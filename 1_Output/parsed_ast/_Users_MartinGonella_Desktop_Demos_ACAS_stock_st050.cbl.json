{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/stock/st050.cbl",
  "fileName": "st050.cbl",
  "timestamp": "2025-09-15T16:25:49.947Z",
  "programId": "st050",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 140
      },
      {
        "name": "file",
        "line": 154
      },
      {
        "name": "working-storage",
        "line": 162
      },
      {
        "name": "linkage",
        "line": 247
      },
      {
        "name": "aa000-Core",
        "line": 261
      },
      {
        "name": "ba000-Process-Stock-Comp",
        "line": 375
      },
      {
        "name": "exit",
        "line": 500
      },
      {
        "name": "zz070-Convert-Date",
        "line": 502
      },
      {
        "name": "exit",
        "line": 530
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 143
      },
      {
        "name": "file-defs",
        "line": 258
      },
      {
        "name": "aa010-Questions",
        "line": 304
      },
      {
        "name": "aa020-Recovery",
        "line": 313
      },
      {
        "name": "aa030-U-Sure",
        "line": 320
      },
      {
        "name": "aa999-Exit",
        "line": 365
      },
      {
        "name": "goback",
        "line": 369
      },
      {
        "name": "ba000-Process-Stock-Comp-Main",
        "line": 378
      },
      {
        "name": "Stock-Last-Actual-Cost",
        "line": 401
      },
      {
        "name": "end-perform",
        "line": 407
      },
      {
        "name": "ba010-Build-Stock",
        "line": 424
      },
      {
        "name": "ba020-Read-Temp",
        "line": 446
      },
      {
        "name": "ba030-Eval-Status",
        "line": 495
      },
      {
        "name": "ba999-Exit",
        "line": 499
      },
      {
        "name": "zz070-Exit",
        "line": 529
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "of",
        "line": 130,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 139,
        "replacing": null
      },
      {
        "name": "selstock",
        "line": 146,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 157,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 202,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 203,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 230,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 250,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 251,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 252,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 496,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 532,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 278
      },
      {
        "target": "ba010-Build-Stock",
        "thru": "ba999-exit",
        "line": 337
      },
      {
        "target": "Stock-Open-Input",
        "thru": null,
        "line": 340
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 344
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 354
      },
      {
        "target": "ba000-Process-Stock-Comp",
        "thru": null,
        "line": 362
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 379
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 381
      },
      {
        "target": "varying",
        "thru": null,
        "line": 402
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 414
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 418
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 429
      },
      {
        "target": "Stock-Open-Output",
        "thru": null,
        "line": 435
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 439
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 449
      },
      {
        "target": "Stock-Write",
        "thru": null,
        "line": 462
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 466
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 474
      },
      {
        "target": "ba030-Eval-Status",
        "thru": null,
        "line": 481
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 489
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 266
      },
      {
        "from": "ws-Date",
        "to": "ws-Conv-Date",
        "line": 279
      },
      {
        "from": "zero",
        "to": "a b",
        "line": 305
      },
      {
        "from": "\"N\"",
        "to": "ws-Recovery",
        "line": 314
      },
      {
        "from": "\"N\"",
        "to": "ws-Reply",
        "line": 325
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 367
      },
      {
        "from": "zero",
        "to": "a b\n              go to ba010-Build-Stock",
        "line": 387
      },
      {
        "from": "zeros",
        "to": "Stock-Construct-Bundle\n                       Stock-Under-Construction\n                       Stock-Work-in-Progress\n                       Stock-Adds\n                       Stock-Deducts\n                       Stock-Wip-Adds\n                       Stock-Wip-Deds\n                       Stock-Last-Actual-Cost",
        "line": 394
      },
      {
        "from": "zeros",
        "to": "Stock-TD-Adds (C)\n                            Stock-TD-Deds (C)\n                            Stock-TD-Wip-Adds (C)\n                            Stock-TD-Wip-Deds (C)\n     end-perform",
        "line": 403
      },
      {
        "from": "Temp-Stock-Record",
        "to": "WS-Stock-Record",
        "line": 461
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 510
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 513
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 517
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 524
      }
    ],
    "computes": [
      {
        "target": "Stock-Value",
        "expression": "Stock-Held * Stock-Cost",
        "line": 29
      },
      {
        "target": "Stock-Value",
        "expression": "Stock-Held * Stock-Cost",
        "line": 390
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "a large number of items are deleted   *\n*>    from the system which has a lot of items.               *\n*>############################################################*\n*>  Note that the program tests that the file record lengths  *\n*>     are the same for both temp file and the stock file and *\n*>     will produce a fatal error msg if not the same.        *\n*>                                                            *\n*>  This process will zeroise all of :\n*>     Stock-Construct-Bundle\n*>     Stock-Under-Construction\n*>     Stock-Work-in-Progress\n*>     Stock-Adds\n*>     Stock-Deducts\n*>     Stock-Wip-Adds\n*>     Stock-Wip-Deds\n*>     Stock-Last-Actual-Cost.\n*>      and with C 1 through 12\n*>         Stock-TD-Adds (C)\n*>         Stock-TD-Deds (C)\n*>         Stock-TD-Wip-Adds (C)\n*>         Stock-TD-Wip-Deds (C)\n*>  and do a compute  Stock-Value = Stock-Held * Stock-Cost.\n*>  SO YOU SHOULD ONLY RUN AT END OF YEAR.\n*>\n*>*************************************************************\n*>    This program is only for the Cobol Stock file and not   *\n*>      for use with the RDB database system as RDB normal    *\n*>      housekeeping takes care of such tasks.                *\n*>                                                            *\n*>  Therefore a test is made to check that the system param   *\n*> File-System-Used = 0 or status FS-Cobol-Files-Used is true *\n*>       otherwise it stops.                                  *\n*>*************************************************************\n*>\n identification          division.\n*>================================\n*>\n*>**\n      program-id.         st050.\n*>**\n*>    Author.             V.B.Coen, FBCS\n*>                        For Applewood Computers.\n*>**\n*>    Security.           Copyright (C) 1976-2025 & later, Vincent Bryan Coen.\n*>                        Distributed under the GNU General Public License.\n*>                        See the file COPYING for details.\n*>**\n*>    Called modules.\n*>                        acas011 -> Stock file FH\n*>                         stockMT - STOCK-REC RDB table.\n*>**\n*>    Error messages used.\n*>\n*>                        ST000.\n*>                        ST003.\n*>\n*>                        ST501.\n*>                        ST502.\n*>                        ST503.\n*>                        ST504.\n*>                        ST505.\n*>                        ST506.\n*>                        ST507.\n*>**\n*> Changes:\n*> 29/06/09 vbc - .00 Written in Cobol from scratch against v2 specs.\n*> 07/09/10 vbc - .00 Added notes with prog description above.\n*> 27/11/11 vbc - .01 Added extra tests and display if errors found during\n*>                    file processing, also added open/close on temp file\n*>                    BUT remd out until testing complete <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n*> 11/12/11 vbc -     Changed version from 1.00.xx to 3.01.xx, in keeping with the rest of ACAS\n*>                .02 Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 12/05/13 vbc - .03 Changed wsnames to in common as pl010 called in st010.\n*> 14/05/13 vbc - .04 Support for File recovery from existing temp file.\n*> 16/05/13 vbc - .05 Changed wsnames to in copybook see above.\n*> 22/05/13 vbc - .06 Added a stock value comp during process.\n*> 21/07/16 vbc - .07 Test to ensure that Cobol files are used.\n*>                    Added message ST507 if no cobol files and as this\n*>                    program is NOT needed for RDB so it has Cobol file I/O only.\n*> 24/10/16 vbc - .08 ALL programs now using wsnames.cob in copybooks.\n*> 13/03/18 vbc - .09 Re comment for .07 made st050 use FH to standardise.\n*>                    Removed unused field WS var. error-code.\n*>                    Chg ST000 to stock rec.\n*> 27/06/20 vbc - .10 Zeroes to WIP 9(6) fields on stock file.\n*>                    fix bug on ba00 recovery with next after goto not skipped.\n*>                    Add finish msg with totals displayed for both passes.\n*> 08/12/22 vbc - .11 Chgd goto in ba000 to use para -Main 4 GC v3.2 warning.\n*> 16/08/23 vbc       Remove remarked out old Cobol File verbs.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 26/12/24 vbc       Change ACCEPT X to force UPPER & remove function upper-case\n*>                    in 2 instances.\n*> 04/02/25 vbc - .12 Extra warning display before proceding regarding cleardown\n*>                       on TD and other fields.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>================================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>-------------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selstock.cob\".  uses \"tmp-stock.dat\"\n     select   Temp-Stock-File      assign  file-9\n                                   access  sequential\n                                   status  fs-reply.\n\n data                    division.\n*>================================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdstock.cob\".\n fd  Temp-Stock-File.\n 01  Temp-Stock-Record.\n     03  filler          pic x(400).\n*>\n working-storage section.\n*>-----------------------\n*>\n 77  Prog-Name           pic x(15)       value \"ST050 (3.02.12)\".\n 77  Eval-Msg            pic x(25)       value spaces.\n*>\n 01  work-fields.\n     03  ws-Reply        pic x                   value space.\n     03  ws-Recovery     pic x                   value \"N\".\n     03  a               pic 9999.\n     03  b               pic 9999.\n     03  c               pic 9(4).\n     03  ws-lines        binary-char  unsigned   value zero.\n     03  ws-22-lines     binary-char  unsigned   value zero.\n     03  ws-23-lines     binary-char  unsigned   value zero.\n     03  ws-env-lines    pic 999                 value zero.\n*>\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n copy \"wsfnctn.cob\".\n copy \"wsstock.cob\".     *> 3.02\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  System-Record          pic x.\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n*>\n 01  Error-Messages.\n     03  ST000          pic x(36) value \"ST000 Error on Writing to Stock Rec.\".\n     03  ST003          pic x(27) value \"ST003 Press return for Menu\".\n*> Module specific\n     03  ST501          pic x(26) value \"ST501 Stock File not found\".\n     03  ST502          pic x(17) value \"ST502 Y or N only\".\n     03  ST503          pic x(29) value \"ST503 Error opening temp file\".\n     03  ST504          pic x(32) value \"ST504 Error writing to temp file\".\n     03  ST505          pic x(55) value \"ST505 Error: Length of Stock File not same as Temp File\".\n     03  ST506          pic x(30) value \"ST506 Error opening Stock File\".\n     03  ST507          pic x(47) value \"ST507 Cobol Files not used, only RDB - Aborting\".\n*>\n 01  Error-Code         pic 999    value zero.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n 01  To-Day             pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n aa000-Core                 section.\n*>*********************************\n*>\n     accept   ws-env-lines from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n*> Get current date into locale format for display\n*>\n     perform  zz070-Convert-Date.\n     move     ws-Date to ws-Conv-Date.\n*>\n*>  Check that Stock file record length is same as Temp file layout\n*>      if not program, MUST be changed to fix and recompiled\n*>\n     move     function length (WS-Stock-Record) to a.\n     move     function length (Temp-Stock-Record) to b.\n     if       a not = b\n              display \" \" at 0401 with erase eos\n              display ST505 at 0401 with foreground-color 4 highlight\n              display \"Stock File = \" at 0601 with foreground-color 2\n              display a at 0614 with foreground-color 2 highlight\n              display \"Temp  File = \" at 0701 with foreground-color 2\n              display b     at 0714 with foreground-color 2 highlight\n              display ST003 at 0801\n              accept ws-reply at 0830\n              go to aa999-Exit.\n*>\n     if       not FS-Cobol-Files-Used                  *> dup processing now removed as redundant.\n              display ST507   at 0101 with foreground-color 2 erase eos\n              display \" \"     at 0201\n              display ST003   at 0301\n              accept ws-reply at 0330\n              go to aa999-Exit.\n*>\n aa010-Questions.\n     move     zero to a b.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Compression Utility\" at 0128 with foreground-color 2.\n     display  ws-Conv-Date at 0171 with foreground-color 2.\n     display  \"Not needed for RDBMS processing  !\" at 0310  with foreground-color 4 highlight.\n     display  \"This process will clean up the Stock File of deleted records\"       at 0410 with foreground-color 2.\n     display  \"Is this a recovery from a previous run of this process - [ ] (N/Y)\" at 0610 with foreground-color 2.\n*>\n aa020-Recovery.\n     move     \"N\" to ws-Recovery.\n     accept   ws-Recovery at 0668 with foreground-color 6 update UPPER.\n     if       ws-Recovery not = \"N\" and not = \"Y\"\n              display ST502 at line ws-23-lines col 1 with foreground-color 4 highlight\n              go to aa020-Recovery.\n*>\n aa030-U-Sure.\n     display  \"This program will cleardown All TD fields and other yearly/period totals\"\n                            at 0810 with foreground-color 2 highlight.\n*>\n     display  \"Confirm you wish this to happen & that you have a backup [ ] (N/Y)\" at 1010 with foreground-color 2.\n     move     \"N\" to ws-Reply.\n     accept   ws-Reply at 1068 with foreground-color 6 update UPPER.\n     if       ws-Reply not = \"N\" and not = \"Y\"\n              display ST502 at line ws-23-lines col 1 with foreground-color 4 highlight\n              go to aa030-U-Sure.\n     if       ws-Reply = \"N\"\n              go to aa999-Exit.\n     display  space at line ws-23-lines col 1 with erase eol.\n*>\n     if       ws-Recovery = \"Y\"\n              display  \"Recreating Stock file from temp file as requested\" at 1210\n                                                with foreground-color 2 highlight erase eol\n              perform   ba010-Build-Stock thru ba999-exit\n              go to aa999-exit.\n*>\n     perform  Stock-Open-Input.      *>  open     input Stock-File.\n     if       fs-reply not = zero\n              display ST501 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 28 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 31 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n              go to aa999-Exit.\n*>\n     open     output Temp-Stock-File.\n     if       fs-reply not = zero\n              display ST503 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 31 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 34 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n              go to aa999-Exit.\n*>\n     display  \"Updating your Stock file as requested\" at 1210 with foreground-color 2 highlight erase eol.\n*>\n     perform  ba000-Process-Stock-Comp.\n     go       to aa999-Exit.\n*>\n aa999-Exit.\n     display  \"Check totals and hit return to quit\" at 1801 with erase eol.\n     move     space to ws-reply.\n     accept   ws-reply at 1836.\n     goback.\n*>\n*>***********************************************\n*>                  Routines                    *\n*>***********************************************\n*>\n ba000-Process-Stock-Comp    section.\n*>**********************************\n*>\n ba000-Process-Stock-Comp-Main.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              perform Stock-Close\n              close Temp-Stock-File\n              display \"Stock in : \" at 1401 with erase eol\n              display a  at 1412\n              display  \"temp stock out : \" at 1431\n              display b at 1448\n              move   zero to a b\n              go to ba010-Build-Stock.\n*>\n     compute  Stock-Value = Stock-Held * Stock-Cost.\n*>\n*> Here any record clean ups if needed - You might want to NOT do any of these !\n*>\n     move     zeros to Stock-Construct-Bundle\n                       Stock-Under-Construction\n                       Stock-Work-in-Progress\n                       Stock-Adds\n                       Stock-Deducts\n                       Stock-Wip-Adds\n                       Stock-Wip-Deds\n                       Stock-Last-Actual-Cost.\n     perform  varying C from 1 by 1 until C > 12\n              move zeros to Stock-TD-Adds (C)\n                            Stock-TD-Deds (C)\n                            Stock-TD-Wip-Adds (C)\n                            Stock-TD-Wip-Deds (C)\n     end-perform.\n     add      1 to a.\n*>\n     write    Temp-Stock-Record from WS-Stock-Record.\n     if       fs-Reply not = zero\n              display ST504 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 34 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 37 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n              perform Stock-Close              *> close Stock-File\n              close Temp-Stock-File\n              go to ba999-Exit.\n     add      1 to b.\n     go       to ba000-Process-Stock-Comp-Main.\n*>\n ba010-Build-Stock.\n     open     input Temp-Stock-File.\n     if       fs-reply not = zero\n              display ST503 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 31 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 34 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n              go to ba999-Exit.\n*>\n     perform  Stock-Open-Output.\n     if       fs-reply not = zero\n              display ST506 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 32 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 35 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n              close Temp-Stock-File\n              go to ba999-Exit.\n*>\n ba020-Read-Temp.\n     read     Temp-Stock-File at end\n              close Temp-Stock-File\n              perform  Stock-Close\n              open output Temp-Stock-File\n              close Temp-Stock-File\n              display \"Temp stock in : \" at 1601\n              display a at 1617\n              display \"New stock out : \" at 1631\n              display b at 1647\n              go to ba999-Exit.\n     add      1 to a.\n*>\n*>  This error should never happen unless HDD error as new file will be = or smaller than original\n*>\n     move     Temp-Stock-Record to WS-Stock-Record.\n     perform  Stock-Write.         *> write    Stock-Record from Temp-Stock-Record invalid key\n     if       FS-Reply = 21 or = 22\n              display ST000 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 38 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 41 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n                 display WS-Stock-Key at line ws-lines col 41\n                 display WS-Stock-Abrev-Key at line ws-lines col 55\n                 go to ba020-Read-Temp.\n\n  *>            perform Stock-Close\n  *>            close Temp-Stock-File\n  *>            go to ba999-Exit.\n*>\n     if       fs-Reply not = zero\n              display ST000 at line ws-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line ws-23-lines col 38 with foreground-color 2 highlight\n              perform  ba030-Eval-Status\n              display Eval-Msg at line ws-23-lines col 41 with foreground-color 2 highlight\n              display ST003   at line ws-lines col 01\n              accept ws-reply at line ws-lines col 30\n                 display WS-Stock-Key at line ws-lines col 41\n                 display WS-Stock-Abrev-Key at line ws-lines col 55\n                 go to ba020-Read-Temp.\n\n   *>           perform Stock-Close\n   *>           close Temp-Stock-File\n   *>           go to ba999-Exit.\n     add      1 to b.\n     go       to ba020-Read-Temp.\n*>\n ba030-Eval-Status.\n copy \"FileStat-Msgs.cpy\"   replacing STATUS by fs-Reply\n                                      MSG by Eval-Msg.\n*>\n ba999-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 8
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 4,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 24,
      "totalOperators": 16,
      "totalOperands": 28,
      "vocabulary": 26,
      "length": 44,
      "volume": 206.81934759820803
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
