{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl020.cbl",
  "fileName": "sl020.cbl",
  "timestamp": "2025-09-15T16:25:29.626Z",
  "programId": "sl020",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 115
      },
      {
        "name": "file",
        "line": 135
      },
      {
        "name": "working-storage",
        "line": 154
      },
      {
        "name": "linkage",
        "line": 385
      },
      {
        "name": "init01",
        "line": 399
      },
      {
        "name": "enquiry",
        "line": 453
      },
      {
        "name": "print-screen",
        "line": 746
      },
      {
        "name": "set-up-work-file",
        "line": 776
      },
      {
        "name": "exit",
        "line": 851
      },
      {
        "name": "get-unposted",
        "line": 853
      },
      {
        "name": "exit",
        "line": 875
      },
      {
        "name": "set-query-flag",
        "line": 877
      },
      {
        "name": "exit",
        "line": 938
      },
      {
        "name": "zz050-Validate-Date",
        "line": 940
      },
      {
        "name": "exit",
        "line": 973
      },
      {
        "name": "zz060-Convert-Date",
        "line": 975
      },
      {
        "name": "exit",
        "line": 1008
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1010
      },
      {
        "name": "exit",
        "line": 1038
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 118
      },
      {
        "name": "file-defs",
        "line": 396
      },
      {
        "name": "menu-exit",
        "line": 441
      },
      {
        "name": "maps04",
        "line": 444
      },
      {
        "name": "Enquiry-Main",
        "line": 456
      },
      {
        "name": "main001",
        "line": 457
      },
      {
        "name": "after-disp-heads",
        "line": 466
      },
      {
        "name": "main-display-end",
        "line": 474
      },
      {
        "name": "work-customer",
        "line": 489
      },
      {
        "name": "inv-amount",
        "line": 492
      },
      {
        "name": "read-sales",
        "line": 508
      },
      {
        "name": "read-open-item",
        "line": 576
      },
      {
        "name": "item-comp-1",
        "line": 625
      },
      {
        "name": "calc-age",
        "line": 656
      },
      {
        "name": "bypass-ageing",
        "line": 676
      },
      {
        "name": "end-statement",
        "line": 680
      },
      {
        "name": "end-if",
        "line": 696
      },
      {
        "name": "disp-totals",
        "line": 698
      },
      {
        "name": "es-disp",
        "line": 710
      },
      {
        "name": "es-accept",
        "line": 719
      },
      {
        "name": "Heads1",
        "line": 752
      },
      {
        "name": "Heads2",
        "line": 760
      },
      {
        "name": "read-invoice",
        "line": 796
      },
      {
        "name": "invoice-eof",
        "line": 837
      },
      {
        "name": "eof-test",
        "line": 842
      },
      {
        "name": "main004-exit",
        "line": 850
      },
      {
        "name": "read-work",
        "line": 859
      },
      {
        "name": "main005-finish",
        "line": 870
      },
      {
        "name": "main005-exit",
        "line": 874
      },
      {
        "name": "accept006",
        "line": 884
      },
      {
        "name": "open006",
        "line": 893
      },
      {
        "name": "error006",
        "line": 926
      },
      {
        "name": "finish006",
        "line": 932
      },
      {
        "name": "main006-exit",
        "line": 937
      },
      {
        "name": "zz050-test-date",
        "line": 967
      },
      {
        "name": "zz050-exit",
        "line": 972
      },
      {
        "name": "zz060-Exit",
        "line": 1007
      },
      {
        "name": "zz070-Exit",
        "line": 1037
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 422,
        "type": "DYNAMIC",
        "using": [
          "File-19",
          "*>",
          "Open",
          "ITM3",
          "file",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "SL119",
          "at",
          "2301",
          "display",
          "SL116",
          "at",
          "2401",
          "accept",
          "Accept-Reply",
          "at",
          "2440",
          "go",
          "to",
          "menu-exit"
        ]
      },
      {
        "target": "maps04",
        "line": 447,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 772,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 105,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 114,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 121,
        "replacing": null
      },
      {
        "name": "selinv",
        "line": 122,
        "replacing": null
      },
      {
        "name": "seloi3",
        "line": 123,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 125,
        "replacing": null
      },
      {
        "name": "fdinv2",
        "line": 150,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 151,
        "replacing": null
      },
      {
        "name": "fdoi3",
        "line": 152,
        "replacing": null
      },
      {
        "name": "print-spool-command-p",
        "line": 158,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 159,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 160,
        "replacing": null
      },
      {
        "name": "slwsoi3",
        "line": 162,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 163,
        "replacing": null
      },
      {
        "name": "slwsinv2",
        "line": 164,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 230,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 383,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 388,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 389,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 390,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1040,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 412
      },
      {
        "target": "set-up-work-file",
        "thru": null,
        "line": 430
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 432
      },
      {
        "target": "OTM3-Open-Input",
        "thru": null,
        "line": 433
      },
      {
        "target": "enquiry",
        "thru": null,
        "line": 434
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 436
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 437
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 463
      },
      {
        "target": "Sales-Start",
        "thru": null,
        "line": 494
      },
      {
        "target": "OTM3-Start",
        "thru": null,
        "line": 496
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 510
      },
      {
        "target": "get-unposted",
        "thru": null,
        "line": 554
      },
      {
        "target": "OTM3-Read-Next",
        "thru": null,
        "line": 578
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 600
      },
      {
        "target": "print-screen",
        "thru": null,
        "line": 733
      },
      {
        "target": "set-query-flag",
        "thru": null,
        "line": 739
      },
      {
        "target": "varying",
        "thru": null,
        "line": 761
      },
      {
        "target": "Heads1",
        "thru": null,
        "line": 766
      },
      {
        "target": "write",
        "thru": null,
        "line": 768
      },
      {
        "target": "main001",
        "thru": null,
        "line": 782
      },
      {
        "target": "Invoice-Open-Input",
        "thru": null,
        "line": 789
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 793
      },
      {
        "target": "Invoice-Read-Next-Header",
        "thru": null,
        "line": 798
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 823
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 839
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 891
      },
      {
        "target": "OTM3-Open",
        "thru": null,
        "line": 895
      },
      {
        "target": "OTM3-Read-Indexed",
        "thru": null,
        "line": 902
      },
      {
        "target": "OTM3-Rewrite",
        "thru": null,
        "line": 918
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 934
      },
      {
        "target": "OTM3-Open-Input",
        "thru": null,
        "line": 935
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 970
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 984
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "references",
        "to": "File-Status - depleted",
        "line": 64
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 402
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 411
      },
      {
        "from": "ws-date",
        "to": "l0-date",
        "line": 413
      },
      {
        "from": "prog-name",
        "to": "l0-version",
        "line": 414
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 418
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 419
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 462
      },
      {
        "from": "spaces",
        "to": "customer-in",
        "line": 476
      },
      {
        "from": "customer-in",
        "to": "WS-Sales-Key\n                             OI-Customer     oi3-customer\n                             l2-account\n                             work-customer",
        "line": 486
      },
      {
        "from": "zero",
        "to": "OI-Invoice      oi3-invoice\n                             work-invoice\n                             inv-amount",
        "line": 490
      },
      {
        "from": "spaces",
        "to": "line-7-19",
        "line": 517
      },
      {
        "from": "sales-name",
        "to": "l1-name",
        "line": 518
      },
      {
        "from": "1",
        "to": "a",
        "line": 520
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 521
      },
      {
        "from": "address-line",
        "to": "l2-address",
        "line": 524
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 526
      },
      {
        "from": "address-line",
        "to": "l3-address",
        "line": 529
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 531
      },
      {
        "from": "address-line",
        "to": "l4-address",
        "line": 534
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 536
      },
      {
        "from": "address-line",
        "to": "l5-address",
        "line": 539
      },
      {
        "from": "sales-current",
        "to": "l2-balance",
        "line": 547
      },
      {
        "from": "sales-unapplied",
        "to": "l3-unapplied",
        "line": 548
      },
      {
        "from": "sales-limit",
        "to": "l4-credit-limit",
        "line": 551
      },
      {
        "from": "zero",
        "to": "l4-unposted",
        "line": 552
      },
      {
        "from": "zero",
        "to": "a b c",
        "line": 570
      },
      {
        "from": "1",
        "to": "Screen-Start",
        "line": 573
      },
      {
        "from": "Screen-Size",
        "to": "Screen-End",
        "line": 574
      },
      {
        "from": "open-item-record-3",
        "to": "oi-header",
        "line": 586
      },
      {
        "from": "100",
        "to": "a\n              go to item-comp-1",
        "line": 591
      },
      {
        "from": "zero",
        "to": "oi-invoice",
        "line": 595
      },
      {
        "from": "oi-invoice",
        "to": "l7-invoice (a)",
        "line": 597
      },
      {
        "from": "oi-date",
        "to": "u-bin",
        "line": 599
      },
      {
        "from": "ws-date",
        "to": "l7-date (a)",
        "line": 601
      },
      {
        "from": "\"Q\"",
        "to": "l7-hold (a)",
        "line": 604
      },
      {
        "from": "spaces",
        "to": "ws-desc",
        "line": 606
      },
      {
        "from": "oi-cr",
        "to": "ws-inv8\n              string \"CN",
        "line": 614
      },
      {
        "from": "\"Payment\"",
        "to": "ws-desc\n          else\n           if oi-type = 6\n              move \"Journal Payment\" to ws-desc",
        "line": 618
      },
      {
        "from": "ws-desc",
        "to": "l7-desc (a)",
        "line": 623
      },
      {
        "from": "amount-out",
        "to": "l7-balance (a)",
        "line": 643
      },
      {
        "from": "inv-amount",
        "to": "l7-amount (a)",
        "line": 644
      },
      {
        "from": "oi-paid",
        "to": "l7-paid (a)",
        "line": 645
      },
      {
        "from": "inv-amount",
        "to": "l7-amount (a)  l7-paid (a)\n              move zero to l7-balance (a)\n              go to bypass-ageing",
        "line": 648
      },
      {
        "from": "zeros",
        "to": "l7-balance (a) l7-amount (a)\n              go to bypass-ageing",
        "line": 653
      },
      {
        "from": "8000",
        "to": "Screen-End\n                subtract b from Body-Lines giving c\n                add 1 to c\n                add c 7 giving l\n                display \" \" at line l col 1 with erase eos\n            end-if\n     end-if",
        "line": 690
      },
      {
        "from": "bal-0",
        "to": "l21-current",
        "line": 701
      },
      {
        "from": "bal-30",
        "to": "l21-bal30",
        "line": 702
      },
      {
        "from": "bal-60",
        "to": "l21-bal60",
        "line": 703
      },
      {
        "from": "bal-90",
        "to": "l21-bal90",
        "line": 704
      },
      {
        "from": "bal-t",
        "to": "l21-os",
        "line": 705
      },
      {
        "from": "a",
        "to": "l21-Invs",
        "line": 706
      },
      {
        "from": "space",
        "to": "s1",
        "line": 721
      },
      {
        "from": "65",
        "to": "cole",
        "line": 722
      },
      {
        "from": "zero",
        "to": "bal-0 bal-30 bal-60 bal-90 bal-t\n              go to enquiry-Main",
        "line": 736
      },
      {
        "from": "14",
        "to": "lin",
        "line": 783
      },
      {
        "from": "zero",
        "to": "cole",
        "line": 784
      },
      {
        "from": "zero",
        "to": "a",
        "line": 785
      },
      {
        "from": "ih-invoice",
        "to": "work-invoice",
        "line": 809
      },
      {
        "from": "ih-customer",
        "to": "work-customer",
        "line": 810
      },
      {
        "from": "zero",
        "to": "a\n              add  1 to cole\n              display \"",
        "line": 828
      },
      {
        "from": "zero",
        "to": "cole",
        "line": 833
      },
      {
        "from": "\"Y\"",
        "to": "work-file-data\n              display SL118  at 1801 with foreground-color 2",
        "line": 847
      },
      {
        "from": "inv-amount",
        "to": "l4-unposted",
        "line": 872
      },
      {
        "from": "zeros",
        "to": "ws-tinv",
        "line": 880
      },
      {
        "from": "customer-in",
        "to": "OI-customer",
        "line": 900
      },
      {
        "from": "ws-tinv",
        "to": "OI-invoice",
        "line": 901
      },
      {
        "from": "open-item-record-3",
        "to": "oi-header",
        "line": 912
      },
      {
        "from": "\"Q\"",
        "to": "oi-hold-flag\n     else\n              move space to oi-hold-flag",
        "line": 914
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 949
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 951
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 955
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 962
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 968
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 969
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 986
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 988
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 991
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 995
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1002
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 1018
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1021
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 1025
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1032
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n*> copy \"selinv.cob\".\n*> copy \"seloi3.cob\".\n*>\n copy \"selprint.cob\".\n     select Work-File  assign       File-21\n                       access       dynamic\n                       organization indexed\n                       status       fs-reply\n                       record key   Work-Key.\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n fd  Work-File.\n*>\n 01  Work-Record.\n     03  Work-Key.\n         05  Work-Customer  pic x(7).\n         05  Work-Invoice   binary-long.\n     03  Work-Amount        pic s9(8)v99  comp-3.\n*>\n fd  print-file.\n*>\n 01  print-record            pic x(80).\n*>\n*> copy \"fdinv2.cob\".\n*> copy \"fdsl.cob\".\n*> copy \"fdoi3.cob\".\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name               pic x(15) value \"SL020 (3.02.15)\".\n*>\n copy \"print-spool-command-p.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n copy \"slwsoi3.cob\".\n copy \"wssl.cob\".\n copy \"slwsinv2.cob\".\n 01  WS-Invoice-Record  redefines Invoice-Record\n                                pic x(137).\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n*>     03  WS-Invoice-Record      pic x.\n*>     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  ws-data.\n     03  a               binary-char     value zero.\n     03  b               binary-char     value zero.\n     03  c               binary-char     value zero.\n     03  l               binary-char     value zero.\n     03  Screen-Size     binary-long     value zero.\n     03  Screen-Start    binary-long     value zero.\n     03  Screen-End      binary-long     value zero.\n     03  ws-inv.\n         05  ws-inv8     pic z(7)9.\n     03  work-1          binary-long     value zero.\n     03  amount-out      pic s9(8)v99  comp-3 value zero.\n     03  inv-amount      pic s9(8)v99  comp-3 value zero.\n     03  customer-in     pic x(7)        value space.\n     03  work-file-data  pic x           value \"N\".\n     03  ws-tinv         pic 9(8)        value zero.\n     03  address-line    pic x(36).\n     03  ws-desc         pic x(20)       value spaces.\n*>\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-21-lines     binary-char unsigned value zero.\n     03  ws-20-lines     binary-char unsigned value zero.\n     03  Body-lines      binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n*>       NONE\n*> Module specific\n     03  SL111          pic x(53) value \"SL111 Error On Writing Work File. Hit Return To Abort\".\n     03  SL112          pic x(21) value \"SL112 Can't open file\".\n     03  SL113          pic x(19) value \"SL113 Can't find it\".\n     03  SL114          pic x(22) value \"SL114 Record not found\".\n     03  SL115          pic x(22) value \"SL115 Error On Rewrite\".\n     03  SL116          pic x(38) value \"SL116 Note: and hit return to continue\".\n     03  SL117          pic x(35) value \"SL117 No Work File Created..No Data\".\n     03  SL118          pic x(23) value \"SL118 Work file Created\".\n     03  SL119          pic x(35) value \"SL119 Sales Transactions Not Posted\".\n*>\n 01  error-code          pic 999.\n*>\n 01  balances        comp-3.\n     03  bal-0           pic s9(8)v99 value zero.\n     03  bal-30          pic s9(8)v99 value zero.\n     03  bal-60          pic s9(8)v99 value zero.\n     03  bal-90          pic s9(8)v99 value zero.\n     03  bal-t           pic s9(8)v99 value zero.\n*>\n 01  line-0.\n     03  l0-version      pic x(15).\n     03  filler          pic x(15)  value spaces.\n     03  l0-title        pic x(20)  value \"Sales Ledger Enquiry\".\n     03  filler          pic x(20)  value spaces.\n     03  l0-date         pic x(10).\n*>\n 01  line-1.\n     03  line-1a.\n         05 l1-lit       pic x(10)  value \"Customer:\".\n         05 l1-name      pic x(30).\n     03  line-1b.\n         05 filler       pic x(40)  value all \"*\".\n*>\n*> seems to be missing [] here see pl015 <<<<<<<<<<<<???\n*>  for lines 2, 3 4\n*>\n 01  line-2.\n     03  line-2a.\n         05 l2-lit       pic x(10)  value \"Address :\".\n         05 l2-address   pic x(30).\n     03  line-2b.\n         05 filler       pic x(10)  value \"* A/C Nos\".\n         05 l2-account   pic x(8).\n         05 filler       pic x(11)  value \"*Balance\".\n         05 l2-balance   pic z(6)9.99.\n         05 filler       pic x      value \"*\".\n*>\n 01  line-3.\n     03  line-3a.\n         05 filler       pic x(10)   value spaces.\n         05 l3-address   pic x(30).\n     03  line-3b.\n         05 filler       pic x(10)  value \"* YTD\".\n         05 l3-ytd       pic z(7)9.\n         05 filler       pic x(11)  value \"*Unapplied\".\n         05 l3-unapplied pic z(6)9.99.\n         05 filler       pic x      value \"*\".\n*>\n 01  line-4.\n     03  line-4a.\n         05 filler          pic x(10)    value spaces.\n         05 l4-address      pic x(30).\n     03  line-4b.\n         05 filler          pic x(10)    value \"* Credit\".\n         05 l4-credit-limit pic z(7)9.\n         05 filler          pic x(11)    value \"*Unposted\".\n         05 l4-unposted     pic z(6)9.99.\n         05 filler          pic x        value \"*\".\n*>\n 01  line-5.\n     03  line-5a.\n         05 filler       pic x(10)       value spaces.\n         05 l5-address   pic x(30).\n     03  line-5b.\n         05 filler       pic x(40)       value all \"*\".\n*>\n 01  line-6.\n     03  filler          pic x           value space.\n     03  l6-lit1         pic x(06)       value \"Number\".\n     03  filler          pic x(06)       value spaces.\n     03  l6-lit2         pic x(04)       value \"Date\".\n     03  filler          pic x(06)       value spaces.\n     03  l6-lit3         pic x(11)       value \"Description\".\n     03  filler          pic x(12)       value spaces.\n     03  l6-lit4         pic x(08)       value \"Invoiced\".\n     03  filler          pic x(09)       value spaces.\n     03  l6-lit5         pic x(04)       value \"Paid\".\n     03  filler          pic x(06)       value spaces.\n     03  l6-lit6         pic x(07)       value \"Balance\".\n*>\n 01  line-7-19.\n     03  l7-group  occurs 100.\n         05 l7-invoice   pic z(7)9       blank when zero.\n         05 filler       pic x.\n         05 l7-hold      pic x.\n         05 filler       pic x.\n         05 l7-date      pic x(11).\n         05 l7-desc      pic x(19).\n         05 l7-amount    pic zz,zzz,zz9.99.\n         05 l7-paid      pic zz,zzz,zz9.99.\n         05 l7-balance   pic zz,zzz,zz9.99.\n*>\n 01  line-20.\n     03  l20-t0          pic x(7)    value \"Inv #\".\n     03  l20-t1          pic x(9)    value \"Total O/S\".\n     03  filler          pic x(11)   value spaces.\n     03  l20-t2          pic x(7)    value \"Current\".\n     03  filler          pic x(11)   value spaces.\n     03  l20-t3          pic x(2)    value \"30\".\n     03  filler          pic x(13)   value spaces.\n     03  l20-t4          pic x(2)    value \"60\".\n     03  filler          pic x(12)   value spaces.\n     03  l20-t5          pic xxx     value \"90+\".\n*>\n 01  line-21.\n     03  l21-Invs        pic zz9.\n     03  filler          pic xx               value spaces.\n     03  l21-os          pic zz,zzz,zz9.99.\n     03  l21-current     pic z(6),zzz,zz9.99.\n     03  l21-bal30       pic zzzz,zzz,zz9.99.\n     03  l21-bal60       pic zzzz,zzz,zz9.99.\n     03  l21-bal90       pic zzzz,zzz,zz9.99.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-21-lines.\n     subtract 4 from ws-lines giving ws-20-lines.\n     subtract 11 from ws-lines giving Body-Lines.\n     move     to-day to ws-date.\n     perform  zz070-Convert-Date.\n     move     ws-date to l0-date.\n     move     prog-name to l0-version.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     1  to File-Key-No.\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-19    *> Open ITM3 file\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    display SL119  at 2301\n                    display SL116  at 2401\n                    accept  Accept-Reply at 2440\n                    go to menu-exit.\n*>\n     perform  set-up-work-file.         *> creates a list of active inv & cr. notes with total amt by cust & inv nos\n     open     input work-file.\n     perform  Sales-Open-Input.\n     perform  OTM3-Open-Input.\n     perform  enquiry.\n     close    work-file.\n     perform  Sales-Close.\n     perform  OTM3-Close.\n     open     output work-file.                    *> clear down workfile, is this safe here?\n     close    work-file.\n*>\n menu-exit.\n     exit     program.\n*>\n maps04.\n*>******\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n*>****************************************************************\n*>                     P R O C E D U R E S                       *\n*>****************************************************************\n*>\n enquiry                 section.\n*>==============================\n*>\n Enquiry-Main.\n main001.\n*>\n     display  \" \" at 0101 with erase eos.\n     display  prog-name at 0101 with foreground-color 2.\n     display  \"Sales Ledger Enquiry\" at 0131 with foreground-color 2.\n     move     to-day to ws-date.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171    with foreground-color 2.\n*>\n after-disp-heads.\n*>\n     display  \"****************************************\" at 0241 with foreground-color 2.\n     display  \"*A/C Nos [       ]*Balance             *\" at 0341 with foreground-color 2.\n     display  \"*Ytd              *Unapplied           *\" at 0441 with foreground-color 2.\n     display  \"*Credit           *Unposted            *\" at 0541 with foreground-color 2.\n     display  \"****************************************\" at 0641 with foreground-color 2.\n*>\n main-display-end.\n*>\n     move     spaces to customer-in.\n     accept   customer-in at 0351 with foreground-color 3.\n     if       customer-in = spaces\n              go to main-exit.\n     if       cob-crt-status = cob-scr-esc\n              go to main-exit.\n*>\n     move     function upper-case (customer-in) to customer-in.\n     display  customer-in at 0351 with foreground-color 3.\n*>\n     move     customer-in to WS-Sales-Key\n                             OI-Customer     oi3-customer\n                             l2-account\n                             work-customer.\n     move     zero        to OI-Invoice      oi3-invoice\n                             work-invoice\n                             inv-amount.\n     set      fn-not-less-than to true.\n     perform  Sales-Start.      *> start sales-file key not < sales-key.\n     set      fn-not-less-than to true.\n     perform  OTM3-Start.        *> start open-item-file-3 key not < oi3-key.\n     if       fs-reply not = zero\n              display SL119 at 2301\n              display SL116 at 2401\n              accept  accept-reply at 2440\n              go to Main-Exit.\n*>\n     if       work-file-data = \"N\"\n              go to read-sales.\n*>\n     start    work-file  key not < work-key.\n*>\n read-sales.\n*>\n     perform  Sales-Read-Next.\n     if       fs-reply = 10\n              go to  main-display-end.\n*>\n     if       WS-Sales-Key not = customer-in\n              go to main-display-end.\n*>\n     move     spaces to line-7-19.\n     move     sales-name  to  l1-name.\n*>\n     move     1  to  a.\n     move     spaces  to  address-line.\n     unstring sales-address delimited by sl-delim into address-line\n                 count a  pointer  a.\n     move     address-line  to  l2-address.\n*>\n     move     spaces  to  address-line.\n     unstring sales-address delimited by sl-delim into address-line\n                 count a  pointer  a.\n     move     address-line  to  l3-address.\n*>\n     move     spaces  to  address-line.\n     unstring sales-address delimited by sl-delim into address-line\n                 count a  pointer  a.\n     move     address-line  to  l4-address.\n*>\n     move     spaces to address-line.\n     unstring sales-address delimited by sl-delim into address-line\n                 count a  pointer  a.\n     move     address-line  to  l5-address.\n*>\n     display  line-1a at 0201 with foreground-color 2.\n     display  line-2a at 0301 with foreground-color 2.\n     display  line-3a at 0401 with foreground-color 2.\n     display  line-4a at 0501 with foreground-color 2.\n     display  line-5a at 0601 with foreground-color 2.\n*>\n     move     sales-current to l2-balance.\n     move     sales-unapplied to l3-unapplied.\n     add      STurnover-Q (1) STurnover-Q (2)\n              STurnover-Q (3) STurnover-Q (4) giving l3-ytd.\n     move     sales-limit to l4-credit-limit.\n     move     zero        to l4-unposted.\n*>\n     perform  get-unposted.\n*>\n     display  l2-balance  at 0370 with foreground-color 2.\n     display  l3-ytd      at 0451 with foreground-color 2.\n     if       sales-unapplied not = zero\n              display l3-unapplied at 0470 with foreground-color 2.\n     display  l4-credit-limit at 0551 with foreground-color 2.\n     if       inv-amount not = zero\n              display l4-unposted at 0570 with foreground-color 2.\n*>\n     display  l6-lit1 at 0702 with foreground-color 2.\n     display  l6-lit2 at 0714 with foreground-color 2.\n     display  l6-lit3 at 0724 with foreground-color 2.\n     display  l6-lit4 at 0746 with foreground-color 2.\n     display  l6-lit5 at 0763 with foreground-color 2.\n     display  l6-lit6 at 0773 with foreground-color 2.\n     move     zero to a b c.\n*>\n     multiply Body-Lines by 80 giving Screen-Size.\n     move     1 to Screen-Start.\n     move     Screen-Size to Screen-End.\n*>\n read-open-item.\n*>\n     perform  OTM3-Read-Next.\n     if       fs-reply = 10\n              go to end-statement.\n     if       fs-reply not = zero     *> JIC for rdb testing\n              go to End-Statement.\n*>\n     if       OI-Customer not =  WS-Sales-Key     *> oi3-customer\n              go to end-statement.\n *>    move     open-item-record-3  to  oi-header.\n*>\n     add      1 to a.\n     if       a > 100\n              move \">> screen overflow <<\" to l7-desc (100)\n              move 100 to a\n              go to item-comp-1.\n*>\n     if       oi-type = 5 or 6                  *> if payment clear inv. no.\n              move  zero  to  oi-invoice.\n*>\n     move     oi-invoice  to  l7-invoice (a).\n*>\n     move     oi-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date   to  l7-date (a).\n*>\n     if       oi-hold-flag not = space\n              move \"Q\" to l7-hold (a).\n*>\n     move     spaces  to  ws-desc.\n     if       oi-type = 1\n              move \"Receipt \" to ws-desc\n     else\n       if     oi-type = 2\n              string \"Goods - \" delimited by size  oi-description delimited by \"  \" into ws-desc\n       else\n         if   oi-type = 3\n              move oi-cr to ws-inv8\n              string \"CN.Re Inv -\" delimited by size ws-inv delimited by size into ws-desc\n         else\n          if  oi-type = 5\n              move  \"Payment\"  to  ws-desc\n          else\n           if oi-type = 6\n              move \"Journal Payment\" to ws-desc.\n*>\n     move     ws-desc to l7-desc (a).\n*>\n item-comp-1.\n*>\n     add      oi-net oi-extra oi-carriage oi-vat oi-discount\n              oi-e-vat oi-deduct-amt oi-deduct-vat oi-c-vat giving inv-amount.\n*>\n     if       oi-type = 3\n              multiply -1 by oi-paid.\n     if       oi-type = 2 or = 3\n              subtract oi-paid from inv-amount giving  amount-out.\n*>\n     if       a > 100\n         and  (oi-type = 2 or 3)\n              go to calc-age.\n*>\n     if       a > 100\n              go to bypass-ageing.\n*>\n     if       oi-type = 2 or 3\n              move amount-out to l7-balance (a).\n     move     inv-amount to l7-amount (a).\n     move     oi-paid to l7-paid (a).\n*>\n     if       oi-type = 1\n              move inv-amount to l7-amount (a)  l7-paid (a)\n              move zero to l7-balance (a)\n              go to bypass-ageing.\n*>\n     if       oi-type = 5  or  6\n              move zeros to l7-balance (a) l7-amount (a)\n              go to bypass-ageing.\n*>\n calc-age.\n*>\n     subtract oi-date  from  run-date  giving  work-1.\n*>\n*> Now work out ageing\n*> (dont worry if paid in full - routine still works ok)\n*>\n     if       work-1  <  30\n              add  amount-out  to  bal-0\n     else\n      if      work-1  <  60\n              add  amount-out  to  bal-30\n      else\n       if     work-1  <  90\n              add  amount-out  to  bal-60\n       else\n              add  amount-out  to  bal-90.\n*>\n     add      amount-out  to  bal-t.\n*>\n bypass-ageing.\n*>\n     go       to read-open-item.\n*>\n end-statement.\n*>************\n*>\n     display  line-7-19 (Screen-Start:Screen-End) at 0801 with foreground-color 2\n     add Body-Lines to b.\n     if     a > b\n            add Screen-Size to Screen-Start\n            add Screen-Size to Screen-End\n            if  b > 100\n                subtract 100 from b          *>  = lines to display\n                move 8000 to Screen-End\n                subtract b from Body-Lines giving c\n                add 1 to c\n                add c 7 giving l\n                display \" \" at line l col 1 with erase eos\n            end-if\n     end-if.\n*>\n disp-totals.\n     display  line-20 at line ws-21-lines col 1 with foreground-color 2.\n*>\n     move     bal-0   to  l21-current.\n     move     bal-30  to  l21-bal30.\n     move     bal-60  to  l21-bal60.\n     move     bal-90  to  l21-bal90.\n     move     bal-t   to  l21-os.\n     move     a       to  l21-Invs.\n*>\n     display  line-21 at line ws-22-lines col 1 with foreground-color 2.\n*>\n es-disp.\n*>\n     display  \"Select: 'P'rint, 'N'ext enquiry, 'T'oggle query flag, \"\n                                            at line ws-lines col 01 with foreground-color 2.\n     if       a > b\n              display \"'M'ore or 'E'nd [ ]\" at line ws-lines col 55 with foreground-color 2\n     else\n              display \"or 'E'nd [ ]\"        at line ws-lines col 55 with foreground-color 2.\n*>\n es-accept.\n*>\n     move     space to s1.\n     move     65 to cole.\n     if       a > b\n              add 7 to cole.\n     accept   s1 at line ws-lines col cole  with foreground-color 6 update auto UPPER.\n     if       cob-crt-status = cob-scr-esc\n              go to main-exit.\n     if       s1 = \"E\"\n              go to main-exit.\n     if       s1 = \"M\"\n              go to end-statement.\n     if       s1 = \"P\"\n              perform print-screen\n              go to es-disp.\n     if       s1 = \"N\"\n              move zero to bal-0 bal-30 bal-60 bal-90 bal-t\n              go to enquiry-Main.\n     if       s1 = \"T\"\n              perform set-query-flag\n              go to es-disp.\n     go       to es-accept.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n print-screen            section.\n*>==============================\n*>\n     open     output print-file.\n     write    print-record from line-0 after 1.  *> ex page\n*>\n Heads1.\n     write    print-record from line-1 after 1.\n     write    print-record from line-2 after 1.\n     write    print-record from line-3 after 1.\n     write    print-record from line-4 after 1.\n     write    print-record from line-5 after 1.\n     write    print-record from line-6 after 1.\n*>\n Heads2.\n     perform  varying l from 1 by 1 until l > a\n              move l7-group (l) to print-record\n              write print-record after 1\n              if  l = 59\n                  write print-record from line-0 after page\n                  perform Heads1\n              end-if\n     end-perform\n     write    print-record from line-20 after 2.\n     write    print-record from line-21 after 2.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-exit.   exit section.\n*>\n set-up-work-file  section.\n*>========================\n*>\n*>  Create work file with unapplied invoices/cr. notes etc so we can\n*>    show them with current invoice/payments per customer\n*>\n     perform  main001.               *> display heads\n     move     14 to lin.\n     move     zero to cole.\n     move     zero to a.\n     if       s-flag-i not = 1\n              go to eof-test.\n     open     output work-file.\n     perform  Invoice-Open-Input.\n*>\n     if       fs-reply not = zero\n              close work-file\n              perform Invoice-Close\n              go to main004-exit.\n*>\n read-invoice.\n*>\n     perform  Invoice-Read-Next-Header.\n     if       fs-reply = 10\n              go to invoice-eof.\n*>\n     if       ih-test not = zero             *> Invoice Headers only\n              go to read-invoice.\n     if       ih-status = \"Z\"                *> Dont want applied transactions\n              go to read-invoice.\n     if       ih-type = 1 or 4               *> Dont want receipts or Proformas\n              go to read-invoice.            *> so, processing invoices, cr. notes\n*>\n     move     ih-invoice  to work-invoice.\n     move     ih-customer to work-customer.\n     add      ih-net ih-extra ih-carriage ih-discount ih-vat\n              ih-c-vat ih-e-vat ih-deduct-amt ih-deduct-vat giving work-amount.\n*>\n     if       ih-type = 3\n              multiply -1 by work-amount.         *> make cr. note  total, negative\n*>\n     write    work-record.\n     if       fs-reply not = zero\n              display SL111     at line ws-lines col 01 with foreground-color 4\n                display fs-reply at line ws-lines col 55\n               accept s1 at line ws-lines col 57 with foreground-color 6\n              close work-file       *> invoice-file\n              perform  Invoice-Close\n              go to menu-exit.\n*>\n     add      1 to a.\n     if       a > 9\n              move zero to a\n              add  1 to cole\n              display \".\" at curs with foreground-color 2.  *> Giving a progress bar as '.' in 10's of records, not really needed!\n     if       cole > 79\n              add 1 to lin\n              move zero to cole.\n*>\n     go       to read-invoice.\n*>\n invoice-eof.\n*>\n     perform  Invoice-Close.\n     close    work-file.\n*>\n eof-test.\n*>\n     if       lin = 14 and cole = zero and a = zero\n              display SL117  at 1801 with foreground-color 2\n     else\n              move \"Y\" to work-file-data\n              display SL118  at 1801 with foreground-color 2.\n*>\n main004-exit.\n     exit     section.\n*>\n get-unposted  section.\n*>====================\n*>\n     if       work-file-data = \"N\"\n              go to main005-finish.\n*>\n read-work.\n*>\n     read     work-file next record at end\n              go to main005-finish.\n     if       fs-reply not = zero\n              go to main005-finish.\n     if       customer-in not = work-customer\n              go to main005-finish.\n     add      work-amount to inv-amount.\n     go       to read-work.\n*>\n main005-finish.\n*>\n     move     inv-amount to l4-unposted.\n*>\n main005-exit.\n     exit     section.\n*>\n set-query-flag section.\n*>======================\n*>\n     move     zeros to ws-tinv.\n     display  \"For Account:        . Give invoice no. to toggle [        ]\" at line ws-23-lines col 1 with foreground-color 2.\n     display  customer-in at line ws-23-lines col 14 with foreground-color 3.\n*>\n accept006.\n*>\n     accept   ws-tinv at line ws-23-lines col 51 with foreground-color 3.\n     if       ws-tinv = zero\n              go to main006-exit.\n*>\n     display  \" \" at line ws-23-lines col 01 with erase eol.\n     perform  OTM3-Close.\n*>\n open006.\n*>\n     perform  OTM3-Open.\n     if       fs-reply not = zero\n              display SL112 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     move     customer-in to OI-customer.\n     move     ws-tinv to OI-invoice.\n     perform  OTM3-Read-Indexed.\n     if       fs-reply = 21\n              display SL113 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     if       OI-invoice not = ws-tinv\n       or     OI-customer not = customer-in\n              display SL114 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n *>     move     open-item-record-3 to oi-header.\n     if       oi-hold-flag = space\n              move \"Q\" to oi-hold-flag\n     else\n              move space to oi-hold-flag.\n*>\n     perform  OTM3-Rewrite.   *> rewrite  open-item-record-3 from oi-header invalid key\n     if       fs-reply = 21 or = 22\n          or  we-Error = 994\n              display SL115 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     go       to finish006.\n*>\n error006.\n*>\n     display  SL116 at line ws-lines col 1 with foreground-color 2 erase eol.\n     accept   s1 at line ws-lines col 34\n     display  \" \" at line ws-23-lines col 1 with erase eos.\n*>\n finish006.\n*>\n     perform  OTM3-Close.\n     perform  OTM3-Open-Input.\n*>\n main006-exit.\n     exit     section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 102
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 5,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 105,
      "totalOperators": 84,
      "totalOperands": 168,
      "vocabulary": 106,
      "length": 252,
      "volume": 1695.435954549926
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
