{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/stock/st020.cbl",
  "fileName": "st020.cbl",
  "timestamp": "2025-09-15T16:25:49.597Z",
  "programId": "st020",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 209
      },
      {
        "name": "file",
        "line": 222
      },
      {
        "name": "working-storage",
        "line": 230
      },
      {
        "name": "linkage",
        "line": 479
      },
      {
        "name": "aa000-Core",
        "line": 493
      },
      {
        "name": "ba000-Process-Manual-Additions",
        "line": 788
      },
      {
        "name": "exit",
        "line": 1129
      },
      {
        "name": "ca000-Process-Manual-Deductions",
        "line": 1131
      },
      {
        "name": "exit",
        "line": 1323
      },
      {
        "name": "da000-Process-Barcode-Additions",
        "line": 1325
      },
      {
        "name": "exit",
        "line": 1716
      },
      {
        "name": "ea000-Process-End-of-Month",
        "line": 1718
      },
      {
        "name": "exit",
        "line": 1765
      },
      {
        "name": "ea100-Print-Additions",
        "line": 1767
      },
      {
        "name": "exit",
        "line": 1843
      },
      {
        "name": "ea200-Print-Deductions",
        "line": 1845
      },
      {
        "name": "exit",
        "line": 1931
      },
      {
        "name": "fa000-Process-Orders",
        "line": 1933
      },
      {
        "name": "exit",
        "line": 2138
      },
      {
        "name": "zz010-Print-Heads",
        "line": 2140
      },
      {
        "name": "Exit",
        "line": 2174
      },
      {
        "name": "zz050-Validate-Date",
        "line": 2176
      },
      {
        "name": "exit",
        "line": 2209
      },
      {
        "name": "zz060-Convert-Date",
        "line": 2211
      },
      {
        "name": "exit",
        "line": 2244
      },
      {
        "name": "zz070-Convert-Date",
        "line": 2246
      },
      {
        "name": "exit",
        "line": 2274
      },
      {
        "name": "zz100-test-escape",
        "line": 2276
      },
      {
        "name": "exit",
        "line": 2290
      },
      {
        "name": "zz200-comm-routines",
        "line": 2292
      },
      {
        "name": "exit",
        "line": 2334
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 212
      },
      {
        "name": "file-defs",
        "line": 490
      },
      {
        "name": "File-Info",
        "line": 527
      },
      {
        "name": "end-if",
        "line": 543
      },
      {
        "name": "aa010-Display-Headings",
        "line": 574
      },
      {
        "name": "aa020-DH-End",
        "line": 594
      },
      {
        "name": "aa030-Display-Head-Add",
        "line": 605
      },
      {
        "name": "aa040-Display-Head-Del",
        "line": 611
      },
      {
        "name": "aa050-Display-Head-Barcode-Add",
        "line": 617
      },
      {
        "name": "aa060-Display-Head-EOM",
        "line": 623
      },
      {
        "name": "aa070-Display-Head-Menu",
        "line": 629
      },
      {
        "name": "aa080-Display-Head-Order",
        "line": 635
      },
      {
        "name": "aa100-Main-Menu",
        "line": 641
      },
      {
        "name": "aa107-Main-Menu-Start",
        "line": 660
      },
      {
        "name": "aa110-Accept-Loop",
        "line": 671
      },
      {
        "name": "aa120-Bypass-Accept-1",
        "line": 682
      },
      {
        "name": "end-if",
        "line": 702
      },
      {
        "name": "maps04",
        "line": 778
      },
      {
        "name": "aa999-Exit",
        "line": 781
      },
      {
        "name": "goback",
        "line": 782
      },
      {
        "name": "ba005-New-Heads",
        "line": 791
      },
      {
        "name": "ba010-Accept-Data1",
        "line": 811
      },
      {
        "name": "ba020-Accept-Qty",
        "line": 865
      },
      {
        "name": "ba030-Accept-Price",
        "line": 913
      },
      {
        "name": "ba040-Setup-Print-Transaction",
        "line": 1007
      },
      {
        "name": "end-if",
        "line": 1124
      },
      {
        "name": "ba999-Exit",
        "line": 1128
      },
      {
        "name": "ca010-Accept-Data1",
        "line": 1149
      },
      {
        "name": "ca020-Accept-Qty",
        "line": 1198
      },
      {
        "name": "ca040-Setup-Print-Transaction",
        "line": 1288
      },
      {
        "name": "ca999-Exit",
        "line": 1322
      },
      {
        "name": "da010-Accept-Data1",
        "line": 1383
      },
      {
        "name": "WS-unit6",
        "line": 1426
      },
      {
        "name": "WS-price",
        "line": 1432
      },
      {
        "name": "da020-Accept-Qty",
        "line": 1442
      },
      {
        "name": "da030-Accept-Price",
        "line": 1490
      },
      {
        "name": "da040-Setup-Print-Transaction",
        "line": 1598
      },
      {
        "name": "end-if",
        "line": 1711
      },
      {
        "name": "da999-Exit",
        "line": 1715
      },
      {
        "name": "ea010-Accept-Delete",
        "line": 1740
      },
      {
        "name": "ea020-Bypass-Displays",
        "line": 1756
      },
      {
        "name": "ea999-Exit",
        "line": 1764
      },
      {
        "name": "ea110-Read-Record",
        "line": 1782
      },
      {
        "name": "ea120-Totals",
        "line": 1813
      },
      {
        "name": "ea199-Exit",
        "line": 1842
      },
      {
        "name": "ea210-Read-Record",
        "line": 1869
      },
      {
        "name": "ea220-Totals",
        "line": 1901
      },
      {
        "name": "ea299-Exit",
        "line": 1930
      },
      {
        "name": "fa010-Accept-Data1",
        "line": 1961
      },
      {
        "name": "fa020-Accept-Qty",
        "line": 2015
      },
      {
        "name": "end-if",
        "line": 2051
      },
      {
        "name": "fa030-Accept-Date-Ord",
        "line": 2053
      },
      {
        "name": "fa040-Accept-Date-Due",
        "line": 2068
      },
      {
        "name": "fa050-Accept-B-ord",
        "line": 2086
      },
      {
        "name": "fa060-Setup-Print-Transaction",
        "line": 2100
      },
      {
        "name": "fa999-Exit",
        "line": 2137
      },
      {
        "name": "zz010-Exit",
        "line": 2173
      },
      {
        "name": "zz050-test-date",
        "line": 2203
      },
      {
        "name": "zz050-exit",
        "line": 2208
      },
      {
        "name": "zz060-Exit",
        "line": 2243
      },
      {
        "name": "zz070-Exit",
        "line": 2273
      },
      {
        "name": "zz100-get-escape",
        "line": 2281
      },
      {
        "name": "zz100-exit",
        "line": 2289
      },
      {
        "name": "zz200-accept-money6a",
        "line": 2295
      },
      {
        "name": "zz200-accept-money6b",
        "line": 2298
      },
      {
        "name": "zz200-accept-money6c",
        "line": 2306
      },
      {
        "name": "zz200-accept-money8a",
        "line": 2314
      },
      {
        "name": "zz200-accept-money8b",
        "line": 2317
      },
      {
        "name": "zz200-accept-money8c",
        "line": 2325
      },
      {
        "name": "zz200-comm-exit",
        "line": 2333
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 512,
        "type": "DYNAMIC",
        "using": [
          "File-11",
          "*>",
          "Stock",
          "file",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "ST219",
          "at",
          "line",
          "WS-23-lines",
          "col",
          "1",
          "with",
          "foreground-color",
          "4",
          "highlight",
          "display",
          "ST003",
          "at",
          "line",
          "WS-lines",
          "col",
          "01",
          "accept",
          "WS-reply",
          "at",
          "line",
          "WS-lines",
          "col",
          "30",
          "go",
          "to",
          "aa999-Exit",
          "end-if",
          "end-if",
          "*>",
          "*>",
          "New",
          "for",
          "BO",
          "processing",
          "20/03/24",
          "*>",
          "move",
          "SL-BO-Flag",
          "to",
          "WS-SL-BO-Flag"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 526,
        "type": "DYNAMIC",
        "using": [
          "File-31",
          "*>",
          "Currently,",
          "only",
          "file",
          "is",
          "used",
          "File-Info"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 687,
        "type": "DYNAMIC",
        "using": [
          "File-10",
          "*>",
          "Audit",
          "file",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "and",
          "Stk-Audit-Used",
          "=",
          "1",
          "perform",
          "Stock-Audit-Open-Output",
          "perform",
          "Stock-Audit-Close",
          "end-if",
          "end-if",
          "*>",
          "if",
          "Stk-Audit-Used",
          "=",
          "1",
          "if",
          "(Menu-Reply",
          ">",
          "zero",
          "and",
          "<",
          "5)",
          "perform",
          "Stock-Audit-Open-Extend",
          "else",
          "perform",
          "Stock-Audit-Open-Input",
          "end-if"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 723,
        "type": "DYNAMIC",
        "using": [
          "Print-Report",
          "end-if",
          "else",
          "if",
          "Menu-Reply",
          "=",
          "2",
          "move",
          "\"Stock",
          "Deduction",
          "Report\"",
          "to",
          "l1-Title",
          "move",
          "spaces",
          "to",
          "l3-Dates-Lit",
          "l3-Price-Lit",
          "l2-Batch",
          "move",
          "\"Proc"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 735,
        "type": "DYNAMIC",
        "using": [
          "Print-Report",
          "end-if",
          "else",
          "if",
          "Menu-Reply",
          "=",
          "3",
          "*>",
          "use",
          "Barcode",
          "reader",
          "data",
          "to",
          "update",
          "stock",
          "&",
          "audit",
          "move",
          "spaces",
          "to",
          "l2-Batch",
          "open",
          "output",
          "Print-File",
          "perform",
          "da000-Process-Barcode-Additions",
          "*>",
          "this",
          "process",
          "need",
          "to",
          "be",
          "moded",
          "to",
          "match",
          "your",
          "kit",
          "close",
          "Print-File",
          "if",
          "Page-Nos",
          "not",
          "=",
          "zero",
          "call",
          "\"SYSTEM\"",
          "using",
          "Print-Report",
          "end-if",
          "else",
          "if",
          "Menu-Reply",
          "=",
          "4",
          "move",
          "\"Stock",
          "Orders",
          "Update\"",
          "to",
          "l1-Title",
          "move",
          "\"Order",
          "Date",
          "Date",
          "Due\"",
          "to",
          "l3-Dates-Lit",
          "move",
          "\"B'Qty\"",
          "to",
          "l3-Price-Lit",
          "move",
          "spaces",
          "to",
          "l3-Stock-Lit",
          "l3-Proc-Lit",
          "move",
          "spaces",
          "to",
          "l2-Batch",
          "line-4",
          "open",
          "output",
          "Print-File",
          "perform",
          "fa000-Process-Orders",
          "close",
          "Print-File",
          "if",
          "Page-Nos",
          "not",
          "=",
          "zero",
          "call",
          "\"SYSTEM\"",
          "using",
          "Print-Report",
          "end-if",
          "else",
          "if",
          "Menu-Reply",
          "=",
          "5",
          "and",
          "Stk-Audit-Used",
          "=",
          "1",
          "*>",
          "zero",
          "=",
          "no",
          "audit,",
          "so",
          "report",
          "not",
          "avail",
          "move",
          "Stk-Audit-No",
          "to",
          "WS-z3",
          "string",
          "\"Batch",
          "\"",
          "delimited",
          "by",
          "size",
          "WS-z3",
          "delimited",
          "by",
          "size",
          "into",
          "l2-Batch",
          "perform",
          "ea000-Process-End-of-Month"
        ]
      },
      {
        "target": "maps04",
        "line": 779,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1730,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1735,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 199,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 208,
        "replacing": null
      },
      {
        "name": "selstock",
        "line": 215,
        "replacing": null
      },
      {
        "name": "selaud",
        "line": 216,
        "replacing": null
      },
      {
        "name": "selboitm",
        "line": 217,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 218,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 225,
        "replacing": null
      },
      {
        "name": "fdaudit",
        "line": 226,
        "replacing": null
      },
      {
        "name": "fdboitm",
        "line": 227,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 228,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 234,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 325,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 412,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 413,
        "replacing": null
      },
      {
        "name": "wsaudit",
        "line": 414,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 415,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 416,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 443,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 482,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 483,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 484,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-Param-Get-Rewrite",
        "line": 2336,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2338,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 545
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 554
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 557
      },
      {
        "target": "aa030-Display-Head-Add",
        "thru": null,
        "line": 578
      },
      {
        "target": "aa040-Display-Head-Del",
        "thru": null,
        "line": 581
      },
      {
        "target": "aa050-Display-Head-Barcode-Add",
        "thru": null,
        "line": 584
      },
      {
        "target": "aa060-Display-Head-EOM",
        "thru": null,
        "line": 587
      },
      {
        "target": "aa080-Display-Head-Order",
        "thru": null,
        "line": 590
      },
      {
        "target": "aa070-Display-Head-Menu",
        "thru": null,
        "line": 592
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 608
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 614
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 620
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 626
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 632
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 638
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 657
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 674
      },
      {
        "target": "Stock-Audit-Open-Output",
        "thru": null,
        "line": 692
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 693
      },
      {
        "target": "Stock-Audit-Open-Extend",
        "thru": null,
        "line": 699
      },
      {
        "target": "Stock-Audit-Open-Input",
        "thru": null,
        "line": 701
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 709
      },
      {
        "target": "ba000-Process-Manual-Additions",
        "thru": null,
        "line": 720
      },
      {
        "target": "ca000-Process-Manual-Deductions",
        "thru": null,
        "line": 732
      },
      {
        "target": "da000-Process-Barcode-Additions",
        "thru": null,
        "line": 741
      },
      {
        "target": "fa000-Process-Orders",
        "thru": null,
        "line": 754
      },
      {
        "target": "ea000-Process-End-of-Month",
        "thru": null,
        "line": 766
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 769
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 772
      },
      {
        "target": "aa010-Display-Headings",
        "thru": null,
        "line": 792
      },
      {
        "target": "varying",
        "thru": null,
        "line": 795
      },
      {
        "target": "move",
        "thru": null,
        "line": 808
      },
      {
        "target": "ba005-New-Heads",
        "thru": null,
        "line": 814
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 831
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 840
      },
      {
        "target": "zz200-accept-money6a",
        "thru": "zz200-accept-money6b",
        "line": 915
      },
      {
        "target": "zz200-accept-money8c",
        "thru": null,
        "line": 955
      },
      {
        "target": "zz900-Read-System-Param",
        "thru": null,
        "line": 972
      },
      {
        "target": "zz910-Rewrite-System-Param",
        "thru": null,
        "line": 974
      },
      {
        "target": "Stock-Audit-Write",
        "thru": null,
        "line": 976
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1021
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1026
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1033
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1060
      },
      {
        "target": "Stock-Rewrite",
        "thru": null,
        "line": 1070
      },
      {
        "target": "until",
        "thru": null,
        "line": 1093
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1095
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1098
      },
      {
        "target": "but",
        "thru": null,
        "line": 1098
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1101
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1119
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1121
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1123
      },
      {
        "target": "aa010-Display-Headings",
        "thru": null,
        "line": 1134
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1137
      },
      {
        "target": "move",
        "thru": null,
        "line": 1146
      },
      {
        "target": "ca000-Process-Manual-Deductions",
        "thru": null,
        "line": 1152
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1170
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1179
      },
      {
        "target": "zz900-Read-System-Param",
        "thru": null,
        "line": 1267
      },
      {
        "target": "zz910-Rewrite-System-Param",
        "thru": null,
        "line": 1269
      },
      {
        "target": "Stock-Audit-Write",
        "thru": null,
        "line": 1271
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1300
      },
      {
        "target": "Stock-Rewrite",
        "thru": null,
        "line": 1312
      },
      {
        "target": "aa010-Display-Headings",
        "thru": null,
        "line": 1364
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1367
      },
      {
        "target": "move",
        "thru": null,
        "line": 1380
      },
      {
        "target": "da000-Process-Barcode-Additions",
        "thru": null,
        "line": 1386
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1403
      },
      {
        "target": "zz200-accept-money6c",
        "thru": null,
        "line": 1506
      },
      {
        "target": "zz200-accept-money8c",
        "thru": null,
        "line": 1546
      },
      {
        "target": "zz900-Read-System-Param",
        "thru": null,
        "line": 1563
      },
      {
        "target": "zz910-Rewrite-System-Param",
        "thru": null,
        "line": 1565
      },
      {
        "target": "Stock-Audit-Write",
        "thru": null,
        "line": 1567
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1612
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1617
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1624
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1651
      },
      {
        "target": "Stock-Rewrite",
        "thru": null,
        "line": 1661
      },
      {
        "target": "until",
        "thru": null,
        "line": 1683
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1685
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1688
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1691
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1706
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1708
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1710
      },
      {
        "target": "ea100-Print-Additions",
        "thru": null,
        "line": 1727
      },
      {
        "target": "ea200-Print-Deductions",
        "thru": null,
        "line": 1732
      },
      {
        "target": "zz900-Read-System-Param",
        "thru": null,
        "line": 1736
      },
      {
        "target": "zz910-Rewrite-System-Param",
        "thru": null,
        "line": 1738
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 1757
      },
      {
        "target": "Stock-Audit-Open-Output",
        "thru": null,
        "line": 1758
      },
      {
        "target": "zz900-Read-System-Param",
        "thru": null,
        "line": 1759
      },
      {
        "target": "zz910-Rewrite-System-Param",
        "thru": null,
        "line": 1762
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 1770
      },
      {
        "target": "Stock-Audit-Open-Input",
        "thru": null,
        "line": 1771
      },
      {
        "target": "Stock-Audit-Read-Next",
        "thru": null,
        "line": 1783
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1808
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1815
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 1848
      },
      {
        "target": "Stock-Audit-Open-Input",
        "thru": null,
        "line": 1849
      },
      {
        "target": "Stock-Audit-Read-Next",
        "thru": null,
        "line": 1870
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1896
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 1903
      },
      {
        "target": "aa010-Display-Headings",
        "thru": null,
        "line": 1942
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1945
      },
      {
        "target": "move",
        "thru": null,
        "line": 1958
      },
      {
        "target": "fa000-Process-Orders",
        "thru": null,
        "line": 1964
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1981
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1990
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2040
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2047
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 2058
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 2073
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2112
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2117
      },
      {
        "target": "zz010-Print-Heads",
        "thru": null,
        "line": 2121
      },
      {
        "target": "Stock-Rewrite",
        "thru": null,
        "line": 2127
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 2149
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2206
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2220
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines",
        "line": 498
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 507
      },
      {
        "from": "SL-BO-Flag",
        "to": "WS-SL-BO-Flag",
        "line": 525
      },
      {
        "from": "\"N\"",
        "to": "WS-SL-BO-Flag\n                             WS-BO-File-Open",
        "line": 529
      },
      {
        "from": "\"N\"",
        "to": "WS-BO-File-Open\n                    go to aa999-Exit\n              else\n                    move  \"Y\" to WS-BO-File-Open\n              end-if\n     end-if",
        "line": 538
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 556
      },
      {
        "from": "WS-Date",
        "to": "WS-Proc-Date",
        "line": 558
      },
      {
        "from": "\"Quarter\"",
        "to": "WS-Current-Period\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"Week\" to WS-Current-Period\n      else\n              move \"Month\" to WS-Current-Period",
        "line": 563
      },
      {
        "from": "zero",
        "to": "WS-Audit-Count Page-Nos",
        "line": 575
      },
      {
        "from": "99",
        "to": "Line-Cnt",
        "line": 576
      },
      {
        "from": "WS-Month",
        "to": "WS-Proc-Month",
        "line": 595
      },
      {
        "from": "5",
        "to": "Menu-Reply\n              go to aa120-Bypass-Accept-1\n      else\n              move    8 to WS-Term-Code                   *> Abort process\n              perform Stock-Close                         *> stock file\n              go to aa999-Exit",
        "line": 653
      },
      {
        "from": "\"Price\"",
        "to": "l3-Price-Lit\n              move  \"    Stock Value    \" to l3-Stock-Lit\n              move spaces to l2-Batch\n              open output Print-File\n              perform  ba000-Process-Manual-Additions\n              close Print-File\n              if  Page-Nos not = zero\n                  call  \"SYSTEM\" using Print-Report\n              end-if\n     else\n      if      Menu-Reply = 2\n              move  \"Stock Deduction Report\" to l1-Title\n              move  spaces                   to l3-Dates-Lit  l3-Price-Lit l2-Batch\n              move  \"Proc",
        "line": 716
      },
      {
        "from": "spaces",
        "to": "l2-Batch\n              open output Print-File\n              perform  da000-Process-Barcode-Additions     *> this process need to be moded to match your kit\n              close Print-File\n              if    Page-Nos not = zero\n                    call  \"SYSTEM\" using Print-Report\n              end-if\n       else\n        if    Menu-Reply = 4\n              move  \"Stock Orders Update\" to l1-Title\n              move  \"Order Date    Date Due\" to l3-Dates-Lit\n              move  \"B'Qty\" to l3-Price-Lit\n              move  spaces to l3-Stock-Lit l3-Proc-Lit\n              move  spaces to l2-Batch line-4\n              open  output Print-File\n              perform fa000-Process-Orders\n              close Print-File\n              if   Page-Nos not = zero\n                   call  \"SYSTEM\" using Print-Report\n              end-if\n        else\n         if   Menu-Reply = 5\n          and Stk-Audit-Used = 1        *> zero = no audit, so report not avail\n              move Stk-Audit-No to WS-z3\n              string  \"Batch \"   delimited by size\n                      WS-z3      delimited by size\n                      into l2-Batch\n              perform  ea000-Process-End-of-Month",
        "line": 739
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 775
      },
      {
        "from": "1",
        "to": "cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"[         ]\"   at curs with foreground-color 2\n              move    58 to cole\n              display \"{      }\"      at curs with foreground-color 2\n              move    67 to cole\n              display \"[           ]\" at curs with foreground-color 2\n     end-perform\n     move     4 to i",
        "line": 796
      },
      {
        "from": "spaces",
        "to": "WSD-Stock-Key",
        "line": 816
      },
      {
        "from": "2",
        "to": "cole",
        "line": 818
      },
      {
        "from": "i",
        "to": "lin",
        "line": 819
      },
      {
        "from": "WSD-Abrev-Stock",
        "to": "WS-Stock-Abrev-Key\n              move     2 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if       FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                       display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       subtract 1 from i\n                       go to ba010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move     1 to File-Key-No\n              perform  Stock-Read-Indexed\n              if       FS-Reply = 23 or = 21\n                       display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       subtract 1 from i\n                       go to ba010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole",
        "line": 829
      },
      {
        "from": "Stock-On-Order",
        "to": "WS-unit6",
        "line": 866
      },
      {
        "from": "space",
        "to": "WS-sign6",
        "line": 867
      },
      {
        "from": "39",
        "to": "cole",
        "line": 868
      },
      {
        "from": "17",
        "to": "cole\n              display WS-spaces-20 at curs\n              go to ba010-Accept-Data1",
        "line": 875
      },
      {
        "from": "WS-unit6",
        "to": "WS-qty",
        "line": 892
      },
      {
        "from": "zero",
        "to": "Stock-Pre-Sales\n     else\n              subtract WS-Qty from Stock-Pre-Sales",
        "line": 894
      },
      {
        "from": "1",
        "to": "Audit-Reverse-Transaction\n              multiply -1 by WS-qty",
        "line": 899
      },
      {
        "from": "48",
        "to": "cole",
        "line": 914
      },
      {
        "from": "amt-ok6",
        "to": "WS-price",
        "line": 918
      },
      {
        "from": "1",
        "to": "Audit-Type         *> Additions\n              move     WS-Stock-Key  to Audit-Stock-Key\n              move     WS-Stock-Desc to Audit-Desc\n              move     WS-qty        to Audit-Transaction-Qty\n              move     WS-price      to Audit-Unit-Cost\n     end-if\n     move     WS-price to Stock-Last-Actual-Cost",
        "line": 923
      },
      {
        "from": "zero",
        "to": "WS-Old-Value",
        "line": 934
      },
      {
        "from": "WS-Value",
        "to": "Audit-Stock-Value-Change",
        "line": 938
      },
      {
        "from": "99999999.99",
        "to": "WS-New-Value",
        "line": 941
      },
      {
        "from": "WS-New-Qty",
        "to": "WS-z6",
        "line": 946
      },
      {
        "from": "59",
        "to": "cole",
        "line": 947
      },
      {
        "from": "68",
        "to": "cole\n              move WS-new-value to amt-ok8\n              perform zz200-accept-money8c\n              if    amt-ok8 not = zero\n                    move amt-ok8 to WS-new-value",
        "line": 953
      },
      {
        "from": "67",
        "to": "cole\n              display \"{           }\" at curs with foreground-color 2\n              add 1 to cole\n              move WS-new-value  to amt-ok8\n              move amt-wk-pds8   to WS-pound8\n              move amt-wk-pence8 to WS-pence8\n              display WS-amount-screen-display8 at curs with foreground-color 3",
        "line": 962
      },
      {
        "from": "Stk-Audit-No",
        "to": "Audit-No\n              perform  zz900-Read-System-Param  *> 05/01/25\n              move     zero      to Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to ba999-Exit",
        "line": 971
      },
      {
        "from": "zero",
        "to": "Stock-On-Order",
        "line": 993
      },
      {
        "from": "zero",
        "to": "Stock-Back-Ordered",
        "line": 996
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 1011
      },
      {
        "from": "WS-Proc-Date",
        "to": "l4-Proc-Date",
        "line": 1012
      },
      {
        "from": "WS-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 1013
      },
      {
        "from": "WS-Stock-Desc",
        "to": "l4-Desc",
        "line": 1014
      },
      {
        "from": "WS-Qty",
        "to": "l4-Qty",
        "line": 1015
      },
      {
        "from": "WS-Price",
        "to": "l4-Cost",
        "line": 1016
      },
      {
        "from": "WS-Value",
        "to": "l4-New-Value",
        "line": 1017
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 1019
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin",
        "line": 1020
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Ordered",
        "line": 1022
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 1024
      },
      {
        "from": "Stock-Order-Due",
        "to": "u-bin",
        "line": 1025
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Due",
        "line": 1027
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 1031
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1032
      },
      {
        "from": "spaces",
        "to": "l4-Lit-Late",
        "line": 1042
      },
      {
        "from": "WS-Days-Late",
        "to": "l4-Days-Late\n                  move \" Days Late\" to l4-Lit-Late\n              else\n               if WS-Days-Late < zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Early\" to l4-Lit-Late",
        "line": 1046
      },
      {
        "from": "zero",
        "to": "Stock-Order-Date Stock-Order-Due",
        "line": 1057
      },
      {
        "from": "WS-New-Value",
        "to": "Stock-Value",
        "line": 1066
      },
      {
        "from": "WS-New-Qty",
        "to": "Stock-Held",
        "line": 1067
      },
      {
        "from": "WS-New-Cost",
        "to": "Stock-Cost",
        "line": 1068
      },
      {
        "from": "U-Bin",
        "to": "Stock-Arrived-Date",
        "line": 1069
      },
      {
        "from": "\"Y\"",
        "to": "WS-BO-Can-Be-Used  *> Testing use WS-BO-Usable (Y)\n              move     WS-Stock-Key to BO-Stk-Item-No\n              start    BO-Stk-Itm-File  key = BO-Stk-Item-No\n              if       FS-Reply not = zeros      *> No such item so process done\n                       go to ba010-Accept-Data1\n              end-if\n              move     Stock-Held to WS-Temp-Stock-Held *> don't process if out of stock now based on BO recs\n              perform  until exit\n                       read     BO-Stk-Itm-File NEXT at end\n                                exit perform\n                       end-read\n                       if       BO-Stk-Item-No not = WS-Stock-Key\n                                exit perform cycle  *> JIC out of stk # order MAY BE SHOULD BE exit perform but JIC\n                       end-if\n                       if       FS-Reply not = zeros  *> no more recs\n                                exit perform\n                       end-if\n*>\n*> valid record but only update BO recs if still have stock - at least on paper :)\n*> as stock received might be less than all BO requirements at this time\n*>\n                       if       WS-Temp-Stock-Held not < BO-Stk-BO-Qty\n                          and   WS-Temp-Stock-Held not = zero\n                                move     \"Y\"   to BO-Stk-Arrived-Flag\n                                move     U-Bin to BO-Stk-BO-Arr-Date\n                                subtract BO-Stk-BO-Qty from WS-Temp-Stock-Held\n                                rewrite  BO-Stk-Itm-Record\n                                if       FS-Reply not = zero\n                                         display  ST221 at line WS-23-Lines col 10\n                                                   with foreground-color 4 highlight beep erase eos\n                                         display  ST006 at line WS-Lines    col 1\n                                                   with foreground-color 2 highlight\n                                         accept   WS-Reply at line WS-Lines col 32\n                                         exit perform\n                                end-if\n                                exit perform cycle\n                       end-if  *> out of stock so cannot proc any more BO recs of same stk #\n              end-perform\n     end-if",
        "line": 1086
      },
      {
        "from": "1",
        "to": "cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"{      }\"      at curs with foreground-color 2\n     end-perform\n     move     4 to i",
        "line": 1138
      },
      {
        "from": "spaces",
        "to": "WSD-Stock-Key",
        "line": 1153
      },
      {
        "from": "2",
        "to": "cole",
        "line": 1155
      },
      {
        "from": "i",
        "to": "lin",
        "line": 1156
      },
      {
        "from": "WSD-Abrev-Stock",
        "to": "WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to ca010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move   1 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to ca010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole",
        "line": 1168
      },
      {
        "from": "48",
        "to": "cole",
        "line": 1191
      },
      {
        "from": "zero",
        "to": "WS-unit6",
        "line": 1199
      },
      {
        "from": "space",
        "to": "WS-sign6\n     move     39 to cole",
        "line": 1200
      },
      {
        "from": "17",
        "to": "cole\n              display WS-spaces-20 at curs\n              go to ca010-Accept-Data1",
        "line": 1208
      },
      {
        "from": "WS-unit6",
        "to": "WS-qty",
        "line": 1222
      },
      {
        "from": "1",
        "to": "Audit-Reverse-Transaction\n              multiply -1 by WS-qty\n              if  (ws-unit6 + Stock-Held) > 999999\n                  display ST205 at line WS-23-lines col 1 with foreground-color 4 highlight\n                  go to ca020-Accept-Qty",
        "line": 1224
      },
      {
        "from": "48",
        "to": "cole",
        "line": 1251
      },
      {
        "from": "WS-New-Qty",
        "to": "WS-Z6",
        "line": 1253
      },
      {
        "from": "2",
        "to": "Audit-Type",
        "line": 1258
      },
      {
        "from": "WS-Stock-Key",
        "to": "Audit-Stock-Key",
        "line": 1259
      },
      {
        "from": "WS-Stock-Desc",
        "to": "Audit-Desc",
        "line": 1260
      },
      {
        "from": "WS-qty",
        "to": "Audit-Transaction-Qty",
        "line": 1261
      },
      {
        "from": "Stock-Cost",
        "to": "Audit-Unit-Cost",
        "line": 1262
      },
      {
        "from": "Stk-Audit-No",
        "to": "Audit-No",
        "line": 1265
      },
      {
        "from": "zero",
        "to": "Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to ca999-Exit",
        "line": 1268
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 1292
      },
      {
        "from": "WS-Proc-Date",
        "to": "l4-Proc-Date",
        "line": 1293
      },
      {
        "from": "WS-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 1294
      },
      {
        "from": "WS-Stock-Desc",
        "to": "l4-Desc",
        "line": 1295
      },
      {
        "from": "WS-Qty",
        "to": "l4-Qty",
        "line": 1296
      },
      {
        "from": "Audit-Stock-Value-Change",
        "to": "l4-New-Value",
        "line": 1297
      },
      {
        "from": "99999999.99",
        "to": "Stock-Value",
        "line": 1310
      },
      {
        "from": "1",
        "to": "cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"[         ]\"   at curs with foreground-color 2\n              move    58 to cole\n              display \"{      }\"      at curs with foreground-color 2\n              move    67 to cole\n              display \"[           ]\" at curs with foreground-color 2\n     end-perform\n     move     4 to i",
        "line": 1368
      },
      {
        "from": "spaces",
        "to": "WSD-Stock-Key",
        "line": 1387
      },
      {
        "from": "2",
        "to": "cole",
        "line": 1389
      },
      {
        "from": "i",
        "to": "lin",
        "line": 1390
      },
      {
        "from": "WSD-Stock-Key",
        "to": "WS-Stock-Key\n     move   1 to File-Key-No\n     perform Stock-Read-Indexed\n     if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n            display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n            display \"Missing Stock Record\" at curs with foreground-color 3 highlight blink\n            go to da010-Accept-Data1\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole",
        "line": 1401
      },
      {
        "from": "1",
        "to": "WS-qty\n                   WS-unit6",
        "line": 1425
      },
      {
        "from": "Stock-Last-Actual-Cost",
        "to": "Amt-ok6\n                                              WS-price\n     else\n              move  Stock-Cost  to Amt-ok6\n                                   WS-price",
        "line": 1428
      },
      {
        "from": "39",
        "to": "cole",
        "line": 1434
      },
      {
        "from": "Stock-On-Order",
        "to": "WS-unit6",
        "line": 1443
      },
      {
        "from": "space",
        "to": "WS-sign6",
        "line": 1444
      },
      {
        "from": "39",
        "to": "cole",
        "line": 1445
      },
      {
        "from": "17",
        "to": "cole\n              display WS-spaces-20 at curs\n              go to da010-Accept-Data1",
        "line": 1452
      },
      {
        "from": "WS-unit6",
        "to": "WS-qty",
        "line": 1469
      },
      {
        "from": "zero",
        "to": "Stock-Pre-Sales\n     else\n              subtract WS-Qty from Stock-Pre-Sales",
        "line": 1471
      },
      {
        "from": "1",
        "to": "Audit-Reverse-Transaction\n              multiply -1 by WS-qty",
        "line": 1476
      },
      {
        "from": "zero",
        "to": "WS-Price\n*>??                           WS-Value\n*>??     go       to\n*>\n     move     48 to cole",
        "line": 1496
      },
      {
        "from": "amt-wk-pence6",
        "to": "WS-pence6",
        "line": 1501
      },
      {
        "from": "amt-wk-pds6",
        "to": "WS-pound6",
        "line": 1502
      },
      {
        "from": "amt-ok6",
        "to": "WS-price",
        "line": 1509
      },
      {
        "from": "1",
        "to": "Audit-Type         *> Additions\n              move     WS-Stock-Key to Audit-Stock-Key\n              move     WS-Stock-Desc to Audit-Desc\n              move     WS-qty to Audit-Transaction-Qty\n              move     WS-price to Audit-Unit-Cost\n     end-if\n     move     WS-price to Stock-Last-Actual-Cost",
        "line": 1514
      },
      {
        "from": "zero",
        "to": "WS-Old-Value",
        "line": 1525
      },
      {
        "from": "WS-Value",
        "to": "Audit-Stock-Value-Change",
        "line": 1529
      },
      {
        "from": "99999999.99",
        "to": "WS-New-Value",
        "line": 1532
      },
      {
        "from": "WS-New-Qty",
        "to": "WS-z6",
        "line": 1537
      },
      {
        "from": "59",
        "to": "cole",
        "line": 1538
      },
      {
        "from": "68",
        "to": "cole\n              move WS-new-value to amt-ok8\n              perform zz200-accept-money8c\n              if    amt-ok8 not = zero\n                    move amt-ok8 to WS-new-value",
        "line": 1544
      },
      {
        "from": "67",
        "to": "cole\n              display \"{           }\" at curs with foreground-color 2\n              add 1 to cole\n              move WS-new-value to amt-ok8\n              move amt-wk-pds8   to WS-pound8\n              move amt-wk-pence8 to WS-pence8\n              display WS-amount-screen-display8 at curs with foreground-color 3",
        "line": 1553
      },
      {
        "from": "Stk-Audit-No",
        "to": "Audit-No\n              perform  zz900-Read-System-Param  *> 05/01/25\n              move zero         to Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to da999-Exit",
        "line": 1562
      },
      {
        "from": "zero",
        "to": "Stock-On-Order",
        "line": 1584
      },
      {
        "from": "zero",
        "to": "Stock-Back-Ordered",
        "line": 1587
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 1602
      },
      {
        "from": "WS-Proc-Date",
        "to": "l4-Proc-Date",
        "line": 1603
      },
      {
        "from": "WS-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 1604
      },
      {
        "from": "WS-Stock-Desc",
        "to": "l4-Desc",
        "line": 1605
      },
      {
        "from": "WS-Qty",
        "to": "l4-Qty",
        "line": 1606
      },
      {
        "from": "WS-Price",
        "to": "l4-Cost",
        "line": 1607
      },
      {
        "from": "WS-Value",
        "to": "l4-New-Value",
        "line": 1608
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 1610
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin",
        "line": 1611
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Ordered",
        "line": 1613
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 1615
      },
      {
        "from": "Stock-Order-Due",
        "to": "u-bin",
        "line": 1616
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Due",
        "line": 1618
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 1622
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1623
      },
      {
        "from": "spaces",
        "to": "l4-Lit-Late",
        "line": 1633
      },
      {
        "from": "WS-Days-Late",
        "to": "l4-Days-Late\n                  move \" Days Late\" to l4-Lit-Late\n              else\n               if WS-Days-Late < zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Early\" to l4-Lit-Late",
        "line": 1637
      },
      {
        "from": "zero",
        "to": "Stock-Order-Date Stock-Order-Due",
        "line": 1648
      },
      {
        "from": "WS-New-Value",
        "to": "Stock-Value",
        "line": 1657
      },
      {
        "from": "WS-New-Qty",
        "to": "Stock-Held",
        "line": 1658
      },
      {
        "from": "WS-New-Cost",
        "to": "Stock-Cost",
        "line": 1659
      },
      {
        "from": "U-Bin",
        "to": "Stock-Arrived-Date",
        "line": 1660
      },
      {
        "from": "\"Y\"",
        "to": "WS-BO-Can-Be-Used  *> Testing use WS-BO-Usable (Y)\n              move  WS-Stock-Key to BO-Stk-Item-No\n              start BO-Stk-Itm-File  key = BO-Stk-Item-No\n              if    FS-Reply not = zeros    *> No such item\n                    go to da010-Accept-Data1\n              end-if\n              move     Stock-Held to WS-Temp-Stock-Held *> don't process if out of stock now based on BO recs\n              perform  until exit\n                       read     BO-Stk-Itm-File NEXT at end\n                                exit perform\n                       end-read\n                       if       BO-Stk-Item-No not = WS-Stock-Key\n                                exit perform cycle  *> JIC out of stk # order\n                       end-if\n                       if       FS-Reply not = zeros\n                                exit perform\n                       end-if\n*> valid record but only update BO recs if still have stock - at least on paper :)\n                       if       WS-Temp-Stock-Held not < BO-Stk-BO-Qty and\n                                WS-Temp-Stock-Held not = zero\n                                move     \"Y\"   to BO-Stk-Arrived-Flag\n                                move     U-Bin to BO-Stk-BO-Arr-Date\n                                subtract BO-Stk-BO-Qty from WS-Temp-Stock-Held\n                                rewrite  BO-Stk-Itm-Record\n                                if       FS-Reply not = zero\n                                         display  ST221 at line WS-23-Lines col 10\n                                                   with foreground-color 4 highlight beep erase eos\n                                         display  ST006 at line WS-Lines    col 1\n                                                   with foreground-color 2 highlight\n                                         accept   WS-Reply at line WS-Lines col 32\n                                         exit perform\n                                end-if\n                                exit perform cycle\n                       end-if  *> out of stock so cannot proc any more BO recs of same stk #\n              end-perform\n     end-if",
        "line": 1676
      },
      {
        "from": "1",
        "to": "Stk-Activity-Rep-Run",
        "line": 1737
      },
      {
        "from": "\"N\"",
        "to": "WS-Reply",
        "line": 1743
      },
      {
        "from": "1",
        "to": "Stk-Audit-No",
        "line": 1761
      },
      {
        "from": "zero",
        "to": "Page-Nos WS-add-total WS-ded-total",
        "line": 1772
      },
      {
        "from": "99",
        "to": "Line-Cnt",
        "line": 1773
      },
      {
        "from": "\"Price\"",
        "to": "l3-Price-Lit",
        "line": 1776
      },
      {
        "from": "spaces",
        "to": "l3-Dates-Lit",
        "line": 1778
      },
      {
        "from": "\"Source/PO.no.\"",
        "to": "l3-Dates-Lit",
        "line": 1779
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 1780
      },
      {
        "from": "Audit-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 1794
      },
      {
        "from": "Audit-Desc",
        "to": "l4-Desc",
        "line": 1795
      },
      {
        "from": "Audit-Transaction-Qty",
        "to": "l4-Qty",
        "line": 1796
      },
      {
        "from": "Audit-Unit-Cost",
        "to": "l4-Cost",
        "line": 1797
      },
      {
        "from": "Audit-Stock-Value-Change",
        "to": "l4-New-Value",
        "line": 1798
      },
      {
        "from": "Audit-Process-Date",
        "to": "l4-Proc-Date",
        "line": 1799
      },
      {
        "from": "spaces",
        "to": "l4-Source",
        "line": 1801
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1816
      },
      {
        "from": "WS-Add-Total",
        "to": "WS-Total",
        "line": 1817
      },
      {
        "from": "56",
        "to": "a",
        "line": 1818
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1822
      },
      {
        "from": "WS-Ded-Total",
        "to": "WS-Total",
        "line": 1823
      },
      {
        "from": "56",
        "to": "a",
        "line": 1824
      },
      {
        "from": "spaces",
        "to": "Print-Record (56:35)",
        "line": 1828
      },
      {
        "from": "75",
        "to": "a",
        "line": 1829
      },
      {
        "from": "56",
        "to": "a",
        "line": 1833
      },
      {
        "from": "spaces",
        "to": "Print-Record (56:35)",
        "line": 1837
      },
      {
        "from": "75",
        "to": "a",
        "line": 1838
      },
      {
        "from": "spaces",
        "to": "Print-Record\n              write    Print-Record before page",
        "line": 1856
      },
      {
        "from": "zero",
        "to": "Page-Nos",
        "line": 1859
      },
      {
        "from": "99",
        "to": "Line-Cnt",
        "line": 1860
      },
      {
        "from": "spaces",
        "to": "l3-Dates-Lit",
        "line": 1864
      },
      {
        "from": "spaces",
        "to": "l3-Price-Lit",
        "line": 1865
      },
      {
        "from": "\"Source/Inv.no.\"",
        "to": "l3-Dates-Lit",
        "line": 1866
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 1867
      },
      {
        "from": "Audit-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 1878
      },
      {
        "from": "Audit-Desc",
        "to": "l4-Desc",
        "line": 1879
      },
      {
        "from": "Audit-Transaction-Qty",
        "to": "l4-Qty",
        "line": 1880
      },
      {
        "from": "Audit-Stock-Value-Change",
        "to": "l4-New-Value",
        "line": 1881
      },
      {
        "from": "Audit-Process-Date",
        "to": "l4-Proc-Date",
        "line": 1882
      },
      {
        "from": "spaces",
        "to": "l4-Source",
        "line": 1883
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1904
      },
      {
        "from": "WS-Add-Total",
        "to": "WS-Total",
        "line": 1905
      },
      {
        "from": "56",
        "to": "a",
        "line": 1906
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1910
      },
      {
        "from": "WS-Ded-Total",
        "to": "WS-Total",
        "line": 1911
      },
      {
        "from": "56",
        "to": "a",
        "line": 1912
      },
      {
        "from": "spaces",
        "to": "Print-Record (56:35)",
        "line": 1916
      },
      {
        "from": "75",
        "to": "a",
        "line": 1917
      },
      {
        "from": "56",
        "to": "a",
        "line": 1921
      },
      {
        "from": "75",
        "to": "a",
        "line": 1925
      },
      {
        "from": "spaces",
        "to": "Print-Record (56:35)",
        "line": 1926
      },
      {
        "from": "1",
        "to": "cole\n              display \"[             ]\" at curs with erase eol foreground-color 2 *> stock no",
        "line": 1946
      },
      {
        "from": "16",
        "to": "cole\n              display \"{                    }\" at curs with foreground-color 2 *> desc (disp)\n              move    38 to cole\n              display \"[      ]\"       at curs with foreground-color 2  *> qty ordered\n              move    46 to cole\n              display \"[          ]\"   at curs with foreground-color 2  *> date ordered\n              move    58 to cole\n              display \"[          ]\"   at curs with foreground-color 2  *> date Due\n              move    70 to cole\n              display \"[      ]\"       at curs with foreground-color 2  *> qty B'ord\n     end-perform\n     move     4 to i",
        "line": 1948
      },
      {
        "from": "spaces",
        "to": "WSD-Stock-Key",
        "line": 1965
      },
      {
        "from": "2",
        "to": "cole",
        "line": 1966
      },
      {
        "from": "i",
        "to": "lin",
        "line": 1967
      },
      {
        "from": "WSD-Abrev-Stock",
        "to": "WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21\n                     display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to fa010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move     1 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to fa010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole",
        "line": 1979
      },
      {
        "from": "space",
        "to": "WS-sign6",
        "line": 2011
      },
      {
        "from": "Stock-On-Order",
        "to": "WS-unit6",
        "line": 2016
      },
      {
        "from": "39",
        "to": "cole",
        "line": 2017
      },
      {
        "from": "17",
        "to": "cole\n              display WS-spaces-20 at curs\n              go to fa010-Accept-Data1",
        "line": 2023
      },
      {
        "from": "WS-unit6",
        "to": "Stock-On-Order",
        "line": 2034
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if",
        "line": 2039
      },
      {
        "from": "47",
        "to": "Cole",
        "line": 2054
      },
      {
        "from": "WS-Stock-Order-Date",
        "to": "WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n              else\n                 display ST005 at line WS-23-lines col 1  with foreground-color 4 highlight\n                 display ST250 at line WS-23-lines col 19 with foreground-color 4 highlight\n                 go to fa030-Accept-Date-Ord\n     else\n              move zero to Stock-Order-Date",
        "line": 2057
      },
      {
        "from": "59",
        "to": "Cole",
        "line": 2069
      },
      {
        "from": "WS-Stock-Order-Due",
        "to": "WS-Test-Date\n              perform zz050-Validate-Date\n              if       u-bin not = zero\n                       move u-bin to Stock-Order-Due\n              else\n                       display ST005 at line WS-23-lines col 1  with foreground-color 4 highlight\n                       display ST251 at line WS-23-lines col 19 with foreground-color 4 highlight\n                       go to fa040-Accept-Date-Due\n              end-if        *> 16/08/23 as it looks messy and wrong without it\n     else\n              move zero to Stock-Order-Due",
        "line": 2072
      },
      {
        "from": "Stock-Back-Ordered",
        "to": "WS-unit6",
        "line": 2087
      },
      {
        "from": "71",
        "to": "cole",
        "line": 2088
      },
      {
        "from": "WS-unit6",
        "to": "Stock-Back-Ordered",
        "line": 2098
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 2104
      },
      {
        "from": "WS-Stock-Key",
        "to": "l4-Stock-Number",
        "line": 2105
      },
      {
        "from": "WS-Stock-Desc",
        "to": "l4-Desc",
        "line": 2106
      },
      {
        "from": "Stock-On-Order",
        "to": "l4-Qty",
        "line": 2107
      },
      {
        "from": "Stock-Back-Ordered",
        "to": "l4-Qty-B-ord",
        "line": 2108
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 2110
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin",
        "line": 2111
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Ordered",
        "line": 2113
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 2115
      },
      {
        "from": "Stock-Order-Due",
        "to": "u-bin",
        "line": 2116
      },
      {
        "from": "WS-date",
        "to": "l4-Date-Due",
        "line": 2118
      },
      {
        "from": "prog-name",
        "to": "l1-Program",
        "line": 2145
      },
      {
        "from": "Page-Nos",
        "to": "l1-Page",
        "line": 2147
      },
      {
        "from": "Usera",
        "to": "l2-User",
        "line": 2148
      },
      {
        "from": "WS-date",
        "to": "l2-Date",
        "line": 2150
      },
      {
        "from": "hd-hh",
        "to": "l2-HH\n              move hd-mm to l2-MM",
        "line": 2153
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record from Line-1 before 1\n              write print-record from Line-2 before 1\n     end-if\n     move     6 to Line-Cnt",
        "line": 2158
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 2170
      },
      {
        "from": "WS-test-date",
        "to": "WS-date",
        "line": 2185
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2187
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz050-test-date",
        "line": 2191
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "WS-date",
        "line": 2198
      },
      {
        "from": "WS-date",
        "to": "u-date",
        "line": 2204
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 2205
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 2222
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 2224
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2227
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit",
        "line": 2231
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 2238
      },
      {
        "from": "to-day",
        "to": "WS-date",
        "line": 2254
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2257
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit",
        "line": 2261
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 2268
      },
      {
        "from": "zero",
        "to": "WS-poundsd6 WS-penced6 amt-ok6",
        "line": 2296
      },
      {
        "from": "WS-pound6",
        "to": "amt-wk-pds6",
        "line": 2301
      },
      {
        "from": "WS-pence6",
        "to": "amt-wk-pence6",
        "line": 2302
      },
      {
        "from": "amt-wk-pence6",
        "to": "WS-pence6",
        "line": 2307
      },
      {
        "from": "amt-wk-pds6",
        "to": "WS-pound6",
        "line": 2308
      },
      {
        "from": "WS-pound6",
        "to": "amt-wk-pds6",
        "line": 2311
      },
      {
        "from": "WS-pence6",
        "to": "amt-wk-pence6",
        "line": 2312
      },
      {
        "from": "zero",
        "to": "WS-poundsd8 WS-penced8 amt-ok8",
        "line": 2315
      },
      {
        "from": "WS-pound8",
        "to": "amt-wk-pds8",
        "line": 2320
      },
      {
        "from": "WS-pence8",
        "to": "amt-wk-pence8",
        "line": 2321
      },
      {
        "from": "amt-wk-pence8",
        "to": "WS-pence8",
        "line": 2326
      },
      {
        "from": "amt-wk-pds8",
        "to": "WS-pound8",
        "line": 2327
      },
      {
        "from": "WS-pound8",
        "to": "amt-wk-pds8",
        "line": 2330
      },
      {
        "from": "WS-pence8",
        "to": "amt-wk-pence8",
        "line": 2331
      }
    ],
    "computes": [
      {
        "target": "WS-Old-Value",
        "expression": "(Stock-Held + Stock-Work-in-Progress) * Stock-Cost\n     else\n              move zero to WS-Old-Value",
        "line": 932
      },
      {
        "target": "Audit-Stock-Value-Change",
        "expression": "WS-Qty * Stock-Cost * -1",
        "line": 1263
      },
      {
        "target": "Stock-Value",
        "expression": "(Stock-Held + Stock-Work-in-Progress) * Stock-Cost on size error\n               display ST212 at line WS-23-lines col 1 with foreground-color 4 highlight\n               move 99999999",
        "line": 1308
      },
      {
        "target": "WS-Old-Value",
        "expression": "(Stock-Held + Stock-Work-in-Progress) * Stock-Cost\n     else\n              move zero to WS-Old-Value",
        "line": 1523
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "any, to stock value.\n*> 28/06/09 vbc - .15 Set Stk-Activity-Rep-Run (1) after running reports\n*>                    Also increment batch no when clearing down Audit file.\n*>                    Reset Stk-Audit-No to 1 on size error (max val = 255).\n*> 15/07/09 vbc - .16 Modify menu option 4 subject to value of Stk-Period-Cur.\n*>                    Batch no (Stk-Audit-No) used on proof rep and updated after\n*>                    running end of period rep and clearing down audit file.\n*>                    Amend manuals to reflect s/w changes.\n*> 20/07/09 vbc - .17 Added function 5 to replace existing optional data, ie\n*>                .18 dates ordered & due, quantities on order and backordered.\n*> 19/08/09 vbc - .19 Added Standard and simple barcode processing based on a\n*>                    WASP WLR8900 CCD LR via USB port. should work for any using\n*>                    same port and protocol see code at da000 for more info.\n*> 07/09/10 vbc - .20 Added extra functions for Cups print spool lpr as well as 2 copies etc.\n*> 11/12/11 vbc -     Changed version from 1.00.xx to 3.01.xx, in keeping with the rest of ACAS\n*>                .21 Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 12/05/13 vbc - .22 Changed wsnames to in common as pl010 called in st010.\n*> 13/05/13 vbc - .23 Added time to reports.\n*> 14/05/13 vbc - .24 Commented out WS-month processing at aa020-DH-End in error along with the test!\n*> 15/05/13 vbc - .25 Added processing in audit report for 'source' from invoicing and purchasing\n*>                    in reports.\n*> 16/05/13 vbc - .26 Changed wsnames using copybook and added msg ST219 to replace 201 if SF not created.\n*> 25/05/13 vbc - .27 Added invoice / PO nos to add/ded audit reports with a change of heading & forced\n*>                    Stock Value literal in adds & deducts report in case another report was run 1st\n*>                    restored test for proc-month as YTD looks odd & changed the add statement (misused?)\n*>                    for yearly figures.\n*> 28/05/13 vbc - .28 (see .27) added credit note reporting see ea000.\n*> 04/06/13 vbc - .29 Replaced Stk-Page-Lines with system Page-Lines.\n*> 20/07/16 vbc - .30 Screen layout error when asking to delete audit file.\n*> 21/07/16 vbc - .31 Replace Cobol file acces verbs with calls to FH and RDB\n*>                    DAL. Precede references to Stock-Record, Stock-Key,\n*>                    Stock-Abrev-Key, Stock-Desc by WS- to reflect that we\n*>                    are only dealing with a WS record and the FD is now gone.\n*>                    Stop using File-Status and replace with call to\n*>                    \"CBL_CHECK_FILE_EXIST\" instead. Do same for all such\n*>                    checks, sets etc to kill of usage dates back to floppies.\n*>                    ST011 added. Update version to 3.02.\n*> 26/07/16 vbc - .32 Added FH/DAL for audit file so all files I/O via a F.H.\n*> 24/10/16 vbc - .33 ALL programs now using wsnames.cob in copybooks\n*>                    Usage of maps99 deleted.\n*> 12/03/18 vbc - .34 acasnnn copylib renaming acas000-open etc to comply with\n*>                    rest of ACAS to (System-Open etc) removed unused field\n*>                    WS var. error-code.\n*>                    Chg ST000 to stock rec.\n*> 16/03/18 vbc - .35 Added code for AUTORUN via stock menu which will print reports\n*>                    for both Additions and Deletions and",
        "line": 77
      },
      {
        "type": "IF",
        "condition": "Qty is higher for both manual and barcode input.\n*>                .37 If SL-BO flag = \"Y\"",
        "line": 129
      },
      {
        "type": "IF",
        "condition": "exists will check if there is a\n*>                    item record there and if so, flag it as stock arrived with\n*>                    the date.  This can",
        "line": 132
      },
      {
        "type": "IF",
        "condition": "on 1st\n*>                    report line count > 5 and page no is odd force new page.\n*> 28/04/24 vbc   .42 Chg test in BO stock-held < (WS-temp-) stock-held to\n*>                    WS-Temp-Stock-Held not < BO-Stk-BO-Qty and not = zero\n*> 29/04/24 vbc - .43 In ba010-Accept-Data1 full key should be WS-Stock-Key\n*>                    WS-Days-Late chg s(4) & L4-Days-Late to zzz9 (increase\n*>                    by 1).\n*> 16/12/24 vbc - .44 Changed Page-Lines to WS-Page-Lines set at 56 as system\n*>                    uses portrait - user may need to change this setting.\n*>                    Extra display if WE-Error opening stock file.\n*>                    On Stock-open tests more close to before goto exit.\n*> 05/01/25 vbc   .45 Add read & rewrite param rec when updating status of\n*>                    Stk-Activity-Rep-Run\n*>\n*>\n*>  << TODO >>\n*>                 1. Need to add wip qty * bundle to co-joined stock no.\n*>                    having updated wip qty et al. ?\n*>                 2. Validate code to ensure conformance with updated spec\n*>                    for order and procedure when calc & updating stock values.\n*>\n*>******************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>================================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>-------------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selstock.cob\".\n*> copy \"selaud.cob\".\n copy \"selboitm.cob\".   *> BO item file Does not use FH, DALs\n copy \"selprint.cob\".\n data                    division.\n*>================================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdstock.cob\".\n*> copy \"fdaudit.cob\".\n copy \"fdboitm.cob\".   *> BO item file\n copy \"fdprint.cob\".\n*>\n working-storage section.\n*>-----------------------\n*>\n 77  Prog-Name           pic x(15)       value \"ST020 (3.02.45)\".\n copy \"print-spool-command.cob\".\n 01  WS-Qty-Screen-Display6.\n     03  WS-unit6        pic 9(6).\n     03  WS-sign6        pic x.\n*>\n 01  WS-amount-screen-display6.\n     03  WS-poundsd6     pic 9(6).\n     03  WS-period6      pic x     value \".\".\n     03  WS-penced6      pic v99.\n 01  WS-amount-screen-accept6 redefines WS-amount-screen-display6.\n     03  WS-pound6       pic 9(6).\n     03  filler          pic x.\n     03  WS-pence6       pic v99.\n*>\n 01  WS-amount-work6.\n     03  amt-wk-pds6     pic 9(6).\n     03  amt-wk-pence6   pic v99.\n 01  WS-amount-ok6 redefines WS-amount-work6.\n     03  amt-ok6         pic 9(6)v99.\n*>\n 01  WS-amount-screen-display8.\n     03  WS-poundsd8     pic 9(8).\n     03  WS-period8      pic x     value \".\".\n     03  WS-penced8      pic v99.\n 01  WS-amount-screen-accept8 redefines WS-amount-screen-display8.\n     03  WS-pound8       pic 9(8).\n     03  filler          pic x.\n     03  WS-pence8       pic v99.\n*>\n 01  WS-amount-work8.\n     03  amt-wk-pds8     pic 9(8).\n     03  amt-wk-pence8   pic v99.\n 01  WS-amount-ok8 redefines WS-amount-work8.\n     03  amt-ok8         pic 9(8)v99.\n*>\n 01  work-fields.\n     03  Menu-Reply      pic 9                   value zero.\n     03  WS-Reply        pic x                   value space.\n     03  Escape-Code     pic x                   value space.\n     03  WS-Proc-Month.\n         05  WS-Proc-Mth pic 99                  value zero.\n             88  WS-Good-Month                   values 01 thru 12.\n     03  WS-Proc-Date    pic x(10).\n     03  WS-Current-Period pic x(8).         *> Week, Month Quarter\n     03  WS-Test-Date    pic x(10).\n     03  WS-stock-dates.\n         05  WS-Stock-Order-Date pic x(10).\n         05  WS-Stock-Order-Due  pic x(10).\n     03  WS-Audit-Report-Lit pic x(33)           value spaces.\n     03  WS-Days-Late    pic s9999               value zero.\n     03  WS-Page-Lines   binary-char unsigned value 56.   *> 16/12/24 as system is for Portrait and Landscape used.\n     03  Line-Cnt        binary-char unsigned    value 99.\n     03  Page-Nos        binary-char unsigned    value zero.\n     03  a               binary-char unsigned    value zero.\n     03  i               binary-char unsigned    value zero.\n     03  b               pic s9(7).\n     03  WS-Audit-Count  binary-short unsigned   value zero.\n*>\n     03  WSD-Stock-Key                           value spaces.\n         05  WSD-Abrev-Stock   pic x(7).\n         05  WSD-Stock-No-Long pic x(6).\n*> 20/03/24\n     03  WS-SL-BO-Flag   pic x.\n         88  WS-BO-Used                          value \"Y\".\n     03  WS-BO-Can-Be-Used\n                         pic x.\n         88  WS-BO-Usable                        value \"Y\".\n     03  WS-BO-File-Open pic x                   value \"N\".\n     03  WS-Temp-Stock-Held\n                         pic s9(6)             value zero.\n*>\n     03  WS-z6           pic z(6).\n     03  WS-z3           pic zz9.\n     03  WS-Qty          pic s9(6)               value zero.\n     03  WS-New-Qty      pic s9(6)               value zero.\n     03  WS-Price        pic 9(6)v99     comp-3  value zero.\n     03  WS-Value        pic s9(8)v99    comp-3  value zero.\n     03  WS-Old-Value    pic s9(8)v99    comp-3  value zero.\n     03  WS-New-Value    pic s9(8)v99    comp-3  value zero.\n     03  WS-New-Cost     pic s9(6)v9999  comp-3  value zero.\n     03  WS-Add-Total    pic s9(9)v99    comp-3  value zero.\n     03  WS-Ded-Total    pic s9(9)v99    comp-3  value zero.\n     03  WS-Total        pic zzz,zzz,zz9.99.\n*>\n     03  WS-Spaces-20    pic x(20)               value spaces.\n     03  WS-Env-Lines    pic 999                 value zero.\n     03  WS-Lines        binary-char  unsigned   value zero.\n     03  WS-22-Lines     binary-char  unsigned   value zero.\n     03  WS-23-Lines     binary-char  unsigned   value zero.\n*>\n 01  accept-Terminator-Array pic 9(4)            value zero.\n     copy \"screenio.cpy\".\n*>\n 01  WS-Date-Formats.\n     03  WS-Swap             pic xx.\n     03  WS-Date             pic x(10).\n     03  WS-UK redefines WS-Date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-Date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-Date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  hdtime                            value spaces.\n     03  hd-hh           pic xx.\n     03  hd-mm           pic xx.\n     03  hd-ss           pic xx.\n     03  hd-uu           pic xx.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n*> Print layouts\n*>\n 01  Line-1.\n     03  l1-Program      pic x(16)     value spaces.\n     03  filler          pic x(39)     value spaces.\n     03  l1-title        pic x(42)     value \"Stock Addition Report\".\n     03  filler          pic x(27)     value spaces.\n     03  filler          pic x(5)      value \"Page \".\n     03  l1-Page         pic zz9.\n*>\n 01  Line-2.\n     03  l2-User         pic x(61).\n     03  l2-Batch        pic x(55)     value spaces.\n     03  l2-Date         pic x(10).\n     03  filler          pic x         value space.\n     03  l2-HH           pic xx        value spaces.\n     03  filler          pic x         value \":\".\n     03  l2-MM           pic xx        value spaces.\n*>\n 01  Line-3.\n     03  filler          pic x(78)   value spaces.\n     03  filler          pic x(9)    value \"Change in\".\n*>\n 01  Line-3b.\n     03  l3-Proc-Lit     pic x(11)  value \"Proc. Date\".\n     03  filler          pic x(57)  value\n         \"Stock Number  Description                         Qty    \".\n     03  l3-Price-Lit    pic x(5)   value \"Price\".\n     03  l3-Stock-Lit    pic x(19)  value \"    Stock Value    \".\n     03  l3-Dates-Lit    pic x(39)  value \"Order Date    Date Due     Order Status\".\n*>\n 01  Line-4.\n     03  l4-Proc-Date    pic x(11).\n     03  l4-Stock-Number pic x(14).        *> 25\n     03  l4-Desc         pic x(32).        *> 57\n     03  l4-Qty          pic z(6)9-.       *> 65\n     03  l4-Cost         pic z(6)9.99-.    *> 76\n     03  l4-Qty-B-ord redefines l4-Cost\n                         pic bbz(5)9bbb.\n     03  l4-New-Value    pic z(5),zz9.99-. *> 89\n     03  filler          pic xxx          value spaces.\n     03  l4-Source.\n         05  l4-Date-Ordered pic x(13).\n         05  l4-Date-Due     pic x(12).        *> 118\n         05  l4-Days-Late    pic zzz9          blank when zero.\n         05  l4-Lit-Late     pic x(10).        *> Days Late  131\n*>\n copy \"wsfnctn.cob\".\n copy \"wsstock.cob\".     *> 3.02\n copy \"wsaudit.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsmaps09.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  System-Record          pic x.\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n*>     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  ST000          pic x(36) value \"ST000 Error on Writing to Stock Rec.\".\n     03  ST002          pic x(36) value \"ST002 Error on Writing to Audit File\".\n     03  ST003          pic x(27) value \"ST003 Press return for Menu\".\n     03  ST005          pic x(18) value \"ST005 Invalid Date\".\n     03  ST006          pic x(30) value \"ST006 Press return to continue\".\n     03  ST011          pic x(33) value \"ST011 Error on stockMT processing\".\n*> Module specific\n     03  ST201          pic x(26) value \"ST201 Stock File not found\".\n     03  ST202          pic x(26) value \"ST202 Audit File not found\".\n     03  ST203          pic x(42) value \"ST203 Abbreviated Stock number not present\".\n     03  ST204          pic x(45) value \"ST204 Quantity cannot equal or exceed 999,999\".\n     03  ST205          pic x(45) value \"ST205 Quantity in Stock cannot exceed 999,999\".\n     03  ST206          pic x(48) value \"ST206 Quantity in Stock cannot be less than zero\".\n     03  ST207          pic x(43) value \"ST207 Quantity can only end with space or -\".\n     03  ST208          pic x(42) value \"ST208 CAUTION: Stock quantity will be zero\".\n     03  ST209          pic x(40) value \"ST209 Stock Value set to Minimum. (Zero)\".\n     03  ST210          pic x(39) value \"ST210 Current Deductions at Zero or < 0\".\n     03  ST211          pic x(39) value \"ST211 To Date Deductions at Zero or < 0\".\n     03  ST212          pic x(49) value \"ST212 Stock Value set to Maximum. (99,999,999.99)\".\n     03  ST213          pic x(23) value \"ST213 Bad month in date\".\n     03  ST214          pic x(28) value \"ST214 Stock Number not found\".\n     03  ST215          pic x(39) value \"ST215 Current Additions at Zero or < 0\".\n     03  ST216          pic x(39) value \"ST216 To Date Additions at Zero or < 0\".\n     03  ST217          pic x(27) value \"ST217 Services only Product\".\n     03  ST218          pic x(53) value \"ST218 Services only product so only quantity accepted\".\n     03  ST219          pic x(32) value \"ST219 Stock File not yet created\".\n     03  ST220          pic x(25) value \"SL220 Cannot open BO file\".\n     03  ST221          pic x(30) value \"ST221 Error on Rewrite BO file\".\n*>\n     03  ST250          pic x(13) value \" (Order Date)\".\n     03  ST251          pic X(11) value \" (Due Date)\".\n*>\n linkage section.\n*>***************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n 01  To-Day             pic x(10).\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n aa000-Core                 section.\n*>*********************************\n*>\n     accept   WS-env-lines from lines.\n     if       WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines.\n     subtract 2 from WS-lines giving WS-22-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n*> New for RDB\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-11    *> Stock file\n                                                 File-Info\n              end-call\n              if    return-code not = zero          *> not = zero - No file found\n                    display ST219 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to aa999-Exit\n              end-if\n     end-if\n*>\n*> New for BO processing 20/03/24\n*>\n     move     SL-BO-Flag  to WS-SL-BO-Flag.   *> BO in operation\n     call     \"CBL_CHECK_FILE_EXIST\" using File-31  *> Currently, only file is used\n                                           File-Info.\n     if       Return-Code not = zero        *> not = zero - No file found\n              move    \"N\" to WS-SL-BO-Flag\n                             WS-BO-File-Open.     *> Turn it off as no file exists at this time\n*>\n     if       WS-BO-Used\n              open  i-o BO-Stk-Itm-File\n              if    FS-Reply not = zero    *> Should never happen as tested above\n                    close  BO-Stk-Itm-File\n                    display  ST220 at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    move  \"N\" to WS-BO-File-Open\n                    go to aa999-Exit\n              else\n                    move  \"Y\" to WS-BO-File-Open\n              end-if\n     end-if.\n*>\n     perform  Stock-Open.\n     if       FS-Reply not = zero\n          or  WE-Error not = zero\n              display ST201 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 28 with foreground-color 2 highlight\n              display \"/\" at line WS-23-lines col 30  with foreground-color 2\n              display WE-Error at line WS-23-lines col 31 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              perform Stock-Close\n              go to aa999-Exit.\n     move     zero to Menu-Reply.\n     perform  zz070-Convert-Date.\n     move     WS-Date to WS-Proc-Date.\n*>\n*> Set variable menu item (4)\n*>\n     if       Stk-Period-Cur = \"Q\"\n              move \"Quarter\" to WS-Current-Period\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"Week\" to WS-Current-Period\n      else\n              move \"Month\" to WS-Current-Period.\n*>\n     string   \"(5)  End of \"    delimited by size\n              WS-Current-Period delimited by space\n              \" Audit Reports\"  delimited by size  into WS-Audit-Report-Lit.\n*>\n aa010-Display-Headings.\n     move     zero to WS-Audit-Count Page-Nos.\n     move     99 to Line-Cnt.\n     if       Menu-Reply = 1\n              perform aa030-Display-Head-Add\n     else\n      if      Menu-Reply = 2\n              perform aa040-Display-Head-Del\n      else\n       if     Menu-Reply = 3\n              perform aa050-Display-Head-Barcode-Add\n       else\n        if    Menu-Reply = 4\n              perform aa060-Display-Head-EOM\n        else\n         if   Menu-Reply = 5\n              perform aa080-Display-Head-Order\n         else\n              perform aa070-Display-Head-Menu.\n*>\n aa020-DH-End.\n     move     WS-Month to WS-Proc-Month.\n     if       WS-Proc-Month not numeric or not WS-Good-Month\n              display ST213 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display WS-Proc-Month at line WS-23-lines col 25 with foreground-color 2 highlight\n              display WS-Date at line WS-23-lines col 28 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to aa999-Exit.\n     go       to aa100-Main-Menu.\n*>\n aa030-Display-Head-Add.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Additions Entry\" at 0130 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa040-Display-Head-Del.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Deductions Entry\" at 0130 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa050-Display-Head-Barcode-Add.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Barcode Additions Entry\" at 0123 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa060-Display-Head-EOM.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock End of Month Processing\" at 0126 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa070-Display-Head-Menu.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Movements Menu\" at 0131 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa080-Display-Head-Order.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Stock Order Entry\" at 0132 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-date at 0171 with foreground-color 2.\n*>\n aa100-Main-Menu.\n*>\n*> First block is for AUTO run via stock menu program when given 2 params\n*>   stock NULL st020\n*>\n     if       function lower-case (WS-CD-Args (1:5)) not = \"st020\"\n              go to aa107-Main-Menu-Start.\n*>\n*>  So it is AUTO RUN\n*>\n     if       WS-CD-Args (6:1) = \"5\"\n      if      Stk-Audit-Used = 1        *> zero = no audit, so report not avail\n              move 5 to Menu-Reply\n              go to aa120-Bypass-Accept-1\n      else\n              move    8 to WS-Term-Code                   *> Abort process\n              perform Stock-Close                         *> stock file\n              go to aa999-Exit.\n*>\n aa107-Main-Menu-Start.\n     display  \"Select one of the following by number :- [ ]\" at 0401 with foreground-color 2.\n*>\n     display  \"(1)  Stock Additions Entry\"       at 0604 with foreground-color 2.\n     display  \"(2)  Stock Deductons Entry\"       at 0704 with foreground-color 2.\n     display  \"(3)  Stock Additions from Barcode Readers\" at 0804 with foreground-color 2.\n     display  \"(4)  Stock Order Entry\"           at 0904 with foreground-color 2.\n     if       Stk-Audit-Used = 1\n              display  WS-Audit-Report-Lit       at 1104 with foreground-color 2. *> OPTION 5\n     display  \"(9)  Return to System Menu\"       at 1404 with foreground-color 2.\n*>\n aa110-Accept-Loop.\n     accept   Menu-Reply at 0443  with foreground-color 6 auto update.\n     if       Menu-Reply = 9\n              perform Stock-Close                         *> stock file\n              if      WS-BO-File-Open = \"Y\"\n                      close  BO-Stk-Itm-File\n              end-if\n              go to aa999-Exit.\n     if       Menu-Reply = zero or > 5\n              go to aa110-Accept-Loop.\n*>\n aa120-Bypass-Accept-1.\n*>\n*>   Create audit cobol file if not exist\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-10    *> Audit file\n                                                 File-Info\n              end-call\n              if       return-code not = zero               *> not = zero - No file found\n                  and  Stk-Audit-Used = 1\n                       perform Stock-Audit-Open-Output\n                       perform Stock-Audit-Close\n              end-if\n     end-if\n*>\n     if       Stk-Audit-Used = 1\n      if      (Menu-Reply > zero and < 5)\n              perform   Stock-Audit-Open-Extend\n      else\n              perform   Stock-Audit-Open-Input\n     end-if.\n*>\n     if       FS-Reply not = zero\n              display ST202 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 28 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              perform Stock-Close\n              go to aa999-Exit.\n*>\n     if       Menu-Reply = 1\n              move  \"Stock Addition Report\" to l1-Title\n              move  \"Order Date    Date Due     Order Status\" to l3-Dates-Lit\n              move  \"Proc. Date\" to l3-Proc-Lit\n              move  \"Price\" to l3-Price-Lit\n              move  \"    Stock Value    \" to l3-Stock-Lit\n              move spaces to l2-Batch\n              open output Print-File\n              perform  ba000-Process-Manual-Additions\n              close Print-File\n              if  Page-Nos not = zero\n                  call  \"SYSTEM\" using Print-Report\n              end-if\n     else\n      if      Menu-Reply = 2\n              move  \"Stock Deduction Report\" to l1-Title\n              move  spaces                   to l3-Dates-Lit  l3-Price-Lit l2-Batch\n              move  \"Proc. Date\" to l3-Proc-Lit\n              move  \"    Stock Value    \" to l3-Stock-Lit\n              open  output Print-File\n              perform  ca000-Process-Manual-Deductions\n              close Print-File\n              if  Page-Nos not = zero\n                  call  \"SYSTEM\" using Print-Report\n              end-if\n      else\n       if     Menu-Reply = 3                               *> use Barcode reader data to update stock & audit\n              move spaces to l2-Batch\n              open output Print-File\n              perform  da000-Process-Barcode-Additions     *> this process need to be moded to match your kit\n              close Print-File\n              if    Page-Nos not = zero\n                    call  \"SYSTEM\" using Print-Report\n              end-if\n       else\n        if    Menu-Reply = 4\n              move  \"Stock Orders Update\" to l1-Title\n              move  \"Order Date    Date Due\" to l3-Dates-Lit\n              move  \"B'Qty\" to l3-Price-Lit\n              move  spaces to l3-Stock-Lit l3-Proc-Lit\n              move  spaces to l2-Batch line-4\n              open  output Print-File\n              perform fa000-Process-Orders\n              close Print-File\n              if   Page-Nos not = zero\n                   call  \"SYSTEM\" using Print-Report\n              end-if\n        else\n         if   Menu-Reply = 5\n          and Stk-Audit-Used = 1        *> zero = no audit, so report not avail\n              move Stk-Audit-No to WS-z3\n              string  \"Batch \"   delimited by size\n                      WS-z3      delimited by size\n                      into l2-Batch\n              perform  ea000-Process-End-of-Month.\n*>\n     if       Stk-Audit-Used = 1\n              perform  Stock-Audit-Close.\n*>\n     if       WS-CD-Args (6:1) = \"5\"                       *> If autorun we are done.\n              perform Stock-Close\n              go to aa999-Exit.\n\n     move     zero to Menu-Reply.\n     go       to aa010-Display-Headings.\n*>\n maps04.\n     call     \"maps04\" using maps03-ws.\n*>\n aa999-Exit.\n     goback.\n*>\n*>******************************************\n*>                  Routines               *\n*>******************************************\n*>\n ba000-Process-Manual-Additions   section.\n*>***************************************\n*>\n ba005-New-Heads.\n     perform  aa010-Display-Headings.\n     display  \" Stock Number    Description         Quantity    Price   Stk Qty   Stk Value\"\n                                                  at 0301 with foreground-color 2.\n     perform  varying lin from 5 by 1 until lin > WS-22-lines\n              move    1 to cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"[         ]\"   at curs with foreground-color 2\n              move    58 to cole\n              display \"{      }\"      at curs with foreground-color 2\n              move    67 to cole\n              display \"[           ]\" at curs with foreground-color 2\n     end-perform\n     move     4 to i.\n*>\n ba010-Accept-Data1.\n     add      1 to i.\n     if       i > WS-22-lines\n              perform  ba005-New-Heads  *> Was ba000-Process-Manual-Additions.  *> checked for end of screen & reset\n              add      1 to i.\n     move     spaces to WSD-Stock-Key.\n     initialize WS-Stock-Audit-Record with filler.\n     move     2 to cole.\n     move     i to lin.\n     accept   WSD-Stock-Key at curs with foreground-color 3 update UPPER.\n     if       WSD-Stock-Key = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to ba999-Exit.\n*>\n*>   Redisplay as uppercase",
        "line": 150
      },
      {
        "type": "IF",
        "condition": "WSD-Stock-No-Long = spaces\n              move     WSD-Abrev-Stock to WS-Stock-Abrev-Key\n              move     2 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if       FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                       display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       subtract 1 from i\n                       go to ba010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move     1 to File-Key-No\n              perform  Stock-Read-Indexed\n              if       FS-Reply = 23 or = 21\n                       display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       subtract 1 from i\n                       go to ba010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole.\n     display  WS-Stock-Desc (1:20) at curs with foreground-color 3.\n*>\n*> Check for Services only flag (e.g., P&P etc) so ignore\n*>\n     if       Stock-Services-Flag = \"Y\"\n              display ST217 at line WS-23-lines col 1 with foreground-color 2 highlight\n              display WS-spaces-20 at curs\n              subtract 1 from i\n              go to ba010-Accept-Data1.\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.  *> clear any prior errors\n*>\n*>  Quantity to add to stock next but use whats on order as guide\n*>\n ba020-Accept-Qty.\n     move     Stock-On-Order to WS-unit6.\n     move     space to WS-sign6.\n     move     39 to cole.\n     accept   WS-Qty-Screen-Display6 at curs with foreground-color 3 update.\n     if       WS-unit6 = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n           or Cob-Crt-Status = Cob-Scr-Key-Up\n           or Cob-Crt-Status = Cob-Scr-Page-Up\n              subtract 1 from i\n              move 17 to cole\n              display WS-spaces-20 at curs\n              go to ba010-Accept-Data1.\n*>\n     if       WS-unit6 > 999998\n              display ST204 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba020-Accept-Qty.\n     if       (ws-unit6 + Stock-Held) > 999999\n              display ST205 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba020-Accept-Qty.\n     if       WS-sign6 not = \"-\" and not = space\n              display ST207 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba020-Accept-Qty.\n*>\n*> Clear error line\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n     move     WS-unit6 to WS-qty.\n     if       Stock-Pre-Sales < WS-Qty\n              move     zero  to Stock-Pre-Sales\n     else\n              subtract WS-Qty from Stock-Pre-Sales.\n*>\n     if       WS-sign6 = \"-\"\n              move   1 to Audit-Reverse-Transaction\n              multiply -1 by WS-qty.\n*>\n     if       WS-qty + Stock-Held < zero\n              display ST206 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba020-Accept-Qty.\n*>\n*> If zero, issue caution and continue so it stays displayed until next line processed\n*>\n     if       WS-qty + Stock-Held = zero\n              display ST208 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30.\n*>\n ba030-Accept-Price.\n     move     48 to cole.\n     perform  zz200-accept-money6a thru zz200-accept-money6b.\n     if       amt-ok6 = zero\n              go to ba020-Accept-Qty.\n     move     amt-ok6 to WS-price.\n*>\n*>  Got it all now, so process it.\n*>\n     if       Stk-Audit-Used = 1\n              move     1 to Audit-Type         *> Additions\n              move     WS-Stock-Key  to Audit-Stock-Key\n              move     WS-Stock-Desc to Audit-Desc\n              move     WS-qty        to Audit-Transaction-Qty\n              move     WS-price      to Audit-Unit-Cost\n     end-if\n     move     WS-price to Stock-Last-Actual-Cost.\n     if       Stock-Held not = zero\n          or  Stock-Work-in-Progress not = zero\n              compute WS-Old-Value = (Stock-Held + Stock-Work-in-Progress) * Stock-Cost\n     else\n              move zero to WS-Old-Value.\n*>\n     multiply WS-Qty by WS-Price giving WS-Value.\n     if       Stk-Audit-Used = 1\n              move     WS-Value to Audit-Stock-Value-Change.\n     add      WS-Value WS-Old-Value giving WS-New-Value   on size error\n              display ST212 at line WS-23-lines col 1 with foreground-color 4 highlight\n              move 99999999.99 to WS-New-Value.\n*>\n*> Display updated quantity\n*>\n     add      WS-Qty Stock-Held giving WS-New-Qty.\n     move     WS-New-Qty to WS-z6.\n     move     59 to cole.\n     display  WS-z6 at curs with foreground-color 3.\n*>\n*> Now for updating stock value\n*>\n     if       not Stock-Averaging\n              move 68 to cole\n              move WS-new-value to amt-ok8\n              perform zz200-accept-money8c\n              if    amt-ok8 not = zero\n                    move amt-ok8 to WS-new-value.\n*>\n     divide   WS-New-Qty into WS-New-Value giving WS-New-Cost rounded.\n*>\n     if       Stock-Averaging\n              move 67 to cole\n              display \"{           }\" at curs with foreground-color 2\n              add 1 to cole\n              move WS-new-value  to amt-ok8\n              move amt-wk-pds8   to WS-pound8\n              move amt-wk-pence8 to WS-pence8\n              display WS-amount-screen-display8 at curs with foreground-color 3.\n*>\n     if       Stk-Audit-Used = 1\n              move Stk-Audit-No to Audit-No\n              perform  zz900-Read-System-Param  *> 05/01/25\n              move     zero      to Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to ba999-Exit.\n*>\n*> WS-Qty can be negative\n*>\n     if       WS-Qty > zero\n              subtract WS-Qty from Stock-On-Order\n     else\n              add WS-Qty to Stock-On-Order.\n*>\n     if       Stock-On-Order not = zero\n              add Stock-On-Order to Stock-Back-Ordered\n              move zero to Stock-On-Order.\n*>\n     if       Stock-Back-Ordered < zero\n              move zero to Stock-Back-Ordered.\n*>\n*>  Accumulate Month and Year to Date (TD) quantities.\n*>\n     add      WS-Qty to Stock-Adds.\n     add      WS-Qty to Stock-TD-Adds (ws-Proc-Mth).\n     if       Stock-Adds < 1\n              display ST215 at line WS-23-lines col 1 with foreground-color 4 highlight.\n     if       Stock-TD-Adds (ws-Proc-Mth) < 1\n              display ST216 at line WS-23-lines col 41 with foreground-color 4 highlight.\n*>\n ba040-Setup-Print-Transaction.\n*>\n*>  Print report line\n*>\n     move     spaces to line-4.\n     move     WS-Proc-Date    to l4-Proc-Date.\n     move     WS-Stock-Key    to l4-Stock-Number.\n     move     WS-Stock-Desc   to l4-Desc.\n     move     WS-Qty          to l4-Qty.\n     move     WS-Price        to l4-Cost.\n     move     WS-Value        to l4-New-Value.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Date to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Ordered.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Due to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Due.\n*>\n*> Work out days from order to today (assuming goods arrived today)\n*>\n     move     to-day to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n*> This test should never happen - yeh right !\n*>\n     if       u-bin = zero\n              display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display u-date at line WS-23-lines col 20 with foreground-color 2 highlight.\n*>\n     if       Stock-Order-Due = zero\n              move spaces to l4-Lit-Late.\n     if       Stock-Order-Due not = zero\n              subtract Stock-Order-Due from u-bin giving WS-Days-Late\n              if  WS-Days-Late > zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Late\" to l4-Lit-Late\n              else\n               if WS-Days-Late < zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Early\" to l4-Lit-Late.\n*>\n*> Clear due and ordered dates if ordered stock zero and print transaction\n*>\n     if       Stock-On-Order = zero\n          and Stock-Back-Ordered = zero\n              move zero to Stock-Order-Date Stock-Order-Due.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    print-record from line-4 after 1.\n     add      1 to Line-Cnt.\n*>\n*>  Update Stock Record\n*>\n     move     WS-New-Value to Stock-Value.\n     move     WS-New-Qty   to Stock-Held.\n     move     WS-New-Cost  to Stock-Cost.\n     move     U-Bin        to Stock-Arrived-Date.\n     perform  Stock-Rewrite.\n     if       FS-Reply not = zero\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ba999-Exit.\n*>\n*> Process any BO records that apply to stk item if BO-Flag set & u-bin = To-Day in days from 1601/01/01 as = 1\n*> Stock record is currernt present / stored\n*>\n     if       Stock-Held not > zero\n              go to ba010-Accept-Data1   *> More arrivals ?\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n       and    WS-BO-Used\n              move     \"Y\" to WS-BO-Can-Be-Used  *> Testing use WS-BO-Usable (Y)\n              move     WS-Stock-Key to BO-Stk-Item-No\n              start    BO-Stk-Itm-File  key = BO-Stk-Item-No\n              if       FS-Reply not = zeros      *> No such item so process done\n                       go to ba010-Accept-Data1\n              end-if\n              move     Stock-Held to WS-Temp-Stock-Held *> don't process if out of stock now based on BO recs\n              perform  until exit\n                       read     BO-Stk-Itm-File NEXT at end\n                                exit perform\n                       end-read\n                       if       BO-Stk-Item-No not = WS-Stock-Key\n                                exit perform cycle  *> JIC out of stk # order MAY BE SHOULD BE exit perform but JIC\n                       end-if\n                       if       FS-Reply not = zeros  *> no more recs\n                                exit perform\n                       end-if\n*>\n*> valid record but only update BO recs if still have stock - at least on paper :)\n*> as stock received might be less than all BO requirements at this time\n*>\n                       if       WS-Temp-Stock-Held not < BO-Stk-BO-Qty\n                          and   WS-Temp-Stock-Held not = zero\n                                move     \"Y\"   to BO-Stk-Arrived-Flag\n                                move     U-Bin to BO-Stk-BO-Arr-Date\n                                subtract BO-Stk-BO-Qty from WS-Temp-Stock-Held\n                                rewrite  BO-Stk-Itm-Record\n                                if       FS-Reply not = zero\n                                         display  ST221 at line WS-23-Lines col 10\n                                                   with foreground-color 4 highlight beep erase eos\n                                         display  ST006 at line WS-Lines    col 1\n                                                   with foreground-color 2 highlight\n                                         accept   WS-Reply at line WS-Lines col 32\n                                         exit perform\n                                end-if\n                                exit perform cycle\n                       end-if  *> out of stock so cannot proc any more BO recs of same stk #\n              end-perform\n     end-if.\n*>\n     go       to ba010-Accept-Data1.\n*>\n ba999-Exit.\n     exit     section.\n*>\n ca000-Process-Manual-Deductions  section.\n*>***************************************\n*>\n     perform  aa010-Display-Headings.\n     display  \" Stock Number    Description         Quantity    Stk Qty\"\n                                                  at 0301 with foreground-color 2.\n     perform  varying lin from 5 by 1 until lin > WS-22-lines\n              move    1 to cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"{      }\"      at curs with foreground-color 2\n     end-perform\n     move     4 to i.\n*>\n ca010-Accept-Data1.\n     add      1 to i.\n     if       i > WS-22-lines\n              perform ca000-Process-Manual-Deductions.  *> check for end of screen & reset\n     move     spaces to WSD-Stock-Key.\n     initialize WS-Stock-Audit-Record.\n     move     2 to cole.\n     move     i to lin.\n     accept   WSD-Stock-Key at curs with foreground-color 3 update.\n     if       WSD-Stock-Key = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to ca999-Exit.\n*>\n     move     function upper-case (WSD-Stock-Key) to WSD-Stock-Key.\n*>\n*>   Redisplay as uppercase",
        "line": 828
      },
      {
        "type": "IF",
        "condition": "WSD-Stock-No-Long = spaces\n              move WSD-Abrev-Stock to WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to ca010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move   1 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to ca010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole.\n     display  WS-Stock-Desc (1:20) at curs with foreground-color 3.\n     move     48 to cole.\n     add      Stock-Work-in-Progress Stock-Held giving WS-Z6.\n     display  WS-Z6 at curs with foreground-color 3.\n     display  \" \" at line WS-23-lines col 1 with erase eol.  *> clear any prior errors\n*>\n*>  Quantity to subtract from stock next\n*>\n ca020-Accept-Qty.\n     move     zero  to WS-unit6.\n     move     space to WS-sign6\n     move     39 to cole.\n     accept   WS-Qty-Screen-Display6 at curs with foreground-color 3 update.\n     if       WS-unit6 = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n           or Cob-Crt-Status = Cob-Scr-Key-Up\n           or Cob-Crt-Status = Cob-Scr-Page-Up\n              subtract 1 from i\n              move 17 to cole\n              display WS-spaces-20 at curs\n              go to ca010-Accept-Data1.\n*>\n     if       WS-unit6 > 999998\n              display ST204 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ca020-Accept-Qty.\n     if       WS-sign6 not = \"-\" and not = space\n              display ST207 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ca020-Accept-Qty.\n*>\n*> clear error line\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n     move     WS-unit6 to WS-qty.\n     if       WS-sign6 = \"-\"\n              move 1 to Audit-Reverse-Transaction\n              multiply -1 by WS-qty\n              if  (ws-unit6 + Stock-Held) > 999999\n                  display ST205 at line WS-23-lines col 1 with foreground-color 4 highlight\n                  go to ca020-Accept-Qty.\n*>\n     if       Stock-Held - WS-qty < zero\n              display ST206 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ca020-Accept-Qty\n     else\n              display  \" \" at line WS-23-lines col 1 with erase eol.\n*>\n*> Check for Services only flag so ignore\n*>\n     if       Stock-Services-Flag = \"Y\"\n              display ST217 at line WS-23-lines col 1 with foreground-color 2 highlight\n              subtract 1 from i\n              go to ca010-Accept-Data1.\n*>\n*> if zero, issue caution and continue\n*>\n     if       Stock-Held - WS-Qty = zero\n              display ST208 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              display \" \" at line WS-23-lines col 1 with erase eos.\n*>\n     move     48 to cole.\n     subtract WS-Qty from Stock-Held giving WS-New-Qty.   *> neg values should add\n     move     WS-New-Qty to WS-Z6.\n     display  WS-Z6 at curs with foreground-color 3.\n*>\n*>  Got it all now so process it.\n*>\n     move     2 to Audit-Type.         *> Deductions\n     move     WS-Stock-Key to Audit-Stock-Key.\n     move     WS-Stock-Desc to Audit-Desc.\n     move     WS-qty to Audit-Transaction-Qty.\n     move     Stock-Cost to Audit-Unit-Cost.              *> IS THIS NEEDED else set to zero\n     compute  Audit-Stock-Value-Change = WS-Qty * Stock-Cost * -1.\n*>\n     move     Stk-Audit-No to Audit-No.\n     if       Stk-Audit-Used = 1\n              perform  zz900-Read-System-Param  *> 05/01/25\n              move zero         to Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to ca999-Exit.\n*>\n*>  Accumulate Month and Year to Date (TD) quantities.\n*>\n     add      WS-Qty to Stock-Deducts.\n     add      WS-Qty to Stock-TD-Deds (ws-Proc-Mth).\n     if       Stock-Deducts < 1\n              display ST210 at line WS-23-lines col 1 with foreground-color 4 highlight.\n     if       Stock-TD-Deds (ws-Proc-Mth) < 1\n              display ST211 at line WS-23-lines col 41 with foreground-color 4 highlight.\n*>\n ca040-Setup-Print-Transaction.\n*>\n*>  print report line\n*>\n     move     spaces    to line-4.\n     move     WS-Proc-Date    to l4-Proc-Date.\n     move     WS-Stock-Key    to l4-Stock-Number.\n     move     WS-Stock-Desc   to l4-Desc.\n     move     WS-Qty          to l4-Qty.\n     move     Audit-Stock-Value-Change  to l4-New-Value.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    print-record from line-4 after 1.\n     add      1 to Line-Cnt.\n*>\n*>  Update Stock Record\n*>\n     subtract WS-Qty from Stock-Held.\n*>                                             needed even for NO stock-averaging\n     compute Stock-Value = (Stock-Held + Stock-Work-in-Progress) * Stock-Cost on size error\n               display ST212 at line WS-23-lines col 1 with foreground-color 4 highlight\n               move 99999999.99 to Stock-Value.\n*>\n     perform  Stock-Rewrite.\n     if       FS-Reply not = zero\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ca999-Exit.\n*>\n     go       to ca010-Accept-Data1.\n*>\n ca999-Exit.\n     exit     section.\n*>\n da000-Process-Barcode-Additions   section.\n*>****************************************\n*>\n*>  Check this AFTER RE-CODING <<<<<<<<<<<<<<<<<<<<<***<<<<<<<<<<<<<<<<<<<<<<<<<<\n*>-----------------------------------------------------------------------------------\n*>\n*>   Coding taken from the additions routine ba000 with most of the code still present\n*>    in case you need to modify it.\n*>\n*> This element just reads the bar code and adds 1 to qty & increases stock value\n*>  by the last unit price paid or if zero",
        "line": 1167
      },
      {
        "type": "IF",
        "condition": "coming from a keyboard with a CR (carriage return)\n*> as tested using a WASP WLR8900 CCD LR (long range) USB scanner available from Wasp\n*> Technologies Inc which are available in the UK and Europe. See SC manual for\n*> additional information.\n*> While this specific reader reads one code at a time and passes\n*> the resulting code to the program along with CR some versions can hold in their memory\n*> many hundreds of such codes each again, ending with a CR. The code as supplied still\n*> supports that.\n*>\n*> Note that the scanners may need to be programmed to end each scanned barcode with a CR.\n*> See the specific scanner manual for the method,\n*> Another point: Some scanners also have a numeric keypad on them so the user can input a\n*> product quantity. This module would need changing to support this.\n*>\n*> For all support to program or for programming a module/program to process bar code data,\n*>  or for that matter any other changes or additions, a request should be made\n*>  to Applewood Computers with details of hardware used, i.e., make, model & specs of\n*>  bar code readers in use and data produced. This is a chargeable service.\n*>\n*> For contact details please see supplied manuals inside front page.\n*>-----------------------------------------------------------------------------------\n*>\n     perform  aa010-Display-Headings.\n     display  \" Stock Number    Description         Quantity    Price   Stk Qty   Stk Value\"\n                                                  at 0301 with foreground-color 2.\n     perform  varying lin from 5 by 1 until lin > WS-22-lines\n              move    1 to cole\n              display \"[             ]\" at curs with erase eol foreground-color 2\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2\n              move    38 to cole\n              display \"[       ]\"     at curs with foreground-color 2\n              move    47 to cole\n              display \"[         ]\"   at curs with foreground-color 2\n              move    58 to cole\n              display \"{      }\"      at curs with foreground-color 2\n              move    67 to cole\n              display \"[           ]\" at curs with foreground-color 2\n     end-perform\n     move     4 to i.\n*>\n da010-Accept-Data1.\n     add      1 to i.\n     if       i > WS-22-lines                          *> check for end of screen & reset\n              perform da000-Process-Barcode-Additions. *> by rerunning paragraph code.\n     move     spaces to WSD-Stock-Key.\n     initialize WS-Stock-Audit-Record.\n     move     2 to cole.\n     move     i to lin.\n     accept   WSD-Stock-Key at curs with foreground-color 3 update.\n     if       WSD-Stock-Key = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to da999-Exit.\n*>\n     move     function upper-case (WSD-Stock-Key) to WSD-Stock-Key.\n*>\n*>   Redisplay as uppercase",
        "line": 1342
      },
      {
        "type": "IF",
        "condition": "FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n            display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n            display \"Missing Stock Record\" at curs with foreground-color 3 highlight blink\n            go to da010-Accept-Data1\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole.\n     display  WS-Stock-Desc (1:20) at curs with foreground-color 3.\n*>\n*> Check for Services only flag so ignore\n*>\n     if       Stock-Services-Flag = \"Y\"\n              display ST217 at line WS-23-lines col 1 with foreground-color 2 highlight\n              display WS-spaces-20 at curs\n              go to da010-Accept-Data1.\n     display  \" \" at line WS-23-lines col 1 with erase eol.  *> clear any prior errors\n*>\n*> Bypass accept quantity but set as 1 and use filed last price paid for unit price\n*>\n     move     1 to WS-qty\n                   WS-unit6.\n     if       Stock-Last-Actual-Cost not = zero\n              move  Stock-Last-Actual-Cost to Amt-ok6\n                                              WS-price\n     else\n              move  Stock-Cost  to Amt-ok6\n                                   WS-price.\n*>\n     move     39 to cole.\n     display  WS-Qty-Screen-Display6 at curs with foreground-color 3.\n     go       to da030-Accept-Price.\n*>\n*> da020 is bypassed as quantity 1 is 'assumed' for basic barcode readers.\n*>\n*>  Quantity to add to stock next but use whats on order as guide\n*>\n da020-Accept-Qty.\n     move     Stock-On-Order to WS-unit6.\n     move     space to WS-sign6.\n     move     39 to cole.\n     accept   WS-Qty-Screen-Display6 at curs with foreground-color 3 update.\n     if       WS-unit6 = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n           or Cob-Crt-Status = Cob-Scr-Key-Up\n           or Cob-Crt-Status = Cob-Scr-Page-Up\n              subtract 1 from i\n              move 17 to cole\n              display WS-spaces-20 at curs\n              go to da010-Accept-Data1.\n*>\n     if       WS-unit6 > 999998\n              display ST204 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Accept-Qty.\n     if       (ws-unit6 + Stock-Held) > 999999\n              display ST205 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Accept-Qty.\n     if       WS-sign6 not = \"-\" and not = space\n              display ST207 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Accept-Qty.\n*>\n*> Clear error line\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n     move     WS-unit6 to WS-qty.\n     if       Stock-Pre-Sales < WS-Qty\n              move     zero  to Stock-Pre-Sales\n     else\n              subtract WS-Qty from Stock-Pre-Sales.\n*>\n     if       WS-sign6 = \"-\"\n              move 1 to Audit-Reverse-Transaction\n              multiply -1 by WS-qty.\n*>\n     if       WS-qty + Stock-Held < zero\n              display ST206 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Accept-Qty.\n*>\n*> If zero, issue caution and continue so it stays displayed until next line processed\n*>\n     if       WS-qty + Stock-Held = zero\n              display ST208 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30.\n*>\n da030-Accept-Price.\n*>\n*> Code bypassed but using Stock-Last-Actual-Cost & update stock value if used otherwise zero\n*>   with no stock value update\n*>\n*>??     if       not Stock-Averaging\n*>??              move zero to WS-Price\n*>??                           WS-Value\n*>??     go       to\n*>\n     move     48 to cole.\n     move     amt-wk-pence6 to WS-pence6.\n     move     amt-wk-pds6 to WS-pound6.\n     display  WS-amount-screen-display6 at curs with foreground-color 3.\n*>\n*>\n*>     perform  zz200-accept-money6c.\n*>     if       amt-ok6 = zero\n*>              go to da020-Accept-Qty.\n*>     move     amt-ok6 to WS-price.\n*>\n*>  Got it all now so process it.\n*>\n     if       Stk-Audit-Used = 1\n              move     1 to Audit-Type         *> Additions\n              move     WS-Stock-Key to Audit-Stock-Key\n              move     WS-Stock-Desc to Audit-Desc\n              move     WS-qty to Audit-Transaction-Qty\n              move     WS-price to Audit-Unit-Cost\n     end-if\n     move     WS-price to Stock-Last-Actual-Cost.\n     if       Stock-Held not = zero\n          or  Stock-Work-in-Progress not = zero\n              compute WS-Old-Value = (Stock-Held + Stock-Work-in-Progress) * Stock-Cost\n     else\n              move zero to WS-Old-Value.\n*>\n     multiply WS-Qty by WS-Price giving WS-Value.\n     if       Stk-Audit-Used = 1\n              move     WS-Value to Audit-Stock-Value-Change.\n     add      WS-Value WS-Old-Value giving WS-New-Value   on size error\n              display ST212 at line WS-23-lines col 1 with foreground-color 4 highlight\n              move 99999999.99 to WS-New-Value.\n*>\n*> Display updated quantity\n*>\n     add      WS-Qty Stock-Held giving WS-New-Qty.\n     move     WS-New-Qty to WS-z6.\n     move     59 to cole.\n     display  WS-z6 at curs with foreground-color 3.\n*>\n*> Now for updating stock value\n*>\n     if       not Stock-Averaging\n              move 68 to cole\n              move WS-new-value to amt-ok8\n              perform zz200-accept-money8c\n              if    amt-ok8 not = zero\n                    move amt-ok8 to WS-new-value.\n*>\n     divide   WS-New-Qty into WS-New-Value giving WS-New-Cost rounded.\n*>\n     if       Stock-Averaging\n              move 67 to cole\n              display \"{           }\" at curs with foreground-color 2\n              add 1 to cole\n              move WS-new-value to amt-ok8\n              move amt-wk-pds8   to WS-pound8\n              move amt-wk-pence8 to WS-pence8\n              display WS-amount-screen-display8 at curs with foreground-color 3.\n*>\n     if       Stk-Audit-Used = 1\n              move Stk-Audit-No to Audit-No\n              perform  zz900-Read-System-Param  *> 05/01/25\n              move zero         to Stk-Activity-Rep-Run\n              perform  zz910-Rewrite-System-Param  *> 05/01/25\n              move WS-Proc-Date to Audit-Process-Date\n              perform  Stock-Audit-Write\n              if    FS-Reply not = zero\n                    display ST002 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n                    display ST003   at line WS-lines col 01\n                    accept WS-reply at line WS-lines col 30\n                    go to da999-Exit.\n*>\n*> WS-Qty can be negative\n*>\n     if       WS-Qty > zero\n              subtract WS-Qty from Stock-On-Order\n     else\n              add WS-Qty to Stock-On-Order.\n*>\n     if       Stock-On-Order not = zero\n              add Stock-On-Order to Stock-Back-Ordered\n              move zero to Stock-On-Order.\n*>\n     if       Stock-Back-Ordered < zero\n              move zero to Stock-Back-Ordered.\n*>\n*>  Accumulate Month and Year to Date (TD) quantities.\n*>\n     add      WS-Qty to Stock-Adds.\n     add      WS-Qty to Stock-TD-Adds (ws-Proc-Mth).\n     if       Stock-Adds < 1\n              display ST215 at line WS-23-lines col 1 with foreground-color 4 highlight.\n     if       Stock-TD-Adds (ws-Proc-Mth) < 1\n              display ST216 at line WS-23-lines col 41 with foreground-color 4 highlight.\n*>\n da040-Setup-Print-Transaction.\n*>\n*>  Print report line\n*>\n     move     spaces to line-4.\n     move     WS-Proc-Date to l4-Proc-Date.\n     move     WS-Stock-Key    to l4-Stock-Number.\n     move     WS-Stock-Desc   to l4-Desc.\n     move     WS-Qty       to l4-Qty.\n     move     WS-Price     to l4-Cost.\n     move     WS-Value     to l4-New-Value.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Date to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Ordered.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Due to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Due.\n*>\n*> Work out days from order to today (assuming goods arrived today)\n*>\n     move     to-day to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n*> This test should never happen\n*>\n     if       u-bin = zero\n              display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display u-date at line WS-23-lines col 20 with foreground-color 2 highlight.\n*>\n     if       Stock-Order-Due = zero\n              move spaces to l4-Lit-Late.\n     if       Stock-Order-Due not = zero\n              subtract Stock-Order-Due from u-bin giving WS-Days-Late\n              if  WS-Days-Late > zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Late\" to l4-Lit-Late\n              else\n               if WS-Days-Late < zero\n                  move WS-Days-Late to l4-Days-Late\n                  move \" Days Early\" to l4-Lit-Late.\n*>\n*> Clear due and ordered dates if ordered stock zero and print transaction\n*>\n     if       Stock-On-Order = zero\n          and Stock-Back-Ordered = zero\n              move zero to Stock-Order-Date Stock-Order-Due.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    print-record from line-4 after 1.\n     add      1 to Line-Cnt.\n*>\n*>  Update Stock Record\n*>\n     move     WS-New-Value to Stock-Value.\n     move     WS-New-Qty   to Stock-Held.\n     move     WS-New-Cost  to Stock-Cost.\n     move     U-Bin      to Stock-Arrived-Date.\n     perform  Stock-Rewrite.\n     if       FS-Reply not = zero\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to da999-Exit.\n*>\n*> Process any BO records that apply to stk item if BO-Flag set & u-bin = To-Day in days from 1601/01/01 as = 1\n*>\n     if       Stock-Held not > zero\n              go to da010-Accept-Data1\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n       and    WS-BO-Used\n              move  \"Y\" to WS-BO-Can-Be-Used  *> Testing use WS-BO-Usable (Y)\n              move  WS-Stock-Key to BO-Stk-Item-No\n              start BO-Stk-Itm-File  key = BO-Stk-Item-No\n              if    FS-Reply not = zeros    *> No such item\n                    go to da010-Accept-Data1\n              end-if\n              move     Stock-Held to WS-Temp-Stock-Held *> don't process if out of stock now based on BO recs\n              perform  until exit\n                       read     BO-Stk-Itm-File NEXT at end\n                                exit perform\n                       end-read\n                       if       BO-Stk-Item-No not = WS-Stock-Key\n                                exit perform cycle  *> JIC out of stk # order\n                       end-if\n                       if       FS-Reply not = zeros\n                                exit perform\n                       end-if\n*> valid record but only update BO recs if still have stock - at least on paper :)\n                       if       WS-Temp-Stock-Held not < BO-Stk-BO-Qty and\n                                WS-Temp-Stock-Held not = zero\n                                move     \"Y\"   to BO-Stk-Arrived-Flag\n                                move     U-Bin to BO-Stk-BO-Arr-Date\n                                subtract BO-Stk-BO-Qty from WS-Temp-Stock-Held\n                                rewrite  BO-Stk-Itm-Record\n                                if       FS-Reply not = zero\n                                         display  ST221 at line WS-23-Lines col 10\n                                                   with foreground-color 4 highlight beep erase eos\n                                         display  ST006 at line WS-Lines    col 1\n                                                   with foreground-color 2 highlight\n                                         accept   WS-Reply at line WS-Lines col 32\n                                         exit perform\n                                end-if\n                                exit perform cycle\n                       end-if  *> out of stock so cannot proc any more BO recs of same stk #\n              end-perform\n     end-if.\n*>\n     go       to da010-Accept-Data1.\n*>\n da999-Exit.\n     exit     section.\n*>\n ea000-Process-End-of-Month  section.\n*>**********************************\n*>\n*> New code for processing records from invoicing in Sales & if present update\n*>   stock values in stock file.\n*> and purchase order receipts if and when implemented.\n*>\n     display  \"Printing\" at 1337 with erase eos.\n     open     output Print-File.\n     perform  ea100-Print-Additions.\n *>    close    Print-File.               *> Force separate reports in case of double sided printing\n *>    if       Page-Nos not = zero\n *>             call  \"SYSTEM\" using Print-Report.\n *>    open     output Print-File.\n     perform  ea200-Print-Deductions.\n     close    Print-File.\n     if       Page-Nos not = zero\n              call  \"SYSTEM\" using Print-Report.\n     perform  zz900-Read-System-Param.  *> 05/01/25\n     move     1   to Stk-Activity-Rep-Run.\n     perform  zz910-Rewrite-System-Param.  *> 05/01/25\n*>\n ea010-Accept-Delete.\n     if       WS-Process-Func = 5\n              go to ea020-Bypass-Displays.\n     move     \"N\" to WS-Reply.\n     display  \"Can I Delete the Audit File Now? [ ]\" at 0401 with foreground-color 2 erase eos.\n     display  \" Making sure that Sales Invoicing and Purchase Ledger are NOT running\"\n                                                     at 0601 with foreground-color 4 highlight.\n     display  \"Check that Reports are complete first, before responding\"\n                                                     at 0802 with foreground-color 4 highlight blink.\n     accept   WS-Reply at 0435 with foreground-color 3 update.\n     move     function upper-case (ws-Reply) to WS-Reply.\n     if       WS-Reply = \"N\"\n              go to ea999-Exit.\n     if       WS-Reply not = \"Y\"\n              go to ea010-Accept-Delete.\n*>\n ea020-Bypass-Displays.\n     perform  Stock-Audit-Close.\n     perform  Stock-Audit-Open-Output.\n     perform  zz900-Read-System-Param. *> 05/01/25\n     add      1 to Stk-Audit-No on size error\n              move 1 to Stk-Audit-No.\n     perform  zz910-Rewrite-System-Param. *> 05/01/25\n*>\n ea999-Exit.\n     exit     section.\n*>\n ea100-Print-Additions     section.\n*>********************************\n*>\n     perform  Stock-Audit-Close.\n     perform  Stock-Audit-Open-Input.\n     move     zero to Page-Nos WS-add-total WS-ded-total.\n     move     99 to Line-Cnt.\n     move     \"Additions Stock Audit Report\" to l1-Title.\n     move     \"Proc. Date\" to l3-Proc-Lit.\n     move     \"Price\"      to l3-Price-Lit.\n     move     \"    Stock Value    \" to l3-Stock-Lit.\n*>     move     spaces to l3-Dates-Lit.\n     move    \"Source/PO.no.\"  to l3-Dates-Lit.\n     move     spaces to line-4.\n*>\n ea110-Read-Record.\n     perform  Stock-Audit-Read-Next.\n     if       FS-Reply = 10     *> EOF\n              go to ea120-Totals.\n*>\n*> Could have batch headers but not in use at this time\n*>\n     if       Del-Record or SL-Del-Record or SL-Credit-Record\n              add  Audit-Stock-Value-Change to WS-Ded-Total.\n*>\n     if       not Add-Record and not PL-Add-Record\n              go to ea110-Read-Record.\n     move     Audit-Stock-Key          to l4-Stock-Number.\n     move     Audit-Desc               to l4-Desc.\n     move     Audit-Transaction-Qty    to l4-Qty.\n     move     Audit-Unit-Cost          to l4-Cost.\n     move     Audit-Stock-Value-Change to l4-New-Value.\n     move     Audit-Process-Date       to l4-Proc-Date.\n     add      Audit-Stock-Value-Change to WS-Add-Total.\n     move     spaces                   to l4-Source.\n     if       PL-Add-Record\n              string \"Purchasing/\"     delimited by size\n                     Audit-Invoice-PO  delimited by size\n                                          into l4-Source.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    Print-Record from line-4 after 1.\n     add      1 to Line-Cnt.\n     go       to ea110-Read-Record.\n*>\n ea120-Totals.\n     if       Line-Cnt > WS-Page-Lines - 7\n              perform zz010-Print-Heads.\n     move     spaces to Print-Record.\n     move     WS-Add-Total to WS-Total.\n     move     56 to a.\n     string   \" Total Additions   \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 3.\n     move     spaces to Print-Record.\n     move     WS-Ded-Total to WS-Total.\n     move     56 to a.\n     string   \" Total Deductions  \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     move     spaces to Print-Record (56:35).\n     move     75 to a.\n     string   \"-------------- \" delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     add      WS-Add-Total WS-Ded-Total giving WS-Total.\n     move     56 to a.\n     string   \" Total Changes     \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     move     spaces to Print-Record (56:35).\n     move     75 to a.\n     string   \"============== \"  delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n*>\n ea199-Exit.\n     exit     section.\n*>\n ea200-Print-Deductions    section.\n*>********************************\n*>\n     perform  Stock-Audit-Close.\n     perform  Stock-Audit-Open-Input.\n*>\n*> Do a page feed if page-no is odd so new report starts on a new\n*>  physical page assuming not using matrix printer - fairly safe these days.\n*>\n     if       Line-Cnt > 4 and  *> might be heads and totals.\n              (Page-Nos = 1 or 3 or 5 or 7 or 9 or 11 or 13 or 15 or 17 or 19)\n              move     spaces to Print-Record\n              write    Print-Record before page.\n*>\n     move     zero to Page-Nos.\n     move     99 to Line-Cnt.\n     move     \"Deductions Stock Audit Report\" to l1-Title.\n     move     \"Proc. Date\"          to l3-Proc-Lit.\n     move     \"    Stock Value    \" to l3-Stock-Lit.\n     move     spaces to l3-Dates-Lit.\n*>     move     spaces to l3-Price-Lit.\n     move    \"Source/Inv.no.\"  to l3-Dates-Lit.\n     move     spaces to line-4.\n*>\n ea210-Read-Record.\n     perform  Stock-Audit-Read-Next.\n     if       FS-Reply = 10    *> EOF\n              go to ea220-Totals.\n*>\n     if       not Del-record\n          and not SL-Del-Record\n          and not SL-Credit-Record\n              go to ea210-Read-Record.\n     move     Audit-Stock-Key          to l4-Stock-Number.\n     move     Audit-Desc               to l4-Desc.\n     move     Audit-Transaction-Qty    to l4-Qty.\n     move     Audit-Stock-Value-Change to l4-New-Value.\n     move     Audit-Process-Date       to l4-Proc-Date.\n     move     spaces to l4-Source.\n     if       SL-Del-Record\n              string \"Invoicing/\"     delimited by size\n                     Audit-Invoice-PO delimited by size\n                                       into l4-Source.\n     if       SL-Credit-Record\n              string \"Credit note/\"       delimited by size\n                     Audit-Invoice-PO     delimited by size\n                     \" for \"              delimited by size\n                     Audit-Cr-for-Invoice delimited by size\n                                       into l4-Source.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    print-record from line-4 after 1.\n     add      1 to Line-Cnt.\n     go       to ea210-Read-Record.\n*>\n ea220-Totals.\n     if       Line-Cnt > WS-Page-Lines - 7\n              perform zz010-Print-Heads.\n     move     spaces to Print-Record.\n     move     WS-Add-Total to WS-Total.\n     move     56 to a.\n     string   \" Total Additions   \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 3.\n     move     spaces to Print-Record.\n     move     WS-Ded-Total to WS-Total.\n     move     56 to a.\n     string   \" Total Deductions  \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     move     spaces to Print-Record (56:35).\n     move     75 to a.\n     string   \"-------------- \" delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     add      WS-Add-Total WS-Ded-Total giving WS-Total.   *> THIS ASSUMES THAT DED IS NEG?\n     move     56 to a.\n     string   \" Total Changes     \" delimited by size\n              WS-Total              delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n     move     75 to a.\n     move     spaces to Print-Record (56:35).\n     string   \"============== \"  delimited by size into Print-Record pointer a.\n     write    Print-Record after 1.\n*>\n ea299-Exit.\n     exit     section.\n*>\n fa000-Process-Orders   section.\n*>*****************************\n*>\n*> Note that audit file is NOT updated only the stock file and that this process\n*> replaces data, ie, quantities are REPLACED not added to\n*>------------------------------------------------------------------------------\n*>  So it is only used when Purchase Ledger is NOT passing this information on\n*>   to Stock Control (or is not used).\n*>\n     perform  aa010-Display-Headings.\n     display  \" Stock Number   Description          Qty Ord Date Ordered  Date Due  \" &\n              \"Back Qty\"                at 0301 with foreground-color 2.\n     perform  varying lin from 5 by 1 until lin > WS-22-lines\n              move    1 to cole\n              display \"[             ]\" at curs with erase eol foreground-color 2 *> stock no.\n              move    16 to cole\n              display \"{                    }\" at curs with foreground-color 2 *> desc (disp)\n              move    38 to cole\n              display \"[      ]\"       at curs with foreground-color 2  *> qty ordered\n              move    46 to cole\n              display \"[          ]\"   at curs with foreground-color 2  *> date ordered\n              move    58 to cole\n              display \"[          ]\"   at curs with foreground-color 2  *> date Due\n              move    70 to cole\n              display \"[      ]\"       at curs with foreground-color 2  *> qty B'ord\n     end-perform\n     move     4 to i.\n*>\n fa010-Accept-Data1.\n     add      1 to i.\n     if       i > WS-22-lines                        *> check for end of screen & redraw\n              perform fa000-Process-Orders.\n     move     spaces to WSD-Stock-Key.\n     move     2 to cole.\n     move     i to lin.\n     accept   WSD-Stock-Key at curs with foreground-color 3 update.\n     if       WSD-Stock-Key = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to fa999-Exit.\n*>\n     move     function upper-case (WSD-Stock-Key) to WSD-Stock-Key.\n*>\n*>   Redisplay as uppercase",
        "line": 1404
      },
      {
        "type": "IF",
        "condition": "WSD-Stock-No-Long = spaces\n              move WSD-Abrev-Stock to WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              perform Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21\n                     display ST203 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to fa010-Accept-Data1\n              end-if\n     else\n              move WSD-Stock-Key to WS-Stock-Key\n              move     1 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if     FS-Reply = 23 or = 21           *> invalid key but for RDB its 23\n                     display ST214 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     subtract 1 from i\n                     go to fa010-Accept-Data1\n              end-if\n     end-if\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n     move     17 to cole.\n     display  WS-Stock-Desc (1:20) at curs with foreground-color 3.\n*>\n*> Check for Services only flag so ignore\n*>\n     if       Stock-Services-Flag = \"Y\"\n              display ST217 at line WS-23-lines col 1 with foreground-color 2 highlight\n              display WS-spaces-20 at curs\n              subtract 1 from i\n              go to fa010-Accept-Data1.\n     display  \" \" at line WS-23-lines col 1 with erase eol.  *> clear any prior errors\n     move     space to WS-sign6.\n*>\n*>  Quantity on order\n*>\n fa020-Accept-Qty.\n     move     Stock-On-Order to WS-unit6.\n     move     39 to cole.\n     accept   WS-unit6 at curs with foreground-color 3 update.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n           or Cob-Crt-Status = Cob-Scr-Key-Up\n           or Cob-Crt-Status = Cob-Scr-Page-Up\n              subtract 1 from i\n              move 17 to cole\n              display WS-spaces-20 at curs\n              go to fa010-Accept-Data1.\n*>\n     if       WS-unit6 > 999998\n              display ST204 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to fa020-Accept-Qty.\n*>\n*> Clear error line\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n     move     WS-unit6 to Stock-On-Order.\n*>\n*> Convert dates pre display and accept\n*>\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if.\n*>\n fa030-Accept-Date-Ord.\n     move     47 to Cole.\n     accept   WS-Stock-Order-Date at curs with foreground-color 3 update.\n     if       WS-Stock-Order-Date not = spaces\n              move WS-Stock-Order-Date to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n              else\n                 display ST005 at line WS-23-lines col 1  with foreground-color 4 highlight\n                 display ST250 at line WS-23-lines col 19 with foreground-color 4 highlight\n                 go to fa030-Accept-Date-Ord\n     else\n              move zero to Stock-Order-Date.\n*>\n fa040-Accept-Date-Due.\n     move     59 to Cole.\n     accept   WS-Stock-Order-Due at curs with foreground-color 3 update.\n     if       WS-Stock-Order-Due not = spaces\n              move WS-Stock-Order-Due to WS-Test-Date\n              perform zz050-Validate-Date\n              if       u-bin not = zero\n                       move u-bin to Stock-Order-Due\n              else\n                       display ST005 at line WS-23-lines col 1  with foreground-color 4 highlight\n                       display ST251 at line WS-23-lines col 19 with foreground-color 4 highlight\n                       go to fa040-Accept-Date-Due\n              end-if        *> 16/08/23 as it looks messy and wrong without it\n     else\n              move zero to Stock-Order-Due.\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n*>\n fa050-Accept-B-ord.\n     move     Stock-Back-Ordered to WS-unit6.\n     move     71 to cole.\n     accept   WS-unit6 at curs with foreground-color 3 update.\n*>\n     if       WS-unit6 > 999998\n              display ST204 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to fa050-Accept-B-ord.\n*>\n*> Clear error line\n*>\n     display  \" \" at line WS-23-lines col 1 with erase eol.\n     move     WS-unit6 to Stock-Back-Ordered.\n*>\n fa060-Setup-Print-Transaction.\n*>\n*>  Print report line\n*>\n     move     spaces to line-4.\n     move     WS-Stock-Key       to l4-Stock-Number.\n     move     WS-Stock-Desc      to l4-Desc.\n     move     Stock-On-Order     to l4-Qty.\n     move     Stock-Back-Ordered to l4-Qty-B-ord.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Date to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Ordered.\n*>\n     move     spaces to u-date.\n     move     Stock-Order-Due to u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date to l4-Date-Due.\n*>\n     if       Line-Cnt > WS-Page-Lines\n              perform zz010-Print-Heads.\n     write    print-record from line-4 after 1.\n     add      1 to Line-Cnt.\n*>\n*>  Update Stock Record\n*>\n     perform  Stock-Rewrite.\n     if       FS-Reply not = zero\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-lines col 38 with foreground-color 2 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to fa999-Exit.\n*>\n     go       to fa010-Accept-Data1.\n*>\n fa999-Exit.\n     exit     section.\n*>\n zz010-Print-Heads         section.\n*>********************************\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to zz010-Exit.\n     move     prog-name to l1-Program.\n     add      1 to Page-Nos.\n     move     Page-Nos to l1-Page.\n     move     Usera to l2-User.\n     perform  zz070-Convert-Date.\n     move     WS-date to l2-Date.\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to l2-HH\n              move hd-mm to l2-MM.\n     if       Page-Nos not = 1\n              write print-record from Line-1 after page\n              write print-record from Line-2 after 1\n              move  spaces to print-record\n              write print-record after 1\n     else\n              write print-record from Line-1 before 1\n              write print-record from Line-2 before 1\n     end-if\n     move     6 to Line-Cnt.\n     if       Menu-Reply not = 5\n              write print-record from Line-3 after 1\n     else\n              subtract 1 from Line-Cnt.\n     write    print-record from Line-3b after 1.\n     move     spaces to print-record.\n     write    print-record after 1.\n*>\n zz010-Exit.\n     Exit     section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   WS-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     WS-test-date to WS-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to WS-date.  *> swap Intl to UK form\n     move     WS-test-date (1:4) to WS-Year.\n     move     WS-test-date (6:2) to WS-Month.\n     move     WS-test-date (9:2) to WS-Days.\n*>\n zz050-test-date.\n     move     WS-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     u-date to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-date as uk/US/Inlt date format\n*>\n     move     to-day to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n zz100-test-escape          section.\n*>*********************************\n*>\n     display  escape-code at 1876 with foreground-color 6.\n*>\n zz100-get-escape.\n     accept   escape-code at 1876 with foreground-color 6 update.\n     move     function upper-case (escape-code) to escape-code.\n*>\n     if       escape-code not = \"B\" and not = \"S\" and not = \"Q\"\n                      and not = \"K\"  and not = \"D\"\n              go to zz100-get-escape.\n*>\n zz100-exit.\n     exit     section.\n*>\n zz200-comm-routines section.\n*>**************************\n*>\n zz200-accept-money6a.\n     move     zero to WS-poundsd6 WS-penced6 amt-ok6.\n*>\n zz200-accept-money6b.\n     display  WS-amount-screen-display6 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept6  at curs with foreground-color 3 update.\n     move     WS-pound6 to amt-wk-pds6.\n     move     WS-pence6 to amt-wk-pence6.\n*>\n*> this updates existing value in amt-ok6\n*>\n zz200-accept-money6c.\n     move     amt-wk-pence6 to WS-pence6.\n     move     amt-wk-pds6 to WS-pound6.\n     display  WS-amount-screen-display6 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept6  at curs with foreground-color 3 update.\n     move     WS-pound6 to amt-wk-pds6.\n     move     WS-pence6 to amt-wk-pence6.\n*>\n zz200-accept-money8a.\n     move     zero to WS-poundsd8 WS-penced8 amt-ok8.\n*>\n zz200-accept-money8b.\n     display  WS-amount-screen-display8 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept8  at curs with foreground-color 3 update.\n     move     WS-pound8 to amt-wk-pds8.\n     move     WS-pence8 to amt-wk-pence8.\n*>\n*> this updates existing value in amt-ok8\n*>\n zz200-accept-money8c.\n     move     amt-wk-pence8 to WS-pence8.\n     move     amt-wk-pds8 to WS-pound8.\n     display  WS-amount-screen-display8 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept8  at curs with foreground-color 3 update.\n     move     WS-pound8 to amt-wk-pds8.\n     move     WS-pence8 to amt-wk-pence8.\n*>\n zz200-comm-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-Param-Get-Rewrite.cob\".\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 1978
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 22,
    "cognitive": 9,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 180,
      "totalOperators": 264,
      "totalOperands": 520,
      "vocabulary": 182,
      "length": 784,
      "volume": 5886.110997915778
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
