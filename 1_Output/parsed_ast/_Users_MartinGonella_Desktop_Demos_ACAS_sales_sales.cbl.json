{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sales.cbl",
  "fileName": "sales.cbl",
  "timestamp": "2025-09-15T16:25:31.405Z",
  "programId": "sales",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 166
      },
      {
        "name": "file",
        "line": 175
      },
      {
        "name": "working-storage",
        "line": 178
      },
      {
        "name": "zz060-Convert-Date",
        "line": 911
      },
      {
        "name": "exit",
        "line": 944
      },
      {
        "name": "maps04",
        "line": 946
      },
      {
        "name": "exit",
        "line": 952
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 169
      },
      {
        "name": "Sales-Main",
        "line": 317
      },
      {
        "name": "goback",
        "line": 330
      },
      {
        "name": "goback",
        "line": 335
      },
      {
        "name": "File-Duplicates-In-Use",
        "line": 341
      },
      {
        "name": "aa010-Get-System-Recs",
        "line": 352
      },
      {
        "name": "end-if",
        "line": 368
      },
      {
        "name": "display-menu",
        "line": 479
      },
      {
        "name": "Conv-date",
        "line": 492
      },
      {
        "name": "end-if",
        "line": 511
      },
      {
        "name": "conv-date-end",
        "line": 513
      },
      {
        "name": "Display-Go",
        "line": 516
      },
      {
        "name": "accept-loop",
        "line": 569
      },
      {
        "name": "call-system-setup",
        "line": 591
      },
      {
        "name": "pre-overrewrite",
        "line": 610
      },
      {
        "name": "goback",
        "line": 627
      },
      {
        "name": "end-if",
        "line": 642
      },
      {
        "name": "File-Duplicates-In-Use",
        "line": 647
      },
      {
        "name": "overclose",
        "line": 660
      },
      {
        "name": "goback",
        "line": 661
      },
      {
        "name": "load-it",
        "line": 663
      },
      {
        "name": "loader",
        "line": 673
      },
      {
        "name": "load00",
        "line": 678
      },
      {
        "name": "load00-exit",
        "line": 695
      },
      {
        "name": "load000",
        "line": 699
      },
      {
        "name": "goback",
        "line": 713
      },
      {
        "name": "load000-exit",
        "line": 715
      },
      {
        "name": "load01",
        "line": 719
      },
      {
        "name": "load02",
        "line": 725
      },
      {
        "name": "load03",
        "line": 731
      },
      {
        "name": "load04",
        "line": 737
      },
      {
        "name": "load05",
        "line": 744
      },
      {
        "name": "load06",
        "line": 751
      },
      {
        "name": "load08",
        "line": 771
      },
      {
        "name": "load09",
        "line": 777
      },
      {
        "name": "load10",
        "line": 783
      },
      {
        "name": "load12",
        "line": 799
      },
      {
        "name": "load13",
        "line": 805
      },
      {
        "name": "load14",
        "line": 811
      },
      {
        "name": "load15",
        "line": 817
      },
      {
        "name": "end-if",
        "line": 823
      },
      {
        "name": "load16",
        "line": 827
      },
      {
        "name": "end-if",
        "line": 835
      },
      {
        "name": "load17",
        "line": 839
      },
      {
        "name": "end-if",
        "line": 845
      },
      {
        "name": "load18",
        "line": 849
      },
      {
        "name": "end-if",
        "line": 855
      },
      {
        "name": "load19",
        "line": 859
      },
      {
        "name": "load20",
        "line": 865
      },
      {
        "name": "load21",
        "line": 871
      },
      {
        "name": "load21a",
        "line": 880
      },
      {
        "name": "load22",
        "line": 894
      },
      {
        "name": "loadsr",
        "line": 900
      },
      {
        "name": "main-exit",
        "line": 906
      },
      {
        "name": "goback",
        "line": 907
      },
      {
        "name": "zz060-Exit",
        "line": 943
      },
      {
        "name": "maps04-exit",
        "line": 951
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 411,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 438,
        "type": "DYNAMIC",
        "using": [
          "Run-Backup",
          "File-Info",
          "end-call",
          "if",
          "Return-Code",
          "not",
          "=",
          "zero",
          "*>",
          "and",
          "Batch-Text",
          "(1:1)",
          "not",
          "=",
          "space",
          "move",
          "\"No",
          "BackUp",
          "Script",
          "in",
          "Bin\"",
          "to",
          "Batch-Text",
          "else",
          "move",
          "1",
          "to",
          "Backup-Sw",
          "string",
          "\"Using",
          "\"",
          "delimited",
          "by",
          "size",
          "Script-Name",
          "delimited",
          "by",
          "space",
          "into",
          "Batch-Text",
          "end-if",
          "*>",
          "*>",
          "*>",
          "22/03/18",
          "New",
          "code",
          "(from",
          "stock)"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 626,
        "type": "DYNAMIC",
        "using": [
          "Full-Backup-Script"
        ]
      },
      {
        "target": "maps04",
        "line": 949,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "proc",
        "line": 70,
        "replacing": null
      },
      {
        "name": "of",
        "line": 156,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 165,
        "replacing": null
      },
      {
        "name": "sys-params-versioning",
        "line": 194,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 238,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 239,
        "replacing": null
      },
      {
        "name": "wstime",
        "line": 240,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 241,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 242,
        "replacing": null
      },
      {
        "name": "wssys4",
        "line": 243,
        "replacing": null
      },
      {
        "name": "wsdflt",
        "line": 244,
        "replacing": null
      },
      {
        "name": "wsfinal",
        "line": 245,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 246,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 273,
        "replacing": null
      },
      {
        "name": "Proc-Get-Env-Set-Files",
        "line": 909,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 954,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "overwrite",
        "thru": null,
        "line": 92
      },
      {
        "target": "zz020-Get-Program-Args",
        "thru": null,
        "line": 337
      },
      {
        "target": "System-Open-Input",
        "thru": null,
        "line": 344
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 346
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 349
      },
      {
        "target": "System-Read-Indexed",
        "thru": null,
        "line": 357
      },
      {
        "target": "System-Read-Indexed",
        "thru": null,
        "line": 361
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 363
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 366
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 381
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 385
      },
      {
        "target": "System-Read-Indexed",
        "thru": null,
        "line": 386
      },
      {
        "target": "System-Read-Indexed",
        "thru": null,
        "line": 391
      },
      {
        "target": "System-Write",
        "thru": null,
        "line": 394
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 400
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 405
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 413
      },
      {
        "target": "Load00",
        "thru": null,
        "line": 471
      },
      {
        "target": "conv-date",
        "thru": null,
        "line": 535
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 597
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 598
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 601
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 602
      },
      {
        "target": "overrewrite",
        "thru": null,
        "line": 625
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 633
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 636
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 639
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 640
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 650
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 653
      },
      {
        "target": "System-rewrite",
        "thru": null,
        "line": 656
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 658
      },
      {
        "target": "overrewrite",
        "thru": null,
        "line": 691
      },
      {
        "target": "overrewrite",
        "thru": null,
        "line": 710
      },
      {
        "target": "overrewrite",
        "thru": null,
        "line": 712
      },
      {
        "target": "load00",
        "thru": null,
        "line": 761
      },
      {
        "target": "load000",
        "thru": null,
        "line": 765
      },
      {
        "target": "load00",
        "thru": null,
        "line": 788
      },
      {
        "target": "load00",
        "thru": null,
        "line": 822
      },
      {
        "target": "load00",
        "thru": null,
        "line": 834
      },
      {
        "target": "load00",
        "thru": null,
        "line": 844
      },
      {
        "target": "load00",
        "thru": null,
        "line": 854
      },
      {
        "target": "load00",
        "thru": null,
        "line": 878
      },
      {
        "target": "load000",
        "thru": null,
        "line": 883
      },
      {
        "target": "load00",
        "thru": null,
        "line": 888
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 920
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zeros",
        "to": "File-System-Used\n                       File-Duplicates-In-Use",
        "line": 340
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 342
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 343
      },
      {
        "from": "\"sys002\"",
        "to": "ws-called    *> create param file by requested info from user\n              call     ws-called using ws-calling-data file-defs\n              perform  System-Open        *>  ditto\n     end-if",
        "line": 347
      },
      {
        "from": "zeros",
        "to": "File-System-Used         *> again in case RDB setup\n                       File-Duplicates-In-Use",
        "line": 353
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 355
      },
      {
        "from": "4",
        "to": "File-Key-No",
        "line": 356
      },
      {
        "from": "System-Record",
        "to": "WS-System-Record-4",
        "line": 358
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 360
      },
      {
        "from": "\"sys002\"",
        "to": "ws-called    *> create param file by requested info from user\n              call     ws-called using ws-calling-data file-defs\n              perform  System-Open\n              go to aa010-Get-System-Recs\n     end-if",
        "line": 364
      },
      {
        "from": "System-Record",
        "to": "WS-Temp-System-Rec",
        "line": 369
      },
      {
        "from": "File-System-Used",
        "to": "Arg-Number       *> save value from param in Cobol file\n*>              move     zero to File-System-Used             *> so we can close the cobol file\n*>              perform  System-Close                         *>  close cobol file\n*>              move     Arg-Number to File-System-Used       *> restore value from param in cobol file\n*>              move     \"66\" to FA-RDBMS-Flat-Statuses       *> Force RDB processing\n*>              move     4 to File-Key-No\n*>              perform  System-Open                          *> It could be values 1 thru 5 when the other RDBs are programmed for\n*>              perform  System-Read-Indexed                  *> Read in RDB table sys totals\n*>              if       fs-reply = zero\n*>                       move System-Record to WS-System-Record-4  *> overwrite cobol rec",
        "line": 379
      },
      {
        "from": "1",
        "to": "File-Key-No\n*>              perform  System-Read-Indexed                  *> get the record from the RDB table\n*>              if       fs-reply not = zero                  *> but if error we have a problem such as someone forgot to run system load modules",
        "line": 390
      },
      {
        "from": "WS-Temp-System-Rec",
        "to": "System-Record   *> restore saved cobol file rec\n*>                       perform System-Write                 *> So create RDB row in SYSTEM-REC from the Cobol file data\n*>                       if      fs-reply not = zero\n*>                               display SY011    at 2301 with erase eos\n*>                               display fs-reply at 2348\n*>                               display SY008    at 2401\n*>                               accept  ws-Reply at 2432\n*>                               perform System-Close\n*>                               goback\n*>                       end-if\n*>              end-if\n*>     end-if",
        "line": 393
      },
      {
        "from": "run-date",
        "to": "u-bin",
        "line": 410
      },
      {
        "from": "u-date",
        "to": "to-day",
        "line": 412
      },
      {
        "from": "\"O/S\"",
        "to": "op-display",
        "line": 419
      },
      {
        "from": "\"Linux\"",
        "to": "op-display\n     else if  Windows move \"Windows\" To op-display\n     else if  Mac     move \"Mac\"     To op-display\n     else if  OS2     move \"OS/2\"    To op-display\n     else if  unix    move \"Unix\"    To op-display\n     else if  dos     move \"Dos\"     To op-display",
        "line": 420
      },
      {
        "from": "Windows-Backup-Script-Name",
        "to": "Script-Name\n     else if  OS2\n              move OS2-Backup-Script-Name to Script-Name\n     else if  Linux or Unix or Mac\n              move Linux-Backup-Script-Name to Script-Name",
        "line": 428
      },
      {
        "from": "1",
        "to": "Backup-Sw\n              string \"Using \"    delimited by size\n                     Script-Name delimited by space into Batch-Text\n     end-if\n*>\n*>\n*> 22/03/18 New code (from stock)",
        "line": 445
      },
      {
        "from": "\"xl150\"",
        "to": "WS-Called\n              move     \"sales\"    to WS-Caller\n              move     zeros      to WS-Term-Code\n              move     spaces     to WS-Del-Link\n              move     zero       to WS-Process-Func\n              move     zero       to WS-Sub-Function\n              perform  Load00\n              go to    Pre-OverRewrite\n     end-if\n*>\n     move     zeros to ws-Process-Func ws-Sub-Function",
        "line": 465
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 481
      },
      {
        "from": "\"sales\"",
        "to": "ws-caller",
        "line": 482
      },
      {
        "from": "spaces",
        "to": "ws-called ws-del-link menu-reply",
        "line": 483
      },
      {
        "from": "zeros",
        "to": "ws-term-code",
        "line": 484
      },
      {
        "from": "maps-ser-nn",
        "to": "curs2",
        "line": 485
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 497
      },
      {
        "from": "u-date",
        "to": "ws-date\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              move ws-date to u-date\n     end-if\n     if       Date-Intl\n              move \"ccyy/mm/dd\" to ws-date   *> swap Intl to UK form\n              move u-date (7:4) to ws-Intl-Year\n              move u-date (4:2) to ws-Intl-Month\n              move u-date (1:2) to ws-Intl-Days\n              move ws-date to u-date\n     end-if",
        "line": 499
      },
      {
        "from": "wsb-hh",
        "to": "wsd-hh\n              move wsb-mm to wsd-mm\n              move wsb-ss to wsd-ss\n              display \"at \"    at 0355 with foreground-color 2\n              display wsd-time at 0358 with foreground-color 2",
        "line": 523
      },
      {
        "from": "wsa-yy",
        "to": "u-year\n              move wsa-mm to u-month\n              move wsa-dd to u-days\n              display \"on \" at 0367 with foreground-color 2\n              perform conv-date\n              display u-date at 0370 with foreground-color 2",
        "line": 531
      },
      {
        "from": "zero",
        "to": "z",
        "line": 581
      },
      {
        "from": "letters-upper",
        "to": "letters",
        "line": 582
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 594
      },
      {
        "from": "zero",
        "to": "ws-term-code",
        "line": 595
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 596
      },
      {
        "from": "4",
        "to": "File-Key-No",
        "line": 599
      },
      {
        "from": "WS-System-Record-4",
        "to": "System-Record",
        "line": 600
      },
      {
        "from": "\"sys002\"",
        "to": "ws-called",
        "line": 604
      },
      {
        "from": "Script-Name",
        "to": "Full-Backup-Script\n      else\n       if     OS2\n              move Script-Name to Full-Backup-Script",
        "line": 621
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses\n              move     1 to File-Key-No\n              perform  System-Open\n              move     1 to File-Key-No\n              move     System-Record to WS-Temp-System-Rec\n              perform  System-Rewrite\n              move     4 to File-Key-No\n              move     WS-System-Record-4 to System-Record\n              perform  System-Rewrite\n              perform  System-Close\n              move     WS-Temp-System-Rec to System-Record\n     end-if",
        "line": 631
      },
      {
        "from": "zeros",
        "to": "File-System-Used\n                       File-Duplicates-In-Use",
        "line": 646
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 648
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 649
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 651
      },
      {
        "from": "System-Record",
        "to": "WS-Temp-System-Rec",
        "line": 652
      },
      {
        "from": "4",
        "to": "File-Key-No",
        "line": 654
      },
      {
        "from": "WS-System-Record-4",
        "to": "System-Record",
        "line": 655
      },
      {
        "from": "WS-Temp-System-Rec",
        "to": "System-Record",
        "line": 657
      },
      {
        "from": "space",
        "to": "menu-reply",
        "line": 666
      },
      {
        "from": "zero",
        "to": "ws-term-code",
        "line": 681
      },
      {
        "from": "zero",
        "to": "ws-term-code",
        "line": 702
      },
      {
        "from": "\"sl000\"",
        "to": "ws-called",
        "line": 722
      },
      {
        "from": "\"sl010\"",
        "to": "ws-called",
        "line": 728
      },
      {
        "from": "\"sl020\"",
        "to": "ws-called",
        "line": 734
      },
      {
        "from": "2",
        "to": "pass-value",
        "line": 740
      },
      {
        "from": "\"sl910\"",
        "to": "ws-called",
        "line": 741
      },
      {
        "from": "4",
        "to": "pass-value",
        "line": 747
      },
      {
        "from": "\"sl920\"",
        "to": "ws-called",
        "line": 748
      },
      {
        "from": "\"sl050\"",
        "to": "ws-called",
        "line": 754
      },
      {
        "from": "\"sl830\"",
        "to": "WS-Called",
        "line": 760
      },
      {
        "from": "\"sl055\"",
        "to": "ws-called",
        "line": 764
      },
      {
        "from": "\"sl060\"",
        "to": "ws-called",
        "line": 768
      },
      {
        "from": "\"sl080\"",
        "to": "ws-called",
        "line": 774
      },
      {
        "from": "\"sl085\"",
        "to": "ws-called",
        "line": 780
      },
      {
        "from": "\"sl090\"",
        "to": "ws-called\n              perform  load00\n     end-if\n     move     \"sl095\" to ws-called",
        "line": 787
      },
      {
        "from": "\"sl100\"",
        "to": "ws-called",
        "line": 796
      },
      {
        "from": "\"sl070\"",
        "to": "ws-called",
        "line": 802
      },
      {
        "from": "\"sl130\"",
        "to": "ws-called",
        "line": 808
      },
      {
        "from": "\"sl140\"",
        "to": "ws-called",
        "line": 814
      },
      {
        "from": "\"sl115\"",
        "to": "ws-called\n              perform  load00\n     end-if",
        "line": 821
      },
      {
        "from": "\"sl110\"",
        "to": "ws-called",
        "line": 824
      },
      {
        "from": "\"sl115\"",
        "to": "ws-called\n              perform  load00\n     end-if",
        "line": 833
      },
      {
        "from": "\"sl190\"",
        "to": "ws-called",
        "line": 836
      },
      {
        "from": "\"sl115\"",
        "to": "ws-called    *> OTM3 sort\n              perform  load00\n     end-if",
        "line": 843
      },
      {
        "from": "\"sl120\"",
        "to": "ws-called",
        "line": 846
      },
      {
        "from": "\"sl165\"",
        "to": "ws-called\n              perform  load00\n     end-if",
        "line": 853
      },
      {
        "from": "\"sl160\"",
        "to": "ws-called",
        "line": 856
      },
      {
        "from": "\"sl180\"",
        "to": "ws-called",
        "line": 862
      },
      {
        "from": "\"sl900\"",
        "to": "ws-called",
        "line": 868
      },
      {
        "from": "\"sl140\"",
        "to": "ws-called",
        "line": 877
      },
      {
        "from": "\"xl150\"",
        "to": "ws-called",
        "line": 882
      },
      {
        "from": "\"sl130\"",
        "to": "ws-called\n              perform load00\n              move zero to ws-term-code\n              go to load21a",
        "line": 887
      },
      {
        "from": "\"sl170\"",
        "to": "ws-called",
        "line": 897
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 922
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 924
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 927
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 931
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 938
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "called by Stock.\n*> 22/09/15 vbc - .19 Added support for Param-Restrict & option Z.\n*> 24/10/16 vbc - .20 ALL programs now using wsnames.cob in copybooks\n*> 30/10/16 vbc - .21 Clean up mapser proc as its a copy proc.Added more msgs.\n*>                    Changed usage of Cbl-File-Details to File-Info (see .10)\n*>                    Remove file-status checks for file exists code.\n*>                    All updates made to active file system RDB or Cobol file not both\n*>                    as when RDB in use the Cobol record only needed for basic RDB data.\n*>                    Changed get-Env stuff to a copybook using common msgs.\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*> 15/01/17 vbc - .22 Removed dead call - maps99.\n*>                    Change proc step for SL160 so no sort if RDB processing.\n*> 23/01/17 vbc - .23 Fixed dry testing bug that saved sys rec using rec4\n*>                    and if files used saved twice. likewise overwriting\n*>                    sys rec on getting RDB from file again poss. causing\n*>                    sys rec curruption by sys4 rec.\n*> 09/02/17 vbc - .24 Do not use sort procs sl115 for 110, 120, 190 if\n*>                    RDB processing. also see (22). Note that sl190 did NOT use\n*>                    the sorted file - it does now.\n*> 23/04/17 vbc -     Updated Dummies-4-Unused-ACAS-FH-Calls to include missing\n*>                    PL recs in all SL programs.\n*> 02/09/17 vbc - .25 New code to update sys4 record or param record if\n*>                    the called program could or does any changes to them.\n*>                    removed the stop run after a goback - unneeded.\n*>                    Chg load000 & load00 to perform/goback instead of go to.\n*>                    also add after call to perform overwrite to update\n*>                    any data changes in system or sys4 record data\n*>                    depending on called program for load00.\n*>                    Set wsnames to use default in copybook without the 'in ..'.\n*> 02/02/18 vbc - .26 Added code to aa010-Get-System-Recs if param file read\n*>                    returns non-zero.\n*> 05/02/18 vbc - .27 Dont close file pre calling sys002 as not open!!!\n*> 13/03/18 vbc -     Adjusted code base to bring it inline with all other menu programs.\n*> 22/03/18 vbc - .28 Added process to allow internal params via WS-Calling-Data\n*>                    WS-Args (13) to start and pass extra info to a called program\n*>                    In this case running xl150 with answers to the start up\n*>                    questions. (F = Forced run).\n*>                    This way program can be started via crontab or better still via\n*>                    Sales Ledger if end of month/beginning of new month.\n*>                    xl150 End of cycle program should only be run if all reports\n*>                    completed, i.e.,\n*>                    Sales: Proof, Packing lists, Invoices, Value Analysis & Postings\n*>                    and payments Proof and Postings.\n*>                    Purchase: Proof, Purchase Orders, Value Analysis & Postings\n*>                    and payments Proof and Postings, Cheques etc if required.\n*>                    Force run will try to run all outstanding reports.\n*> 14/04/18 vbc - .29 Remark out code for reading in rdb system data as file will\n*>                    ALWAYS be up2date.\n*>                    On request for system setup write out sys rec 1 & 4 to file\n*>                    first. Adjust overwrite so that rdb if valid is processed\n*>                    followed by the file. Doing this system wide.\n*> 21/05/18 vbc - .30 Small change to the backup process at prerewrite\n*>                    On menu exit do NOT display space as it forces a wait stop.\n*> 28/05/18 vbc - .31 Added ws fields for env. columns and lines to verify minimums.\n*> 31/05/23 vbc - .32 Added execution of sl830 first when Invoice Post selected.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 26/12/24 vbc       Change menu ACCEPT to use UPPER and remove the function.\n*> 17/02/25 vbc - .33 Call in load07 to 830 should have been using load00 not 000.\n*>\n*>****\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy  \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n data  division.\n*>=============\n*>\n file section.\n*>-----------\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15)    value \"Sales (3.02.33)\".\n 77  z                   binary-char  value zero.\n 77  Batch-Text          pic x(28)    value spaces.\n 77  Script-Name         pic x(20)    value spaces.\n 77  Run-Backup          pic x(512)   value spaces.  *> size changed\n 77  Full-Backup-Script  pic x(512)   value spaces.\n 77  OS-Delimiter        pic x        value \"/\".     *> Preset for *nix\n 77  ACAS_BIN            pic x(512)   value spaces.  *> added\n 77  ACAS_LEDGERS        pic x(500)   value spaces.\n 77  Arg-Number          pic 9        value zero.\n*>========================================================\n*>  in case file layout upgrade is needed.\n*>   Using a file update program.\n*>\n copy \"sys-params-versioning.cob\".\n*>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n*>\n*> holds program parameter values from command line\n 01  Arg-Vals                         value spaces.\n     03  Arg-Value       pic x(525)  occurs 2.\n 01  Arg-Test            pic x(525)   value spaces.\n 01  Saved-CD-Args       pic x(13).\n*>\n 01  Backup-Sw           pic 9     value zero.\n     88  Backup-Script-Found       value 1.\n 01  Linux-Backup-Script-Name   pic x(20) value \"acasbkup.sh\".\n 01  Windows-Backup-Script-Name pic x(20) value \"acasbkup.bat\".\n 01  OS2-Backup-Script-Name     pic x(20) value \"acasbkup.cmd\".\n*>\n 01  File-Info                          value zero.       *> Layout as per GNU v3 manual\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.    *> Mod date.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.    *> Mod time\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  ws-data.\n     03  menu-reply      pic x          value \"A\".\n     03  op-display      pic x(7).\n*>\n     03  letters-upper   pic x(26)      value \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".\n     03  letters.\n         05  a-entry     pic x          occurs 26 indexed by q.\n*>\n     03  ws-reply        pic x.\n     03  a               pic 99         comp.\n     03  b               pic 99.\n     03  c               pic 99.\n     03  wsmaps-ser.\n         05  wsmaps-ser-xx pic xx.\n         05  wsmaps-ser-nn pic 9(4).\n*>\n     03  ws-env-columns  pic 999       value zero.\n     03  ws-env-lines    pic 999       value zero.\n*>\n copy \"wsmaps03.cob\".    *> for maps04\n copy \"wscall.cob\".\n copy \"wstime.cob\".\n copy \"wsfnctn.cob\".\n copy \"wssystem.cob\".\n copy \"wssys4.cob\"   replacing System-Record-4 by WS-System-Record-4.\n copy \"wsdflt.cob\".\n copy \"wsfinal.cob\".\n copy \"wsnames.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  System-Record          pic x.\n*>     03  Default-Record         pic x.\n*>     03  Final-Record           pic x.\n*>     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY006           pic x(62) value \"SY006 Program Arguments limited to two and you have specified \".\n     03  SY007           pic x(35) value \"SY007 Program arguments incorrect: \".\n     03  SY008           pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY009           pic x(53) value \"SY009 Environment variables not yet set up : ABORTING\".\n     03  SY010           pic x(46) value \"SY010 Terminal program not set to length => 24\".\n     03  SY011           pic x(47) value \"SY011 Error on systemMT processing, Fs-reply = \".\n     03  SY013           pic x(47) value \"SY013 Terminal program not set to Columns => 80\".\n*> Module specific\n*>\n 01  to-day              pic x(10).\n*>\n 01  WS-Temp-System-Rec  pic x(2048).   *> Size overkill\n*>\n procedure division.\n*>=================\n*>\n Sales-Main.\n*>---------\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n*>\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     function current-date to wse-date-block.\n*>\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              display SY010    at 0101 with erase eos\n              accept  ws-reply at 0133\n              goback.\n     accept   ws-env-Columns from Columns.\n     if       ws-Env-Columns < 80\n              display SY013    at 0101 with erase eos\n              accept  ws-reply at 0133\n              goback.\n*>\n     perform  zz020-Get-Program-Args.\n*>\n Open-System.                *> First get system param cobol file\n     move     zeros to File-System-Used\n                       File-Duplicates-In-Use.\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.  *> Force Cobol proc.\n     move     1 to File-Key-No.\n     perform  System-Open-Input.\n     if       fs-reply not = zero\n *>             perform System-Close\n              move     \"sys002\" to ws-called    *> create param file by requested info from user\n              call     ws-called using ws-calling-data file-defs\n              perform  System-Open        *>  ditto\n     end-if.                      *> 02/02/18\n*>\n aa010-Get-System-Recs.\n     move     zeros to File-System-Used         *> again in case RDB setup\n                       File-Duplicates-In-Use.  *> if sys002 just been run.\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.  *> Force Cobol proc.\n     move     4 to File-Key-No.\n     perform  System-Read-Indexed.        *> Read Cobol file sys totals\n     move     System-Record to WS-System-Record-4.\n*>\n     move     1 to File-Key-No.\n     perform  System-Read-Indexed.        *> Read Cobol file params\n     if       fs-reply not = zero          *> should NOT happen as done in\n              perform System-Close          *> open-system\n              move    \"sys002\" to ws-called    *> create param file by requested info from user\n              call     ws-called using ws-calling-data file-defs\n              perform  System-Open\n              go to aa010-Get-System-Recs\n     end-if.\n     move     System-Record to WS-Temp-System-Rec.   *> save in case of sys-rec-4 overwrite\n*>\n*> BY PASS THIS CODE AS THE FILE WILL ALWAYS BE CURRENT.\n*>\n*>  We now have the param file along with RDB information so -\n*>  Check if RDB in use & if so, close Cobol file and open\n*>   and read the RDB system-rec but if recs do not exist\n*>    write using the Cobol file versions.\n*>\n*>     if       File-System-Used NOT = zero      *> RDB in use ( could be values 1 thru 5 but currently only 1)\n*>              move     File-System-Used to Arg-Number       *> save value from param in Cobol file\n*>              move     zero to File-System-Used             *> so we can close the cobol file\n*>              perform  System-Close                         *>  close cobol file\n*>              move     Arg-Number to File-System-Used       *> restore value from param in cobol file\n*>              move     \"66\" to FA-RDBMS-Flat-Statuses       *> Force RDB processing\n*>              move     4 to File-Key-No\n*>              perform  System-Open                          *> It could be values 1 thru 5 when the other RDBs are programmed for\n*>              perform  System-Read-Indexed                  *> Read in RDB table sys totals\n*>              if       fs-reply = zero\n*>                       move System-Record to WS-System-Record-4  *> overwrite cobol rec.\n*>              end-if\n*>              move     1 to File-Key-No\n*>              perform  System-Read-Indexed                  *> get the record from the RDB table\n*>              if       fs-reply not = zero                  *> but if error we have a problem such as someone forgot to run system load modules.\n*>                       move WS-Temp-System-Rec to System-Record   *> restore saved cobol file rec\n*>                       perform System-Write                 *> So create RDB row in SYSTEM-REC from the Cobol file data\n*>                       if      fs-reply not = zero\n*>                               display SY011    at 2301 with erase eos\n*>                               display fs-reply at 2348\n*>                               display SY008    at 2401\n*>                               accept  ws-Reply at 2432\n*>                               perform System-Close\n*>                               goback\n*>                       end-if\n*>              end-if\n*>     end-if.\n     perform  System-Close.\n*>\n*>   Back to work as we have the RDB rec if in use otherwise the Cobol one\n*>    regardless the system file/table is now closed with recs saved in WS.\n*>\n     move     run-date to u-bin.\n     call     \"maps04\" using maps03-ws.\n     move     u-date to to-day.\n     perform  zz060-Convert-Date.\n*>\n     if       not S-L\n              set S-L to true.\n*>\n     if       op-system = zero\n              move \"O/S\" to op-display.\n     if       linux   move \"Linux\"   To op-display\n     else if  Windows move \"Windows\" To op-display\n     else if  Mac     move \"Mac\"     To op-display\n     else if  OS2     move \"OS/2\"    To op-display\n     else if  unix    move \"Unix\"    To op-display\n     else if  dos     move \"Dos\"     To op-display.\n*>\n     if       Dos or Windows\n              move Windows-Backup-Script-Name to Script-Name\n     else if  OS2\n              move OS2-Backup-Script-Name to Script-Name\n     else if  Linux or Unix or Mac\n              move Linux-Backup-Script-Name to Script-Name.\n*>\n     string   ACAS_BIN     delimited by space\n              OS-Delimiter delimited by size\n              Script-Name  delimited by space  into Run-Backup\n     end-string\n     call     \"CBL_CHECK_FILE_EXIST\" using Run-Backup\n                                           File-Info\n     end-call\n     if       Return-Code not = zero\n*>          and Batch-Text (1:1) not = space\n              move \"No BackUp Script in Bin\" to Batch-Text\n     else\n              move 1 to Backup-Sw\n              string \"Using \"    delimited by size\n                     Script-Name delimited by space into Batch-Text\n     end-if\n*>\n*>\n*> 22/03/18 New code (from stock).\n*>\n*> Check to see if WS-Calling-Data set to auto to run a program (st0020 or st040).\n*>  A field within takes on the value of param 2 that is supplied when calling\n*>   stock where param 1 must be one of the following :\n*>     ACAS_LEDGERS=path   OR 'NONE' OR 'NO' OR 'NULL' (Case dont care),\n*>         where param 2 must be xl150 or ? (case dont care).\n*>",
        "line": 67
      },
      {
        "type": "IF",
        "condition": "WS-CD-Args (1:5) = \"xl150\"\n              move     \"xl150\"    to WS-Called\n              move     \"sales\"    to WS-Caller\n              move     zeros      to WS-Term-Code\n              move     spaces     to WS-Del-Link\n              move     zero       to WS-Process-Func\n              move     zero       to WS-Sub-Function\n              perform  Load00\n              go to    Pre-OverRewrite\n     end-if\n*>\n     move     zeros to ws-Process-Func ws-Sub-Function.\n     if       menu-reply = \"A\"            *> menu run for 1st time in run unit ONLY\n              go to load01.\n*>\n display-menu.\n     display  usera at 0101 with erase eos foreground-color 3.\n     move     to-day to u-date.\n     move     \"sales\" to ws-caller.\n     move     spaces to ws-called ws-del-link menu-reply.\n     move     zeros to ws-term-code.\n     move     maps-ser-nn to curs2.\n     display  maps-ser-xx at 2474 with foreground-color 3.\n     display  curs2 at 2476 with foreground-color 3.\n     display  \"Copyright (c) 1976-\" at 2401 with foreground-color 3.\n     display  wse-year at 2420 with foreground-color 3.\n     display  \" Applewood Computers\" at 2424 with foreground-color 3.\n*>\n Conv-date.\n*>\n*> Convert from UK to selected form\n*>\n     if       Date-Form not > zero and < 4\n              move 1 to Date-Form.\n     if       Date-USA\n              move u-date to ws-date\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              move ws-date to u-date\n     end-if\n     if       Date-Intl\n              move \"ccyy/mm/dd\" to ws-date   *> swap Intl to UK form\n              move u-date (7:4) to ws-Intl-Year\n              move u-date (4:2) to ws-Intl-Month\n              move u-date (1:2) to ws-Intl-Days\n              move ws-date to u-date\n     end-if.\n*>\n conv-date-end.\n     display  u-date at 0171 with foreground-color 3.\n*>\n Display-Go.\n*>\n     display  prog-name at 0301 with foreground-color 2.\n     display  \"Sales Ledger System Menu\" at 0329 with foreground-color 2.\n*>\n     accept   wsb-time from time.\n     if       wsb-time not = \"00000000\"\n              move wsb-hh to wsd-hh\n              move wsb-mm to wsd-mm\n              move wsb-ss to wsd-ss\n              display \"at \"    at 0355 with foreground-color 2\n              display wsd-time at 0358 with foreground-color 2.\n*>\n     accept   wsa-date from date.\n     if       wsa-date not = \"000000\"\n              move wsa-yy to u-year\n              move wsa-mm to u-month\n              move wsa-dd to u-days\n              display \"on \" at 0367 with foreground-color 2\n              perform conv-date\n              display u-date at 0370 with foreground-color 2.\n*>\n     display  \"Select one of the following by letter  :- [ ]\" at 0601 with foreground-color 2.\n*>\n     display  \"(A)  Date Entry\"                  at 1004 with foreground-color 2.\n     display  \"(B)  Customer File Maintenance\"   at 1104 with foreground-color 2.\n     display  \"(C)  Sales Ledger Enquiry\"        at 1204 with foreground-color 2.\n     display  \"(D)  Sales Transactions Input\"    at 1304 with foreground-color 2.\n     display  \"(E)  Sales Transactions Amend\"    at 1404 with foreground-color 2.\n     display  \"(F)  Sales Transactions Proof\"    at 1504 with foreground-color 2.\n     display  \"(G)  Sales Transactions Post\"     at 1604 with foreground-color 2.\n     display  \"(H)  Payment Input\"               at 1704 with foreground-color 2.\n     display  \"(I)  Payment Amend\"               at 1804 with foreground-color 2.\n     display  \"(J)  Payment Proof\"               at 1904 with foreground-color 2.\n     display  \"(K)  Payment Post\"                at 2004 with foreground-color 2.\n     display  \"(L)  Set-Up Sales Analysis Codes\" at 2104 with foreground-color 2.\n     display  \"(M)  Sales Analysis Report\"       at 2204 with foreground-color 2.\n     display  \"(N)  Sales Day Book\"              at 1044 with foreground-color 2.\n     display  \"(O)  Statement Production\"        at 1144 with foreground-color 2.\n     display  \"(P)  Dunning Letters Generation\"  at 1244 with foreground-color 2.\n     display  \"(Q)  Aged Debtors Analysis\"       at 1344 with foreground-color 2.\n     display  \"(R)  Alphabetical Customer List\"  at 1444 with foreground-color 2.\n     display  \"(S)  Customer Turnover Report\"    at 1544 with foreground-color 2.\n     display  \"(T)  Invoice Sub-System\"          at 1644 with foreground-color 2.\n     display  \"(U)  End of Cycle Processing\"     at 1744 with foreground-color 2.\n     display  \"(V)  Customer File Dump\"          at 1844 with foreground-color 2.\n     display  \"(X)  Exit To \"                    at 2044 with foreground-color 2.\n     display  Op-Display                         at 2057 with foreground-color 2.\n     display  batch-text                         at 2149 with foreground-color 2.\n*>     display  \"(Y)  File Fix Up\"                 at 2244  with foreground-color 2.  *> not available [25]\n     if       Param-Restrict not = \"Y\"\n              display  \"(Z)  System Setup\"       at 2344       with foreground-color 2.\n*>\n accept-loop.\n*>\n     accept   menu-reply at 0644 with foreground-color 6 auto UPPER.\n*>\n     if       menu-reply = \"X\"\n              go to pre-overrewrite.\n*>\n     if       menu-reply = \"Z\" and\n              Param-Restrict = \"Y\"\n              display  \"Not permitted\" at 2331 with foreground-color 2\n              go to display-menu.\n*>\n     move     zero to z.\n     move     letters-upper to letters.\n     set      q  to  1\n     search   a-entry\n              when a-entry (q) = menu-reply\n              set z to q.\n     if       z = zero\n              go to accept-loop.\n     go       to load-it.\n*>\n call-system-setup.\n*>****************\n*>\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.  *> Force Cobol proc.\n     move     zero to ws-term-code.\n     move     1 to File-Key-No.\n     perform  System-Open.\n     perform  System-Rewrite.                           *> in case of any changes\n     move     4 to File-Key-No.\n     move     WS-System-Record-4 to System-Record.\n     perform  System-Rewrite.\n     perform  System-Close.\n*>\n     move     \"sys002\" to ws-called.\n     call     ws-called using ws-calling-data file-defs. *> and we only use file00\n     if       ws-term-code > 7                           *> sys002 only terminates with 0\n              stop run.\n     go       to Open-System.\n*>\n pre-overrewrite.\n     if       not Backup-Script-Found\n              go to overrewrite.\n*>\n     if       Linux or Unix or Mac\n              string \"nohup \" delimited by size\n                      Run-Backup delimited by space\n                    \" 0</dev/null &>/dev/null &\" delimited by size into Full-Backup-Script\n              end-string\n     else\n      if      Dos or Windows\n              move Script-Name to Full-Backup-Script\n      else\n       if     OS2\n              move Script-Name to Full-Backup-Script.\n     perform  overrewrite.\n     call     \"SYSTEM\" using Full-Backup-Script.\n     goback.\n*>\n overrewrite.                                  *> save to RDB or file.\n     if       File-System-Used NOT = zero   *> Force RDB processing\n              move     \"66\" to FA-RDBMS-Flat-Statuses\n              move     1 to File-Key-No\n              perform  System-Open\n              move     1 to File-Key-No\n              move     System-Record to WS-Temp-System-Rec\n              perform  System-Rewrite\n              move     4 to File-Key-No\n              move     WS-System-Record-4 to System-Record\n              perform  System-Rewrite\n              perform  System-Close\n              move     WS-Temp-System-Rec to System-Record\n     end-if.\n*>\n*> Now do the same for the Cobol file.\n*>\n     move     zeros to File-System-Used\n                       File-Duplicates-In-Use.\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.   *> Force Cobol proc.\n     move     1 to File-Key-No.\n     perform  System-Open.                       *> Open cobol file params as I/O\n     move     1 to File-Key-No.\n     move     System-Record to WS-Temp-System-Rec.\n     perform  System-Rewrite.                    *> Update Cobol file params\n     move     4 to File-Key-No.\n     move     WS-System-Record-4 to System-Record.\n     perform  System-rewrite.                    *> Update Cobol file sys totals\n     move     WS-Temp-System-Rec to System-Record.\n     perform  System-Close.                      *> Close the Cobol param file.\n*>\n overclose.\n     goback.\n*>\n load-it.\n*>******\n*>\n     move     space to menu-reply.\n     go       to load01 load02 load03 load04 load05 load06 load07\n                 load08 load09 load10 load11 load12 load13 load14\n                 load15 load16 load17 load18 load19 load20 load21\n                 load22 loader loader loadsr call-system-setup\n              depending on z.\n*>\n loader.\n*>-----\n*>\n     go       to display-menu.\n*>\n load00.\n*>-----\n*>\n     move     zero to ws-term-code.\n     call     ws-called using ws-calling-data\n                              System-Record\n                              to-day\n                              file-defs\n     end-call\n     if       ws-term-code < 8\n       and    (ws-called = \"sl000\" or \"sl080\" or \"sl085\" or \"sl090\" or \"sl095\"\n                                  or \"sl100\" or \"sl115\" or \"sl200\" or \"sl910\"\n                                  or \"sl920\" or \"sl930\" )                          *> 200 ??  930 ??\n              perform overrewrite.     *> Update sys4 and system recs in case of changes.\n     if       ws-term-code > 7      *> Got a serious (reported) error\n              go to overrewrite.\n*>\n load00-exit.\n*>\n     go       to display-menu.\n*>\n load000.\n*>------\n*>\n     move     zero to ws-term-code.\n     call     ws-called using ws-calling-data\n                              System-Record\n                              WS-System-Record-4\n                              to-day\n                              file-defs\n     end-call\n     if       ws-term-code < 8  *> for sl055 & 060, xl150\n              perform overrewrite.    *> Update sys4 and system recs in case of changes.\n     if       ws-term-code > 7      *> Got a serious (reported) error\n              perform overrewrite\n              goback.\n*>\n load000-exit.\n*>\n     go       to display-menu.\n*>\n load01.\n*>-----\n*>\n     move     \"sl000\" to ws-called.\n     go       to load00.\n*>\n load02.\n*>-----\n*>\n     move     \"sl010\" to ws-called.\n     go       to load00.\n*>\n load03.\n*>-----\n*>\n     move     \"sl020\" to ws-called.\n     go       to load00.\n*>\n load04.\n*>-----\n*>\n     move     2 to pass-value.\n     move     \"sl910\" to ws-called.\n     go       to load00.\n*>\n load05.\n*>-----\n*>\n     move     4 to pass-value.\n     move     \"sl920\" to ws-called.\n     go       to load00.\n*>\n load06.\n*>-----\n*>\n     move     \"sl050\" to ws-called.\n     go       to load00.\n*>\n load07.             *> Sales trans posting\n*>-----\n*>\n     move     \"sl830\" to WS-Called.   *> In case autogen is use\n     perform  load00.\n     if       ws-term-code not = zero\n              go to display-menu.\n     move     \"sl055\" to ws-called.\n     perform  load000.\n     if       ws-term-code not = zero\n              go to display-menu.\n     move     \"sl060\" to ws-called.\n     go       to load000.\n*>\n load08.\n*>-----\n*>\n     move     \"sl080\" to ws-called.\n     go       to load00.\n*>\n load09.\n*>-----\n*>\n     move     \"sl085\" to ws-called.\n     go       to load00.\n*>\n load10.\n*>-----\n*>\n     if       FS-Cobol-Files-Used    *> well use fn-Read-By-Batch (32)\n              move     \"sl090\" to ws-called\n              perform  load00\n     end-if\n     move     \"sl095\" to ws-called.\n     go       to load00.\n*>\n load11.              *> Sales payments posting\n*>-----\n*>\n     move     \"sl100\" to ws-called.\n     go       to load000.\n*>\n load12.\n*>-----\n*>\n     move     \"sl070\" to ws-called.\n     go       to load00.\n*>\n load13.\n*>-----\n*>\n     move     \"sl130\" to ws-called.\n     go       to load00.\n*>\n load14.\n*>-----\n*>\n     move     \"sl140\" to ws-called.\n     go       to load00.\n*>\n load15.\n*>-----\n*>\n     if       FS-Cobol-Files-Used    *> well use fn-Read-By-Cust (33)\n              move     \"sl115\" to ws-called\n              perform  load00\n     end-if.\n     move     \"sl110\" to ws-called.\n     go       to load00.\n*>\n load16.\n*>-----\n*>\n*>  sl190 Was using otm3 - unsorted now changed to use sorted. 09/02/17\n*>\n     if       FS-Cobol-Files-Used    *> well use fn-Read-By-Cust (33)\n              move     \"sl115\" to ws-called\n              perform  load00\n     end-if.\n     move     \"sl190\" to ws-called.\n     go       to load00.\n*>\n load17.\n*>-----\n*>\n     if       FS-Cobol-Files-Used    *> well use fn-Read-By-Cust (33)\n              move     \"sl115\" to ws-called    *> OTM3 sort\n              perform  load00\n     end-if.\n     move     \"sl120\" to ws-called.   *> Aged debtors Rep.\n     go       to load000.\n*>\n load18.\n*>-----\n*>\n     if       FS-Cobol-Files-Used    *> well use fn-Read-By-Name (31)\n              move     \"sl165\" to ws-called\n              perform  load00\n     end-if.\n     move     \"sl160\" to ws-called.\n     go       to load00.\n*>\n load19.\n*>-----\n*>\n     move     \"sl180\" to ws-called.\n     go       to load00.\n*>\n load20.\n*>-----\n*>\n     move     \"sl900\" to ws-called.\n     go       to load00.\n*>\n load21.\n*>-----\n*>\n     if       ws-term-code = 3\n              go to load21a.\n*>\n     move     \"sl140\" to ws-called.\n     perform  load00.\n*>\n load21a.\n*>\n     move     \"xl150\" to ws-called.\n     perform  load000.\n     if       ws-term-code = 2 or 3\n              go to display-menu.\n     if       ws-term-code = 1\n              move \"sl130\" to ws-called\n              perform load00\n              move zero to ws-term-code\n              go to load21a.\n*>\n     go       to display-menu.\n*>\n load22.\n*>-----\n*>\n     move     \"sl170\" to ws-called.\n     go       to load00.\n*>\n loadsr.\n*>-----\n*>\n     display  \"Sorry not available\" at 2331 with foreground-color 2.\n     go       to accept-loop.\n*>\n main-exit.\n     goback.\n*>\n copy \"Proc-Get-Env-Set-Files.cob\".\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 464
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 7,
    "cognitive": 2,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 92,
      "totalOperators": 88,
      "totalOperands": 176,
      "vocabulary": 93,
      "length": 264,
      "volume": 1726.3379261325201
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
