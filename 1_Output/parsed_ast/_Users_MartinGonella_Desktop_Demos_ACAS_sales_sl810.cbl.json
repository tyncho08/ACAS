{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl810.cbl",
  "fileName": "sl810.cbl",
  "timestamp": "2025-09-15T16:25:29.816Z",
  "programId": "sl810",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "working-storage",
        "line": 141
      },
      {
        "name": "linkage",
        "line": 354
      },
      {
        "name": "init01",
        "line": 369
      },
      {
        "name": "Running-Totals",
        "line": 474
      },
      {
        "name": "Write-Details",
        "line": 503
      },
      {
        "name": "Read-Details",
        "line": 528
      },
      {
        "name": "Eval-Status",
        "line": 545
      },
      {
        "name": "Comm-Routines",
        "line": 555
      },
      {
        "name": "Inv-Level-1",
        "line": 607
      },
      {
        "name": "Get-Data-1",
        "line": 660
      },
      {
        "name": "Inv-Level-2",
        "line": 760
      },
      {
        "name": "Get-Data-2",
        "line": 824
      },
      {
        "name": "End-Totals",
        "line": 1215
      },
      {
        "name": "Total-Screen",
        "line": 1300
      },
      {
        "name": "Invoice-Details",
        "line": 1460
      },
      {
        "name": "Program-Start",
        "line": 1798
      },
      {
        "name": "zz050-Validate-Date",
        "line": 1860
      },
      {
        "name": "exit",
        "line": 1897
      },
      {
        "name": "zz060-Convert-Date",
        "line": 1899
      },
      {
        "name": "exit",
        "line": 1932
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1934
      },
      {
        "name": "exit",
        "line": 1962
      },
      {
        "name": "Maps04",
        "line": 1964
      },
      {
        "name": "exit",
        "line": 1970
      }
    ],
    "paragraphs": [
      {
        "name": "file-defs",
        "line": 366
      },
      {
        "name": "Main",
        "line": 410
      },
      {
        "name": "Data-Input",
        "line": 426
      },
      {
        "name": "More-Data",
        "line": 441
      },
      {
        "name": "sih-vat",
        "line": 478
      },
      {
        "name": "end-if",
        "line": 521
      },
      {
        "name": "end-perform",
        "line": 540
      },
      {
        "name": "Accept-Money6a",
        "line": 558
      },
      {
        "name": "Accept-Money6b",
        "line": 563
      },
      {
        "name": "Accept-Money6c",
        "line": 571
      },
      {
        "name": "Accept-Money7a",
        "line": 581
      },
      {
        "name": "Accept-Money7b",
        "line": 586
      },
      {
        "name": "Accept-Money7c",
        "line": 594
      },
      {
        "name": "Loop",
        "line": 621
      },
      {
        "name": "Get-Data-1-Main",
        "line": 665
      },
      {
        "name": "Get-Code",
        "line": 675
      },
      {
        "name": "Get-Net",
        "line": 717
      },
      {
        "name": "Get-Vat-Code",
        "line": 724
      },
      {
        "name": "Get-Vat-Rate",
        "line": 742
      },
      {
        "name": "Loop",
        "line": 779
      },
      {
        "name": "Get-Data-2-Main",
        "line": 842
      },
      {
        "name": "Get-Product",
        "line": 851
      },
      {
        "name": "Bypass-Product-Space-Tests",
        "line": 873
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 877
      },
      {
        "name": "Process-Stock-Record",
        "line": 1019
      },
      {
        "name": "Get-Code",
        "line": 1053
      },
      {
        "name": "Get-Desc",
        "line": 1076
      },
      {
        "name": "Get-Qty",
        "line": 1104
      },
      {
        "name": "Get-Unit",
        "line": 1121
      },
      {
        "name": "Recomp-Net",
        "line": 1128
      },
      {
        "name": "Get-Disc",
        "line": 1138
      },
      {
        "name": "Get-Vat-Code",
        "line": 1159
      },
      {
        "name": "Jump-Totals",
        "line": 1195
      },
      {
        "name": "Test-For-Read-Stock",
        "line": 1202
      },
      {
        "name": "end-if",
        "line": 1210
      },
      {
        "name": "End-Totals-Main",
        "line": 1218
      },
      {
        "name": "Confirmation",
        "line": 1241
      },
      {
        "name": "Get-Days",
        "line": 1349
      },
      {
        "name": "Get-Extra",
        "line": 1364
      },
      {
        "name": "Get-Extra-Vat",
        "line": 1379
      },
      {
        "name": "Get-Carriage",
        "line": 1398
      },
      {
        "name": "Get-Carriage-Vat",
        "line": 1406
      },
      {
        "name": "Get-Deduct-Amt",
        "line": 1413
      },
      {
        "name": "Get-Deduct-Vat",
        "line": 1438
      },
      {
        "name": "Get-Deduct-Days",
        "line": 1451
      },
      {
        "name": "Invoice-Details-Main",
        "line": 1463
      },
      {
        "name": "Customer-Input",
        "line": 1509
      },
      {
        "name": "Customer-Test",
        "line": 1522
      },
      {
        "name": "Delivery-Read",
        "line": 1542
      },
      {
        "name": "Customer-Setup",
        "line": 1558
      },
      {
        "name": "Customer-Display",
        "line": 1562
      },
      {
        "name": "Check-For-Delete-Amend",
        "line": 1595
      },
      {
        "name": "end-if",
        "line": 1618
      },
      {
        "name": "Get-Invoice-No",
        "line": 1622
      },
      {
        "name": "Repeat-Count-Input",
        "line": 1632
      },
      {
        "name": "Freq-Input",
        "line": 1647
      },
      {
        "name": "Date-Input",
        "line": 1655
      },
      {
        "name": "Ref-Input",
        "line": 1677
      },
      {
        "name": "Type-Input",
        "line": 1682
      },
      {
        "name": "Delete-Current-Record",
        "line": 1747
      },
      {
        "name": "New-Customer",
        "line": 1778
      },
      {
        "name": "end-if",
        "line": 1855
      },
      {
        "name": "zz050-Test-Date",
        "line": 1891
      },
      {
        "name": "zz050-exit",
        "line": 1896
      },
      {
        "name": "zz060-Exit",
        "line": 1931
      },
      {
        "name": "zz070-Exit",
        "line": 1961
      },
      {
        "name": "maps04-exit",
        "line": 1969
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "scr_dump",
        "line": 399,
        "type": "DYNAMIC",
        "using": [
          "wScreenName",
          "returning",
          "wInt",
          "*>",
          "perform",
          "abc",
          "*>",
          "call",
          "\"scr_restore\"",
          "using",
          "wScreenName",
          "returning",
          "wInt",
          "*>",
          "call",
          "\"CBL_DELETE_FILE\"",
          "using",
          "Path-Work",
          "*>",
          "go",
          "to",
          "xxx"
        ]
      },
      {
        "target": "sl960",
        "line": 1791,
        "type": "DYNAMIC",
        "using": [
          "WS-calling-data",
          "system-record",
          "to-day"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1804,
        "type": "DYNAMIC",
        "using": [
          "File-15",
          "*>",
          "Analysis",
          "Needed",
          "for",
          "sl820",
          "?",
          "&",
          "sl830",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "move",
          "1",
          "to",
          "WS-Process-Func",
          "WS-Sub-Function",
          "call",
          "\"sl070\"",
          "using",
          "WS-calling-data",
          "system-record",
          "to-day",
          "file-defs",
          "call",
          "\"CBL_CHECK_FILE_EXIST\"",
          "using",
          "File-15",
          "*>",
          "Only",
          "if",
          "the",
          "call",
          "failed",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "SL192",
          "at",
          "2301",
          "display",
          "SL003",
          "at",
          "2401",
          "accept",
          "WS-Reply",
          "at",
          "2430",
          "end-if",
          "end-if",
          "end-if",
          "*>",
          "perform",
          "Sales-Open"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1829,
        "type": "DYNAMIC",
        "using": [
          "File-4",
          "*>",
          "slautogen",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "perform",
          "SLautogen-Open-Output",
          "*>",
          "open",
          "output",
          "SLautogen-file",
          "perform",
          "SLautogen-Close",
          "*>",
          "close",
          "SLautogen-file",
          "move",
          "\"Y\"",
          "to",
          "SL-Autogen",
          "move",
          "1",
          "to",
          "SL-Next-Rec",
          "*>",
          "SIMILAR",
          "TO",
          "NEXT",
          "INVOICE",
          "#",
          "end-if",
          "*>",
          "as",
          "file",
          "is",
          "ISAM",
          "end-if",
          "*>",
          "move",
          "zero",
          "to",
          "Menu-Reply"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1846,
        "type": "DYNAMIC",
        "using": [
          "File-11",
          "*>",
          "Stock",
          "file",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "perform",
          "Stock-Open-Output",
          "*>",
          "open",
          "output",
          "stock-file",
          "*>",
          "OC",
          "doesnt",
          "create",
          "in",
          "i-o",
          "-",
          "possible",
          "bug",
          "perform",
          "Stock-Close",
          "*>",
          "close",
          "stock-file",
          "end-if",
          "perform",
          "Stock-Open",
          "*>",
          "open",
          "i-o",
          "stock-file",
          "Thats",
          "ok",
          "we",
          "just",
          "wont",
          "find",
          "any",
          "items",
          "end-if",
          "end-if"
        ]
      },
      {
        "target": "maps04",
        "line": 1967,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 127,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 136,
        "replacing": null
      },
      {
        "name": "slwsinv",
        "line": 148,
        "replacing": null
      },
      {
        "name": "slwsinv2",
        "line": 149,
        "replacing": null
      },
      {
        "name": "wsanal",
        "line": 152,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 153,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 154,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 155,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 157,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 158,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 292,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 323,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 357,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 358,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 359,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 549,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1972,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "instead",
        "thru": null,
        "line": 85
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 382
      },
      {
        "target": "abc",
        "thru": null,
        "line": 400
      },
      {
        "target": "Program-Start",
        "thru": null,
        "line": 408
      },
      {
        "target": "Invoice-Details",
        "thru": null,
        "line": 413
      },
      {
        "target": "Inv-Level-1",
        "thru": null,
        "line": 432
      },
      {
        "target": "Inv-Level-2",
        "thru": null,
        "line": 434
      },
      {
        "target": "End-Totals",
        "thru": null,
        "line": 439
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 459
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 460
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 461
      },
      {
        "target": "SLautogen-Close",
        "thru": null,
        "line": 462
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 465
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 466
      },
      {
        "target": "varying",
        "thru": null,
        "line": 480
      },
      {
        "target": "*>",
        "thru": null,
        "line": 483
      },
      {
        "target": "SLautogen-Write",
        "thru": null,
        "line": 511
      },
      {
        "target": "Eval-Status",
        "thru": null,
        "line": 513
      },
      {
        "target": "Update-Stock-n-Audit",
        "thru": null,
        "line": 523
      },
      {
        "target": "sih-lines",
        "thru": null,
        "line": 532
      },
      {
        "target": "SLautogen-Read-Next",
        "thru": null,
        "line": 536
      },
      {
        "target": "varying",
        "thru": null,
        "line": 624
      },
      {
        "target": "*>",
        "thru": null,
        "line": 636
      },
      {
        "target": "Get-Data-1",
        "thru": null,
        "line": 646
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 708
      },
      {
        "target": "Accept-Money7a",
        "thru": "Accept-Money7b",
        "line": 719
      },
      {
        "target": "Accept-Money6c",
        "thru": null,
        "line": 744
      },
      {
        "target": "Running-Totals",
        "thru": null,
        "line": 751
      },
      {
        "target": "varying",
        "thru": null,
        "line": 780
      },
      {
        "target": "*>",
        "thru": null,
        "line": 792
      },
      {
        "target": "Get-Data-2",
        "thru": null,
        "line": 810
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 905
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 911
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 923
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 945
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 951
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 973
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1000
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1010
      },
      {
        "target": "Test-For-Read-Stock",
        "thru": null,
        "line": 1017
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 1071
      },
      {
        "target": "Accept-Money7a",
        "thru": "Accept-Money7b",
        "line": 1123
      },
      {
        "target": "Running-Totals",
        "thru": null,
        "line": 1193
      },
      {
        "target": "Eval-Status",
        "thru": null,
        "line": 1204
      },
      {
        "target": "Total-Screen",
        "thru": null,
        "line": 1220
      },
      {
        "target": "SLautogen-Write",
        "thru": null,
        "line": 1271
      },
      {
        "target": "SLautogen-Rewrite",
        "thru": null,
        "line": 1274
      },
      {
        "target": "Eval-Status",
        "thru": null,
        "line": 1277
      },
      {
        "target": "Write-Details",
        "thru": null,
        "line": 1288
      },
      {
        "target": "Accept-Money7c",
        "thru": null,
        "line": 1376
      },
      {
        "target": "Accept-Money6c",
        "thru": null,
        "line": 1387
      },
      {
        "target": "Accept-Money7a",
        "thru": "Accept-Money7b",
        "line": 1400
      },
      {
        "target": "Accept-Money6c",
        "thru": null,
        "line": 1408
      },
      {
        "target": "Accept-Money7c",
        "thru": null,
        "line": 1435
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 1466
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 1532
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 1549
      },
      {
        "target": "SLautogen-Read-Indexed",
        "thru": null,
        "line": 1608
      },
      {
        "target": "Read-Details",
        "thru": null,
        "line": 1617
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1658
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1667
      },
      {
        "target": "SLautogen-Delete-All",
        "thru": null,
        "line": 1762
      },
      {
        "target": "SLautogen-Delete",
        "thru": null,
        "line": 1764
      },
      {
        "target": "sih-lines",
        "thru": null,
        "line": 1767
      },
      {
        "target": "SLautogen-Delete",
        "thru": null,
        "line": 1770
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1771
      },
      {
        "target": "SLautogen-Close",
        "thru": null,
        "line": 1779
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1781
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1782
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 1783
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1785
      },
      {
        "target": "Stock-Audit-Close",
        "thru": null,
        "line": 1787
      },
      {
        "target": "program-start",
        "thru": null,
        "line": 1792
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1822
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 1823
      },
      {
        "target": "Analysis-Open",
        "thru": null,
        "line": 1824
      },
      {
        "target": "SLautogen-Open-Output",
        "thru": null,
        "line": 1832
      },
      {
        "target": "SLautogen-Close",
        "thru": null,
        "line": 1833
      },
      {
        "target": "SLautogen-Open",
        "thru": null,
        "line": 1840
      },
      {
        "target": "Stock-Open-Output",
        "thru": null,
        "line": 1850
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1851
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 1853
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1894
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1908
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines",
        "line": 374
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 383
      },
      {
        "from": "spaces",
        "to": "Path-Work",
        "line": 387
      },
      {
        "from": "z\"sl-temp.scr\"",
        "to": "wScreenName\n *>             call     \"scr_dump\"    using wScreenName returning wInt\n *>             perform  abc\n *>             call     \"scr_restore\" using wScreenName returning wInt\n *>             call     \"CBL_DELETE_FILE\" using Path-Work\n *>             go to xxx",
        "line": 398
      },
      {
        "from": "space",
        "to": "WS-Service-Only",
        "line": 412
      },
      {
        "from": "16",
        "to": "lin",
        "line": 422
      },
      {
        "from": "1",
        "to": "cole",
        "line": 423
      },
      {
        "from": "zero",
        "to": "i",
        "line": 429
      },
      {
        "from": "zero",
        "to": "Cob-Crt-Status",
        "line": 443
      },
      {
        "from": "\"Y\"",
        "to": "WS-reply",
        "line": 444
      },
      {
        "from": "zero",
        "to": "pass-value",
        "line": 458
      },
      {
        "from": "zero",
        "to": "sih-Net\n                        sih-vat",
        "line": 477
      },
      {
        "from": "sih-Net",
        "to": "display-9",
        "line": 485
      },
      {
        "from": "sih-vat",
        "to": "display-9",
        "line": 489
      },
      {
        "from": "sih-invoice",
        "to": "sil-invoice (j)",
        "line": 507
      },
      {
        "from": "j",
        "to": "sil-line (j)",
        "line": 508
      },
      {
        "from": "sih-type",
        "to": "sil-type (j)",
        "line": 509
      },
      {
        "from": "zero",
        "to": "j",
        "line": 531
      },
      {
        "from": "sih-invoice",
        "to": "invoice-nos   *>  IS THIS CORRECT\n              move j to item-nos                *>  IS THIS CORRECT\n              perform SLautogen-Read-Next\n              if      FS-Reply = zeros\n                      move WS-Invoice-Record to Invoice-Lines (j)\n              end-if\n     end-perform",
        "line": 534
      },
      {
        "from": "spaces",
        "to": "exception-msg",
        "line": 548
      },
      {
        "from": "zero",
        "to": "WS-poundsd6 WS-penced6 amt-ok6",
        "line": 561
      },
      {
        "from": "WS-pound6",
        "to": "amt-wk-pds6",
        "line": 568
      },
      {
        "from": "WS-pence6",
        "to": "amt-wk-pence6",
        "line": 569
      },
      {
        "from": "amt-wk-pence6",
        "to": "WS-pence6",
        "line": 574
      },
      {
        "from": "amt-wk-pds6",
        "to": "WS-pound6",
        "line": 575
      },
      {
        "from": "WS-pound6",
        "to": "amt-wk-pds6",
        "line": 578
      },
      {
        "from": "WS-pence6",
        "to": "amt-wk-pence6",
        "line": 579
      },
      {
        "from": "zero",
        "to": "WS-poundsd7 WS-penced7 amt-ok7",
        "line": 584
      },
      {
        "from": "WS-pound7",
        "to": "amt-wk-pds7",
        "line": 591
      },
      {
        "from": "WS-pence7",
        "to": "amt-wk-pence7",
        "line": 592
      },
      {
        "from": "amt-wk-pence7",
        "to": "WS-pence7",
        "line": 597
      },
      {
        "from": "amt-wk-pds7",
        "to": "WS-pound7",
        "line": 598
      },
      {
        "from": "WS-pound7",
        "to": "amt-wk-pds7",
        "line": 601
      },
      {
        "from": "WS-pence7",
        "to": "amt-wk-pence7",
        "line": 602
      },
      {
        "from": "1",
        "to": "cole\n              display  \"(\" at curs with erase eol foreground-color 2\n              move     2 to cole\n              display  i at curs with foreground-color 2\n              move     4 to cole\n              display  \") [  ]\" at curs with foreground-color 2\n              move     36 to cole\n              display  \"[          ] [ ]   {         } (\" at curs with foreground-color 2\n              move     78 to cole\n              display  \")\" at curs       with foreground-color 2\n     end-perform\n*>\n*> i = no",
        "line": 626
      },
      {
        "from": "1",
        "to": "i ?????\n*>\n*>     subtract 16 from WS-23-Lines giving m",
        "line": 639
      },
      {
        "from": "1",
        "to": "i\n     subtract WS-Accept-Body  from  i",
        "line": 641
      },
      {
        "from": "1",
        "to": "j",
        "line": 643
      },
      {
        "from": "zero",
        "to": "Cob-Crt-Status",
        "line": 645
      },
      {
        "from": "1",
        "to": "new-screen\n              go to  Main-Exit",
        "line": 670
      },
      {
        "from": "zero",
        "to": "new-screen",
        "line": 673
      },
      {
        "from": "7",
        "to": "cole",
        "line": 681
      },
      {
        "from": "WS-pa",
        "to": "sil-pa (i) pa-group",
        "line": 684
      },
      {
        "from": "spaces",
        "to": "sil-description (i)",
        "line": 685
      },
      {
        "from": "\"S\"",
        "to": "pa-system",
        "line": 705
      },
      {
        "from": "11",
        "to": "cole",
        "line": 706
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 707
      },
      {
        "from": "PA-Desc",
        "to": "sil-description (i)",
        "line": 715
      },
      {
        "from": "37",
        "to": "cole",
        "line": 718
      },
      {
        "from": "amt-ok7",
        "to": "sil-Net (i) WS-Net",
        "line": 722
      },
      {
        "from": "50",
        "to": "cole",
        "line": 729
      },
      {
        "from": "Vat-Code",
        "to": "sil-Vat-Code (i)",
        "line": 735
      },
      {
        "from": "zero",
        "to": "amt-ok6\n       else\n              move vat-rate (Vat-Code) to WS-vat-rate\n              compute amt-ok6 rounded =  (WS-Net * WS-vat-rate) / 100",
        "line": 737
      },
      {
        "from": "56",
        "to": "cole",
        "line": 743
      },
      {
        "from": "amt-ok6",
        "to": "sil-vat (i) WS-vat",
        "line": 745
      },
      {
        "from": "68",
        "to": "cole",
        "line": 748
      },
      {
        "from": "1",
        "to": "cole\n              if      SL-Stock-Link = \"N\"\t\t*> No stock then process PA code\n                      display \"[             ][  ][\" at curs with foreground-color 2 erase eol\n                      move    51 to cole\n                      display   \"][     ][          ][     ][ ]\" at curs  with foreground-color 2\n              else\t\t\t\t*> ignore PA\n                      display \"[             ][\" at curs with foreground-color 2 erase eol\n                      move    49 to cole\n                      display \"]  [     ][          ][     ][ ]\" at curs  with foreground-color 2\n              end-if\n     end-perform\n*>\n*> This is what the item capture displays look like & 1st is for non-linked\n*>   stock Control:\n*>\n*>    Product    Code <---------Description-------->   Qty   Unit Price  Disc",
        "line": 782
      },
      {
        "from": "1",
        "to": "i = pos",
        "line": 803
      },
      {
        "from": "1",
        "to": "j",
        "line": 806
      },
      {
        "from": "1",
        "to": "new-screen\n              go to  Main-Exit",
        "line": 846
      },
      {
        "from": "zero",
        "to": "new-screen",
        "line": 849
      },
      {
        "from": "2",
        "to": "cole",
        "line": 857
      },
      {
        "from": "spaces",
        "to": "sil-description (i)",
        "line": 861
      },
      {
        "from": "WS-product",
        "to": "sil-product (i)\n                            test-product\n                            WS-Temp-Stock-Key",
        "line": 875
      },
      {
        "from": "zero",
        "to": "WS-Net WS-unit WS-qty\n              go to  Get-desc",
        "line": 880
      },
      {
        "from": "17",
        "to": "cole",
        "line": 889
      },
      {
        "from": "WS-Abrev-Stock",
        "to": "WS-Stock-Abrev-Key\n              move  2 to File-Key-No\n              set fn-not-less-than to true\n              perform Stock-Start              *> start Stock-File key not < WS-Stock-Abrev-Key invalid key\n              if    FS-Reply = 21\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if             *> end-start\n              perform Stock-Read-Next        *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                         *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> have we the right one?\n              display WS-Stock-Desc at curs with foreground-color 3\n              go to Get-Product\n     end-if\n*>\n     if       Cob-Crt-Status = Cob-Scr-F2                *> read next record\n              perform Stock-Read-Next      *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                       *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> have we the right one?\n              display WS-Stock-Desc at curs with foreground-color 3\n              go to Get-Product\n     end-if\n*>\n*> Search on Desc",
        "line": 902
      },
      {
        "from": "WS-Description",
        "to": "WS-Stock-Desc\n              move  3 to File-Key-No         *> start Stock-File key not < WS-Stock-Desc invalid key\n              set fn-not-less-than to true\n              perform Stock-Start\n              if    FS-Reply = 21\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-Product\n              end-if                      *> end-start\n              perform Stock-Read-Next     *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-Product\n              end-if                      *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> Got the right one? Show desc, stock held & retail price\n                                         WS-Product\n              display WS-Stock-Desc at curs with foreground-color 3 highlight\n              move Stock-Held to WS-Qty\n              display WS-Qty at line lin col 53 with foreground-color 3 highlight\n              display \"Hit return (for testing)\" at 2401  *> TESTING ONLY\n              accept WS-reply at 2425            *> TESTING ONLY\n              display \" \" at 2401 with erase eol *> TESTING ONLY\n              move Stock-Retail to amt-ok7\n              move amt-wk-pds7   to WS-pound7\n              move amt-wk-pence7 to WS-pence7\n              display WS-amount-screen-display7 at line lin col 60 with foreground-color 3 highlight\n              go to Get-Product\n     end-if\n*>\n     if       Cob-Crt-Status = Cob-Scr-F5      *> Read next on Desc",
        "line": 942
      },
      {
        "from": "SL196",
        "to": "WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                        *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> Got the right one? Show desc, stock held & retail price\n                                      WS-Product\n              display WS-Stock-Desc at curs with foreground-color 3 highlight\n              move Stock-Held to WS-Qty\n              display WS-Qty at line lin col 53 with foreground-color 3 highlight\n              move Stock-Retail to amt-ok7\n              move amt-wk-pds7   to WS-pound7\n              move amt-wk-pence7 to WS-pence7\n              display WS-amount-screen-display7 at line lin col 60 with foreground-color 3 highlight\n              go to Get-Product\n     end-if\n*>\n*> So, no special function just search for entered key\n*>\n     if       WS-Stock-No-Long = spaces\n              move WS-Abrev-Stock to WS-Stock-Abrev-Key\n              move 2 to File-Key-No\n     else\n              move WS-Temp-Stock-Key to WS-Stock-Key\n              move 1 to File-Key-No\n     end-if\n     perform  Stock-Read-Indexed    *> read Stock-File record key WS-Stock-Abrev-Key invalid key\n     if       FS-Reply = 21\n              move SL196 to WS-Stock-Desc\n              display WS-Stock-Desc at curs with foreground-color 4\n              go to Get-product\n     end-if                        *> end-read\n*>\n*> can shorten code now so rem out next block vbc 27/08/17\n*>\n *>    else\n *>             perform Stock-Read-Indexed    *> read Stock-File key WS-Stock-Key invalid key\n *>             if   FS-Reply = 21\n *>                  move SL196 to WS-Stock-Desc\n *>                  display WS-Stock-Desc at curs with foreground-color 4\n *>                  go to Get-product\n *>             end-if                        *> end-read\n *>    end-if\n     perform  Test-For-Read-Stock",
        "line": 975
      },
      {
        "from": "17",
        "to": "cole",
        "line": 1025
      },
      {
        "from": "Stock-sa-Group",
        "to": "WS-pa pa-group sil-pa (i)",
        "line": 1026
      },
      {
        "from": "WS-Stock-Desc",
        "to": "WS-description sil-description (i)",
        "line": 1028
      },
      {
        "from": "Stock-Retail",
        "to": "amt-ok7",
        "line": 1029
      },
      {
        "from": "Stock-Retail",
        "to": "WS-Unit",
        "line": 1030
      },
      {
        "from": "amt-wk-pds7",
        "to": "WS-pound7",
        "line": 1031
      },
      {
        "from": "amt-wk-pence7",
        "to": "WS-pence7",
        "line": 1032
      },
      {
        "from": "Stock-Held",
        "to": "WS-qty",
        "line": 1034
      },
      {
        "from": "1",
        "to": "WS-Qty",
        "line": 1035
      },
      {
        "from": "\"N\"",
        "to": "WS-Service-Only",
        "line": 1037
      },
      {
        "from": "17",
        "to": "cole",
        "line": 1059
      },
      {
        "from": "spaces",
        "to": "sil-description (i)",
        "line": 1062
      },
      {
        "from": "WS-pa",
        "to": "pa-group sil-pa (i)",
        "line": 1067
      },
      {
        "from": "\"S\"",
        "to": "pa-system",
        "line": 1068
      },
      {
        "from": "21",
        "to": "cole",
        "line": 1069
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1070
      },
      {
        "from": "17",
        "to": "cole\n     else\n              move 21 to cole",
        "line": 1083
      },
      {
        "from": "WS-description",
        "to": "sil-description (i)",
        "line": 1090
      },
      {
        "from": "\"B\"",
        "to": "Escape-Code\n     else\n              move space to Escape-Code",
        "line": 1092
      },
      {
        "from": "zero",
        "to": "WS-qty",
        "line": 1106
      },
      {
        "from": "53",
        "to": "cole",
        "line": 1107
      },
      {
        "from": "Stock-Held",
        "to": "WS-Qty\n              go to Get-Qty",
        "line": 1115
      },
      {
        "from": "60",
        "to": "cole",
        "line": 1122
      },
      {
        "from": "amt-ok7",
        "to": "WS-unit",
        "line": 1126
      },
      {
        "from": "WS-Net",
        "to": "display-9 sil-Net (i)",
        "line": 1133
      },
      {
        "from": "WS-qty",
        "to": "sil-qty (i)",
        "line": 1134
      },
      {
        "from": "WS-unit",
        "to": "sil-unit (i)",
        "line": 1135
      },
      {
        "from": "Sales-Discount",
        "to": "WS-discount",
        "line": 1139
      },
      {
        "from": "72",
        "to": "cole",
        "line": 1140
      },
      {
        "from": "WS-disc-wka",
        "to": "WS-disca1",
        "line": 1141
      },
      {
        "from": "WS-disc-wkb",
        "to": "WS-disca3",
        "line": 1142
      },
      {
        "from": "WS-discb1",
        "to": "WS-disc-wka",
        "line": 1145
      },
      {
        "from": "WS-discb3",
        "to": "WS-disc-wkb",
        "line": 1146
      },
      {
        "from": "WS-discount",
        "to": "work-d sil-discount (i)",
        "line": 1148
      },
      {
        "from": "WS-Net",
        "to": "work-n",
        "line": 1149
      },
      {
        "from": "WS-Net",
        "to": "sil-Net (i) display-9",
        "line": 1156
      },
      {
        "from": "\"S\"",
        "to": "Vat-Code-X",
        "line": 1160
      },
      {
        "from": "79",
        "to": "cole",
        "line": 1161
      },
      {
        "from": "1",
        "to": "Vat-Code\n      else\n       if     Vat-Code-X = \"R\"                   *> Reduced  code 2 (05% - 01/01/17)\n              move 2 to Vat-Code\n        else\n         if   Vat-Code-X = \"Z\"                   *> Zero     code 3 (00% - 01/01/17)\n              move 3 to Vat-Code",
        "line": 1171
      },
      {
        "from": "Vat-Code",
        "to": "sil-Vat-Code (i)",
        "line": 1182
      },
      {
        "from": "zero",
        "to": "WS-vat\n       else\n              move vat-rate (Vat-Code) to WS-vat-rate\n              compute  WS-vat rounded =  (WS-Net * WS-vat-rate) / 100",
        "line": 1185
      },
      {
        "from": "WS-vat",
        "to": "display-9 sil-vat (i)",
        "line": 1190
      },
      {
        "from": "zero",
        "to": "Cob-Crt-Status",
        "line": 1219
      },
      {
        "from": "15",
        "to": "lin",
        "line": 1224
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1225
      },
      {
        "from": "\"Y\"",
        "to": "WS-reply",
        "line": 1244
      },
      {
        "from": "\"Q\"",
        "to": "Escape-Code\n              go to Main-Exit",
        "line": 1249
      },
      {
        "from": "\"P\"",
        "to": "sih-status",
        "line": 1258
      },
      {
        "from": "space",
        "to": "sih-status-P",
        "line": 1259
      },
      {
        "from": "\"P\"",
        "to": "sih-status-P",
        "line": 1265
      },
      {
        "from": "i",
        "to": "sih-lines",
        "line": 1267
      },
      {
        "from": "sinvoice-header",
        "to": "WS-Invoice-Record",
        "line": 1269
      },
      {
        "from": "zero",
        "to": "j",
        "line": 1287
      },
      {
        "from": "1",
        "to": "s-flag-i",
        "line": 1290
      },
      {
        "from": "11",
        "to": "lin",
        "line": 1291
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1292
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1303
      },
      {
        "from": "11",
        "to": "lin",
        "line": 1304
      },
      {
        "from": "1",
        "to": "Menu-Reply\n     else\n              move  2  to  Menu-Reply",
        "line": 1309
      },
      {
        "from": "sih-Net",
        "to": "display-9",
        "line": 1340
      },
      {
        "from": "sih-vat",
        "to": "display-8",
        "line": 1343
      },
      {
        "from": "zero",
        "to": "sih-days sih-carriage",
        "line": 1350
      },
      {
        "from": "sales-credit",
        "to": "sih-days\n     else if  sih-type = 4\n              move pf-retention to sih-days",
        "line": 1352
      },
      {
        "from": "sih-days",
        "to": "WS-dayes",
        "line": 1355
      },
      {
        "from": "WS-dayes",
        "to": "sih-days",
        "line": 1362
      },
      {
        "from": "zero",
        "to": "sih-extra sih-e-vat\n              go to Get-carriage",
        "line": 1366
      },
      {
        "from": "zero",
        "to": "sih-extra",
        "line": 1372
      },
      {
        "from": "1526",
        "to": "curs",
        "line": 1374
      },
      {
        "from": "sih-extra",
        "to": "amt-ok7",
        "line": 1375
      },
      {
        "from": "amt-ok7",
        "to": "sih-extra",
        "line": 1377
      },
      {
        "from": "zero",
        "to": "sih-e-vat\n              go to Get-carriage",
        "line": 1381
      },
      {
        "from": "1541",
        "to": "curs",
        "line": 1386
      },
      {
        "from": "amt-ok6",
        "to": "sih-e-vat",
        "line": 1388
      },
      {
        "from": "1626",
        "to": "curs",
        "line": 1399
      },
      {
        "from": "amt-ok7",
        "to": "sih-carriage",
        "line": 1401
      },
      {
        "from": "1641",
        "to": "curs",
        "line": 1407
      },
      {
        "from": "amt-ok6",
        "to": "sih-c-vat",
        "line": 1409
      },
      {
        "from": "\"Z\"",
        "to": "WS-named",
        "line": 1418
      },
      {
        "from": "zero",
        "to": "sih-deduct-amt sih-deduct-vat sih-deduct-days\n              go to  Main-Exit",
        "line": 1422
      },
      {
        "from": "zero",
        "to": "sih-deduct-amt sih-deduct-vat sih-deduct-days\n *>             go to  Main-Exit",
        "line": 1426
      },
      {
        "from": "4",
        "to": "amt-ok7",
        "line": 1432
      },
      {
        "from": "1726",
        "to": "curs",
        "line": 1434
      },
      {
        "from": "amt-ok7",
        "to": "sih-deduct-amt",
        "line": 1436
      },
      {
        "from": "zeros",
        "to": "sih-deduct-vat",
        "line": 1439
      },
      {
        "from": "sih-days",
        "to": "WS-dayes",
        "line": 1452
      },
      {
        "from": "WS-dayes",
        "to": "sih-deduct-days",
        "line": 1455
      },
      {
        "from": "\"E\"",
        "to": "WS-Entry-Mode",
        "line": 1475
      },
      {
        "from": "\"E\"",
        "to": "WS-Entry-Mode\n     else\n       if     Cob-Crt-Status = Cob-Scr-F3\n              move \"U\" to WS-Entry-Mode\n       else\n         if   Cob-Crt-Status = Cob-Scr-F4\n              move \"D\" to WS-Entry-Mode\n         else\n          if  Cob-Crt-Status = Cob-Scr-Esc\n              move  \"Q\"  to  Escape-Code\n              go to  Main-Exit\n          else\n           if not WS-Valid-Modes\n              display \"SL197 Invalid mode - try again\"   at 0401  with foreground-color 2 BEEP\n              go to Invoice-Details-Main",
        "line": 1478
      },
      {
        "from": "spaces",
        "to": "sih-customer",
        "line": 1510
      },
      {
        "from": "zero",
        "to": "Cob-Crt-Status",
        "line": 1511
      },
      {
        "from": "\"Y\"",
        "to": "WS-Show-Delivery\n     else\n              move \"N\" to WS-Show-Delivery",
        "line": 1518
      },
      {
        "from": "\"Q\"",
        "to": "Escape-Code\n              go to  Main-Exit",
        "line": 1525
      },
      {
        "from": "1",
        "to": "c-check",
        "line": 1528
      },
      {
        "from": "sih-customer",
        "to": "WS-Sales-Key",
        "line": 1529
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1531
      },
      {
        "from": "zero",
        "to": "c-check",
        "line": 1534
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1547
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1548
      },
      {
        "from": "zero",
        "to": "delivery-tag\n              go to  Customer-Setup",
        "line": 1551
      },
      {
        "from": "deliv-address",
        "to": "address-a",
        "line": 1554
      },
      {
        "from": "sales-address",
        "to": "address-a",
        "line": 1560
      },
      {
        "from": "1",
        "to": "z",
        "line": 1568
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1569
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1574
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1579
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1584
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1589
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1593
      },
      {
        "from": "zero",
        "to": "sih-Test\n                               sih-Invoice\n              accept   sih-Invoice  at 0469 with foreground-color 3 update\n              if       sih-Invoice = zero\n                or     Cob-Crt-Status = Cob-Scr-Esc\n                       move  \"Q\"  to  Escape-Code\n                       go to  Main-Exit\n              end-if\n              move     1 to File-Key-No\n              move     sih-Invoice to Invoice-Nos\n              move     zero to Item-Nos\n              perform  SLautogen-Read-Indexed    *> Get header record\n              if       fs-reply not = zero   *> was = 21mariadb-10",
        "line": 1597
      },
      {
        "from": "SL-Next-Rec",
        "to": "WS-Next-Inv\n              display  WS-Next-Inv at 0469 with foreground-color 7       *> White\n              add      1 to SL-Next-Rec",
        "line": 1624
      },
      {
        "from": "\"Y\"",
        "to": "Sih-Freq",
        "line": 1648
      },
      {
        "from": "sih-Date",
        "to": "U-Bin\n              perform  zz060-Convert-Date",
        "line": 1657
      },
      {
        "from": "1",
        "to": "z\n              go to  Main-Exit",
        "line": 1663
      },
      {
        "from": "WS-date",
        "to": "WS-test-date",
        "line": 1666
      },
      {
        "from": "WS-test-date",
        "to": "WS-date",
        "line": 1674
      },
      {
        "from": "u-bin",
        "to": "sih-date",
        "line": 1675
      },
      {
        "from": "2",
        "to": "sih-type",
        "line": 1683
      },
      {
        "from": "space",
        "to": "WS-named",
        "line": 1685
      },
      {
        "from": "d-types",
        "to": "add-line1",
        "line": 1694
      },
      {
        "from": "zero",
        "to": "sih-cr",
        "line": 1699
      },
      {
        "from": "zero",
        "to": "z",
        "line": 1700
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 1707
      },
      {
        "from": "999",
        "to": "we-error",
        "line": 1715
      },
      {
        "from": "998",
        "to": "we-error",
        "line": 1719
      },
      {
        "from": "997",
        "to": "we-error",
        "line": 1724
      },
      {
        "from": "zero",
        "to": "z",
        "line": 1739
      },
      {
        "from": "1",
        "to": "z\n                        Cob-Crt-Status\n              subtract 1 from SL-Next-Rec\n              go       to Main-Exit",
        "line": 1742
      },
      {
        "from": "1",
        "to": "File-Key-No\n              move     Sinvoice-Header to WS-Invoice-Record\n              if       not FS-Cobol-Files-Used\n                       perform  SLautogen-Delete-All\n              else\n                       perform  SLautogen-Delete\n                       move     sih-Invoice to Invoice-Nos\n                       move     zero to j\n                       perform  sih-lines times\n                                add      1 to J\n                                move     J to Item-Nos\n                                perform  SLautogen-Delete\n                       end-perform\n              end-if\n     end-if\n     display  space  at col 1 line WS-23-Lines with erase eol",
        "line": 1759
      },
      {
        "from": "\"C\"",
        "to": "Escape-Code",
        "line": 1775
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 1802
      },
      {
        "from": "1",
        "to": "WS-Process-Func WS-Sub-Function\n                    call \"sl070\" using WS-calling-data\n                                       system-record\n                                       to-day\n                                       file-defs\n                    call  \"CBL_CHECK_FILE_EXIST\" using File-15   *> Only if the call failed\n                                                       File-Info\n                    if    return-code not = zero          *> not = zero - No file found\n                          display   SL192 at 2301\n                          display   SL003 at 2401\n                          accept WS-Reply at 2430\n                    end-if\n              end-if\n     end-if\n*>\n     perform  Sales-Open",
        "line": 1807
      },
      {
        "from": "\"Y\"",
        "to": "SL-Autogen\n                    move     1   to SL-Next-Rec    *> SIMILAR TO NEXT INVOICE #\n              end-if                               *> as file is ISAM\n     end-if\n*>\n     move     zero  to  Menu-Reply",
        "line": 1834
      },
      {
        "from": "WS-test-date",
        "to": "WS-date",
        "line": 1869
      },
      {
        "from": "WS-Month",
        "to": "WS-Inv-Month    *> done again for UK - but JIC\n              move 1 to Date-Form",
        "line": 1871
      },
      {
        "from": "WS-Month",
        "to": "WS-Inv-Month\n              go to zz050-test-date",
        "line": 1874
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-Month to WS-days\n              move WS-swap  to WS-Month\n              move WS-Month to WS-Inv-Month\n              go to zz050-test-date",
        "line": 1877
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "WS-date",
        "line": 1885
      },
      {
        "from": "WS-Month",
        "to": "WS-Inv-Month\n     move     WS-test-date (9:2) to WS-Days",
        "line": 1888
      },
      {
        "from": "WS-date",
        "to": "u-date",
        "line": 1892
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1893
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 1910
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 1912
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1915
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-Month to WS-days\n              move WS-swap to WS-Month\n              go to zz060-Exit",
        "line": 1919
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 1926
      },
      {
        "from": "to-day",
        "to": "WS-date",
        "line": 1942
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1945
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-Month to WS-days\n              move WS-swap to WS-Month\n              go to zz070-Exit",
        "line": 1949
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 1956
      }
    ],
    "computes": [
      {
        "target": "sih-extra",
        "expression": "(sih-Net * extra-rate) / 100\n     else\n              move  zero  to  sih-extra",
        "line": 1370
      },
      {
        "target": "amt-ok6",
        "expression": "sih-extra  *  vat-rate-1  /  100",
        "line": 1384
      },
      {
        "target": "amt-ok7",
        "expression": "sih-Net  /  10",
        "line": 1429
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "input aborted forgot to subtract from SL-Next-Rec.\n*> 28/07/23 vbc - .04 In Delete-Current-Record check for RDB & perform instead\n*>                    SLautogen-delete-all.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>****** NOTES ************\n*>\n*>>>>>>>>> ??? >>     For kbrd keys F2, 3, 5, 6  & 8 during stock data entry\n*>                    For kbrd keys F9, F10 & F11 Program data mode\n*>                                    - F9 - Entry, F10 - Update and F11 - Delete.\n*>                    In Bypass-Product-Space-Tests at  Search on Desc\n*>                    there are three code lines to display and accept\n*>\n*>                    a return on line 24 used for TESTING ONLY.\n*>  >>->>>>           SO -> REMOVE AFTER TESTING <-  VINCENT!!!!\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n*>\n data                    division.\n*>===============================\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"SL810 (3.02.04)\".\n 77  Exception-Msg       pic x(25) value spaces.\n*>\n*> Data file Records here\n*>\n copy \"slwsinv.cob\"  replacing Invoice-Line by Invoice-Lines. *> Dup name Holds sih (header) & sil (lines)\n copy \"slwsinv2.cob\".\n 01  WS-Invoice-Record  redefines Invoice-Record\n                                pic x(137).\n copy \"wsanal.cob\".\n copy \"wsdel.cob\".\n copy \"wssl.cob\".\n copy \"wsstock.cob\".\n*>\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n 01  WS-amount-screen-display6.\n     03  WS-poundsd6     pic 9(6).\n     03  WS-period6      pic x     value \".\".\n     03  WS-penced6      pic v99.\n 01  WS-amount-screen-accept6 redefines WS-amount-screen-display6.\n     03  WS-pound6       pic 9(6).\n     03  filler          pic x.\n     03  WS-pence6       pic v99.\n*>\n 01  WS-amount-work6.\n     03  amt-wk-pds6     pic 9(6).\n     03  amt-wk-pence6   pic v99.\n 01  WS-amount-ok6 redefines WS-amount-work6.\n     03  amt-ok6         pic 9(6)v99.\n*>\n 01  WS-amount-screen-display7.\n     03  WS-poundsd7     pic 9(7).\n     03  WS-period7      pic x     value \".\".\n     03  WS-penced7      pic v99.\n 01  WS-amount-screen-accept7 redefines WS-amount-screen-display7.\n     03  WS-pound7       pic 9(7).\n     03  filler          pic x.\n     03  WS-pence7       pic v99.\n*>\n 01  WS-amount-work7.\n     03  amt-wk-pds7     pic 9(7).\n     03  amt-wk-pence7   pic v99.\n 01  WS-amount-ok7 redefines WS-amount-work7.\n     03  amt-ok7         pic 9(7)v99.\n*>\n 01  WS-discount-display.\n     03  WS-disca1       pic 99.\n     03  WS-disca2       pic x        value \".\".\n     03  WS-disca3       pic v99.\n 01  WS-discount-accept redefines WS-discount-display.\n     03  WS-discb1       pic 99.\n     03  filler          pic x.\n     03  WS-discb3       pic v99.\n 01  WS-discount-work.\n     03  WS-disc-wka     pic 99.\n     03  WS-disc-wkb     pic v99.\n 01  WS-discount redefines WS-discount-work  pic 99v99.\n*>\n*> REMARK OUT, ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.  *> not needed\n*>     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.  *> ditto\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n*>     03  WS-Invoice-Record      pic x.  *> Used for SLautogen rec\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  WS-data.\n     03  test-product.\n         05  filler      pic x.\n             88  sil-comment             value \"/\".\n         05  filler      pic x(12).\n     03  Menu-Reply      pic 9.\n     03  WS-reply        pic x.\n     03  z               pic 99.\n     03  c-check         pic 9.\n         88  c-exists                    value  1.\n     03  Address-A       pic x(96).\n     03  address-line.\n         05 add-line1    pic x(15).\n         05 add-line2    pic x(21).\n     03  WS-named        pic x           value space.\n     03  WS-dash         pic x(80)       value all \"-\".\n     03  work-1          pic 9(7)v99.\n     03  work-n          pic 9(7)v99.\n     03  work-d          pic 9(7)v99.\n     03  display-8       pic z(5)9.99.\n     03  display-9       pic z(6)9.99.\n     03  Vat-Code-X.                           *> this for S, R, Z = Std,Reduced,Zero\n         05  Vat-Code    pic 9.                *> 18/01/17\n     03  i               pic 99.\n     03  j               pic 99.\n     03  k               pic 99.\n     03  m               pic 99.\n     03  Escape-Code     pic x.\n     03  new-screen      pic 9(8).\n*>\n     03  WS-Entry-Mode   pic A                value space.\n         88  WS-Valid-Modes                   values \"E\" \"U\" \"D\".\n         88  Entry-Mode                       value \"E\".\n         88  Amend-Mode                       value \"U\".\n         88  Update-Mode                      value \"U\".\n         88  Delete-Mode                      value \"D\".\n*>\n     03  WS-Next-Inv     pic 9(8)             value zero.\n     03  WS-Service-Only pic x                value space.  *> Set to Y if only service line items present for invoice\n     03  altypes         pic x(15)            value \"Account <<<\".\n     03  filler redefines altypes.\n         05 d-types      pic x(15).    *>  occurs 1.\n     03  WS-vat-rate     pic 99v99.\n     03  WS-pa           pic xx.\n     03  WS-product      pic x(13).\n     03  WS-Temp-Stock-Key                    value spaces.\n         05  WS-Abrev-Stock   pic x(7).\n         05  WS-Stock-No-Long pic x(6).\n     03  WS-description  pic x(32).\n     03  WS-qty          pic 9(5).\n     03  WS-Net          pic 9(7)v99.\n     03  WS-vat          pic 9(7)v99.\n     03  WS-unit         pic 9(7)v99.\n     03  WS-cr           pic 9(8).\n     03  WS-dayes        pic 99.\n     03  WS-Inv-Month.\n         05  WS-Inv-Mth  pic 99.\n     03  WS-Show-Delivery pic X.\n*>\n     03  WS-env-lines    pic 999         value zero.\n     03  WS-lines        binary-char unsigned value zero.\n     03  WS-Accept-body  binary-char unsigned value 8.         *> set for 24 line screen (-1) but Not yet in use\n     03  WS-23-Lines     binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n*> the following for GC and screen\n*>\n 01  wScreenName             pic x(256).\n 01  wInt                    binary-long.\n*>\n 01  WS-Test-Date            pic x(10).\n 01  WS-date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-date             pic x(10).\n     03  WS-UK redefines WS-date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-Month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-date.\n         05  WS-usa-Month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-Month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-Mo           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  Error-Messages.  *> MAKE SURE THESE msgs ARE IN THE BUILDING and SALES manuals <<<<<<<<<<<<<<<<<<<<<<<<<<<<\n*> System Wide\n     03  CLR16          pic x(16) value spaces.\n     03  CLR22          pic x(22) value spaces.\n     03  CLR40          pic x(40) value spaces.\n*>\n     03  SL003          pic x(28) value \"SL003 Hit Return To Continue\".\n     03  SL006          pic x(43) value \"SL006 Note Details & Hit Return to continue\".\n*> Module specific\n     03  SL180          pic x(34) value \"SL180 Err on Autogen Rec. write : \".\n     03  SL186          pic x(30) value \"SL186 P.A. Code Does Not Exist\".\n     03  SL187          pic x(38) value \"SL187 Autogen Record not found on file\".\n     03  SL192          pic x(30) value \"SL192 P.A. File Does Not Exist\".\n     03  SL194          pic x(19) value \"SL194 Stock Read : \".\n     03  SL196          pic x(22) value \"SL196 Record Not found\".\n     03  SL197          pic x(30) value \"SL197 Invalid mode - try again\".\n*>\n 01  error-code          pic 999.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n*>*************\n*>\n     accept   WS-env-lines from lines.\n     if       WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines.\n     subtract 1 from WS-lines giving WS-23-Lines.\n     subtract 15 from WS-23-Lines giving WS-Accept-Body.\t*> gives no. of invoice item lines\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n *>     perform  zz070-Convert-Date.   *> WS-date now local disp date\n     move     1 to File-Key-No.\n*>\n*>  Set up delete file for screen save/restore.   ????????\n*>\n *>    move     spaces to Path-Work.\n *>    string   ACAS-Path       delimited by space\n *>             \"sl-temp.scr\"   delimited by size\n *>                                into Path-Work.\n*>\n*>  Here is the code for it when ready to cut/paste in.\n*>\n*>\n*> Experimental code here\n*>\n *>    if       Cob-Crt-Status = Cob-Scr-F3\n *>             move     z\"sl-temp.scr\"  to wScreenName\n *>             call     \"scr_dump\"    using wScreenName returning wInt\n *>             perform  abc\n *>             call     \"scr_restore\" using wScreenName returning wInt\n *>             call     \"CBL_DELETE_FILE\" using Path-Work\n *>             go to xxx.\n\n*>\n*>  Open files\n*>\n     perform  Program-Start.\n*>\n Main.\n     initialize sinvoice-header with filler.\n     move     space to WS-Service-Only.\n     perform  Invoice-Details.\n*>\n     if       Escape-Code = \"C\"  *> from Invoice-Details\n              go to  More-Data.\n*>\n     if       z not = zero\n       or     Escape-Code = \"Q\"\n              go to  Menu-Exit.\n*>\n     move     16  to  lin.\n     move     1 to cole.\n     display  \" \" at curs with erase eos.\n*>\n Data-Input.\n     initialize SInvoice-Bodies with filler.\n*>\n     move     zero to  i.\n*>\n     if       i-level-1\n              perform  Inv-Level-1\n     else\n              perform  Inv-Level-2.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              go to Main.\n*>\n     if       i not = 1\n              perform End-Totals.\n*>\n More-Data.\n     display \"Enter Further Autogen Invoices? (Y/N) [Y] \" at line WS-lines col 29 with foreground-color 3.\n     move     zero to Cob-Crt-Status.\n     move     \"Y\" to WS-reply.\n     accept   WS-reply at line WS-lines col 68  with foreground-color 6 update UPPER.\n *>    move     function upper-case (WS-reply) to WS-reply.\n*>\n     display  space at line WS-lines col 01 with erase eol.\n*>\n     if       WS-reply = \"Y\"\n              go to Main.\n     if       WS-reply not = \"N\"\n              go to More-Data.\n*>\n Menu-Exit.\t\t\t*> Moved from program-start, silly place to have it\n*>********\n*>\n     move     zero to  pass-value.\n     perform  Sales-Close.          *>      close    sales-file\n     perform  Delivery-Close.       *>               delivery-file\n     perform  Analysis-Close.       *>               analysis-file.\n     perform  SLautogen-Close.      *>      close    SLautogen-file\n*>\n     if       SL-Stock-Link = \"Y\"\n *>             perform Stock-Audit-Close.\n              perform Stock-Close.         *>  close Stock-File  Stock-Audit\n*>\n     exit     program.\n*>\n*>****************************************************************\n*>                 P R O C E D U R E S                           *\n*>****************************************************************\n*>\n Running-Totals section.\n*>=====================\n*>\n     move     zero  to  sih-Net\n                        sih-vat.\n*>\n     perform  varying k from 1 by 1 until k  >  i\n              add sil-Net (k) to sih-Net\n              add sil-vat (k) to sih-vat\n     end-perform\n*>\n     move     sih-Net  to  display-9.\n     if       i-level-1\n              display display-9 at 1237 with foreground-color 3.\n*>\n     move     sih-vat  to  display-9.\n     if       i-level-1\n              display display-9 at 1255 with foreground-color 3.\n*>\n     add      sih-Net  sih-vat  giving  display-9.\n*>\n     if       i-level-1\n              display display-9 at 1268 with foreground-color 3\n     else\n              display display-9 at 1270 with foreground-color 3.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Write-Details section.    *> RECHECK ALL THIS\n*>====================\n*>\n     add      1  to  j.\n     move     sih-invoice  to sil-invoice (j).\n     move     j            to sil-line (j).\n     move     sih-type     to sil-type (j).\n     move     invoice-lines (j)  to  WS-Invoice-Record.  *> was line\n     perform  SLautogen-Write.             *>  write    invoice-record.\n     if       fs-reply not = zero\n              perform Eval-Status\n              display sl180         at line WS-23-Lines col 1 with erase eol foreground-color 4\n              display fs-reply      at line WS-23-Lines col 36 with foreground-color 3\n              display exception-msg at line WS-23-Lines col 39 with foreground-color 3\n              display invoice-key   at line WS-23-Lines col 64 with foreground-color 3\n              display sl006         at line WS-lines col 01 with foreground-color 3\n              accept  WS-reply at line WS-lines col 44\n              display \" \" at line WS-23-Lines col 1 with erase eos\n     end-if.\n*>\n *>    perform  Update-Stock-n-Audit.   *> NOT FOR AUTOGEN\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Read-Details section.    *> RECHECK ALL THIS\n*>===================\n*>\n     move     zero to j.\n     perform  sih-lines times\n              add  1 to j\n              move sih-invoice to invoice-nos   *>  IS THIS CORRECT\n              move j to item-nos                *>  IS THIS CORRECT\n              perform SLautogen-Read-Next\n              if      FS-Reply = zeros\n                      move WS-Invoice-Record to Invoice-Lines (j)\n              end-if\n     end-perform.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Eval-Status  section.\n*>===================\n*>\n     move     spaces to exception-msg.\n copy \"FileStat-Msgs.cpy\"  replacing STATUS by fs-reply\n                                     msg    by exception-msg.\n*>\n Main-Exit.   exit section.\n*>************************\n*>\n Comm-Routines section.\n*>********************\n*>\n Accept-Money6a.\n*>-------------\n*>\n     move     zero to WS-poundsd6 WS-penced6 amt-ok6.\n*>\n Accept-Money6b.\n*>-------------\n*>\n     display  WS-amount-screen-display6 at curs  with foreground-color 3.\n     accept   WS-amount-screen-accept6  at curs   with foreground-color 3 update.\n     move     WS-pound6 to amt-wk-pds6.\n     move     WS-pence6 to amt-wk-pence6.\n*>\n Accept-Money6c.\n*>-------------\n*>\n     move     amt-wk-pence6 to WS-pence6.\n     move     amt-wk-pds6   to WS-pound6.\n     display  WS-amount-screen-display6 at curs  with foreground-color 3.\n     accept   WS-amount-screen-accept6  at curs   with foreground-color 3 update.\n     move     WS-pound6 to amt-wk-pds6.\n     move     WS-pence6 to amt-wk-pence6.\n*>\n Accept-Money7a.\n*>-------------\n*>\n     move     zero to WS-poundsd7 WS-penced7 amt-ok7.\n*>\n Accept-Money7b.\n*>-------------\n*>\n     display  WS-amount-screen-display7 at curs  with foreground-color 3.\n     accept   WS-amount-screen-accept7  at curs   with foreground-color 3 update.\n     move     WS-pound7 to amt-wk-pds7.\n     move     WS-pence7 to amt-wk-pence7.\n*>\n Accept-Money7c.\n*>-------------\n*>\n     move     amt-wk-pence7 to WS-pence7.\n     move     amt-wk-pds7 to WS-pound7.\n     display  WS-amount-screen-display7 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept7  at curs  with foreground-color 3 update.\n     move     WS-pound7 to amt-wk-pds7.\n     move     WS-pence7 to amt-wk-pence7.\n*>\n comm-exit.   exit section.\n*>--------    ----\n*>\n Inv-Level-1  section.\n*>===================\n*>\n*> No one should be using this consider scrapping and forcing invoicer =2 etc\n*>\n     display  WS-dash        at 1101 with foreground-color 2.\n     display  \"Level 1\"      at 1201 with foreground-color 2.\n     display  \"Line - \"      at 1216 with foreground-color 2.\n     display  \"[          ]\" at 1236 with foreground-color 2.\n     display  \"[          ]\" at 1254 with foreground-color 2.\n     display  \"[          ]\" at 1267 with foreground-color 2.\n     display  \"Code\"         at 1405 with foreground-color 2.\n     display  \"<---Net---->  Vat   Vat Amount  Gross Amount\" at 1436 with foreground-color 2.\n*>\n Loop.\n*>***\n*>\n     perform  varying lin from 16 by 1 until lin not < WS-23-Lines\n              add      1  to  i\n              move     1 to cole\n              display  \"(\" at curs with erase eol foreground-color 2\n              move     2 to cole\n              display  i at curs with foreground-color 2\n              move     4 to cole\n              display  \") [  ]\" at curs with foreground-color 2\n              move     36 to cole\n              display  \"[          ] [ ]   {         } (\" at curs with foreground-color 2\n              move     78 to cole\n              display  \")\" at curs       with foreground-color 2\n     end-perform\n*>\n*> i = no. lines on screen for items,",
        "line": 84
      },
      {
        "type": "IF",
        "condition": "Cob-Crt-Status = Cob-Scr-esc\n              go to Main-Exit.\n*>\n     if       new-screen = 1\n              go to Loop.\n*>\n     if       sil-description (i) not = spaces\n       and    i not = 40                      *> FIXED Invoice line limit ?  !!\n              go to Loop.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Get-Data-1   section.\n*>===================\n*>\n*> No one should be using this consider scrapping and forcing invoicer =2 etc\n*>\n Get-Data-1-Main.\n     add      j  15  giving  lin.\n*>\n     if       lin  >  WS-23-Lines\n              subtract 1 from i\n              move 1 to new-screen\n              go to  Main-Exit.\n*>\n     move     zero to new-screen.\n*>\n Get-Code.\n     if       i  >  1\n       and    sil-pa (i) = spaces\n              move  sil-pa (i - 1)  to  sil-pa (i).\n*>\n     move     sil-pa (i) to WS-pa.\n     move     7 to cole.\n     display  WS-pa at curs with foreground-color 3.\n     accept   WS-pa at curs with foreground-color 3 update.\n     move     WS-pa to sil-pa (i) pa-group.\n     move     spaces  to  sil-description (i).\n*>\n     if       WS-pa = spaces\n              go to  Main-Exit.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              go to Main-Exit.\n*>\n     if       WS-pa = \"<<\"\n        and   i = 1\n              go to Get-Code.\n*>\n     if       WS-pa = \"<<\"\n              subtract  1  from  lin\n              if    lin  >  15\n                    subtract  1  from  i\n                    subtract 1 from j\n                    go to  Get-Code\n              else\n                    subtract WS-Accept-Body from  i          *> Was 8 Need to follow logic, can we use WS-Accept-Body ??\n                    go to  Get-Data-1-Main.\n     move     \"S\" to pa-system.\n     move     11 to cole.\n     move     1 to File-Key-No.\n     perform  Analysis-Read-Indexed.     *> read analysis-file record invalid key\n     if       FS-Reply = 21\n              display SL186 at line WS-23-Lines col 1 with foreground-color 4 highlight beep\n              go to  Get-Code.\n     display  \" \" at line WS-23-Lines col 1 with erase eol.\n*>\n     display  PA-Desc at curs with foreground-color 3.\n     move     PA-Desc  to  sil-description (i).\n*>\n Get-Net.\n     move     37 to cole.\n     perform  Accept-Money7a thru Accept-Money7b.\n     if       amt-ok7 = zero\n              go to Get-Code.\n     move     amt-ok7 to sil-Net (i) WS-Net.\n*>\n Get-Vat-Code.\n*>\n*>  Only using 1st three as last 2 are for local sales tax but not in UK.\n*>   NOTE that it is not currently programmed for (e.g., last 2).\n*>\n     move     50 to cole.\n     accept   Vat-Code at curs with foreground-color 3 update.\n*>\n     if       Vat-Code  >  3\n              go to  Get-Vat-Code.\n*>\n     move     Vat-Code  to  sil-Vat-Code (i).\n     if       Vat-Code = zero\n              move  zero  to  amt-ok6\n       else\n              move vat-rate (Vat-Code) to WS-vat-rate\n              compute amt-ok6 rounded =  (WS-Net * WS-vat-rate) / 100.\n*>\n Get-Vat-Rate.\n     move     56 to cole.\n     perform  Accept-Money6c.\n     move     amt-ok6 to sil-vat (i) WS-vat.\n*>\n     add      WS-vat WS-Net giving  display-9.\n     move     68 to cole.\n     display  display-9 at curs with foreground-color 3.\n*>\n     perform  Running-Totals.\n*>\n     add      1 to j.\n     add      1  to  i.\n     go       to Get-Data-1-Main.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Inv-Level-2  section.\n*>===================\n*>\n     display  WS-dash at 1101 with foreground-color 2.\n     if       SL-Stock-Link not = \"Y\"\n              display  \"Level 2\"      at 1201 with foreground-color 2\n     else\n              display  \"Stock Linked\" at 1201 with foreground-color 2.\n     display  \"Line - \"               at 1216 with foreground-color 2.\n     display  \"Net <          >\"      at 1227 with foreground-color 2.\n     display  \"Vat <          >\"      at 1244 with foreground-color 2.\n     display  \"Invoice <          >\"  at 1261 with foreground-color 2.\n     if       SL-Stock-Link = \"N\"\t\t*> No stock",
        "line": 647
      },
      {
        "type": "IF",
        "condition": "SL-Stock-Link = \"N\"\t\t*> No stock",
        "line": 783
      },
      {
        "type": "IF",
        "condition": "end-perform\n*>\n*> This is what the item capture displays look like & 1st is for non-linked\n*>   stock Control:\n*>\n*>    Product    Code <---------Description-------->   Qty   Unit Price  Disc. Vat\n*>[      12 >13 ][2 ][        24 >30                ][  5  ][  9>10    ][  5  ][1]\n*> If STOCK LINKED:\n*>    Product     <----------Description--------->    Qty   Unit Price  Disc. Vat\n*>[      12 >13 ][        24 >32                  ]  [  5  ][  9>10    ][  5  ][1]\n*>\n*>     subtract 16 from WS-23-Lines giving m.  *> or move 1 to i = pos. in line item table\n*>\n     subtract WS-Accept-Body from i.                    *> m = WS-Accept-body\n     move     1  to  j.\n*>\n     display  i at 1223 with foreground-color 2.\n*>\n     perform  Get-Data-2.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              go to Main-Exit.\n*>\n     if       new-screen = 1\n              go to  Loop.\n*>\n     if       WS-product not = spaces\n       and    i not = 40\t\t\t*> max no. of items per invoice\n              go to  Loop.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Get-Data-2   section.\n*>===================\n*>\n*>**********************************************************************\n*>  This section will accept invoice line data if SC (stock control)   *\n*>  is NOT linked in param file. If it is linked, will only request:   *\n*>  Stock code or if entered chars = 7 or less, Abrev code so can      *\n*>  search same if using F3 to find 1st",
        "line": 791
      },
      {
        "type": "IF",
        "condition": "lin  >  WS-23-Lines - 1\n              subtract  1  from  i\n              move  1  to  new-screen\n              go to  Main-Exit.\n*>\n     move     zero  to  new-screen.\n*>\n Get-Product.\n     if       i  >  1\n       and    sil-product (i) = spaces\n              move  sil-product (i - 1) to sil-product (i).  *> display prev entered code for new line\n*>                                                              to save typing\n     display  i at 1223 with foreground-color 2.             *> disp line # on summary line\n     move     2 to cole.\n     move     sil-product (i) to WS-product.\n     accept   WS-product at curs with foreground-color 3 update.\n*>\n     move     spaces  to  sil-description (i).\n*>\n*> Process description accept & search via start / read next if F6 detected\n*>\n     if       Cob-Crt-Status = Cob-Scr-F6\n              go to Bypass-Product-Space-Tests.\n*>\n     if       WS-product = spaces\n              go to Main-Exit.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              go to Main-Exit.\n*>\n Bypass-Product-Space-Tests.\n     move     function upper-case (WS-product) to WS-product.\n     move     WS-product to sil-product (i)\n                            test-product\n                            WS-Temp-Stock-Key.\n*>\n     if       sil-comment\n              move zero to WS-Net WS-unit WS-qty\n              go to  Get-desc.\n*>\n     if       WS-product = \"<<           \"\n              subtract  1  from  lin\n              go to Get-prod-test.\n*>\n     if       SL-Stock-Link not = \"Y\"    *> continue with old code to accept all data\n              go to Get-Code.\n     move     17 to cole.                *> 4 Desc.\n*>\n*> Search nearest Abrev key and read next ..\n*>  When this is tested we can wrap this and next together\n*>    with a F3 test",
        "line": 844
      },
      {
        "type": "IF",
        "condition": "F2 or F3 test\n*>\n*> Leaving these embedded literals in to help in dry testing etc\n*>   instead of replacing with fixed SLnnn vars.\n*>\n     if       Cob-Crt-Status = Cob-Scr-F3\n *>\n *> Search Abrev",
        "line": 893
      },
      {
        "type": "IF",
        "condition": "FS-Reply = 21\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if             *> end-start\n              perform Stock-Read-Next        *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                         *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> have we the right one?\n              display WS-Stock-Desc at curs with foreground-color 3\n              go to Get-Product\n     end-if\n*>\n     if       Cob-Crt-Status = Cob-Scr-F2                *> read next record\n              perform Stock-Read-Next      *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                       *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> have we the right one?\n              display WS-Stock-Desc at curs with foreground-color 3\n              go to Get-Product\n     end-if\n*>\n*> Search on Desc. but has dup keys so disp. Abrev. code\n*>    & F5 for next on description\n*>  When this is tested we can wrap this and next together with a\n*>      F6 test",
        "line": 906
      },
      {
        "type": "IF",
        "condition": "F5 or F6 test\n*>\n     if       Cob-Crt-Status = Cob-Scr-F6\n              move    sil-description (i) to WS-description\n              accept  WS-description at curs with foreground-color 3 update\n              move WS-Description to WS-Stock-Desc\n              move  3 to File-Key-No         *> start Stock-File key not < WS-Stock-Desc invalid key\n              set fn-not-less-than to true\n              perform Stock-Start\n              if    FS-Reply = 21\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-Product\n              end-if                      *> end-start\n              perform Stock-Read-Next     *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-Product\n              end-if                      *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> Got the right one? Show desc, stock held & retail price\n                                         WS-Product\n              display WS-Stock-Desc at curs with foreground-color 3 highlight\n              move Stock-Held to WS-Qty\n              display WS-Qty at line lin col 53 with foreground-color 3 highlight\n              display \"Hit return (for testing)\" at 2401  *> TESTING ONLY\n              accept WS-reply at 2425            *> TESTING ONLY\n              display \" \" at 2401 with erase eol *> TESTING ONLY\n              move Stock-Retail to amt-ok7\n              move amt-wk-pds7   to WS-pound7\n              move amt-wk-pence7 to WS-pence7\n              display WS-amount-screen-display7 at line lin col 60 with foreground-color 3 highlight\n              go to Get-Product\n     end-if\n*>\n     if       Cob-Crt-Status = Cob-Scr-F5      *> Read next on Desc.\n              perform Stock-Read-Next         *> read  Stock-File next record at end\n              if    FS-Reply = 10\n                    move SL196 to WS-Stock-Desc\n                    display WS-Stock-Desc at curs with foreground-color 4\n                    go to Get-product\n              end-if                        *> end-read\n              move WS-Stock-Abrev-Key to sil-product (i)    *> Got the right one? Show desc, stock held & retail price\n                                      WS-Product\n              display WS-Stock-Desc at curs with foreground-color 3 highlight\n              move Stock-Held to WS-Qty\n              display WS-Qty at line lin col 53 with foreground-color 3 highlight\n              move Stock-Retail to amt-ok7\n              move amt-wk-pds7   to WS-pound7\n              move amt-wk-pence7 to WS-pence7\n              display WS-amount-screen-display7 at line lin col 60 with foreground-color 3 highlight\n              go to Get-Product\n     end-if\n*>\n*> So, no special function just search for entered key\n*>\n     if       WS-Stock-No-Long = spaces\n              move WS-Abrev-Stock to WS-Stock-Abrev-Key\n              move 2 to File-Key-No\n     else\n              move WS-Temp-Stock-Key to WS-Stock-Key\n              move 1 to File-Key-No\n     end-if\n     perform  Stock-Read-Indexed    *> read Stock-File record key WS-Stock-Abrev-Key invalid key\n     if       FS-Reply = 21\n              move SL196 to WS-Stock-Desc\n              display WS-Stock-Desc at curs with foreground-color 4\n              go to Get-product\n     end-if                        *> end-read\n*>\n*> can shorten code now so rem out next block vbc 27/08/17\n*>\n *>    else\n *>             perform Stock-Read-Indexed    *> read Stock-File key WS-Stock-Key invalid key\n *>             if   FS-Reply = 21\n *>                  move SL196 to WS-Stock-Desc\n *>                  display WS-Stock-Desc at curs with foreground-color 4\n *>                  go to Get-product\n *>             end-if                        *> end-read\n *>    end-if\n     perform  Test-For-Read-Stock.\n*>\n Process-Stock-Record.\n*>\n*>  Have the required Stock record so get and show the desc\n*>\n*>     if       WS-Stock-Desc not = SL196\n*>              display WS-pa        at line lin col 17 with foreground-color 3\n     move     17 to cole.        *> Desc.\n     move     Stock-sa-Group to WS-pa pa-group sil-pa (i).\n     display  WS-Stock-Desc   at curs with foreground-color 3.\n     move     WS-Stock-Desc    to WS-description sil-description (i).\n     move     Stock-Retail  to amt-ok7.\n     move     Stock-Retail  to WS-Unit.\n     move     amt-wk-pds7   to WS-pound7.\n     move     amt-wk-pence7 to WS-pence7.\n     display  WS-amount-screen-display7 at line lin col 60 with foreground-color 3.\n *>    move     Stock-Held to WS-qty. *> sl810\n     move     1 to WS-Qty.    *> Autogen change\n     if       Stock-Services-Flag not = \"Y\"\n              move  \"N\" to WS-Service-Only.\n     go       to Get-Qty.          *> Bypass manual input code as comes from stock record\n*>\n Get-Prod-Test.   *> THESE TESTS LOOK WRONG IF SCREEN LONGER THAN 24 LINES <<<<<\n     if       i = 1\n              add 1 to lin\n              go to Get-product.\n*>\n     if       lin  >  15\n              subtract  1  from  i\n              subtract  1  from  j\n              go to  Get-product\n      else\n              subtract WS-Accept-Body from i           *> instead of 8 can we use WS-Accept-Body ??\n              go to  Get-Data-2-Main.\n*>\n Get-Code.\n     if       i  >  1\n       and    sil-pa (i) = spaces\n              move  sil-pa (i - 1)  to  sil-pa (i).\n*>\n     move     sil-pa (i) to WS-pa.\n     move     17 to cole.\n     accept   WS-pa at curs with foreground-color 3 update.\n*>\n     move     spaces  to  sil-description (i).\n*>\n     if       WS-pa = spaces\n              go to  Get-product.\n*>\n     move     WS-pa to pa-group sil-pa (i).\n     move     \"S\" to pa-system.\n     move     21 to cole.                         *> disp error in desc.\n     move     1 to File-Key-No.\n     perform  Analysis-Read-Indexed.      *> read analysis-file record invalid key\n     if       FS-Reply = 21\n              display SL186 at curs  with foreground-color 4\n              go to  Get-Code.\n*>\n Get-Desc.\n     if       i  >  1\n         and  sil-description (i) = spaces\n         and  not  sil-comment\n              move  sil-description (i - 1) to  sil-description (i).\n*>\n     if       SL-Stock-Link = \"Y\"\n              move 17 to cole\n     else\n              move 21 to cole.\n     move     sil-description (i) to WS-description.\n     display  WS-description at curs with foreground-color 3.\n     accept   WS-description at curs with foreground-color 3 update.\n*>\n     move     WS-description to sil-description (i).\n     if       WS-description = space\n              move \"B\" to Escape-Code\n     else\n              move space to Escape-Code.\n     if       Escape-Code = \"B\"\n         and  sil-comment\n              go to Get-product.\n     if       Escape-Code = \"B\"\n              go to  Get-Code.\n*>\n     if       sil-comment\n              go to  jump-totals.\n*>\n Get-Qty.\n     if       SL-Stock-Link = \"N\"\t\t*> if it is shown = current stock\n              move     zero to WS-qty.\n     move     53 to cole.\n     display  WS-qty at curs with foreground-color 3.\n     accept   WS-qty at curs with foreground-color 3 update.\n*>\n     if       WS-qty = zero\n              go to Get-desc.\n     if       SL-Stock-Link = \"Y\"         *> make sure not selling more stock than held\n       and    WS-qty > Stock-Held\n              move Stock-Held to WS-Qty\n              go to Get-Qty.\n*>\n     if       SL-Stock-Link = \"Y\"    *> bypass accept unit price\n              go to Recomp-Net.\n*>\n Get-Unit.\n     move     60 to cole.\n     perform  Accept-Money7a thru Accept-Money7b.\n     if       amt-ok7 = zero\n              go to Get-qty.\n     move     amt-ok7 to WS-unit.\n*>\n Recomp-Net.\n     multiply WS-qty by  WS-unit giving  WS-Net on size error\n              display  \"SizER\" at curs with blink foreground-color 4\n              go to Get-qty.\n*>\n     move     WS-Net to  display-9 sil-Net (i).\n     move     WS-qty to sil-qty (i).\n     move     WS-unit to sil-unit (i).\n     display  display-9 at 1232 with foreground-color 3.\n*>\n Get-Disc.\n     move     Sales-Discount  to  WS-discount.\n     move     72 to cole.\n     move     WS-disc-wka to WS-disca1.\n     move     WS-disc-wkb to WS-disca3.\n     display  WS-discount-display at curs with foreground-color 3.\n     accept   WS-discount-accept  at curs with foreground-color 3 update.\n     move     WS-discb1 to WS-disc-wka.\n     move     WS-discb3 to WS-disc-wkb.\n*>\n     move     WS-discount to  work-d sil-discount (i).\n     move     WS-Net to  work-n.\n*>\n     multiply work-n by work-d giving work-1\n     divide   work-1 by 100    giving work-1\n*>\n     subtract work-1  from  WS-Net.\n*>\n     move     WS-Net to sil-Net (i) display-9.\n     display  display-9 at 1232 with foreground-color 3.\n*>\n Get-Vat-Code.\n     move \"S\" to Vat-Code-X.  *> 17/2/23  for Standard rate\n     move     79 to cole.\n     display  Vat-Code-X at curs with foreground-color 3.\n     accept   Vat-Code-X at curs with foreground-color 3 update.\n*>\n*> THIS NEEDS Adding to for rates 4 and 5.\n*>\n*>\n*>   Accept S, R and Z replacing with 1, 2 & 3.      Rating   %   - Effective\n*>\n     if       Vat-Code-X = \"S\"                   *> Standard code 1 (20% - 01/01/17)\n              move 1 to Vat-Code\n      else\n       if     Vat-Code-X = \"R\"                   *> Reduced  code 2 (05% - 01/01/17)\n              move 2 to Vat-Code\n        else\n         if   Vat-Code-X = \"Z\"                   *> Zero     code 3 (00% - 01/01/17)\n              move 3 to Vat-Code.\n*>\n     if       Vat-Code < 1 or > 3                *> using 1st three as last 2 are Sales tax, Not used in the UK.\n              go to  Get-Vat-Code.                *> so change test for 'not = 4 or 5' instead of '> 3'\n*>\n     move     Vat-Code  to  sil-Vat-Code (i).\n*>\n     if       Vat-Code = zero\n              move  zero  to  WS-vat\n       else\n              move vat-rate (Vat-Code) to WS-vat-rate\n              compute  WS-vat rounded =  (WS-Net * WS-vat-rate) / 100.\n*>\n     move     WS-vat to  display-9 sil-vat (i).\n     display  display-9 at 1249 with foreground-color 3.\n*>\n     perform  Running-Totals.\n*>\n Jump-Totals.\n     add      1  to  j.\n     add      1  to  i.\n     go to    Get-Data-2-Main.\n*>\n*> CAN IT BE USED FOR OTHER FILES  (SL194 os for Stock file) ??????\n*>\n Test-For-Read-Stock.\n     if       fs-reply not = zero\n              perform Eval-Status\n              display SL194    at line WS-23-Lines col 1 with foreground-color 4 highlight erase eol\n              display fs-reply at line WS-23-Lines col 21 with foreground-color 2 highlight\n              display exception-msg at line WS-23-Lines col 24 with foreground-color 3\n              display SL006 at line WS-lines col 1\n              accept WS-reply at line WS-lines col 45\n     end-if.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n End-Totals   section.\n*>===================\n*>\n End-Totals-Main.\n     move     zero to Cob-Crt-Status.\n     perform  Total-Screen.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              go to Main-Exit.\n*>\n     move     15  to  lin.\n     move     1 to cole.\n     display  \" \" at curs with erase eos.\n*>\n     display  \"*********************\" at 1660  with foreground-color 2\n     display  \"*\" at 1760 with foreground-color 2\n     display  \"*\" at 1780 with foreground-color 2\n     display  \"*\" at 1860 with foreground-color 2\n     display  \"*\" at 1880 with foreground-color 2\n     display  \"*\" at 1960 with foreground-color 2\n     display  \"*\" at 1980 with foreground-color 2\n     display  \"*********************\" at 2060 with foreground-color 2.\n*>\n     display  \"Invoice ok to Store\" at 1761 with foreground-color 2.\n     display  \"(Y/N) ? [Y]\" at 1868 with foreground-color 2.\n     display  \" ESC to Quit\" at 1964 with foreground-color 2.\n*>\n Confirmation.\n*>***********\n*>\n     move     \"Y\"  to   WS-reply.\n     accept   WS-reply at 1977 with foreground-color 6 UPPER update.\n *>    move     function upper-case (WS-reply) to WS-reply.\n*>\n     if       Cob-Crt-Status = Cob-Scr-esc\n              move  \"Q\"  to  Escape-Code\n              go to Main-Exit.\n*>\n     if       WS-reply = \"N\"\n              go to  End-Totals-Main.\n*>\n     if       WS-reply not = \"Y\"\n              go to  Confirmation.\n*>\n     move     \"P\"  to  sih-status.\n *>    move     space to sih-status-P.\n*>\n*>        JIC normal stock items are present (turns this to space or \"N\"\n*>          Do NOT print picking/delivery note, marked as already done.\n*>\n     if       WS-Service-Only = \"Y\" or = space\n              move     \"P\" to sih-status-P.\n     subtract 1  from  i.\n     move     i    to  sih-lines.\n*>\n     move     sinvoice-header  to  WS-Invoice-Record.  *> was invoice-record\n     if       Entry-Mode\n              perform  SLautogen-Write       *>  write    SLautogen-record.\n     else\n       if     Amend-Mode\n              perform  SLautogen-Rewrite.\n*>\n     if       fs-reply not = zero\n              perform Eval-Status\n              display sl180         at line WS-23-Lines col  1 with erase eol foreground-color 4\n              display fs-reply      at line WS-23-Lines col 36 with foreground-color 3\n              display exception-msg at line WS-23-Lines col 39 with foreground-color 3\n              display invoice-key   at line WS-23-Lines col 64 with foreground-color 3\n              display sl006         at line WS-lines    col  1 with foreground-color 3\n              accept  WS-reply      at line WS-lines    col 44\n              display \" \"           at line WS-23-Lines col  1 with erase eos\n     end-if\n*>\n     move     zero to  j.\n     perform  Write-Details  i  times.\n*>\n     move     1 to s-flag-i.\n     move     11  to  lin.\n     move     1 to cole.\n     display  \" \" at curs with erase eos.\n*>\n     go       to Main-Exit.\n*>\n Main-Exit.   exit section.\n*>********    *****\n*>\n Total-Screen section.\n*>===================\n*>\n     move     1 to cole.\n     move     11 to lin.\n     display  \" \" at curs with erase eos.\n     display  WS-dash at 1101 with foreground-color 2.\n*>\n     if       i-level-1\n              move  1  to  Menu-Reply\n     else\n              move  2  to  Menu-Reply.\n*>\n     display  \"Level \"   at 1201 with foreground-color 2.\n     display  Menu-Reply at 1207 with foreground-color 2.\n     display  \"<---Net---->   <---Vat--->\" at 1225 with foreground-color 2.\n     display  \"<---Gross-->     Days\"      at 1254 with foreground-color 2.\n     display  \"Sub-Totals\"                 at 1404 with foreground-color 2.\n     display  \"{          }   {         }\" at 1425 with foreground-color 2.\n     display  \"{          }     [  ]\"      at 1454 with foreground-color 2.\n*>\n     display  Extra-Desc                   at 1504 with foreground-color 2.\n     display  \"[          ]   [         ]\" at 1525 with foreground-color 2.\n     display  \"{          }\"               at 1554 with foreground-color 2.\n*>\n     display  \"Shipping & Handling\"        at 1604 with foreground-color 2.\n     display  \"[          ]   [         ]\" at 1625 with foreground-color 2.\n     display  \"{          }\"               at 1654 with foreground-color 2.\n*>\n     display  \"Late Charge\"                at 1704 with foreground-color 2.\n     display  \"[          ]              \" at 1725 with foreground-color 2.\n     display  \"{          }     [  ]\"      at 1754 with foreground-color 2.\n*>\n     display  \"------------   -----------\" at 1825 with foreground-color 2.\n     display  \"------------\"               at 1854 with foreground-color 2.\n*>\n     display  \"Itemised Totals\"            at 1904 with foreground-color 2.\n     display  \"{          }   {         }\" at 1925 with foreground-color 2.\n     display  \"{          }\"               at 1954 with foreground-color 2.\n*>\n     move     sih-Net  to  display-9.\n     display  display-9 at 1426 with foreground-color 3.\n*>\n     move     sih-vat  to  display-8.\n     display  display-8 at 1441 with foreground-color 3.\n*>\n     add      sih-Net  sih-vat  giving  display-9.\n     display  display-9 at 1455 with foreground-color 3.\n*>\n Get-Days.\n     move     zero to sih-days sih-carriage.\n     if       sih-type = 2\n              move sales-credit  to  sih-days\n     else if  sih-type = 4\n              move pf-retention to sih-days.\n     move     sih-days to WS-dayes.\n     if       sih-type not = 2\n              display WS-dayes at 1472 with foreground-color 3\n              go to Get-extra.\n*>\n     display  WS-dayes at 1472 with foreground-color 3.\n     accept   WS-dayes at 1472 with foreground-color 3 update.\n     move     WS-dayes to sih-days.\n*>\n Get-Extra.\n     if       Extra-Type = space\n              move zero to sih-extra sih-e-vat\n              go to Get-carriage.\n*>\n     if       Extra-Rate not = zero\n              compute  sih-extra = (sih-Net * extra-rate) / 100\n     else\n              move  zero  to  sih-extra.\n*>\n     move     1526 to curs.\n     move     sih-extra to amt-ok7.\n     perform  Accept-Money7c.\n     move     amt-ok7 to sih-extra.\n*>\n Get-Extra-Vat.\n     if       sih-extra = zero\n              move  zero to  sih-e-vat\n              go to Get-carriage.\n*>\n     compute  amt-ok6 = sih-extra  *  vat-rate-1  /  100.\n*>\n     move     1541 to curs.\n     perform  Accept-Money6c.\n     move     amt-ok6 to sih-e-vat.\n*>\n     add      sih-extra  sih-e-vat  giving  display-9.\n     display  display-9 at 1555 with foreground-color 3.\n*>\n     if       discount\n         and  sih-extra not = zero\n              multiply -1 by sih-extra\n              multiply -1 by sih-e-vat.\n*>\n Get-Carriage.\n     move     1626 to curs.\n     perform  Accept-Money7a thru Accept-Money7b.\n     move     amt-ok7 to sih-carriage.\n     compute  amt-ok6 rounded = sih-carriage * vat-rate-1 / 100.\n*>\n*> Note that vat-rate-1 must be standard rate for p & p\n*>\n Get-Carriage-Vat.\n     move     1641 to curs.\n     perform  Accept-Money6c.\n     move     amt-ok6 to sih-c-vat.\n     add      sih-carriage  sih-c-vat  giving  display-9.\n     display  display-9 at 1655 with foreground-color 3.\n*>\n Get-Deduct-Amt.\n  *>   if       WS-named = \"A\"\n  *>      and   oi-Net = sih-Net\n  *>      and   oi-vat = sih-vat\n  *>      and   oi-carriage = sih-carriage\n  *>            move \"Z\" to WS-named.\n*>\n *>    if       (sih-type not = 2  and not = 3)       *> Invoices, Credit Notes\n     if       not Late-Charges\n              move zero to sih-deduct-amt sih-deduct-vat sih-deduct-days\n              go to  Main-Exit.\n *>         or  not late-charges\n *>         or  WS-named = \"Z\"\n *>             move zero to sih-deduct-amt sih-deduct-vat sih-deduct-days\n *>             go to  Main-Exit.\n*>\n     compute  amt-ok7 =  sih-Net  /  10.      *> Use default discount of 10% can be overridden\n*>\n     if       amt-ok7 <  4      *> DEFAULT MINIMUM Deduct amount Should this be changed ???????\n              move  4  to  amt-ok7.      *> and for sl910/20\n*>\n     move     1726 to curs.\n     perform  Accept-Money7c.\n     move     amt-ok7 to sih-deduct-amt.\n*>\n Get-Deduct-Vat.\n     move     zeros to sih-deduct-vat.\n*>\n     add      sih-Net  sih-extra  sih-carriage  sih-deduct-amt giving  display-9.\n     display  display-9 at 1926 with foreground-color 3.\n*>\n     add      sih-vat  sih-e-vat  sih-c-vat  sih-deduct-vat giving  display-8.\n     display  display-8 at 1941 with foreground-color 3.\n*>\n     add      sih-Net  sih-extra  sih-carriage  sih-deduct-amt\n              sih-vat  sih-e-vat  sih-c-vat  sih-deduct-vat   giving  display-9.\n     display  display-9 at 1955 with foreground-color 3.\n*>\n Get-Deduct-Days.\n     move     sih-days  to  WS-dayes.\n     display  WS-dayes at 1772 with foreground-color 3.\n     accept   WS-dayes at 1772 with foreground-color 3 update.\n     move     WS-dayes to sih-deduct-days.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Invoice-Details section.\n*>======================\n*>\n Invoice-Details-Main.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Recurring Invoicing Data Entry\" at 0127           with foreground-color 2. *> COB-COLOR-GREEN\n     perform  zz070-Convert-Date.        *> convert date to LOCALE format\n     display  WS-date at 0171 with foreground-color 2.\n*>\n     display  \"****************************************\" at 0341 with foreground-color 2.\n     display  \"* Mode  [ ] [E=Entry, Update, Delete]   \" at 0441 with foreground-color 2.\n     display  \"*         or E=F2, U=F3, D=F4           \" at 0541 with foreground-color 2.\n     display  \"             ESC to quit                \" at 0641 with foreground-color 2.\n     display  \"----------------------------------------\" at 0741 with foreground-color 2.\n*>\n     move     \"E\" to WS-Entry-Mode.\n     accept   WS-Entry-Mode  at 0450 with foreground-color 3 update upper. *> COB-COLOR-CYAN\n     if       Cob-Crt-Status = Cob-Scr-F2\n              move \"E\" to WS-Entry-Mode\n     else\n       if     Cob-Crt-Status = Cob-Scr-F3\n              move \"U\" to WS-Entry-Mode\n       else\n         if   Cob-Crt-Status = Cob-Scr-F4\n              move \"D\" to WS-Entry-Mode\n         else\n          if  Cob-Crt-Status = Cob-Scr-Esc\n              move  \"Q\"  to  Escape-Code\n              go to  Main-Exit\n          else\n           if not WS-Valid-Modes\n              display \"SL197 Invalid mode - try again\"   at 0401  with foreground-color 2 BEEP\n              go to Invoice-Details-Main.\n     display  CLR40  at 0401.\n*>\n     if       Entry-Mode or Update-Mode\n              display  \"*A/C Nos  [       ]*Rec.   [        ]  *\" at 0441 with foreground-color 2 erase eos\n              display  \"*Repeat # [  ]     *Freq   [ ] [Y,M,Q ]*\" at 0541 with foreground-color 2\n              display  \"*Date  [  /  /    ]*Ref    [          ]*\" at 0641 with foreground-color 2\n              display  \"****************************************\" at 0741 with foreground-color 2\n              display  \"F1 = Setup new Customer; F8 = Only Show delivery details (at A/C entry)\"\n                                                                  at 0907 with foreground-color COB-COLOR-MAGENTA\n              display  \"Remember to Set date to FIRST of month\"   at 1001 with foreground-color 5\n              display  \"Type [ ]  <2> = Account\"                  at 1201 with foreground-color 2.\n*>\n     if       Delete-Mode\n              display  \"*A/C Nos  [       ]*Rec.   [        ]  *\" at 0441 with foreground-color 2 erase eos\n              display  \"****************************************\" at 0541 with foreground-color 2.\n*>\n Customer-Input.\n     move     spaces  to  sih-customer.\n     move     zero to Cob-Crt-Status.\n     accept   sih-customer at 0452 with foreground-color 3 update UPPER.\n     display  space at col 1 line WS-23-Lines with erase eol. *> Clr SL187\n     if       Cob-Crt-Status = Cob-Scr-F1\n              go to New-Customer.\n*>\n     if       Cob-Crt-Status = Cob-Scr-F8\n              move \"Y\" to WS-Show-Delivery\n     else\n              move \"N\" to WS-Show-Delivery.\n*>\n Customer-Test.\n     if       sih-customer = spaces\n       or     Cob-Crt-Status = Cob-Scr-Esc\n              move  \"Q\"  to  Escape-Code\n              go to  Main-Exit.\n*>\n     move     1  to  c-check.\n     move     sih-customer  to WS-Sales-Key.\n*>\n     move     1 to File-Key-No.\n     perform  Sales-Read-Indexed.       *> read sales-file record invalid key\n     if       fs-reply = 21\n              move  zero  to  c-check.\n*>\n     if       not  c-exists\n              display  \"No such Customer\" at 0401 with foreground-color 3\n              go to  Customer-Input.\n     display  CLR16 at 0401.\n     display  space at 0901 with erase eol.  *> Clear F1 comment line\n*>\n Delivery-Read.\n     if       delivery-tag = zero     *> Only show delivery details if F8 pressed instead of\n       or     WS-Show-Delivery = \"N\"  *> accept on cust no. input (here there is no del addr data)\n              go to Customer-Setup.\n*>\n     move     \"D\"          to WS-Deliv-Key-Type.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     perform  Delivery-Read-Indexed.          *> read delivery-file invalid key\n     if       fs-reply = 21\n              move  zero  to  delivery-tag\n              go to  Customer-Setup.\n*>\n     move     deliv-address to address-a.\n     display  \"Delivery Address\" at 0302 with foreground-color 3.\n     go       to Customer-Display.\n*>\n Customer-Setup.\n     display  CLR16 at 0302 with foreground-color 3.\n     move     sales-address  to  address-a.\n*>\n Customer-Display.\n     if       delivery-tag = zero\n              display sales-name at 0301 with foreground-color 3\n     else\n              display deliv-name at 0301 with foreground-color 3.\n*>\n     move     1  to  z.\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by  sl-delim\n                  into  address-line  count z  pointer  z.\n     display  address-line at 0401 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by  sl-delim\n                  into  address-line  count z  pointer  z.\n     display  address-line at 0501 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by  sl-delim\n                  into  address-line  count z  pointer  z.\n     display  address-line at 0601 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by  sl-delim\n                  into  address-line  count z  pointer  z.\n     display  address-line at 0701 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  into  address-line   pointer  z.\n     display  address-line at 0801 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n*>\n Check-For-Delete-Amend.\n     if       Delete-Mode or Amend-Mode\n              move     zero to sih-Test\n                               sih-Invoice\n              accept   sih-Invoice  at 0469 with foreground-color 3 update\n              if       sih-Invoice = zero\n                or     Cob-Crt-Status = Cob-Scr-Esc\n                       move  \"Q\"  to  Escape-Code\n                       go to  Main-Exit\n              end-if\n              move     1 to File-Key-No\n              move     sih-Invoice to Invoice-Nos\n              move     zero to Item-Nos\n              perform  SLautogen-Read-Indexed    *> Get header record\n              if       fs-reply not = zero   *> was = 21mariadb-10.5.20-1.mga8.x86_64\n                       display  SL187 at col 1 line WS-23-Lines with foreground-color 5 BEEP *> Magenta\n                       go to   Check-For-Delete-Amend\n              end-if\n              display  space at  col 1 line WS-23-Lines with erase eol  *> Clr error line\n              if       Delete-Mode\n                       go to  Delete-Current-Record\n              end-if\n              perform  Read-Details\n     end-if.\n*>\n*> Now Amend\n*>\n Get-Invoice-No.\n     if       Entry-Mode\n              move     SL-Next-Rec  to WS-Next-Inv\n              display  WS-Next-Inv at 0469 with foreground-color 7       *> White\n              add      1 to SL-Next-Rec.                             *> remember to deduct one if entry aborted OR add after write\n*>\n*>\n*> Now have header get Invoice lines for same invoice nos\n*> Data present for Amend or initialised for Entry (but have invoice-nos)\n*>\n Repeat-Count-Input.\n     display  \"Repeat option values : \"  at 1501.\n     display  \"99 = NO Repeated operations (option ignored)\" at 1601.\n     display  \"00 = Record WILL BE DELETED\" at 1701.\n     display  \"01 - 96 number of repeated invoice generations before record is deleted\" at 1801.\n     accept   sih-Repeat at 0552 with foreground-color 3 update.\n     if       sih-Repeat not numeric\n              display  \"Not numeric \" at col 1 line WS-23-Lines  with foreground-color 3 BEEP\n              go to Repeat-Count-Input.\n     display  CLR16 (1:12)  at col 1 line WS-23-Lines.\n     display  space at 1501 with erase eol.\n     display  space at 1601 with erase eol.\n     display  space at 1701 with erase eol.\n     display  space at 1801 with erase eol.\n*>\n Freq-Input.\n *>    move     \"Y\" to Sih-Freq.    *> For yearly\n     accept   Sih-Freq at 0569 with foreground-color 3 update UPPER.\n     if       not sih-Valid-Freqs\n              display \"Freq invalid try again\" at col 1 line WS-23-Lines  with foreground-color 3 BEEP\n              go to Freq-Input.\n     display  CLR22 at col 1 line WS-23-Lines.\n*>\n Date-Input.\n     if       Update-Mode   *>  convert bin date to display for updating HERE\n              move     sih-Date to U-Bin\n              perform  zz060-Convert-Date.\n*> Check date in right format on screen\n     accept   WS-date at 0649 with foreground-color 3 update.\n     if       Cob-Crt-Status = Cob-Scr-esc\n         or   WS-date = spaces\n              move 1 to z\n              go to  Main-Exit.\n*>\n     move     WS-date to WS-test-date.\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              go to  Date-Input.\n     display  space  at 1001 with erase eol.  *> Clear date reminder display\n*>\n*> Taking date as is so can be any during a month - NO TEST OR CHANGE\n*>\n     move     WS-test-date to WS-date.  *> still need orig. disp date as WS-date now UK\n     move     u-bin  to  sih-date.\n*>\n Ref-Input.\n     accept   sih-ref at 0669 with foreground-color 3 update.\n*>\n*>  CAN WE NOT JUST FORCE THIS AS 2 ????\n*>\n Type-Input.\n     move     2 to sih-type.\n     accept   sih-type at 1207 with foreground-color 3 update.\n     move     space to WS-named.\n     if       sih-type = zero\n              go to Invoice-Details-Main. *> restart input\n*>\n     if       sih-type  not = 2\n              display  \"Type must be 2 (Invoice)\" at 1236 with foreground-color 3\n              go to  Type-Input.\n     display  space at 1236 with erase eol.\n*>\n     move     d-types  to add-line1.            *> JIC others added\n     display  space at 1201 with erase eol.\n     display  \">>> \" at 1231 with foreground-color 2.\n     display  add-line1 at 1235 with foreground-color 2.\n*>\n     move     zero to sih-cr.\n     move     zero to z.\n*>\n*>  Type 2 (Account) only\n*>\n*>   Leave this in for the moment as not sure it is NOT needed\n*>     but mention process in manual!\n*>\n     move     zero  to  we-error.\n*>\n     subtract sales-unapplied from sales-current.\n*>\n     if       sales-current  >  zero\n              subtract sales-last-inv from run-date giving  work-1\n              if work-1  >  sales-credit\n              display \"Overdue Balance <<<\" at 1648   with foreground-color 2 highlight\n              move  999  to  we-error.\n*>\n     if       sales-current  >  sales-limit\n              display \"Balance Exceeds Credit Limit <<<\" at 1725 with foreground-color 2 highlight\n              move  998  to  we-error.\n*>\n     if       sales-credit not > zero\n          or  sales-limit  not > zero\n              display \"No Longer an Account Customer <<<\" at 1825 with foreground-color 2 highlight\n              move  997  to  we-error.\n*>\n     if       we-error = zero\n              go to  Main-Exit.\n*>\n     display  \">>> Warning! \"      at 1635 with foreground-color 2  highlight.\n     display  \"**********************\" at 1958  with foreground-color 2.\n     display  \"*\" at 2058 with foreground-color 2.\n     display  \"*\" at 2158 with foreground-color 2.\n     display  \"*\" at 2080 with foreground-color 2.\n     display  \"*\" at 2180 with foreground-color 2.\n     display  \"**********************\" at 2258  with foreground-color 2.\n*>\n     display  \"ESC To Abort\" at 2160 with foreground-color 2.\n     display  \"Return To Continue\" at 2060 with foreground-color 2.\n     move     zero to z.\n     accept   z at 2174 with foreground-color 6 update.\n     if       Cob-Crt-Status = Cob-Scr-esc\n              move 1 to z\n                        Cob-Crt-Status\n              subtract 1 from SL-Next-Rec\n              go       to Main-Exit.\n*>\n Delete-Current-Record.\n*>\n*>  We do NOT record deleted record # - they are not reused as not needed for audit purposes.\n*>\n     display  \"Confirm you wish to delete this Autogen record Y/N [ ]\"\n                                                  at col 1 line WS-23-Lines with foreground-color 5. *> Magenta\n     accept   WS-Reply at col 53 line WS-23-Lines with foreground-color 2 UPPER BEEP.\n     if       WS-Reply not = \"Y\" and not = \"N\"\n              display \"Try again using (Y/N)\" at col 61 line WS-23-Lines with foreground-color 2 BEEP.\n              go to Delete-Current-Record.\n     display space at col 1 line WS-23-Lines with erase eol.\n     if       WS-Reply = \"Y\"\n              move     1 to File-Key-No\n              move     Sinvoice-Header to WS-Invoice-Record\n              if       not FS-Cobol-Files-Used\n                       perform  SLautogen-Delete-All\n              else\n                       perform  SLautogen-Delete\n                       move     sih-Invoice to Invoice-Nos\n                       move     zero to j\n                       perform  sih-lines times\n                                add      1 to J\n                                move     J to Item-Nos\n                                perform  SLautogen-Delete\n                       end-perform\n              end-if\n     end-if\n     display  space  at col 1 line WS-23-Lines with erase eol.\n     move     \"C\" to Escape-Code.  *> See if there is mnore to do.\n     go to    Main-Exit.\n*>\n New-Customer.\n     perform  SLautogen-Close.\n*>\n     perform  Sales-Close.               *> close sales-file\n     perform  Delivery-Close.            *> close delivery-file\n     perform  Analysis-Close.            *> close analysis-file\n     if       SL-Stock-Link = \"Y\"\n              perform  Stock-Close.      *> close Stock-File.\n *>    if       Stk-Audit-Used = 1\n *>             perform Stock-Audit-Close. *> close Stock-Audit.\n*>\n*> Call SL cust create program for New customer.\n*>\n     call     \"sl960\" using WS-calling-data system-record to-day.\n     perform  program-start.\n     go       to Invoice-Details-Main.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Program-Start section.\n*>====================\n*>\n     display  space at 0101 with erase eos.\n     move     to-day to u-date.          *> in UK date form\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-15        *> Analysis Needed for sl820 ? & sl830\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    move 1 to WS-Process-Func WS-Sub-Function\n                    call \"sl070\" using WS-calling-data\n                                       system-record\n                                       to-day\n                                       file-defs\n                    call  \"CBL_CHECK_FILE_EXIST\" using File-15   *> Only if the call failed\n                                                       File-Info\n                    if    return-code not = zero          *> not = zero - No file found\n                          display   SL192 at 2301\n                          display   SL003 at 2401\n                          accept WS-Reply at 2430\n                    end-if\n              end-if\n     end-if\n*>\n     perform  Sales-Open.             *> open input sales-file delivery-file analysis-file.\n     perform  Delivery-Open.          *> these 2 are open I-O to force creation.\n     perform  Analysis-Open.\n*>\n*> Create autogen file if not exist and set autogen flag and (system rec) next-inv field.\n*>\n     if       FS-Cobol-Files-Used             *> create Autogen if not exist.\n              call  \"CBL_CHECK_FILE_EXIST\" using File-4       *> slautogen\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    perform  SLautogen-Open-Output    *> open output SLautogen-file\n                    perform  SLautogen-Close          *> close SLautogen-file\n                    move     \"Y\" to SL-Autogen\n                    move     1   to SL-Next-Rec    *> SIMILAR TO NEXT INVOICE #\n              end-if                               *> as file is ISAM\n     end-if\n*>\n     move     zero  to  Menu-Reply.\n     perform  SLautogen-Open.             *>  open i-o SLautogen-file.\n*>\n*> if linked open Stock & Audit file\n*>\n     if       SL-Stock-Link = \"Y\"\n       if     FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-11        *> Stock file\n                                                 File-Info\n              end-call\n              if    return-code not = zero          *> not = zero - No file found\n                    perform Stock-Open-Output      *>  open output stock-file  *> OC doesnt create in i-o - possible bug\n                    perform Stock-Close            *>  close       stock-file\n              end-if\n              perform Stock-Open                   *> open i-o  stock-file   Thats ok we just wont find any items\n       end-if\n     end-if.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   WS-test-date\n*> output:  u-date/WS-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     WS-test-date to WS-date.\n     if       Date-Form = zero\n              move WS-Month to WS-Inv-Month    *> done again for UK - but JIC\n              move 1 to Date-Form.\n     if       Date-UK\n              move WS-Month to WS-Inv-Month\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-Month to WS-days\n              move WS-swap  to WS-Month\n              move WS-Month to WS-Inv-Month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to WS-date.  *> swap Intl to UK form\n     move     WS-test-date (1:4) to WS-Year.\n     move     WS-test-date (6:2) to WS-Month.\n     move     WS-Month           to WS-Inv-Month\n     move     WS-test-date (9:2) to WS-Days.\n*>\n zz050-Test-Date.\n     move     WS-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     u-date to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-Month to WS-days\n              move WS-swap to WS-Month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-date as uk/US/Inlt date format\n*>\n     move     to-day to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-Month to WS-days\n              move WS-swap to WS-Month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n Maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 937
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 18,
    "cognitive": 8,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 213,
      "totalOperators": 221,
      "totalOperands": 436,
      "vocabulary": 215,
      "length": 657,
      "volume": 5090.562702180276
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
