{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs020.cbl",
  "fileName": "irs020.cbl",
  "timestamp": "2025-09-15T16:25:49.304Z",
  "programId": "irs020",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 132
      },
      {
        "name": "file",
        "line": 139
      },
      {
        "name": "working-storage",
        "line": 145
      },
      {
        "name": "linkage",
        "line": 274
      },
      {
        "name": "screen",
        "line": 310
      },
      {
        "name": "init01",
        "line": 605
      },
      {
        "name": "Set-Up",
        "line": 645
      },
      {
        "name": "amend",
        "line": 769
      },
      {
        "name": "Set-Up-Finished",
        "line": 863
      },
      {
        "name": "exit",
        "line": 910
      },
      {
        "name": "Show",
        "line": 912
      },
      {
        "name": "listing",
        "line": 931
      },
      {
        "name": "file-init",
        "line": 1036
      },
      {
        "name": "Input-Headings",
        "line": 1053
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 133
      },
      {
        "name": "reverse-video",
        "line": 318
      },
      {
        "name": "reverse-video",
        "line": 350
      },
      {
        "name": "reverse-video",
        "line": 382
      },
      {
        "name": "reverse-video",
        "line": 455
      },
      {
        "name": "reverse-video",
        "line": 464
      },
      {
        "name": "File-Defs",
        "line": 602
      },
      {
        "name": "main-loop",
        "line": 617
      },
      {
        "name": "main01-exit",
        "line": 642
      },
      {
        "name": "goback",
        "line": 643
      },
      {
        "name": "Set-Up-Main",
        "line": 648
      },
      {
        "name": "main-loop",
        "line": 652
      },
      {
        "name": "get-input",
        "line": 673
      },
      {
        "name": "vat-check",
        "line": 719
      },
      {
        "name": "End-Input",
        "line": 744
      },
      {
        "name": "end-if",
        "line": 762
      },
      {
        "name": "main-exit",
        "line": 766
      },
      {
        "name": "exit",
        "line": 767
      },
      {
        "name": "get-input",
        "line": 784
      },
      {
        "name": "vat-check",
        "line": 836
      },
      {
        "name": "end-input",
        "line": 850
      },
      {
        "name": "main-exit",
        "line": 860
      },
      {
        "name": "exit",
        "line": 861
      },
      {
        "name": "Setup-Fin-Retry",
        "line": 883
      },
      {
        "name": "Set-Up-Finished-Exit",
        "line": 909
      },
      {
        "name": "main-exit",
        "line": 928
      },
      {
        "name": "exit",
        "line": 929
      },
      {
        "name": "p-Client-2",
        "line": 939
      },
      {
        "name": "end-perform",
        "line": 1027
      },
      {
        "name": "Print-Fini",
        "line": 1029
      },
      {
        "name": "list-exit",
        "line": 1033
      },
      {
        "name": "exit",
        "line": 1034
      },
      {
        "name": "main-exit",
        "line": 1050
      },
      {
        "name": "exit",
        "line": 1051
      },
      {
        "name": "end-if",
        "line": 1069
      },
      {
        "name": "end-if",
        "line": 1076
      },
      {
        "name": "display-existing",
        "line": 1096
      },
      {
        "name": "display-existing-end",
        "line": 1131
      },
      {
        "name": "main-exit",
        "line": 1137
      },
      {
        "name": "exit",
        "line": 1138
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 74,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "SYSTEM",
        "line": 1031,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 123,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 130,
        "replacing": null
      },
      {
        "name": "irsprint-spool-command-p",
        "line": 147,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 179,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 180,
        "replacing": null
      },
      {
        "name": "irswsdflt",
        "line": 181,
        "replacing": null
      },
      {
        "name": "irswsfinal",
        "line": 184,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 245,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 254,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 275,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 278,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 308,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 1140,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 75
      },
      {
        "target": "Set-Up",
        "thru": null,
        "line": 624
      },
      {
        "target": "Amend",
        "thru": null,
        "line": 627
      },
      {
        "target": "Show",
        "thru": null,
        "line": 630
      },
      {
        "target": "Listing",
        "thru": null,
        "line": 633
      },
      {
        "target": "Set-Up-Finished",
        "thru": null,
        "line": 636
      },
      {
        "target": "file-init",
        "thru": null,
        "line": 657
      },
      {
        "target": "varying",
        "thru": null,
        "line": 663
      },
      {
        "target": "perform",
        "thru": null,
        "line": 670
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 692
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 750
      },
      {
        "target": "acasirsub3-Write",
        "thru": null,
        "line": 752
      },
      {
        "target": "amend",
        "thru": null,
        "line": 764
      },
      {
        "target": "varying",
        "thru": null,
        "line": 774
      },
      {
        "target": "perform",
        "thru": null,
        "line": 781
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 817
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 856
      },
      {
        "target": "acasirsub3-Write",
        "thru": null,
        "line": 858
      },
      {
        "target": "acasirsub5-Read-Next",
        "thru": null,
        "line": 871
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 881
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 893
      },
      {
        "target": "acasirsub5-Write",
        "thru": null,
        "line": 905
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 907
      },
      {
        "target": "Input-Headings",
        "thru": null,
        "line": 917
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 926
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 951
      },
      {
        "target": "acasirsub3-Read-Next",
        "thru": null,
        "line": 964
      },
      {
        "target": "varying",
        "thru": null,
        "line": 968
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 979
      },
      {
        "target": "*>",
        "thru": null,
        "line": 985
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 990
      },
      {
        "target": "acasirsub5-Read-Next",
        "thru": null,
        "line": 995
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1018
      },
      {
        "target": "acasirsub3-Write",
        "thru": null,
        "line": 1048
      },
      {
        "target": "acasirsub3-Read-Next",
        "thru": null,
        "line": 1059
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 1081
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1107
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 613
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 615
      },
      {
        "from": "zero",
        "to": "menu-reply",
        "line": 620
      },
      {
        "from": "1",
        "to": "cole\n              add 6 w giving lin\n              display w at curs with foreground-color 2\n              move 41 to cole\n              display y at curs with foreground-color 2\n     end-perform\n     perform  Input-Headings",
        "line": 665
      },
      {
        "from": "ws-acs",
        "to": "def-acs (w)",
        "line": 680
      },
      {
        "from": "41",
        "to": "cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input",
        "line": 682
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 687
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 691
      },
      {
        "from": "\"OB\"",
        "to": "ws-codes\n      else\n       if     w = 31                        *> Purchases\n              move \"VI\" to ws-codes\n       else                                 *> must be 32 (sales)",
        "line": 706
      },
      {
        "from": "\"VO\"",
        "to": "ws-codes",
        "line": 711
      },
      {
        "from": "\"N\"",
        "to": "ws-vat2\n              display ws-vat2 at curs2 with foreground-color 3\n     end-if\n     move     function upper-case (ws-vat2) to ws-vat",
        "line": 727
      },
      {
        "from": "ws-vat",
        "to": "def-vat (w)",
        "line": 731
      },
      {
        "from": "41",
        "to": "cole\n              move 6   to  lin",
        "line": 739
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 749
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 751
      },
      {
        "from": "1",
        "to": "cole\n              add 6 w giving lin\n              display w at curs with foreground-color 2\n              move 41 to cole\n              display y at curs with foreground-color 2\n     end-perform\n     perform  Input-Headings",
        "line": 776
      },
      {
        "from": "zero",
        "to": "y",
        "line": 786
      },
      {
        "from": "y",
        "to": "w",
        "line": 795
      },
      {
        "from": "41",
        "to": "cole\n     else\n              move 1 to cole\n     end-if\n     move     zero to lin",
        "line": 798
      },
      {
        "from": "ws-acs",
        "to": "def-acs (w)",
        "line": 808
      },
      {
        "from": "ws-acs",
        "to": "nl-owning",
        "line": 811
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 812
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 816
      },
      {
        "from": "ws-codes",
        "to": "def-codes (w)",
        "line": 828
      },
      {
        "from": "ws-vat",
        "to": "def-vat (w)",
        "line": 843
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 855
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 857
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 870
      },
      {
        "from": "1",
        "to": "file-function access-type",
        "line": 880
      },
      {
        "from": "zeros",
        "to": "PL-App-Created PL-Approp-AC\n     end-if\n     accept   Finished-Account-Setup-Screen-1",
        "line": 885
      },
      {
        "from": "\"1\"",
        "to": "PL-App-Created\n              move  PL-Approp-AC to nl-owning\n              move  zero to nl-sub-nominal\n *>             move  4 to file-function                      *> Read indexed\n              perform  acasirsub1-Read-Indexed\n              if    we-error = 2\n                    display IR021  at 2401 with foreground-color 4\n                    display IR022  at 2437 with foreground-color 2\n                    accept ws-reply at 2467\n                    go to setup-fin-retry\n              end-if\n     end-if\n*>\n*> open, write out & close file\n*>\n *>    move     5 to file-function",
        "line": 889
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 906
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 920
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 925
      },
      {
        "from": "run-date",
        "to": "p-date",
        "line": 937
      },
      {
        "from": "client",
        "to": "p-client\n                           p-Client-2",
        "line": 938
      },
      {
        "from": "suser",
        "to": "p-user",
        "line": 940
      },
      {
        "from": "hd-hh",
        "to": "hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time",
        "line": 943
      },
      {
        "from": "1",
        "to": "file-function  access-type",
        "line": 950
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 958
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 963
      },
      {
        "from": "w",
        "to": "p-num\n              move  def-acs (w)  to  p-ac\n              move  def-acs (w)  to  nl-owning\n              move  zero  to  nl-sub-nominal\n              if    def-acs (w)  =  zero\n                    move spaces to  p-desc\n                                    p-vat\n                                    p-code\n              else\n *>                   move 4  to  file-function   *>  get code description\n                    perform acasirsub1-Read-Indexed\n                    move nl-name to p-desc\n                    move def-codes (w) to p-code\n                    move def-vat (w)   to p-vat\n              end-if\n              write    print-record from line-5 after 1\n     end-perform\n*>\n*> Done so close files and spool report\n*>\n *>    move     2  to  file-function",
        "line": 969
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 994
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1002
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1012
      },
      {
        "from": "14",
        "to": "B",
        "line": 1017
      },
      {
        "from": "\"Z\"",
        "to": "ws-reply\n*>              go to main-exit",
        "line": 1044
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 1047
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 1058
      },
      {
        "from": "1",
        "to": "file-function   access-type",
        "line": 1080
      },
      {
        "from": "space",
        "to": "ws-reply\n              accept ws-reply at 2430\n              go to main01-exit in init01",
        "line": 1086
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 1092
      },
      {
        "from": "7",
        "to": "lin",
        "line": 1093
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1094
      },
      {
        "from": "ws-acs",
        "to": "nl-owning",
        "line": 1103
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1104
      },
      {
        "from": "4",
        "to": "file-function\n              perform acasirsub1-Read-Indexed\n              add  10 curs giving curs2\n              display nl-name (1:22) at curs2 with foreground-color cob-color-cyan\n     end-if\n*>\n*> Get code description\n*>\n     add      33  curs giving curs2",
        "line": 1106
      },
      {
        "from": "41",
        "to": "cole\n              move 6   to  lin",
        "line": 1126
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 1134
      },
      {
        "from": "7",
        "to": "lin",
        "line": 1135
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "coa exists if not exit.\n*> 25/07/83 vbc - fix print routine,set ans to 0 1st.\n*> 15/09/83 vbc - clean up print layout.\n*> 28/05/84 vbc - hilite disp heads.\n*> 14/04/85 vbc - exclude finals & reduce print to 79 chars.\n*> 26/09/89 vbc - 2.53\n*>                mods for cobol/2 change print to 80 chars.\n*> 21/01/09 vbc - Migration to Open/Gnu Cobol as version 3.\n*> 21/02/09 vbc - Cosmetics in the displays for setup and amend\n*> 21/09/10 vbc - Added print spool.\n*>                .10 fix for portrait printing\n*> 11/10/16 vbc - .11 Print out Finished A/C titles.\n*> 01/12/16 vbc - 3.02\n*>                .12 RDB support via acasirsub(1-5) & DALs and using\n*>                    standard ACAS param file (system.dat) for info pickup\n*>                    passed to IRS-System-Params (renamed from system-record).\n*>                    Replaced all occurances of call \"irsubn\" by\n*>                     perform acasirsubn\n*>                    File-Defs  added to all irsnnn calls as 2nd param.\n*>                    Clean up all msgs to use Pre-Defined ones system/module\n*>                    wide across entire IRS system in compliance with all of\n*>                    ACAS.\n*> 20/12/16 vbc -     All irs progs call cpybk Proc-ZZ100-ACAS-IRS-Calls.\n*> 25/12/17 vbc -     RW version available.\n*> 29/01/18 vbc - .13 Changed copies to use copybooks where poss.\n*>                    renamed print-spool-commandxxx & wsnl to irsprint-spool-command\n*>                    & irswsnl as moved to copybooks dir.\n*> 07/02/18 vbc - .14 Check for ESC on amend as well as zero entered.\n*> 10/02/18 vbc - .15 Renamed IR011-16 to IR911-16 and others.\n*> 12/02/18 vbc - .16 Changed PL-Approp from 5 to 6. Yes IRS uses 5 but GL is 6.\n*> 14/02/18 vbc - .17 In Set up, check that def. acs 30 - 32 have been created\n*>                    (non zero values) else display IR025, SY008\n*>",
        "line": 58
      },
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n copy  \"envdiv.cob\".\n*>\n input-output section.\n file-control.\n*>\n     select  print-file     assign  \"prt-1\"\n                            organization line sequential.\n*>\n data division.\n file section.\n*>\n fd  print-file.\n 01  print-record.\n     03  filler          pic x(80).\n*>\n working-storage section.\n 01  prog-name           pic x(16)    value \"irs020 (3.02.18)\".\n copy \"irsprint-spool-command-p.cob\".\n*>\n 01  filler.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  input-type      pic x.\n         88  sub-input        value  \"Y\".\n     03  ws-pass         pic x(4).\n     03  A               pic 99    comp value zero.      *> 4 Final print\n     03  B               pic 99    comp value zero.      *> 4 Final print\n     03  w               pic 99.\n     03  y               pic 99.\n*>\n     03  hdtime                          value spaces.\n         05  hd-hh       pic xx.\n         05  hd-mm       pic xx.\n         05  hd-ss       pic xx.\n         05  hd-uu       pic xx.\n     03  HD2-Time.\n         05  filler      pic x     value spaces.\n         05  hd2-hh      pic xx.\n         05  filler      pic x     value \":\".\n         05  hd2-mm      pic xx.\n*>\n     03  ws-acs          pic 9(5).\n     03  ws-codes        pic xx.\n     03  ws-codes2       pic xx.\n     03  ws-vat          pic x.\n     03  ws-vat2         pic x.\n     03  filler                           value \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".\n         05  WS-Alpha-Cd1 pic x occurs 26.\n*>\n copy  \"irswsnl.cob\"   replacing NL-Record by WS-IRSNL-Record.\n copy  \"wsfnctn.cob\".\n copy  \"irswsdflt.cob\" replacing Default-Record by WS-IRS-Default-Record.\n*>\n*>                  finals not in use at present but included ?\n copy  \"irswsfinal.cob\".\n*>\n 01  filler.\n     03  line-1.\n       05  p-user        pic x(24).\n       05  filler        pic x(5)     value spaces.\n       05  filler        pic x(25)    value \"Incomplete Records System\".\n       05  filler        pic x(11)    value spaces.\n       05  p-date        pic x(8).\n       05  p-time        pic x(6)     value spaces.   *> BHH:MM\n*>\n     03  line-3.\n       05  p-client      pic x(24).\n       05  filler        pic x(9)     value spaces.\n       05  filler        pic x(16)    value \"Posting Defaults\".\n       05  filler        pic x(23)    value spaces.\n*>\n     03  line-4.\n       05  filler        pic x(64)    value\n       \"             A/C Nos     ------Description------    Code VAT\".\n*>\n     03  line-5.\n       05  filler        pic x(10)    value spaces.\n       05  p-num         pic z9bb.\n       05  p-ac          pic zzzz9b   blank when zero.\n       05  filler        pic x(5)     value spaces.\n       05  p-desc        pic x(25).\n       05  filler        pic x(3)     value spaces.\n       05  p-code        pic xx.\n       05  filler        pic x(5)     value spaces.\n       05  p-vat         pic x.\n*>\n     03  line-6.\n         05  p-client-2  pic x(24).\n         05  filler      pic x(9)     value spaces.\n         05  filler      pic x(17)    value \"Finished Accounts\".\n         05  filler      pic x(22)    value spaces.\n*>\n     03  line-7.\n         05  filler      pic x(80)    value\n         \"    A/C       Heading               Sign\" &\n         \"    A/C       Heading               Sign\".\n\n     03  line-8.\n         05  filler      pic x(50)    value\n         \"   Type                                    Type\".\n*>\n     03  line-9.\n       04  filler occurs 2.\n         05  filler      pic x(4)     value spaces.\n         05  filler      pic x        value \"<\".\n         05  Pos-1       pic x.\n         05  filler      pic x        value \">\".\n         05  filler      pic xxx      value spaces.\n         05  Par-1       pic x(24).\n         05  filler      pic xxx      value spaces.\n         05  filler      pic x        value \"[\".\n         05  Par-2       pic x.\n         05  filler      pic x        value \"]\".\n*>\n 01  All-My-Constants      pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n *>    03  WS-IRSNL-Record       pic x.\n *>    03  WS-IRS-Default-Record pic x.\n     03  Posting-Record        pic x.\n     03  WS-IRS-Posting-Record pic x.\n *>    03  Final-Record          pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide      USED are :\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR914          pic x(51) value \"IR914 Error on irspostingMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific  USED are :\n     03  IR020          pic x(52) value \"IR020 Give Default to amend - [  ]  (Use 00 to quit)\".\n     03  IR021          pic x(35) value \"IR021 Account not found. Try again!\".\n     03  IR022          pic x(28) value \"IR022 Hit return to continue\".\n     03  IR023          pic x(42) value \"IR023 End of listing. Hit return for Menu \".\n     03  IR024          pic x(62) value\n                 \"IR024 You must Setup Chart of Accounts first (Selection no. 2)\".\n     03  IR025          pic x(44) value \"IR025 You MUST set up accounts 30, 31 and 32\".\n*>\n linkage section.\n copy  \"irswssystem.cob\"\n              replacing system-record  by IRS-System-Params. *> (01 level)\n*>\n copy \"wssystem.cob\"    *> NEW for v3.02\n             replacing  System-Record by WS-System-Record\n                        Run-Date   by ACAS-Run-Date     *> these 3 are in binary\n                        Start-Date by ACAS-Start-Date   *> IRS expects as x(8)\n                        End-Date   by ACAS-End-Date     *>  dd/mm/yy\n                        suser      by ACAS-suser\n                        Address-1  by ACAS-Address-1\n                        Address-2  by ACAS-Address-2\n                        Address-3  by ACAS-Address-3\n                        Address-4  by ACAS-Address-4\n                        Post-Code  by ACAS-Post-Code\n                        Print-Spool-Name by ACAS-Print-Spool-Name\n                        Pass-Value by ACAS-Pass-Value\n                        Pass-Word  by ACAS-Pass-Word\n                        OP-System  By ACAS-Op-System\n                        Client     by IRS-Client\n                        System-Ops by IRS-System-Ops\n                        Next-Post  by IRS-Next-Post\n                        Vat-Rates2 by IRS-Vat-Rates2\n                        Vat1       by IRS-Vat1\n                        Vat2       by IRS-Vat2\n                        Vat3       by IRS-Vat3\n                        Vat-Group  by IRS-Vat-Group\n                        Vat-Psent  by IRS-Vat-Psent\n                        Save-Sequ  by IRS-Save-Sequ\n                        System-Work-Group by IRS-System-Work-Group\n                        PL-App-Created by IRS-PL-App-Created\n                        PL-Approp-AC   by IRS-PL-Approp-AC\n                        1st-Time-Flag  by IRS-First-Time-Flag.\n*>\n copy \"wsnames.cob\".\n*>\n screen section.\n*>--------------\n 01  menu-screen-1             background-color cob-color-black\n                               foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col 1   blank screen.\n     03  value \"Default File Utilities\"    line 1 col 29\n                               foreground-color cob-color-white\n                               background-color cob-color-blue\n                                        reverse-video.\n     03  pic x(8) from run-date            line 1 col 73.\n     03  value \"Client -\"                  line 3 col 1.\n     03  pic x(29) from client             line 3 col 10\n                               foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line 3 col 39.\n     03  pic x(8) from start-date          line 3 col 52\n                               foreground-color cob-color-cyan.\n     03  value \"End date -\"                line 3 col 62.\n     03  pic x(8) from end-date            line 3 col 73\n                               foreground-color cob-color-cyan.\n     03  value \"Select the required function by number    [\"\n                                           line 5 col 1.\n     03  pic x using menu-reply  auto      line 5 col 44\n                               foreground-color cob-color-yellow.\n     03  value \"]\"                         line 5 col 45.\n     03  value \"(1)  Set-Up Default Accounts\" line  8 col 6.\n     03  value \"(2)  Amend  Default Accounts\" line 10 col 6.\n     03  value \"(3)  Display the Defaults\"    line 12 col 6.\n     03  value \"(4)  Print   the Defaults\"    line 14 col 6.\n     03  value \"(5)  Set-Up Final Accounts\"   line 17 col 6.\n     03  value \"(9)  Return to System Menu\"   line 20 col 6.\n     03  value \"F1 to F5 = options 1 to 5;  Return to Accept \" &\n             \"data;   Escape to quit\"               line 23 col 1\n                       highlight foreground-color cob-color-white.\n*>\n 01  Setup-Screen-1            background-color cob-color-black\n                               foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col 1   blank screen.\n     03  value \"Default Accounts Setup\"    line 1 col 29\n                               foreground-color cob-color-white\n                               background-color cob-color-blue\n                                reverse-video.\n     03  pic x(8) from run-date            line 1 col 73.\n*>\n 01  Setup-Screen-2Q.\n     03  value \"Client -\"                  line 3 col  1.\n     03  pic x(24) from client             line 3 col 10 foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line 3 col 39.\n     03  pic x(8) from start-date          line 3 col 52 foreground-color cob-color-cyan.\n     03  value \"End date -\"                line 3 col 62.\n     03  pic x(8) from end-date            line 3 col 73 foreground-color cob-color-cyan.\n     03  value \"Add to Existing Defaults (Y/N) ? - [\"\n                                           line 5 col 1.\n     03  pic x to ws-reply  auto           line 5 col 37 foreground-color cob-color-yellow.\n     03  value \"]\"                         line 5 col 38.\n     03  value \"N.B. (1) If first time setup for this client an\" &\n               \"swer no (N)\"               line 7 col  1 background-color cob-color-red\n                                                         foreground-color cob-color-white.\n     03  value \"(2) Answering no (N)\"      line 8 col  6 background-color cob-color-red\n                                                         foreground-color cob-color-white.\n     03  value \"destroys\"                  line 8 col 27 foreground-color cob-color-white\n                                                         background-color cob-color-red\n                                                                blink reverse-video.\n     03  value \"the existing defaults\"     line 8 col 36 background-color cob-color-red\n                                                         foreground-color cob-color-white.\n     03  value \"Escape to quit;    Return to Accept data\"\n                                           line 23 col 1 highlight foreground-color cob-color-white.\n*>\n 01  Amend-Screen-1                                      background-color cob-color-black\n                                                         foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col  1  blank screen.\n     03  value \"Default Accounts Amendments\" line 1 col 28 foreground-color cob-color-white\n                                                           background-color cob-color-blue\n                                                                reverse-video.\n     03  pic x(8) from run-date            line 1 col 73.\n*> setup\n 01  Setup-Amend-Screen-3                                 background-color cob-color-black\n                                                          foreground-color cob-color-green.\n     03  value \"Client -\"                  line  3 col  1.\n     03  pic x(24) from client             line  3 col 10 foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line  3 col 39.\n     03  pic x(8) from start-date          line  3 col 52 foreground-color cob-color-cyan.\n     03  value \"End date -\"                line  3 col 62.\n     03  pic x(8) from end-date            line  3 col 73 foreground-color cob-color-cyan.\n     03  value \"A/C Nos\"                   line  5 col  4.\n     03  value \"Description\"               line  5 col 14.\n     03  value \"Code VAT   A/C Nos\"        line  5 col 33.\n     03  value \"Description\"               line  5 col 54.\n     03  value \"Code VAT\"                  line  5 col 73.\n     03  value \" \"  erase eol              line  6 col 1.\n     03  value \"01 [00000]                      [AB] [C]\" &\n            \"17 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"02 [00000]                      [AB] [C]\" &\n            \"18 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"03 [00000]                      [AB] [C]\" &\n            \"19 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"04 [00000]                      [AB] [C]\" &\n            \"20 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"05 [00000]                      [AB] [C]\" &\n            \"21 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"06 [00000]                      [AB] [C]\" &\n            \"22 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"07 [00000]                      [AB] [C]\" &\n            \"23 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"08 [00000]                      [AB] [C]\" &\n            \"24 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"09 [00000]                      [AB] [C]\" &\n            \"25 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"10 [00000]                      [AB] [C]\" &\n            \"26 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"11 [00000]                      [AB] [C]\" &\n            \"27 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"12 [00000]                      [AB] [C]\" &\n            \"28 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"13 [00000]                      [AB] [C]\" &\n            \"29 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"14 [00000]                      [AB] [C]\" &\n            \"30 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"15 [00000]                      [AB] [C]\" &\n            \"31 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n     03  value \"16 [00000]                      [AB] [C]\" &\n            \"32 [00000]                      [DE] [F]\"\n                                           line plus 1 col 1.\n*> after display need to update cc1&2 with 1 - 16 & cc41&42 with 17 - 32\n*>  cc4/44 = a/c-nos , vat 38/78, 33/73 code\n*>\n 01  Display-Screen-1                                     background-color cob-color-black\n                                                          foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line  1 col  1      blank screen.\n     03  value \"Default Accounts Display\"  line  1 col 27 foreground-color cob-color-white\n                                                          background-color cob-color-blue\n                                                                reverse-video.\n     03  pic x(8) from run-date            line  1 col 73.\n*>\n 01  Finished-Account-Setup-Screen-1                      background-color cob-color-black\n                                                          foreground-color cob-color-green.\n     03  value \"Client \"                   line  1 col  1         blank screen.\n     03  pic x(24) from client             line  1 col  8 foreground-color cob-color-cyan.\n     03  value \"Finished Accounts Setup\"   line  1 col 34 foreground-color cob-color-white\n                                                          background-color cob-color-blue\n                                                                 reverse-video.\n     03  pic x(8) from run-date            line  1 col 73.\n     03  value \"Trading and Profit & Loss Account              \" &\n               \"   Balance Sheet\"          line  3 col  4.\n     03  value \"--------Heading---------  Sign          -------\" &\n               \"-Heading---------  Sign\"   line  4 col 10.\n     03  value \"Income Accounts\"           line  5 col  1.\n     03  value \"Fixed     Assets\"          line  5 col 41.\n     03  value \"<A>   [\"                   line  6 col  3.\n     03  pic x(24) using ar1-1             line  6 col 10 foreground-color 3.\n     03  value \"] [\"                       line  6 col 34.\n     03  pic x     using ar2-1             line  6 col 37 foreground-color 3.\n     03  value \"]    <O>   [\"              line  6 col 38.\n     03  pic x(24) using ar1-15            line  6 col 50 foreground-color 3.\n     03  value \"] [\"                       line  6 col 74.\n     03  pic x     using ar2-15            line  6 col 77 foreground-color 3.\n     03  value \"]\"                         line  6 col 78.\n     03  value \"<B>   [\"                   line  7 col  3.\n     03  pic x(24) using ar1-2             line  7 col 10 foreground-color 3.\n     03  value \"] [\"                       line  7 col 34.\n     03  pic x     using ar2-2             line  7 col 37 foreground-color 3.\n     03  value \"]    <P>   [\"              line  7 col 38.\n     03  pic x(24) using ar1-16            line  7 col 50 foreground-color 3.\n     03  value \"] [\"                       line  7 col 74.\n     03  pic x     using ar2-16            line  7 col 77 foreground-color 3.\n     03  value \"]\"                         line  7 col 78.\n     03  value \"<C>   [\"                   line  8 col  3.\n     03  pic x(24) using ar1-3             line  8 col 10 foreground-color 3.\n     03  value \"] [\"                       line  8 col 34.\n     03  pic x     using ar2-3             line  8 col 37 foreground-color 3.\n     03  value \"]    <Q>   [\"              line  8 col 38.\n     03  pic x(24) using ar1-17            line  8 col 50 foreground-color 3.\n     03  value \"] [\"                       line  8 col 74.\n     03  pic x     using ar2-17            line  8 col 77 foreground-color 3.\n     03  value \"]\"                         line  8 col 78.\n     03  value \"<D>   [\"                   line  9 col  3.\n     03  pic x(24) using ar1-4             line  9 col 10 foreground-color 3.\n     03  value \"] [\"                       line  9 col 34.\n     03  pic x     using ar2-4             line  9 col 37 foreground-color 3.\n     03  value \"]\"                         line  9 col 38.\n     03  value \"Direct Cost Accounts\"      line 10 col  1.\n     03  value \"Current Assets\"            line 10 col 41.\n     03  value \"<E>   [\"                   line 11 col  3.\n     03  pic x(24) using ar1-5             line 11 col 10 foreground-color 3.\n     03  value \"] [\"                       line 11 col 34.\n     03  pic x     using ar2-5             line 11 col 37 foreground-color 3.\n     03  value \"]    <R>   [\"              line 11 col 38.\n     03  pic x(24) using ar1-18            line 11 col 50 foreground-color 3.\n     03  value \"] [\"                       line 11 col 74.\n     03  pic x     using ar2-18            line 11 col 77 foreground-color 3.\n     03  value \"]\"                         line 11 col 78.\n     03  value \"<F>   [\"                   line 12 col  3.\n     03  pic x(24) using ar1-6             line 12 col 10 foreground-color 3.\n     03  value \"] [\"                       line 12 col 34.\n     03  pic x     using ar2-6             line 12 col 37 foreground-color 3.\n     03  value \"]    <S>   [\"              line 12 col 38.\n     03  pic x(24) using ar1-19            line 12 col 50 foreground-color 3.\n     03  value \"] [\"                       line 12 col 74.\n     03  pic x     using ar2-19            line 12 col 77 foreground-color 3.\n     03  value \"]\"                         line 12 col 78.\n     03  value \"<G>   [\"                   line 13 col  3.\n     03  pic x(24) using ar1-7             line 13 col 10 foreground-color 3.\n     03  value \"] [\"                       line 13 col 34.\n     03  pic x     using ar2-7             line 13 col 37 foreground-color 3.\n     03  value \"]    <T>   [\"              line 13 col 38.\n     03  pic x(24) using ar1-20            line 13 col 50 foreground-color 3.\n     03  value \"] [\"                       line 13 col 74.\n     03  pic x     using ar2-20            line 13 col 77 foreground-color 3.\n     03  value \"]\"                         line 13 col 78.\n     03  value \"<H>   [\"                   line 14 col  3.\n     03  pic x(24) using ar1-8             line 14 col 10 foreground-color 3.\n     03  value \"] [\"                       line 14 col 34.\n     03  pic x     using ar2-8             line 14 col 37 foreground-color 3.\n     03  value \"]\"                         line 14 col 38.\n     03  value \"Sundry Income Accounts\"    line 15 col  1.\n     03  value \"Current Liabilities\"       line 15 col 41.\n     03  value \"<I>   [\"                   line 16 col  3.\n     03  pic x(24) using ar1-9             line 16 col 10 foreground-color 3.\n     03  value \"] [\"                       line 16 col 34.\n     03  pic x     using ar2-9             line 16 col 37 foreground-color 3.\n     03  value \"]    <U>   [\"              line 16 col 38.\n     03  pic x(24) using ar1-21            line 16 col 50 foreground-color 3.\n     03  value \"] [\"                       line 16 col 74.\n     03  pic x     using ar2-21            line 16 col 77 foreground-color 3.\n     03  value \"]\"                         line 16 col 78.\n     03  value \"<J>   [\"                   line 17 col  3.\n     03  pic x(24) using ar1-10            line 17 col 10 foreground-color 3.\n     03  value \"] [\"                       line 17 col 34.\n     03  pic x     using ar2-10            line 17 col 37 foreground-color 3.\n     03  value \"]    <V>   [\"              line 17 col 38.\n     03  pic x(24) using ar1-22            line 17 col 50 foreground-color 3.\n     03  value \"] [\"                       line 17 col 74.\n     03  pic x     using ar2-22            line 17 col 77 foreground-color 3.\n     03  value \"]\"                         line 17 col 78.\n     03  value \"Indirect Cost Accounts\"    line 18 col  1.\n     03  value \"Capital Accounts\"          line 18 col 41.\n     03  value \"<K>   [\"                   line 19 col  3.\n     03  pic x(24) using ar1-11            line 19 col 10 foreground-color 3.\n     03  value \"] [\"                       line 19 col 34.\n     03  pic x     using ar2-11            line 19 col 37 foreground-color 3.\n     03  value \"]    <W>   [\"              line 19 col 38.\n     03  pic x(24) using ar1-23            line 19 col 50 foreground-color 3.\n     03  value \"] [\"                       line 19 col 74.\n     03  pic x     using ar2-23            line 19 col 77 foreground-color 3.\n     03  value \"]\"                         line 19 col 78.\n     03  value \"<L>   [\"                   line 20 col  3.\n     03  pic x(24) using ar1-12            line 20 col 10 foreground-color 3.\n     03  value \"] [\"                       line 20 col 34.\n     03  pic x     using ar2-12            line 20 col 37 foreground-color 3.\n     03  value \"]    <X>   [\"              line 20 col 38.\n     03  pic x(24) using ar1-24            line 20 col 50 foreground-color 3.\n     03  value \"] [\"                       line 20 col 74.\n     03  pic x     using ar2-24            line 20 col 77 foreground-color 3.\n     03  value \"]\"                         line 20 col 78.\n     03  value \"<M>   [\"                   line 21 col  3.\n     03  pic x(24) using ar1-13            line 21 col 10 foreground-color 3.\n     03  value \"] [\"                       line 21 col 34.\n     03  pic x     using ar2-13            line 21 col 37 foreground-color 3.\n     03  value \"]    <Y>   [\"              line 21 col 38.\n     03  pic x(24) using ar1-25            line 21 col 50 foreground-color 3.\n     03  value \"] [\"                       line 21 col 74.\n     03  pic x     using ar2-25            line 21 col 77 foreground-color 3.\n     03  value \"]\"                         line 21 col 78.\n     03  value \"<N>   [\"                   line 22 col  3.\n     03  pic x(24) using ar1-14            line 22 col 10 foreground-color 3.\n     03  value \"] [\"                       line 22 col 34.\n     03  pic x     using ar2-14            line 22 col 37 foreground-color 3.\n     03  value \"]    <Z>   [\"              line 22 col 38.\n     03  pic x(24) using ar1-26            line 22 col 50 foreground-color 3.\n     03  value \"] [\"                       line 22 col 74.\n     03  pic x     using ar2-26            line 22 col 77 foreground-color 3.\n     03  value \"]\"                         line 22 col 78.\n     03  value \"P & L Appropriation Account [\"  line 23 col  1.\n     03  pic 9(6) using PL-Approp-AC6      line 23 col 30 foreground-color 3.\n     03  value \"]\"                         line 23 col 36.\n*>\n procedure division using IRS-System-Params\n                          WS-System-Record\n                          File-Defs.\n*>*****************************************\n*>\n init01  section.\n*>--------------\n*>\n*> first get Date & User Information\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n     move     1 to File-Key-No.               *> 1 = Primary\n*>\n main-loop.\n*>----------\n*>\n     move     zero to menu-reply.\n     display  menu-screen-1.\n     accept   menu-screen-1.\n     if       menu-reply = 1 or Cob-Crt-Status = Cob-Scr-F1\n              perform Set-Up\n     else\n      if      menu-reply = 2 or Cob-Crt-Status = Cob-Scr-F2\n              perform Amend\n      else\n       if     menu-reply = 3 or Cob-Crt-Status = Cob-Scr-F3\n              perform Show\n       else\n        if    menu-reply = 4 or Cob-Crt-Status = Cob-Scr-F4\n              perform Listing\n        else\n         if   menu-reply = 5 or Cob-Crt-Status = Cob-Scr-F5\n              perform Set-Up-Finished\n         else\n         if   menu-reply = 9 or Cob-Crt-Status = Cob-Scr-Esc\n              go to main01-exit.\n     go       to main-loop.\n*>\n main01-exit.\n     goback.\n*>\n Set-Up section.\n*>-------------\n*>\n Set-Up-Main.\n     display  Setup-Screen-1.\n     accept   Setup-Screen-2Q.\n*>\n main-loop.\n*>---------\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to main-exit.\n     if       function upper-case (ws-reply) = \"N\"\n              perform  file-init.\n     if       function upper-case (ws-reply) not = \"Y\" and not = \"N\"\n              go to Set-Up-Main.\n*>\n     display  Setup-Screen-1.\n     display  Setup-Amend-Screen-3.\n     perform  varying w from 1 by 1 until w > 16\n              add w 16 giving y\n              move 1 to cole\n              add 6 w giving lin\n              display w at curs with foreground-color 2\n              move 41 to cole\n              display y at curs with foreground-color 2\n     end-perform\n     perform  Input-Headings.\n*>\n get-input.\n*>----------\n*>\n     display  w at curs with foreground-color 2.\n     add      4  curs giving curs2.\n     move     def-acs (w) to ws-acs.\n     accept   ws-acs at curs2 with update foreground-color cob-color-cyan.\n     move     ws-acs to def-acs (w).\n     if       def-acs (w)  =  zero\n              move 41  to  cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input.\n     move     def-acs (w)  to  nl-owning.\n     move     zero  to  nl-sub-nominal.\n*>\n*> get code description.\n*>\n *>    move     4  to  file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error  =  2\n              go to get-input.\n     add      10  curs giving curs2.\n     display  nl-name at curs2  with foreground-color cob-color-cyan.\n     add      22 to col2.\n     display  \"[  ]\"  at curs2 with foreground-color 2.\n     add      1 to col2.\n     move     def-codes (w) to ws-codes.\n*>\n     if       w < 30\n              accept ws-codes  at curs2 with update foreground-color 3\n     else\n      if      w = 30\n              move \"OB\" to ws-codes\n      else\n       if     w = 31                        *> Purchases\n              move \"VI\" to ws-codes\n       else                                 *> must be 32 (sales).\n              move \"VO\" to ws-codes.\n*>\n     move     function upper-case (ws-codes) to def-codes (w).\n     add      32    curs giving curs2.\n     add      1 to col2.\n     display  ws-codes at curs2  with foreground-color cob-color-cyan.\n     add      2 to col2.\n*>\n vat-check.\n*>----------\n*>\n     add      38    curs giving curs2.\n     move     def-vat (w) to ws-vat2.\n     if       w < 30\n              accept ws-vat2 at curs2 with foreground-color 3\n     else\n              move \"N\" to ws-vat2\n              display ws-vat2 at curs2 with foreground-color 3\n     end-if\n     move     function upper-case (ws-vat2) to ws-vat.\n     move     ws-vat to def-vat (w).\n     if       ws-vat not = \"I\" and not = \"N\" and not = \"O\"\n              go to vat-check.\n*>\n     add      1  to  w.\n     if       w  >  32\n              go to end-input.\n     if       w  =  17\n              move 41  to  cole\n              move 6   to  lin.\n     add      1  to  lin.\n     go       to get-input.\n*>\n End-Input.\n*>----------\n*>\n*> now close A/c file & write out defaults.\n*>\n *>                                   move     2  to  file-function.\n     perform  acasirsub1-Close.\n *>                                   move     5  to  file-function.\n     perform  acasirsub3-Write.\n*>\n*>  Check that default a/cs 30, 31 & 32 have been set up.\n*>\n     if       def-acs (30) = zero\n          or  def-acs (31) = zero\n          or  def-acs (32) = zero\n              display IR025 at 2301 with foreground-color 2 erase eol\n              display SY008 at 2401 with foreground-color 2 erase eol\n              accept  ws-reply at 2435\n     end-if.\n*>\n     perform  amend.           *> Force Amendment mode.\n*>\n main-exit.\n     exit.\n*>\n amend section.\n*>-------------\n*>\n     display  Amend-Screen-1.\n     display  Setup-Amend-Screen-3.\n     perform  varying w from 1 by 1 until w > 16\n              add w 16 giving y\n              move 1 to cole\n              add 6 w giving lin\n              display w at curs with foreground-color 2\n              move 41 to cole\n              display y at curs with foreground-color 2\n     end-perform\n     perform  Input-Headings.\n*>\n get-input.\n*>----------\n     move     zero to y.\n     display  IR020 at 2420 with foreground-color 2 with erase eol.\n     accept   y     at 2451 with update foreground-color cob-color-yellow.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to End-Input.\n     if       y = zero\n              go to end-input.\n     if       y < 1 or > 32\n              go to get-input.\n     move     y to w.\n     if       y > 16\n              subtract 16 from y\n              move 41 to cole\n     else\n              move 1 to cole\n     end-if\n     move     zero to lin.\n     add      y 6 to lin.\n     display  w at curs       with foreground-color 2.\n     add      4 curs giving curs2.\n     move     def-acs (w) to ws-acs.\n     accept   ws-acs at curs2 with update foreground-color cob-color-cyan.\n     move     ws-acs to def-acs (w).\n     if       ws-acs = zero\n              go to end-input.\n     move     ws-acs to nl-owning.\n     move     zero to nl-sub-nominal.\n*>\n*> get code description.\n*>\n *>    move     4 to file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              go to get-input.\n     add      10 curs giving curs2.\n     display  nl-name at curs2 with foreground-color cob-color-cyan.\n     add      22 to col2.\n     display  \"[  ]\"  at curs2 with foreground-color 2.\n     add      1 to col2.\n     move     def-codes (w) to ws-codes.\n     accept   ws-codes2 at curs2   with update foreground-color cob-color-cyan.\n     move     function upper-case (ws-codes2) to ws-codes.\n     move     ws-codes to def-codes (w).\n     add      32 curs giving curs2.\n     display  \"[\" at curs2 with foreground-color 2.\n     add      1 to col2.\n     display  ws-codes at curs2 with foreground-color cob-color-cyan.\n     add      2 to col2.         *> this looks wrong should only be 1\n     display  \"]\" at curs2 with foreground-color 2.\n*>\n vat-check.\n*>----------\n*>\n     add      38 curs giving curs2.\n     move     def-vat (w) to ws-vat2.\n     accept   ws-vat2 at curs2 with update foreground-color cob-color-cyan.\n     move     function upper-case (ws-vat2) to ws-vat.\n     move     ws-vat to def-vat (w).\n     if       ws-vat not = \"I\"\n                 and not = \"N\"\n                 and not = \"O\"\n              go to vat-check.\n     go       to get-input.\n*>\n end-input.\n*>--------\n*>\n*>  Close A/c file & write out defaults.\n*>\n *>    move     2 to file-function.\n     perform  acasirsub1-Close.\n *>    move     5 to file-function.\n     perform  acasirsub3-Write.\n*>\n main-exit.\n     exit.\n*>\n Set-Up-Finished section.\n*>----------------------\n*>\n*>   Final Accts not used on Open Source version but we can set",
        "line": 120
      },
      {
        "type": "IF",
        "condition": "1st time get an initialised record so no errors.\n*>\n *>    move     3  to  file-function.             *> open & read\n     perform  acasirsub5-Read-Next.\n*>\n     if       we-error not = zero\n              display IR915      at 2301 with foreground-color 4 erase eol\n              display we-error   at 2350 with foreground-color 4 highlight\n              display SY008      at 2401 with foreground-color 2 erase eol\n              accept  menu-reply at 2432\n              go to Set-Up-Finished-Exit\n     end-if\n *>    move     1  to  file-function access-type.      *> open input Nominal\n     perform  acasirsub1-Open-Input.\n*>\n Setup-Fin-Retry.\n     if       PL-App-Created not = \"1\"\n              move zeros to PL-App-Created PL-Approp-AC\n     end-if\n     accept   Finished-Account-Setup-Screen-1.\n     if       PL-Approp-AC not = zero\n              move \"1\" to PL-App-Created\n              move  PL-Approp-AC to nl-owning\n              move  zero to nl-sub-nominal\n *>             move  4 to file-function                      *> Read indexed\n              perform  acasirsub1-Read-Indexed\n              if    we-error = 2\n                    display IR021  at 2401 with foreground-color 4\n                    display IR022  at 2437 with foreground-color 2\n                    accept ws-reply at 2467\n                    go to setup-fin-retry\n              end-if\n     end-if\n*>\n*> open, write out & close file\n*>\n *>    move     5 to file-function.\n     perform  acasirsub5-Write.    *> write and close Final\n *>    move     2 to file-function.                         *> close Nominal\n     perform  acasirsub1-Close.\n*>\n Set-Up-Finished-Exit.\n     exit     section.\n*>\n Show section.\n*>------------\n*>\n     display  Display-Screen-1.\n     display  Setup-Amend-Screen-3.\n     perform  Input-Headings.\n     display  \" \"      at 2301 with erase eol.\n     display  IR023    at 2401 with foreground-color cob-color-white.\n     move     space to ws-reply.\n     accept   ws-reply at 2445.\n*>\n*> now close A/Cs File\n*>\n *>    move     2 to file-function.\n     perform  acasirsub1-Close.\n*>\n main-exit.\n     exit.\n*>\n listing section.\n*>---------------\n*>\n*>   Defaults\n*>\n     display  space at 0101 with erase eos.\n     move     run-date to  p-date.\n     move     client   to  p-client\n                           p-Client-2.\n     move     suser    to  p-user.\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time.\n*>\n*> Open printer & Accounts files\n*>\n     open     output  print-file.\n *>    move     1  to  file-function  access-type.\n     perform  acasirsub1-Open-Input.\n*>\n*>  Print Heads\n*>\n     write    print-record  from  line-1 after 1.\n     write    print-record  from  line-3 after 2.\n     write    print-record  from  line-4 after 2.\n     move     spaces  to  print-record.\n     write    print-record after 2.\n*>\n*>  get record\n*>\n *>    move     3  to  file-function.\n     perform  acasirsub3-Read-Next.\n*>\n*> Now print them\n*>\n     perform  varying w from 1 by 1 until w > 32\n              move  w  to  p-num\n              move  def-acs (w)  to  p-ac\n              move  def-acs (w)  to  nl-owning\n              move  zero  to  nl-sub-nominal\n              if    def-acs (w)  =  zero\n                    move spaces to  p-desc\n                                    p-vat\n                                    p-code\n              else\n *>                   move 4  to  file-function   *>  get code description\n                    perform acasirsub1-Read-Indexed\n                    move nl-name to p-desc\n                    move def-codes (w) to p-code\n                    move def-vat (w)   to p-vat\n              end-if\n              write    print-record from line-5 after 1\n     end-perform\n*>\n*> Done so close files and spool report\n*>\n *>    move     2  to  file-function.        *>  close a/cs file\n     perform  acasirsub1-Close.\n*>\n*>  Now for Finished A/Cs\n*>\n *>    move     3  to  file-function.             *> open & read\n     perform  acasirsub5-Read-Next.\n*>\n     if       ar1-fields = spaces\n              go to Print-Fini.\n*>\n     write    print-record  from  line-1 after page.\n     write    print-record  from  line-6 after 2.\n     move     spaces  to  print-record.\n     if       PL-Approp-AC not = zeros\n              string   \"  P & L Appropriation Account [\"\n                       PL-Approp-AC\n                       \"]\"  into Print-Record\n              end-string\n              write    print-record after 2\n     end-if\n     write    print-record  from  line-7 after 2.\n     write    print-record  from  line-8 after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n*>\n*>  Now spit out the Finished a/c data\n*>\n     move     14 to B.\n     perform  varying A from 1 by 1 until A > 13\n              move ar1 (A) to PAR-1 (1)             *> Desc\n              move ar1 (B) to PAR-1 (2)\n              move ar2 (A) to PAR-2 (1)             *> Sign\n              move ar2 (B) to PAR-2 (2)\n              move WS-Alpha-CD1 (A) to POS-1(1)     *> A/c Type\n              move WS-Alpha-CD1 (B) to POS-1(2)     *> As A - Z\n              write  Print-Record from Line-9 after 1\n              add 1 to B\n     end-perform.\n*>\n Print-Fini.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n list-exit.\n     exit.\n*>\n file-init section.\n*>-----------------\n*>\n*> Remove password controls for O/S versions.\n*>\n*>     display  \"Enter pass-word - [    ]\" at 0551 with foreground-color 2.\n*>     accept   ws-pass at 0570 with update secure.\n*>     if       ws-pass not = pass-word\n*>              move \"Z\" to ws-reply\n*>              go to main-exit.\n     initialize WS-IRS-Default-Record.\n *>    move     5 to file-function.\n     perform  acasirsub3-Write.\n*>\n main-exit.\n     exit.\n*>\n Input-Headings section.\n*>---------------------\n*>\n*> Open & read the defaults\n*>\n *>    move     3  to  file-function.\n     perform  acasirsub3-Read-Next.\n*>\n*>  Test that dflt data exists [11/12/16] - bug finding ?\n*>\n     if       FS-Reply not = zero\n              display IR913 at 2301\n              display FS-Reply at 2349\n              display IR022    at 2401\n              accept  ws-reply at 2430\n              go      to main01-exit in init01\n     end-if.\n     if       WS-IRS-Default-Record = spaces\n              display IR913 at 2301\n              display FS-Reply at 2350         *> 1 poss. more to show this is in use.\n              display IR022    at 2401\n              accept  ws-reply at 2430\n              go      to main01-exit in init01\n     end-if.\n*>\n*> Open N/L file\n*>\n *>    move     1  to  file-function   access-type.\n     perform  acasirsub1-Open-Input.\n*>\n     if       we-error not = zero\n              display IR024 at 2301\n              display IR022 at 2401       with foreground-color cob-color-white\n              move space to ws-reply\n              accept ws-reply at 2430\n              go to main01-exit in init01.\n*>\n*> Now input existing defaults\n*>\n     move     1 to w  cole.   *> curs\n     move     7 to lin.\n     move     1 to File-Key-No.\n*>\n display-existing.\n*>-----------------\n*>\n     display  w at curs with foreground-color cob-color-green.\n     add      4  curs giving curs2.\n     move     def-acs (w) to ws-acs.\n     display  ws-acs at curs2      with foreground-color cob-color-cyan.\n     move     ws-acs to nl-owning.\n     move     zero  to  nl-sub-nominal.\n     if       ws-acs not = zero\n *>             move 4 to file-function\n              perform acasirsub1-Read-Indexed\n              add  10 curs giving curs2\n              display nl-name (1:22) at curs2 with foreground-color cob-color-cyan\n     end-if\n*>\n*> Get code description\n*>\n     add      33  curs giving curs2.\n     move     def-codes (w) to ws-codes.\n     display  ws-codes  at curs2     with foreground-color cob-color-cyan.\n     add      5 to col2.\n     move     def-vat (w) to ws-vat.\n     display  ws-vat  at curs2       with foreground-color cob-color-cyan.\n     add      1 to col2.\n     display  \"]\" at curs2           with foreground-color cob-color-green.\n     add      1  to  w.\n     if       w  >  32\n              go to display-existing-end.\n     if       w  =  17\n              move 41  to  cole\n              move 6   to  lin.\n     add      1  to  lin.\n     go       to display-existing.\n*>\n display-existing-end.\n*>---------------------\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n main-exit.\n     exit.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 868
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 60,
      "totalOperators": 60,
      "totalOperands": 120,
      "vocabulary": 61,
      "length": 180,
      "volume": 1067.5327207613195
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
