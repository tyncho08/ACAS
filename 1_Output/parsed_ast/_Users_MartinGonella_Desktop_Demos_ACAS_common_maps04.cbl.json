{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/maps04.cbl",
  "fileName": "maps04.cbl",
  "timestamp": "2025-09-15T16:25:37.994Z",
  "programId": "maps04",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 84
      },
      {
        "name": "working-storage",
        "line": 89
      },
      {
        "name": "linkage",
        "line": 102
      }
    ],
    "paragraphs": [
      {
        "name": "main",
        "line": 125
      },
      {
        "name": "ws-unpack",
        "line": 184
      },
      {
        "name": "main-exit",
        "line": 193
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "of",
        "line": 74,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 83,
        "replacing": null
      }
    ],
    "performs": []
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "z",
        "line": 134
      },
      {
        "from": "a-cc",
        "to": "td-cc",
        "line": 151
      },
      {
        "from": "a-year",
        "to": "td-yy",
        "line": 152
      },
      {
        "from": "a-month",
        "to": "td-mm",
        "line": 153
      },
      {
        "from": "a-days",
        "to": "td-dd",
        "line": 154
      },
      {
        "from": "\"00/00/0000\"",
        "to": "a-date",
        "line": 187
      },
      {
        "from": "td-ccyy",
        "to": "a-ccyy",
        "line": 189
      },
      {
        "from": "td-mm",
        "to": "a-month",
        "line": 190
      },
      {
        "from": "td-dd",
        "to": "a-days",
        "line": 191
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "conversion is needed instead of just storing\n*>                         as CCYYMMDD.\n*>**\n*>    Version.            1.04 of 03/02/02 21:00.\n*>                        1.11 of 12/03/09.\n*>****\n*>\n*> changes:\n*> 05/02/02 vbc - Converted to year 2k using dd/mm/yyyy.\n*> 29/01/09 vbc - Migration to GNU Cobol & using intrinsic functions\n*>                to do most of the work as v1.10 for MAPS04, to help\n*>                reduce risk of format change problems in old programs.\n*>\n*> 19/10/16 vbc - THIS uses binary dates from 31/12/1600 so is NOT usable\n*>                 within IRS as is, but in any event uses dates with CC\n*>                 e.g., dd/mm/ccyy where as IRS uses dd/mm/yy.\n*>                 but fixable within IRS itself.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment      division.\n*>========================\n*>\n copy  \"envdiv.cob\".\n input-output     section.\n*>-----------------------\n*>\n data             division.\n*>========================\n working-storage  section.\n*>-----------------------\n*>\n 01  date-fields.\n     03  z                  pic 99 binary.\n     03  test-date.\n         05  td-ccyy.\n             07  td-cc      pic 99.\n             07  td-yy      pic 99.\n         05  td-mm          pic 99.\n         05  td-dd          pic 99.\n     03  test-date9 redefines test-date pic 9(8).\n*>\n linkage          section.\n*>-----------------------\n*>\n*>*********\n*> maps04 *\n*>*********\n*>\n 01  mapa03-ws.\n     03  a-date             pic x(10).\n     03  filler  redefines  a-date.\n       05  a-days           pic 99.\n       05  filler           pic x.\n       05  a-month          pic 99.\n       05  filler           pic x.\n       05  a-ccyy           pic 9(4).\n       05  filler redefines a-ccyy.\n           07  a-cc         pic 99.\n           07  a-year       pic 99.\n     03  a-bin              binary-long.\n*>\n procedure        division using  mapa03-ws.\n*>=========================================\n*>\n main.\n*>---\n*>\n*> if dd/mm/ccyy is bad a-bin = zero,\n*>   if entry a-bin not zero",
        "line": 26
      },
      {
        "type": "IF",
        "condition": "a-bin  >  zero\n              go to  ws-unpack.\n*>\n     move     zero    to  z.\n     inspect  a-date replacing all \".\" by \"/\".\n     inspect  a-date replacing all \",\" by \"/\".\n     inspect  a-date replacing all \"-\" by \"/\".\n     inspect  a-date tallying z for all \"/\".\n*>\n*>  Very basic testing here as function test-date checks for\n*>           February and leap years\n*>\n     if       z not = 2 or\n              a-days not numeric or\n              a-month not numeric or\n              a-cc   not numeric or\n              a-days < 01 or > 31 or\n              a-month < 01 or > 12\n              go to main-exit.\n*>\n     move     a-cc    to td-cc.\n     move     a-year  to td-yy.\n     move     a-month to td-mm.\n     move     a-days  to td-dd.\n*>\n     if       function test-date-yyyymmdd (test-date9) not = zero\n              go to main-exit.\n*>\n*>********************************************\n*>       Date Validation & Conversion        *\n*>       ============================        *\n*>                                           *\n*>  Requires date input in a-date as         *\n*>  dd.mm.yy or dd.mm.ccyy & returns date as *\n*>      ccyymmdd in  a-bin                   *\n*>  Date errors returned as a-bin equal zero *\n*>                                           *\n*>********************************************\n*>\n     move     function integer-of-date (test-date9) to a-bin.\n     go       to main-exit.\n*>\n*>\n*>*************************************\n*>   Binary Date Conversion Routine   *\n*>   ==============================   *\n*>                                    *\n*>  Requires ccyymmdd input in a-bin  *\n*>  &  returns date  in a-date        *\n*>  This way dates can be compared    *\n*>    as is                           *\n*>*************************************\n*>\n ws-unpack.\n*>========\n*>\n     move     \"00/00/0000\" to a-date.\n     move     function date-of-integer (a-bin) to test-date.  *> ccyymmdd\n     move     td-ccyy to a-ccyy.\n     move     td-mm   to a-month.\n     move     td-dd   to a-days.          *> Now UK date\n*>\n main-exit.\n     exit     program.",
        "line": 131
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 2,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 14,
      "totalOperators": 9,
      "totalOperands": 18,
      "vocabulary": 15,
      "length": 27,
      "volume": 105.48604608143
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
