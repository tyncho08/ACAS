{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs040.cbl",
  "fileName": "irs040.cbl",
  "timestamp": "2025-09-15T16:25:49.028Z",
  "programId": "irs040",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 128
      },
      {
        "name": "file",
        "line": 135
      },
      {
        "name": "working-storage",
        "line": 141
      },
      {
        "name": "linkage",
        "line": 253
      },
      {
        "name": "init01",
        "line": 296
      },
      {
        "name": "headings",
        "line": 654
      },
      {
        "name": "get-record",
        "line": 671
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 129
      },
      {
        "name": "File-Defs",
        "line": 293
      },
      {
        "name": "run-loop",
        "line": 321
      },
      {
        "name": "ask-zero-bal",
        "line": 346
      },
      {
        "name": "output-select",
        "line": 355
      },
      {
        "name": "display-tb",
        "line": 377
      },
      {
        "name": "disp-head-1",
        "line": 383
      },
      {
        "name": "disp-head-end",
        "line": 394
      },
      {
        "name": "main-loop",
        "line": 399
      },
      {
        "name": "its-not-summary",
        "line": 461
      },
      {
        "name": "main-display-1",
        "line": 485
      },
      {
        "name": "screen-clear",
        "line": 502
      },
      {
        "name": "total-display",
        "line": 509
      },
      {
        "name": "print-tb",
        "line": 525
      },
      {
        "name": "print-tb-1",
        "line": 530
      },
      {
        "name": "main-loop-p",
        "line": 538
      },
      {
        "name": "p-its-not-summary",
        "line": 600
      },
      {
        "name": "main-print-1",
        "line": 622
      },
      {
        "name": "main-end",
        "line": 632
      },
      {
        "name": "print-tb-exit",
        "line": 648
      },
      {
        "name": "exit",
        "line": 649
      },
      {
        "name": "main01-exit",
        "line": 651
      },
      {
        "name": "main-exit",
        "line": 668
      },
      {
        "name": "exit",
        "line": 669
      },
      {
        "name": "main-exit",
        "line": 675
      },
      {
        "name": "exit",
        "line": 676
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 69,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "SYSTEM",
        "line": 644,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 117,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 126,
        "replacing": null
      },
      {
        "name": "irsprint-spool-command-p",
        "line": 144,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 188,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 189,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 198,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 256,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 259,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 289,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 678,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 70
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 379
      },
      {
        "target": "get-record",
        "thru": null,
        "line": 402
      },
      {
        "target": "if",
        "thru": null,
        "line": 415
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 417
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 420
      },
      {
        "target": "move",
        "thru": null,
        "line": 441
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 499
      },
      {
        "target": "disp-head-1",
        "thru": null,
        "line": 506
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 522
      },
      {
        "target": "print-tb-1",
        "thru": "print-tb-exit",
        "line": 527
      },
      {
        "target": "headings",
        "thru": null,
        "line": 534
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 536
      },
      {
        "target": "get-record",
        "thru": null,
        "line": 541
      },
      {
        "target": "if",
        "thru": null,
        "line": 554
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 556
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 559
      },
      {
        "target": "move",
        "thru": null,
        "line": 580
      },
      {
        "target": "headings",
        "thru": null,
        "line": 626
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 646
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 673
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-accept-lines",
        "line": 303
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 313
      },
      {
        "from": "hd-hh",
        "to": "hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time",
        "line": 317
      },
      {
        "from": "zero",
        "to": "total-dr  total-cr ws-sub-not",
        "line": 324
      },
      {
        "from": "spaces",
        "to": "output-reply2",
        "line": 334
      },
      {
        "from": "\"Summary\"",
        "to": "p-report\n     else\n              move  \"Detail \" to p-report",
        "line": 342
      },
      {
        "from": "spaces",
        "to": "output-reply2",
        "line": 347
      },
      {
        "from": "spaces",
        "to": "output-reply2",
        "line": 356
      },
      {
        "from": "suser",
        "to": "p-user",
        "line": 361
      },
      {
        "from": "client",
        "to": "p-client",
        "line": 362
      },
      {
        "from": "start-date",
        "to": "p-start",
        "line": 363
      },
      {
        "from": "end-date",
        "to": "p-end",
        "line": 364
      },
      {
        "from": "run-date",
        "to": "p-date",
        "line": 365
      },
      {
        "from": "zero",
        "to": "main-cr main-dr main-ac ws-sub-not",
        "line": 366
      },
      {
        "from": "spaces",
        "to": "main-name",
        "line": 367
      },
      {
        "from": "1",
        "to": "file-function access-type",
        "line": 378
      },
      {
        "from": "zero",
        "to": "total-cr total-dr counter",
        "line": 380
      },
      {
        "from": "1",
        "to": "p-page",
        "line": 381
      },
      {
        "from": "6",
        "to": "lin",
        "line": 395
      },
      {
        "from": "zero",
        "to": "flag",
        "line": 396
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 403
      },
      {
        "from": "zero",
        "to": "nl-owning nl-cr nl-dr\n     end-if\n     if       we-error = 3\n         and  not summary\n              go to total-display",
        "line": 405
      },
      {
        "from": "work-dr",
        "to": "p-debit\n                         move zero to p-credit work-cr\n                         add  work-dr  to  total-dr\n                   else\n                         subtract main-dr from main-cr giving work-cr\n                         move work-cr to p-credit\n                         move zero to p-debit work-dr\n                         add  work-cr  to  total-cr\n                   end-if\n                   move  \"Main\" to p-legend\n                   move  main-ac        to p-account\n                   move  main-name      to p-name\n                   move  nl-owning to main-ac\n                   move  nl-name   to main-name\n                   move  nl-dr     to main-dr\n                   move  nl-cr     to main-cr\n                   go to main-display-1\n              end-perform\n              move nl-owning to main-ac\n              move nl-dr     to main-dr\n              move nl-cr     to main-cr\n              move nl-name   to main-name\n              go to main-loop\n     end-if\n*>\n     if       nl-sub-nominal not = zero\n         and  nl-owning = main-ac\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              go to main-loop",
        "line": 424
      },
      {
        "from": "work-dr",
        "to": "p-debit\n              move zero to p-credit work-cr\n              add  work-dr  to  total-dr\n     else\n              subtract nl-dr from nl-cr giving work-cr\n              move work-cr to p-credit\n              move zero to p-debit work-dr\n              add  work-cr  to  total-cr\n     end-if\n     if       nl-sub-nominal = zero\n              move \"Main\" to p-legend\n              move nl-owning to p-account\n     else\n              move \"Sub\"  to p-legend\n              move nl-sub-nominal to p-account\n     end-if\n     move     nl-name to p-name",
        "line": 467
      },
      {
        "from": "1",
        "to": "cole",
        "line": 486
      },
      {
        "from": "zero",
        "to": "nl-dr nl-cr sub-dr sub-cr",
        "line": 488
      },
      {
        "from": "6",
        "to": "lin",
        "line": 494
      },
      {
        "from": "2",
        "to": "file-function\n              perform  acasirsub1-Close\n              go to  run-loop",
        "line": 498
      },
      {
        "from": "spaces",
        "to": "ws-reply",
        "line": 503
      },
      {
        "from": "counter",
        "to": "p-page",
        "line": 505
      },
      {
        "from": "total-dr",
        "to": "t-debit",
        "line": 511
      },
      {
        "from": "total-cr",
        "to": "t-credit",
        "line": 512
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 521
      },
      {
        "from": "zero",
        "to": "total-cr total-dr",
        "line": 531
      },
      {
        "from": "zero",
        "to": "flag  counter  rstats",
        "line": 533
      },
      {
        "from": "1",
        "to": "file-function access-type",
        "line": 535
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 542
      },
      {
        "from": "zero",
        "to": "nl-owning nl-cr nl-dr\n     end-if\n     if       we-error = 3\n         and  not summary\n              go to main-end\n     end-if\n     if       not summary\n              go to p-its-not-summary",
        "line": 544
      },
      {
        "from": "work-dr",
        "to": "p-debit\n                         move zero to p-credit work-cr\n                         add  work-dr  to  total-dr\n                   else\n                         subtract main-dr from main-cr giving work-cr\n                         move work-cr to p-credit\n                         move zero to p-debit work-dr\n                         add  work-cr  to  total-cr\n                   end-if\n                   move  \"Main\" to p-legend\n                   move  main-ac        to p-account\n                   move  main-name      to p-name\n                   move  nl-owning to main-ac\n                   move  nl-name   to main-name\n                   move  nl-dr     to main-dr\n                   move  nl-cr     to main-cr\n                   go to main-print-1\n              end-perform\n              move nl-owning to main-ac\n              move nl-dr     to main-dr\n              move nl-cr     to main-cr\n              move nl-name   to main-name\n              go to main-loop-p\n     end-if\n*>\n     if       nl-sub-nominal not = zero\n         and  nl-owning = main-ac\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              go to main-loop-p",
        "line": 563
      },
      {
        "from": "work-dr",
        "to": "p-debit\n              move  zero to p-credit work-cr\n              add   work-dr  to  total-dr\n     else\n              subtract  nl-dr from nl-cr giving work-cr\n              move  work-cr to p-credit\n              move  zero to p-debit work-dr\n              add   work-cr  to  total-cr",
        "line": 606
      },
      {
        "from": "\"Main\"",
        "to": "p-legend\n              move  nl-owning to p-account\n     else\n              move  \"Sub\"  to p-legend\n              move  nl-sub-nominal to p-account",
        "line": 615
      },
      {
        "from": "nl-name",
        "to": "p-name",
        "line": 620
      },
      {
        "from": "zero",
        "to": "nl-dr nl-cr sub-dr sub-cr",
        "line": 627
      },
      {
        "from": "total-dr",
        "to": "t-debit",
        "line": 634
      },
      {
        "from": "total-cr",
        "to": "t-credit",
        "line": 635
      },
      {
        "from": "ws-sub-not",
        "to": "l7-errcnt\n     else\n              move zero to l7-errcnt\n     end-if\n     write    print-record from line-7 after 1",
        "line": 637
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 645
      },
      {
        "from": "counter",
        "to": "p-page",
        "line": 656
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 664
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 666
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 672
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "a count appears on the total print line at far left it\n*>                means there is a logic errror. also shows for display to\n*>                right of 'hit return for menu' <<<\n*> 21/09/10 vbc - Added print spool.\n*>                .12 fix for portrait printing\n*> 02/12/16 vbc - 3.02\n*>                .13 Added RDB support using acas000, acasirsub1.\n*>                    RDB support via acasirsub(1-5) & DALs and using\n*>                    standard ACAS param file (system.dat) for info pickup\n*>                    passed to IRS-System-Params (renamed from system-record).\n*>                    Replaced all occurances of call \"irsubn\" by\n*>                     perform acasirsubn\n*>                    File-Defs  added to all irsnnn calls as 2nd param.\n*>                    Clean up all msgs to use Pre-Defined ones system/module\n*>                    wide across entire IRS system in compliance with all of\n*>                    ACAS.\n*> 20/12/16 vbc -     All irs progs call cpybk Proc-ZZ100-ACAS-IRS-Calls.\n*> 29/12/16 vbc - .14 Change performs to acasirsub1 to by para names - makes\n*>                    it easier to see what the function is\n*>                    (open, close, read-next).\n*> 29/01/18 vbc - .15 Changed copies to use copybooks where poss. E.g.,\n*>                    renamed print-spool-commandxxx & wsnl to irsprint-spool-command\n*>                    & irswsnl as moved to copybooks dir.\n*> 10/02/18 vbc - .16 Renamed IR011-16 to IR911-16 and others.\n*> 01/05/18 vbc - .17 Change reporting to honour request to ignore zero balance\n*>                    accounts same as for displays.\n*> 02/05/18 vbc - .18 Added Time to report (in Listing) & do this for most of the\n*>                    reports in IRS as it is hard to work out the latest reports.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n*>*******************\n*>\n copy  \"envdiv.cob\".\n*>\n input-output section.\n file-control.\n*>\n     select  print-file     assign \"prt-1\"\n                            organization line sequential.\n*>\n data division.\n file section.\n*>\n fd  print-file.\n*>\n 01  print-record        pic x(80).\n*>\n working-storage section.\n*>\n 77  prog-name           pic x(16)  value \"irs040 (3.02.18)\".\n copy \"irsprint-spool-command-p.cob\".\n 01  filler.\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-show-lines   binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-accept-lines binary-char unsigned value zero.\n*>\n     03  output-reply    pic x.\n     03  output-reply2   pic x.\n     03  ws-reply        pic x.\n     03  tipe            pic x          value \"D\".\n         88  summary          value  \"S\".\n         88  detaile          value  \"D\".\n     03  empty           PIC X          value space.\n         88  do-print         value  \"Y\".\n         88  nodo-print       value  \"N\".\n     03  counter         pic 99         value zero.\n     03  total-dr        pic s9(7)v99   value zero.\n     03  total-cr        pic s9(7)v99   value zero.\n     03  sub-dr          pic s9(7)v99   value zero.\n     03  sub-cr          pic s9(7)v99   value zero.\n     03  work-dr         pic s9(7)v99   value zero.\n     03  work-cr         pic s9(7)v99   value zero.\n     03  main-cr         pic s9(7)v99 comp value zero.\n     03  main-dr         pic s9(7)v99 comp value zero.\n     03  main-ac         pic 9(5)       value zero.\n     03  main-name       pic x(24)      value space.\n     03  ws-sub-not      pic 9(4)       value zero.\n     03  rstats          pic 9          value zero.\n     03  flag            pic 9          value zero.\n     03  line-cnt        pic 99   comp  value 99.\n*>\n     03  hdtime                          value spaces.\n         05  hd-hh       pic xx.\n         05  hd-mm       pic xx.\n         05  hd-ss       pic xx.\n         05  hd-uu       pic xx.\n     03  HD2-Time.\n         05  filler      pic x     value spaces.\n         05  hd2-hh      pic xx.\n         05  filler      pic x     value \":\".\n         05  hd2-mm      pic xx.\n*>\n copy \"irswsnl.cob\"   replacing NL-Record by WS-IRSNL-Record.\n copy \"wsfnctn.cob\".\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n *>    03  WS-IRSNL-Record       pic x.   *> acasirsub1 in use.\n     03  WS-IRS-Default-Record pic x.     *> acasirsub3 not in use.\n     03  Posting-Record        pic x.     *> acasirsub4 not in use.\n     03  WS-IRS-Posting-Record pic x.     *> acas008    not in use.\n     03  Final-Record          pic x.     *> Table/File  not used in this program.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  filler.\n     03  line-1.\n       05  p-user        pic x(24).\n       05  filler        pic x(5)     value spaces.\n       05  p-report      pic x(8).\n       05  l1-a          pic x(13)    value \"Trial Balance\".\n       05  filler        pic x(5)     value spaces.\n       05  p-date        pic x(8).\n       05  P-Time        pic x(6)     value spaces.\n       05  filler        pic xx       value spaces.\n       05  l1-b          pic x(5)     value \"Page \".\n       05  p-page        pic zz9.\n     03  line-3.\n       05  p-client      pic x(24).\n       05  l3-a          pic x(17)    value \"    Start Date - \".\n       05  p-start       pic x(8).\n       05  l3-b          pic x(22)    value \"           End Date - \".\n       05  p-end         pic x(8).\n     03  line-4.\n       05  l4-a          pic x(37)    value \" Account     ----------Name----------\".\n       05  filler        pic x(19)    value \"   Type\".\n       05  l4-b          pic x(24)    value \"   --Debit--   --Credit-\".\n     03  line-5.\n       05  p-account     pic bzzzz9  blank when zero.\n       05  filler        pic x(6)     value spaces.\n       05  p-name        pic x(24).\n       05  filler        pic x(4)     value spaces.\n       05  p-legend      pic x(16).\n       05  p-debit       pic z(8)9.99 blank when zero.\n       05  p-credit      pic z(8)9.99 blank when zero.\n     03  line-6.\n       05  filler        pic x(57)    value spaces.\n       05  l6-a          pic x(23)    value \"=========== ===========\".\n     03  line-7.\n       05  filler.\n           07  l7-errcnt pic zzzz   blank when zero.\n           07  filler    pic x(37)    value spaces.\n       05  l7-a          pic x(15)    value \"T o t a l      \".\n       05  t-debit       pic z(8)9.99.\n       05  t-credit      pic z(8)9.99.\n*>\n 01  Error-Messages.\n*> System Wide      USED are :\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR914          pic x(51) value \"IR914 Error on irspostingMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific  USED are :\n     03  IR040          pic x(42) value \"IR040 End of listing. Hit return for Menu.\".\n*>\n linkage section.\n*>---------------\n*>\n copy \"irswssystem.cob\"  *> IRS param record\n              replacing system-record  by IRS-System-Params. *> (01 level)\n*>\n copy \"wssystem.cob\"    *> NEW for v3.02\n             replacing  System-Record by WS-System-Record\n                        Run-Date   by ACAS-Run-Date     *> these 3 are in binary\n                        Start-Date by ACAS-Start-Date   *> IRS expects as x(8)\n                        End-Date   by ACAS-End-Date     *>  dd/mm/yy\n                        suser      by ACAS-suser\n                        Address-1  by ACAS-Address-1\n                        Address-2  by ACAS-Address-2\n                        Address-3  by ACAS-Address-3\n                        Address-4  by ACAS-Address-4\n                        Post-Code  by ACAS-Post-Code\n                        Print-Spool-Name by ACAS-Print-Spool-Name\n                        Pass-Value by ACAS-Pass-Value\n                        Pass-Word  by ACAS-Pass-Word\n                        OP-System  By ACAS-Op-System\n                        Client     by IRS-Client\n                        System-Ops by IRS-System-Ops\n                        Next-Post  by IRS-Next-Post\n                        Vat-Rates2 by IRS-Vat-Rates2\n                        Vat1       by IRS-Vat1\n                        Vat2       by IRS-Vat2\n                        Vat3       by IRS-Vat3\n                        Vat-Group  by IRS-Vat-Group\n                        Vat-Psent  by IRS-Vat-Psent\n                        Save-Sequ  by IRS-Save-Sequ\n                        System-Work-Group by IRS-System-Work-Group\n                        PL-App-Created by IRS-PL-App-Created\n                        PL-Approp-AC   by IRS-PL-Approp-AC\n                        1st-Time-Flag  by IRS-First-Time-Flag.\n*>\n copy \"wsnames.cob\".\n*>\n procedure division using IRS-System-Params\n                          WS-System-Record\n                          File-Defs.\n*>*****************************************\n*>\n init01 section.\n*>**************\n*>\n*> first get date & user information..\n*>\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-accept-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-show-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time.\n*>\n run-loop.\n*>--------\n*>\n     move     zero  to  total-dr  total-cr ws-sub-not.\n     display  prog-name       at 0101 with erase eos foreground-color 2.\n     display  \"Trial Balance\" at 0131 with foreground-color 1 background-color 7.\n     display  run-date        at 0173 with foreground-color 2.\n*>\n     display  \"Summary or Detail <S> or <D>......[ ]\" AT 0501 with foreground-color 2.\n     display  \"Zero balances to Print (Y/N)......[ ]\" at 0701 with foreground-color 2.\n     display  \"Press <Return> to exit\"                at 0741 with foreground-color 2.\n     display  \"Display or Print  <D> or <P>......[ ]\" at 0901 with foreground-color 2.\n*>\n     move     spaces to output-reply2.\n     accept   output-reply2  at 0536 with auto.\n     move     function upper-case (output-reply2) to tipe.\n     if       tipe = space\n              go to main01-exit.\n     if       not summary and not detaile\n              go to run-loop.\n     if       summary\n              move  \"Summary\" to p-report\n     else\n              move  \"Detail \" to p-report.\n*>\n ask-zero-bal.\n     move     spaces to output-reply2.\n     accept   output-reply2 at 0736 with auto.\n     move     function upper-case (output-reply2) to empty.\n     if       empty = space\n              go to main01-exit.\n     if       not do-print and not nodo-print\n              go to ask-zero-bal.\n*>\n output-select.\n     move     spaces to output-reply2.\n     accept   output-reply2 at 0936 with auto.\n     move     function upper-case (output-reply2) to output-reply.\n     if       output-reply not = \"D\" and not = \"P\"\n              go to  output-select.\n     move     suser      to p-user.\n     move     client     to p-client.\n     move     start-date to p-start.\n     move     end-date   to p-end.\n     move     run-date   to p-date.\n     move     zero       to main-cr main-dr main-ac ws-sub-not.\n     move     spaces     to main-name.\n     if       output-reply = \"D\"\n              go to  display-tb.\n     if       output-reply = \"P\"\n              go to  print-tb.\n*>\n*>------------------------------------------------------\n*>                      Procedures\n*>------------------------------------------------------\n*>\n display-tb.\n *>    move     1  to  file-function access-type.\n     perform  acasirsub1-Open-Input.\n     move     zero to total-cr total-dr counter.\n     move     1 to p-page.\n*>\n disp-head-1.\n     display  line-1         at 0101 with foreground-color 2 erase eos.\n     display  p-report       at 0130 with foreground-color 1 background-color 7.\n     display  l1-a           at 0138 with foreground-color 1 background-color 7.\n     display  line-3         at 0301 with foreground-color 3.\n     display  \"Start Date -\" at 0329 with foreground-color 2.\n     display  \"End Date -\"   at 0361 with foreground-color 2.\n     display  line-4         at 0501 with foreground-color 2.\n     display  \"Enter <N> for next screen <X> to exit....[ ]\"\n                                at line ws-lines col 01 with foreground-color 2.\n*>\n disp-head-end.\n     move     6 to lin.\n     move     zero to flag.\n     add      1 to counter.\n*>\n main-loop.\n     if       we-error = 3\n              go to total-display.\n     perform  get-record.\n     move     spaces to line-5.\n     if       we-error = 3\n              move zero to nl-owning nl-cr nl-dr\n     end-if\n     if       we-error = 3\n         and  not summary\n              go to total-display.\n*>\n     if       not summary\n              go to its-not-summary.\n*>\n     if       nl-sub-nominal = zero       *> we have a main a/c\n              perform\n                   if    main-ac = zero   *> only for 1st nl record\n                         exit perform\n                   end-if\n                   if    main-dr = main-cr and not do-print\n                         exit perform\n                   end-if\n                   if    main-dr > main-cr\n                         subtract main-cr from main-dr giving work-dr\n                         move work-dr to p-debit\n                         move zero to p-credit work-cr\n                         add  work-dr  to  total-dr\n                   else\n                         subtract main-dr from main-cr giving work-cr\n                         move work-cr to p-credit\n                         move zero to p-debit work-dr\n                         add  work-cr  to  total-cr\n                   end-if\n                   move  \"Main\" to p-legend\n                   move  main-ac        to p-account\n                   move  main-name      to p-name\n                   move  nl-owning to main-ac\n                   move  nl-name   to main-name\n                   move  nl-dr     to main-dr\n                   move  nl-cr     to main-cr\n                   go to main-display-1\n              end-perform\n              move nl-owning to main-ac\n              move nl-dr     to main-dr\n              move nl-cr     to main-cr\n              move nl-name   to main-name\n              go to main-loop\n     end-if\n*>\n     if       nl-sub-nominal not = zero\n         and  nl-owning = main-ac\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              go to main-loop.\n*>\n     if       nl-sub-nominal not = zero\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              add 1 to ws-sub-not\n              go to main-loop.\n*>\n its-not-summary.\n     if       nl-dr = nl-cr and not do-print\n              go to main-loop.\n*>\n     if       nl-dr > nl-cr\n              subtract  nl-cr from nl-dr giving work-dr\n              move work-dr to p-debit\n              move zero to p-credit work-cr\n              add  work-dr  to  total-dr\n     else\n              subtract nl-dr from nl-cr giving work-cr\n              move work-cr to p-credit\n              move zero to p-debit work-dr\n              add  work-cr  to  total-cr\n     end-if\n     if       nl-sub-nominal = zero\n              move \"Main\" to p-legend\n              move nl-owning to p-account\n     else\n              move \"Sub\"  to p-legend\n              move nl-sub-nominal to p-account\n     end-if\n     move     nl-name to p-name.\n*>\n main-display-1.\n     move     1 to cole.\n     display  line-5 at curs with foreground-color 3.\n     move     zero  to  nl-dr nl-cr sub-dr sub-cr.\n     if       we-error = 3\n              go to  total-display.\n     add      1  to  lin.\n     if       lin  < ws-show-lines\n              go to  main-loop.\n     move     6  to  lin.\n     accept   output-reply2 at line ws-lines col 43 with auto.\n     move     function upper-case (output-reply2) to ws-reply.\n     if       ws-reply = \"X\"\n *>             move 2  to  file-function\n              perform  acasirsub1-Close\n              go to  run-loop.\n*>\n screen-clear.\n     move     spaces to ws-reply.\n     add      1 to counter.\n     move     counter to p-page.\n     perform  disp-head-1.\n     go to    main-loop.\n*>\n total-display.\n     display  line-6 at line ws-show-lines col 01 with foreground-color 2.\n     move     total-dr to t-debit.\n     move     total-cr to t-credit.\n     display  line-7 at line ws-22-lines col 01 with foreground-color 3.\n     display  line-6 at line ws-accept-lines col 01 with foreground-color 2.\n     display  \" \" at line ws-lines col 01 with erase eol.\n *>    display  \"Press Return for menu\" at line ws-lines col 01 with foreground-color 2.\n     display  IR040 at line ws-lines col 01 with foreground-color 2.\n     if       ws-sub-not not = zero                        *> was disp col 26\n              display ws-sub-not at line ws-lines col 46 with foreground-color 3 highlight.\n     accept   ws-reply at line ws-lines col 44.     *> was 23\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n     go to    run-loop.\n*>\n print-tb.\n     display  space at 0101 with erase eos.\n     perform  print-tb-1 thru print-tb-exit.\n     go to    run-loop.\n*>\n print-tb-1.\n     move     zero to total-cr total-dr.\n     open     output  print-file.\n     move     zero  to  flag  counter  rstats.\n     perform  headings.\n *>    move     1  to  file-function access-type.\n     perform  acasirsub1-Open-Input.\n*>\n main-loop-p.\n     if       we-error = 3\n              go to main-end.\n     perform  get-record.\n     move     spaces to line-5.\n     if       we-error = 3\n              move zero to nl-owning nl-cr nl-dr\n     end-if\n     if       we-error = 3\n         and  not summary\n              go to main-end\n     end-if\n     if       not summary\n              go to p-its-not-summary.\n*>\n     if       nl-sub-nominal = zero        *> we hame a main a/c\n              perform\n                   if    main-ac = zero    *> only for 1st nl record\n                         exit perform\n                   end-if\n                   if    main-dr = main-cr and not do-print\n                         exit perform\n                   end-if\n                   if    main-dr > main-cr\n                         subtract main-cr from main-dr giving work-dr\n                         move work-dr to p-debit\n                         move zero to p-credit work-cr\n                         add  work-dr  to  total-dr\n                   else\n                         subtract main-dr from main-cr giving work-cr\n                         move work-cr to p-credit\n                         move zero to p-debit work-dr\n                         add  work-cr  to  total-cr\n                   end-if\n                   move  \"Main\" to p-legend\n                   move  main-ac        to p-account\n                   move  main-name      to p-name\n                   move  nl-owning to main-ac\n                   move  nl-name   to main-name\n                   move  nl-dr     to main-dr\n                   move  nl-cr     to main-cr\n                   go to main-print-1\n              end-perform\n              move nl-owning to main-ac\n              move nl-dr     to main-dr\n              move nl-cr     to main-cr\n              move nl-name   to main-name\n              go to main-loop-p\n     end-if\n*>\n     if       nl-sub-nominal not = zero\n         and  nl-owning = main-ac\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              go to main-loop-p.\n*>\n     if       nl-sub-nominal not = zero         *> this should not used\n              add nl-dr to main-dr\n              add nl-cr to main-cr\n              add 1 to ws-sub-not               *> but just in case count usage but dont print\n              go to main-loop-p.\n*>\n p-its-not-summary.\n     if       nl-dr = nl-cr and not do-print\n              go to main-loop-p.\n*>\n     if       nl-dr  >  nl-cr\n              subtract  nl-cr from nl-dr giving work-dr\n              move  work-dr to p-debit\n              move  zero to p-credit work-cr\n              add   work-dr  to  total-dr\n     else\n              subtract  nl-dr from nl-cr giving work-cr\n              move  work-cr to p-credit\n              move  zero to p-debit work-dr\n              add   work-cr  to  total-cr.\n     if       nl-sub-nominal = zero\n              move  \"Main\" to p-legend\n              move  nl-owning to p-account\n     else\n              move  \"Sub\"  to p-legend\n              move  nl-sub-nominal to p-account.\n     move     nl-name to p-name.\n*>\n main-print-1.\n     write    print-record from line-5 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > 75\n              perform  headings.\n     move     zero  to  nl-dr nl-cr sub-dr sub-cr.\n     if       we-error = 3\n              go to  main-end.\n     go to    main-loop-p.\n*>\n main-end.\n     write    print-record from line-6 after 3.\n     move     total-dr  to  t-debit.\n     move     total-cr  to  t-credit.\n     if       ws-sub-not not = zero           *> count for a logic error if none zero\n              move ws-sub-not to l7-errcnt\n     else\n              move zero to l7-errcnt\n     end-if\n     write    print-record from line-7 after 1.\n     write    print-record from line-6 after 1.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n*>\n print-tb-exit.\n     exit.\n*>\n main01-exit.\n     exit     program.\n*>\n headings section.\n     add      1  to  counter.\n     move     counter to p-page.\n     if       counter = 1\n              write print-record from line-1 after 1\n     else\n              write print-record from line-1 after page\n     end-if\n     write    print-record from line-3 after 2.\n     write    print-record from line-4 after 2.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     6 to line-cnt.\n*>\n main-exit.\n     exit.\n*>\n get-record section.\n *>    move     3  to  file-function.\n     perform  acasirsub1-Read-Next.\n*>\n main-exit.\n     exit.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 59
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 4,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 61,
      "totalOperators": 51,
      "totalOperands": 102,
      "vocabulary": 62,
      "length": 153,
      "volume": 910.9920354891918
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
