{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl025.cbl",
  "fileName": "pl025.cbl",
  "timestamp": "2025-09-15T16:25:47.455Z",
  "programId": "pl025",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 91
      },
      {
        "name": "file",
        "line": 104
      },
      {
        "name": "working-storage",
        "line": 110
      },
      {
        "name": "linkage",
        "line": 180
      },
      {
        "name": "screen",
        "line": 189
      },
      {
        "name": "init01",
        "line": 267
      },
      {
        "name": "setup-suppliers",
        "line": 292
      },
      {
        "name": "oddsnsods",
        "line": 367
      },
      {
        "name": "test-escape",
        "line": 373
      },
      {
        "name": "supplier-data",
        "line": 389
      },
      {
        "name": "validate-address",
        "line": 411
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 95
      },
      {
        "name": "file-defs",
        "line": 265
      },
      {
        "name": "menu-end",
        "line": 289
      },
      {
        "name": "supplier-accept",
        "line": 300
      },
      {
        "name": "supplier-details",
        "line": 330
      },
      {
        "name": "get-details",
        "line": 339
      },
      {
        "name": "main-output",
        "line": 347
      },
      {
        "name": "maps09",
        "line": 370
      },
      {
        "name": "get-escape",
        "line": 378
      },
      {
        "name": "Supplier-Data-Main",
        "line": 392
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps09",
        "line": 371,
        "type": "DYNAMIC",
        "using": [
          "customer-code"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 81,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 90,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 98,
        "replacing": null
      },
      {
        "name": "seldel",
        "line": 99,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 107,
        "replacing": null
      },
      {
        "name": "fddel",
        "line": 108,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 113,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 114,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 118,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 119,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 169,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 176,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 183,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 184,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 185,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 430,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 281
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 282
      },
      {
        "target": "setup-suppliers",
        "thru": null,
        "line": 285
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 286
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 287
      },
      {
        "target": "maps09",
        "thru": null,
        "line": 312
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 321
      },
      {
        "target": "supplier-data",
        "thru": null,
        "line": 342
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 345
      },
      {
        "target": "Purch-Write",
        "thru": null,
        "line": 355
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 362
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 396
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 274
      },
      {
        "from": "spaces",
        "to": "customer-nos",
        "line": 295
      },
      {
        "from": "spaces",
        "to": "a01-Notes-1  a01-Notes-2 d24-03",
        "line": 296
      },
      {
        "from": "\"]\"",
        "to": "d24-02",
        "line": 297
      },
      {
        "from": "\"C\"",
        "to": "maps09-reply",
        "line": 311
      },
      {
        "from": "\"]\"",
        "to": "d24-03",
        "line": 319
      },
      {
        "from": "customer-code",
        "to": "WS-Purch-Key",
        "line": 320
      },
      {
        "from": "run-date",
        "to": "purch-create-date",
        "line": 334
      },
      {
        "from": "1",
        "to": "purch-status",
        "line": 335
      },
      {
        "from": "customer-code",
        "to": "WS-Purch-Key",
        "line": 336
      },
      {
        "from": "age-to-pay",
        "to": "purch-credit",
        "line": 337
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 344
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type\n              move   WS-Purch-Key to Deliv-Purchase-Key\n              move   spaces    to Deliv-Name\n              move   A01-Notes to Deliv-Address\n              perform Delivery-Write",
        "line": 358
      },
      {
        "from": "purch-address",
        "to": "test-address",
        "line": 395
      },
      {
        "from": "zero",
        "to": "Purch-Notes-Tag\n     else\n              move 1    to Purch-Notes-Tag",
        "line": 405
      },
      {
        "from": "zero",
        "to": "a",
        "line": 414
      },
      {
        "from": "zero",
        "to": "truth\n     else\n              move  1  to  truth",
        "line": 418
      },
      {
        "from": "zero",
        "to": "a",
        "line": 422
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 426
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selpl.cob\".\n*> copy \"seldel.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpl.cob\".\n*> copy \"fddel.cob\".\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"PL025 (3.02.08)\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps09.cob\".\n*>\n*> EX FDs\n*>\n copy \"wspl.cob\".\n copy \"wsdel.cob\".\n*>\n*> REMARK OUT, ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  a               pic 999.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  escape-code     pic x.\n     03  truth           pic 9.\n         88  a-true                   value  1.\n         88  a-false                  value  zero.\n     03  test-address    pic x(92).\n     03  d24-02          pic x           value space.\n     03  d24-03          pic x           value space.\n     03  d24-check.\n         05  filler      pic x(13)       value \"Check Digit {\".\n         05  d24-digit   pic x           value space.\n         05  filler      pic x           value \"}\".\n     03  A01-Notes.\n         05  a01-Notes-1 pic x(48)       value spaces.\n         05  a01-Notes-2 pic x(48)       value spaces.\n     03  ws-env-lines    pic 999         value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Error-Messages.\n *> System Wide\n *> Module Specific\n     03  PL131           pic x(36) value \"PL131 Supplier Record Already Exists\".\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  error-code          pic 999.\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n screen section.\n*>=============\n*>\n 01  display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  value \"Supplier Nos : [\"    line  4 col  6.\n*> >>>>>>>> customer no here <<<<<<<\n     03  from d24-02          pic x  line  4 col 28.\n     03  from d24-03          pic x          col 29.\n     03  from d24-check       pic x(15)      col 31.\n     03  value \"Supplier Name: [\"    line  6 col  6.\n     03  using Purch-name  pic x(30) line  6 col 22.\n     03  value \"]\"                   line  6 col 52.\n     03  value \"Addr: [\"             line  7 col 15.\n     03  using Purch-addr1 pic x(48)         col 22.\n     03  value \"]\"                   line  7 col 70.\n     03  value \"[\"                   line  8 col 21.\n     03  using Purch-addr2    pic x(48)      col 22.\n     03  value \"]\"                   line  8 col 70.\n     03  value \"Suppliers Bank Details\"\n                                     line  9 col  6.\n     03  value \"Sort Code  : [\"      line 10 col  8.\n     03  using Purch-SortCode pic 9(6)       col 22.\n     03  value \"]\"                           col 28.\n     03  value \"Account No : [\"      line 11 col  8.\n     03  using Purch-AccountNo pic 9(8)      col 22.\n     03  value \"]\"                           col 30.\n     03  value \"Supplier Note: [\"    line 12 col  6.\n     03  using a01-Notes-1    pic x(48)      col 22.\n     03  value \"]\"                           col 70.\n     03  value \"[\"                   line 13 col 21.\n     03  using a01-Notes-2    pic x(48)      col 22.\n     03  value \"]\"                           col 70.\n     03  value \"Telephone    : [\"    line 14 col  6.\n     03  using Purch-phone    pic x(13)      col 22.\n     03  value \"]\"                           col 35.\n     03  value \"Ext: [\"                      col 37.\n     03  using Purch-ext      pic x(4)       col 43.\n     03  value \"]\"                           col 47.\n     03  value \"Fax : [\"                     col 50.\n     03  using Purch-fax      pic x(13)      col 57.\n     03  value \"]\"                           col 70.\n     03  value \"Email Sales  : [\"    line 15 col  6.\n     03  using Purch-email    pic x(30)      col 22.\n     03  value \"]\"                           col 52.\n     03  value \"Credit Period: [\"    line 18 col  6.\n     03  using Purch-credit   pic 99         col 22.\n     03  value \"]\"                           col 24.\n     03  value \"Credit limit : [\"    line 19 col  6.\n     03  using Purch-limit    pic 9(7)       col 22.\n     03  value \"] Discount : [\"              col 29.\n     03  using Purch-discount pic 99v99      col 43.\n     03  value \"]\"                           col 47.\n     03  value \"*******************\" line 19 col 61.\n     03  value \"Unapplied Bal: {\"    line 20 col  6.\n     03  value \"}\"                           col 34.\n     03  value \"* Escape Code [\"     line 20 col 61.\n*>  value entered by individual display\n     03  value \"] *\"                         col 77.\n     03  value \"Current Bal  : {\"    line 21 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 34.\n     03  value \"* <B> = Back      *\"         col 61.\n     03  value \"Last invoice : {\"    line 22 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 30.\n     03  value \"* <S> = Save      *\"         col 61.\n     03  value \"Last payment : {\"    line 23 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 30.\n     03  value \"* <Q> = Quit      *\" line 23 col 61.\n     03  value \"*******************\" line 24 col 61.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n init01 section.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     display  prog-name at 0101 with foreground-color 2.\n*>\n     perform  Purch-Open.        *> open   i-o purchase-file\n     perform  Delivery-Open.     *> open   i-o delivery-file.\n     display  \" \" at line 3 col 1 with erase eos\n*>\n     perform  setup-suppliers.\n     perform  Purch-Close.\n     perform  Delivery-Close.    *> close  purchase-file delivery-file.\n*>\n menu-end.\n     exit     program.\n*>\n setup-suppliers         section.\n*>==============================\n*>\n     move     spaces to customer-nos.\n     move     spaces to a01-Notes-1  a01-Notes-2 d24-03. *> not in sl960\n     move     \"]\" to d24-02.                     *> not in sl960\n     display  display-02.\n*>\n supplier-accept.\n*>**************\n*>\n     accept   customer-nos at 0422 with foreground-color 3.\n     if       customer-nos = spaces\n              go to  main-exit.\n     move     function upper-case (customer-nos) to customer-nos.\n     display  customer-nos at 0422 with foreground-color 3.\n*>\n     display  \" \" at line ws-23-lines col 1 with erase eol.\n*>\n     move     \"C\"  to  maps09-reply.\n     perform  maps09.\n     if       maps09-reply not = \"Y\"\n              go to  supplier-accept.\n*>\n     move     check-digit of maps09-ws to WS-Purch-Key (7:1).\n     display  WS-Purch-Key (7:1) at 0444 with foreground-color 3.\n*>\n     move     \"]\" to d24-03.                  *> not in sl960\n     move     customer-code  to  WS-Purch-Key.\n     perform  Purch-Read-Indexed     *>  read  purchase-file invalid key\n     if       fs-reply = 21 or 23\n              go to  supplier-details.\n*>\n*> Record already exists.\n*>\n     display  PL131  at 2301   with foreground-color 4.\n     go       to supplier-accept.\n*>\n supplier-details.\n*>***************\n*>\n     initialize WS-Purch-Record  WS-Delivery-Record.\n     move     run-date      to purch-create-date.\n     move     1             to purch-status.      *> Live\n     move     customer-code to WS-Purch-Key.\n     move     age-to-pay    to purch-credit.\n*>\n get-details.\n*>**********\n*>\n     perform  supplier-data.\n*>\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>**********\n*>\n     if       escape-code = \"B\"\n              go to get-details.\n*>\n     if       escape-code = \"Q\"\n              go to  main-exit.\n     perform  Purch-Write.        *> write    purch-record.\n*>\n     if       Purch-Notes-Tag not = zero\n              move   \"D\"       to WS-Deliv-Key-Type\n              move   WS-Purch-Key to Deliv-Purchase-Key\n              move   spaces    to Deliv-Name\n              move   A01-Notes to Deliv-Address\n              perform Delivery-Write.    *>  write  delivery-record.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n oddsnsods section.\n*>****************\n*>\n maps09.\n     call     \"maps09\"  using  customer-code.\n*>\n test-escape  section.\n*>===================\n*>\n     display  escape-code at 2076 with foreground-color 6.\n*>\n get-escape.\n*>*********\n*>\n     accept   escape-code at 2076 with foreground-color 6 update.\n     move     function upper-case (escape-code) to escape-code.\n*>\n     if       escape-code not = \"B\" and not = \"S\" and not = \"Q\"\n              go to get-escape.\n*>\n main-exit.   exit section.\n*>\n supplier-data           section.\n*>==============================\n*>\n Supplier-Data-Main.\n     accept   display-02.\n*>\n     move     purch-address  to  test-address.\n     perform  validate-address.\n*>\n      if      a-false\n              display \"Addr Err\" at 0771 with foreground-color 4\n              go to supplier-data-Main\n      else\n              display \" \" at 0771 with erase eol.\n*>\n     if       A01-Notes = spaces\n              move zero to Purch-Notes-Tag\n     else\n              move 1    to Purch-Notes-Tag.\n*>\n main-exit.   exit section.\n*>\n validate-address        section.\n*>==============================\n*>\n     move     zero  to  a.\n     inspect  test-address  tallying  a  for all pl-delim.\n*>\n     if       a  >  4  or  <  1\n              move  zero  to  truth\n     else\n              move  1  to  truth.\n*>\n     move     zero  to  a.\n     inspect  test-address tallying a for characters before initial pl-delim.\n*>\n     if       a  >  30\n              move  zero  to  truth.\n*>\n main-exit.   exit section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 78
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 29,
      "totalOperators": 19,
      "totalOperands": 38,
      "vocabulary": 30,
      "length": 57,
      "volume": 279.69276394968557
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
