{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/stock/st030.cbl",
  "fileName": "st030.cbl",
  "timestamp": "2025-09-15T16:25:49.701Z",
  "programId": "st030",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 145
      },
      {
        "name": "file",
        "line": 156
      },
      {
        "name": "working-storage",
        "line": 163
      },
      {
        "name": "linkage",
        "line": 535
      },
      {
        "name": "Screen",
        "line": 543
      },
      {
        "name": "AA000-Core",
        "line": 657
      },
      {
        "name": "BA000-Process-Valuations",
        "line": 848
      },
      {
        "name": "exit",
        "line": 970
      },
      {
        "name": "CA000-Process-Activity",
        "line": 972
      },
      {
        "name": "exit",
        "line": 1118
      },
      {
        "name": "DA000-Process-ReOrder",
        "line": 1120
      },
      {
        "name": "exit",
        "line": 1278
      },
      {
        "name": "EA000-Process-Stock-Lists",
        "line": 1280
      },
      {
        "name": "exit",
        "line": 1476
      },
      {
        "name": "EB000-Process-Stock-Desc",
        "line": 1478
      },
      {
        "name": "FA000-Process-History",
        "line": 1529
      },
      {
        "name": "exit",
        "line": 1670
      },
      {
        "name": "GA000-Process-Location",
        "line": 1672
      },
      {
        "name": "exit",
        "line": 1767
      },
      {
        "name": "ZZ002-Print-Head-Top",
        "line": 1773
      },
      {
        "name": "exit",
        "line": 1804
      },
      {
        "name": "ZZ004-String-Range",
        "line": 1806
      },
      {
        "name": "exit",
        "line": 1848
      },
      {
        "name": "ZZ006-String-Range",
        "line": 1850
      },
      {
        "name": "exit",
        "line": 1890
      },
      {
        "name": "ZZ010-Print-Heads",
        "line": 1892
      },
      {
        "name": "exit",
        "line": 1920
      },
      {
        "name": "ZZ020-Print-Heads",
        "line": 1922
      },
      {
        "name": "exit",
        "line": 1983
      },
      {
        "name": "ZZ025-Print-Heads",
        "line": 1985
      },
      {
        "name": "Exit",
        "line": 2039
      },
      {
        "name": "ZZ030-Print-Heads",
        "line": 2041
      },
      {
        "name": "Exit",
        "line": 2077
      },
      {
        "name": "ZZ035-Print-Heads",
        "line": 2079
      },
      {
        "name": "ZZ040-Print-Heads",
        "line": 2099
      },
      {
        "name": "exit",
        "line": 2121
      },
      {
        "name": "ZZ045-Print-Heads",
        "line": 2123
      },
      {
        "name": "exit",
        "line": 2145
      },
      {
        "name": "ZZ050-Report-Selection",
        "line": 2147
      },
      {
        "name": "exit",
        "line": 2299
      },
      {
        "name": "ZZ060-Convert-Date",
        "line": 2301
      },
      {
        "name": "exit",
        "line": 2334
      },
      {
        "name": "ZZ070-Convert-Date",
        "line": 2336
      },
      {
        "name": "exit",
        "line": 2364
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 148
      },
      {
        "name": "file-defs",
        "line": 654
      },
      {
        "name": "WS-Todate-Period",
        "line": 685
      },
      {
        "name": "AA010-Display-Headings",
        "line": 733
      },
      {
        "name": "AA020-Display-Heads",
        "line": 762
      },
      {
        "name": "AA030-DH-End",
        "line": 770
      },
      {
        "name": "aa100-Main-Menu",
        "line": 781
      },
      {
        "name": "aa110-Accept-Loop",
        "line": 794
      },
      {
        "name": "end-evaluate",
        "line": 830
      },
      {
        "name": "maps04",
        "line": 838
      },
      {
        "name": "aa999-Exit",
        "line": 841
      },
      {
        "name": "end-if",
        "line": 868
      },
      {
        "name": "BA010-Read-Rec",
        "line": 896
      },
      {
        "name": "BA020-Print-Rec",
        "line": 925
      },
      {
        "name": "BA030-Finish-Report",
        "line": 946
      },
      {
        "name": "ba999-Exit",
        "line": 969
      },
      {
        "name": "end-if",
        "line": 1014
      },
      {
        "name": "CA010-Read-Rec",
        "line": 1017
      },
      {
        "name": "CA020-Print-Rec",
        "line": 1063
      },
      {
        "name": "CA030-Finish-Report",
        "line": 1108
      },
      {
        "name": "ca999-Exit",
        "line": 1117
      },
      {
        "name": "end-if",
        "line": 1163
      },
      {
        "name": "DA010-Read-Rec",
        "line": 1165
      },
      {
        "name": "DA013-End-Range-Test",
        "line": 1206
      },
      {
        "name": "DA020-Print-Rec",
        "line": 1218
      },
      {
        "name": "DA030-Finish-Report",
        "line": 1268
      },
      {
        "name": "da999-Exit",
        "line": 1277
      },
      {
        "name": "EA010-Read-Rec",
        "line": 1326
      },
      {
        "name": "EA020-Print-Rec",
        "line": 1352
      },
      {
        "name": "EA030-Totals",
        "line": 1456
      },
      {
        "name": "ea999-Exit",
        "line": 1475
      },
      {
        "name": "EB010-Read-Rec",
        "line": 1488
      },
      {
        "name": "EB020-Print-Rec",
        "line": 1496
      },
      {
        "name": "EB030-Totals",
        "line": 1517
      },
      {
        "name": "FA010-Read-Rec",
        "line": 1575
      },
      {
        "name": "FA020-Print-Rec",
        "line": 1601
      },
      {
        "name": "FA030-Finish-Report",
        "line": 1641
      },
      {
        "name": "FA999-Exit",
        "line": 1669
      },
      {
        "name": "C",
        "line": 1679
      },
      {
        "name": "GA010-Read-Rec",
        "line": 1699
      },
      {
        "name": "end-perform",
        "line": 1735
      },
      {
        "name": "GA030-Finish-Report",
        "line": 1737
      },
      {
        "name": "GA999-Exit",
        "line": 1766
      },
      {
        "name": "line-0",
        "line": 1802
      },
      {
        "name": "ZZ002-Exit",
        "line": 1803
      },
      {
        "name": "ZZ004-Exit",
        "line": 1847
      },
      {
        "name": "end-if",
        "line": 1874
      },
      {
        "name": "ZZ006-Exit",
        "line": 1889
      },
      {
        "name": "ZZ010-Exit",
        "line": 1919
      },
      {
        "name": "ZZ020-Exit",
        "line": 1982
      },
      {
        "name": "ZZ025-Exit",
        "line": 2038
      },
      {
        "name": "ZZ030-Exit",
        "line": 2076
      },
      {
        "name": "ZZ040-Exit",
        "line": 2120
      },
      {
        "name": "ZZ045-Exit",
        "line": 2144
      },
      {
        "name": "ZZ050-Report-Selection-Main",
        "line": 2149
      },
      {
        "name": "WS-Location-To-Cnt",
        "line": 2159
      },
      {
        "name": "ZZ050-Get-Disp-01",
        "line": 2186
      },
      {
        "name": "ZZ050-Get-Disp-03",
        "line": 2203
      },
      {
        "name": "ZZ050-Get-Disp-04",
        "line": 2243
      },
      {
        "name": "end-perform",
        "line": 2270
      },
      {
        "name": "end-perform",
        "line": 2280
      },
      {
        "name": "ZZ050-Exit",
        "line": 2298
      },
      {
        "name": "ZZ060-Exit",
        "line": 2333
      },
      {
        "name": "ZZ070-Exit",
        "line": 2363
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 709,
        "type": "DYNAMIC",
        "using": [
          "File-11",
          "*>",
          "Stock",
          "file",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "ST300",
          "at",
          "line",
          "WS-23-Lines",
          "col",
          "1",
          "with",
          "foreground-color",
          "4",
          "highlight",
          "display",
          "ST006",
          "at",
          "line",
          "WS-Lines",
          "col",
          "01",
          "accept",
          "WS-Reply",
          "at",
          "line",
          "WS-Lines",
          "col",
          "32",
          "go",
          "to",
          "aa999-Exit",
          "end-if",
          "end-if",
          "*>",
          "perform",
          "Stock-Open"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 834,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 839,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 135,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 144,
        "replacing": null
      },
      {
        "name": "selstock",
        "line": 151,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 152,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 159,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 161,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 167,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 225,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 484,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 485,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 486,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 487,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 514,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 538,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 539,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 540,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2366,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "ZZ070-Convert-Date",
        "thru": null,
        "line": 675
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 720
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 726
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 729
      },
      {
        "target": "AA010-Display-Headings",
        "thru": null,
        "line": 799
      },
      {
        "target": "ZZ050-Report-Selection",
        "thru": null,
        "line": 801
      },
      {
        "target": "Stock-Open-Input",
        "thru": null,
        "line": 809
      },
      {
        "target": "BA000-Process-Valuations",
        "thru": null,
        "line": 814
      },
      {
        "target": "CA000-Process-Activity",
        "thru": null,
        "line": 816
      },
      {
        "target": "DA000-Process-ReOrder",
        "thru": null,
        "line": 818
      },
      {
        "target": "FA000-Process-History",
        "thru": null,
        "line": 820
      },
      {
        "target": "EA000-Process-Stock-Lists",
        "thru": null,
        "line": 822
      },
      {
        "target": "EB000-Process-Stock-Desc",
        "thru": null,
        "line": 824
      },
      {
        "target": "GA000-Process-Location",
        "thru": null,
        "line": 826
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 832
      },
      {
        "target": "varying",
        "thru": null,
        "line": 852
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 854
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 860
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 877
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 890
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 897
      },
      {
        "target": "ZZ010-Print-Heads",
        "thru": null,
        "line": 926
      },
      {
        "target": "ZZ010-Print-Heads",
        "thru": null,
        "line": 962
      },
      {
        "target": "varying",
        "thru": null,
        "line": 976
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 978
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 985
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1001
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1013
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1018
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1042
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1047
      },
      {
        "target": "ZZ020-Print-Heads",
        "thru": null,
        "line": 1067
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1124
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1126
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1133
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1149
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1161
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1166
      },
      {
        "target": "ZZ030-Print-Heads",
        "thru": null,
        "line": 1222
      },
      {
        "target": "ZZ060-Convert-Date",
        "thru": null,
        "line": 1252
      },
      {
        "target": "ZZ060-Convert-Date",
        "thru": null,
        "line": 1259
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1284
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1286
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1292
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1308
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1320
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1327
      },
      {
        "target": "ZZ040-Print-Heads",
        "thru": null,
        "line": 1353
      },
      {
        "target": "ZZ060-Convert-Date",
        "thru": null,
        "line": 1375
      },
      {
        "target": "ZZ060-Convert-Date",
        "thru": null,
        "line": 1382
      },
      {
        "target": "ZZ040-Print-Heads",
        "thru": null,
        "line": 1468
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1485
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1490
      },
      {
        "target": "ZZ035-Print-Heads",
        "thru": null,
        "line": 1497
      },
      {
        "target": "ZZ035-Print-Heads",
        "thru": null,
        "line": 1520
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1533
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1535
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1541
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1557
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1569
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1576
      },
      {
        "target": "ZZ045-Print-Heads",
        "thru": null,
        "line": 1603
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1608
      },
      {
        "target": "write",
        "thru": null,
        "line": 1610
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1621
      },
      {
        "target": "if",
        "thru": null,
        "line": 1626
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1629
      },
      {
        "target": "move",
        "thru": null,
        "line": 1632
      },
      {
        "target": "ZZ045-Print-Heads",
        "thru": null,
        "line": 1657
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1692
      },
      {
        "target": "until",
        "thru": null,
        "line": 1700
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1701
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1703
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1711
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1716
      },
      {
        "target": "ZZ025-Print-Heads",
        "thru": null,
        "line": 1722
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1734
      },
      {
        "target": "ZZ025-Print-Heads",
        "thru": null,
        "line": 1747
      },
      {
        "target": "ZZ004-String-Range",
        "thru": null,
        "line": 1901
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 1905
      },
      {
        "target": "ZZ004-String-Range",
        "thru": null,
        "line": 1946
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 1951
      },
      {
        "target": "ZZ006-String-Range",
        "thru": null,
        "line": 2028
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 2032
      },
      {
        "target": "ZZ004-String-Range",
        "thru": null,
        "line": 2064
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 2069
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 2090
      },
      {
        "target": "ZZ004-String-Range",
        "thru": null,
        "line": 2109
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 2113
      },
      {
        "target": "ZZ004-String-Range",
        "thru": null,
        "line": 2133
      },
      {
        "target": "ZZ002-Print-Head-Top",
        "thru": null,
        "line": 2137
      },
      {
        "target": "varying",
        "thru": null,
        "line": 2262
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 2265
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 2268
      },
      {
        "target": "varying",
        "thru": null,
        "line": 2272
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 2275
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 2278
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2310
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-Lines WS-Lines\n     else\n              move  WS-env-Lines to WS-Lines\n     end-if\n     subtract 1 from WS-Lines giving WS-23-Lines",
        "line": 662
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 671
      },
      {
        "from": "WS-Date",
        "to": "WS-Conv-Date",
        "line": 676
      },
      {
        "from": "hd-hh",
        "to": "L2-HH\n              move hd-mm to L2-MM",
        "line": 679
      },
      {
        "from": "spaces",
        "to": "WS-Current-Period\n                        WS-Todate-Period",
        "line": 684
      },
      {
        "from": "\"Quarter\"",
        "to": "WS-Current-Period\n                                L64-Lit-Period\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"Week\" to WS-Current-Period\n              move \"   Week\" to L64-Lit-Period\n      else\n              move \"  Month\" to L64-Lit-Period\n              move \"Month\" to WS-Current-Period",
        "line": 688
      },
      {
        "from": "\"Month",
        "to": "Date\" to WS-Todate-Period\n     else\n      if      Stk-Period-dat = \"Q\"\n              move \"Quarter To Date\" to WS-Todate-Period\n      else\n              move \"Year To Date\" to WS-Todate-Period",
        "line": 699
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 728
      },
      {
        "from": "zero",
        "to": "Page-Nos",
        "line": 737
      },
      {
        "from": "99",
        "to": "Line-Cnt",
        "line": 738
      },
      {
        "from": "to-day",
        "to": "WS-Date",
        "line": 771
      },
      {
        "from": "WS-Month",
        "to": "WS-Proc-Month",
        "line": 772
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 795
      },
      {
        "from": "zero",
        "to": "Menu-Reply\n                       go       to AA010-Display-Headings\n     end-evaluate",
        "line": 828
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 835
      },
      {
        "from": "\"z\"",
        "to": "WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move   1 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n              if    FS-Reply = 21\n                    display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                    display ST006   at line WS-Lines col 01\n                    accept WS-Reply at line WS-Lines col 32\n                    move zero to Access-Type\n                    go to ba999-Exit\n              end-if\n     end-if",
        "line": 853
      },
      {
        "from": "WS-Abrev-From",
        "to": "WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move   2 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n              if    FS-Reply = 21\n                    display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                    display ST006   at line WS-Lines col 01\n                    accept WS-Reply at line WS-Lines col 32\n                    move zero to Access-Type\n                    go to ba999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n     end-if\n     move     zero to Access-Type",
        "line": 871
      },
      {
        "from": "zero",
        "to": "WS-Total-Value",
        "line": 893
      },
      {
        "from": "spaces",
        "to": "line-15",
        "line": 894
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "l15-Abrev-Number",
        "line": 927
      },
      {
        "from": "WS-Stock-Key",
        "to": "l15-Stock-Number",
        "line": 928
      },
      {
        "from": "WS-Stock-Desc",
        "to": "l15-Desc",
        "line": 929
      },
      {
        "from": "Stock-Last-Actual-Cost",
        "to": "l15-Cost",
        "line": 930
      },
      {
        "from": "Stock-Cost",
        "to": "l15-Ave-Cost",
        "line": 931
      },
      {
        "from": "Stock-Held",
        "to": "l15-Qty",
        "line": 932
      },
      {
        "from": "Stock-Value",
        "to": "l15-Value",
        "line": 933
      },
      {
        "from": "Stock-Retail",
        "to": "l15-Retail",
        "line": 934
      },
      {
        "from": "spaces",
        "to": "l15-Blank-0\n     end-if\n     if       Stk-Manu-Used = 1\n              move Stock-Work-in-Progress to l15-Wip\n     end-if\n     write    Print-Record from Line-15 after 1",
        "line": 936
      },
      {
        "from": "99",
        "to": "Line-Cnt\n              perform ZZ010-Print-Heads",
        "line": 961
      },
      {
        "from": "WS-Total-Value",
        "to": "l16-Value",
        "line": 964
      },
      {
        "from": "\"z\"",
        "to": "WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     move     spaces to line-25",
        "line": 977
      },
      {
        "from": "WS-Stock-From",
        "to": "WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              if      FS-Reply = 21                *> invalid key\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ca999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move    WS-Abrev-From to WS-Stock-Abrev-Key\n              if      WS-Stock-Abrev-Key (7:1) = space\n                      move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              if      FS-Reply = 21                *> invalid key\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 30\n                      go to ca999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n     end-if",
        "line": 982
      },
      {
        "from": "zero",
        "to": "Access-Type",
        "line": 1015
      },
      {
        "from": "zero",
        "to": "WS-Total-Add WS-Total-Ded",
        "line": 1040
      },
      {
        "from": "zero",
        "to": "WS-WIP-Total-Add WS-WIP-Total-Ded",
        "line": 1041
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "L25-Abrev-Number",
        "line": 1068
      },
      {
        "from": "WS-Stock-Key",
        "to": "L25-Stock-Number",
        "line": 1069
      },
      {
        "from": "WS-Stock-Desc",
        "to": "L25-Desc",
        "line": 1070
      },
      {
        "from": "Stock-Cost",
        "to": "L25-Ave-Cost\n              move  Stock-Value            to L25-Value\n     else\n              move  spaces                 to L25-ValueX\n              move  Stock-Last-Actual-Cost to L25-Ave-Cost\n     end-if\n     move     Stock-Held                   to L25-Qty",
        "line": 1072
      },
      {
        "from": "Stock-Retail",
        "to": "L25-Retail",
        "line": 1079
      },
      {
        "from": "Stock-Adds",
        "to": "L25-Cur-Add",
        "line": 1080
      },
      {
        "from": "Stock-Deducts",
        "to": "L25-Cur-Ded",
        "line": 1081
      },
      {
        "from": "WS-Total-Add",
        "to": "L25-YTD-Add",
        "line": 1084
      },
      {
        "from": "WS-Total-Ded",
        "to": "L25-YTD-Ded",
        "line": 1085
      },
      {
        "from": "spaces",
        "to": "line-25\n              move \"Work in Progress:\"    to L25b-Lit-Wip\n              move Stock-Work-in-Progress to L25-Qty\n              move \"WIP:\"                 to L25-Lit-Wip\n              move Stock-Wip-Adds         to L25-Cur-Add\n              move Stock-Wip-Deds         to L25-Cur-Ded\n              subtract Stock-Wip-Deds from Stock-Wip-Adds giving L25-Cur-Net\n              move WS-WIP-Total-Add       to L25-YTD-Add\n              move WS-WIP-Total-Ded       to L25-YTD-Ded\n              subtract WS-WIP-Total-Ded from WS-WIP-Total-Add giving L25-YTD-Net\n              write Print-Record from Line-25 after 1\n              add  1 to Line-Cnt\n     end-if\n     go       to CA010-Read-Rec",
        "line": 1093
      },
      {
        "from": "\"z\"",
        "to": "WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     move     spaces to line-35",
        "line": 1125
      },
      {
        "from": "WS-Stock-From",
        "to": "WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 30\n                      go to da999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move WS-Abrev-From to WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to da999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              move     zero to Access-Type\n     end-if",
        "line": 1130
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "L35-Abrev-Number",
        "line": 1223
      },
      {
        "from": "WS-Stock-Key",
        "to": "L35-Stock-Number",
        "line": 1224
      },
      {
        "from": "WS-Stock-Desc",
        "to": "L35-Desc",
        "line": 1225
      },
      {
        "from": "space",
        "to": "L35-Flag",
        "line": 1226
      },
      {
        "from": "\"O\"",
        "to": "L35-Flag\n     else\n      if      Stock-Held < Stock-ReOrder-Pnt\n              move \"U\" to L35-Flag",
        "line": 1228
      },
      {
        "from": "space",
        "to": "L35-Flag",
        "line": 1234
      },
      {
        "from": "Stock-Cost",
        "to": "L35-Cost\n     else\n              move  Stock-Last-Actual-Cost to L35-Cost\n     end-if\n     move     Stock-Held                   to L35-Qty",
        "line": 1237
      },
      {
        "from": "Stock-Supplier-P1",
        "to": "L35-Supplier",
        "line": 1242
      },
      {
        "from": "Stock-ReOrder-Pnt",
        "to": "L35-ReOrder-Pnt",
        "line": 1243
      },
      {
        "from": "Stock-Std-ReOrder",
        "to": "L35-Std-ReOrder",
        "line": 1244
      },
      {
        "from": "Stock-On-Order",
        "to": "L35-On-Order",
        "line": 1245
      },
      {
        "from": "Stock-Back-Ordered",
        "to": "L35-Back-Ordered",
        "line": 1246
      },
      {
        "from": "Stock-Work-in-Progress",
        "to": "L35-WIP\n     end-if\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to L35-Order-Date\n     else\n              move spaces to L35-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to L35-Order-Due\n     else\n              move spaces to L35-Order-Due\n     end-if\n     write    Print-Record from Line-35 after 1",
        "line": 1248
      },
      {
        "from": "\"z\"",
        "to": "WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ea999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move WS-Abrev-From to WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ea999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              move     zero to Access-Type\n     end-if\n     move     spaces to line-45",
        "line": 1285
      },
      {
        "from": "zero",
        "to": "WS-Rec-Cnt",
        "line": 1324
      },
      {
        "from": "spaces",
        "to": "line-45",
        "line": 1355
      },
      {
        "from": "WS-Stock-Key",
        "to": "l45-Stock-Number",
        "line": 1356
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "l45-Abrev-Stock",
        "line": 1357
      },
      {
        "from": "Stock-Supplier-P1",
        "to": "l45-Supplier-No",
        "line": 1358
      },
      {
        "from": "Stock-Retail",
        "to": "l45-Retail",
        "line": 1359
      },
      {
        "from": "Stock-Cost",
        "to": "l45-Cost",
        "line": 1360
      },
      {
        "from": "spaces",
        "to": "l45-Costz\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n              move  Stock-Value        to l45-Value\n              move  Stock-Held         to l45-Held\n              move  Stock-ReOrder-Pnt  to l45-Reord-Pnt\n              move  Stock-Std-ReOrder  to l45-Reord-Qty\n              move  Stock-On-Order     to l45-Qty-Ordered\n              move  Stock-Back-Ordered to l45-Qty-Back-Ord\n     end-if\n     move     WS-Stock-Location        to l45-Location",
        "line": 1362
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to l45-Date-Ordered\n     else\n              move spaces to l45-Date-Ordered\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to l45-Date-Due\n     else\n              move spaces to l45-Date-Due\n     end-if\n     move     WS-Stock-Desc to l46-Desc",
        "line": 1374
      },
      {
        "from": "1",
        "to": "a",
        "line": 1388
      },
      {
        "from": "spaces",
        "to": "l46-vars",
        "line": 1389
      },
      {
        "from": "Stock-Pre-Sales",
        "to": "WS-z6\n              string \"  Pre Sales :\"       delimited by size\n                     WS-z6                 delimited by size into l46-vars pointer a\n     end-if\n     if       Line-Cnt > 6\n              move all \"-\" to Print-Record\n              write Print-Record after 1\n              write Print-Record from line-45 after 1\n              add   2 to Line-Cnt\n     else\n              add   1 to Line-Cnt\n              write Print-Record from line-45 after 1\n     end-if\n     write    Print-Record from line-46 after 1",
        "line": 1414
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1429
      },
      {
        "from": "Stock-Construct-Bundle",
        "to": "WS-z6\n              move Stock-Under-Construction to WS-z6b\n              move Stock-Work-in-Progress   to WS-z6c\n              string \"Construction Bundle :\"    delimited by size\n                     WS-z6                      delimited by size\n                     \"  WIP :\"                  delimited by size\n                     WS-z6c                     delimited by size\n                     \"  Under Construction :\"   delimited by size\n                     WS-z6b                     delimited by size\n                     \" For Constructed Item : \" delimited by size\n                     Stock-Construct-Item       delimited by size\n                                into Print-Record\n              end-string\n              write  Print-Record after 1\n              add 1 to Line-Cnt\n     end-if\n     if       Stock-Services-Flag = \"Y\"\n              move \"Services only Product\" to Print-Record\n              write  Print-Record after 1\n              add 1 to Line-Cnt\n     end-if\n     go       to EA010-Read-Rec",
        "line": 1433
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1469
      },
      {
        "from": "WS-Rec-Cnt",
        "to": "WS-Rec-Total",
        "line": 1470
      },
      {
        "from": "spaces",
        "to": "Line-62",
        "line": 1481
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Desc",
        "line": 1482
      },
      {
        "from": "3",
        "to": "File-Key-No",
        "line": 1483
      },
      {
        "from": "zero",
        "to": "WS-Rec-Cnt",
        "line": 1486
      },
      {
        "from": "3",
        "to": "File-Key-No",
        "line": 1489
      },
      {
        "from": "WS-Stock-Key",
        "to": "L62-Stock-Number",
        "line": 1500
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "L62-Abrev",
        "line": 1501
      },
      {
        "from": "WS-Stock-Desc",
        "to": "L62-Description",
        "line": 1502
      },
      {
        "from": "Stock-Retail",
        "to": "L62-Retail",
        "line": 1503
      },
      {
        "from": "Stock-Cost",
        "to": "L62-Cost",
        "line": 1504
      },
      {
        "from": "Stock-Held",
        "to": "L62-Held\n              move  spaces to L62-Service\n     else\n              move zero to L62-Held\n              move \"Services only Product\" to L62-Service",
        "line": 1506
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1514
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1521
      },
      {
        "from": "WS-Rec-Cnt",
        "to": "WS-Rec-Total",
        "line": 1522
      },
      {
        "from": "\"z\"",
        "to": "WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move     WS-Stock-From to WS-Stock-Key\n              move     1 to File-Key-No\n              set      fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform  Stock-Start\n              if       FS-Reply = 21\n                       display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                       display ST006   at line WS-Lines col 01\n                       accept WS-Reply at line WS-Lines col 32\n                       go to FA999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move     WS-Abrev-From to WS-Stock-Abrev-Key\n              if       WS-Stock-Abrev-Key (7:1) = space\n                       move zero to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move     2 to File-Key-No\n              set      fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform  Stock-Start\n              if       FS-Reply = 21\n                       display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                       display ST006   at line WS-Lines col 01\n                       accept WS-Reply at line WS-Lines col 32\n                       go to FA999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move     zeros to WS-Stock-Abrev-Key\n              move     2 to File-Key-No\n              set      fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform  Stock-Start\n              move     zero to Access-Type\n     end-if\n     move     zero     to WS-Rec-Cnt c",
        "line": 1534
      },
      {
        "from": "spaces",
        "to": "Line-65",
        "line": 1573
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "L65-Abrev-Stock",
        "line": 1604
      },
      {
        "from": "WS-Stock-Key",
        "to": "L65-Stock-Number",
        "line": 1605
      },
      {
        "from": "WS-Stock-Desc",
        "to": "L65-Desc",
        "line": 1606
      },
      {
        "from": "spaces",
        "to": "Line-65\n              move     zero to b                     *> dont bother printing WIPs if all zero\n              if       Stock-Wip-Adds not = zero\n                or     Stock-Wip-Deds not = zero\n                       move 1 to b\n              end-if\n              perform  varying a from 1 by 1 until a > 12\n                       if       Stock-TD-WIP-Adds (a) not = zero\n                         or     Stock-TD-WIP-Deds (a) not = zero\n                                move 1 to b\n                       end-if\n              end-perform\n              if       b not = zero\n                       add      Stock-Wip-Adds Stock-Wip-Deds giving L65-This-Period\n                       perform  varying a from 1 by 1 until a > 12\n                                add Stock-TD-WIP-Adds (a) Stock-TD-WIP-Deds (a)\n                                                          giving L65-This-Year (a)\n                       end-perform\n                       move     \"WIP:\" to L65-Lit-Wip\n                       write    Print-Record from Line-65 after 1\n                       add      1 to Line-Cnt\n                       move     1 to c\n              end-if\n     end-if\n     go       to FA010-Read-Rec",
        "line": 1615
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1658
      },
      {
        "from": "WS-Rec-Cnt",
        "to": "WS-Rec-Total",
        "line": 1659
      },
      {
        "from": "zero",
        "to": "WS-Rec-Cnt\n                      C",
        "line": 1678
      },
      {
        "from": "spaces",
        "to": "Line-72",
        "line": 1680
      },
      {
        "from": "low-values",
        "to": "WS-Current-Location",
        "line": 1681
      },
      {
        "from": "WS-Location-Frm",
        "to": "WS-Stock-Location\n     else\n              move     low-values      to WS-Stock-Location",
        "line": 1686
      },
      {
        "from": "4",
        "to": "File-Key-No",
        "line": 1690
      },
      {
        "from": "WS-Stock-Location",
        "to": "WS-Current-Location\n              end-if\n              if       WS-Location-To-Cnt not = zero\n                and    WS-Stock-Location (1:WS-Location-To-Cnt) >\n                                            WS-Location-To (1:WS-Location-To-Cnt)\n                       exit perform\n              end-if\n              if       WS-Location-Frm-Cnt not = zero\n                and    WS-Stock-Location (1:WS-Location-Frm-Cnt) <\n                                            WS-Location-Frm (1:WS-Location-Frm-Cnt)\n                       exit perform cycle     *> Skip record\n              end-if\n*>\n*> Have a record in range if Frm / To in use\n*> Now we can deal with printing the record\n*>\n              perform  ZZ025-Print-Heads\n              move     WS-Stock-Abrev-Key to L72-Abrev-Stock\n              move     WS-Stock-Key       to L72-Stock-Number\n              move     WS-Stock-Desc      to L72-Desc\n              move     WS-Stock-Location  to L72-Location\n              move     Stock-Held         to L72-Held\n*>\n              write    Print-Record from Line-72 after 1\n              add      1 to WS-Rec-Cnt\n              add      1 to Line-Cnt\n *>             move     WS-Stock-Location  to WS-Current-Location\n*> above is in wrong place\n              exit perform cycle\n     end-perform",
        "line": 1706
      },
      {
        "from": "250",
        "to": "Line-Cnt\n              perform ZZ025-Print-Heads",
        "line": 1746
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1749
      },
      {
        "from": "WS-Rec-Cnt",
        "to": "WS-Rec-Total",
        "line": 1750
      },
      {
        "from": "Prog-Name",
        "to": "l11-Program",
        "line": 1777
      },
      {
        "from": "Page-Nos",
        "to": "l11-Page",
        "line": 1778
      },
      {
        "from": "Usera",
        "to": "l12-User",
        "line": 1779
      },
      {
        "from": "WS-Conv-Date",
        "to": "l12-Date",
        "line": 1780
      },
      {
        "from": "Report-Name",
        "to": "l11-Title",
        "line": 1781
      },
      {
        "from": "Line-12",
        "to": "Print-Record\n              if    b > 1\n                    move Line-0 (1:b) to Print-Record (a:b)\n              end-if\n              write Print-Record after 1\n              move  spaces to Print-Record\n              write Print-Record after 1\n     else\n              write Print-Record from Line-11 before 1\n              move Line-12 to Print-Record\n              if    b > 1\n                    move Line-0 (1:b) to Print-Record (a:b)\n              end-if\n              write Print-Record before 1\n     end-if\n     move     6 to Line-Cnt",
        "line": 1784
      },
      {
        "from": "spaces",
        "to": "Print-Record\n                        line-0",
        "line": 1801
      },
      {
        "from": "1",
        "to": "b",
        "line": 1898
      },
      {
        "from": "spaces",
        "to": "Line-0",
        "line": 1899
      },
      {
        "from": "spaces",
        "to": "l13-Lit-WIP l14-Lit-WIP\n     else\n              move \"WIP\"  to l13-Lit-WIP\n              move \"Qty\"  to l14-Lit-WIP\n     end-if\n     write    Print-Record from Line-13 after 1",
        "line": 1908
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1916
      },
      {
        "from": "1",
        "to": "b",
        "line": 1931
      },
      {
        "from": "\"Value\"",
        "to": "L24-Lit-Val\n     else\n              move \"   Unit\"  to L23-Lit-Average\n              move spaces     to L23-Lit-Val L24-Lit-Val\n     end-if\n*>\n*>  Set up period and to date heads\n*>\n     if       Stk-Period-Cur = \"Q\"\n              move \"< Current Quarter >\" to L23-Lit-Cur\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"<- Current Week -->\" to L23-Lit-Cur\n      else\n              move \"<- Current Month ->\" to L23-Lit-Cur",
        "line": 1956
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1979
      },
      {
        "from": "spaces",
        "to": "Print-Record\n *>                      write    Print-Record after page  *> AFTER TESTING\n                       write    Print-Record after 2     *> page  *> FOR TESTING remove after\n *>                      move     128  to Line-Cnt         *> AFTER TESTING add back",
        "line": 2005
      },
      {
        "from": "spaces",
        "to": "Print-Record\n                       write    Print-Record after 1\n               end-if\n              end-if\n              move     WS-Stock-Location  to WS-Current-Location\n     end-if\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ025-Exit",
        "line": 2014
      },
      {
        "from": "1",
        "to": "b",
        "line": 2026
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 2035
      },
      {
        "from": "1",
        "to": "b",
        "line": 2050
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 2073
      },
      {
        "from": "1",
        "to": "b",
        "line": 2087
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 2093
      },
      {
        "from": "5",
        "to": "Line-Cnt",
        "line": 2095
      },
      {
        "from": "1",
        "to": "b",
        "line": 2107
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 2117
      },
      {
        "from": "1",
        "to": "b",
        "line": 2131
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 2141
      },
      {
        "from": "spaces",
        "to": "WS-Stock-From WS-Stock-To\n                        WS-Abrev-From WS-Abrev-To\n                        WS-Location-Frm WS-Location-To",
        "line": 2153
      },
      {
        "from": "zeroes",
        "to": "WS-Partial WS-First-Rec WS-Reply\n                        WS-Location-Not-Ignored\n                        WS-Location-Frm-Cnt\n                        WS-Location-To-Cnt",
        "line": 2156
      },
      {
        "from": "1",
        "to": "WS-Partial\n     else\n              move zero to WS-Partial",
        "line": 2237
      },
      {
        "from": "\"N\"",
        "to": "WS-Double-Sided-Prt",
        "line": 2253
      },
      {
        "from": "zero",
        "to": "WS-Partial\n     else\n      if      WS-Location-Frm-Cnt > 0\n       or     WS-Location-To-Cnt > 0\n              move   1 to WS-Partial\n      else\n              move   zero to WS-Partial",
        "line": 2283
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to ZZ060-Exit",
        "line": 2312
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 2314
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2317
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to ZZ060-Exit",
        "line": 2321
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 2328
      },
      {
        "from": "to-day",
        "to": "WS-date",
        "line": 2344
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2347
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to ZZ070-Exit",
        "line": 2351
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 2358
      }
    ],
    "computes": [
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 1845
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 1887
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 1904
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2\n     end-if  *>  Next bit should work with any compiler (unless you know better)\n     perform  ZZ002-Print-Head-Top",
        "line": 1949
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 2031
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2\n     end-if\n     perform  ZZ002-Print-Head-Top",
        "line": 2067
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 2089
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 2112
      },
      {
        "target": "a",
        "expression": "(132 - b + 2) / 2",
        "line": 2136
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "used & wip qty or wip history\n*>                    nonzero.\n*>                .08 Replace trailing spaces on Abrev-To with 'z'.\n*> 25/06/09 vbc - .09-10 If range not used force start on Abrev key = 0 to make\n*>                    all reads on stock file sequential by Abrev key. Clean up\n*>                    positioning of subheadings ie 'All Items' etc, 1 col right.\n*> 29/06/09 vbc - .11 Added Stock History report.\n*> 22/07/09 vbc - .12/13 Understocked test wrong - Dont ask.\n*> 07/09/10 vbc - .14/16 on opt 5 incorrect test for < 0 > 5\n*>                    amended lpr to include cpi=12 & Cups printer spool.\n*> 11/12/11 vbc -     Changed version from 1.00.xx to 3.01.xx, in keeping with the rest of ACAS\n*>                .17 Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 04/03/12 vbc - .18 Cleanup: Removed chk char from Stock-Abbrev-key and WS-Stock-Key 4 rdbms\n*> 12/05/13 vbc - .19 Changed wsnames to in common as pl010 called in st010.\n*> 13/05/13 vbc - .20 Added time to reports.\n*> 16/05/13 vbc - .21 Changed wsnames to in copybook see above.\n*> 04/06/13 vbc - .22 Replaced Stk-WS-Page-Lines with system WS-Page-Lines.\n*> 21/07/16 vbc - .23 Replace Cobol file acces verbs with calls to FH and RDB\n*>                    DAL. Precede references to Stock-Record, WS-Stock-Key,\n*>                    WS-Stock-Abrev-Key, WS-Stock-Desc by WS- to reflect that we\n*>                    are only dealing with a WS record and the FD is now gone.\n*>                    Stop using File-Status and replace with call to\n*>                    \"CBL_CHECK_FILE_EXIST\" instead. Do same for all such\n*>                    checks, sets etc to kill of usage, dates back to floppies.\n*>                    ST011 added. Update version to 3.02.\n*> 24/10/16 vbc - .24 ALL programs now using wsnames.cob in copybooks.\n*>                    Usage of maps99 redundant so removed.\n*> 12/03/18 vbc - .25 acasnnn copylib renaming acas000-open etc to comply with\n*>                    rest of ACAS to (System-Open etc) removed unused field\n*>                    WS var. error-code.\n*> 02/07/20 vbc - .26 Adjust heads for print range using space and not size.\n*>                .27 On reports with FLG 'O' not used for zero stocks see\n*>                    L35-Flag\n*> 08/12/22 vbc - .28 Chgd goto in ZZ050 to use para -Main 4 GC v3.2 warning.\n*> 14/08/23 vbc - .29 Added report by Description as option 6,\n*>                    using WS-Page-Lines preset to 45 as reporting is Landscape.\n*> 16/08/23 vbc       Removed old remarked out Cobol file verbs.\n*> 25/02/24 vbc       Removed testing version of st030.cbl-SORT-2 not needed.\n*> 30/03/24 vbc       WARNING THIS PROGRAM DOES NOT REPORT ON STOCK-ARRIVAL-DATE\n*>                    DUE TO NOT ENOUGH SPACE ON A LINE OF 132 COLS.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 16/12/24 vbc - .30 Changed WS-Page-Lines to 56 as reports are landscape.\n*>                    User site to change if wrong for their printers.\n*> 26/01/25 vbc - .31 Added menu option 7 - Stock Report by Location so that\n*>                    report can be used to verify by stock storage location\n*>                    using new alt Stock key - Location.\n*>                    RDBMS Record may need an update ? Done.\n*>                    Ditto for FH and DAL.  Done.\n*> 04/02/25 vbc - .32 Added 'WS-'  to Stock-Location.\n*> 14/02/25           READY FOR TESTING - option 7 and from/too set with\n*>                      ignore cnt = 3 on test data. DONE.\n*>                    TEST code left in at zz025 that skipps doing a page or\n*>                    double page break  - SHOULD be changed back if user needs it\n*>                    but will use more paper per report.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>================================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>-------------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selstock.cob\".\n copy \"selprint.cob\".\n data                    division.\n*>================================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdstock.cob\".\n*>\n copy \"fdprint.cob\".\n*>\n working-storage section.\n*>-----------------------\n*>\n 77  Prog-Name               pic x(15)   value \"ST030 (3.02.32)\".\n copy \"print-spool-command.cob\".\n 77  Report-Name             pic x(28)   value spaces.\n*>\n 01  work-fields.\n     03  Menu-Reply          pic 9               value zero.\n         88  Menu-Level-1-Valid-Options          values 1 thru 7 9.\n     03  WS-Reply            pic 9               value zero.\n     03  SS-Reply            pic 99              value zeros.\n     03  WS-Proc-Month.\n         05  WS-Proc-Mth     pic 99              value zero.\n             88  WS-Good-Month                   values 01 thru 12.\n     03  WS-Partial          pic 9               value zero.\n     03  WS-First-Rec        pic 9               value zero.\n     03  WS-Stock-From       pic x(13)           value spaces.\n     03  WS-Stock-To         pic x(13)           value spaces.\n     03  WS-Abrev-From       pic x(7)            value spaces.\n     03  WS-Abrev-To         pic x(7)            value spaces.\n*>\n*> Location can be mixed case\n*>\n     03  WS-Location-Frm     pic x(10)           value spaces.  *> Used\n     03  WS-Location-To      pic x(10)           value spaces.  *>  and used\n     03  WS-Location-Not-Ignored\n                             pic 9               value zero.    *>  OR used.in chars from left\n     03  WS-Location-Frm-Cnt pic 99              value zero.    *> Computed from Loc Frm\n     03  WS-Location-To-Cnt  pic 99              value zero.    *> Computed from Loc To\n     03  WS-Double-Sided-Prt pic x               value \"Y\".\n     03  WS-Current-Location pic x(10)           value low-values.\n*>\n     03  WS-3                pic 999.\n     03  WS-z6               pic z(6).\n     03  WS-z6b              pic z(6).\n     03  WS-z6c              pic z(6).\n     03  WS-Rec-Total        pic zzz,zzz,zz9.\n     03  WS-Current-Period  pic x(10).\n     03  WS-Todate-Period   pic x(16).\n     03  WS-Total-Value     pic s9(9)v99 comp-3  value zero.\n     03  WS-Total-Add    binary-long             value zero.\n     03  WS-Total-Ded    binary-long             value zero.\n     03  WS-WIP-Total-Add binary-long            value zero.\n     03  WS-WIP-Total-Ded binary-long            value zero.\n     03  WS-Rec-Cnt      binary-long  unsigned   value zero.\n     03  WS-Page-Lines   binary-char  unsigned   value 56.   *> 16/12/24 as system is for Portrait.\n     03  Line-Cnt        binary-char  unsigned   value 99.\n     03  Page-Nos            pic 9(4)            value zero.\n     03  A               binary-char  unsigned   value zero.\n     03  B               binary-char  unsigned   value zero.\n     03  C               binary-char  unsigned   value zero.\n     03  R               binary-char  unsigned   value zero.\n     03  X               binary-char  unsigned   value zero.\n     03  Z               binary-char  unsigned   value zero.\n*>\n     03  WS-Lines        binary-char  unsigned   value zero.\n     03  WS-22-Lines     binary-char  unsigned   value zero.\n     03  WS-23-Lines     binary-char  unsigned   value zero.\n     03  WS-env-Lines        pic 999             value zero.\n*>\n 01  accept-terminator-array pic 9(4)            value zero.\n     copy \"screenio.cpy\".\n*>\n 01  WS-date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-date             pic x(10).\n     03  WS-UK redefines WS-date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  hdtime                            value spaces.\n     03  hd-hh               pic xx.\n     03  hd-mm               pic xx.\n     03  hd-ss               pic xx.\n     03  hd-uu               pic xx.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes      pic 9(18) comp.\n     05 Mod-DD               pic 9(2)  comp.\n     05 Mod-MO               pic 9(2)  comp.\n     05 Mod-YYYY             pic 9(4)  comp.\n     05 Mod-HH               pic 9(2)  comp.\n     05 Mod-MM               pic 9(2)  comp.\n     05 Mod-SS               pic 9(2)  comp.\n     05 filler               pic 9(2)  comp. *> Always 00\n*>\n*> Print layouts\n*>\n 01  Line-0a                 pic x(19) value \"Items ranging from \".\n 01  Line-0b                 pic x(9)  value \" through \".\n 01  Line-0C                 pic x(23) value \"Locations ranging from \".\n 01  Line-0D                 pic x(9)  value \" through \".\n*>\n 01  Line-0                  pic x(100)    value spaces.\n*>\n*>\n 01  Line-11.       *>  Valuation report\n     03  l11-Program         pic x(16)     value spaces.\n     03  filler              pic x(39)     value spaces.\n     03  l11-title           pic x(42)     value \"Stock Valuation Report\".\n     03  filler              pic x(27)     value spaces.\n     03  filler              pic x(5)      value \"Page \".\n     03  l11-Page            pic zz9.\n*>\n 01  Line-12.\n     03  l12-User            pic x(40).\n     03  filler              pic x(76)     value spaces.\n     03  l12-Date            pic x(10).\n     03  filler              pic x         value space.\n     03  L2-HH               pic xx        value spaces.\n     03  filler              pic x         value \":\".\n     03  L2-MM               pic xx        value spaces.\n*>\n 01  Line-13.        *> Valuation Report\n     03  filler              pic x(96)   value\n         \"<------- Stock ------>                                      Average       Replace     Stock     \".\n     03  l13-Lit-Wip         pic xxx     value \"WIP\".\n     03  filler              pic x(24)   value \"     Value in    Retail\".\n*>\n 01  Line-14.\n     03  filler              pic x(96)   value\n         \"Abrev    Number         Description                           Cost          Cost        Qty     \".\n     03  l14-Lit-WIP         pic xxx     value \"Qty\".\n     03  filler              pic x(24)   value \"     Stockroom    Price \".\n*>\n 01  Line-15.\n     03  l15-Abrev-Number    pic x(9).\n     03  l15-Stock-Number    pic x(15).          *> 24\n     03  l15-Desc            pic x(33).          *> 57\n     03  l15-Ave-Cost        pic zzzzz,zz9.9999. *> 71\n     03  filler redefines l15-Ave-Cost.\n         05  filler          pic x(12).\n         05  l15-blank-0     pic xx.\n     03  l15-Cost            pic zzzzz,zz9.99.   *> 83\n     03  l15-Qty             pic zzzz,zz9.          *> 91\n     03  l15-Wip             pic z(7)9.          *> 99\n     03  l15-Value           pic zzz,zzz,zz9.99. *> 113\n     03  l15-Retail          pic zzzzz,zz9.99.   *> 125\n*>\n 01  Line-16-Total. *> Total\n     03  filler              pic x(86)  value spaces.\n     03  filler              pic x(13)  value \"Total Value: \".\n     03  l16-Value           pic zzz,zzz,zz9.99.\n*>\n 01  Line-16-Over.\n     03  filler              pic x(99) value spaces.\n     03  filler              pic x(14) value all \"-\".\n*>\n 01  Line-16-Under.\n     03  filler              pic x(99) value spaces.\n     03  filler              pic x(14) value all \"=\".\n*>\n*>\n 01  Line-23.       *> Activity Report\n     03  filler              pic x(72)   value \"<------ Stock ------>                                  Current  Retail  \".\n     03  L23-Lit-Average     pic x(13)   value \" Average\".  *> or \"   Unit\" (cost)\n     03  L23-Lit-Val         pic x(9)    value \"  Stock \".\n     03  L23-Lit-Cur         pic x(19)   value \"<- Current Period >\".\n     03  L23-Lit-YTD         pic x(19)   value \"<- Year to Date -->\".\n*>\n 01  Line-24.\n     03  filler              pic x(86)  value \"Abrev     Number      Description                       Stock   Price      Cost\".\n     03  L24-Lit-Val         pic x(11)  value \"Value\".\n     03  filler              pic x(35)  value \"Add   Ded    Net   Add   Ded    Net\".\n*>\n 01  Line-25.\n     03  L25-Abrev-Number    pic x(8).\n     03  L25-Stock-Number    pic x(14).          *> 22\n     03  L25-Desc.\n         05  filler          pic x(28).\n         05  L25-Lit-Wip     pic x(5).           *> 55\n     03  L25-Qty             pic zzz,zz9.        *> 62\n     03  L25-Retail          pic zzz,zz9.99.     *> 72\n     03  L25-Ave-Cost        pic zzz,zz9.99.     *> 82\n     03  L25-ValueX.\n         05  L25-Value       pic zzzzz,zz9.99.   *> 94\n     03  L25-Cur-Add         pic z(5)9.          *> 100\n     03  L25-Cur-Ded         pic z(5)9.          *> 106\n     03  L25-Cur-Net         pic z(5)9-.         *> 113\n     03  L25-YTD-Add         pic z(5)9.          *> 119\n     03  L25-YTD-Ded         pic z(5)9.          *> 125\n     03  L25-YTD-Net         pic z(5)9-.         *> 132\n*>\n 01  Line-25B redefines Line-25.\n     03  filler              pic x(77).\n     03  L25b-Lit-Wip        pic x(17).  *> \"Work In Progress:\"\n     03  filler              pic x(38).\n*>\n*>\n 01  Line-33.           *> ReOrder Report\n     03  filler              pic x(132)   value\n         \"<------ Stock ------>                                     Supp    Stock \" &\n         \"< ReOrder >  Unit     On   <------- Date ------>    Bk   WIP\".\n*>\n 01  Line-34.\n     03  filler              pic x(132)  value\n         \"Abrev     Number     Flg Description                      Number   Qty  \" &\n         \"  Pnt   Qty  Cost    Order  Ordered      Due       Ord   Qty\".\n*>\n 01  Line-35.\n     03  L35-Abrev-Number    pic x(8).\n     03  L35-Stock-Number    pic x(14).          *> 22\n     03  L35-Flag            pic x.\n     03  filler              pic xx.             *> 25\n     03  L35-Desc            pic x(33).          *> 58\n     03  L35-Supplier        pic x(7).           *> 65\n     03  L35-Qty             pic z(5)9.          *> 71\n     03  L35-ReOrder-Pnt     pic z(5)9.          *> 77\n     03  L35-Std-Reorder     pic z(5)9.          *> 83\n     03  L35-Cost            pic z(5)9.99.       *> 92\n     03  L35-On-Order        pic z(5)9b.         *> 99\n     03  L35-Order-Date      pic x(11).\n     03  L35-Order-Due       pic x(10).          *> 120\n     03  L35-Back-Ordered    pic z(5)9.          *> 126\n     03  L35-WIP             pic z(6).           *> 132\n*>\n*>\n 01  line-43.             *> Stock Report  (as in st010 but with range facility) - OPTIONS 4 & 5\n     03  filler              pic x(132)  value\n         \"<------ Stock ------> Supplier  Location     Unit      Unit        Value \" &\n         \"   Number <- ReOrder -> <------- Date ------>  Quantity On\".\n*>\n 01  line-44.\n     03  filler              pic x(132)  value\n         \"Abrev   Number         Number               Price      Cost        in Stk\" &\n         \"   in Stk  Point    Qty   Ordered     Due      Order  B/Ord\".\n*>\n 01  line-45.\n     03  l45-Abrev-Stock     pic x(8).\n     03  l45-Stock-Number    pic x(14).\n     03  l45-Supplier-No     pic x(8).           *> 30\n     03  l45-Location        pic x(11).          *> 41\n     03  l45-Retail          pic z(6)9.99.       *> 51\n     03  l45-Cost            pic z(6)9.9999.     *> 63\n     03  l45-Costx redefines l45-Cost.  *> helps to clear fraction of a penny/cent when zero\n         05  filler          pic x(10).\n         05  l45-Costz       pic xx.\n     03  l45-Value           pic zzzzz,zz9.99.   *> 75\n     03  l45-Held            pic z(6)9.          *> 82\n     03  l45-Reord-Pnt       pic z(6)9.          *> 89\n     03  l45-Reord-Qty       pic z(6)9b.         *> 97\n     03  l45-Date-Ordered    pic x(11).          *> 108\n     03  l45-Date-Due        pic x(10).          *> 118\n     03  l45-Qty-Ordered     pic z(6)9.          *> 125\n     03  l45-Qty-Back-Ord    pic z(6)9.          *> 132\n*>\n 01  line-46.\n     03  filler              pic x(5)   value spaces.\n     03  filler              pic x(13)  value \"Description: \".\n     03  l46-Desc            pic x(32)  value spaces.\n     03  filler              pic x(5)   value spaces.\n     03  l46-vars            pic x(77).\n*>\n*>\n 01  Line-61.           *>  Report By Desc EB00\n     03  filler              pic x(88)  value \"Description                       Abrev    Number             Price      \" &\n                                           \" Cost     Held\".\n*>\n 01  Line-62.\n     03  L62-Description     pic x(32)BB.        *> 34\n     03  L62-Abrev           pic x(7)BB.         *> 43\n     03  L62-Stock-Number    pic x(13)BB.        *> 58\n     03  L62-Retail          pic z(6)9.99B.      *> 69\n     03  L62-Cost            pic z(6)9.9999B.    *> 82\n     03  L62-Held            pic z(4)9        blank when zero.       *> 87\n     03  filler              pic x(5).           *> 92\n     03  L62-Service         pic x(25).          *> 117\n*>\n*>\n 01  Line-63.             *> History Report\n     03  filler              pic x(132)  value \"<------ Stock ------>\" &\n         \" Description          This <----------------------------- History for the\" &\n         \" Year ------------------------------->\".\n*>\n 01  Line-64.\n     03  filler              pic x(41)  value \"Abrev   Number        \".\n     03  L64-Lit-Period      pic x(07)  value \"Quarter\".  *> | \" Month \" | \" Week  \"\n*>\n 01  Line-65.\n     03  L65-Abrev-Stock     pic x(8).\n     03  L65-Stock-Number    pic x(14).              *> 22\n     03  L65-Desc.\n         05  filler          pic x(14).\n         05  L65-Lit-Wip     pic x(4).\n     03  filler              pic x.                  *> 41\n     03  L65-This-Period     pic -(6)9.              *> (7)      48\n     03  L65-This-Year       pic -(6)9   occurs 12.  *> (84)     132\n*>\n*>\n 01  Line-71.     *> Location Report\n     03  filler              pic x(96) value \"  Location  Stock Number   Abrev    Description                       \" &\n                                            \"Qty Held  Qty Diff.\".\n*>\n 01  Line-72.\n     03  L72-Location        pic x(10)BB.        *> 12\n     03  L72-Stock-Number    pic x(13)BB.        *> 27\n     03  L72-Abrev-Stock     pic x(7)BB.         *> 36\n     03  L72-Desc            pic x(32)BB.        *> 70\n     03  L72-Held            pic z(5)9BB.        *> 78\n     03  L72-Held-Diff       pic x(18)  value spaces. *> 96\n     *>                                  To be filled in, if different with - sign\n     *>                                 - if less than printed quantity\n*>\n*>\n copy \"wsstock.cob\".     *> 3.02\n copy \"wsfnctn.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsmaps09.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at ZZ080-ACAS-Calls\n*>     03  System-Record          pic x.\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*>  System wide\n     03  ST006               pic x(30) value \"ST006 Press return to continue\".\n*> Module specific\n     03  ST300               pic x(32) value \"ST300 Stock File not yet created\".\n     03  ST301               pic x(26) value \"ST301 Stock File not found\".\n                                            *> should not happen as ST300 shown and prog exits - JIC\n     03  ST302               pic x(60) value \"ST302 There were no Stock numbers within the specified range\".\n     03  ST303               pic x(66) value \"ST303 There were no Abrev Stock numbers within the specified range\".\n     03  ST304               pic x(53) value \"ST304 You cannot specify both Stock AND Abrev numbers\".\n     03  ST305               pic x(42) value \"ST305 Abbreviated Stock number not present\".\n     03  ST306               pic x(28) value \"ST306 Stock Number not found\".\n     03  ST307               pic x(43) value \"ST307 Stock From MUST be less than Stock To\".\n     03  ST308               pic x(43) value \"ST308 Abrev From MUST be less than Abrev To\".\n     03  ST309               pic x(49) value \"ST309 Location Ignored Count must be less than 9\".\n     03  ST310               pic x(30) value \"ST310 Stock Location not found\".\n     03  ST311               pic x(56) value \"ST311 There were no locations within the specified range\".\n     03  ST313               pic x(23) value \"ST313 Bad month in date\".\n*>\n linkage section.\n*>***************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n 01  To-Day             pic x(10).\n*>\n Screen Section.\n*>*************\n*>\n 01  display-01                  background-color cob-color-black  *> ReOrder Rep\n                                 foreground-color cob-color-green.\n     03  from Prog-Name          pic x(15)          line  1 col  1 blank screen.\n     03  from Report-Name        pic x(28)                  col 26.\n     03  from WS-Conv-Date       pic x(10)                  col 71.\n     03  value \"Report Attributes\"                  line  3 col 32.\n     03  value \"Select an Report Option Number : [\" line  5 col  1.\n     03  using WS-Reply          pic 9                      col 35.\n     03  value \"]\"                                          col 36.\n     03  value \"(1)   All Stock Items\"              line  7 col 10.\n     03  value \"(2)   A Range of Items\"             line  8 col 10.\n     03  value \"(3)   Items that are Understocked\"  line  9 col 10.\n     03  value \"(4)   Range of Understocked Items\"  line 10 col 10.\n     03  value \"(5)   Items, Not in Stock\"          line 11 col 10.\n     03  value \"(6)   Range of Items, Not in Stock \"\n                                                    line 12 col 10.\n     03  value \"(7)   Items on Order\"               line 13 col 10.\n     03  value \"(8)   Range of Items on Order\"      line 14 col 10.\n     03  value \"(9)   Return to Main Menu\"          line 16 col 10.\n*>\n 01  display-02                  background-color cob-color-black  *> Activity Rep\n                                 foreground-color cob-color-green.\n     03  from Prog-Name          pic x(15)          line  1 col  1 blank screen.\n     03  from Report-Name        pic x(28)                  col 26.\n     03  from WS-Conv-Date       pic x(10)                  col 71.\n     03  value \"Report Attributes\"                  line  3 col 32.\n     03  value \"Select an Report Option Number : [\" line  5 col  1.\n     03  using WS-Reply      pic 9                          col 35.\n     03  value \"]\"                                          col 36.\n     03  value \"(1)   All Stock Items\"              line  7 col 10.\n     03  value \"(2)   Range of Items\"               line  8 col 10.\n     03  value \"(3)   Items Active in current \"     line  9 col 10.\n     03  from WS-Current-Period pic x(10)                   col 40.\n     03  value \"(4)   Items Active in \"             line 10 col 10.\n     03  from WS-Todate-Period  pic x(16)                   col 32.\n     03  value \"(5)   Range of active Items in Current \"\n                                                    line 11 col 10.\n     03  from WS-Current-Period pic x(10)                   col 49.\n     03  value \"(6)   Range of active Items in \"    line 12 col 10.\n     03  from WS-Todate-Period  pic x(16)                   col 41.\n     03  value \"(9)   Return to Main Menu\"          line 14 col 10.\n*>\n 01  display-03                  background-color cob-color-black  *> Valuation Rep\n                                 foreground-color cob-color-green.\n     03  from Prog-Name      pic x(15)              line  1 col  1 blank screen.\n     03  from Report-Name    pic x(28)                      col 26.\n     03  from WS-Conv-Date   pic x(10)                      col 71.\n     03  value \"Report Attributes\"                  line  3 col 32.\n     03  value \"Leave fields blank to select All\"   line  5 col 24 highlight.\n     03  value \"Select Stock no. or Abrev Stock no. but NOT both\"\n                                                    line  6 col 17 highlight.\n     03  value \"From Stock Number - [\"              line  8 col  4.\n     03  using WS-Stock-From pic x(13)                      col 25.\n     03  value \"]\"                                          col 38.\n     03  value \"Enter characters in positions to match\"     col 41.\n     03  value \"  To Stock Number - [\"              line  9 col  4.\n     03  using WS-Stock-To   pic x(13)                      col 25.\n     03  value \"]\"                                          col 38.\n     03  value \"Enter characters in positions to match\"     col 41.\n     03  value \"OR\"                                 line 10 col 14 highlight.\n     03  value \"From Abrev Number - [\"              line 11 col  4.\n     03  using WS-Abrev-From pic x(7)                       col 25.\n     03  value \"]\"                                          col 32.\n     03  value \"Enter characters in positions to match\"     col 41.\n     03  value \"  To Abrev Number - [\"              line 12 col  4.\n     03  using WS-Abrev-To   pic x(7)                       col 25.\n     03  value \"]\"                                          col 32.\n     03  value \"Enter characters in positions to match\"     col 41.\n*>\n*> New 26/1/25 .31\n*>\n 01  display-04                  background-color cob-color-black  *> Location Rep\n                                 foreground-color cob-color-green.\n     03  from Prog-Name      pic x(15)              line  1 col  1 blank screen.\n     03  from Report-Name    pic x(28)                      col 26.\n     03  from WS-Conv-Date   pic x(10)                      col 71.\n     03  value \"Report Attributes\"                  line  3 col 32.\n     03  value \"Leave these two fields blank, to select All\"\n                                                    line  5 col 24 highlight.\n *>\n     03  value \"From Location - [\"                  line  8 col  4.\n     03  using WS-Location-Frm pic x(10)                    col 21.\n     03  value \"]\"                                          col 31.\n     03  value \"Enter characters in positions to match\"     col 41.\n     03  value \"  To Location - [\"                  line  9 col  4.\n     03  using WS-Location-To  pic x(10)                    col 21.\n     03  value \"]\"                                          col 31.\n     03  value \"Enter characters in positions to match\"     col 41.\n     03  value \"OR\"                                 line 10 col 14 highlight.\n     03  value \"Fixed characters to Ignore - [\"     line 11 col  4.\n     03  using WS-Location-Not-Ignored   pic 9              col 34.\n     03  value \"]\"                                          col 35.\n     03  value \"First chars in pos for Page Break\"          col 41.\n*>\n     03  value \"Count must be between 0 to 9 & 0 will ignore ANY differences, No page breaks\"\n                                                    line 13 col 1.\n     03  value \"A change in these positions will force a new page\"\n                                                    line 15 col 4.\n     03  value \"Are you using double sided prints - [\"\n                                                    line 17 col 1.\n     03  using WS-Double-Sided-Prt   pic x                  col 38.\n     03  value \"] {Y/N}\"                                    col 39.\n     03  value \"(Y will force a New Page when page count is odd number)\"\n                                                    line 19 col 10.\n*>\n procedure  division using WS-calling-data\n                           system-record\n                           to-day\n                           file-defs.\n*>****************************************\n*>\n AA000-Core                 section.\n*>*********************************\n*>\n     accept   WS-env-Lines from lines.\n     if       WS-env-Lines < 24\n              move  24 to WS-env-Lines WS-Lines\n     else\n              move  WS-env-Lines to WS-Lines\n     end-if\n     subtract 1 from WS-Lines giving WS-23-Lines.\n     subtract 2 from WS-Lines giving WS-22-Lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n*> Get current date into locale format for display and printing\n*>\n     perform  ZZ070-Convert-Date.\n     move     WS-Date to WS-Conv-Date.\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to L2-HH\n              move hd-mm to L2-MM.\n*>\n*> Set up period descriptives for screen and reports\n*>\n     move     spaces to WS-Current-Period\n                        WS-Todate-Period.\n*>\n     if       Stk-Period-Cur = \"Q\"\n              move \"Quarter\" to WS-Current-Period\n                                L64-Lit-Period\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"Week\" to WS-Current-Period\n              move \"   Week\" to L64-Lit-Period\n      else\n              move \"  Month\" to L64-Lit-Period\n              move \"Month\" to WS-Current-Period.\n*>\n     if       Stk-Period-dat = \"M\"\n              move \"Month To Date\" to WS-Todate-Period\n     else\n      if      Stk-Period-dat = \"Q\"\n              move \"Quarter To Date\" to WS-Todate-Period\n      else\n              move \"Year To Date\" to WS-Todate-Period.\n*>\n*> New for RDB\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-11  *> Stock file\n                                                 File-Info\n              end-call\n              if    return-code not = zero          *> not = zero - No file found\n                    display ST300 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                    display ST006   at line WS-Lines col 01\n                    accept WS-Reply at line WS-Lines col 32\n                    go to aa999-Exit\n              end-if\n     end-if\n*>\n     perform  Stock-Open.\n     if       FS-Reply not = zero\n              display ST301 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display FS-Reply at line WS-23-Lines col 28 with foreground-color 2 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              perform Stock-Close\n              go to aa999-Exit.\n     move     zero to Menu-Reply.\n     perform  Stock-Close.    *> open and close prior to each proc incase Start not used)\n*>\n*> Good, we now know the stock file exists\n*>\n AA010-Display-Headings.\n *>\n *> First time used will use Reports Menu option\n *>\n     move     zero to Page-Nos.\n     move     99 to Line-Cnt.\n     if       Menu-Reply = 1\n              move \"Stock Valuation Report\"       to Report-Name\n     else\n      if      Menu-Reply = 2\n              move \"Stock Activity Report \"       to Report-Name\n      else\n       if     Menu-Reply = 3\n              move \"Stock Re-Order Report \"       to Report-Name\n       else\n        if    Menu-Reply = 4\n              move \" Stock History Report \"       to Report-Name\n        else\n         if   Menu-Reply = 5\n              move \"     Stock Report     \"       to Report-Name\n         else\n          if  Menu-Reply = 6\n              move \"Stock Report by Description\"  to Report-Name\n          else\n           if Menu-Reply = 7    *> New 26/01/25\n              move \"Stock Report by Location\"     to Report-Name\n           else\n              move \"Stock Control - Reports Menu\" to Report-Name.\n*>\n AA020-Display-Heads.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     if       Menu-Reply = zero\n              display  Report-Name at 0127 with foreground-color 2\n     else\n              display  Report-Name at 0130 with foreground-color 2.\n     display  WS-Conv-Date at 0171 with foreground-color 2.\n*>\n AA030-DH-End.\n     move     to-day to WS-Date.\n     move     WS-Month to WS-Proc-Month.\n     if       WS-Proc-Month not numeric or not WS-Good-Month\n              display ST313 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display WS-Proc-Month at line WS-23-Lines col 25 with foreground-color 2 highlight\n              display WS-Date at line WS-23-Lines col 28 with foreground-color 2 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              go to aa999-Exit.\n*>\n aa100-Main-Menu.\n     display  \"Select one of the following by number :- [ ]\" at 0401 with foreground-color 2\n                                                                          erase eos.\n*>\n     display  \"(1)  Valuation Report\"            at 0604 with foreground-color 2.\n     display  \"(2)  Activity Report\"             at 0704 with foreground-color 2.\n     display  \"(3)  Re-Order Report\"             at 0804 with foreground-color 2.\n     display  \"(4)  Stock History Report\"        at 0904 with foreground-color 2.\n     display  \"(5)  Stock Report\"                at 1004 with foreground-color 2.\n     display  \"(6)  Stock Report by Description\" at 1104 with foreground-color 2.\n     display  \"(7)  Stock Report by Location\"    at 1204 with foreground-color 2.\n     display  \"(9)  Return to System Menu\"       at 1404 with foreground-color 2.\n*>\n aa110-Accept-Loop.\n     move     zero to Menu-Reply.\n     accept   Menu-Reply at 0443  with foreground-color 6 auto update.\n     if       Menu-Reply = 9\n              go to aa999-Exit.\n     perform  AA010-Display-Headings.\n     if       Menu-Reply not = 6\n              perform  ZZ050-Report-Selection.\n*> check if quit at level 1\n *>    if       WS-Reply = 9\n *>             go to AA020-Display-Heads.\n     if       not Menu-Level-1-Valid-Options  *>  Menu-Reply = 9 OR (not > zero and < 8)\n              go to aa110-Accept-Loop.\n*>\n     display  space at line WS-23-Lines col 1 with erase eol.\n     perform  Stock-Open-Input.\n*>\n     open     output Print-File.\n     evaluate Menu-Reply\n              when     1\n                       perform  BA000-Process-Valuations\n              when     2\n                       perform  CA000-Process-Activity\n              when     3\n                       perform  DA000-Process-ReOrder\n              when     4\n                       perform  FA000-Process-History\n              when     5\n                       perform  EA000-Process-Stock-Lists\n              when     6\n                       perform  EB000-Process-Stock-Desc\n              when     7\n                       perform  GA000-Process-Location\n              when     other\n                       move     zero to Menu-Reply\n                       go       to AA010-Display-Headings\n     end-evaluate.\n     close    Print-File.\n     perform  Stock-Close.\n     if       Page-Nos not = zero   *> Don't print blank file\n              call  \"SYSTEM\" using Print-Report.\n     move     zero to Menu-Reply.\n     go       to AA010-Display-Headings.  *> Might want other reports\n*>\n maps04.\n     call     \"maps04\" using maps03-ws.\n*>\n aa999-Exit.\n     exit     program.\n*>\n*>***********************************************\n*>                  Routines                    *\n*>***********************************************\n*>\n BA000-Process-Valuations section.\n*>*******************************\n*>\n     if       WS-Abrev-To not = spaces\n              perform varying a from 7 by -1 until a < 2 or WS-Abrev-To (a:1) not = space\n                      move \"z\" to WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move   1 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n              if    FS-Reply = 21\n                    display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                    display ST006   at line WS-Lines col 01\n                    accept WS-Reply at line WS-Lines col 32\n                    move zero to Access-Type\n                    go to ba999-Exit\n              end-if\n     end-if.\n*>\n     if       WS-Abrev-From not = spaces\n              move WS-Abrev-From to WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move   2 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n              if    FS-Reply = 21\n                    display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                    display ST006   at line WS-Lines col 01\n                    accept WS-Reply at line WS-Lines col 32\n                    move zero to Access-Type\n                    go to ba999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move   2 to File-Key-No\n              set   fn-not-less-than to true     *> Access-Type = 8\n              perform Stock-Start\n     end-if\n     move     zero to Access-Type.\n     move     zero to WS-Total-Value.\n     move     spaces to line-15.\n*>\n BA010-Read-Rec.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to BA030-Finish-Report.\n*>\n*> next 2 in case start does not work and its a partial list and before from keys\n*>\n     if       WS-Stock-From not = spaces\n         and  WS-Stock-From > WS-Stock-Key\n              go to BA010-Read-Rec.\n     if       WS-Abrev-From not = spaces\n         and  WS-Abrev-From > WS-Stock-Abrev-Key\n              go to BA010-Read-Rec.\n*>\n     if       Stock-Services-Flag = \"Y\"     *> IGNORE services\n              go to BA010-Read-Rec.\n*>\n*> next 2 if partial list and past the to keys\n*>\n     if       WS-Stock-To not = spaces\n         and  WS-Stock-Key > WS-Stock-To\n              go to BA030-Finish-Report.\n*>\n     if       WS-Abrev-To not = spaces\n         and  WS-Stock-Abrev-Key > WS-Abrev-To\n              go to BA030-Finish-Report.\n*>\n*> Now we can deal with printing the record\n*>\n BA020-Print-Rec.\n     perform  ZZ010-Print-Heads.\n     move     WS-Stock-Abrev-Key to l15-Abrev-Number.\n     move     WS-Stock-Key       to l15-Stock-Number.\n     move     WS-Stock-Desc      to l15-Desc.\n     move     Stock-Last-Actual-Cost to l15-Cost.\n     move     Stock-Cost      to l15-Ave-Cost.\n     move     Stock-Held      to l15-Qty.\n     move     Stock-Value     to l15-Value.\n     move     Stock-Retail    to l15-Retail.\n     if       l15-Blank-0 = \"00\"\n              move spaces to l15-Blank-0\n     end-if\n     if       Stk-Manu-Used = 1\n              move Stock-Work-in-Progress to l15-Wip\n     end-if\n     write    Print-Record from Line-15 after 1.\n     add      Stock-Value to WS-Total-Value.\n     add      1 to Line-Cnt.\n     go       to BA010-Read-Rec.\n*>\n BA030-Finish-Report.\n*>\n*> On current page. Enough extra lines for total and if Partial report,\n*>      extra 2 lines for from/to line\n*>\n     if       Page-Nos = zero\n        and   (spaces not = WS-Stock-From or not = WS-Stock-To)\n              display ST302 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to ba999-Exit.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Abrev-From or not = WS-Abrev-To)\n              display ST303 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to ba999-Exit.\n*>\n     if       Line-Cnt > WS-Page-Lines - 4\n              move 99 to Line-Cnt\n              perform ZZ010-Print-Heads.\n*>\n     move     WS-Total-Value to l16-Value.\n     write    Print-Record from Line-16-Over after 2.\n     write    Print-Record from Line-16-Total after 1.\n     write    Print-Record from Line-16-Under after 1.\n*>\n ba999-Exit.\n     exit     section.\n*>\n CA000-Process-Activity section.\n*>*****************************\n*>\n     if       WS-Abrev-To not = spaces\n              perform varying a from 7 by -1 until a < 2 or WS-Abrev-To (a:1) not = space\n                      move \"z\" to WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     move     spaces to line-25.\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              if      FS-Reply = 21                *> invalid key\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ca999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move    WS-Abrev-From to WS-Stock-Abrev-Key\n              if      WS-Stock-Abrev-Key (7:1) = space\n                      move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              if      FS-Reply = 21                *> invalid key\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 30\n                      go to ca999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n     end-if.\n     move     zero to Access-Type.\n*>\n CA010-Read-Rec.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to CA030-Finish-Report.\n*>\n     if       WS-Reply = 1\n              go to CA020-Print-Rec.\n*>\n*> next 2 in case start does not work and its a partial list and before from keys\n*>\n     if       WS-Stock-From not = spaces\n         and  WS-Stock-From > WS-Stock-Key\n              go to CA010-Read-Rec.\n     if       WS-Abrev-From not = spaces\n         and  WS-Abrev-From > WS-Stock-Abrev-Key\n              go to CA010-Read-Rec.\n*>\n*> now for other report variations\n*>\n     if       WS-Reply = 3 or 5  *> Activity in current period\n         and  zero = Stock-Adds and Stock-Deducts and Stock-Wip-Adds and Stock-Wip-Deds\n              go to CA010-Read-Rec.\n*>\n     move     zero to WS-Total-Add WS-Total-Ded.\n     move     zero to WS-WIP-Total-Add WS-WIP-Total-Ded.\n     perform  varying a from 1 by 1 until a > 12\n              add  Stock-TD-Adds (a)      to WS-Total-Add\n              add  Stock-TD-Deds (a)      to WS-Total-Ded\n              add  Stock-TD-Wip-Adds (a)  to WS-WIP-Total-Add\n              add  Stock-TD-Wip-Deds (a)  to WS-WIP-Total-Ded\n     end-perform\n*>\n     if       WS-Reply = 4 or 6  *> Activity in period to date\n         and  zero = WS-Total-Add and WS-Total-Ded and WS-WIP-Total-Add and WS-WIP-Total-Ded\n              go to CA010-Read-Rec.\n*>\n*> next 2 if partial list and past the to keys\n*>\n     if       WS-Stock-To not = spaces\n         and  WS-Stock-Key > WS-Stock-To\n              go to CA030-Finish-Report.\n*>\n     if       WS-Abrev-To not = spaces\n         and  WS-Stock-Abrev-Key > WS-Abrev-To\n              go to CA030-Finish-Report.\n*>\n CA020-Print-Rec.\n*>\n*> Now we can deal with printing the record\n*>\n     perform  ZZ020-Print-Heads.\n     move     WS-Stock-Abrev-Key           to L25-Abrev-Number.\n     move     WS-Stock-Key                 to L25-Stock-Number.\n     move     WS-Stock-Desc                to L25-Desc.\n     if       Stock-Averaging\n              move  Stock-Cost             to L25-Ave-Cost\n              move  Stock-Value            to L25-Value\n     else\n              move  spaces                 to L25-ValueX\n              move  Stock-Last-Actual-Cost to L25-Ave-Cost\n     end-if\n     move     Stock-Held                   to L25-Qty.\n     move     Stock-Retail                 to L25-Retail.\n     move     Stock-Adds                   to L25-Cur-Add.\n     move     Stock-Deducts                to L25-Cur-Ded.\n     subtract Stock-Deducts from Stock-Adds giving L25-Cur-Net.\n*>\n     move     WS-Total-Add                 to L25-YTD-Add.\n     move     WS-Total-Ded                 to L25-YTD-Ded.\n     subtract WS-Total-Ded from WS-Total-Add giving L25-YTD-Net.\n     write    Print-Record from Line-25 after 1.\n     add      1 to Line-Cnt.\n     if       Stk-Manu-Used = 1\n         and  (Stock-Work-in-Progress not = zero\n          or  Stock-Wip-Adds not = zero or Stock-Wip-Deds not = zero\n          or  WS-WIP-Total-Add not = zero or WS-WIP-Total-Ded not = zero)\n              move spaces to line-25\n              move \"Work in Progress:\"    to L25b-Lit-Wip\n              move Stock-Work-in-Progress to L25-Qty\n              move \"WIP:\"                 to L25-Lit-Wip\n              move Stock-Wip-Adds         to L25-Cur-Add\n              move Stock-Wip-Deds         to L25-Cur-Ded\n              subtract Stock-Wip-Deds from Stock-Wip-Adds giving L25-Cur-Net\n              move WS-WIP-Total-Add       to L25-YTD-Add\n              move WS-WIP-Total-Ded       to L25-YTD-Ded\n              subtract WS-WIP-Total-Ded from WS-WIP-Total-Add giving L25-YTD-Net\n              write Print-Record from Line-25 after 1\n              add  1 to Line-Cnt\n     end-if\n     go       to CA010-Read-Rec.\n*>\n CA030-Finish-Report.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Stock-From or not = WS-Stock-To)\n              display ST302 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to ca999-Exit.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Abrev-From or not = WS-Abrev-To)\n              display ST303 at line WS-23-Lines col 1 with foreground-color 4 highlight.\n*>\n ca999-Exit.\n     exit     section.\n*>\n DA000-Process-ReOrder section.\n*>****************************\n*>\n     if       WS-Abrev-To not = spaces\n              perform varying a from 7 by -1 until a < 2 or WS-Abrev-To (a:1) not = space\n                      move \"z\" to WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     move     spaces to line-35.\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 30\n                      go to da999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move WS-Abrev-From to WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to da999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              move     zero to Access-Type\n     end-if.\n*>\n DA010-Read-Rec.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to DA030-Finish-Report.\n*>\n     if       WS-Reply = 1        *>  All items\n              go to DA020-Print-Rec.\n     if       Stock-Services-Flag = \"Y\"     *> ignore 'services' records\n              go to DA010-Read-Rec.\n*>\n*> next 2 in case start does not work and its a partial list and before from keys\n*>\n     if       WS-Stock-From not = spaces\n         and  WS-Stock-From > WS-Stock-Key\n              go to DA010-Read-Rec.\n     if       WS-Abrev-From not = spaces\n         and  WS-Abrev-From > WS-Stock-Abrev-Key\n              go to DA010-Read-Rec.\n*>\n*> now for other report variations\n*>\n     if       WS-Reply = 2          *> all items in range\n              go to DA013-End-Range-Test.\n*>\n     if       (WS-Reply = 3 or 4)  *> Understocked\n         and  (Stock-ReOrder-Pnt < Stock-Held)\n              go to DA010-Read-Rec.\n*>\n     if       (WS-Reply = 5 or 6)  *> no Stock\n         and  (Stock-Held not = zero)\n              go to DA010-Read-Rec.\n*>\n     if       (WS-Reply = 7 or 8)  *> On Order\n         and  (Stock-On-Order = zero\n         and  Stock-Back-Ordered = zero\n         and  Stock-Order-Date = zero\n         and  Stock-Order-Due  = zero)\n              go to DA010-Read-Rec.\n*>\n*> Record passed specific tests, so can be included in report subject to next one\n*>\n DA013-End-Range-Test.\n*>\n*> next 2 if partial list and past the to keys\n*>\n     if       WS-Stock-To not = spaces\n         and  WS-Stock-Key > WS-Stock-To\n              go to DA030-Finish-Report.\n*>\n     if       WS-Abrev-To not = spaces\n         and  WS-Stock-Abrev-Key > WS-Abrev-To\n              go to DA030-Finish-Report.\n*>\n DA020-Print-Rec.\n*>\n*> Now we can deal with printing the record for all within scope\n*>\n     perform  ZZ030-Print-Heads.\n     move     WS-Stock-Abrev-Key              to L35-Abrev-Number.\n     move     WS-Stock-Key                    to L35-Stock-Number.\n     move     WS-Stock-Desc                   to L35-Desc.\n     move     space                           to L35-Flag.\n     if       Stock-Held = zero\n              move \"O\" to L35-Flag\n     else\n      if      Stock-Held < Stock-ReOrder-Pnt\n              move \"U\" to L35-Flag.\n*>\n     if       Stock-Services-Flag = \"Y\"\n              move space to L35-Flag.\n*>\n     if       Stock-Averaging\n              move  Stock-Cost             to L35-Cost\n     else\n              move  Stock-Last-Actual-Cost to L35-Cost\n     end-if\n     move     Stock-Held                   to L35-Qty.\n     move     Stock-Supplier-P1            to L35-Supplier.\n     move     Stock-ReOrder-Pnt            to L35-ReOrder-Pnt.\n     move     Stock-Std-ReOrder            to L35-Std-ReOrder.\n     move     Stock-On-Order               to L35-On-Order.\n     move     Stock-Back-Ordered           to L35-Back-Ordered.\n     if       Stk-Manu-Used = 1\n              move Stock-Work-in-Progress  to L35-WIP\n     end-if\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to L35-Order-Date\n     else\n              move spaces to L35-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to L35-Order-Due\n     else\n              move spaces to L35-Order-Due\n     end-if\n     write    Print-Record from Line-35 after 1.\n     add      1 to Line-Cnt.\n     go       to DA010-Read-Rec.\n*>\n DA030-Finish-Report.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Stock-From or not = WS-Stock-To)\n              display ST302 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to da999-Exit.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Abrev-From or not = WS-Abrev-To)\n              display ST303 at line WS-23-Lines col 1 with foreground-color 4 highlight.\n*>\n da999-Exit.\n     exit     section.\n*>\n EA000-Process-Stock-Lists section.\n*>********************************\n*>\n     if       WS-Abrev-To not = spaces\n              perform varying a from 7 by -1 until a < 2 or WS-Abrev-To (a:1) not = space\n                      move \"z\" to WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move WS-Stock-From to WS-Stock-Key\n              move    1 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ea999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move WS-Abrev-From to WS-Stock-Abrev-Key\n              if   WS-Stock-Abrev-Key (7:1) = space\n                   move 0 to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move    2 to File-Key-No\n              set     fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform Stock-Start\n              if      FS-Reply = 21\n                      display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                      display ST006   at line WS-Lines col 01\n                      accept WS-Reply at line WS-Lines col 32\n                      go to ea999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move  zeros to WS-Stock-Abrev-Key\n              move    2 to File-Key-No\n              set     fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform Stock-Start\n              move     zero to Access-Type\n     end-if\n     move     spaces to line-45.\n     move     zero to WS-Rec-Cnt.\n*>\n EA010-Read-Rec.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to EA030-Totals.\n*>\n*> next 2 in case start does not work and its a partial list and before from keys\n*>\n     if       WS-Stock-From not = spaces\n         and  WS-Stock-From > WS-Stock-Key\n              go to EA010-Read-Rec.\n     if       WS-Abrev-From not = spaces\n         and  WS-Abrev-From > WS-Stock-Abrev-Key\n              go to EA010-Read-Rec.\n*>\n*> next 2 if partial list and past the to keys\n*>\n     if       WS-Stock-To not = spaces\n         and  WS-Stock-Key > WS-Stock-To\n              go to EA030-Totals.\n*>\n     if       WS-Abrev-To not = spaces\n         and  WS-Stock-Abrev-Key > WS-Abrev-To\n              go to EA030-Totals.\n*>\n*> Now we can deal with printing the record\n*>\n EA020-Print-Rec.\n     perform  ZZ040-Print-Heads.\n     add      1 to WS-Rec-Cnt.\n     move     spaces to line-45.\n     move     WS-Stock-Key          to l45-Stock-Number.\n     move     WS-Stock-Abrev-Key    to l45-Abrev-Stock.\n     move     Stock-Supplier-P1  to l45-Supplier-No.\n     move     Stock-Retail       to l45-Retail.\n     move     Stock-Cost         to l45-Cost.\n     if       l45-Costz = \"00\"\n              move spaces to l45-Costz\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n              move  Stock-Value        to l45-Value\n              move  Stock-Held         to l45-Held\n              move  Stock-ReOrder-Pnt  to l45-Reord-Pnt\n              move  Stock-Std-ReOrder  to l45-Reord-Qty\n              move  Stock-On-Order     to l45-Qty-Ordered\n              move  Stock-Back-Ordered to l45-Qty-Back-Ord\n     end-if\n     move     WS-Stock-Location        to l45-Location.\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to l45-Date-Ordered\n     else\n              move spaces to l45-Date-Ordered\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform ZZ060-Convert-Date\n              move WS-date to l45-Date-Due\n     else\n              move spaces to l45-Date-Due\n     end-if\n     move     WS-Stock-Desc to l46-Desc.\n     move     1 to a.\n     move     spaces to l46-vars.\n     if       Stock-Supplier-P2 not = spaces\n           or Stock-Supplier-P3 not = spaces\n              string \"Secondary Suppliers\" delimited by size into l46-vars pointer a\n              if Stock-Supplier-P2 not = spaces\n                  string \" 1: \"            delimited by size\n                         Stock-Supplier-P2 delimited by size into l46-vars pointer a\n              end-if\n              if Stock-Supplier-P3 not = spaces\n                  string \" 2: \"            delimited by size\n                         Stock-Supplier-P3 delimited by size into l46-vars pointer a\n              end-if\n              add 2 to a\n     end-if\n     if       Stock-SA-Code not = spaces\n              string \"SA Code: \"           delimited by size\n                     Stock-SA-Group        delimited by size into l46-vars pointer a\n              add 2 to a\n     end-if\n     if       Stock-PA-Code not = spaces\n              string \"PA Code: \"           delimited by size\n                     Stock-PA-Group        delimited by size into l46-vars pointer a\n     end-if\n*>\n     if       Stock-Pre-Sales not = zero\n              move Stock-Pre-Sales to WS-z6\n              string \"  Pre Sales :\"       delimited by size\n                     WS-z6                 delimited by size into l46-vars pointer a\n     end-if\n     if       Line-Cnt > 6\n              move all \"-\" to Print-Record\n              write Print-Record after 1\n              write Print-Record from line-45 after 1\n              add   2 to Line-Cnt\n     else\n              add   1 to Line-Cnt\n              write Print-Record from line-45 after 1\n     end-if\n     write    Print-Record from line-46 after 1.\n     add      1 to Line-Cnt.\n     move     spaces to Print-Record.\n     if       Stock-Services-Flag not = \"Y\"\n          and (zero not = Stock-Construct-Bundle or not = Stock-Under-Construction\n           or not = Stock-Work-in-Progress or Stock-Construct-Item not = spaces)\n              move Stock-Construct-Bundle   to WS-z6\n              move Stock-Under-Construction to WS-z6b\n              move Stock-Work-in-Progress   to WS-z6c\n              string \"Construction Bundle :\"    delimited by size\n                     WS-z6                      delimited by size\n                     \"  WIP :\"                  delimited by size\n                     WS-z6c                     delimited by size\n                     \"  Under Construction :\"   delimited by size\n                     WS-z6b                     delimited by size\n                     \" For Constructed Item : \" delimited by size\n                     Stock-Construct-Item       delimited by size\n                                into Print-Record\n              end-string\n              write  Print-Record after 1\n              add 1 to Line-Cnt\n     end-if\n     if       Stock-Services-Flag = \"Y\"\n              move \"Services only Product\" to Print-Record\n              write  Print-Record after 1\n              add 1 to Line-Cnt\n     end-if\n     go       to EA010-Read-Rec.\n*>\n EA030-Totals.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Stock-From or not = WS-Stock-To)\n              display ST302 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to ea999-Exit.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Abrev-From or not = WS-Abrev-To)\n              display ST303 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to ea999-Exit.\n*>\n     if       Line-Cnt > WS-Page-Lines - 3\n              add 60 to Line-Cnt\n              perform ZZ040-Print-Heads.\n     move     spaces to Print-Record.\n     move     WS-Rec-Cnt to WS-Rec-Total.\n     string   \" Total stock records Printed \" delimited by size\n              function trim (ws-Rec-Total leading) delimited by size into Print-Record.\n     write    Print-Record after 3.\n*>\n ea999-Exit.\n     exit     section.\n*>\n EB000-Process-Stock-Desc section.\n*>*******************************\n*>\n     move     spaces to Line-62.\n     move     spaces to WS-Stock-Desc.\n     move     3 to File-Key-No.\n     set      fn-not-less-than to true.\n     perform  Stock-Start.\n     move     zero to WS-Rec-Cnt.\n*>\n EB010-Read-Rec.\n     move     3 to File-Key-No.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to EB030-Totals.\n*>\n*> Now we can deal with printing the record\n*>\n EB020-Print-Rec.\n     perform  ZZ035-Print-Heads.\n     add      1 to WS-Rec-Cnt.\n*>\n     move     WS-Stock-Key             to L62-Stock-Number.\n     move     WS-Stock-Abrev-Key       to L62-Abrev.\n     MOVE     WS-Stock-Desc            to L62-Description.\n     move     Stock-Retail             to L62-Retail.\n     move     Stock-Cost               to L62-Cost.\n     if       Stock-Services-Flag not = \"Y\"\n              move  Stock-Held         to L62-Held\n              move  spaces to L62-Service\n     else\n              move zero to L62-Held\n              move \"Services only Product\" to L62-Service.\n\n     write    Print-Record from Line-62 after 1.\n     add      1 to Line-Cnt.\n     move     spaces to Print-Record.\n     go       to EB010-Read-Rec.\n*>\n EB030-Totals.\n     if       Line-Cnt > WS-Page-Lines - 3\n              add 60 to Line-Cnt\n              perform ZZ035-Print-Heads.\n     move     spaces to Print-Record.\n     move     WS-Rec-Cnt to WS-Rec-Total.\n     string   \" Total stock records Printed \" delimited by size\n              function trim (ws-Rec-Total leading) delimited by size into Print-Record.\n     write    Print-Record after 2.\n*>\n EB999-Exit.  exit section.\n*>\n FA000-Process-History section.\n*>****************************\n*>\n     if       WS-Abrev-To not = spaces\n              perform  varying a from 7 by -1 until a < 2 or WS-Abrev-To (a:1) not = space\n                       move \"z\" to WS-Abrev-To (a:1)\n              end-perform\n     end-if\n     if       WS-Stock-From not = spaces\n              move     WS-Stock-From to WS-Stock-Key\n              move     1 to File-Key-No\n              set      fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform  Stock-Start\n              if       FS-Reply = 21\n                       display ST306 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                       display ST006   at line WS-Lines col 01\n                       accept WS-Reply at line WS-Lines col 32\n                       go to FA999-Exit\n              end-if\n     end-if\n*>\n     if       WS-Abrev-From not = spaces\n              move     WS-Abrev-From to WS-Stock-Abrev-Key\n              if       WS-Stock-Abrev-Key (7:1) = space\n                       move zero to WS-Stock-Abrev-Key (7:1)\n              end-if\n              move     2 to File-Key-No\n              set      fn-not-less-than to true       *>  move    8 to Access-Type   *> =\n              perform  Stock-Start\n              if       FS-Reply = 21\n                       display ST305 at line WS-23-Lines col 1 with foreground-color 4 highlight\n                       display ST006   at line WS-Lines col 01\n                       accept WS-Reply at line WS-Lines col 32\n                       go to FA999-Exit\n              end-if\n     end-if\n     if       WS-Partial = zero\n              move     zeros to WS-Stock-Abrev-Key\n              move     2 to File-Key-No\n              set      fn-not-less-than to true         *>    move    8 to Access-Type   *> not <\n              perform  Stock-Start\n              move     zero to Access-Type\n     end-if\n     move     zero     to WS-Rec-Cnt c.\n     move     spaces   to Line-65.\n*>\n FA010-Read-Rec.\n     perform  Stock-Read-Next.\n     if       FS-Reply = 10\n              go to FA030-Finish-Report.\n*>\n*> next 2 in case start does not work and its a partial list and before from keys\n*>\n     if       WS-Stock-From not = spaces\n         and  WS-Stock-From > WS-Stock-Key\n              go to FA010-Read-Rec.\n     if       WS-Abrev-From not = spaces\n         and  WS-Abrev-From > WS-Stock-Abrev-Key\n              go to FA010-Read-Rec.\n*>\n*> next 2 if partial list and past the to keys\n*>\n     if       WS-Stock-To not = spaces\n         and  WS-Stock-Key > WS-Stock-To\n              go to FA030-Finish-Report.\n*>\n     if       WS-Abrev-To not = spaces\n         and  WS-Stock-Abrev-Key > WS-Abrev-To\n              go to FA030-Finish-Report.\n*>\n*> Now we can deal with printing the record\n*>\n FA020-Print-Rec.\n     add      1 to WS-Rec-Cnt.\n     perform  ZZ045-Print-Heads.\n     move     WS-Stock-Abrev-Key to L65-Abrev-Stock.\n     move     WS-Stock-Key       to L65-Stock-Number.\n     move     WS-Stock-Desc      to L65-Desc.\n     add      Stock-Adds Stock-Deducts giving L65-This-Period.\n     perform  varying a from 1 by 1 until a > 12\n              add Stock-TD-Adds (a) Stock-TD-Deds (a) giving L65-This-Year (a)\n     end-perform\n     write    Print-Record from Line-65 after 1.\n     add      1 to Line-Cnt.\n*>\n     if       Stk-Manu-Used = 1\n              move     spaces to Line-65\n              move     zero to b                     *> dont bother printing WIPs if all zero\n              if       Stock-Wip-Adds not = zero\n                or     Stock-Wip-Deds not = zero\n                       move 1 to b\n              end-if\n              perform  varying a from 1 by 1 until a > 12\n                       if       Stock-TD-WIP-Adds (a) not = zero\n                         or     Stock-TD-WIP-Deds (a) not = zero\n                                move 1 to b\n                       end-if\n              end-perform\n              if       b not = zero\n                       add      Stock-Wip-Adds Stock-Wip-Deds giving L65-This-Period\n                       perform  varying a from 1 by 1 until a > 12\n                                add Stock-TD-WIP-Adds (a) Stock-TD-WIP-Deds (a)\n                                                          giving L65-This-Year (a)\n                       end-perform\n                       move     \"WIP:\" to L65-Lit-Wip\n                       write    Print-Record from Line-65 after 1\n                       add      1 to Line-Cnt\n                       move     1 to c\n              end-if\n     end-if\n     go       to FA010-Read-Rec.\n*>\n FA030-Finish-Report.\n*>\n*> On current page. Enough extra lines for total and if Partial report,\n*>      extra 2 lines for from/to line\n*>\n     if       Page-Nos = zero\n        and   (spaces not = WS-Stock-From or not = WS-Stock-To)\n              display ST302 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to FA999-Exit.\n     if       Page-Nos = zero\n        and   (spaces not = WS-Abrev-From or not = WS-Abrev-To)\n              display ST303 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to FA999-Exit.\n*>\n     if       Line-Cnt > WS-Page-Lines - 5\n              add 60 to Line-Cnt\n              perform ZZ045-Print-Heads.\n     move     spaces to Print-Record.\n     move     WS-Rec-Cnt to WS-Rec-Total.\n     string   \" Total stock records Printed \" delimited by size\n              function trim (ws-Rec-Total leading) delimited by size into Print-Record.\n     write    Print-Record after 2.\n*>\n     if       Stk-Manu-Used = 1\n         and  c = zero\n              move \"WIP records were present but none had data\" to Print-Record\n              write Print-Record after 2.\n*>\n FA999-Exit.\n     exit     section.\n*>\n GA000-Process-Location section.\n*>*****************************\n*>\n*>  SEE ZZ025 for page break coding that is current changed for write 1 or two lines on change of location\n*>   instead of a page or double page (on odd page #) for testing to reduce wasting paper.\n*>\n     move     zero to WS-Rec-Cnt\n                      C.\n     move     spaces to Line-72.\n     move     low-values to WS-Current-Location.\n*>\n*> 1st time through Line-cnt will be > 99\n*>\n     if       WS-Location-Frm-Cnt > 0\n              move     WS-Location-Frm to WS-Stock-Location\n     else\n              move     low-values      to WS-Stock-Location.\n*>\n     move     4 to File-Key-No.\n     set      fn-greater-than to true.\n     perform  Stock-Start.\n     if       FS-Reply = 21 or = 23\n              display ST310 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              go to GA999-Exit.\n*>\n GA010-Read-Rec.\n     perform  until FS-Reply = 10\n              perform  Stock-Read-Next\n              if       FS-Reply = 10\n                       exit perform\n              end-if\n              if       WS-Current-Location = low-values  *> Only done the once\n                       move     WS-Stock-Location to WS-Current-Location\n              end-if\n              if       WS-Location-To-Cnt not = zero\n                and    WS-Stock-Location (1:WS-Location-To-Cnt) >\n                                            WS-Location-To (1:WS-Location-To-Cnt)\n                       exit perform\n              end-if\n              if       WS-Location-Frm-Cnt not = zero\n                and    WS-Stock-Location (1:WS-Location-Frm-Cnt) <\n                                            WS-Location-Frm (1:WS-Location-Frm-Cnt)\n                       exit perform cycle     *> Skip record\n              end-if\n*>\n*> Have a record in range if Frm / To in use\n*> Now we can deal with printing the record\n*>\n              perform  ZZ025-Print-Heads\n              move     WS-Stock-Abrev-Key to L72-Abrev-Stock\n              move     WS-Stock-Key       to L72-Stock-Number\n              move     WS-Stock-Desc      to L72-Desc\n              move     WS-Stock-Location  to L72-Location\n              move     Stock-Held         to L72-Held\n*>\n              write    Print-Record from Line-72 after 1\n              add      1 to WS-Rec-Cnt\n              add      1 to Line-Cnt\n *>             move     WS-Stock-Location  to WS-Current-Location\n*> above is in wrong place\n              exit perform cycle\n     end-perform.\n*>\n GA030-Finish-Report.\n*>\n*> On current page. Enough extra lines for total,\n*>\n     if       Page-Nos = zero\n              display ST311 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              go to GA999-Exit.\n*>\n     if       Line-Cnt > WS-Page-Lines - 7\n              move 250 to Line-Cnt\n              perform ZZ025-Print-Heads.\n*>\n     move     spaces to Print-Record.\n     move     WS-Rec-Cnt to WS-Rec-Total.\n     string   \" Total Stock records Printed \" delimited by size\n              function trim (ws-Rec-Total leading) delimited by size into Print-Record.\n     write    Print-Record after 2.\n     move     \" Date / Time Stock Check Completed :                                 By\"\n              to Print-Record.\n     write    Print-Record after 3.\n     move     \" Date / Time Stock Added/Removed from Stock Control :                By\"\n              to Print-Record.\n     write    Print-Record after 2.\n*>\n*> Next two only for testing\n*>\n *>    display  ST006        at line WS-23-Lines col 1 with foreground-color 4 erase eos.\n *>    accept   Accept-Reply at line WS-23-Lines col 32.\n*>\n GA999-Exit.\n     exit     section.\n*>\n*>***********************************************\n*>           Common Routines                    *\n*>***********************************************\n*>\n ZZ002-Print-Head-Top      section.\n*>********************************\n*>\n     add      1            to Page-Nos.\n     move     Prog-Name    to l11-Program.\n     move     Page-Nos     to l11-Page.\n     move     Usera        to l12-User.\n     move     WS-Conv-Date to l12-Date.\n     move     Report-Name  to l11-Title.\n     if       Page-Nos not = 1\n              write Print-Record from Line-11 after page\n              move Line-12 to Print-Record\n              if    b > 1\n                    move Line-0 (1:b) to Print-Record (a:b)\n              end-if\n              write Print-Record after 1\n              move  spaces to Print-Record\n              write Print-Record after 1\n     else\n              write Print-Record from Line-11 before 1\n              move Line-12 to Print-Record\n              if    b > 1\n                    move Line-0 (1:b) to Print-Record (a:b)\n              end-if\n              write Print-Record before 1\n     end-if\n     move     6 to Line-Cnt.\n*>\n     move     spaces to Print-Record\n                        line-0.\n ZZ002-Exit.\n     exit     section.\n*>\n ZZ004-String-Range        section.\n*>********************************\n*>\n*>      b is set prior to call\n*> Insert 'Items ranging from '\n*>\n     string   Line-0a            delimited by size into Line-0 pointer b.\n*> Insert stock-from or 'Start'\n     if       spaces not = WS-Stock-From or not = WS-Stock-To\n              if  WS-Stock-From = spaces\n                  string \"Start\"       delimited by size into Line-0 pointer b\n              else\n                  string WS-Stock-From delimited by space into Line-0 pointer b\n              end-if\n*> Insert 'through'\n              string Line-0b           delimited by size into Line-0 pointer b\n*> Insert stock-to or 'End'\n              if  WS-Stock-To = spaces\n                  string \"End\"         delimited by size into Line-0 pointer b\n              else\n                  string WS-Stock-To   delimited by space into Line-0 pointer b\n              end-if\n     else\n*>\n*>  Must be Abrev so do similar as above but abrev may be missing trailing chars\n*>\n              if WS-Abrev-From = spaces\n                  string \"Start\"       delimited by size into Line-0 pointer b\n              else\n                  string function trim (ws-Abrev-From trailing)\n                                       delimited by space into Line-0 pointer b\n              end-if\n              string Line-0b           delimited by size into Line-0 pointer b\n              if  WS-Abrev-To = spaces\n                  string \"End\"         delimited by size into Line-0 pointer b\n              else\n                  string WS-Abrev-To   delimited by space into Line-0 pointer b\n              end-if\n     end-if\n     compute a = (132 - b + 2) / 2.\n*>\n ZZ004-Exit.\n     exit     section.\n*>\n ZZ006-String-Range        section.\n*>********************************\n*>\n*>      b is set prior to call   <<<<<\n*> Insert 'Locations ranging from '\n*>\n     string   Line-0C                  delimited by size into Line-0 pointer b.\n*> Insert Location-From or 'Start'\n     if       spaces not = WS-Location-Frm or not = WS-Location-To\n              if  WS-Location-Frm = spaces\n                  string \"Start\"       delimited by size into Line-0 pointer b\n              else\n                  string function trim (WS-Location-Frm trailing)\n                                       delimited by space into Line-0 pointer b\n              end-if\n*> Insert 'through'\n              string Line-0D           delimited by size  into Line-0 pointer b\n*> Insert Location-To or 'End'\n              if  WS-Location-To = spaces\n                  string \"End\"         delimited by size  into Line-0 pointer b\n              else\n                  string function trim (WS-Location-To trailing)\n                                       delimited by space into Line-0 pointer b\n              end-if\n     end-if.\n*>\n*>  Chars # to cause double page break (if page ' Odd) else single page break.\n*>\n     if       WS-Location-Not-Ignored > zero\n              string \", field size for page break : \"\n                                       delimited by size into Line-0 pointer b\n              string WS-Location-Not-Ignored\n                                       delimited by size into Line-0 pointer b\n     else\n              string \", field size for page break : Not Used\"\n                                       delimited by size into Line-0 pointer b\n     end-if\n     compute a = (132 - b + 2) / 2.\n*>\n ZZ006-Exit.\n     exit     section.\n*>\n ZZ010-Print-Heads         section.\n*>********************************\n*>      Valuation\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ010-Exit.\n     move     1 to b.\n     move     spaces to Line-0.\n     if       WS-Partial = 1\n              perform ZZ004-String-Range\n     else\n              string \"All Items\"       delimited by size into Line-0 pointer b\n              compute a = (132 - b + 2) / 2.\n     perform  ZZ002-Print-Head-Top.\n*>\n     if       Stk-Manu-Used = zero\n              move spaces to l13-Lit-WIP l14-Lit-WIP\n     else\n              move \"WIP\"  to l13-Lit-WIP\n              move \"Qty\"  to l14-Lit-WIP\n     end-if\n     write    Print-Record from Line-13 after 1.\n     write    Print-Record from Line-14 after 1.\n*>\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ010-Exit.\n     exit     section.\n*>\n ZZ020-Print-Heads         section.\n*>********************************\n*>    Activity\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ020-Exit.\n*>\n*> Build report Sub title based on sub menu selection and print it + field heads\n*>\n     move     1 to b.\n     if       WS-Reply = 1 or 2\n              string \"All\" delimited by size into Line-0 pointer b\n     end-if\n     if       WS-Reply = 3 or 5\n              string \"Active in Current \"   delimited by size\n                     WS-Current-Period      delimited by \" \" into Line-0 pointer b\n     end-if\n     if       WS-Reply = 4 or 6\n              string \"Active in \"           delimited by size\n                     WS-Todate-Period       delimited by \"  \"\n                     \" To Date\"             delimited by size into Line-0 pointer b\n     end-if\n     add      1 to b.\n     if       WS-Partial = 1\n              perform ZZ004-String-Range\n     else\n              string \"Items\" delimited by size into Line-0 pointer b\n              compute  a = (132 - b + 2) / 2\n     end-if  *>  Next bit should work with any compiler (unless you know better)\n     perform  ZZ002-Print-Head-Top.\n*>\n     if       Stock-Averaging\n              move \" Average\" to L23-Lit-Average\n              move \" Stock\"   to L23-Lit-Val\n              move \"Value\"    to L24-Lit-Val\n     else\n              move \"   Unit\"  to L23-Lit-Average\n              move spaces     to L23-Lit-Val L24-Lit-Val\n     end-if\n*>\n*>  Set up period and to date heads\n*>\n     if       Stk-Period-Cur = \"Q\"\n              move \"< Current Quarter >\" to L23-Lit-Cur\n     else\n      if      Stk-Period-Cur = \"W\"\n              move \"<- Current Week -->\" to L23-Lit-Cur\n      else\n              move \"<- Current Month ->\" to L23-Lit-Cur.\n\n     if       Stk-Period-Dat = \"Q\"\n              move \"< Quarter to Date >\" to L23-Lit-YTD\n     else\n              move \"<- Year to Date -->\" to L23-Lit-YTD.\n*>\n     write    Print-Record from Line-23 after 1.\n     write    Print-Record from Line-24 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ020-Exit.\n     exit     section.\n*>\n ZZ025-Print-Heads         section.\n*>********************************\n*>\n*>     Location\n*>\n*>\n*>  SEE code for page break coding that is current changed for write 1 or two lines on change of location\n*>   instead of a page or double page (on odd page #) for testing to reduce wasting paper.\n*>\n*>   TEST CODE PRESENT so that paper not wasted.\n*>\n     if       WS-Location-Not-Ignored > zero\n     and      Page-Nos > zero\n     and      WS-Stock-Location (1:WS-Location-Not-Ignored) not =\n              WS-Current-Location (1:WS-Location-Not-Ignored)\n              add      10 Page-Nos giving Z       *> So forcing a remainder value but not really needed\n              divide   2 into Z giving X Remainder R\n              if       WS-Double-Sided-Prt = \"Y\"\n               and     R > zero               *> we have an ODD Page number\n                       add      2 to Line-Cnt    *> ONLY FOR TESTING and not using after page\n                       move     spaces to Print-Record\n *>                      write    Print-Record after page  *> AFTER TESTING\n                       write    Print-Record after 2     *> page  *> FOR TESTING remove after\n *>                      move     128  to Line-Cnt         *> AFTER TESTING add back.\n              else\n               if      WS-Double-Sided-Prt = \"N\"  *> do a blank line\n                and    R > zero               *> we have an ODD Page number\n  *>                     add      128 to Line-Cnt    *> AFTER TESTING\n                       add      1 to Line-Cnt           *> These 3 for TESTING\n                       move     spaces to Print-Record\n                       write    Print-Record after 1\n               end-if\n              end-if\n              move     WS-Stock-Location  to WS-Current-Location\n     end-if\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ025-Exit.\n*>\n*> Build report Sub title based on sub menu selection and print it + field heads\n*>\n     move     1 to b.\n     if       WS-Partial = 1\n              perform ZZ006-String-Range\n     else\n              string \"All Items\"       delimited by size into Line-0 pointer b\n              compute a = (132 - b + 2) / 2.\n     perform  ZZ002-Print-Head-Top.\n*>\n     write    Print-Record from Line-71 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ025-Exit.\n     Exit     section.\n*>\n ZZ030-Print-Heads         section.\n*>********************************\n*>     Reorder\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ030-Exit.\n*>\n*> Build report Sub title based on sub menu selection and print it + field heads\n*>\n     move     1 to b.\n     if       WS-Reply = 1 or 2\n              string \"All \" delimited by size into Line-0 pointer b\n     end-if\n     if       WS-Reply = 3 or 4\n              string \"Understocked \" delimited by size into Line-0 pointer b\n     end-if\n     if       WS-Reply = 5 or 6\n              string \"Not in Stock \" delimited by size into Line-0 pointer b\n     end-if\n     if       WS-Reply = 7 or 8\n              string \"On Order \" delimited by size into Line-0 pointer b\n     end-if\n     if       WS-Partial = 1\n              perform ZZ004-String-Range\n     else\n              string \"Items\" delimited by size into Line-0 pointer b\n              compute  a = (132 - b + 2) / 2\n     end-if\n     perform  ZZ002-Print-Head-Top.\n*>\n     write    Print-Record from Line-33 after 1.\n     write    Print-Record from Line-34 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ030-Exit.\n     Exit     section.\n*>\n ZZ035-Print-Heads         section.\n*>********************************\n*>\n*>  Stock Lists by Description\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ035-Exit.\n*>\n     move     1 to b.\n     string   \"All Items\"       delimited by size into Line-0 pointer b\n              compute a = (132 - b + 2) / 2.\n     perform  ZZ002-Print-Head-Top.\n*>\n     write    Print-Record from Line-61 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n     move     5 to Line-Cnt.\n*>\n ZZ035-Exit.  exit section.\n*>\n ZZ040-Print-Heads         section.\n*>********************************\n*>\n*>  Stock Lists\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ040-Exit.\n*>\n     move     1 to b.\n     if       WS-Partial = 1\n              perform ZZ004-String-Range\n     else\n              string \"All Items\"       delimited by size into Line-0 pointer b\n              compute a = (132 - b + 2) / 2.\n     perform  ZZ002-Print-Head-Top.\n*>\n     write    Print-Record from Line-43 after 1.\n     write    Print-Record from Line-44 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ040-Exit.\n     exit     section.\n*>\n ZZ045-Print-Heads         section.\n*>********************************\n*>\n*> Stock History\n*>\n     if       Line-Cnt not > WS-Page-Lines\n              go to ZZ045-Exit.\n*>\n     move     1 to b.\n     if       WS-Partial = 1\n              perform ZZ004-String-Range\n     else\n              string \"All Items\"       delimited by size into Line-0 pointer b\n              compute a = (132 - b + 2) / 2.\n     perform  ZZ002-Print-Head-Top.\n*>\n     write    Print-Record from Line-63 after 1.\n     write    Print-Record from Line-64 after 1.\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n*>\n ZZ045-Exit.\n     exit     section.\n*>\n ZZ050-Report-Selection  section.\n*>******************************\n ZZ050-Report-Selection-Main.\n*>\n*>  Common for all reports\n*>\n     move     spaces to WS-Stock-From WS-Stock-To\n                        WS-Abrev-From WS-Abrev-To\n                        WS-Location-Frm WS-Location-To.\n     move     zeroes to WS-Partial WS-First-Rec WS-Reply\n                        WS-Location-Not-Ignored\n                        WS-Location-Frm-Cnt\n                        WS-Location-To-Cnt.\n*>\n     if       Menu-Reply = 1    *> Valuation report, only get stk no. range\n              go to ZZ050-Get-Disp-03.\n     if       Menu-Reply = 3    *> ReOrder reports\n              go to ZZ050-Get-Disp-01.\n     if       Menu-Reply = 4 or = 5    *> Stock item or History report\n              go to ZZ050-Get-Disp-03.\n     if       Menu-Reply = 7           *> By Location / range of locations\n              go to ZZ050-Get-Disp-04.\n     if       Menu-Reply = 6           *> should not get here !\n              go to ZZ050-Exit.\n*>\n*> If here, its a Activity report  (2)\n*>\n     accept   display-02.\n     if       WS-Reply = 9\n              go to ZZ050-Exit.\n     if       WS-Reply < 1 or > 6\n              go to ZZ050-Report-Selection-Main.\n     if       WS-Reply = 2 or 5 or 6   *>  2(range), 5(Range current period), 6(range todate)\n              go to ZZ050-Get-Disp-03.\n*>\n*> now left with 1 (All), 3 All current period) & 4 (All, Period to date)\n*>\n     go       to ZZ050-Exit.\n*>\n ZZ050-Get-Disp-01.\n*>\n*>  Setup for Reorder\n*>\n     accept   display-01.\n     if       WS-Reply = 9\n              go to ZZ050-Exit.\n     if       WS-Reply < 1\n              go to ZZ050-Get-Disp-01.\n     if       WS-Reply = 2 or 4 or 6 or 8  *> 2(range), 4(Range understock), 6(range unstock)\n                                           *> 8 (Range on Order)\n              go to ZZ050-Get-Disp-03.\n*>\n*> now left with 1 (All), 3 All understocked), 5 (All, unstocked) & 7 (all on order)\n*>\n     go       to ZZ050-Exit.\n*>\n ZZ050-Get-Disp-03.\n     accept   display-03.\n     move     function upper-case (ws-Stock-From) to WS-Stock-From.\n     move     function upper-case (ws-Stock-To)   to WS-Stock-To.\n     move     function upper-case (ws-Abrev-From) to WS-Abrev-From.\n     move     function upper-case (ws-Abrev-To)   to WS-Abrev-To.\n*>\n*> Cant have both Stock and Abrev in any combination\n*>\n     if       (ws-Stock-From not = spaces and WS-Abrev-From not = spaces)\n          or  (ws-Stock-To   not = spaces and WS-Abrev-To   not = spaces)\n          or  (ws-Stock-From not = spaces and WS-Abrev-To   not = spaces)\n          or  (ws-Stock-To   not = spaces and WS-Abrev-From not = spaces)\n              display ST304 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              go to ZZ050-Get-Disp-03.\n*>\n     if       WS-Stock-From not = spaces and WS-Stock-To not = spaces\n         and  WS-Stock-From > WS-Stock-To\n              display ST307 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              go to ZZ050-Get-Disp-03.\n*>\n     if       WS-Abrev-From not = spaces and WS-Abrev-To not = spaces\n         and  WS-Abrev-From > WS-Abrev-To\n              display ST308 at line WS-23-Lines col 1 with foreground-color 4 highlight\n              display ST006   at line WS-Lines col 01\n              accept WS-Reply at line WS-Lines col 32\n              go to ZZ050-Get-Disp-03.\n*>\n     if       WS-Stock-From not = spaces or WS-Stock-To not = spaces\n           or WS-Abrev-From not = spaces or WS-Abrev-To not = spaces\n              move 1    to WS-Partial\n     else\n              move zero to WS-Partial.\n*>\n     go       to ZZ050-Exit.\n*>\n ZZ050-Get-Disp-04.\n*>\n*> CAUTION: Stock location can be mixed case\n*>\n     accept   Display-04 with UPDATE.\n     move     Function UPPER-CASE (WS-Location-Frm) to WS-Location-Frm.\n     move     Function UPPER-CASE (WS-Location-To)  to WS-Location-To.\n     move     Function UPPER-CASE (WS-Double-Sided-Prt) to WS-Double-Sided-Prt.\n     if       WS-Double-Sided-Prt = space\n       or     (WS-Double-Sided-Prt not = \"N\" and not = \"Y\")\n              move     \"N\" to WS-Double-Sided-Prt.   *> JIC\n     if       WS-Location-Not-Ignored > 8\n              display  ST309 at line WS-22-Lines col 1 with foreground-colour 4\n                                                            highlight erase EOS\n              display  ST006 at line WS-23-Lines col 1\n              accept   WS-Reply at line WS-23-Lines col 32\n              go to ZZ050-Get-Disp-04.\n*>\n     if       WS-Location-Frm (1:4) not = spaces\n              perform  varying WS-Location-Frm-Cnt from 10 by -1\n                         until WS-Location-Frm-Cnt < 2\n                       if      WS-Location-Frm-Cnt < 2   *> JIC\n                               exit perform\n                       end-if\n                       if      WS-Location-Frm (WS-Location-Frm-Cnt:1) = space\n                               exit perform cycle\n                       end-if\n              end-perform.\n     if       WS-Location-To (1:4) not = spaces\n              perform  varying WS-Location-To-Cnt from 10 by -1\n                         until WS-Location-To-Cnt < 2\n                       if      WS-Location-To-Cnt < 2   *> JIC\n                               exit perform\n                       end-if\n                       if      WS-Location-To (WS-Location-To-Cnt:1) = space\n                               exit perform cycle\n                       end-if\n              end-perform.\n     if       WS-Location-Frm (1:4) = spaces\n      and     WS-Location-To  (1:4) = spaces\n              move   zero to WS-Partial\n     else\n      if      WS-Location-Frm-Cnt > 0\n       or     WS-Location-To-Cnt > 0\n              move   1 to WS-Partial\n      else\n              move   zero to WS-Partial.\n*>\n      if      WS-Partial = 1\n              display  \"Processing Partial Start/End locations\" at line WS-22-Lines col 1\n                                                                 with foreground-color 4 erase eos\n      else\n              display  \"NOT processing Partial Locations\"       at line WS-22-Lines col 1\n                                                                 with foreground-color 4 erase eos.\n*>\n ZZ050-Exit.\n     exit     section.\n*>\n ZZ060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to ZZ060-Exit.\n     move     u-date to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to ZZ060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to ZZ060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n ZZ060-Exit.\n     exit     section.\n*>\n ZZ070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-date as uk/US/Inlt date format\n*>\n     move     to-day to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to ZZ070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to ZZ070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n ZZ070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 52
      }
    ],
    "evaluates": [
      {
        "content": "Menu-Reply\n              when     1\n                       perform  BA000-Process-Valuations\n       ...",
        "line": 812,
        "whenCount": 8
      }
    ],
    "validations": []
  },
  "complexity": {
    "mccabe": 22,
    "cognitive": 17,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 170,
      "totalOperators": 158,
      "totalOperands": 298,
      "vocabulary": 172,
      "length": 456,
      "volume": 3386.3767281441565
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
