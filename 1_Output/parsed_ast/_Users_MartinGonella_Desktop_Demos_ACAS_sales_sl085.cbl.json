{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl085.cbl",
  "fileName": "sl085.cbl",
  "timestamp": "2025-09-15T16:25:30.375Z",
  "programId": "sl085",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 107
      },
      {
        "name": "file",
        "line": 118
      },
      {
        "name": "working-storage",
        "line": 124
      },
      {
        "name": "linkage",
        "line": 264
      },
      {
        "name": "init01",
        "line": 279
      },
      {
        "name": "new-payment",
        "line": 328
      },
      {
        "name": "payment-appropriate",
        "line": 517
      },
      {
        "name": "erase-screen",
        "line": 600
      },
      {
        "name": "zz050-Validate-Date",
        "line": 608
      },
      {
        "name": "exit",
        "line": 641
      },
      {
        "name": "zz060-Convert-Date",
        "line": 643
      },
      {
        "name": "exit",
        "line": 676
      },
      {
        "name": "zz070-Convert-Date",
        "line": 678
      },
      {
        "name": "exit",
        "line": 706
      },
      {
        "name": "maps04",
        "line": 708
      },
      {
        "name": "exit",
        "line": 714
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 110
      },
      {
        "name": "file-defs",
        "line": 276
      },
      {
        "name": "end-if",
        "line": 296
      },
      {
        "name": "display-heads",
        "line": 298
      },
      {
        "name": "dh-exit",
        "line": 306
      },
      {
        "name": "menu-exit",
        "line": 315
      },
      {
        "name": "main-exit",
        "line": 321
      },
      {
        "name": "New-Payment-Main",
        "line": 331
      },
      {
        "name": "date-input",
        "line": 341
      },
      {
        "name": "get-batch",
        "line": 347
      },
      {
        "name": "customer-input",
        "line": 356
      },
      {
        "name": "find-trans-loop",
        "line": 374
      },
      {
        "name": "value-input",
        "line": 437
      },
      {
        "name": "value-input-req",
        "line": 449
      },
      {
        "name": "value-input-2",
        "line": 458
      },
      {
        "name": "data-input",
        "line": 470
      },
      {
        "name": "skip-pay-approp",
        "line": 475
      },
      {
        "name": "more-data",
        "line": 484
      },
      {
        "name": "accept-money",
        "line": 496
      },
      {
        "name": "accept-money2",
        "line": 505
      },
      {
        "name": "pay-loop",
        "line": 526
      },
      {
        "name": "get-deduct",
        "line": 555
      },
      {
        "name": "by-pass-deduct",
        "line": 575
      },
      {
        "name": "main-end",
        "line": 585
      },
      {
        "name": "zz050-test-date",
        "line": 635
      },
      {
        "name": "zz050-exit",
        "line": 640
      },
      {
        "name": "zz060-Exit",
        "line": 675
      },
      {
        "name": "zz070-Exit",
        "line": 705
      },
      {
        "name": "maps04-exit",
        "line": 713
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 711,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 97,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 106,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 113,
        "replacing": null
      },
      {
        "name": "seloi3",
        "line": 114,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 121,
        "replacing": null
      },
      {
        "name": "fdoi3",
        "line": 122,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 127,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 128,
        "replacing": null
      },
      {
        "name": "wsoi",
        "line": 160,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 161,
        "replacing": null
      },
      {
        "name": "slwsoi3",
        "line": 162,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 262,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 267,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 268,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 269,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 716,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 303
      },
      {
        "target": "OTM3-Open",
        "thru": null,
        "line": 309
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 310
      },
      {
        "target": "new-payment",
        "thru": null,
        "line": 311
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 312
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 313
      },
      {
        "target": "display-heads",
        "thru": null,
        "line": 319
      },
      {
        "target": "display-heads",
        "thru": null,
        "line": 333
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 344
      },
      {
        "target": "OTM3-Start",
        "thru": null,
        "line": 372
      },
      {
        "target": "OTM3-Read-Next",
        "thru": null,
        "line": 377
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 404
      },
      {
        "target": "accept-money2",
        "thru": null,
        "line": 442
      },
      {
        "target": "OTM3-Delete",
        "thru": null,
        "line": 464
      },
      {
        "target": "payment-appropriate",
        "thru": null,
        "line": 473
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 479
      },
      {
        "target": "erase-screen",
        "thru": null,
        "line": 481
      },
      {
        "target": "OTM3-Start",
        "thru": null,
        "line": 524
      },
      {
        "target": "OTM3-Read-Next",
        "thru": null,
        "line": 529
      },
      {
        "target": "accept-money",
        "thru": null,
        "line": 566
      },
      {
        "target": "OTM3-Rewrite",
        "thru": null,
        "line": 578
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 638
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 652
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Y",
        "to": "Oi-3-Flag Before\n*>                & After,Also Check For 7 On Pass-Value",
        "line": 41
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 282
      },
      {
        "from": "zero",
        "to": "k",
        "line": 308
      },
      {
        "from": "\"Y\"",
        "to": "oi-3-flag",
        "line": 318
      },
      {
        "from": "4",
        "to": "lin",
        "line": 332
      },
      {
        "from": "spaces",
        "to": "oi3-customer",
        "line": 349
      },
      {
        "from": "zero",
        "to": "display-n",
        "line": 359
      },
      {
        "from": "oi3-key",
        "to": "save-key",
        "line": 370
      },
      {
        "from": "open-item-record-3",
        "to": "oi-header",
        "line": 380
      },
      {
        "from": "oi-type",
        "to": "transaction-type",
        "line": 394
      },
      {
        "from": "oi-customer",
        "to": "pay-customer",
        "line": 396
      },
      {
        "from": "oi-date",
        "to": "pay-date",
        "line": 397
      },
      {
        "from": "oi-paid",
        "to": "pay-value hold-pay",
        "line": 398
      },
      {
        "from": "oi-approp",
        "to": "approp-amount",
        "line": 399
      },
      {
        "from": "pay-customer",
        "to": "WS-Sales-Key",
        "line": 402
      },
      {
        "from": "zero",
        "to": "c-check",
        "line": 406
      },
      {
        "from": "sales-address",
        "to": "address-a",
        "line": 408
      },
      {
        "from": "1",
        "to": "a",
        "line": 412
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 417
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 422
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 427
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 431
      },
      {
        "from": "sales-current",
        "to": "display-s",
        "line": 433
      },
      {
        "from": "pay-value",
        "to": "amt-ok",
        "line": 440
      },
      {
        "from": "0751",
        "to": "curs",
        "line": 441
      },
      {
        "from": "amt-ok",
        "to": "pay-value",
        "line": 443
      },
      {
        "from": "oi-deduct-amt",
        "to": "si-deduct-amt",
        "line": 468
      },
      {
        "from": "14",
        "to": "lin",
        "line": 480
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 486
      },
      {
        "from": "zero",
        "to": "ws-poundsd2 amt-ok2 ws-penced2",
        "line": 499
      },
      {
        "from": "ws-pound2",
        "to": "amt-wk-pds2",
        "line": 502
      },
      {
        "from": "ws-pence2",
        "to": "amt-wk-pence2",
        "line": 503
      },
      {
        "from": "amt-wk-pence",
        "to": "ws-pence",
        "line": 508
      },
      {
        "from": "amt-wk-pds",
        "to": "ws-pound",
        "line": 509
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 512
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 513
      },
      {
        "from": "zero",
        "to": "save-invoice",
        "line": 521
      },
      {
        "from": "save-key",
        "to": "oi3-key",
        "line": 522
      },
      {
        "from": "open-item-record-3",
        "to": "oi-header",
        "line": 533
      },
      {
        "from": "zero",
        "to": "oi-b-nos oi-b-item oi-cr oi-status",
        "line": 549
      },
      {
        "from": "si-deduct-amt",
        "to": "si-display",
        "line": 558
      },
      {
        "from": "oi-invoice",
        "to": "display-inv",
        "line": 560
      },
      {
        "from": "1224",
        "to": "curs",
        "line": 565
      },
      {
        "from": "amt-ok2",
        "to": "oi-deduct-amt",
        "line": 567
      },
      {
        "from": "approp-amount",
        "to": "display-8\n              move si-deduct-amt to display-s\n              display display-8 at 1304 with foreground-color 2\n              display display-s at 1317 with foreground-color 2\n              display SL003     at 1331 with foreground-color 4\n              accept ws-reply at 1354  with foreground-color 2",
        "line": 590
      },
      {
        "from": "1",
        "to": "cole",
        "line": 603
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 617
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 619
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 623
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 630
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 636
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 637
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 654
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 656
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 659
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 663
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 670
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 686
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 689
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 693
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 700
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "there are more in SL?\n*> 24/10/16 vbc - .07 ALL programs now using wsnames.cob in copybooks\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*> 21/01/17 vbc - .08 Replaced refs to maps99 for display msgs.\n*> 25/01/17 vbc       Dry testing completed.\n*> 07/02/17 vbc - .09 Updated FD/WS for 019 and replaced cobol verbs\n*>                    for access to FH/DALs.\n*> 10/12/22 vbc   .10 Added para after some sections 4 GC 3.2 warning msgs.\n*> 03/04/23 vbc - .11 Using ws-lines for error msgs at start of prog.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> These files and programs is part of the Applewood Computers Accounting\n*> System and is copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms of the GNU General Public License as published by the\n*> Free Software Foundation; version 3 and later as revised for personal\n*> usage only and that includes for use within a business but without\n*> repackaging or for Resale in any way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental mode must get in touch with the copyright holder\n*> with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n*> copy \"seloi3.cob\".\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdsl.cob\".\n*> copy \"fdoi3.cob\".\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(15) value \"SL085 (3.02.11)\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(7).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(7).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic 9(7).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic 9(7)v99.\n*>\n 01  ws-amount-screen-display2.\n     03  ws-poundsd2     pic 999.\n     03  ws-period2      pic x     value \".\".\n     03  ws-penced2      pic v99.\n 01  ws-amount-screen-accept2 redefines ws-amount-screen-display2.\n     03  ws-pound2       pic 999.\n     03  filler          pic x.\n     03  ws-pence2       pic v99.\n*>\n 01  ws-amount-work2.\n     03  amt-wk-pds2     pic 999.\n     03  amt-wk-pence2   pic v99.\n 01  ws-amount-ok2 redefines ws-amount-work2.\n     03  amt-ok2         pic 999v99.\n*>\n*> copy \"wsoi.cob\".\n copy \"wssl.cob\".\n copy \"slwsoi3.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n*>     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  a               pic 99.\n     03  c-check         pic 9.\n         88  c-exists                       value  1.\n     03  work-1          pic s9(6)v99.\n     03  display-8       pic -(5)9.99.\n     03  display-s       pic z(5)9.99cr.\n     03  display-n       pic 9(5).\n     03  display-inv     pic z(7)9.\n     03  si-deduct-amt   pic s999v99     comp  value zero.\n     03  si-display      pic -zz9.99.\n     03  k               pic 999.\n     03  approp-amount   pic s9(6)v99    comp-3 value zero.\n     03  pay-customer    pic x(7).\n     03  pay-date        binary-long.\n     03  pay-value       pic s9(6)v99    comp-3 value zero.\n     03  address-A       pic x(96).\n     03  address-line    pic x(36).\n     03  transaction-type pic 9                 value zero.\n         88  trans-payment                      value 5.\n         88  trans-unapplied                    value 6.\n     03  hold-pay        pic s9(6)v99    comp-3 value zero.\n     03  save-key.\n         05 save-customer pic x(7).\n         05 save-invoice  binary-long.    *> was pic 9(8)       comp.\n     03  ws-env-lines    pic 999                value zero.\n     03  ws-lines        binary-char unsigned   value zero.\n     03  ws-23-lines     binary-char unsigned   value zero.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SL003           pic x(28) value \"SL003 Hit Return To Continue\".\n*> Module specific\n     03  SL140           pic x(36) value \"SL140 Not Yet Supporting Corrections\".\n     03  SL141           pic x(42) value \"SL141 Amount Approp Or Deduct Amt Not Zero\".\n     03  SL142           pic x(39) value \"SL142 No Payments To Correct/Proof/Post\".\n*>\n 01  error-code          pic 999.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n     if       s-flag-p = zero\n              display SL142   at 0501\n              display SL003   at line ws-lines col 1   *> 2401\n              accept ws-reply at line ws-lines col 30  *> 2430\n              go to main-exit\n     end-if.\n*>\n display-heads.\n*>------------\n*>\n     display  prog-name at 0202 with erase eos foreground-color 2.\n     display  \"Payment Data Amend\" at 0233 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0271 with foreground-color 2.\n*>\n dh-exit.\n*>\n     move     zero  to  k.\n     perform  OTM3-Open.      *> open i-o open-item-file-3 sales-file\n     perform  Sales-Open.\n     perform  new-payment.\n     perform  OTM3-Close.   *> close open-item-file-3 sales-file\n     perform  Sales-Close.\n*>\n menu-exit.\n*>********\n*>\n     move     \"Y\" to oi-3-flag.\n     perform  display-heads.\n*>\n main-exit.\n     exit program.\n*>\n*>****************************************\n*>               Procedures\t         *\n*>****************************************\n*>\n new-payment             section.\n*>==============================\n*>\n New-Payment-Main.\n     move     4  to  lin.\n     perform  display-heads.\n*>\n     display  \"****************************************\" at 0441 with foreground-color 2.\n     display  \"*Date    [  /  /    ]                  *\" at 0541 with foreground-color 2.\n     display  \"*A/C Nos    [       ]                ***\" at 0641 with foreground-color 2.\n     display  \"*Value   {          }*Batch [     /   ]*\" at 0741 with foreground-color 2.\n     display  \"****************************************\" at 0841 with foreground-color 2.\n*>\n date-input.\n*>*********\n*>\n     perform  zz070-Convert-Date.\n     display  ws-date at 0551 with foreground-color 3.\n*>\n get-batch.\n*>\n     move     spaces to oi3-customer.\n     accept   oi3-customer at 0654 with foreground-color 3.\n     move     function upper-case (oi3-customer) to oi3-customer.\n     display  oi3-customer at 0654 with foreground-color 3.\n     if       oi3-customer = spaces\n              go to main-exit.\n*>\n customer-input.\n*>*************\n*>\n     move     zero to display-n.\n     accept   display-n at 0770 with foreground-color 3 update.\n     if       display-n = zero\n              go to  main-exit.\n*>\n     accept   k at 0776 with foreground-color 3 update.\n*>\n     if       k = zero\n              go to customer-input.\n     multiply display-n by 1000 giving oi3-invoice.\n     add      k to oi3-invoice.\n     move     oi3-key to save-key.\n     set      fn-not-less-than to true.\n     perform  OTM3-Start.     *> start open-item-file-3 key not < oi3-key.\n*>\n find-trans-loop.\n*>**************\n*>\n     perform  OTM3-Read-Next.     *>  read open-item-file-3 next record at end\n     if       fs-reply = 10\n              go to  get-batch.\n *>     move     open-item-record-3  to  oi-header.\n*>\n     if       oi-customer not = save-customer\n          or  oi-invoice not = save-invoice\n              go to get-batch.\n*>\n     if       oi-b-nos  not equal  display-n\n           or oi-b-item not equal  k\n           or (oi-type not = 5 and not = 6)    *> payment or unappled journal\n              go to  find-trans-loop.\n*>\n     if       oi-type = 6                                                 *> 25.11.11 this looks like wrong place to put msg\n              display \"Warning Unapplied Balance Journal\" at 0645 with foreground-color 2.\n*>\n     move     oi-type to transaction-type.\n*>\n     move     oi-customer  to  pay-customer.\n     move     oi-date      to  pay-date.\n     move     oi-paid      to  pay-value hold-pay.\n     move     oi-approp    to  approp-amount.\n*>\n     display  pay-customer at 0572 with foreground-color 2.\n     move     pay-customer  to  WS-Sales-Key.\n*>\n     perform  Sales-Read-Indexed.            *>  read sales-file record invalid key\n     if       fs-reply = 21\n              move  zero  to  c-check.\n*>\n     move     sales-address  to  address-a.\n*>\n     display  sales-name at 0401 with foreground-color 2.\n*>\n     move     1  to  a.\n     unstring address-a  delimited  by sl-delim\n              into address-line count a pointer a.\n     display  address-line at 0501 with foreground-color 2.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by sl-delim\n              into address-line count a pointer a.\n     display  address-line at 0601 with foreground-color 2.\n*>\n     move     spaces  to  address-line.\n     unstring address-a  delimited  by sl-delim\n              into  address-line  count a  pointer  a.\n     display  address-line at 0701 with foreground-color 2.\n*>\n     move     spaces  to  address-line.\n     unstring address-a into  address-line  pointer  a.\n     display  address-line at 0801 with foreground-color 2.\n*>\n     move     spaces  to  address-line.\n*>\n     move     sales-current  to  display-s.\n     display  \"Current Balance - \" at 1001  with foreground-color 2.\n     display  display-s at 1019 with foreground-color 2.\n*>\n value-input.\n*>**********\n*>\n     move     pay-value to amt-ok.\n     move     0751 to curs.\n     perform  accept-money2.\n     move     amt-ok to pay-value.\n     if       pay-value not = oi-paid\n              go to value-input-2.\n     display  \"Confirm No Action? i.e. Request Cancelled (Y/N)..[ ]\"\n                                   at 1201 with foreground-color 2.\n*>\n value-input-req.\n*>\n     accept   ws-reply at 1251 with foreground-color 6.\n     move     function upper-case (ws-reply) to ws-reply\n     if       ws-reply = \"Y\"\n              go to new-payment-Main.\n     if       ws-reply not = \"N\"\n              go to value-input-req.\n*>\n value-input-2.\n*>\n     if       pay-value not = zero\n              display SL140  at 1201 with erase eol\n              go to value-input.\n*>\n     perform  OTM3-Delete.      *>  delete   open-item-file-3.\n*>\n     if       oi-approp = zero\n              go to  skip-pay-approp.\n     move     oi-deduct-amt  to si-deduct-amt.\n*>\n data-input.\n*>*********\n*>\n     perform  payment-appropriate.\n*>\n skip-pay-approp.\n*>\n     if       trans-unapplied\n              add hold-pay to sales-unapplied\n              perform  Sales-Rewrite               *>  rewrite sales-record.\n     move     14  to  lin.\n     perform  erase-screen.\n     display  \"Make Further Corrections (Y/N) ? [Y]\" at 1629 with foreground-color 2.\n*>\n more-data.\n*>\n     move     \"Y\"  to   ws-reply.\n     accept   ws-reply at 1663 with foreground-color 6 update.\n     move     function upper-case (ws-reply) to ws-reply.\n*>\n     if       ws-reply = \"Y\"\n              go to  new-payment-Main.\n     if       ws-reply not = \"N\"\n              go to more-data.\n     go       to main-exit.\n*>\n accept-money.\n*>-----------\n*>\n     move     zero to ws-poundsd2 amt-ok2 ws-penced2.\n     display  ws-amount-screen-display2 at curs with foreground-color 2.\n     accept   ws-amount-screen-accept2 at curs  with foreground-color 2 update.\n     move     ws-pound2 to amt-wk-pds2.\n     move     ws-pence2 to amt-wk-pence2.\n*>\n accept-money2.\n*>------------\n*>\n     move     amt-wk-pence to ws-pence.\n     move     amt-wk-pds to ws-pound.\n     display  ws-amount-screen-display at curs with foreground-color 3.\n     accept   ws-amount-screen-accept at curs  with foreground-color 3 update.\n     move     ws-pound to amt-wk-pds.\n     move     ws-pence to amt-wk-pence.\n*>\n main-exit.   exit section.\n*>\n payment-appropriate     section.\n*>==============================\n*>\n     display  \"Reversing Please Wait\" at 1101  with foreground-color 2.\n     move     zero to save-invoice.\n     move     save-key to oi3-key.\n     set      fn-not-less-than to true.\n     perform  OTM3-Start.     *> start open-item-file-3 key not < oi3-key.\n*>\n pay-loop.\n*>*******\n*>\n     perform  OTM3-Read-Next.    *>  read open-item-file-3 next record  at end\n     if       fs-reply = 10\n              go to  main-end.\n*>\n *>    move     open-item-record-3  to  oi-header.\n*>\n     if       oi-type  not = 2            *> invoices\n              go to pay-loop.\n*>\n     if       oi-customer  not = pay-customer\n              go to  main-end.\n*>\n     if       oi-b-nos not = display-n\n        or    oi-b-item not = k\n              go to pay-loop.\n*>\n     divide   oi-cr by 100 giving work-1.\n     subtract work-1 from oi-paid.\n     subtract work-1 from oi-p-c.\n     subtract work-1 from approp-amount.\n     move     zero to oi-b-nos oi-b-item oi-cr oi-status.\n*>\n     if       si-deduct-amt = zero\n          or  oi-deduct-amt not zero\n              go to  by-pass-deduct.\n*>\n get-deduct.\n*>*********\n*>\n     move     si-deduct-amt  to  si-display.\n     display  \"For Invoice No. \" at 1301 with foreground-color 2.\n     move     oi-invoice to display-inv.\n     display  display-inv at 1317 with foreground-color 2.\n     display  \"Enter Deduct Amount - [      ]\" at 1201  with foreground-color 2.\n     display  \"Amount Available = \" at 1240  with foreground-color 2.\n     display  si-display at 1259 with foreground-color 3.\n     move     1224 to curs.\n     perform  accept-money.\n     move     amt-ok2 to oi-deduct-amt.\n     if       oi-deduct-amt  >  si-deduct-amt\n              go to  get-deduct\n     else\n              subtract  oi-deduct-amt  from  si-deduct-amt.\n     display  \" \" at 1201 with erase eol.\n     display  \" \" at 1301 with erase eol.\n*>\n by-pass-deduct.\n*>*************\n*>\n     perform  OTM3-Rewrite.      *> rewrite open-item-record-3 from oi-header.\n     if       approp-amount = zero\n        and   si-deduct-amt = zero\n              go to main-end.\n*>\n     go       to pay-loop.\n*>\n main-end.\n*>\n     if       approp-amount not = zero\n          or  si-deduct-amt not = zero\n              display SL141 at 1201 with foreground-color 4\n              move approp-amount to display-8\n              move si-deduct-amt to display-s\n              display display-8 at 1304 with foreground-color 2\n              display display-s at 1317 with foreground-color 2\n              display SL003     at 1331 with foreground-color 4\n              accept ws-reply at 1354  with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****.\n*>\n erase-screen            section.\n*>==============================\n*>\n     move     1 to cole.\n     display  \" \" at curs with erase eos.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>****************************************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 60
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 75,
      "totalOperators": 61,
      "totalOperands": 122,
      "vocabulary": 76,
      "length": 183,
      "volume": 1143.3707349601762
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
