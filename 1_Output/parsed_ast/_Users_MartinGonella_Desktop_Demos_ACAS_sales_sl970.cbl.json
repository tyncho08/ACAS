{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl970.cbl",
  "fileName": "sl970.cbl",
  "timestamp": "2025-09-15T16:25:29.911Z",
  "programId": "sl970",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": false,
    "errors": [
      "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl970.cbl:1101: error: an-accept.pl: No such file or directory",
      "Cannot read properties of undefined (reading 'total')"
    ],
    "warnings": []
  },
  "parseErrors": [
    "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl970.cbl:1101: error: an-accept.pl: No such file or directory",
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 141
      },
      {
        "name": "file",
        "line": 154
      },
      {
        "name": "working-storage",
        "line": 160
      },
      {
        "name": "linkage",
        "line": 403
      },
      {
        "name": "screen",
        "line": 412
      },
      {
        "name": "aa000",
        "line": 459
      },
      {
        "name": "ba000-Reports",
        "line": 549
      },
      {
        "name": "exit",
        "line": 626
      },
      {
        "name": "bb100-Cust-Heads",
        "line": 628
      },
      {
        "name": "bc100-Item-Heads",
        "line": 652
      },
      {
        "name": "ba110-Move-Cust",
        "line": 676
      },
      {
        "name": "exit",
        "line": 717
      },
      {
        "name": "ba120-Move-Item",
        "line": 719
      },
      {
        "name": "exit",
        "line": 760
      },
      {
        "name": "CA000-Amend",
        "line": 762
      },
      {
        "name": "exit",
        "line": 992
      },
      {
        "name": "zz060-Convert-Date",
        "line": 994
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1028
      },
      {
        "name": "zz080-Convert-Local-To-Bin-Date",
        "line": 1057
      },
      {
        "name": "maps04",
        "line": 1093
      },
      {
        "name": "exit",
        "line": 1099
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 144
      },
      {
        "name": "file-defs",
        "line": 456
      },
      {
        "name": "aa000-Main",
        "line": 462
      },
      {
        "name": "end-if",
        "line": 491
      },
      {
        "name": "L2-Name",
        "line": 496
      },
      {
        "name": "AN-Return-Code",
        "line": 505
      },
      {
        "name": "aa010-Menu",
        "line": 512
      },
      {
        "name": "aa010-Sub-Menu",
        "line": 518
      },
      {
        "name": "aa020-Menu-Input",
        "line": 526
      },
      {
        "name": "AA000-Menu-Exit",
        "line": 546
      },
      {
        "name": "goback",
        "line": 547
      },
      {
        "name": "ba010-Main",
        "line": 552
      },
      {
        "name": "ba020-Cust-Report",
        "line": 569
      },
      {
        "name": "end-perform",
        "line": 592
      },
      {
        "name": "ba020-Exit",
        "line": 594
      },
      {
        "name": "exit",
        "line": 595
      },
      {
        "name": "ba030-Item-Report",
        "line": 597
      },
      {
        "name": "end-perform",
        "line": 620
      },
      {
        "name": "ba030-Exit",
        "line": 622
      },
      {
        "name": "exit",
        "line": 623
      },
      {
        "name": "ba999-Exit",
        "line": 625
      },
      {
        "name": "end-if",
        "line": 714
      },
      {
        "name": "ba110-Exit",
        "line": 716
      },
      {
        "name": "end-if",
        "line": 757
      },
      {
        "name": "ba120-Exit",
        "line": 759
      },
      {
        "name": "CA010-Main",
        "line": 767
      },
      {
        "name": "CA020-Get-Mode",
        "line": 783
      },
      {
        "name": "CA030-Get-Key",
        "line": 799
      },
      {
        "name": "BO-Cust-Itm-No",
        "line": 816
      },
      {
        "name": "CA040-Get-Confirm-Delete",
        "line": 853
      },
      {
        "name": "CA050-Get-Ord-Date",
        "line": 902
      },
      {
        "name": "end-if",
        "line": 919
      },
      {
        "name": "CA060-Get-Est-Date",
        "line": 922
      },
      {
        "name": "CA070-Get-Inv-Type",
        "line": 935
      },
      {
        "name": "CA080-Price",
        "line": 945
      },
      {
        "name": "ca998-Exit",
        "line": 984
      },
      {
        "name": "ca999-Exit",
        "line": 990
      },
      {
        "name": "zz080-Conv-Common-Date",
        "line": 1081
      },
      {
        "name": "maps04-exit",
        "line": 1098
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 482,
        "type": "DYNAMIC",
        "using": [
          "File-31",
          "*>",
          "bostkitm",
          "file",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "or",
          "File-Size-Bytes",
          "=",
          "zero",
          "*>",
          "No",
          "data",
          "if",
          "exists",
          "display",
          "SL207",
          "at",
          "1210",
          "with",
          "foreground-color",
          "4",
          "highlight",
          "display",
          "SL006",
          "at",
          "1410",
          "with",
          "foreground-color",
          "4",
          "beep",
          "accept",
          "WS-Reply",
          "at",
          "1455",
          "with",
          "foreground-color",
          "3",
          "goback",
          "end-if",
          "end-if"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 535,
        "type": "DYNAMIC",
        "using": [
          "Print-Report",
          "*>",
          "Landscape",
          "go",
          "to",
          "aa000-Menu-Exit"
        ]
      },
      {
        "target": "maps04",
        "line": 1096,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 131,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 140,
        "replacing": null
      },
      {
        "name": "selboitm",
        "line": 147,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 148,
        "replacing": null
      },
      {
        "name": "fdboitm",
        "line": 157,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 158,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 164,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 166,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 167,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 169,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 170,
        "replacing": null
      },
      {
        "name": "wsboitm",
        "line": 171,
        "replacing": null
      },
      {
        "name": "an-accept",
        "line": 232,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 271,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 401,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 406,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 407,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 408,
        "replacing": null
      },
      {
        "name": "an-accept",
        "line": 1101,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1103,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 498
      },
      {
        "target": "ba000-Reports",
        "thru": null,
        "line": 539
      },
      {
        "target": "CA000-Amend",
        "thru": null,
        "line": 543
      },
      {
        "target": "ba020-Cust-Report",
        "thru": "ba020-Exit",
        "line": 558
      },
      {
        "target": "ba030-Item-Report",
        "thru": "ba030-Exit",
        "line": 559
      },
      {
        "target": "ba020-Cust-Report",
        "thru": "ba020-Exit",
        "line": 563
      },
      {
        "target": "ba030-Item-Report",
        "thru": "ba030-Exit",
        "line": 566
      },
      {
        "target": "until",
        "thru": null,
        "line": 581
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 584
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 588
      },
      {
        "target": "ba110-Move-Cust",
        "thru": null,
        "line": 590
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 591
      },
      {
        "target": "until",
        "thru": null,
        "line": 609
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 612
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 616
      },
      {
        "target": "ba120-Move-Item",
        "thru": null,
        "line": 618
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 619
      },
      {
        "target": "bb100-Cust-Heads",
        "thru": null,
        "line": 679
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 694
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 697
      },
      {
        "target": "bc100-Item-Heads",
        "thru": null,
        "line": 722
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 737
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 740
      },
      {
        "target": "Stock-Open-Input",
        "thru": null,
        "line": 769
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 774
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 841
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 847
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 891
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 894
      },
      {
        "target": "zz080-Convert-Local-To-Bin-Date",
        "thru": null,
        "line": 912
      },
      {
        "target": "AN-Test-Status",
        "thru": null,
        "line": 954
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 986
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 988
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1003
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines",
        "line": 465
      },
      {
        "from": "hd-hh",
        "to": "L3-HH\n              move hd-mm to L3-MM",
        "line": 475
      },
      {
        "from": "Prog-Name",
        "to": "L1-Name\n                           L2-Name",
        "line": 495
      },
      {
        "from": "Usera",
        "to": "L3-User",
        "line": 497
      },
      {
        "from": "WS-Date",
        "to": "L3-Date",
        "line": 499
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 500
      },
      {
        "from": "zeros",
        "to": "AN-Error-Code\n                       AN-Return-Code",
        "line": 504
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 513
      },
      {
        "from": "1",
        "to": "Menu-Reply",
        "line": 527
      },
      {
        "from": "\"N\"",
        "to": "WS-Printer-Status\n                       close Print-File\n              end-if\n              call     \"SYSTEM\" using Print-Report  *> Landscape\n              go to aa000-Menu-Exit",
        "line": 532
      },
      {
        "from": "\"Y\"",
        "to": "WS-Printer-Status",
        "line": 555
      },
      {
        "from": "60",
        "to": "WS-Line-No",
        "line": 578
      },
      {
        "from": "zero",
        "to": "WS-Page-No",
        "line": 579
      },
      {
        "from": "60",
        "to": "WS-Line-No",
        "line": 606
      },
      {
        "from": "zero",
        "to": "WS-Page-No",
        "line": 607
      },
      {
        "from": "WS-Page-No",
        "to": "L1-Page",
        "line": 634
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 646
      },
      {
        "from": "6",
        "to": "WS-Line-No",
        "line": 648
      },
      {
        "from": "WS-Page-No",
        "to": "L2-Page",
        "line": 658
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 670
      },
      {
        "from": "6",
        "to": "WS-Line-No",
        "line": 672
      },
      {
        "from": "spaces",
        "to": "Line-8",
        "line": 680
      },
      {
        "from": "BO-Stk-Cust-No",
        "to": "L8-Cust",
        "line": 681
      },
      {
        "from": "BO-Stk-Item-No",
        "to": "L8-Item-No",
        "line": 682
      },
      {
        "from": "\":\"",
        "to": "L8-Slash\n              move     BO-Serial  to L8-Serial-No\n     else\n              move     space      to L8-Slash",
        "line": 684
      },
      {
        "from": "BO-Stk-PO",
        "to": "L8-PO",
        "line": 689
      },
      {
        "from": "BO-Stk-Orig-Inv-No",
        "to": "L8-Orig-Inv",
        "line": 690
      },
      {
        "from": "BO-Stk-BO-Qty",
        "to": "L8-Qty",
        "line": 691
      },
      {
        "from": "BO-Stk-BO-Arr-Date",
        "to": "U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L8-Arr-Date",
        "line": 693
      },
      {
        "from": "BO-Stk-Order-Date",
        "to": "U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L8-Ord-Date",
        "line": 696
      },
      {
        "from": "BO-Stk-Price",
        "to": "L8-Price",
        "line": 700
      },
      {
        "from": "BO-Stk-Arrived-Flag",
        "to": "L8-Flag",
        "line": 701
      },
      {
        "from": "\"UNKNOWN\"",
        "to": "L8-Inv-Type",
        "line": 705
      },
      {
        "from": "BO-Stk-Cust-No",
        "to": "WS-Cust-No\n              write    Print-Record from Line-8 after 2\n              add      2 to WS-Line-No\n     else\n              write    Print-Record from Line-8 after 1\n              add      2 to WS-Line-No\n     end-if",
        "line": 708
      },
      {
        "from": "spaces",
        "to": "Line-9",
        "line": 723
      },
      {
        "from": "BO-Stk-Cust-No",
        "to": "L9-Cust",
        "line": 724
      },
      {
        "from": "BO-Stk-Item-No",
        "to": "L9-Item-No",
        "line": 725
      },
      {
        "from": "\":\"",
        "to": "L9-Slash\n              move     BO-Serial  to L9-Serial-No\n     else\n              move space          to L9-Slash",
        "line": 727
      },
      {
        "from": "BO-Stk-PO",
        "to": "L9-PO",
        "line": 732
      },
      {
        "from": "BO-Stk-Orig-Inv-No",
        "to": "L9-Orig-Inv",
        "line": 733
      },
      {
        "from": "BO-Stk-BO-Qty",
        "to": "L9-Qty",
        "line": 734
      },
      {
        "from": "BO-Stk-BO-Arr-Date",
        "to": "U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L9-Arr-Date",
        "line": 736
      },
      {
        "from": "BO-Stk-Order-Date",
        "to": "U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L9-Ord-Date",
        "line": 739
      },
      {
        "from": "BO-Stk-Price",
        "to": "L9-Price",
        "line": 743
      },
      {
        "from": "BO-Stk-Arrived-Flag",
        "to": "L9-Flag",
        "line": 744
      },
      {
        "from": "\"UNKNOWN\"",
        "to": "L9-Inv-Type",
        "line": 748
      },
      {
        "from": "BO-Stk-Item-No",
        "to": "WS-Item-No\n              write    Print-Record from Line-9 after 2\n              add      2 to WS-Line-No\n     else\n              write    Print-Record from Line-9 after 1\n              add      2 to WS-Line-No\n     end-if",
        "line": 751
      },
      {
        "from": "\"N\"",
        "to": "WS-Stock-Flag\n     else\n              move   \"Y\" to WS-Stock-Flag",
        "line": 771
      },
      {
        "from": "\"N\"",
        "to": "WS-Sales-Flag\n     else\n              move   \"Y\" to WS-Sales-Flag",
        "line": 776
      },
      {
        "from": "space",
        "to": "WS-Data-Mode",
        "line": 784
      },
      {
        "from": "WS-BO-Cust-Itm-No",
        "to": "BO-Cust-Itm-No",
        "line": 813
      },
      {
        "from": "zeros",
        "to": "FS-Reply",
        "line": 814
      },
      {
        "from": "BO-Stk-Itm-Record",
        "to": "WS-BO-Stk-Itm-Record",
        "line": 817
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 838
      },
      {
        "from": "WS-BO-Stk-Item-No",
        "to": "WS-Stock-Key",
        "line": 839
      },
      {
        "from": "WS-BO-Stk-Cust-No",
        "to": "WS-Sales-Key",
        "line": 845
      },
      {
        "from": "\"N\"",
        "to": "WS-Reply\n              display \"Confirm Delete (Y/N) - [ ]\" at 1201 with foreground-color 2\n                                                                erase eol\n              accept  WS-Reply at 1225 with foreground-color 3 update UPPER\n              if      WS-Reply not = \"Y\" and not = \"N\"\n                      display SL216 at 1230 with foreground-color 4 highlight beep  *> Y OR N !\n                      go to CA040-Get-Confirm-Delete\n              end-if\n              if      WS-Reply = \"Y\"\n                      move    WS-BO-Cust-Itm-No to BO-Cust-Itm-No\n                      delete  BO-Stk-Itm-File Record\n                      if      FS-Reply not = zero\n                              display  SL210 at 1201 with foreground-color 4\n                                                          erase eol highlight beep\n                              display FS-Reply at 1242\n                              display SL003    at 1245\n                              accept  WS-Reply at 1275\n                      end-if\n              end-if\n              go to CA020-Get-Mode",
        "line": 855
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "WS-Ord-Date *> all in WS area\n              else\n               if      Date-USA\n                       move     \"mm/dd/ccyy\" to WS-Ord-Date\n               else\n                       move     \"ccyy/mm/dd\" to WS-Ord-Date\n               end-if\n              end-if\n              move     5 to WS-BO-Stk-Inv-Type        *> For display-03 for spaces\n     else    *> Using temp dates in local format converting from binary since 1601\n              move     WS-BO-Stk-BO-Arr-Date to U-Bin\n              perform  zz060-Convert-Date\n              move     WS-Date to WS-Est-Date             *> Not used for displays here\n              move     WS-BO-Stk-Order-Date to U-Bin\n              perform  zz060-Convert-Date\n              move     WS-Date to WS-Ord-Date             *> In WS area Only\n     end-if",
        "line": 880
      },
      {
        "from": "WS-Ord-Date",
        "to": "WS-Test-Date\n                       perform  zz080-Convert-Local-To-Bin-Date\n                       if       Return-Code not = zeros\n                                display  SL211 at line ws-lines col 1 with foreground-color 4 highlight\n                                                                           erase eol\n                                go to CA050-Get-Ord-Date\n                       else\n                                display \" \" at line WS-Lines col 1 erase eol\n                       end-if",
        "line": 911
      },
      {
        "from": "Stock-Retail",
        "to": "WS-BO-Stk-Price",
        "line": 923
      },
      {
        "from": "Stock-Retail",
        "to": "WS-Disp-Price\n              display  SL217   at 1310 with foreground-color 4 highlight beep\n              display  WS-Disp-Price at 1357 with foreground-color 4\n              display  \"Stock Price\" at 1369 with foreground-color 2\n     else\n              display \" \" at 1310 erase eol",
        "line": 928
      },
      {
        "from": "8",
        "to": "AN-LINE   *> as cust",
        "line": 949
      },
      {
        "from": "55",
        "to": "AN-COLUMN\n*>              set      AN-MODE-IS-UPDATE TO TRUE\n *>             call     static \"ACCEPT_NUMERIC\" using by REFERENCE WS-BO-Stk-Price    *> HAD STATIC\n *>                                                    by REFERENCE AN-ACCEPT-NUMERIC\n *>             perform  AN-Test-Status",
        "line": 950
      },
      {
        "from": "WS-Disp-Price",
        "to": "WS-BO-Stk-Price\n     end-if\n*>\n     if       WS-Mode-Input\n              write    BO-Stk-Itm-Record from WS-BO-Stk-Itm-Record\n              if       FS-Reply NOT = zero     *> Should not happen but ",
        "line": 956
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 1005
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 1007
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1010
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz060-Exit",
        "line": 1014
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 1021
      },
      {
        "from": "to-day",
        "to": "WS-date",
        "line": 1036
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1039
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz070-Exit",
        "line": 1043
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 1050
      },
      {
        "from": "WS-Test-Date",
        "to": "WS-Date",
        "line": 1063
      },
      {
        "from": "WS-Year",
        "to": "WS-Temp-Date-YMD (1:4)\n              move WS-USA-Month to WS-Temp-Date-YMD (5:2)\n              move WS-USA-Days  to WS-Temp-Date-YMD (7:2)\n              go to zz080-Conv-Common-Date",
        "line": 1065
      },
      {
        "from": "WS-Year",
        "to": "WS-Temp-Date-YMD (1:4)\n              move WS-Month     to WS-Temp-Date-YMD (5:2)\n              move WS-Days      to WS-Temp-Date-YMD (7:2)\n              go to zz080-Conv-Common-Date",
        "line": 1070
      },
      {
        "from": "WS-Intl-Year",
        "to": "WS-Temp-Date-YMD (1:4)",
        "line": 1077
      },
      {
        "from": "WS-Intl-Month",
        "to": "WS-Temp-Date-YMD (5:2)",
        "line": 1078
      },
      {
        "from": "WS-Intl-Days",
        "to": "WS-Temp-Date-YMD (7:2)",
        "line": 1079
      },
      {
        "from": "zero",
        "to": "Return-Code",
        "line": 1089
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "price change occurred on amend.\n*>                        Updated L8 & L9 for width and added Invoice type\n*>                        Q! is it now correct?\n*> 16/04/24 vbc           Copyright notice update superseding all previous notices.\n*> 26/04/24 vbc       .02 Forgot to set WS-Printer-Status to \"N\" before finishing\n*>                        in aa020-Menu-Input and 2nd head not printed.\n*>                        Chg heads to 108 width.\n*> 28/04/24 vbc       .03 Minor code chg for Headings\n*> 22/08/24 vbc       .04 Added Time on reports, item serial # for reports and\n*>                        for BO data accepts / amends.\n*> 16/06/24 vbc       .05 Date/Time reporting < 6 plus space after date.\n*> 17/02/25 vbc       .06 Zeroise WS-Page-No at start of each report, JIC it is rerun.\n*> 19/02/25 vbc       .07 Adjust file open and file closes in CA000, some missing\n*>                        minor cleanup of displays in SS and accepts.\n*> 25/02/25 vbc       .08 Fine adjusts for display-03 etc.\n*> 29/07/25 vbc       .09 Removed use of accept_numeric - cannot build it without\n*>                        issues.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 16-04-2024.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n copy \"selboitm.cob\".\n copy \"selprint.cob\".\n*>\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n copy \"fdboitm.cob\".\n copy \"fdprint.cob\".    *> 132 cols\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"SL970 (3.02.09)\".\n*>\n copy \"print-spool-command.cob\".\n*>\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n copy \"wssl.cob\".\n copy \"wsstock.cob\".\n copy \"wsboitm.cob\".\n*>\n*> REMARK OUT, ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  System-Record          pic x.  *> added 10/03/24\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  WS-data.\n     03  Menu-Reply      pic x.\n     03  WS-Reply        pic x.\n     03  Z               pic 99.\n     03  Escape-Code     pic x.\n     03  WS-SL-BO-Flag   pic x.\n         88  WS-BO-Used                  value \"Y\".\n     03  WS-BO-Can-Be-Used pic x.\n         88  WS-BO-Usable                value \"Y\".\n     03  WS-Page-No      pic 9(4)        value zeros.\n     03  WS-Line-No      pic 99          value 60.\n     03  WS-Cust-No      pic x(7)        value spaces.\n     03  WS-Item-No      pic x(13)       value spaces.\n     03  WS-Printer-Status\n                         pic x           value \"N\".     *> N = closed,  Y = open.\n     03  WS-Ord-Date     pic x(10).                     *> for printing\n     03  WS-Est-Date     pic x(10).                     *>   ditto\n     03  WS-Data-Mode    pic x           value space.\n         88  WS-Mode-Input               value \"I\".\n         88  WS-Mode-Amend               value \"A\".\n         88  WS-Mode-Delete              value \"D\".\n         88  WS-Valid-Modes              values \"A\" \"D\" \"I\".\n     03  WS-Sales-Flag   pic x           value \"N\".\n     03  WS-Stock-Flag   pic x           value \"N\".\n     03  WS-Serial-Slash pic x           value \"/\".   *> added 22/08/24\n     03  WS-Disp-Price   pic z(6)9.99    value zero.\n*>\n*> Above also needs SL-BO-Flag = Y (Sales-BO-Set) for invoice usage.\n*>\n     03  WS-env-lines    pic 999         value zero.\n     03  WS-lines        binary-char unsigned value zero.\n     03  WS-accept-body  binary-char unsigned value 8.         *> set for 24 line screen (-1) but Not yet in use\n     03  WS-23-lines     binary-char unsigned value zero.\n*>\n copy \"an-accept.ws\".\n*>\n 01  WS-Temp-Date-YMD.\n     03  WS-Temp-Date-YMD9   pic 9(8).\n 01  WS-Test-Date            pic x(10).\n 01  WS-date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-date             pic x(10).\n     03  WS-UK redefines WS-date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  hdtime                            value spaces.\n     03  hd-hh           pic xx.\n     03  hd-mm           pic xx.\n     03  hd-ss           pic xx.\n     03  hd-uu           pic xx.\n*>\n 01  WS-Tables.\n     03  WS-I-Types      pic x(40)       value \"Receipt Invoice Credit  Proforma        \". *> Credit not used here\n     03  filler  redefines WS-I-Types.\n         05  WS-Inv-Type pic x(8)  occurs 5.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SL003          pic x(28) value \"SL003 Hit Return To Continue\".\n     03  SL006          pic x(43) value \"SL006 Note Details & Hit Return to continue\".\n*> Module specific\n     03  SL194          pic x(19) value \"SL194 Stock Read : \".\n     03  SL195          pic x(22) value \"SL195 Stock Rewrite : \".\n     03  SL196          pic x(22) value \"SL196 Record Not found\".\n     03  SL201          pic x(38) value \"SL201 Custoner BO (Back Order) Not Set\".\n     03  SL202          pic x(54) value \"SL202 Creating BO rec & Changed Qty to held on invoice\".\n     03  SL203          pic x(29) value \"SL203 Err on Bo-Rec. Write : \".\n     03  SL204          pic x(31) value \"SL204 Err on Bo-Rec. Rewrite : \".\n*>     03  SL205          pic x(41) value \"SL205 Using Stock Held for quantity order\".\n*>     03  SL206          pic x(50) value \"SL206 Computation overflow - Qty or cost too large\".\n     03  SL207          pic x(53) value \"SL207 No data file bostkitm - Nothing to do - Exiting\".\n     03  SL208          pic x(33) value \"SL208 Cust/Item not found - Retry\".\n     03  SL209          pic x(31) value \"SL209 Cust/Item Present - Retry\".\n     03  SL210          pic x(41) value \"SL210 Failed to delete record - Status : \".\n     03  SL211          pic x(27) value \"SL211 Bad Date - Order Date\".\n     03  SL212          pic x(27) value \"SL212 Bad Date - Est.  Date\".\n     03  SL213          pic x(17) value \"SL213 Prints OK ?\".\n*>     03  SL214          pic x(36) value \"SL214 Can I clear down the BO file ?\".\n     03  SL215          pic x(57) value \"Invalid Mode - I = Input, A = Amend, D = Delete or Escape\".\n     03  SL216          pic x(27) value \"SL216 Answer must be N or Y\".\n     03  SL217          pic x(47) value \"SL217 Warning: There has been a price change : \".\n     03  SL218          pic x(41) value \"SL218 Invoice type must be 1, 2 or 4 Only\".\n*>\n 01  error-code          pic 999.\n*>\n*> Reporting line sources\n*>\n 01  Line-1.  *> 110\n     03  L1-Name         pic x(34).\n     03  filler          pic x(68)       value \"Back Order Report by Customer\".\n     03  filler          pic x(5)        value \"Page \".\n     03  L1-Page         pic zz9.\n*>\n 01  Line-2.  *> 110\n     03  L2-Name         pic x(34).\n     03  filler          pic x(68)       value \"Back Order Report by Item\".\n     03  filler          pic x(5)        value \"Page \".\n     03  L2-Page         pic zz9.\n*>\n 01  Line-3.  *> 110\n     03  L3-User         pic x(34)       value spaces.\n     03  filler          pic x(60)       value spaces.\n     03  L3-Date         pic x(10).\n     03  filler          pic x           value space.\n     03  L3-HH           pic xx.   *> all added 22/08/24\n     03  filler          pic x           value \":\".\n     03  L3-MM           pic xx.\n*>\n 01  Line-4.  *> By Customers #1\n*>                                                                                                       111111111111111111111\n*>    000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112\n*>    123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\n     03  filler          pic x(113)       value\n     \" Customer   Item Number      Order       Original      Back Order      Est Arriv        Retail   Arrival Inv.Type\".\n*>\n 01  Line-5.  *> By Customers #2\n*>                                                                                                       111111111111111111111\n*>    000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112\n*>    123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\n     03  filler          pic x(110)       value\n     \"  Number                                 Invoice       Qty   Date        Date            Price    Flag\".\n*>     A123456    1234567890123 1234567890     12345678 999,999  ccyy/mm/dd  ccyy/mm/dd  z,zzz,zz9.99     Y    Proforma\n*>                                        /zz\n 01  Line-6.  *> By Items #1\n*>                                                                                                       111111111111111111111\n*>    000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112\n*>    123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\n     03  filler          pic x(113)       value\n     \" Item Number    Customer     Order      Original      Back Order      Est Arriv        Retail   Arrival Inv.Type\".\n*>\n 01  Line-7.  *> By Items #2\n*>                                                                                                       111111111111111111111\n*>    000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112\n*>    123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890\n     03  filler          pic x(110)       value\n     \"                 Number                 Invoice       Qty   Date        Date            Price    Flag\".\n*>     1234567890123  A123456   1234567890  12345678 999,999 ccyy/mm/dd  ccyy/mm/dd  z,zzz,zz9.99      Y    Receipt\n*>\n*>\n 01  Line-8. *> Data by Customer\n     03  filler              pic x.\n     03  L8-Cust             pic x(7).\n     03  filler              pic x(4).\n     03  L8-Item-No          pic x(13).      *> 25\n     03  L8-Slash            pic x.          *> 26 added 22/08/24\n     03  L8-Serial-No        pic 99b   Blank when zero.  *> 29 added 22/08/24 = +3 to the line\n     03  L8-PO               pic x(10)b.      *> 40\n     03  L8-Orig-Inv         pic x(8)b.       *> 49\n     03  L8-Qty              pic zzz,zz9bb.   *> 58\n     03  L8-Ord-Date         pic x(10)bb.     *> 70   Multi format\n     03  L8-Arr-Date         pic x(10)b.      *> 81   Multi format\n     03  L8-Price            pic z,zzz,zz9.99. *> 93\n     03  filler              pic x(6).        *> 99\n     03  L8-Flag             pic xbbbb.       *> 104\n     03  L8-Inv-Type         pic x(8).        *> 112\n*>\n 01  Line-9. *> Data by Items\n     03  filler              pic x.\n     03  L9-Item-No          pic x(13).     *> 14\n     03  L9-Slash            pic x.         *> 15\n     03  L9-Serial-No        pic 99b  Blank when zero.       *> 18\n     03  L9-Cust             pic x(7).        *> 25\n     03  filler              pic xx.          *> 27\n     03  L9-PO               pic x(10)bbb.    *> 40\n     03  L9-Orig-Inv         pic x(8)b.       *> 49\n     03  L9-Qty              pic zzz,zz9bb.   *> 58\n     03  L9-Ord-Date         pic x(10)bb.     *> 70   Multi format\n     03  L9-Arr-Date         pic x(10)b.     *> 81   Multi format\n     03  L9-Price            pic z,zzz,zz9.99. *> 93\n     03  filler              pic x(6).        *> 99\n     03  L9-Flag             pic xbbbb.       *> 105  Y or N\n     03  L9-Inv-Type         pic x(8).        *> 112\n*>\n 01  COB-CRT-Status          pic 9(4)         value zero.\n copy \"screenio.cpy\".\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  To-Day              pic x(10).\n*>\n screen section.\n*>*************\n*>\n 01  Display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green\n                                                     blank line. *>  was screen.\n*>\n     03  value \" Mode - [\"                   line 4 col 1.\n     03  using WS-Data-Mode   pic x                 col 10 foreground-color 3.\n     03  value \"] I = Input, A = Amend, D = Delete or Escape to quit\"        col 11.\n*>\n*>              000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999\n*>              123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789\n     03  value \"Cust.   Item Number  (S#)   Order   ------ BO ------    Price    Arr Inv.\" line 5 col  1.\n     03  value \"Number                                Qty  Date                  Flg Type\" line 6 col  1.\n*>\n 01  Display-03                                      Blank Line.\n     03  using WS-BO-Stk-Cust-No  pic x(7)   line 8 col  1.\n     03  using WS-BO-Stk-Item-No  pic x(13)         col  9.\n     03  value \":\"                pic x             col 22. *> added this & next for serial # but blank if not used\n     03  using WS-BO-Serial       pic 99            col 23.\n     03  using WS-BO-Stk-PO       pic x(10)         col 26.\n     03  using WS-BO-Stk-BO-Qty   pic 9(6)          col 37.\n     03  using WS-Ord-Date        pic x(10)         col 44.       *> From WS area\n     03  using WS-BO-Stk-Price    pic z(6)9.99      col 55.\n     03  using WS-BO-Stk-Arrived-Flag pic x         col 67.\n     03  using WS-BO-Stk-Inv-Type pic 9             col 71.       *> 1=Receipt, 2=Invoice, 4=Proforma\n     03  value \"=\"                pic x             col 72.\n     03  using WS-Inv-Type (WS-BO-Stk-Inv-Type)     col 73  pic x(8).\n*>\n 01  Display-04-Cust-Stock.\n     03  value \"Customer - {\"                 line 10 col  1     Blank Line.\n     03  using Sales-Name         pic x(30)           col 13.\n     03  value \"}\"                                    col 43.\n     03  value \"Stock Desc - {\"               line 11 col  1     Blank Line.\n     03  using WS-Stock-Desc      pic x(32)           col 15.\n     03  value \"}\"                                    col 47.\n*>\n*> ABOVE WILL NEED CHANGES AND CLEAR OUT COMMENT RULERS AFTER TESTING\n*>\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n aa000 section.\n*>************\n*>\n aa000-Main.\n     accept   WS-env-lines from lines.\n     if       WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     accept   HDTime from TIME.\n     if       HDTime not = \"00000000\"\n              move hd-hh to L3-HH\n              move hd-mm to L3-MM.\n*>\n*>  Have we a BO file ? if not display msgs and quit\n*>\n     display  space at 0101 with erase eos.\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-31    *> bostkitm file\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                or  File-Size-Bytes = zero          *> No data if exists\n                    display  SL207    at 1210 with foreground-color 4 highlight\n                    display  SL006    at 1410 with foreground-color 4 beep\n                    accept   WS-Reply at 1455 with foreground-color 3\n                    goback\n              end-if\n     end-if.\n*>\n*> Fill header info\n*>\n     move     Prog-Name to L1-Name\n                           L2-Name.\n     move     Usera  to  L3-User.\n     perform  zz070-Convert-Date.   *> WS-date now LOCAL display date\n     move     WS-Date to L3-Date.\n     move     Print-Spool-Name to PSN.\n*>\n*> Next 5 for ACCEPT_NUMERIC processing\n*>\n     move     zeros to AN-Error-Code\n                       AN-Return-Code.\n     SET      AN-FG-IS-GREEN  TO TRUE.\n     SET      AN-BG-IS-BLACK  TO TRUE.\n     SET      AN-FG2-IS-CYAN  TO TRUE.\n*>\n     SET      AN-MODE-IS-UPDATE   TO TRUE.  *> could be AN-MODE-IS-NO-UPDATE\n*>\n aa010-Menu.\n     move     zero  to  Menu-Reply.\n     display  Prog-Name at 0101 with erase eos foreground-color 2.\n     display  \"BO Reporting and Amendments Menu\" at 0134 with foreground-color 2.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n aa010-Sub-Menu.\n     display  \"Select one of the following by number :- [ ]\"  at 0501 with foreground-color 2 erase eos.\n     display  \"(1)  Report All Back Orders by Customer And by Item \"  at 0711 with foreground-color 2.\n     display  \"(2)  Report BO by Customers\"      at 0811 with foreground-color 2.\n     display  \"(3)  Report BO by Stock Items\"    at 0911 with foreground-color 2.\n     display  \"(4)  Amend or Delete Back Orders\" at 1011 with foreground-color 2.\n     display  \"(X)  Return To System menu\"       at 1211 with foreground-color 2.\n*>\n aa020-Menu-Input.\n     move     1 to Menu-Reply.\n     accept   Menu-Reply at 0543 with foreground-color 6 auto UPPER.\n*>\n     if       Menu-Reply  = \"X\"\n              if       WS-Printer-Status = \"Y\"\n                       move \"N\" to WS-Printer-Status\n                       close Print-File\n              end-if\n              call     \"SYSTEM\" using Print-Report  *> Landscape\n              go to aa000-Menu-Exit.\n*>\n     if       Menu-Reply = 1 or = 2 or = 3\n              perform  ba000-Reports\n              go to aa020-Menu-Input.\n*>\n     if       Menu-Reply = 4\n              perform  CA000-Amend.\n     go       to       aa010-Sub-Menu.\n*>\n AA000-Menu-Exit.\n     goback.\n*>\n ba000-Reports section.\n*>********************\n*>\n ba010-Main.\n     if       WS-Printer-Status = \"N\"\n              open     output Print-File\n              move     \"Y\" to WS-Printer-Status.\n*>\n     if       Menu-Reply = 1     *> Cust & Item reports\n              perform  ba020-Cust-Report thru ba020-Exit\n              perform  ba030-Item-Report thru ba030-Exit\n              go to    ba999-Exit.\n*>\n     if       Menu-Reply =  2\n              perform  ba020-Cust-Report thru ba020-Exit\n              go to    ba999-Exit.\n*>\n     perform  ba030-Item-Report thru ba030-Exit.\n     go to    ba999-Exit.\n*>\n ba020-Cust-Report.\n     open     input    BO-Stk-Itm-File.\n     if       FS-Reply not = zero\n              display  \"BO Open Failure = \" at line ws-23-lines col 1 with erase eos\n              display  FS-Reply at line ws-23-lines col 19\n              display  SL006    at line ws-Lines col 1\n              accept   WS-Reply at line ws-lines col 45\n              close    BO-Stk-Itm-File\n              go to    ba020-Exit.\n     move     60       to WS-Line-No.\n     move     zero     to WS-Page-No.\n     start    BO-Stk-Itm-File FIRST.\n     perform  until exit\n              read     BO-Stk-Itm-File next at end\n                       close   BO-Stk-Itm-File\n                       exit perform\n              end-read\n              if       FS-Reply not = zero\n                       close   BO-Stk-Itm-File\n                       exit perform\n              end-if\n              perform  ba110-Move-Cust\n              exit     perform cycle\n     end-perform.\n*>\n ba020-Exit.\n     exit.\n*>\n ba030-Item-Report.\n     open     input    BO-Stk-Itm-File.\n     if       FS-Reply not = zero\n              display  \"BO Open Failure = \" at line ws-23-lines col 1 with erase eos\n              display  FS-Reply at line ws-23-lines col 19\n              display  SL006    at line ws-Lines col 1\n              accept   WS-Reply at line ws-lines col 45\n              close    BO-Stk-Itm-File\n              go to    ba030-Exit.\n     move     60       to WS-Line-No.\n     move     zero     to WS-Page-No.\n     start    BO-Stk-Itm-File FIRST.   *>  key BO-Stk-Item-No.\n     perform  until exit\n              read     BO-Stk-Itm-File next at end\n                       close   BO-Stk-Itm-File\n                       exit perform\n              end-read\n              if       FS-Reply not = zero\n                       close   BO-Stk-Itm-File\n                       exit perform\n              end-if\n              perform  ba120-Move-Item\n              exit     perform cycle\n     end-perform.\n*>\n ba030-Exit.\n     exit.\n*>\n ba999-Exit.\n     exit     section.\n*>\n bb100-Cust-Heads  section.\n*>************************\n*>\n     if       WS-Line-No not > Page-Lines\n              go to bb100-Exit.\n     add      1 to WS-Page-No.\n     move     WS-Page-No to L1-Page.\n     if       WS-Page-No = 1\n              write    Print-Record from Line-1 before 1\n              write    Print-Record from Line-3 before 1\n              write    Print-Record from Line-4 after 1\n              write    Print-Record from Line-5 after 1\n     else\n              write    Print-Record from Line-1 after page\n              write    Print-Record from Line-3 after 1\n              write    Print-Record from Line-4 after 2\n              write    Print-Record from Line-5 after 1\n     end-if\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n     move     6 to WS-Line-No.\n*>\n bb100-Exit.  exit  section.\n*>\n bc100-Item-Heads  section.\n*>************************\n*>\n     if       WS-Line-No not > Page-Lines\n              go to bc100-Exit.\n     add      1 to WS-Page-No.\n     move     WS-Page-No to L2-Page.\n     if       WS-Page-No = 1\n              write    Print-Record from Line-2 before 1\n              write    Print-Record from Line-3 before 1\n              write    Print-Record from Line-6 after 1\n              write    Print-Record from Line-7 after 1\n     else\n              write    Print-Record from Line-2 after page\n              write    Print-Record from Line-3 after 1\n              write    Print-Record from Line-6 after 2\n              write    Print-Record from Line-7 after 1\n     end-if\n     move     spaces to Print-Record.\n     write    Print-Record after 1.\n     move     6 to WS-Line-No.\n*>\n bc100-Exit.  exit  section.\n*>\n ba110-Move-Cust    section.\n*>*************************\n*>\n     perform  bb100-Cust-Heads.\n     move     spaces              to Line-8.\n     move     BO-Stk-Cust-No      to L8-Cust.\n     move     BO-Stk-Item-No      to L8-Item-No.\n     if       BO-Serial not = zero\n              move     \":\"        to L8-Slash\n              move     BO-Serial  to L8-Serial-No\n     else\n              move     space      to L8-Slash.\n*>\n     move     BO-Stk-PO           to L8-PO.\n     move     BO-Stk-Orig-Inv-No  to L8-Orig-Inv.\n     move     BO-Stk-BO-Qty       to L8-Qty.\n*>\n     move     BO-Stk-BO-Arr-Date  to U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L8-Arr-Date.\n     move     BO-Stk-Order-Date   to U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L8-Ord-Date.\n*>\n     move     BO-Stk-Price        to L8-Price.\n     move     BO-Stk-Arrived-Flag to L8-Flag.\n     if       BO-Stk-Inv-Type not < 1 and not > 4\n              move     WS-Inv-Type (BO-Stk-Inv-Type) to L8-Inv-Type\n     else\n              move     \"UNKNOWN\" to L8-Inv-Type.\n*>\n     if       WS-Cust-No not = BO-Stk-Cust-No\n              move     BO-Stk-Cust-No to WS-Cust-No\n              write    Print-Record from Line-8 after 2\n              add      2 to WS-Line-No\n     else\n              write    Print-Record from Line-8 after 1\n              add      2 to WS-Line-No\n     end-if.\n*>\n ba110-Exit.\n     exit     section.\n*>\n ba120-Move-Item    section.\n*>*************************\n*>\n     perform  bc100-Item-Heads.\n     move     spaces              to Line-9.\n     move     BO-Stk-Cust-No      to L9-Cust.\n     move     BO-Stk-Item-No      to L9-Item-No.\n     if       BO-Serial not = zero\n              move     \":\"        to L9-Slash\n              move     BO-Serial  to L9-Serial-No\n     else\n              move space          to L9-Slash.\n*>\n     move     BO-Stk-PO           to L9-PO.\n     move     BO-Stk-Orig-Inv-No  to L9-Orig-Inv.\n     move     BO-Stk-BO-Qty       to L9-Qty.\n*>\n     move     BO-Stk-BO-Arr-Date  to U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L9-Arr-Date.\n     move     BO-Stk-Order-Date   to U-Bin\n     perform  zz060-Convert-Date\n     move     WS-Date             to L9-Ord-Date.\n*>\n     move     BO-Stk-Price        to L9-Price.\n     move     BO-Stk-Arrived-Flag to L9-Flag.\n     if       BO-Stk-Inv-Type not < 1 and not > 4\n              move     WS-Inv-Type (BO-Stk-Inv-Type) to L9-Inv-Type\n     else\n              move     \"UNKNOWN\" to L9-Inv-Type.\n*>\n     if       WS-Item-No not = BO-Stk-Item-No\n              move     BO-Stk-Item-No to WS-Item-No\n              write    Print-Record from Line-9 after 2\n              add      2 to WS-Line-No\n     else\n              write    Print-Record from Line-9 after 1\n              add      2 to WS-Line-No\n     end-if.\n*>\n ba120-Exit.\n     exit     section.\n*>\n CA000-Amend     section.\n*>**********************\n*>\n*> Used for Input and Amend modes\n*>\n CA010-Main.\n     open     i-o      BO-Stk-Itm-File.\n     perform  Stock-Open-Input.\n     if       FS-Reply not = zero\n              move   \"N\" to WS-Stock-Flag\n     else\n              move   \"Y\" to WS-Stock-Flag.\n     perform  Sales-Open-Input.\n     if       FS-Reply not = zero\n              move   \"N\" to WS-Sales-Flag\n     else\n              move   \"Y\" to WS-Sales-Flag.\n*>\n     display   \" \" at 0401 with erase eos.\n     display   Display-02.\n*>\n CA020-Get-Mode.\n     move     space to WS-Data-Mode.\n     display  \" \" at 1201 with erase eol.  *> Clear Deletes DONE msg if there.\n     accept   Display-02.\n     move     FUNCTION UPPER-CASE (WS-Data-Mode) to WS-Data-Mode.\n     if       not WS-Valid-Modes and\n              Cob-Crt-Status not = Cob-Scr-Esc\n              display  SL215 at line WS-Lines col 1 with foreground-color 4  *> Invalid mode\n              go to CA020-get-Mode.\n*>\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to ca998-Exit.            *> close open files",
        "line": 85
      },
      {
        "type": "IF",
        "condition": "Cob-Crt-Status = Cob-Scr-Esc\n              go to ca998-Exit.\n*>\n     accept   WS-BO-Stk-Item-No at 0809 with foreground-color 3 UPPER.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to ca998-Exit.\n     display  \" \" at 0412 with erase eol.\n     display  \" \" at line WS-Lines col 1 erase eol.\n*>\n     move     WS-BO-Cust-Itm-No to BO-Cust-Itm-No.\n     move     zeros to FS-Reply.\n     read     BO-Stk-Itm-File  KEY\n                               BO-Cust-Itm-No.\n     move     BO-Stk-Itm-Record to WS-BO-Stk-Itm-Record.\n*>\n*> If valid rec is in both areas otherwise on in WS-BO etc.\n*>\n     if       (WS-Mode-Amend or\n              WS-Mode-Delete) and\n              FS-Reply not = zeroes\n              display  SL208 at line WS-Lines col 10 with foreground-color 4\n                                                          highlight beep\n              display  FS-Reply at line WS-Lines col 45 with foreground-color 3\n              go to CA030-Get-Key.\n*>\n     if       WS-Mode-Input and\n              FS-Reply = zeroes\n              display  SL209 at line WS-Lines col 10 with foreground-color 4\n                                                          highlight beep\n              go to CA030-Get-Key.\n     display  \" \" at line WS-Lines col 10 erase eol.\n*>\n*> Get and display the itm desc and cust name\n*>\n     move     1 to File-Key-No.\n     move     WS-BO-Stk-Item-No to WS-Stock-Key.\n     if       WS-Stock-Flag = \"Y\"\n              perform  Stock-Read-Indexed\n              if       fs-Reply = 23 or = 21\n                       move  \"Not Found \" to WS-Stock-Desc.\n*>\n     move     WS-BO-Stk-Cust-No  to  WS-Sales-Key.\n     if       WS-Sales-Flag = \"Y\"\n              perform  Sales-Read-Indexed.\n              if       FS-Reply = 21 or = 23\n                       move  \"Not Found \" to Sales-Name.\n*>\n     display  Display-04-Cust-Stock.\n*>\n CA040-Get-Confirm-Delete.\n     if       WS-Mode-Delete\n              move    \"N\" to WS-Reply\n              display \"Confirm Delete (Y/N) - [ ]\" at 1201 with foreground-color 2\n                                                                erase eol\n              accept  WS-Reply at 1225 with foreground-color 3 update UPPER\n              if      WS-Reply not = \"Y\" and not = \"N\"\n                      display SL216 at 1230 with foreground-color 4 highlight beep  *> Y OR N !\n                      go to CA040-Get-Confirm-Delete\n              end-if\n              if      WS-Reply = \"Y\"\n                      move    WS-BO-Cust-Itm-No to BO-Cust-Itm-No\n                      delete  BO-Stk-Itm-File Record\n                      if      FS-Reply not = zero\n                              display  SL210 at 1201 with foreground-color 4\n                                                          erase eol highlight beep\n                              display FS-Reply at 1242\n                              display SL003    at 1245\n                              accept  WS-Reply at 1275\n                      end-if\n              end-if\n              go to CA020-Get-Mode.\n*>\n*> Must be WS-Mode-Amend or WS-Mode-Input\n*>\n     if       WS-Mode-Input\n              if       Date-UK\n                       move     \"dd/mm/ccyy\" to WS-Ord-Date *> all in WS area\n              else\n               if      Date-USA\n                       move     \"mm/dd/ccyy\" to WS-Ord-Date\n               else\n                       move     \"ccyy/mm/dd\" to WS-Ord-Date\n               end-if\n              end-if\n              move     5 to WS-BO-Stk-Inv-Type        *> For display-03 for spaces\n     else    *> Using temp dates in local format converting from binary since 1601\n              move     WS-BO-Stk-BO-Arr-Date to U-Bin\n              perform  zz060-Convert-Date\n              move     WS-Date to WS-Est-Date             *> Not used for displays here\n              move     WS-BO-Stk-Order-Date to U-Bin\n              perform  zz060-Convert-Date\n              move     WS-Date to WS-Ord-Date             *> In WS area Only\n     end-if.  *>  Now local date format\n     display  Display-03.\n     if       WS-Mode-Input\n              accept   WS-BO-Stk-PO       at 0826 with foreground-color 3 Update\n              accept   WS-BO-Stk-BO-Qty   at 0837 with foreground-color 3 Update. *> could use accept_numeric routine\n*>\n CA050-Get-Ord-Date.\n     display  WS-Ord-Date at 0844 with foreground-color 3.\n     if       WS-Mode-Input\n              accept   WS-Ord-Date  at 0844 with foreground-color 3 Update  *> using  WS temp field\n              if       WS-Ord-Date (1:2) not = zeros and   *> test date for valid range\n                                         not = spaces and\n                                         not = \"dd\"   and\n                                         not = \"mm\"   and\n                                         not = \"cc\"\n                       move     WS-Ord-Date to WS-Test-Date\n                       perform  zz080-Convert-Local-To-Bin-Date\n                       if       Return-Code not = zeros\n                                display  SL211 at line ws-lines col 1 with foreground-color 4 highlight\n                                                                           erase eol\n                                go to CA050-Get-Ord-Date\n                       else\n                                display \" \" at line WS-Lines col 1 erase eol\n                       end-if.\n              move     FUNCTION INTEGER-OF-DATE (WS-Temp-Date-YMD9) to WS-BO-Stk-Order-Date.\n*>\n CA060-Get-Est-Date.\n     move     Stock-Retail to WS-BO-Stk-Price.  *> Preload the price for input\n*>\n     if       WS-Mode-Amend and\n              WS-BO-Stk-Price not = Stock-Retail\n              display  \" \" at 0855 with erase eol\n              move     Stock-Retail to WS-Disp-Price\n              display  SL217   at 1310 with foreground-color 4 highlight beep\n              display  WS-Disp-Price at 1357 with foreground-color 4\n              display  \"Stock Price\" at 1369 with foreground-color 2\n     else\n              display \" \" at 1310 erase eol.\n*>\n CA070-Get-Inv-Type.\n     display  \" \" at 0855 with erase eol.\n     accept   WS-BO-Stk-Inv-Type  at 0872 with foreground-color 3 update.\n     if       WS-BO-Stk-Inv-Type not = 1 and not = 2 and not = 4\n              display  SL218  at line WS-23-Lines col 1 with foreground-color 4\n                                                             highlight beep\n              go to CA070-Get-Inv-Type\n     else\n              display \" \" at 1310 erase eol.\n*>\n CA080-Price.\n     if       WS-Mode-Input OR\n              (WS-Mode-Amend AND\n              WS-BO-Stk-Inv-Type = 2 or = 4)  *> Amend/Onput, invoice or proforma only, otherwise price is fixed\n *>             MOVE     8   TO AN-LINE   *> as cust. has prepaid or pre-ordered against price\n *>             MOVE     55  TO AN-COLUMN\n*>              set      AN-MODE-IS-UPDATE TO TRUE\n *>             call     static \"ACCEPT_NUMERIC\" using by REFERENCE WS-BO-Stk-Price    *> HAD STATIC\n *>                                                    by REFERENCE AN-ACCEPT-NUMERIC\n *>             perform  AN-Test-Status.\n              accept   WS-Disp-Price at 0855 foreground-color 3 UPDATE\n              move     WS-Disp-Price to WS-BO-Stk-Price\n     end-if\n*>\n     if       WS-Mode-Input\n              write    BO-Stk-Itm-Record from WS-BO-Stk-Itm-Record\n              if       FS-Reply NOT = zero     *> Should not happen but ...\n                       display  SL203 at line WS-23-Lines col 1 with foreground-color 4\n                                                                 highlight beep erase eos\n                       display  FS-Reply at line WS-23-Lines col 30 with foreground-color 3\n                                                                 highlight beep\n                       display  SL006  at line WS-Lines col 1\n                       accept   WS-Reply at line WS-Lines col 45\n                       display \" \" at line WS-Lines col 1 with erase eol\n              end-if\n              go to CA020-Get-Mode.\n*>\n     rewrite  BO-Stk-Itm-Record from WS-BO-Stk-Itm-Record.\n     if       FS-Reply NOT = zero     *> Should not happen but ...\n              display  SL204 at line WS-23-Lines col 1 with foreground-color 4\n                                                        highlight beep erase eos\n              display  FS-Reply at line WS-23-Lines col 32 with foreground-color 3\n                                                        highlight beep\n              display  SL006  at line WS-Lines col 1\n              accept   WS-Reply at line WS-Lines col 45\n*> OK try it, but should not work\n              write    BO-Stk-Itm-Record from WS-BO-Stk-Itm-Record.\n     go       to  CA020-Get-Mode.\n*>\n ca998-Exit.\n     if       WS-Sales-Flag = \"Y\"\n              perform  Sales-Close.\n     if       WS-Stock-Flag = \"Y\"\n              perform  Stock-Close.\n     close    BO-Stk-Itm-File.\n\n ca999-Exit.\n     exit     section.\n*>\n zz060-Convert-Date    section.\n*>****************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.  *> date now dd.mm.yyyy\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     u-date to WS-date.   *> UK date\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.  exit section.\n*>\n zz070-Convert-Date    section.\n*>****************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-date as uk/US/Inlt date format\n*>\n     move     to-day to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.  exit section.\n*>\n zz080-Convert-Local-To-Bin-Date  section.\n*>***************************************\n*>\n*> Input:  WS-Test-Date =  Local date\n*> Output: U-Bin  days since 1601\n*>\n     move     WS-Test-Date to WS-Date.\n     if       Date-USA                *> swap month and days\n              move WS-Year      to WS-Temp-Date-YMD (1:4)\n              move WS-USA-Month to WS-Temp-Date-YMD (5:2)\n              move WS-USA-Days  to WS-Temp-Date-YMD (7:2)\n              go to zz080-Conv-Common-Date.\n     if       Date-UK\n              move WS-Year      to WS-Temp-Date-YMD (1:4)\n              move WS-Month     to WS-Temp-Date-YMD (5:2)\n              move WS-Days      to WS-Temp-Date-YMD (7:2)\n              go to zz080-Conv-Common-Date.\n*>\n*> Must be intl\n*>\n     move     WS-Intl-Year  to WS-Temp-Date-YMD (1:4).\n     move     WS-Intl-Month to WS-Temp-Date-YMD (5:2).\n     move     WS-Intl-Days  to WS-Temp-Date-YMD (7:2).\n*>\n zz080-Conv-Common-Date.\n*>\n*> Date now yyyymmdd\n*>\n     move     FUNCTION TEST-FORMATTED-DATETIME (\"YYYYMMDD\", WS-Temp-Date-YMD9) to Return-Code.\n     if       Return-Code not = zero\n              go to zz080-Exit.\n     move     FUNCTION INTEGER-OF-DATE (WS-Temp-Date-YMD9) to U-Bin.\n     move     zero to Return-Code.\n*>\n zz080-Exit.  exit section.\n*>\n maps04             section.\n*>*************************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"an-accept.pl\".\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 804
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 2,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 114,
      "totalOperators": 80,
      "totalOperands": 160,
      "vocabulary": 115,
      "length": 240,
      "volume": 1642.91761222665
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
