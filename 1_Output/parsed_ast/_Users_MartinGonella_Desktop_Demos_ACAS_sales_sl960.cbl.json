{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl960.cbl",
  "fileName": "sl960.cbl",
  "timestamp": "2025-09-15T16:25:29.704Z",
  "programId": "sl960",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 105
      },
      {
        "name": "file",
        "line": 118
      },
      {
        "name": "working-storage",
        "line": 124
      },
      {
        "name": "linkage",
        "line": 199
      },
      {
        "name": "screen",
        "line": 208
      },
      {
        "name": "init01",
        "line": 300
      },
      {
        "name": "setup-customers",
        "line": 325
      },
      {
        "name": "oddsnsods",
        "line": 409
      },
      {
        "name": "test-escape",
        "line": 425
      },
      {
        "name": "customer-data",
        "line": 444
      },
      {
        "name": "validate-address",
        "line": 516
      },
      {
        "name": "validate-response",
        "line": 536
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 109
      },
      {
        "name": "file-defs",
        "line": 298
      },
      {
        "name": "menu-end",
        "line": 322
      },
      {
        "name": "customer-input",
        "line": 328
      },
      {
        "name": "customer-accept",
        "line": 334
      },
      {
        "name": "customer-details",
        "line": 366
      },
      {
        "name": "get-details",
        "line": 382
      },
      {
        "name": "main-output",
        "line": 390
      },
      {
        "name": "maps09",
        "line": 412
      },
      {
        "name": "clear-error-line",
        "line": 415
      },
      {
        "name": "clear-error-line-24",
        "line": 420
      },
      {
        "name": "get-escape",
        "line": 430
      },
      {
        "name": "Customer-Data-Main",
        "line": 447
      },
      {
        "name": "bypass-deliv-test",
        "line": 475
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps09",
        "line": 413,
        "type": "DYNAMIC",
        "using": [
          "customer-code"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 95,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 104,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 112,
        "replacing": null
      },
      {
        "name": "seldel",
        "line": 113,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 121,
        "replacing": null
      },
      {
        "name": "fddel",
        "line": 122,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 127,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 128,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 129,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 130,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 187,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 195,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 202,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 203,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 204,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 558,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 314
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 315
      },
      {
        "target": "Setup-Customers",
        "thru": null,
        "line": 318
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 319
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 320
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 343
      },
      {
        "target": "maps09",
        "thru": null,
        "line": 346
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 357
      },
      {
        "target": "customer-data",
        "thru": null,
        "line": 385
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 388
      },
      {
        "target": "Sales-Write",
        "thru": null,
        "line": 399
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 404
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 452
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 465
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 480
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 491
      },
      {
        "target": "clear-error-line-24",
        "thru": null,
        "line": 554
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 307
      },
      {
        "from": "spaces",
        "to": "customer-nos",
        "line": 332
      },
      {
        "from": "\"C\"",
        "to": "maps09-reply",
        "line": 345
      },
      {
        "from": "customer-code",
        "to": "WS-Sales-Key",
        "line": 355
      },
      {
        "from": "customer-code",
        "to": "WS-Sales-Key",
        "line": 370
      },
      {
        "from": "sl-charges",
        "to": "sales-late",
        "line": 371
      },
      {
        "from": "sl-dunning",
        "to": "sales-dunning",
        "line": 372
      },
      {
        "from": "sl-credit",
        "to": "sales-credit",
        "line": 373
      },
      {
        "from": "sl-disc",
        "to": "sales-discount",
        "line": 374
      },
      {
        "from": "sl-min",
        "to": "sales-late-min",
        "line": 375
      },
      {
        "from": "sl-max",
        "to": "sales-late-max",
        "line": 376
      },
      {
        "from": "sl-limit",
        "to": "sales-limit",
        "line": 377
      },
      {
        "from": "run-date",
        "to": "sales-create-date",
        "line": 378
      },
      {
        "from": "\"N\"",
        "to": "Sales-Partial-Ship-Flag",
        "line": 379
      },
      {
        "from": "1",
        "to": "sales-status",
        "line": 380
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 387
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type\n              move   WS-Sales-Key to WS-Deliv-Sales-Key\n              perform Delivery-Write",
        "line": 402
      },
      {
        "from": "zero",
        "to": "error-flag",
        "line": 448
      },
      {
        "from": "sales-address",
        "to": "test-address",
        "line": 451
      },
      {
        "from": "1",
        "to": "error-flag\n      else\n              display ws-spaces-10 at 0771",
        "line": 456
      },
      {
        "from": "zero",
        "to": "delivery-tag\n              go to bypass-deliv-test",
        "line": 461
      },
      {
        "from": "deliv-address",
        "to": "test-address",
        "line": 464
      },
      {
        "from": "1",
        "to": "error-flag\n      else\n              display ws-spaces-10 at 1071",
        "line": 469
      },
      {
        "from": "1",
        "to": "delivery-tag",
        "line": 473
      },
      {
        "from": "a01-late-charg",
        "to": "ws-reply",
        "line": 478
      },
      {
        "from": "z",
        "to": "sales-late\n              display ws-spaces-7 at 1524\n     else\n              display \"Error\" at 1524 with foreground-color 4\n              move 1 to error-flag",
        "line": 483
      },
      {
        "from": "a01-dun-letter",
        "to": "ws-reply",
        "line": 489
      },
      {
        "from": "z",
        "to": "sales-dunning\n     else\n              display \"Error\" at 1624 with foreground-color 4\n              go to customer-data-Main",
        "line": 495
      },
      {
        "from": "\"N\"",
        "to": "Sales-Partial-Ship-Flag",
        "line": 502
      },
      {
        "from": "1",
        "to": "Error-Flag\n              display \"Error\" at 1232 with foreground-color 4",
        "line": 507
      },
      {
        "from": "zero",
        "to": "a",
        "line": 519
      },
      {
        "from": "zero",
        "to": "truth\n     else\n              move  1  to  truth",
        "line": 523
      },
      {
        "from": "zero",
        "to": "a",
        "line": 527
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 531
      },
      {
        "from": "1",
        "to": "truth",
        "line": 539
      },
      {
        "from": "1",
        "to": "z\n     else\n      if      ws-reply  = \"N\"\n              move  0  to  z\n      else\n              move  0  to  truth",
        "line": 543
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "needed.         *\n*>                                                                *\n*>  Could be changed to do so though, time, time .                *\n*>                                                                *\n*>*****************************************************************\n*>\n identification          division.\n*>===============================\n*>\n      program-id.         sl960.\n*>**\n*>    Author.             Cis Cobol Conversion By V B Coen, FBCS, FIDM, FIDPM 18/10/83\n*>                        For Applewood Computers.\n*>**\n*>    Security.           Copyright (C) 1976-2025 & later, Vincent Bryan Coen.\n*>                        Distributed under the GNU General Public License.\n*>                        See the file COPYING for details.\n*>**\n*>    Remarks.            Sales Ledger Customer File Creation For\n*>                        Invoice Data Entry Program (Sl910).\n*>**\n*>    Version.            See Prog-Name & Date-Comped In Ws.\n*>**\n*>    Called Modules.     Maps09.\n*>                        acas012  ->       (Sales)\n*>                         salesMT.\n*>                        acas014  ->       (Delivery)\n*>                         deliveryMT.\n*>**\n*>    Error messages used.\n*>                        SL131\n*>                        SL132\n*>**\n*>    Changes.\n*> 16/02/83 vbc - 240570-680:Fixes Date Err On Sales-Last Etc.\n*> 20/03/83 Vbc - 320210:Fix On Sales Rec Not Fount Error.\n*> 22/04/83 Vbc - Fix Display Deliv Name ,310220.\n*> 10/10/83 Vbc - Chg Printer To Use Line-Cnt,Also Clear Display\n*>                Fault On Cust Setup.\n*> 22/10/83 Vbc - Conversion To Cis Cobol.\n*> 30/10/83 Vbc - Converted From Sl010.\n*> 06/03/84 Vbc - Support New Sales File Fields Pay-Average Etc.\n*> 28/04/84 Vbc - Support New Sales File Fields Ext, Tlx.\n*> 12/07/84 Vbc - Move Escape Box 5 Chars Right.\n*> 03/03/09 Vbc - Migration to Open Cobol v3.00.00.\n*> 26/11/11 vbc - .01 Error msgs to SLnnn.Support for dates other than UK (Neither used here)\n*> 08/12/11 vbc - .02 Support for path+filenames.\n*> 09/12/11 vbc -     Updated version to 3.01.nn\n*> 27/02/12 vbc - .03 Changed use of check-digit' in 'sales-key to WS-Sales-Key (7:1) for SQL processing.\n*> 24/10/16 vbc - .04 ALL programs now using wsnames.cob in copybooks\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*> 19/01/17 vbc - .05 Added remaining FH processing now complete.\n*>                    Replaced usage of maps99 with display/s.\n*> 25/01/17 vbc       Dry testing completed.\n*> 10/12/22 vbc   .06 Added para after some sections 4 GC 3.2 warning msgs.\n*> 15/03/24 vbc - .07 Added support for field Sales-Partial-Ship-Flag for input\n*>                    display and reporting. Chg case for FUNCTION, UPPER-CASE.\n*>                    as of and from sl010.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n*> copy \"seldel.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdsl.cob\".\n*> copy \"fddel.cob\".\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"SL960 (3.02.07)\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps09.cob\".\n copy \"wssl.cob\".\n copy \"wsdel.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  ws-data.\n     02  filler.\n     03  ws-reply        pic x.\n     03  a               pic 999.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  error-flag      pic 9           value zero.\n     03  escape-code     pic x.\n     03  truth           pic 9.\n         88  a-true                   value  1.\n         88  a-false                  value  0.\n     03  test-address    pic x(92).\n     03  ws-spaces-10                    value spaces.\n         05  ws-spaces-7 pic x(7).\n         05  filler      pic xxx.\n     03  d24-02          pic x           value space.\n     03  d24-03          pic x           value space.\n     03  d24-check.\n         05  filler      pic x(13)       value \"Check Digit {\".\n         05  d24-digit   pic x           value space.\n         05  filler      pic x           value \"}\".\n     03  A01-Notes.\n         05  a01-Notes-1 pic x(48)       value spaces.\n         05  a01-Notes-2 pic x(48)       value spaces.\n     03  a01-late-charg  pic x           value space.\n     03  a01-dun-letter  pic x           value space.\n     03  ws-env-lines    pic 999         value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Error-Messages.\n *> System Wide\n *> Module Specific\n     03  SL131           pic x(31) value \"SL131 Response Must Be (Y or N)\".\n     03  SL132           pic x(36) value \"SL132 Customer Record Already Exists\".\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  error-code          pic 999.\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(8).\n*>\n screen section.\n*>=============\n*>\n 01  display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  value \"Customer Nos : [\"    line  4 col  6.\n*> >>>>>>>> customer no here <<<<<<<\n     03  from d24-02          pic x  line  4 col 28.\n     03  from d24-03          pic x          col 29.\n     03  from d24-check       pic x(15)      col 31.\n     03  value \"Customer Name: [\"    line  6 col  6.\n     03  using sales-name  pic x(30) line  6 col 22.\n     03  value \"]\"                   line  6 col 52.\n     03  value \"Addr: [\"             line  7 col 15.\n     03  using sales-addr1    pic x(48)      col 22.\n     03  value \"]\"                   line  7 col 70.\n     03  value \"[\"                   line  8 col 21.\n     03  using sales-addr2    pic x(48)      col 22.\n     03  value \"]\"                   line  8 col 70.\n     03  value \"Delivery name: [\"    line  9 col  6.\n     03  using deliv-name     pic x(30)      col 22.\n     03  value \"]\"                           col 52.\n     03  value \"Addr: [\"             line 10 col 15.\n     03  using deliv-addr1    pic x(48)      col 22.\n     03  value \"]\"                           col 70.\n     03  value \"[\"                   line 11 col 21.\n     03  using deliv-addr2    pic x(48)      col 22.\n     03  value \"]\"                           col 70.\n*> added 15/03/24\n     03  value \"BO Allowed - [\"      line 12 col  6.\n     03  using Sales-Partial-Ship-Flag\n                              pic x          col 20.\n     03  value \"] (Y or N)\"                  col 21.\n*>\n     03  value \"Telephone    : [\"    line 13 col  6.\n     03  using sales-phone    pic x(13)      col 22.\n     03  value \"]\"                           col 35.\n     03  value \"Ext: [\"                      col 37.\n     03  using sales-ext      pic x(4)       col 43.\n     03  value \"]\"                           col 47.\n     03  value \"Fax : [\"                     col 50.\n     03  using sales-fax      pic x(13)      col 57.\n     03  value \"]\"                           col 70.\n     03  value \"Email Sales  : [\"    line 14 col  6.\n     03  using sales-email    pic x(30)      col 22.\n     03  value \"]\"                           col 52.\n     03  value \"Late charges : [\"    line 15 col  6.\n     03  using a01-late-charg  pic x         col 22.\n     03  value \"]\"                           col 23.\n     03  value \"Minimum balance before late charge : [\" col 31.\n     03  using sales-late-min pic 9(4)       col 69.\n     03  value \"]\"                           col 73.\n     03  value \"Late letters : [\"    line 16 col  6.\n     03  using a01-dun-letter  pic x         col 22.\n     03  value \"]\"                           col 23.\n     03  value \"Maximum late charge\"         col 31.\n     03  value \": [\"                         col 66.\n     03  using sales-late-max pic 9(4)       col 69.\n     03  value \"]\"                           col 73.\n     03  value \"Credit period: [\"    line 17 col  6.\n     03  using sales-credit   pic 99         col 22.\n     03  value \"]\"                           col 24.\n     03  value \"Credit limit : [\"    line 18 col  6.\n     03  using sales-limit    pic 9(7)       col 22.\n     03  value \"] Discount : [\"              col 29.\n     03  using sales-discount pic 99v99      col 43.\n     03  value \"]\"                           col 47.\n     03  value \"Unapplied Bal: {\"    line 19 col  6.\n     03  value \"}\"                           col 34.\n     03  value \"*******************\"         col 61.\n     03  value \"Current Bal  : {\"    line 20 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 34.\n     03  value \"* Escape Code [\"             col 61.\n     03  using escape-code    pic x          col 76.\n     03  value \"] *\"                         col 77.\n     03  value \"Last invoice : {\"    line 21 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 30.\n     03  value \"* <B> = Back      *\"         col 61.\n     03  value \"Last payment : {\"    line 22 col  6.\n*> value entered by individual display\n     03  value \"}\"                           col 30.\n     03  value \"* <S> = Save      *\"         col 61.\n     03  value \"* <Q> = Quit      *\" line 23 col 61.\n     03  value \"*******************\" line 24 col 61.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n init01 section.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     display  prog-name at 0101 with erase eos foreground-color 2.\n*>\n     perform  Sales-Open.            *> open     i-o sales-file delivery-file.\n     perform  Delivery-Open.\n     display \" \" at line 3 col 1 with erase eos.\n*>\n     perform  Setup-Customers.\n     perform  Sales-Close.      *>  close    sales-file delivery-file.\n     perform  Delivery-Close.\n*>\n menu-end.\n     exit     program.\n*>\n setup-customers         section.\n*>==============================\n*>\n customer-input.\n*>*************\n*>\n     display  display-02.\n     move     spaces to customer-nos.\n*>\n customer-accept.\n*>**************\n*>\n     accept   customer-nos at 0422 with foreground-color 3 update.\n     if       customer-nos  = spaces\n              go to  main-end.\n     move     FUNCTION UPPER-CASE (customer-nos) to customer-nos.\n     display  customer-nos at 0422 with foreground-color 3.\n*>\n     perform  clear-error-line.\n*>\n     move     \"C\"  to  maps09-reply.\n     perform  maps09.\n     if       maps09-reply  not = \"Y\"\n              go to  customer-input.\n*>\n     move     check-digit of maps09-ws  to   WS-Sales-Key (7:1).\n     display  WS-Sales-Key (7:1) at 0444 with foreground-color 3.\n*>     move     check-digit of maps09-ws  to   check-digit of WS-Sales-Record.\n*>     display  check-digit of WS-Sales-Record at 0444 with foreground-color 3.\n*>\n     move     customer-code  to  WS-Sales-Key.\n*>\n     perform  Sales-Read-Indexed.           *> read sales-file  invalid key\n     if       fs-reply = 21 or 23\n              go to  customer-details.\n*>\n*> Record already exists.\n*>\n     display  SL132  at 2301      with foreground-color 4.\n     go       to customer-accept.\n*>\n customer-details.\n*>***************\n*>\n     initialize WS-Sales-Record WS-Delivery-Record.\n     move     customer-code to  WS-Sales-Key.\n     move     sl-charges    to  sales-late.\n     move     sl-dunning    to  sales-dunning.\n     move     sl-credit     to  sales-credit.\n     move     sl-disc       to  sales-discount.\n     move     sl-min        to  sales-late-min.\n     move     sl-max        to  sales-late-max.\n     move     sl-limit      to  sales-limit.\n     move     run-date      to  sales-create-date.\n     move     \"N\"           to  Sales-Partial-Ship-Flag.\n     move     1             to  sales-status.                   *>  Live\n*>\n get-details.\n*>**********\n*>\n     perform  customer-data.\n*>\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>**********\n*>\n     if       escape-code  = \"B\"\n              go to get-details.\n*>\n     if       escape-code  = \"Q\"\n              go to  main-end.\n*>\n     perform  Sales-Write.           *> write    sales-record.\n*>\n     if       delivery-tag  not = zero\n              move   \"D\"          to WS-Deliv-Key-Type\n              move   WS-Sales-Key to WS-Deliv-Sales-Key\n              perform Delivery-Write.        *> write  delivery-record.\n*>\n main-end.    exit section.\n*>*******    ****\n*>\n oddsnsods section.\n*>****************\n*>\n maps09.\n     call     \"maps09\"  using  customer-code.\n*>\n clear-error-line.\n*>***************\n*>\n     display  \" \" at 2301 with erase eol.\n*>\n clear-error-line-24.\n*>******************\n*>\n     display  \" \" at 2401 with erase eol.\n*>\n test-escape  section.\n*>===================\n*>\n     display  escape-code at 2076 with foreground-color 6.\n*>\n get-escape.\n*>*********\n*>\n     accept   escape-code at 2076 with foreground-color 6 update.\n     move     FUNCTION UPPER-CASE (escape-code) to escape-code.\n*>\n     if       escape-code not = \"B\"\n                      and not = \"S\"\n                      and not = \"Q\"\n              go to get-escape.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n customer-data           section.\n*>==============================\n*>\n Customer-Data-Main.\n     move     zero to error-flag.\n     accept   display-02.\n*>\n     move     sales-address  to  test-address.\n     perform  validate-address.\n*>\n     if       a-false\n              display \"Addr Err\" at 0771 with foreground-color 4\n              move 1 to error-flag\n      else\n              display ws-spaces-10 at 0771.\n*>\n     if       deliv-name  = spaces\n              move  zero  to  delivery-tag\n              go to bypass-deliv-test.\n*>\n     move     deliv-address  to  test-address.\n     perform  validate-address.\n*>\n     if       a-false\n              display \"Addr Err\" at 1071 with foreground-color 4\n              move 1 to error-flag\n      else\n              display ws-spaces-10 at 1071.\n*>\n     move     1  to  delivery-tag.\n*>\n bypass-deliv-test.\n*>****************\n*>\n     move     a01-late-charg to ws-reply.\n*>\n     perform  validate-response.\n*>\n     if       a-true\n              move  z  to  sales-late\n              display ws-spaces-7 at 1524\n     else\n              display \"Error\" at 1524 with foreground-color 4\n              move 1 to error-flag.\n*>\n     move     a01-dun-letter to ws-reply.\n*>\n     perform  validate-response.\n*>\n     if       a-true\n              display ws-spaces-7 at 1624\n              move  z  to  sales-dunning\n     else\n              display \"Error\" at 1624 with foreground-color 4\n              go to customer-data-Main.\n*>\n     move     FUNCTION UPPER-CASE (Sales-Partial-Ship-Flag) to Sales-Partial-Ship-Flag.\n     if       Sales-Partial-Ship-Flag = space\n              move \"N\" to Sales-Partial-Ship-Flag.\n     if       Sales-Partial-Ship-Flag = \"Y\" or\n                                      = \"N\"\n              display ws-spaces-7 at 1232\n     else\n              move 1 to Error-Flag\n              display \"Error\" at 1232 with foreground-color 4.\n*>\n     if       error-flag not = zero\n              go to customer-data-Main.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n validate-address        section.\n*>==============================\n*>\n     move     zero  to  a.\n     inspect  test-address  tallying a for all sl-delim.\n*>\n     if       a  >  4  or  <  1\n              move  zero  to  truth\n     else\n              move  1  to  truth.\n*>\n     move     zero  to  a.\n     inspect  test-address  tallying  a for  characters  before initial  sl-delim.\n*>\n     if       a  >  30\n              move  zero  to  truth.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n validate-response       section.\n*>==============================\n*>\n     move     1  to  truth.\n*>\n     move     FUNCTION UPPER-CASE (ws-reply) to ws-reply.\n     if       ws-reply  = \"Y\"\n              move  1  to  z\n     else\n      if      ws-reply  = \"N\"\n              move  0  to  z\n      else\n              move  0  to  truth.\n*>\n     if       a-false\n              display SL131  at 2401\n              go to main-exit.\n*>\n     perform  clear-error-line-24.\n*>\n main-exit.   exit section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 7
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 52,
      "totalOperators": 36,
      "totalOperands": 72,
      "vocabulary": 53,
      "length": 108,
      "volume": 618.6154090928254
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
