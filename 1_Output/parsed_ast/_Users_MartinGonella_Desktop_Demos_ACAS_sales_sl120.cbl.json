{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl120.cbl",
  "fileName": "sl120.cbl",
  "timestamp": "2025-09-15T16:25:30.062Z",
  "programId": "sl120",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 115
      },
      {
        "name": "file",
        "line": 128
      },
      {
        "name": "working-storage",
        "line": 134
      },
      {
        "name": "linkage",
        "line": 383
      },
      {
        "name": "init01",
        "line": 399
      },
      {
        "name": "trail-balance",
        "line": 441
      },
      {
        "name": "headings-1",
        "line": 742
      },
      {
        "name": "report-analysis",
        "line": 768
      },
      {
        "name": "exit",
        "line": 912
      },
      {
        "name": "read-sales",
        "line": 914
      },
      {
        "name": "check-zero",
        "line": 1021
      },
      {
        "name": "zz050-Validate-Date",
        "line": 1051
      },
      {
        "name": "exit",
        "line": 1084
      },
      {
        "name": "zz060-Convert-Date",
        "line": 1086
      },
      {
        "name": "exit",
        "line": 1119
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1121
      },
      {
        "name": "exit",
        "line": 1149
      },
      {
        "name": "maps04",
        "line": 1151
      },
      {
        "name": "exit",
        "line": 1157
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 118
      },
      {
        "name": "file-defs",
        "line": 397
      },
      {
        "name": "menu-ent",
        "line": 434
      },
      {
        "name": "main-display-end",
        "line": 450
      },
      {
        "name": "date-input",
        "line": 458
      },
      {
        "name": "customer-input",
        "line": 472
      },
      {
        "name": "value-input",
        "line": 476
      },
      {
        "name": "read-perform",
        "line": 519
      },
      {
        "name": "read-open-item",
        "line": 528
      },
      {
        "name": "Read-Loop-Tests",
        "line": 552
      },
      {
        "name": "roi-1",
        "line": 561
      },
      {
        "name": "bypass-ageing",
        "line": 646
      },
      {
        "name": "bypass-age-go",
        "line": 658
      },
      {
        "name": "end-statement",
        "line": 687
      },
      {
        "name": "end-statement-end",
        "line": 712
      },
      {
        "name": "item-end",
        "line": 714
      },
      {
        "name": "accept-money",
        "line": 720
      },
      {
        "name": "main-end",
        "line": 729
      },
      {
        "name": "main-exit",
        "line": 911
      },
      {
        "name": "Read-Sales-Main",
        "line": 917
      },
      {
        "name": "read-sales-test",
        "line": 980
      },
      {
        "name": "main-end",
        "line": 1006
      },
      {
        "name": "test-for-inv",
        "line": 1011
      },
      {
        "name": "test2",
        "line": 1034
      },
      {
        "name": "test3",
        "line": 1041
      },
      {
        "name": "zz050-test-date",
        "line": 1078
      },
      {
        "name": "zz050-exit",
        "line": 1083
      },
      {
        "name": "zz060-Exit",
        "line": 1118
      },
      {
        "name": "zz070-Exit",
        "line": 1148
      },
      {
        "name": "maps04-exit",
        "line": 1156
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 416,
        "type": "DYNAMIC",
        "using": [
          "File-19",
          "*>",
          "Open",
          "ITM3",
          "file",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "SL151",
          "at",
          "2301",
          "display",
          "SL003",
          "at",
          "2401",
          "accept",
          "ws-reply",
          "at",
          "2430",
          "go",
          "to",
          "menu-ent"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 432,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 1154,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 105,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 114,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 121,
        "replacing": null
      },
      {
        "name": "slselois",
        "line": 122,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 123,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 131,
        "replacing": null
      },
      {
        "name": "slfdois",
        "line": 132,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 133,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 138,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 139,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 140,
        "replacing": null
      },
      {
        "name": "wsoi",
        "line": 141,
        "replacing": null
      },
      {
        "name": "slwsoi3",
        "line": 142,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 143,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 179,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 182,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 386,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 387,
        "replacing": null
      },
      {
        "name": "wssys4",
        "line": 388,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 389,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1161,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "bypass-ageing",
        "thru": null,
        "line": 50
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 426
      },
      {
        "target": "Trail-Balance",
        "thru": null,
        "line": 429
      },
      {
        "target": "Report-Analysis",
        "thru": null,
        "line": 430
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 465
      },
      {
        "target": "accept-money",
        "thru": null,
        "line": 478
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 483
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 484
      },
      {
        "target": "OTM3-Open-Input",
        "thru": null,
        "line": 494
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 496
      },
      {
        "target": "Sales-Start",
        "thru": null,
        "line": 514
      },
      {
        "target": "read-sales",
        "thru": null,
        "line": 520
      },
      {
        "target": "OTM3-Read-Next-Sorted-By-Cust",
        "thru": null,
        "line": 536
      },
      {
        "target": "bypass-ageing",
        "thru": null,
        "line": 559
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 571
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 578
      },
      {
        "target": "check-zero",
        "thru": null,
        "line": 596
      },
      {
        "target": "check-zero",
        "thru": null,
        "line": 604
      },
      {
        "target": "check-zero",
        "thru": null,
        "line": 623
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 735
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 737
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 774
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 918
      },
      {
        "target": "read-sales-test",
        "thru": null,
        "line": 948
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 967
      },
      {
        "target": "end-statement",
        "thru": null,
        "line": 977
      },
      {
        "target": "test-for-inv",
        "thru": null,
        "line": 1000
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1081
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1095
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 412
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 414
      },
      {
        "from": "zero",
        "to": "cob-crt-status",
        "line": 459
      },
      {
        "from": "ws-date",
        "to": "ws-test-date",
        "line": 464
      },
      {
        "from": "ws-date",
        "to": "l3-date",
        "line": 469
      },
      {
        "from": "u-bin",
        "to": "entered-date",
        "line": 470
      },
      {
        "from": "0750",
        "to": "curs",
        "line": 477
      },
      {
        "from": "amt-ok",
        "to": "pay-value",
        "line": 479
      },
      {
        "from": "zero",
        "to": "page-nos",
        "line": 482
      },
      {
        "from": "customer-in",
        "to": "WS-Sales-Key",
        "line": 511
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 513
      },
      {
        "from": "1",
        "to": "y",
        "line": 516
      },
      {
        "from": "99",
        "to": "fs-reply2\n                      go to    end-statement\n              end-if\n              go to Read-Loop-Tests\n     end-if\n*>\n     read     open-item-file-s at end\n              move 99 to fs-reply2\n              go to    end-statement",
        "line": 538
      },
      {
        "from": "open-item-record-s",
        "to": "oi-header",
        "line": 550
      },
      {
        "from": "oi-customer",
        "to": "last-read",
        "line": 553
      },
      {
        "from": "zero",
        "to": "oi-invoice",
        "line": 573
      },
      {
        "from": "oi-invoice",
        "to": "l5-invoice",
        "line": 574
      },
      {
        "from": "oi-hold-flag",
        "to": "l5-hold",
        "line": 575
      },
      {
        "from": "oi-date",
        "to": "u-bin",
        "line": 577
      },
      {
        "from": "ws-date",
        "to": "l5-date",
        "line": 579
      },
      {
        "from": "inv-amount",
        "to": "l5-bal-0\n              perform check-zero\n              go to bypass-ageing",
        "line": 595
      },
      {
        "from": "0",
        "to": "b\n     else     move 1 to b",
        "line": 614
      },
      {
        "from": "1",
        "to": "work-1",
        "line": 618
      },
      {
        "from": "amount-out",
        "to": "l5-bal-0\n              perform check-zero\n              add amount-out to tot-bal-0\n              add b to inv-0\n     else\n      if      work-1  <  60\n              add  amount-out  to  bal-30\n              move amount-out to l5-bal-30\n              add amount-out to tot-bal-30\n              add b to inv-30\n      else\n       if     work-1  <  90\n              add  amount-out  to  bal-60\n              move amount-out to l5-bal-60\n              add amount-out to tot-bal-60\n              add b to inv-60\n       else\n              move amount-out to l5-bal-90\n              add  amount-out to tot-bal-90\n              add b to inv-90\n              add  amount-out  to  bal-90",
        "line": 622
      },
      {
        "from": "\"L\"",
        "to": "l5-late-only\n      else\n              move space to l5-late-only",
        "line": 666
      },
      {
        "from": "zero",
        "to": "amount-out",
        "line": 670
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 682
      },
      {
        "from": "bal-0",
        "to": "l6-bal-0",
        "line": 690
      },
      {
        "from": "bal-30",
        "to": "l6-bal-30",
        "line": 691
      },
      {
        "from": "bal-60",
        "to": "l6-bal-60",
        "line": 692
      },
      {
        "from": "bal-90",
        "to": "l6-bal-90",
        "line": 693
      },
      {
        "from": "bal-pay",
        "to": "l6-payments",
        "line": 694
      },
      {
        "from": "spaces",
        "to": "l6-lbalance\n              add 2 to line-cnt",
        "line": 699
      },
      {
        "from": "zero",
        "to": "bal-0   bal-30\n                        bal-60  bal-90\n                        bal-pay bal-t",
        "line": 706
      },
      {
        "from": "zero",
        "to": "ws-poundsd amt-ok ws-penced",
        "line": 723
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 726
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 727
      },
      {
        "from": "page-nos",
        "to": "l1-page",
        "line": 748
      },
      {
        "from": "prog-name",
        "to": "l1-version",
        "line": 749
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 750
      },
      {
        "from": "scycle",
        "to": "l3-period",
        "line": 752
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record from line-1 before 1\n     end-if\n     write    print-record  from  line-3 after 1",
        "line": 756
      },
      {
        "from": "zero",
        "to": "line-cnt",
        "line": 763
      },
      {
        "from": "spaces",
        "to": "line-4",
        "line": 772
      },
      {
        "from": "99",
        "to": "line-cnt",
        "line": 773
      },
      {
        "from": "inv-0",
        "to": "l10-0",
        "line": 778
      },
      {
        "from": "inv-30",
        "to": "l10-30",
        "line": 779
      },
      {
        "from": "inv-60",
        "to": "l10-60",
        "line": 780
      },
      {
        "from": "inv-90",
        "to": "l10-90",
        "line": 781
      },
      {
        "from": "a",
        "to": "l10-tot",
        "line": 783
      },
      {
        "from": "\"Amount\"",
        "to": "l8-head",
        "line": 785
      },
      {
        "from": "tot-bal-0",
        "to": "l8-0",
        "line": 786
      },
      {
        "from": "tot-bal-30",
        "to": "l8-30",
        "line": 787
      },
      {
        "from": "tot-bal-60",
        "to": "l8-60",
        "line": 788
      },
      {
        "from": "tot-bal-90",
        "to": "l8-90",
        "line": 789
      },
      {
        "from": "tot-os-bal",
        "to": "l8-tot work-2",
        "line": 794
      },
      {
        "from": "100",
        "to": "l8-tot",
        "line": 797
      },
      {
        "from": "work-1",
        "to": "l8-0",
        "line": 799
      },
      {
        "from": "work-1",
        "to": "l8-30",
        "line": 801
      },
      {
        "from": "work-1",
        "to": "l8-60",
        "line": 803
      },
      {
        "from": "work-1",
        "to": "l8-90",
        "line": 805
      },
      {
        "from": "zero",
        "to": "l8-0 l8-30 l8-60 l8-90",
        "line": 808
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 820
      },
      {
        "from": "tot-amt-unapp-pay",
        "to": "l8-0",
        "line": 822
      },
      {
        "from": "tot-no-unapp-pay",
        "to": "l10-tot",
        "line": 823
      },
      {
        "from": "\"Payments\"",
        "to": "l8-head",
        "line": 825
      },
      {
        "from": "sl-payments",
        "to": "l8-0",
        "line": 826
      },
      {
        "from": "tot-no-pay",
        "to": "l10-tot",
        "line": 827
      },
      {
        "from": "tot-no-cr-bal",
        "to": "l10-tot",
        "line": 830
      },
      {
        "from": "tot-amt-cr-bal",
        "to": "l8-0",
        "line": 831
      },
      {
        "from": "tot-amt-late",
        "to": "l8-0",
        "line": 834
      },
      {
        "from": "tot-no-late",
        "to": "l10-tot",
        "line": 835
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 837
      },
      {
        "from": "tot-acct-live",
        "to": "l10-tot",
        "line": 839
      },
      {
        "from": "tot-acct-active",
        "to": "l10-tot",
        "line": 842
      },
      {
        "from": "work-1",
        "to": "l8-tot",
        "line": 846
      },
      {
        "from": "spaces",
        "to": "line-10",
        "line": 852
      },
      {
        "from": "spaces",
        "to": "l10-head",
        "line": 855
      },
      {
        "from": "sl-os-bal-last-month",
        "to": "l8-tot",
        "line": 857
      },
      {
        "from": "sl-invoices-this-month",
        "to": "l8-tot",
        "line": 860
      },
      {
        "from": "tot-bal-60",
        "to": "l8-tot",
        "line": 865
      },
      {
        "from": "spaces",
        "to": "line-10",
        "line": 872
      },
      {
        "from": "tot-bal-0",
        "to": "l8-0",
        "line": 873
      },
      {
        "from": "spaces",
        "to": "line-10",
        "line": 875
      },
      {
        "from": "sl-credit-notes-this-month",
        "to": "l8-tot",
        "line": 876
      },
      {
        "from": "sl-payments",
        "to": "l8-tot",
        "line": 879
      },
      {
        "from": "tot-amt-late",
        "to": "l8-tot",
        "line": 882
      },
      {
        "from": "sl-credit-deductions",
        "to": "l8-tot",
        "line": 886
      },
      {
        "from": "spaces",
        "to": "line-10",
        "line": 892
      },
      {
        "from": "tot-bal-30",
        "to": "l8-0",
        "line": 893
      },
      {
        "from": "spaces",
        "to": "l11-f1",
        "line": 895
      },
      {
        "from": "tot-bal-0",
        "to": "l8-0 sl-os-bal-this-month",
        "line": 899
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 903
      },
      {
        "from": "sl-variance",
        "to": "l8-tot",
        "line": 905
      },
      {
        "from": "99",
        "to": "fs-reply\n              go to  main-end",
        "line": 920
      },
      {
        "from": "99",
        "to": "fs-reply\n              go to main-end",
        "line": 924
      },
      {
        "from": "99",
        "to": "fs-reply\n              go to main-end",
        "line": 929
      },
      {
        "from": "sales-name",
        "to": "l5-name",
        "line": 953
      },
      {
        "from": "WS-Sales-Key",
        "to": "l5-account",
        "line": 954
      },
      {
        "from": "sales-phone",
        "to": "l5-telephone",
        "line": 955
      },
      {
        "from": "sales-current",
        "to": "l6-balance",
        "line": 956
      },
      {
        "from": "\"Balance:\"",
        "to": "l6-lbalance",
        "line": 957
      },
      {
        "from": "spaces",
        "to": "l6-lover",
        "line": 958
      },
      {
        "from": "sales-credit",
        "to": "l6-credit",
        "line": 959
      },
      {
        "from": "sales-limit",
        "to": "l6-limit",
        "line": 960
      },
      {
        "from": "\"Over:\"",
        "to": "l6-lover\n     else     move zero to l6-over",
        "line": 963
      },
      {
        "from": "sales-unapplied",
        "to": "l5-payments",
        "line": 970
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 974
      },
      {
        "from": "1",
        "to": "truth",
        "line": 983
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 986
      },
      {
        "from": "sales-last-pay",
        "to": "pay-date\n       else   move sales-last-inv to pay-date",
        "line": 989
      },
      {
        "from": "1",
        "to": "truth",
        "line": 994
      },
      {
        "from": "zero",
        "to": "truth\n              perform test-for-inv",
        "line": 999
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1004
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1016
      },
      {
        "from": "\"<\"",
        "to": "l5-less\n              move \">\" to l5-greater\n              move oi-paid to l5-bal-0",
        "line": 1029
      },
      {
        "from": "\"<\"",
        "to": "l5-less\n              move \">\" to l5-greater\n              multiply oi-paid by -1 giving l5-bal-0",
        "line": 1036
      },
      {
        "from": "\"<\"",
        "to": "l5-less-1\n              move \">\" to l5-greater-1\n              move oi-paid to l5-payments\n      else\n              subtract oi-approp from oi-paid giving l5-payments",
        "line": 1043
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 1060
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1062
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 1066
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 1073
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 1079
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1080
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 1097
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 1099
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1102
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 1106
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1113
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 1129
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1132
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 1136
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1143
      }
    ],
    "computes": [
      {
        "target": "work-1",
        "expression": "(tot-acct-active * 100) / tot-acct-live",
        "line": 845
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "openitm record skipped perform bypass-ageing.\n*> 01/05/84 vbc - Unapplied cash= sales-unapplied if unapp&current\n*>                 not zero.\n*> 09/10/84 vbc - Chg read-sales-test, 2 c if non recpts present.\n*> 03/03/09 vbc - Migration to open cobol v3.00.0.\n*> 29/05/09 vbc - Support for Page-Lines instead of fixed number.\n*> 07/09/10 vbc - .03 Mod lpr.\n*> 25/11/11 vbc - .04 Error msgs to SLnnn.Support for dates other than UK\n*> 08/12/11 vbc - .05 Support for path+filenames.\n*> 09/12/11 vbc -     Updated version to 3.01.nn\n*> 11/12/11 vbc - .06 Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 29/05/13 vbc - .07 Clear a bug if OTM3 sorted file empty which should not arise but found in testing\n*>                    so added error tests and msgs.\n*> 24/10/16 vbc - .08 ALL programs now using wsnames.cob in copybooks\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*> 21/01/17 vbc - .09 Replace refs to maps99 by display msgs.\n*> 25/01/17 vbc       Dry testing completed.\n*> 09/02/17 vbc - .10 Updated FD/WS and replaced cobol verbs\n*>                    for access to FH/DALs when not using Cobol files.\n*>                    Sort requirements removed (sl165) when processing\n*>                    RDB tables as the sort step removed in place of\n*>                    read Table by Order.\n*>                    Note: When using RDB tables there is no sorting,\n*>                    Data is from selecting by order.\n*> 10/12/22 vbc   .11 Added para after some sections 4 GC 3.2 warning msgs.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n copy \"slselois.cob\".\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdsl.cob\".\n copy \"slfdois.cob\".\n copy \"fdprint.cob\".\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"SL120 (3.02.11)\".\n 77  Exception-Msg       pic x(25) value spaces.\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*> copy \"wsoi.cob\".\n copy \"slwsoi3.cob\".\n copy \"wssl.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n*>     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n*>     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n     03  WS-Invoice-Record      pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  fs-reply2       pic 99.\n     03  z               pic 99.\n     03  y               pic 99.\n     03  truth           pic 9 .\n       88  a-true                         value  1.\n       88  a-false                        value  0.\n     03  first-time      pic 9            value zero.\n     03  ws-spaces       pic x(80)        value spaces.\n     03  st-date         pic x(8)         value spaces.\n     03  work-1          pic s9(7)v99     value zero.\n     03  work-2          pic s9(7)v99.\n     03  display-8       pic z(5)9.99.\n     03  display-5       pic zz9.99.\n     03  a               pic s9(7) comp-3 value zero.\n     03  b               pic s9(5) comp   value zero.\n     03  i               pic 99.\n     03  j               pic 99.\n     03  k               pic 99.\n     03  l-p             pic 99 value zero.\n     03  customer-in     pic x(7)         value spaces.\n     03  filler  redefines  customer-in.\n       05  array-l       pic x  occurs  7.\n     03  pay-date        binary-long.\n     03  pay-value       pic s9(6)v99     value zero.\n     03  pay-paid        pic s9(6)v99.\n     03  last-read       pic x(7)         value spaces.\n     03  page-nos        pic 99           value zero.\n     03  line-cnt        pic 99           value 66.\n     03  inv-amount      pic s9(7)v99     value zero.\n     03  amount-out      pic s9(7)v99     value zero.\n     03  entered-date    binary-long      value zero.\n*>\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(6).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(6).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic 9(6).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic 9(6)v99.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SL003          pic x(28) value \"SL003 Hit Return To Continue\".\n*> Module specific\n     03  SL151          pic x(35) value \"SL151 Sales Transactions Not Posted\".\n     03  Sl152          pic x(33) value \"SL152 Payments Proofed Not Posted\".\n     03  SL153          pic x(37) value \"SL153 No Open invoice records present\".\n*>\n 01  analysis                                   comp-3.\n     03  inv-0              pic s9(6)     value zero.\n     03  inv-30             pic s9(6)     value zero.\n     03  inv-60             pic s9(6)     value zero.\n     03  inv-90             pic s9(6)     value zero.\n     03  tot-bal-0          pic s9(8)v99  value zero.\n     03  tot-bal-30         pic s9(8)v99  value zero.\n     03  tot-bal-60         pic s9(8)v99  value zero.\n     03  tot-bal-90         pic s9(8)v99  value zero.\n     03  tot-os-bal         pic s9(8)v99  value zero.\n     03  tot-no-pay         pic s9(5)     value zero.\n     03  tot-no-cr-bal      pic s9(5)     value zero.\n     03  tot-acct-active    pic s9(5)     value zero.\n     03  tot-acct-live      pic s9(5)     value zero.\n     03  tot-no-late        pic s9(5)     value zero.\n     03  tot-no-unapp-pay   pic s9(5)     value zero.\n     03  tot-amt-late       pic s9(7)v99  value zero.\n     03  tot-amt-pay        pic s9(7)v99  value zero.\n     03  tot-amt-cr-bal     pic s9(7)v99  value zero.\n     03  tot-amt-unapp-pay  pic s9(7)v99  value zero.\n     03  tot-unappl-credits pic s9(7)v99  value zero.\n     03  tot-sales-bal      pic s9(7)v99  value zero.\n*>\n 01  balances                                    comp-3.\n     03  bal-0           pic s9(7)v99 value zero.\n     03  bal-30          pic s9(7)v99 value zero.\n     03  bal-60          pic s9(7)v99 value zero.\n     03  bal-90          pic s9(7)v99 value zero.\n     03  bal-t           pic s9(7)v99 value zero.\n     03  bal-pay         pic s9(7)v99 value zero.\n\n 01  line-1.\n     03  l1-version      pic x(56)       value spaces.\n     03  filler          pic x(68)       value \"Aged Debtors Report\".\n     03  filler          pic x(5)        value \"Page \".\n     03  l1-page         pic zz9.\n*>\n 01  line-3.\n     03  l3-user         pic x(56)       value spaces.\n     03  l3-list.\n         05  l3-lcur     pic x(18)       value \"Current Period is \".\n         05  l3-period   pic z9          blank when zero.\n     03  filler          pic x(46)       value spaces.\n     03  l3-date         pic x(10).\n*>\n 01  line-4.\n     03  filler          pic x(132)      value \"Customer  Name                           Telephone  \" &\n         \"   Invoice     Date       Current         30         60    90 & Over   Payments\".\n*>\n 01  line-5  value spaces.\n     02  l5-f1.\n     03  l5-account      pic x(9).\n     03  l5-name         pic x(32).\n     03  l5-telephone    pic x(13).\n     02  l5-title.\n     03  l5-invoice      pic z(7)9       blank when zero.\n     03  l5-hold         pic x.\n     03  l5-late-only    pic x.\n     03  l5-date         pic x(10).\n     02  l5-f2.\n     03  l5-less         pic x.\n     03  l5-bal-0        pic zzzzzz9.99cr.\n     03  l5-greater      pic x.\n     03  l5-bal-30       pic zzzzzzz9.99.\n     03  l5-bal-60       pic zzzzzzz9.99.\n     03  l5-bal-90       pic zzzzzz9.99.\n     03  l5-less-1       pic x.\n     03  l5-payments     pic zzzzzz9.99.\n     03  l5-greater-1    pic x.\n*>\n 01  line-6.\n     03  l6-lover        pic x(5)        value spaces.\n     03  l6-over         pic zzz,zz9.99bb  blank when zero.\n     03  filler          pic x(7)        value \"Terms:\".\n     03  l6-credit       pic z9bb.\n     03  filler          pic x(13)       value \"Credit Limit:\".\n     03  l6-limit        pic zzzz,zz9.\n     03  filler          pic x(6)        value spaces.\n     03  l6-lbalance     pic x(8)        value \"Balance:\".\n     03  l6-balance      pic zzzz,zz9.99.\n     03  l6-bal-0        pic zzzz,zz9.99cr.\n     03  l6-bal-30       pic zzzz,zz9.99.\n     03  l6-bal-60       pic zzzz,zz9.99.\n     03  l6-bal-90       pic zzzz,zz9.99.\n     03  l6-payments     pic zzzz,zz9.99.\n*>\n 01  line-7.\n     03  filler          pic x(29)       value spaces.\n     03  filler          pic x(103)      value \"Total       Current         30           60       90 & Over\".\n*>\n 01  line-8.\n     03  l8-head.\n         05 l8-hd1       pic x                value space.\n         05 l8-hd2       pic x(24).\n     03  l8-tot          pic zzzz,zz9.99cr.\n     03  l8-0            pic zzzz,zz9.99cr.\n     03  l8-30           pic zzzz,zz9.99cr.\n     03  l8-60           pic zzzz,zz9.99cr.\n     03  l8-90           pic zzzz,zz9.99cr.\n*>\n 01  line-10 redefines line-8.\n     03  l10-head        pic x(25).\n     03  l10-tot         pic zzzz,zz9bbbbb.\n     03  l10-0           pic zzzz,zz9bbbbb.\n     03  l10-30          pic zzzz,zz9bbbbb.\n     03  l10-60          pic zzzz,zz9bbbbb.\n     03  l10-90          pic zzzz,zz9.\n*>\n 01  line-9.\n     03  filler          pic x(29) value spaces.\n     03  filler          pic x(19) value \"Number       Amount\".\n*>\n 01  line-11.\n     03  filler          pic x(25) value spaces.\n     03  l11-f1          pic x(13) value all \"-\".\n     03  l11-f2          pic x(13) value all \"-\".\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wssys4.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          system-record-4\n                          to-day\n                          file-defs.\n*>=======================================\n init01 section.\n*>\n     display  \" \" at 0101 with erase eos.\n*>\n     if       s-flag-p = 1\n              display SL152   at 2301\n              display SL003   at 2401\n              accept ws-reply at 2430\n              go to menu-ent.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n     move     to-day to u-date.\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-19    *> Open ITM3 file\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    display SL151   at 2301\n                    display SL003   at 2401\n                    accept ws-reply at 2430\n                    go       to menu-ent.\n*>\n     display  prog-name at 0202 with foreground-color 2 erase eos.\n     display  \"Aged Debtors Report\" at 0231 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0271 with foreground-color 2.\n*>\n     perform  Trail-Balance.\n     perform  Report-Analysis.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n menu-ent.\n     exit     program.\n*>\n*>****************************************************************\n*>      p r o c e d u r e s                                      *\n*>****************************************************************\n*>\n trail-balance           section.\n*>==============================\n*>\n     display  \"****************************************\" at 0441 with foreground-color 2.\n     display  \"*Date    [  /  /    ]                  *\" at 0541 with foreground-color 2.\n     display  \"*A/C Nos [       ]                   ***\" at 0641 with foreground-color 2.\n     display  \"*Value  [         ]*                   *\" at 0741 with foreground-color 2.\n     display  \"****************************************\" at 0841 with foreground-color 2.\n*>\n main-display-end.\n*>\n     display  \"Notes\" at 1201 with foreground-color 2.\n     display  \"*****\" at 1301 with foreground-color 2.\n     display  \" (1)  -  <Date>  :  Appears on listing\" at 1501  with foreground-color 2.\n     display  \" (2)  -  <A/C>   :  A/c's to match for printing\"\tat 1601 with foreground-color 2.\n     display  \" (3)  -  <Value> :  Minimum o/s to print\" at 1701 with foreground-color 2.\n*>\n date-input.\n     move     zero to cob-crt-status.\n     display  ws-date at 0551 with foreground-color 3.\n     accept   ws-date at 0551 with foreground-color 3 update.\n     if       ws-date = spaces\n              go to main-exit.\n     move     ws-date to ws-test-date.\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              go to  date-input.\n*>\n     move     ws-date  to  l3-date.   *> was WS-test-date 10/01/18\n     move     u-bin to entered-date.\n*>\n customer-input.\n     accept   customer-in at 0651 with foreground-color 3.\n     move     function upper-case (customer-in) to customer-in.\n*>\n value-input.\n     move     0750 to curs.\n     perform  accept-money.\n     move     amt-ok to pay-value.\n*>\n     open     output print-file.\n     move     zero  to  page-nos.\n     perform  headings-1.\n     perform  Sales-Open-Input.           *> open     input sales-file.\n*>\n     if       FS-Cobol-Files-Used\n              open     input  open-item-file-s\n              if       fs-reply not = zero\n                       close open-item-file-s\n                       open input open-item-file-s\n                       display SL153  at 2450    *> No Open invoice records present\n              end-if\n     else\n              perform  OTM3-Open-Input\n *>             if       fs-reply not = zero\n *>                      perform OTM3-Close\n *>                      go to Main-End\n *>             end-if\n     end-if\n*>\n *>    open     input open-item-file-s.\n *>    if       fs-reply not = zero\n *>             close open-item-file-s\n *>             open output open-item-file-s\n *>             close open-item-file-s\n *>             open input open-item-file-s\n *>             display SL153  at 2450.        *> No Open invoice records present\n*>\n     if       customer-in = spaces\n              go to read-perform.\n     move     customer-in to WS-Sales-Key.\n     set      fn-not-less-than to true.\n     move     1  to File-Key-No.\n     perform  Sales-Start.            *> start sales-file key not < WS-Sales-Key invalid key\n     if       fs-reply = 21\n              move 1 to y.\n     inspect  customer-in replacing all spaces by \"Z\".\n*>\n read-perform.\n     perform  read-sales.\n*>\n     if       fs-reply = 99 or = 10\n              go to  main-end.\n*>\n     if       last-read = WS-Sales-Key\n              go to roi-1.\n*>\n read-open-item.\n     if       last-read > WS-Sales-Key\n              go to read-perform.\n*>\n     if       fs-reply2 = 99\n              go to end-statement.\n*>\n     if       NOT FS-Cobol-Files-Used\n              perform OTM3-Read-Next-Sorted-By-Cust\n              if      fs-reply not = zero     *> = 10\n                      move 99 to fs-reply2\n                      go to    end-statement\n              end-if\n              go to Read-Loop-Tests\n     end-if\n*>\n     read     open-item-file-s at end\n              move 99 to fs-reply2\n              go to    end-statement.\n     if       fs-reply not = zero\n              go to    end-statement.\n*>\n     move     open-item-record-s  to  oi-header.\n*>\n Read-Loop-Tests.\n     move     oi-customer  to  last-read.\n*>\n     if       last-read  >  WS-Sales-Key\n              go to  end-statement.\n*>\n     if       last-read  not equal  WS-Sales-Key\n              perform bypass-ageing\n              go to  read-open-item.\n roi-1.\n*>\n*>  O-I transaction is for this customer.\n*>\n     if       oi-type = 1  or = 4\n              go to  read-open-item.\n*>\n*> Can safely ignore receipts & pro-formas.\n*>\n     if       line-cnt > Page-Lines\n              perform headings-1.\n     if       oi-type = 5 or = 6\n              move zero to oi-invoice.\n     move     oi-invoice  to  l5-invoice.\n     move     oi-hold-flag to l5-hold.\n*>\n     move     oi-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date   to  l5-date.\n*>\n*> Invoices only here\n*>\n     add      oi-net  oi-extra  oi-carriage\n              oi-vat  oi-discount  oi-e-vat\n              oi-deduct-amt oi-deduct-vat\n              oi-c-vat    giving  inv-amount.\n*>\n     if       oi-type = 2\n              subtract   oi-paid  from  inv-amount giving  amount-out.\n*>\n*> Cr. notes only here.\n*>\n     if       oi-type = 3\n              add  oi-paid  to  inv-amount\n              move  inv-amount  to  l5-bal-0\n              perform check-zero\n              go to bypass-ageing.\n*>\n*> Payments  only here.\n*>\n     if       oi-type = 5  or  6\n              add   oi-paid  to  bal-pay\n*>  subtract oi-approp from bal-pay\n              perform check-zero\n              go to bypass-ageing.\n*>\n     subtract oi-date  from  entered-date  giving  work-1.\n*>\n*> Now work out ageing\n*> (dont worry if paid in full - routine still works ok)\n*>   Also force credit balance into current\n*>\n     if       amount-out = zero\n              move 0 to b\n     else     move 1 to b.\n*>\n     if       amount-out is negative\n              move 1 to work-1.\n*>\n     if       work-1  <  30\n              add  amount-out  to  bal-0\n              move amount-out to l5-bal-0\n              perform check-zero\n              add amount-out to tot-bal-0\n              add b to inv-0\n     else\n      if      work-1  <  60\n              add  amount-out  to  bal-30\n              move amount-out to l5-bal-30\n              add amount-out to tot-bal-30\n              add b to inv-30\n      else\n       if     work-1  <  90\n              add  amount-out  to  bal-60\n              move amount-out to l5-bal-60\n              add amount-out to tot-bal-60\n              add b to inv-60\n       else\n              move amount-out to l5-bal-90\n              add  amount-out to tot-bal-90\n              add b to inv-90\n              add  amount-out  to  bal-90.\n*>\n     add      amount-out  to  bal-t.\n*>\n bypass-ageing.\n*>\n*> ie payment\n*>\n     if       oi-type = 5 or 6\n         and  oi-deduct-amt not = zero\n              add oi-deduct-amt to tot-amt-late\n              add 1 to tot-no-late.\n     if       oi-type = 5 or 6\n              add  oi-paid  to  tot-amt-pay\n              add  1  to  tot-no-pay.\n*>\n bypass-age-go.\n     if       oi-type = 3 and\n              inv-amount not = zero\n              add inv-amount to tot-unappl-credits.\n*>\n     if       oi-type = 2 and\n              amount-out = oi-deduct-amt and\n              amount-out not = zero\n              move \"L\" to l5-late-only\n      else\n              move space to l5-late-only.\n*>\n     move     zero to amount-out.\n*>\n*> Now to print. What joy!!!!!!.\n*>\n     if       l5-account not = spaces\n              write print-record from ws-spaces after 1\n              add 1 to line-cnt.\n     write    print-record  from  line-5 after 1.\n     add      1 to line-cnt.\n*>\n*> Loop back for next item.\n*>\n     move     spaces  to  line-5.\n     go       to read-open-item.\n*>\n*> Can only get here at the end of a statement.\n*>\n end-statement.\n*>************\n*>\n     move     bal-0   to  l6-bal-0.\n     move     bal-30  to  l6-bal-30.\n     move     bal-60  to  l6-bal-60.\n     move     bal-90  to  l6-bal-90.\n     move     bal-pay to  l6-payments.\n*>\n     if       l6-lbalance not = spaces\n              write print-record  from  line-6 after 1\n              write print-record  from  ws-spaces after 1\n              move spaces to l6-lbalance\n              add 2 to line-cnt.\n*>\n*> Set-up for the next one",
        "line": 50
      },
      {
        "type": "IF",
        "condition": "FS-Cobol-Files-Used\n              close    open-item-file-s          *>  sales-file.\n     else\n              perform OTM3-Close\n     end-if\n     perform  Sales-Close.\n*>\n main-exit.   exit.\n*>********    ****\n*>\n headings-1              section.\n*>==============================\n*>\n     if       line-cnt < Page-Lines\n              go to main-exit.\n     add      1  to  page-nos.\n     move     page-nos  to  l1-page.\n     move     prog-name to  l1-version.\n     move     usera     to  l3-user.\n     if       line-cnt not = 99\n              move scycle to  l3-period.\n*>\n     if       page-nos not = 1\n              write print-record from line-1 after page\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record from line-1 before 1\n     end-if\n     write    print-record  from  line-3 after 1.\n     write    print-record  from  line-4 after 2.\n     move     zero to line-cnt.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-analysis          section.\n*>===============================\n*>\n     move     \"Account Statistics  \" to l3-list.\n     move     spaces to line-4.\n     move     99 to line-cnt.\n     perform  headings-1.\n     write    print-record from line-7 after 1.\n     write    print-record from ws-spaces after 1.\n     move     \"Number Of Invoices\" to l10-head.\n     move     inv-0  to l10-0.\n     move     inv-30 to l10-30.\n     move     inv-60 to l10-60.\n     move     inv-90 to l10-90.\n     add      inv-0 inv-30 inv-60 inv-90 giving a.\n     move     a to l10-tot.\n     write    print-record from line-10 after 1.\n     move     \"Amount\" to l8-head.\n     move     tot-bal-0  to l8-0.\n     move     tot-bal-30 to l8-30.\n     move     tot-bal-60 to l8-60.\n     move     tot-bal-90 to l8-90.\n     add      tot-bal-0 tot-bal-30 tot-bal-60 tot-bal-90 giving tot-os-bal.\n*>\n*>    Note that TOT-OS-BAL does NOT include credit balances.\n*>\n     move     tot-os-bal to l8-tot work-2.\n     write    print-record from line-8 after 1.\n     move     \"% of O/S Invoices\" to l8-head.\n     move     100 to l8-tot.\n     compute  work-1 rounded = (tot-bal-0 * 100) / work-2.\n     move     work-1 to l8-0.\n     compute  work-1 rounded = (tot-bal-30 * 100) / work-2.\n     move     work-1 to l8-30.\n     compute  work-1 rounded = (tot-bal-60 * 100) / work-2.\n     move     work-1 to l8-60.\n     compute  work-1 rounded = (tot-bal-90 * 100) / work-2.\n     move     work-1 to l8-90.\n     write    print-record from line-8 after 1.\n     move     \"Average O/S Amount\" to l8-head.\n     move     zero to l8-0 l8-30 l8-60 l8-90.\n     if       inv-0 not = zero\n              divide tot-bal-0 by inv-0 giving l8-0.\n     if       inv-30 not = zero\n              divide tot-bal-30 by inv-30 giving l8-30.\n     if       inv-60 not = zero\n              divide tot-bal-60 by inv-60 giving l8-60.\n     if       inv-90 not = zero\n              divide tot-bal-90 by inv-90 giving l8-90.\n     divide   work-2 by a giving l8-tot.\n     write    print-record from line-8 after 1.\n     write    print-record from line-9 after 3.\n     move     spaces to line-8.\n     move     \"Unapplied Cash\" to l8-head.\n     move     tot-amt-unapp-pay to l8-0.\n     move     tot-no-unapp-pay to l10-tot.\n     write    print-record from line-8 after 2.\n     move     \"Payments\" to l8-head.\n     move     sl-payments to l8-0.\n     move     tot-no-pay  to l10-tot.\n     write    print-record from line-8 after 1.\n     move     \"Credit Balances\" to l8-head.\n     move     tot-no-cr-bal to l10-tot.\n     move     tot-amt-cr-bal to l8-0.\n     write    print-record from line-8 after 1.\n     move     \"Late Charges\" to l8-head.\n     move     tot-amt-late to l8-0.\n     move     tot-no-late to l10-tot.\n     write    print-record from line-8 after 1.\n     move     spaces to line-8.\n     move     \"Number of Live Accounts\" to l10-head.\n     move     tot-acct-live to l10-tot.\n     write    print-record from line-10 after 1.\n     move     \"Number of Active Accounts\" to l10-head.\n     move     tot-acct-active to l10-tot.\n     write    print-record from line-10 after 1.\n     move     \"% Active\" to l8-head.\n     compute  work-1 = (tot-acct-active * 100) / tot-acct-live.\n     move     work-1 to l8-tot.\n     write    print-record from line-8 after 1.\n*>\n     if       customer-in not = spaces\n              go to main-exit.\n*>\n     move     spaces to line-10.\n     move     \"  Reconciliation Data\" to l10-head.\n     write    print-record from line-10 after 3.\n     move     spaces to l10-head.\n     write    print-record from line-10 after 1.\n     move     sl-os-bal-last-month to l8-tot.\n     move     \"Balance Brought Forward\" to l10-head.\n     write    print-record from line-10 after 1.\n     move     sl-invoices-this-month to l8-tot.\n     move     \"Plus: Invoices Posted\" to l10-head.\n     write    print-record from line-10 after 1.\n*>     move     \"      Unapplied CN Bal's\" TO L10-HEAD.\n*>     multiply -1 by sl-cn-unappl-this-month giving tot-bal-60.\n*>     move     tot-bal-60 to l8-tot.\n*>     write    print-record from line-10 after 1.\n     add      sl-os-bal-last-month\n              sl-invoices-this-month\n*> tot-bal-60\n                                     giving tot-bal-0.\n     write    print-record from line-11 after 1.\n     move     spaces to line-10.\n     move     tot-bal-0 to l8-0.\n     write    print-record from line-10 after 1.\n     move     spaces to line-10.\n     move     sl-credit-notes-this-month to l8-tot.\n     move     \"Less: Credit Notes Posted\" to l10-head.\n     write    print-record from line-10 after 2.\n     move     sl-payments to l8-tot.\n     move     \"      Payments Posted\" to l10-head.\n     write    print-record from line-10 after 1.\n     move     tot-amt-late to l8-tot.\n     move     \"      Pay Late Chgs Taken\" to l10-head.\n     write    print-record from line-10 after 1.\n     move     \"      CN Late Chgs Taken\" to l10-head.\n     move     sl-credit-deductions to l8-tot.\n     write    print-record from line-10 after 1.\n     write    print-record from line-11 after 1.\n     add      tot-amt-late   sl-payments\n              sl-credit-notes-this-month\n              sl-credit-deductions       giving tot-bal-30.\n     move     spaces to line-10.\n     move     tot-bal-30 to l8-0.\n     write    print-record from line-10 after 1.\n     move     spaces to l11-f1.\n     write    print-record from line-11 after 2.\n     subtract tot-bal-30 from tot-bal-0.\n     move     \"Balance Carried Forward\" to l10-head.\n     move     tot-bal-0 to l8-0 sl-os-bal-this-month.\n     write    print-record from line-10 after 1.\n     move     all \"=\" to l11-f2.\n     write    print-record from line-11 after 1.\n     move     spaces to line-8.\n     subtract tot-bal-0 from tot-sales-bal giving sl-variance.\n     move     sl-variance to l8-tot.\n     if       sl-variance not = zero\n              move \"Out Of Balance\" to l8-hd2\n              add sl-variance to sl-os-bal-this-month\n              write print-record from line-10 after 2.\n*>\n main-exit.\n     exit     section.\n*>\n read-sales   section.\n*>*******************\n*>\n Read-Sales-Main.\n     perform  Sales-Read-Next.            *> read     sales-file  next  record at end\n     if       fs-reply = 10\n              move 99  to  fs-reply\n              go to  main-end.\n*>\n     if       fs-reply not = zero\n              move 99 to fs-reply\n              go to main-end.\n*>\n     if       customer-in not = spaces\n        and   WS-Sales-Key > customer-in\n              move 99 to fs-reply\n              go to main-end.\n*>\n     add      1 to tot-acct-live.\n     add      sales-current to tot-sales-bal.\n*>\n     if       sales-unapplied not = zero\n        and   sales-current not = zero\n              add sales-unapplied to tot-amt-unapp-pay\n              add 1 to tot-no-unapp-pay.\n*>\n     if       sales-unapplied not = zero\n              subtract sales-unapplied from tot-sales-bal\n              subtract sales-unapplied from sales-current.\n*>\n     if       sales-current negative\n              add 1 to tot-no-cr-bal\n              add sales-current to tot-amt-cr-bal.\n*>\n     perform  read-sales-test.\n     if       a-false\n              go to read-sales-Main.\n*>\n     add      1 to tot-acct-active.\n     move     sales-name  to  l5-name.\n     move     WS-Sales-Key  to  l5-account.\n     move     sales-phone  to  l5-telephone.\n     move     sales-current  to  l6-balance.\n     move     \"Balance:\" to l6-lbalance.\n     move     spaces     to l6-lover.\n     move     sales-credit  to  l6-credit.\n     move     sales-limit   to  l6-limit.\n     if       sales-current > sales-limit\n              subtract sales-limit from sales-current giving l6-over\n              move \"Over:\" to l6-lover\n     else     move zero to l6-over.\n     if       sales-current is negative\n              move \"Cr Bal:\" to l6-lbalance.\n     perform  headings-1.\n     if       sales-unapplied = zero\n              go to main-end.\n     move     sales-unapplied to l5-payments.\n     move     \"Unapplied Cash\" to l5-title.\n     add      sales-unapplied to bal-pay.\n     write    print-record from line-5 after 2.\n     move     spaces to line-5.\n     add      2 to line-cnt.\n     if       last-read not = WS-Sales-Key\n              perform  end-statement.\n     go       to main-end.\n*>\n read-sales-test.\n*>**************\n*>\n     move     1 to truth.\n*>\n     if       sales-current = zero\n              move zero to truth.\n*>\n     if       sales-last-pay > sales-last-inv\n              move sales-last-pay to pay-date\n       else   move sales-last-inv to pay-date.\n*>\n     if       sales-current = zero\n      and     pay-date > s-end-cycle-date\n              move 1 to truth.\n*>\n     if       sales-current = zero and\n              sales-last-pay not = zero and\n              sales-last-pay = sales-last-inv\n              move zero to truth\n              perform test-for-inv.\n*>\n     if       pay-value not = zero\n        and   sales-current  <  pay-value\n              move zero to truth.\n*>\n main-end.\n*>*******\n*>\n     go       to main-exit.\n*>\n test-for-inv.\n*>***********\n*>\n     if       last-read = WS-Sales-Key\n       and    oi-type not = 1\n              move 1 to truth.\n*>\n main-exit.   exit section.\n*>********    *****\n*>\n check-zero              section.\n*>==============================\n*>\n     if       oi-type = 3\n              go to test2.\n     if       oi-type = 5 or 6\n              go to test3.\n     if       amount-out = zero\n              move \"<\" to l5-less\n              move \">\" to l5-greater\n              move oi-paid to l5-bal-0.\n     go       to main-exit.\n*>\n test2.\n     if       inv-amount = zero\n              move \"<\" to l5-less\n              move \">\" to l5-greater\n              multiply oi-paid by -1 giving l5-bal-0.\n     go       main-exit.\n*>\n test3.\n     if       oi-paid = oi-approp\n              move \"<\" to l5-less-1\n              move \">\" to l5-greater-1\n              move oi-paid to l5-payments\n      else\n              subtract oi-approp from oi-paid giving l5-payments.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*****************************************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n main-exit.   exit section.\n*>************************\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 732
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 7,
    "cognitive": 2,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 153,
      "totalOperators": 134,
      "totalOperands": 266,
      "vocabulary": 155,
      "length": 400,
      "volume": 2910.449762109695
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
