{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl920.cbl",
  "fileName": "pl920.cbl",
  "timestamp": "2025-09-15T16:25:48.125Z",
  "programId": "pl920",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 84
      },
      {
        "name": "file",
        "line": 95
      },
      {
        "name": "working-storage",
        "line": 100
      },
      {
        "name": "linkage",
        "line": 192
      },
      {
        "name": "init",
        "line": 207
      },
      {
        "name": "Payment-Amend",
        "line": 220
      },
      {
        "name": "zz070-Convert-Date",
        "line": 323
      },
      {
        "name": "exit",
        "line": 351
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 87
      },
      {
        "name": "file-defs",
        "line": 204
      },
      {
        "name": "menu-exit",
        "line": 217
      },
      {
        "name": "read-purchase",
        "line": 226
      },
      {
        "name": "end-perform",
        "line": 234
      },
      {
        "name": "get-key",
        "line": 236
      },
      {
        "name": "end-perform",
        "line": 269
      },
      {
        "name": "get-change",
        "line": 271
      },
      {
        "name": "accept-money",
        "line": 296
      },
      {
        "name": "accept-money2",
        "line": 305
      },
      {
        "name": "write-back",
        "line": 315
      },
      {
        "name": "zz070-Exit",
        "line": 350
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "of",
        "line": 73,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 83,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 90,
        "replacing": null
      },
      {
        "name": "selpay",
        "line": 91,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 98,
        "replacing": null
      },
      {
        "name": "fdpay",
        "line": 99,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 103,
        "replacing": null
      },
      {
        "name": "plwsoi",
        "line": 104,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 108,
        "replacing": null
      },
      {
        "name": "plwspay",
        "line": 109,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 137,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 184,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 195,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 196,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 197,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 353,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 210
      },
      {
        "target": "Payment-Amend",
        "thru": null,
        "line": 213
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 214
      },
      {
        "target": "Payments-Close",
        "thru": null,
        "line": 215
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 223
      },
      {
        "target": "Payments-Open",
        "thru": null,
        "line": 224
      },
      {
        "target": "varying",
        "thru": null,
        "line": 228
      },
      {
        "target": "Payments-Read-Indexed",
        "thru": null,
        "line": 248
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 253
      },
      {
        "target": "varying",
        "thru": null,
        "line": 258
      },
      {
        "target": "accept-money2",
        "thru": null,
        "line": 291
      },
      {
        "target": "Payments-Rewrite",
        "thru": null,
        "line": 318
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 212
      },
      {
        "from": "1",
        "to": "cole\n              display z at curs with foreground-color 3\n              move    3 to cole\n              display \"   {        } [          ]\" at curs  with foreground-color 2\n     end-perform",
        "line": 230
      },
      {
        "from": "spaces",
        "to": "pay-supl-key",
        "line": 237
      },
      {
        "from": "01",
        "to": "ws-pay-nos",
        "line": 244
      },
      {
        "from": "ws-pay-nos",
        "to": "pay-nos",
        "line": 246
      },
      {
        "from": "pay-supl-key",
        "to": "WS-Purch-Key",
        "line": 252
      },
      {
        "from": "7",
        "to": "cole\n              display  display-folio at curs  with foreground-color 3\n              move 18 to cole\n              display display-8 at curs with foreground-color 3\n              move    32 to cole\n              move    pay-invoice (z) to ws-pay-invoice\n              display ws-pay-invoice at curs with foreground-color 3\n     end-perform",
        "line": 262
      },
      {
        "from": "pay-gross",
        "to": "display-8",
        "line": 275
      },
      {
        "from": "18",
        "to": "cole",
        "line": 289
      },
      {
        "from": "amt-ok",
        "to": "pay-value (y)",
        "line": 292
      },
      {
        "from": "zero",
        "to": "ws-poundsd amt-ok ws-penced",
        "line": 299
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 302
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 303
      },
      {
        "from": "amt-wk-pence",
        "to": "ws-pence",
        "line": 308
      },
      {
        "from": "amt-wk-pds",
        "to": "ws-pound",
        "line": 309
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 312
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 313
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 331
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 334
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 338
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 345
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selpl.cob\".\n*> copy \"selpay.cob\".\n data                    division.\n*>===============================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdpl.cob\".\n*> copy \"fdpay.cob\".\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"PL920 (3.02.06)\".\n copy \"wsfnctn.cob\".\n copy \"plwsoi.cob\".\n*>\n*> Ex FDs\n*>\n copy \"wspl.cob\".     *> WS-Purch-Record.\n copy \"plwspay.cob\".  *> Pay-Record.\n 01  WS-Pay-Record  redefines Pay-Record.\n     03  filler     pic x(238).\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n*>     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  ws-data.\n     03  y               pic 9.\n     03  z               pic 99.\n     03  display-8       pic z(6)9.99.\n     03  display-folio   pic z(7)9.\n     03  ws-pay-nos      pic 99        value zero.\n     03  ws-pay-invoice  pic x(10).\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(7).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(7).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic 9(7).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic 9(7)v99.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n copy \"wsmaps03.cob\".\n*>\n*> 01  Error-Messages.\n*> System Wide\n*>     03  PL005          pic x(18) value \"PL005 Invalid Date\".\n*> Module specific\n*>     NONE\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init section.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Payment Due Amendment\" at 0130 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171 with foreground-color 2.\n     move     1 to File-Key-No.  *> Good for all files/tables used here.\n     perform  Payment-Amend.\n     perform  Purch-Close.\n     perform  Payments-Close. *> close purchase-file pay-file.\n*>\n menu-exit.\n     exit     program.\n*>\n Payment-Amend section.\n*>====================\n*>\n     perform  Purch-Open-Input. *>  open input purchase-file.\n     perform  Payments-Open.    *> open i-o   pay-file.\n*>\n read-purchase.\n     display  \"Supplier - [       /  ]\" at 0501  with foreground-color 2.\n     perform  varying z from 1 by 1 until z > 9\n              add     8  z  giving  lin\n              move    1 to cole\n              display z at curs with foreground-color 3\n              move    3 to cole\n              display \"   {        } [          ]\" at curs  with foreground-color 2\n     end-perform.\n*>\n get-key.\n     move     spaces to pay-supl-key.\n     accept   pay-supl-key at 0513 with foreground-color 3 UPPER.\n *>    move     function upper-case (pay-supl-key) to pay-supl-key.\n*>\n     if       pay-supl-key = spaces\n              go to  main-exit.\n*>\n     move     01  to  ws-pay-nos.\n     accept   ws-pay-nos at 0521 with foreground-color 3 update.\n     move     ws-pay-nos to pay-nos.\n*>\n     perform  Payments-Read-Indexed.  *>  read     pay-file invalid key\n     if       fs-reply = 21 or = 23\n              go to  get-key.\n*>\n     move     pay-supl-key  to  WS-Purch-Key.\n     perform  Purch-Read-Indexed.  *>  read purchase-file invalid key\n     if       fs-reply = 21 or = 23\n              go to get-key.\n     display  purch-name at 0526 with foreground-color 3.\n*>\n     perform  varying z from 1 by 1 until z > 9\n              add  8  z  giving  lin\n              move pay-folio (z) to display-folio\n              move pay-value (z) to display-8\n              move 7 to cole\n              display  display-folio at curs  with foreground-color 3\n              move 18 to cole\n              display display-8 at curs with foreground-color 3\n              move    32 to cole\n              move    pay-invoice (z) to ws-pay-invoice\n              display ws-pay-invoice at curs with foreground-color 3\n     end-perform.\n*>\n get-change.\n*>*********\n*>\n     display  \"Gross - [           ]\" at 0556  with foreground-color 2.\n     move     pay-gross  to  display-8.\n     display  display-8 at 0565 with foreground-color 3.\n     display  \"line to alter - [ ]\" at 2201 with foreground-color 2.\n     accept   y at 2218 with foreground-color 6.\n*>\n     if       y = zero\n              go to  write-back.\n*>\n     if       pay-value (y) = zero\n              go to  get-change.\n*>\n     add      8  y  giving  lin.\n     subtract pay-value (y) from pay-gross.\n*>\n     move     18 to cole.\n     move     pay-value (y) to amt-ok.\n     perform  accept-money2.\n     move     amt-ok to pay-value (y).\n     add      pay-value (y)  to  pay-gross.\n     go       to get-change.\n*>\n accept-money.\n*>-----------\n*>\n     move     zero to ws-poundsd amt-ok ws-penced.\n     display  ws-amount-screen-display at curs with foreground-color 3.\n     accept   ws-amount-screen-accept at curs  with foreground-color 3 update.\n     move     ws-pound to amt-wk-pds.\n     move     ws-pence to amt-wk-pence.\n*>\n accept-money2.\n*>------------\n*>\n     move     amt-wk-pence to ws-pence.\n     move     amt-wk-pds to ws-pound.\n     display  ws-amount-screen-display at curs  with foreground-color 3.\n     accept   ws-amount-screen-accept at curs   with foreground-color 3 update.\n     move     ws-pound to amt-wk-pds.\n     move     ws-pence to amt-wk-pence.\n*>\n write-back.\n*>*********\n*>\n     perform  Payments-Rewrite. *>  rewrite  pay-record.\n     go       to get-key.\n*>\n main-exit.   exit section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 70
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 2,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 29,
      "totalOperators": 21,
      "totalOperands": 42,
      "vocabulary": 30,
      "length": 63,
      "volume": 309.1341075233367
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
