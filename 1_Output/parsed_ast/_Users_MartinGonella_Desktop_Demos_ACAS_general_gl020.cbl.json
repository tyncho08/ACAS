{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/general/gl020.cbl",
  "fileName": "gl020.cbl",
  "timestamp": "2025-09-15T16:25:32.207Z",
  "programId": "gl020",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 101
      },
      {
        "name": "file",
        "line": 112
      },
      {
        "name": "working-storage",
        "line": 117
      },
      {
        "name": "linkage",
        "line": 220
      },
      {
        "name": "init01",
        "line": 237
      },
      {
        "name": "set-up",
        "line": 303
      },
      {
        "name": "amend",
        "line": 471
      },
      {
        "name": "show",
        "line": 543
      },
      {
        "name": "file-init",
        "line": 559
      },
      {
        "name": "exit",
        "line": 579
      },
      {
        "name": "input-headings",
        "line": 581
      },
      {
        "name": "get-description",
        "line": 662
      },
      {
        "name": "zz050-Validate-Date",
        "line": 676
      },
      {
        "name": "exit",
        "line": 713
      },
      {
        "name": "zz060-Convert-Date",
        "line": 715
      },
      {
        "name": "exit",
        "line": 748
      },
      {
        "name": "zz070-Convert-Date",
        "line": 750
      },
      {
        "name": "exit",
        "line": 778
      },
      {
        "name": "maps03",
        "line": 780
      },
      {
        "name": "exit",
        "line": 786
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 104
      },
      {
        "name": "file-defs",
        "line": 234
      },
      {
        "name": "Init01-Main",
        "line": 242
      },
      {
        "name": "accept-money",
        "line": 290
      },
      {
        "name": "main01-exit",
        "line": 300
      },
      {
        "name": "main-loop",
        "line": 312
      },
      {
        "name": "get-input",
        "line": 333
      },
      {
        "name": "vat-check",
        "line": 424
      },
      {
        "name": "main-end",
        "line": 463
      },
      {
        "name": "get-input",
        "line": 480
      },
      {
        "name": "vat-check",
        "line": 520
      },
      {
        "name": "end-input",
        "line": 535
      },
      {
        "name": "main-exit",
        "line": 576
      },
      {
        "name": "input-loop",
        "line": 591
      },
      {
        "name": "end-loop",
        "line": 608
      },
      {
        "name": "display-existing",
        "line": 616
      },
      {
        "name": "jump-1",
        "line": 635
      },
      {
        "name": "display-existing-end",
        "line": 653
      },
      {
        "name": "zz050-test-date",
        "line": 707
      },
      {
        "name": "zz050-exit",
        "line": 712
      },
      {
        "name": "zz060-Exit",
        "line": 747
      },
      {
        "name": "zz070-Exit",
        "line": 777
      },
      {
        "name": "maps04-exit",
        "line": 785
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps01",
        "line": 569,
        "type": "DYNAMIC",
        "using": [
          "maps01-ws"
        ]
      },
      {
        "target": "maps04",
        "line": 783,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 91,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 100,
        "replacing": null
      },
      {
        "name": "seledger",
        "line": 107,
        "replacing": null
      },
      {
        "name": "fdledger",
        "line": 115,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 122,
        "replacing": null
      },
      {
        "name": "wsledger",
        "line": 123,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 149,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 184,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 210,
        "replacing": null
      },
      {
        "name": "wsmaps01",
        "line": 218,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 223,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 224,
        "replacing": null
      },
      {
        "name": "wsdflt",
        "line": 225,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 226,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 788,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 261
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 266
      },
      {
        "target": "set-up",
        "thru": null,
        "line": 281
      },
      {
        "target": "amend",
        "thru": null,
        "line": 283
      },
      {
        "target": "show",
        "thru": null,
        "line": 285
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 307
      },
      {
        "target": "file-init",
        "thru": null,
        "line": 323
      },
      {
        "target": "input-headings",
        "thru": null,
        "line": 331
      },
      {
        "target": "accept-money",
        "thru": null,
        "line": 339
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 375
      },
      {
        "target": "amend",
        "thru": null,
        "line": 466
      },
      {
        "target": "input-headings",
        "thru": null,
        "line": 478
      },
      {
        "target": "accept-money",
        "thru": null,
        "line": 500
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 505
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 538
      },
      {
        "target": "input-headings",
        "thru": null,
        "line": 551
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 554
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 627
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 669
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 710
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 724
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 245
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 264
      },
      {
        "from": "amt-wk-pds",
        "to": "ws-pound",
        "line": 293
      },
      {
        "from": "amt-wk-pence",
        "to": "ws-pence",
        "line": 294
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 297
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 298
      },
      {
        "from": "amt-ok",
        "to": "def-acs (w)",
        "line": 340
      },
      {
        "from": "41",
        "to": "cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input",
        "line": 344
      },
      {
        "from": "41",
        "to": "cole\n              move 31  to  w\n              move 21  to  lin\n              go to get-input\n       else\n              go to main-end",
        "line": 352
      },
      {
        "from": "41",
        "to": "cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input",
        "line": 361
      },
      {
        "from": "41",
        "to": "cole\n              move 31  to  w\n              move 21  to  lin\n              go to get-input",
        "line": 368
      },
      {
        "from": "\"OB\"",
        "to": "ws-codes\n      else\n       if     w = 31\n              move \"VI\" to ws-codes\n       else\n              move \"VO\" to ws-codes",
        "line": 393
      },
      {
        "from": "41",
        "to": "cole\n              move 30 to w\n              move 20 to lin\n              go to get-input",
        "line": 406
      },
      {
        "from": "41",
        "to": "cole\n              move 31 to w\n              move 21 to lin\n              go to get-input\n       else\n              go to main-end",
        "line": 415
      },
      {
        "from": "ws-codes",
        "to": "def-codes (w)",
        "line": 422
      },
      {
        "from": "\"N\"",
        "to": "ws-vat\n              display ws-vat at curs2 with foreground-color 3",
        "line": 435
      },
      {
        "from": "41",
        "to": "cole\n              move 31 to w\n              move 21 to lin\n              go to get-input\n       else\n              go to main-end",
        "line": 442
      },
      {
        "from": "ws-vat",
        "to": "def-vat (w)",
        "line": 449
      },
      {
        "from": "41",
        "to": "cole\n              move 6   to  lin",
        "line": 458
      },
      {
        "from": "zero",
        "to": "y",
        "line": 482
      },
      {
        "from": "y",
        "to": "w",
        "line": 489
      },
      {
        "from": "41",
        "to": "cole\n      else\n              move     1   to  cole",
        "line": 492
      },
      {
        "from": "zero",
        "to": "lin",
        "line": 495
      },
      {
        "from": "amt-ok",
        "to": "def-acs (w)",
        "line": 501
      },
      {
        "from": "ws-codes",
        "to": "def-codes (w)",
        "line": 516
      },
      {
        "from": "ws-vat",
        "to": "def-vat (w)",
        "line": 532
      },
      {
        "from": "\"P\"",
        "to": "encode",
        "line": 565
      },
      {
        "from": "\"Z\"",
        "to": "ws-reply\n *>             go to main-exit",
        "line": 572
      },
      {
        "from": "7",
        "to": "lin",
        "line": 588
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 589
      },
      {
        "from": "6",
        "to": "lin\n              move 41 to  cole",
        "line": 603
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 613
      },
      {
        "from": "7",
        "to": "lin",
        "line": 614
      },
      {
        "from": "41",
        "to": "cole\n              move 6   to  lin",
        "line": 648
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 656
      },
      {
        "from": "7",
        "to": "lin",
        "line": 657
      },
      {
        "from": "\"00\"",
        "to": "ledger-pc",
        "line": 666
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 667
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 671
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 689
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 691
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 695
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 702
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 708
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 709
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 726
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 728
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 731
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 735
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 742
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 758
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 761
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 765
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 772
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"seledger.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdledger.cob\".\n*>\n working-storage section.\n*>----------------------\n*>\n 77  prog-name           pic x(15)  value \"GL020 (3.02.05)\".\n*>\n copy \"wsfnctn.cob\".\n copy \"wsledger.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n*>     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(4).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(4).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic 9(4).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic  9(4)v99.\n*>\n 01  work-fields.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  a               pic 99.\n     03  w               pic 99.\n     03  y               pic 99.\n     03  ws-acs          pic 9(4).99.\n     03  ws-codes        pic xx.\n     03  ws-vat          pic x.\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-21-lines     binary-char unsigned value zero.\n     03  ws-20-lines     binary-char unsigned value zero.\n*>     03  ws-eval-msg     pic x(25)       value spaces.\n*>\n 01  accept-terminator-array   pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n copy \"wsmaps03.cob\".\n*>\n01  Error-Messages.\n*> System Wide\n    03  GL010           pic x(16) value \"GL010 Hit Return\".\n*> Module specific\n    03  GL021           pic x(34) value \"GL021 Chart of Accounts not set up\".\n*>\n copy \"wsmaps01.cob\".\n*>\n linkage section.\n*>---------------\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsdflt.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day          pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          default-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n init01       section.\n*>*******************\n*>\n*>  Not use as only need 17 data lines but usable in other modules\n*>\n Init01-Main.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-21-lines.\n     subtract 4 from ws-lines giving ws-20-lines.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n*>\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Default File Utilities\" at 0129  with foreground-color 2.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n     move     1  to File-Key-No.\n*>\n     perform  GL-Nominal-Open-Input.  *>  open input ledger-file.\n*>\n     if       fs-reply not = zero\n              display GL021    at 2301 with foreground-color 4\n              display GL010    at 2401 with foreground-color 2\n              accept ws-reply at 2420  with foreground-color 2\n              go to main01-exit.\n*>\n     display  \"Select the required function by number    [ ]\" at 0501  with foreground-color 2.\n     display  \"(1)  Set-Up Default Accounts\" at 0806             with foreground-color 2.\n     display  \"(2)  Amend  Default Accounts\" at 1006             with foreground-color 2.\n     display  \"(3)  Display The Defaults\" at 1206                with foreground-color 2.\n     display  \"(9)  Return To System Menu\" at 2006               with foreground-color 2.\n     accept   menu-reply  at 0544 with foreground-color 6 auto.\n     if       menu-reply = 1\n              perform  set-up.\n     if       menu-reply = 2\n              perform  amend.\n     if       menu-reply = 3\n              perform  show.\n     if       menu-reply = 9\n              go to main01-exit.\n     go       to init01-Main.\n*>\n accept-money.\n*>-----------\n*>\n     move     amt-wk-pds to ws-pound.\n     move     amt-wk-pence to ws-pence.\n     display  ws-amount-screen-display at curs2  with foreground-color 3.\n     accept   ws-amount-screen-accept at curs2   with update foreground-color 3.\n     move     ws-pound to amt-wk-pds.\n     move     ws-pence to amt-wk-pence.\n*>\n main01-exit.\n     exit     program.\n*>\n set-up       section.\n*>-------------------\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  \"Default Accounts Set-Up\" at 0129 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n*>\n main-loop.\n*>--------\n     display  \"Add To Existing Defaults (Y/N) ? - [ ]\" at 0501 with foreground-color 2.\n     display  \"N.B. (1) If first time set-up for this client answer no (N)\"\n                                      at 0701 with foreground-color 2.\n     display  \"(2) Answering no (N)\"  at 0806  with foreground-color 2.\n     display  \"DESTROYS\" at 0827 with foreground-color 4 background-color 7 highlight.\n     display  \"the existing defaults\" at 0836  with foreground-color 2.\n     accept   ws-reply  at 0537 with foreground-color 4.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply = \"N\"\n              perform  file-init.      *> removed passwd processing for O/S versions.\n     if       ws-reply not = \"Y\"\n                   and not = \"N\"\n              go to  main-loop.\n     display  space at 0501 with erase eol.\n     display  space at 0601 with erase eol.\n     display  space at 0701 with erase eol.\n     display  space at 0801 with erase eol.\n     perform  input-headings.\n*>\n get-input.\n*>--------\n*>\n     display  w at curs with foreground-color 2.\n     add      3  curs giving curs2.\n     move     def-acs (w) to amt-ok.\n     perform  accept-money.\n     move     amt-ok to def-acs (w).\n*>\n     if       cob-crt-status = cob-scr-esc\n       if     w < 30\n              move 41  to  cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input.\n*>\n     if       cob-crt-status = cob-scr-esc\n       if     w < 31\n         and  auto-vat\n              move 41  to  cole\n              move 31  to  w\n              move 21  to  lin\n              go to get-input\n       else\n              go to main-end.\n*>\n     if       def-acs (w) = zero\n       and    w < 30\n              move 41  to  cole\n              move 30  to  w\n              move 20  to  lin\n              go to get-input.\n*>\n     if       def-acs (w) = zero\n       and    auto-vat\n              move 41  to  cole\n              move 31  to  w\n              move 21  to  lin\n              go to get-input.\n*>\n*> get code description.\n*>\n     perform  get-description.\n*>\n     if       we-error = 255\n              go to get-input.\n*>\n     add      12  curs giving curs2.\n     display  ledger-name at curs2 with foreground-color 3.\n     add      20 to col2.\n     display  \"[  ] \" at curs2 with foreground-color 2.\n     add      1 to col2.\n     move     def-codes (w) to ws-codes.\n     display  ws-codes at curs2 with foreground-color 3.\n*>\n     if       w < 30\n              accept ws-codes  at curs2  with foreground-color 3 update\n              move function upper-case (ws-codes) to ws-codes\n     else\n      if      w = 30\n              move \"OB\" to ws-codes\n      else\n       if     w = 31\n              move \"VI\" to ws-codes\n       else\n              move \"VO\" to ws-codes.\n*>\n     display  ws-codes at curs2 with foreground-color 2.\n*>\n     if       cob-crt-status not = cob-scr-esc\n              next sentence\n     else\n       if     w < 30\n              move 41 to cole\n              move 30 to w\n              move 20 to lin\n              go to get-input.\n*>\n     if       cob-crt-status not = cob-scr-esc\n              next sentence\n     else\n       if     auto-vat and w < 31\n              move 41 to cole\n              move 31 to w\n              move 21 to lin\n              go to get-input\n       else\n              go to main-end.\n*>\n     move     ws-codes to def-codes (w).\n*>\n vat-check.\n*>--------\n*>\n     add      38    curs giving curs2.\n     move     def-vat (w) to ws-vat.\n     display  ws-vat at curs2 with foreground-color 3.\n\n     if       w < 30\n              accept ws-vat at curs2 with foreground-color 3 update\n              move function upper-case (ws-vat) to ws-vat\n     else\n              move \"N\" to ws-vat\n              display ws-vat at curs2 with foreground-color 3.\n*>\n     if       cob-crt-status not = cob-scr-esc\n              next sentence\n     else\n       if     auto-vat and w < 31\n              move 41 to cole\n              move 31 to w\n              move 21 to lin\n              go to get-input\n       else\n              go to main-end.\n*>\n     move     ws-vat to def-vat (w).\n     if       ws-vat  = \"I\" or \"N\" or \"O\"\n              next sentence\n     else\n              go to vat-check.\n     add      1  to  w.\n     if       w  >  32\n              go to main-end.\n     if       w  =  17\n              move 41  to  cole\n              move 6   to  lin.\n     add      1  to  lin.\n     go       to get-input.\n*>\n main-end.\n*>-------\n*>\n     perform  amend.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n amend        section.\n*>-------------------\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Default Accounts Amendment\" at 0127 with foreground-color 2.\n     display  to-day at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n     perform  input-headings.\n*>\n get-input.\n*>--------\n     move     zero to y.\n     display  \"Enter Number To Alter (Return to exit)  :- [  ]\" at 2401 with foreground-color 2.\n     accept   y  at 2445 with foreground-color 6 update.\n     if       y = zero\n              go to end-input.\n     if       y  <  1  or  >  32\n              go to get-input.\n     move     y  to  w.\n     if       y  >  16\n              subtract 16  from  y\n              move     41  to  cole\n      else\n              move     1   to  cole.\n     move     zero  to  lin.\n     add      y  6  to  lin\n     display  w at curs with foreground-color 2.\n     add      3    curs giving curs2.\n     move     def-acs (w) to amt-ok.\n     perform  accept-money.\n     move     amt-ok to def-acs (w).\n*>\n*> get code description.\n*>\n     perform  get-description.\n*>\n     if       we-error = 255\n              go to  get-input.\n     add      12    curs giving curs2.\n     display  ledger-name at curs2 with foreground-color 3.\n     add      20 to col2.\n     display  \"[  ] \" at curs2 with foreground-color 2.\n     add      1 to col2.\n     move     def-codes (w) to ws-codes.\n     accept   ws-codes  at curs2 with update foreground-color 3.\n     move     ws-codes to def-codes (w).\n     add      33    curs giving curs2.\n     display  ws-codes at curs2 with foreground-color 3.\n*>\n vat-check.\n*>--------\n*>\n     add      38    curs giving curs2.\n     move     def-vat (w) to ws-vat.\n     accept   ws-vat   at curs2 with update foreground-color 3.\n     move function upper-case (ws-vat) to ws-vat.\n\n     if       ws-vat  = \"I\" or \"N\" or \"O\"\n              next sentence\n     else\n              go to vat-check.\n     move     ws-vat to def-vat (w).\n     go       to get-input.\n*>\n end-input.\n*>--------\n*>\n     perform  GL-Nominal-Close.  *>  close ledger-file.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n show         section.\n*>-------------------\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Default Accounts Display\" at 0126   with foreground-color 2.\n     display  WS-Date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n*>\n     perform  input-headings.\n     display  \"End of listing. Hit return for Menu.\" at 2301 with foreground-color 2.\n     accept   ws-reply  at 2379 with foreground-color 6.\n     perform  GL-Nominal-Close.  *> close ledger-file.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n file-init    section.\n*>-------------------\n*>\n*> Changed to simple password as passkey encryption breaches UK MIS security regs\n*>   if not supplied as a library.\n*>\n *>    move     \"P\" to encode.\n *>    display  \"Enter Password  - [    ]\" at 0551  with foreground-color 2.\n  *>    display   \"Enter Passkey  -  [                                ] at 0501 with foreground-color 2.\n *>    accept   pass-word of maps01-ws at 0570      with foreground-color 6 secure.\n *>    call     \"maps01\" using maps01-ws.\n *>    if       pass-word of maps01-ws not =\n *>             pass-word of system-record\n *>             move \"Z\"  to  ws-reply\n *>             go to main-exit.\n     initialize Default-Record.\n*>\n main-exit.\n*>--------\n*>\n     exit     section.\n*>\n input-headings section.\n*>---------------------\n*>\n     display  \"A/C Nos\" at 0504 with foreground-color 2.\n     display  \"Code Vat\" at 0533 with foreground-color 2.\n     display  \"A/C Nos\" at 0544 with foreground-color 2.\n     display  \"Code Vat\" at 0573 with foreground-color 2.\n     move     7  to  lin.\n     move     1  to  w  cole.\n*>\n input-loop.\n*>---------\n*>\n     display  w at curs with foreground-color 2.\n     add      2    curs giving curs2.\n     display  \"[       ]\" at curs2 with foreground-color 2.\n     add      30 to col2.\n     display  \"[  ] [ ]\" at curs2 with foreground-color 2.\n     add      1  to  w.\n     if       w  >  32\n              go to end-loop.\n     if       w  =  17\n              move 6  to  lin\n              move 41 to  cole.\n     add      1  to  lin.\n     go       to input-loop.\n*>\n end-loop.\n*>-------\n*>\n*> Now input existing defaults\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n display-existing.\n*>---------------\n*>\n     add      3    curs giving curs2.\n     move     def-acs (w) to ws-acs.\n     display  ws-acs  at curs2 with foreground-color 3.\n     if       def-acs (w) = zero\n              go to jump-1.\n*>\n*> get code description.\n*>\n     perform  get-description.\n     if       we-error = 255\n              go to jump-1.\n     add      12  curs giving curs2.\n     display  ledger-name at curs2 with foreground-color 3.\n     add      20 to col2.\n     display  \"[  ] \" at curs2 with foreground-color 2.\n*>\n jump-1.\n*>-----\n*>\n     add      33    curs giving curs2.\n     move     def-codes (w) to ws-codes.\n     display  ws-codes  at curs2 with foreground-color 3.\n     add      5 to col2.\n     move     def-vat (w) to ws-vat.\n     display  ws-vat  at curs2 with foreground-color 3.\n     add      1  to  w.\n     if       w  >  32\n              go to display-existing-end.\n     if       w  =  17\n              move 41  to  cole\n              move 6   to  lin.\n     add      1  to  lin.\n     go       to display-existing.\n*>\n display-existing-end.\n*>-------------------\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n get-description section.\n*>----------------------\n*>\n     multiply def-acs (w)  by  100  giving  WS-Ledger-nos.\n     move     \"00\"         to  ledger-pc.\n     move     zero to we-error.\n*>\n     perform  GL-Nominal-Read-Indexed.  *>  read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps03.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps03.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps03       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 88
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 4,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 56,
      "totalOperators": 54,
      "totalOperands": 108,
      "vocabulary": 57,
      "length": 162,
      "volume": 944.9281822946881
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
