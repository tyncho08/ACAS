{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/general/gl050.cbl",
  "fileName": "gl050.cbl",
  "timestamp": "2025-09-15T16:25:32.408Z",
  "programId": "gl050",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 110
      },
      {
        "name": "file",
        "line": 123
      },
      {
        "name": "working-storage",
        "line": 130
      },
      {
        "name": "linkage",
        "line": 295
      },
      {
        "name": "init01",
        "line": 312
      },
      {
        "name": "gl020c-show",
        "line": 463
      },
      {
        "name": "input-headings",
        "line": 478
      },
      {
        "name": "gl050a",
        "line": 570
      },
      {
        "name": "gl050b",
        "line": 1021
      },
      {
        "name": "write-out",
        "line": 1477
      },
      {
        "name": "back-up",
        "line": 1519
      },
      {
        "name": "open-posting",
        "line": 1565
      },
      {
        "name": "close-posting",
        "line": 1573
      },
      {
        "name": "quit-batch",
        "line": 1581
      },
      {
        "name": "zz050-Validate-Date",
        "line": 1614
      },
      {
        "name": "exit",
        "line": 1651
      },
      {
        "name": "zz060-Convert-Date",
        "line": 1653
      },
      {
        "name": "exit",
        "line": 1686
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1688
      },
      {
        "name": "exit",
        "line": 1716
      },
      {
        "name": "maps03",
        "line": 1718
      },
      {
        "name": "exit",
        "line": 1724
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 113
      },
      {
        "name": "file-defs",
        "line": 309
      },
      {
        "name": "menu-input",
        "line": 340
      },
      {
        "name": "get-default",
        "line": 365
      },
      {
        "name": "menu-exit",
        "line": 374
      },
      {
        "name": "menu-ex",
        "line": 380
      },
      {
        "name": "goback",
        "line": 382
      },
      {
        "name": "get-next-batch",
        "line": 388
      },
      {
        "name": "write-next-batch",
        "line": 395
      },
      {
        "name": "get-batch",
        "line": 403
      },
      {
        "name": "end-get-batch",
        "line": 419
      },
      {
        "name": "put-batch",
        "line": 422
      },
      {
        "name": "accept-money8s",
        "line": 427
      },
      {
        "name": "accept-money8s2",
        "line": 436
      },
      {
        "name": "accept-money9",
        "line": 445
      },
      {
        "name": "accept-account",
        "line": 454
      },
      {
        "name": "input-loop",
        "line": 488
      },
      {
        "name": "end-loop",
        "line": 505
      },
      {
        "name": "display-existing",
        "line": 513
      },
      {
        "name": "jump-1",
        "line": 532
      },
      {
        "name": "get-description",
        "line": 550
      },
      {
        "name": "display-existing-end",
        "line": 561
      },
      {
        "name": "init-done",
        "line": 592
      },
      {
        "name": "def-in",
        "line": 614
      },
      {
        "name": "end-if",
        "line": 651
      },
      {
        "name": "post-in",
        "line": 653
      },
      {
        "name": "default-pc",
        "line": 670
      },
      {
        "name": "def-date",
        "line": 690
      },
      {
        "name": "jump-1",
        "line": 704
      },
      {
        "name": "batch-in",
        "line": 722
      },
      {
        "name": "cycle-in",
        "line": 746
      },
      {
        "name": "items-in",
        "line": 766
      },
      {
        "name": "gross-in",
        "line": 776
      },
      {
        "name": "vat-in",
        "line": 785
      },
      {
        "name": "desc-in",
        "line": 797
      },
      {
        "name": "batch-outline",
        "line": 811
      },
      {
        "name": "b-o-loop2",
        "line": 826
      },
      {
        "name": "b-o-data",
        "line": 836
      },
      {
        "name": "help-outline",
        "line": 840
      },
      {
        "name": "h-o-loop2",
        "line": 847
      },
      {
        "name": "h-o-data",
        "line": 857
      },
      {
        "name": "def-set-up",
        "line": 864
      },
      {
        "name": "d-s-loop1",
        "line": 870
      },
      {
        "name": "get-ac",
        "line": 881
      },
      {
        "name": "get-vat",
        "line": 897
      },
      {
        "name": "get-code",
        "line": 915
      },
      {
        "name": "dummy-return-1",
        "line": 934
      },
      {
        "name": "exit",
        "line": 935
      },
      {
        "name": "validate-pc",
        "line": 937
      },
      {
        "name": "dummy-return-2",
        "line": 956
      },
      {
        "name": "exit",
        "line": 957
      },
      {
        "name": "get-description",
        "line": 959
      },
      {
        "name": "def-val",
        "line": 979
      },
      {
        "name": "store-defaults",
        "line": 989
      },
      {
        "name": "val-date",
        "line": 996
      },
      {
        "name": "dummy-return-x",
        "line": 1007
      },
      {
        "name": "exit",
        "line": 1008
      },
      {
        "name": "program-exit",
        "line": 1010
      },
      {
        "name": "main-end",
        "line": 1013
      },
      {
        "name": "define-vat-rate",
        "line": 1038
      },
      {
        "name": "Reget-Vat-Rate",
        "line": 1044
      },
      {
        "name": "jump-tag",
        "line": 1065
      },
      {
        "name": "main-loop",
        "line": 1116
      },
      {
        "name": "get-account",
        "line": 1152
      },
      {
        "name": "accept-p-c",
        "line": 1191
      },
      {
        "name": "accept-amount",
        "line": 1219
      },
      {
        "name": "accept-vat",
        "line": 1251
      },
      {
        "name": "vat-amount-input",
        "line": 1298
      },
      {
        "name": "accept-narative",
        "line": 1337
      },
      {
        "name": "loop-end",
        "line": 1369
      },
      {
        "name": "help-outline",
        "line": 1419
      },
      {
        "name": "h-o-loop2",
        "line": 1427
      },
      {
        "name": "h-o-data",
        "line": 1437
      },
      {
        "name": "net",
        "line": 1446
      },
      {
        "name": "gross",
        "line": 1453
      },
      {
        "name": "main-exit",
        "line": 1462
      },
      {
        "name": "write-loop",
        "line": 1495
      },
      {
        "name": "sub-loop",
        "line": 1531
      },
      {
        "name": "read-loop",
        "line": 1543
      },
      {
        "name": "loop",
        "line": 1590
      },
      {
        "name": "read-next",
        "line": 1596
      },
      {
        "name": "main-end",
        "line": 1605
      },
      {
        "name": "zz050-test-date",
        "line": 1645
      },
      {
        "name": "zz050-exit",
        "line": 1650
      },
      {
        "name": "zz060-Exit",
        "line": 1685
      },
      {
        "name": "zz070-Exit",
        "line": 1715
      },
      {
        "name": "maps04-exit",
        "line": 1723
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 1112,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "maps04",
        "line": 1721,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 100,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 109,
        "replacing": null
      },
      {
        "name": "seledger",
        "line": 116,
        "replacing": null
      },
      {
        "name": "selbatch",
        "line": 117,
        "replacing": null
      },
      {
        "name": "selpost",
        "line": 118,
        "replacing": null
      },
      {
        "name": "fdledger",
        "line": 126,
        "replacing": null
      },
      {
        "name": "fdbatch",
        "line": 127,
        "replacing": null
      },
      {
        "name": "fdpost",
        "line": 128,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 135,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 136,
        "replacing": null
      },
      {
        "name": "wsledger",
        "line": 137,
        "replacing": null
      },
      {
        "name": "wsbatch",
        "line": 138,
        "replacing": null
      },
      {
        "name": "wspost",
        "line": 139,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 165,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 168,
        "replacing": null
      },
      {
        "name": "glwspc",
        "line": 291,
        "replacing": null
      },
      {
        "name": "glwspint",
        "line": 293,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 298,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 299,
        "replacing": null
      },
      {
        "name": "wsdflt",
        "line": 300,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 301,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1726,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "GL-Batch-Open-Input",
        "thru": null,
        "line": 321
      },
      {
        "target": "GL-Batch-Open-Output",
        "thru": null,
        "line": 323
      },
      {
        "target": "GL-Batch-Write",
        "thru": null,
        "line": 329
      },
      {
        "target": "GL-Batch-Close",
        "thru": null,
        "line": 330
      },
      {
        "target": "GL-Batch-Open",
        "thru": null,
        "line": 331
      },
      {
        "target": "GL-Posting-Open-Input",
        "thru": null,
        "line": 333
      },
      {
        "target": "GL-Posting-Open-Output",
        "thru": null,
        "line": 335
      },
      {
        "target": "GL-Posting-Write",
        "thru": null,
        "line": 337
      },
      {
        "target": "GL-Posting-Close",
        "thru": null,
        "line": 338
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 345
      },
      {
        "target": "get-next-batch",
        "thru": null,
        "line": 361
      },
      {
        "target": "gl050a",
        "thru": null,
        "line": 368
      },
      {
        "target": "gl050b",
        "thru": null,
        "line": 371
      },
      {
        "target": "write-next-batch",
        "thru": null,
        "line": 372
      },
      {
        "target": "GL-Batch-Close",
        "thru": null,
        "line": 378
      },
      {
        "target": "GL-Batch-Write",
        "thru": null,
        "line": 401
      },
      {
        "target": "GL-Batch-Open",
        "thru": null,
        "line": 406
      },
      {
        "target": "GL-Batch-Read-Indexed",
        "thru": null,
        "line": 415
      },
      {
        "target": "GL-Batch-Rewrite",
        "thru": null,
        "line": 425
      },
      {
        "target": "input-headings",
        "thru": null,
        "line": 471
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 524
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 557
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 573
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 582
      },
      {
        "target": "main-end",
        "thru": null,
        "line": 587
      },
      {
        "target": "batch-outline",
        "thru": null,
        "line": 600
      },
      {
        "target": "help-outline",
        "thru": null,
        "line": 602
      },
      {
        "target": "gl020c-show",
        "thru": null,
        "line": 625
      },
      {
        "target": "def-set-up",
        "thru": null,
        "line": 638
      },
      {
        "target": "def-val",
        "thru": null,
        "line": 641
      },
      {
        "target": "validate-pc",
        "thru": null,
        "line": 686
      },
      {
        "target": "store-defaults",
        "thru": null,
        "line": 693
      },
      {
        "target": "val-date",
        "thru": null,
        "line": 718
      },
      {
        "target": "accept-money9",
        "thru": null,
        "line": 780
      },
      {
        "target": "accept-money9",
        "thru": null,
        "line": 792
      },
      {
        "target": "accept-account",
        "thru": null,
        "line": 884
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 891
      },
      {
        "target": "batch-outline",
        "thru": null,
        "line": 930
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 949
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 970
      },
      {
        "target": "get-description",
        "thru": null,
        "line": 987
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1000
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1016
      },
      {
        "target": "help-outline",
        "thru": null,
        "line": 1028
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 1030
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1124
      },
      {
        "target": "reget-vat-rate",
        "thru": null,
        "line": 1129
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1144
      },
      {
        "target": "accept-account",
        "thru": null,
        "line": 1156
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1159
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 1175
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1203
      },
      {
        "target": "accept-money8s",
        "thru": null,
        "line": 1224
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1230
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1267
      },
      {
        "target": "net",
        "thru": null,
        "line": 1284
      },
      {
        "target": "gross",
        "thru": null,
        "line": 1288
      },
      {
        "target": "accept-money8s2",
        "thru": null,
        "line": 1308
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1321
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1348
      },
      {
        "target": "write-out",
        "thru": null,
        "line": 1414
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1465
      },
      {
        "target": "quit-batch",
        "thru": null,
        "line": 1468
      },
      {
        "target": "open-posting",
        "thru": null,
        "line": 1483
      },
      {
        "target": "write-loop",
        "thru": null,
        "line": 1488
      },
      {
        "target": "close-posting",
        "thru": null,
        "line": 1490
      },
      {
        "target": "GL-Posting-Write",
        "thru": null,
        "line": 1514
      },
      {
        "target": "write-out",
        "thru": null,
        "line": 1523
      },
      {
        "target": "open-posting",
        "thru": null,
        "line": 1536
      },
      {
        "target": "GL-Posting-Read-Next",
        "thru": null,
        "line": 1537
      },
      {
        "target": "read-loop",
        "thru": null,
        "line": 1539
      },
      {
        "target": "close-posting",
        "thru": null,
        "line": 1540
      },
      {
        "target": "GL-Posting-Read-Next",
        "thru": null,
        "line": 1546
      },
      {
        "target": "GL-Posting-Delete",
        "thru": null,
        "line": 1560
      },
      {
        "target": "GL-Posting-Open",
        "thru": null,
        "line": 1568
      },
      {
        "target": "GL-Posting-Close",
        "thru": null,
        "line": 1576
      },
      {
        "target": "open-posting",
        "thru": null,
        "line": 1584
      },
      {
        "target": "GL-Posting-Read-Indexed",
        "thru": null,
        "line": 1586
      },
      {
        "target": "GL-Posting-Delete",
        "thru": null,
        "line": 1594
      },
      {
        "target": "GL-Posting-Read-Next",
        "thru": null,
        "line": 1599
      },
      {
        "target": "close-posting",
        "thru": null,
        "line": 1608
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 1648
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 1662
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "RRN",
        "to": "POST-RRN BEFORE PROCESSING              *\n*>  The whole issue regarding using RRN needs to be      *\n*>   examined to see if a replacement key should be used *\n*> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ *\n*>  THIS WILL APPLY TO OTHER PROGRAMS THAT USE THE       =\n*>     POSTING FILE  {gl051 ]                            =\n*>********************************************************\n*>\n identification          division",
        "line": 8
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 318
      },
      {
        "from": "spaces",
        "to": "posting-array",
        "line": 320
      },
      {
        "from": "spaces",
        "to": "description\n              move 9      to  WS-Ledger\n              move 99999  to  WS-Batch-Nos\n              move 99     to  bcycle of WS-Batch-Record\n              perform  GL-Batch-Write",
        "line": 325
      },
      {
        "from": "1",
        "to": "a ws-menu",
        "line": 350
      },
      {
        "from": "1",
        "to": "WS-Ledger",
        "line": 391
      },
      {
        "from": "next-batch",
        "to": "WS-Batch-Nos",
        "line": 392
      },
      {
        "from": "1",
        "to": "WS-Ledger",
        "line": 407
      },
      {
        "from": "zero",
        "to": "ws-poundsd8s amt-ok8s ws-penced8s",
        "line": 430
      },
      {
        "from": "ws-pound8s",
        "to": "amt-wk-pds8s",
        "line": 433
      },
      {
        "from": "ws-pence8s",
        "to": "amt-wk-pence8s",
        "line": 434
      },
      {
        "from": "amt-wk-pence8s",
        "to": "ws-pence8s",
        "line": 439
      },
      {
        "from": "amt-wk-pds8s",
        "to": "ws-pound8s",
        "line": 440
      },
      {
        "from": "ws-pound8s",
        "to": "amt-wk-pds8s",
        "line": 442
      },
      {
        "from": "ws-pence8s",
        "to": "amt-wk-pence8s",
        "line": 443
      },
      {
        "from": "zero",
        "to": "ws-poundsd9 amt-ok9 ws-penced9",
        "line": 448
      },
      {
        "from": "ws-pound9",
        "to": "amt-wk-pds9",
        "line": 451
      },
      {
        "from": "ws-pence9",
        "to": "amt-wk-pence9",
        "line": 452
      },
      {
        "from": "zero",
        "to": "ws-maind acc-ok ws-subd",
        "line": 457
      },
      {
        "from": "ws-main",
        "to": "acc-wk-main\n     move     ws-sub   to acc-wk-sub",
        "line": 460
      },
      {
        "from": "7",
        "to": "lin",
        "line": 485
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 486
      },
      {
        "from": "6",
        "to": "lin\n              move 41 to  cole",
        "line": 500
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 510
      },
      {
        "from": "7",
        "to": "lin",
        "line": 511
      },
      {
        "from": "41",
        "to": "cole\n              move 6   to  lin",
        "line": 545
      },
      {
        "from": "\"00\"",
        "to": "ledger-pc",
        "line": 554
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 555
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 559
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 564
      },
      {
        "from": "7",
        "to": "lin",
        "line": 565
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 579
      },
      {
        "from": "\"00\"",
        "to": "ledger-pc",
        "line": 580
      },
      {
        "from": "WS-Ledger-Record",
        "to": "p-c-branches",
        "line": 590
      },
      {
        "from": "a",
        "to": "bdefault\n              go to  main-end",
        "line": 629
      },
      {
        "from": "zero",
        "to": "batch-def-pc",
        "line": 635
      },
      {
        "from": "a",
        "to": "bdefault",
        "line": 646
      },
      {
        "from": "1",
        "to": "vat-flag\n     else\n              move zero to vat-flag\n     end-if",
        "line": 648
      },
      {
        "from": "\"CR\"",
        "to": "convention2",
        "line": 661
      },
      {
        "from": "ws-date",
        "to": "tran-date",
        "line": 707
      },
      {
        "from": "1",
        "to": "WS-Ledger",
        "line": 725
      },
      {
        "from": "zero",
        "to": "batch-status cleared-status proofed posted\n                      stored actual-gross actual-vat",
        "line": 726
      },
      {
        "from": "WS-Batch-Nos",
        "to": "display-batch",
        "line": 732
      },
      {
        "from": "2020",
        "to": "curs2",
        "line": 779
      },
      {
        "from": "amt-ok9",
        "to": "input-gross",
        "line": 783
      },
      {
        "from": "2120",
        "to": "curs2",
        "line": 791
      },
      {
        "from": "amt-ok9",
        "to": "input-vat",
        "line": 795
      },
      {
        "from": "15",
        "to": "lin",
        "line": 822
      },
      {
        "from": "1",
        "to": "cole",
        "line": 829
      },
      {
        "from": "46",
        "to": "cole",
        "line": 831
      },
      {
        "from": "15",
        "to": "lin",
        "line": 843
      },
      {
        "from": "50",
        "to": "cole",
        "line": 850
      },
      {
        "from": "80",
        "to": "cole",
        "line": 852
      },
      {
        "from": "16",
        "to": "lin",
        "line": 867
      },
      {
        "from": "2",
        "to": "cole",
        "line": 868
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 882
      },
      {
        "from": "1911",
        "to": "curs2",
        "line": 883
      },
      {
        "from": "acc-ok",
        "to": "def-acs (33)",
        "line": 885
      },
      {
        "from": "33",
        "to": "a",
        "line": 889
      },
      {
        "from": "zero",
        "to": "batch-def-pc",
        "line": 890
      },
      {
        "from": "ws-vat",
        "to": "def-vat (33)",
        "line": 913
      },
      {
        "from": "1",
        "to": "truth",
        "line": 932
      },
      {
        "from": "1",
        "to": "truth\n     else\n      if      p-b-codes  (batch-def-pc) = \"Y\" OR \"E\"\n              move  1  to  truth\n       else\n              move  0  to  truth",
        "line": 941
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 962
      },
      {
        "from": "zeros",
        "to": "ledger-pc\n     else\n              move  batch-def-pc  to  ledger-pc\n     end-if\n     perform  GL-Nominal-Read-Indexed",
        "line": 966
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 972
      },
      {
        "from": "0",
        "to": "truth\n     else\n              move  1  to  truth",
        "line": 975
      },
      {
        "from": "0",
        "to": "truth\n     else\n              move  1  to  truth\n     end-if\n     perform  get-description",
        "line": 983
      },
      {
        "from": "tran-date",
        "to": "ws-test-date",
        "line": 999
      },
      {
        "from": "0",
        "to": "truth\n     else\n              move   1  to  truth\n              move   u-bin  to  entered",
        "line": 1002
      },
      {
        "from": "zero",
        "to": "w",
        "line": 1032
      },
      {
        "from": "32",
        "to": "w",
        "line": 1034
      },
      {
        "from": "31",
        "to": "w",
        "line": 1036
      },
      {
        "from": "1",
        "to": "v",
        "line": 1046
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1059
      },
      {
        "from": "WS-Batch-Nos",
        "to": "display-batch",
        "line": 1067
      },
      {
        "from": "zero",
        "to": "batch-def-pc",
        "line": 1078
      },
      {
        "from": "entered",
        "to": "u-bin",
        "line": 1111
      },
      {
        "from": "zero",
        "to": "save-a",
        "line": 1113
      },
      {
        "from": "1",
        "to": "a",
        "line": 1114
      },
      {
        "from": "ws-date",
        "to": "array-date (a)",
        "line": 1122
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1142
      },
      {
        "from": "ws-test-date",
        "to": "array-date (a)",
        "line": 1145
      },
      {
        "from": "0817",
        "to": "curs2",
        "line": 1155
      },
      {
        "from": "acc-ok",
        "to": "account-in",
        "line": 1157
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 1171
      },
      {
        "from": "array-pc",
        "to": "ledger-pc",
        "line": 1173
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1177
      },
      {
        "from": "1",
        "to": "vat-flag-2\n     else\n              move zero to vat-flag-2",
        "line": 1187
      },
      {
        "from": "zero",
        "to": "array-pc",
        "line": 1194
      },
      {
        "from": "1217",
        "to": "curs2",
        "line": 1222
      },
      {
        "from": "amt-ok8s",
        "to": "array-amount (a)\n     else\n              move zero to array-amount (a)",
        "line": 1225
      },
      {
        "from": "zero",
        "to": "array-vat-amount (a)\n              go to  vat-amount-input",
        "line": 1255
      },
      {
        "from": "space",
        "to": "array-vat",
        "line": 1258
      },
      {
        "from": "zero",
        "to": "array-vat-amount (a)\n              go to vat-amount-input",
        "line": 1260
      },
      {
        "from": "zero",
        "to": "array-vat-amount (a)\n              go to accept-narative",
        "line": 1292
      },
      {
        "from": "1617",
        "to": "curs2",
        "line": 1306
      },
      {
        "from": "amt-ok8s",
        "to": "array-vat-amount (a)",
        "line": 1319
      },
      {
        "from": "spaces",
        "to": "ws-legend",
        "line": 1344
      },
      {
        "from": "ws-legend",
        "to": "array-legend (a)",
        "line": 1346
      },
      {
        "from": "1",
        "to": "rev-flag",
        "line": 1376
      },
      {
        "from": "\"DR\"",
        "to": "ws-convention",
        "line": 1380
      },
      {
        "from": "\"CR\"",
        "to": "ws-convention",
        "line": 1383
      },
      {
        "from": "array-pc",
        "to": "array-dr-pc (a)\n              move  \"DR\"  to  array-vat-side (a)\n     else\n              multiply  account-in  by  100\n                        giving  array-cr (a)\n              move  array-pc    to  array-cr-pc (a)\n              move  \"CR\"  to  array-vat-side (a)",
        "line": 1388
      },
      {
        "from": "batch-def-ac",
        "to": "array-cr (a)\n              move  batch-def-pc  to  array-cr-pc (a)\n     else\n              move  batch-def-ac  to  array-dr (a)\n              move  batch-def-pc  to  array-dr-pc (a)\n*>\n     move     batch-def-code  to  array-code (a)",
        "line": 1397
      },
      {
        "from": "zero",
        "to": "array-vat-ac (a)",
        "line": 1408
      },
      {
        "from": "batch-def-pc",
        "to": "array-vat-pc (a)",
        "line": 1410
      },
      {
        "from": "zero",
        "to": "rev-flag",
        "line": 1416
      },
      {
        "from": "14",
        "to": "lin",
        "line": 1422
      },
      {
        "from": "54",
        "to": "cole",
        "line": 1423
      },
      {
        "from": "54",
        "to": "cole",
        "line": 1430
      },
      {
        "from": "80",
        "to": "cole",
        "line": 1432
      },
      {
        "from": "1",
        "to": "a",
        "line": 1492
      },
      {
        "from": "WS-Batch-Nos",
        "to": "batch",
        "line": 1498
      },
      {
        "from": "batch-def-code",
        "to": "post-code in WS-Posting-record",
        "line": 1501
      },
      {
        "from": "z",
        "to": "a\n              go to  main-exit",
        "line": 1525
      },
      {
        "from": "post-date",
        "to": "array-date (y)",
        "line": 1548
      },
      {
        "from": "post-dr",
        "to": "array-dr (y)",
        "line": 1549
      },
      {
        "from": "dr-pc",
        "to": "array-dr-pc (y)",
        "line": 1550
      },
      {
        "from": "post-cr",
        "to": "array-cr (y)",
        "line": 1551
      },
      {
        "from": "cr-pc",
        "to": "array-cr-pc (y)",
        "line": 1552
      },
      {
        "from": "post-amount",
        "to": "array-amount (y)",
        "line": 1553
      },
      {
        "from": "post-legend",
        "to": "array-legend (y)",
        "line": 1554
      },
      {
        "from": "vat-pc",
        "to": "array-vat-pc (y)",
        "line": 1556
      },
      {
        "from": "post-vat-side",
        "to": "array-vat-side (y)",
        "line": 1557
      },
      {
        "from": "vat-amount",
        "to": "array-vat-amount (y)",
        "line": 1558
      },
      {
        "from": "batch-start",
        "to": "rrn",
        "line": 1585
      },
      {
        "from": "9",
        "to": "z",
        "line": 1609
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 1627
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1629
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 1633
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 1640
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 1646
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1647
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 1664
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 1666
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1669
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 1673
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1680
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 1696
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1699
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 1703
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1710
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "a replacement key should be used *\n*> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ *\n*>  THIS WILL APPLY TO OTHER PROGRAMS THAT USE THE       =\n*>     POSTING FILE  {gl051 ]                            =\n*>********************************************************\n*>\n identification          division.\n*>===============================\n*>\n*>**\n      program-id.         gl050.\n*>**\n*>    Author.             GL was written by Simon Whine MBCS, on behalf of\n*>                        Applewood Computers and its group of Companies.\n*>                        All changes/migrations by:\n*>                        Vincent B. Coen FBCS, FIDM, FIDPM.\n*>                        Converted For Cis December 84,\n*>                        For Applewood Computers.\n*>                        Written to supplement IRS to support larger numbers for\n*>                        accounts to 10 digits nominal and subnominals and money\n*>                        amounts to 100M - 1 for customers requiring a\n*>                        comparable? but cheaper product than Oracle financials.\n*>                        Reduced down some point later in time for accnts 6\n*>                        digits and reduced money amounts.\n*>**\n*>    Security.           Copyright (C) 1976-2025 & later, Vincent Bryan Coen.\n*>                        Distributed under the GNU General Public License.\n*>                        See the file COPYING for details.\n*>**\n*>    Remarks.            Transaction Processing.\n*>**\n*>    Version.            See Prog-Name In Ws.\n*>**\n*>    Called Modules.     Maps04.\n*>  ledger , posting, batch\n*>\n*>                        acas005 ->\n*>                         nominalMT\n*>                        acas006\n*>                         glpostingMT\n*>                        acas007\n*>                         glbatchMT\n*>**\n*>    Error messages used.\n*>                        GL010 Hit Return\n*>                        GL051 Set Up P/C Branches First\n*>                        GL052 Invalid. Too early\n*>                        GL053 Invalid. Too forward\n*>                        GL054 No check on items.\n*>**\n*> Changes:\n*> 27/01/09 vbc - Migration to Open Cobol.\n*> 18/12/11 vbc - .03 Support for dates other than UK & clean up msgs\n*>                    Error msgs to GLnnn,\n*>                    Support for path+filenames.\n*> 24/10/16 vbc - .   ALL programs now using wsnames.cob in copybooks\n*> 09/12/16 vbc - .04 Removed temp default function (33) using the 33rd\n*>                    occurance of default record fields.\n*> 12/01/18 vbc - .05 Updated for v3.02 & FH & DALs.\n*> 30/05/18 vbc - .06 Renamed all warning & error msgs also in Manual.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"seledger.cob\".\n*> copy \"selbatch.cob\".\n*> copy \"selpost.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdledger.cob\".\n*> copy \"fdbatch.cob\".\n*> copy \"fdpost.cob\".\n*>\n working-storage section.\n*>----------------------\n*>\n 77  prog-name           pic x(15)  value \"gl050 (3.02.06)\".\n*>\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsledger.cob\".\n copy \"wsbatch.cob\".\n copy \"wspost.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n*>     03  WS-Ledger-Record       pic x.\n*>     03  WS-Posting-Record      pic x.\n*>     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  accept-terminator-array pic 9(4).\n     copy \"screenio.cpy\".\n 01  filler.\n     03  display-acs         pic 9(4).99.\n     03  display-batch       pic z(4)9.\n     03  display-vat         pic z9.99.\n     03  display-amt         pic 9(8).99.\n     03  a                   pic 99           value zero.\n     03  save-a              pic 99           value zero.\n     03  v                   pic 9            value zero.\n     03  w                   pic 99           value zero.\n     03  y                   pic 99           value zero.\n     03  z                   pic 99           value zero.\n     03  ws-reply            pic x.\n     03  ws-menu             pic 9.\n     03  truth               pic 9       value zero.\n         88  falset            value 0.\n         88  truet             value 1.\n     03  tran-date           pic x(8).\n     03  ws-vat              pic x.\n     03  ws-vat2             pic x.\n     03  ws-codes            pic xx.\n     03  ws-codes2           pic xx.\n     03  ws-acs              pic 9(4).99.\n     03  ws-legend           pic x(32).\n     03  ws-vat-rate         pic 99v99   comp  value zero.\n     03  vat-flag            pic 9             value zero.\n     03  vat-flag-2          pic 9             value zero.\n*>    03  rev-flag            pic 9             value zero.\n     03  escape-code         pic x             value space.\n     03  account-in          pic 9(4)v99.\n     03  array-pc            pic 99.\n     03  array-vat           pic x.\n     03  convention2         pic xx.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  GL010          pic x(16) value \"GL010 Hit Return\".\n*> Module specific\n     03  GL051          pic x(31) value \"GL051 Set Up P/C Branches First\".\n     03  GL052          pic x(24) value \"GL052 Invalid. Too early\".\n     03  GL053          pic x(26) value \"GL053 Invalid. Too forward\".\n     03  GL054          pic x(24) value \"GL054 No check on items.\".\n*>\n 01  ws-account-screen-display.\n     03  ws-maind        pic 9(4).\n     03  ws-period1      pic x     value \".\".\n     03  ws-subd         pic v99.\n 01  ws-account-screen-accept redefines ws-account-screen-display.\n     03  ws-main         pic 9(4).\n     03  filler          pic x.\n     03  ws-sub          pic v99.\n*>\n 01  ws-account-work.\n     03  acc-wk-main     pic  9(4).\n     03  acc-wk-sub      pic v99.\n 01  ws-account-ok redefines ws-account-work.\n     03  acc-ok          pic 9(4)v99.\n*>\n 01  ws-amount-screen-display8s.\n     03  ws-poundsd8s    pic 9(8).\n     03  ws-period8s     pic x     value \".\".\n     03  ws-penced8s     pic v99.\n 01  ws-amount-screen-accept8s redefines ws-amount-screen-display8s.\n     03  ws-pound8s      pic 9(8).\n     03  filler          pic x.\n     03  ws-pence8s      pic v99.\n*>\n 01  ws-amount-work8s.\n     03  amt-wk-pds8s    pic 9(8).\n     03  amt-wk-pence8s  pic v99.\n 01  ws-amount-ok8s redefines ws-amount-work8s.\n     03  amt-ok8s        pic 9(8)v99.\n*>\n 01  ws-amount-screen-display9.\n     03  ws-poundsd9     pic 9(9).\n     03  ws-period9      pic x     value \".\".\n     03  ws-penced9      pic v99.\n 01  ws-amount-screen-accept9 redefines ws-amount-screen-display9.\n     03  ws-pound9       pic 9(9).\n     03  filler          pic x.\n     03  ws-pence9       pic v99.\n*>\n 01  ws-amount-work9.\n     03  amt-wk-pds9     pic 9(9).\n     03  amt-wk-pence9   pic v99.\n 01  ws-amount-ok9 redefines ws-amount-work9.\n     03  amt-ok9         pic 9(9)v99.\n*>\n 01  display-plus-31                value all \"+\".\n     03  display-plus-27 pic x(27).\n     03  display-plus-4  pic xxxx.\n*>\n 01  display-star-46     pic x(46)  value all \"*\".\n*>\n 01  display-spaces.\n     03  ws-space-44                value spaces.\n         05  ws-space-29 pic x(29).\n         05  ws-space-15 pic x(15).\n*>\n copy \"glwspc.cob\".\n*>\n copy \"glwspint.cob\".\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsdflt.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          default-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n*>*************\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     1  to File-Key-No.\n*>\n     move     spaces to posting-array.\n     perform  GL-Batch-Open-Input.            *> open input batch-file.\n     if       fs-reply not = zero\n              perform  GL-Batch-Open-Output   *> open output batch-file\n              initialize WS-Batch-Record\n              move spaces to description\n              move 9      to  WS-Ledger\n              move 99999  to  WS-Batch-Nos\n              move 99     to  bcycle of WS-Batch-Record\n              perform  GL-Batch-Write.        *> write batch-record.\n     perform  GL-Batch-Close.                 *> close batch-file.\n     perform  GL-Batch-Open.                  *> open i-o  batch-file.\n*>\n     perform  GL-Posting-Open-Input.          *> open input posting-file.\n     if       fs-reply not = zero\n              perform  GL-Posting-Open-Output *> open output posting-file\n              initialize WS-Posting-Record\n              perform  GL-Posting-Write.      *> write posting-record.\n     perform  GL-Posting-Close.               *> close posting-file.\n*>\n menu-input.\n*>*********\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Transaction Entry Functions\" at 0127  with foreground-color 2.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n     display  \"Select one of the following by number :- [1]\" at 0801 with foreground-color 2.\n*>\n     move     1  to  a ws-menu.\n*>\n     display  \"(1)  Set up New Batch\" at 1001  with foreground-color 2.\n     display  \"(9)  Exit to System Menu\" at 1301 with foreground-color 2.\n*>\n     accept   ws-menu at 0843 with foreground-color 6 update.\n*>\n     if       ws-menu = 9\n              go to  menu-exit.\n*>\n     if       ws-menu = 1\n              perform  get-next-batch\n              go to get-default.\n     go       to menu-input.\n*>\n get-default.\n*>**********\n*>\n     perform  gl050a.\n     if       bdefault = zero\n              go to  menu-exit.\n     perform  gl050b.\n     perform  write-next-batch.\n     go       to menu-input.\n\n menu-exit.\n*>********\n*>\n     perform  GL-Batch-Close.          *> close batch-file.\n*>\n menu-ex.\n*>\n     goback.\n*>\n*>*********************************************\n*>                 Procedures                 *\n*>*********************************************\n*>\n get-next-batch.\n*>*************\n*>\n     move     1           to  WS-Ledger.\n     move     next-batch  to  WS-Batch-Nos.\n     add      1           to  next-batch.\n*>\n write-next-batch.\n*>***************\n*>\n     if       z = 9\n              subtract  1  from  next-batch\n     else\n              perform  GL-Batch-Write.          *> write batch-record.\n*>\n get-batch.\n*>********\n*>\n     perform  GL-Batch-Open.         *> open i-o  batch-file.\n     move     1 to  WS-Ledger.\n*>\n     display  \"Enter Batch Number :- [     ]\" at 1801 with foreground-color 2.\n     accept   WS-Batch-Nos at 1824 with foreground-color 3 update.\n*>\n     if       WS-Batch-Nos = zero\n              go to  end-get-batch.\n*>\n     perform  GL-Batch-Read-Indexed.       *> read batch-file  record  invalid key\n     if       fs-reply = 21\n              go to  get-batch.\n*>\n end-get-batch.\n*>************\n*>\n put-batch.\n*>********\n*>\n     perform  GL-Batch-Rewrite.            *> rewrite batch-record.\n*>\n accept-money8s.\n*>-------------\n*>\n     move     zero to ws-poundsd8s amt-ok8s ws-penced8s.\n     display  ws-amount-screen-display8s at curs2  with foreground-color 3.\n     accept   ws-amount-screen-accept8s at curs2   with foreground-color 3 update.\n     move     ws-pound8s to amt-wk-pds8s.\n     move     ws-pence8s to amt-wk-pence8s.\n*>\n accept-money8s2.\n*>--------------\n*>\n     move     amt-wk-pence8s to ws-pence8s.\n     move     amt-wk-pds8s   to ws-pound8s.\n     accept   ws-amount-screen-accept8s at curs2 with foreground-color 3 update.\n     move     ws-pound8s to amt-wk-pds8s.\n     move     ws-pence8s to amt-wk-pence8s.\n*>\n accept-money9.\n*>------------\n*>\n     move     zero to ws-poundsd9 amt-ok9 ws-penced9.\n     display  ws-amount-screen-display9 at curs2 with foreground-color 3.\n     accept   ws-amount-screen-accept9 at curs2  with foreground-color 3 update.\n     move     ws-pound9 to amt-wk-pds9.\n     move     ws-pence9 to amt-wk-pence9.\n*>\n accept-account.\n*>-------------\n*>\n     move     zero to ws-maind acc-ok ws-subd.\n     display  ws-account-screen-display at curs2 with foreground-color 3.\n     accept   ws-account-screen-accept at curs2  with foreground-color 3 update.\n     move     ws-main  to acc-wk-main\n     move     ws-sub   to acc-wk-sub.\n*>\n gl020c-show              section.\n*>*******************************\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Default Accounts Display\" at 0126 with foreground-color 2.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 2.\n*>\n     perform  input-headings.\n     display  \"End of listing. Hit return for Menu.\" at 2301  with foreground-color 2.\n     accept   ws-reply  at 2379 with foreground-color 6.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n input-headings          section.\n*>******************************-\n*>\n     display  \"A/C Nos\" at 0504 with foreground-color 2.\n     display  \"Code Vat\" at 0533 with foreground-color 2.\n     display  \"A/C Nos\" at 0544 with foreground-color 2.\n     display  \"Code Vat\" at 0573 with foreground-color 2.\n     move     7  to  lin.\n     move     1  to  w  cole.\n*>\n input-loop.\n*>---------\n*>\n     display  w at curs.\n     add      2    curs giving curs2.\n     display  \"[       ]\" at curs2 with foreground-color 2.\n     add      30 to col2.\n     display  \"[  ] [ ]\" at curs2 with foreground-color 2.\n     add      1  to  w.\n     if       w  >  32\n              go to end-loop.\n     if       w  =  17\n              move 6  to  lin\n              move 41 to  cole.\n     add      1  to  lin.\n     go       to input-loop.\n*>\n end-loop.\n*>-------\n*>\n*> now input existing defaults\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n display-existing.\n*>---------------\n*>\n     add      3    curs giving curs2.\n     move     def-acs (w) to display-acs.\n     display  display-acs  at curs2 with foreground-color 3.\n     if       def-acs (w)  = zero\n              go to jump-1.\n*>\n*> get code description.\n*>\n     perform  get-description.\n     if       we-error = 255\n              go to jump-1.\n     add      12  curs giving curs2.\n     display  ledger-name at curs2 with foreground-color 3.\n     add      20 to col2.\n     display  \"[  ] \" at curs2 with foreground-color 2.\n*>\n jump-1.\n*>-----\n*>\n     add      33    curs giving curs2.\n     move     def-codes (w) to ws-codes.\n     display  ws-codes  at curs2 with foreground-color 3.\n     add      5 to col2.\n     move     def-vat (w) to ws-vat.\n     display  ws-vat  at curs2 with foreground-color 3.\n     add      1  to  w.\n     if       w  >  32\n              go to display-existing-end.\n     if       w  =  17\n              move 41  to  cole\n              move 6   to  lin.\n     add      1  to  lin.\n     go       to display-existing.\n*>\n get-description.\n*>--------------\n*>\n     multiply def-acs (w)  by  100  giving  WS-Ledger-Nos.\n     move     \"00\"         to  ledger-pc.\n     move     zero to we-error.\n*>\n     perform  GL-Nominal-Read-Indexed.       *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n display-existing-end.\n*>-------------------\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n main-exit.   exit section.\n*>--------    ----\n*>\n gl050a section.\n*>*************\n*>\n     perform  GL-Nominal-Open-Input.     *> open input  ledger-file.\n*>\n     if       not profit-centres\n       and    not branches\n              go to  init-done.\n*>\n     move     999999 to  WS-Ledger-Nos.\n     move     \"00\"   to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.        *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              display GL051 at 0101 with foreground-color 4 erase eos\n              display GL010 at 0211\n              accept ws-reply at 0234\n              perform main-end\n              go to program-exit.\n*>\n     move     WS-Ledger-Record  to  p-c-branches.\n*>\n init-done.\n*>--------\n*>\n     display  prog-name at 0101  with foreground-color 2 erase eos.\n     display  \"General Ledger - Posting Set-Up\"  at 0126  with foreground-color 2\n     display  ws-date at 0171 with foreground-color 2.\n*>\n     if       preserve-batch\n              perform  batch-outline  through  b-o-data.\n*>\n     perform  help-outline  through  h-o-data.\n*>\n     display  \"Select Default Number          :- [  ]\" at 0401  with foreground-color 2.\n     display  \"Select Posting Convention      :- [CR]\" at 0701  with foreground-color 2.\n*>\n     if       profit-centres\n              display \"Select Default Profit Centre   :- [  ]\" at 1001 with foreground-color 2.\n     if       branches\n              display \"Select Default Branch          :- [  ]\" at 1001 with foreground-color 2.\n*>\n     display  \"Enter Transaction Posting Date :- [        ]\"   at 1301 with foreground-color 2.\n*>\n def-in.\n*>*****\n*>\n     display  \" 0 - Return to System Menu   \" at 1851 with foreground-color 2.\n     display  \"33 - Set-up Temporary Default\" at 1951 with foreground-color 2.\n     display  \"99 - Display current Defaults\" at 2051 with foreground-color 2.\n     display  space at 2151 with erase eol.\n     display  space at 2251 with erase eol.\n     accept   a at 0436 with foreground-color 6.\n*>\n     if       a =  99               *> 99 = quit extry\n              perform gl020c-show\n              go to init-done.\n*>\n     if       a = zero\n              move  a  to bdefault\n              go to  main-end.\n*>\n     if       a > 33\n              go to  def-in.\n*>\n     move     zero  to  batch-def-pc.\n*>\n     if       a = 33\n              perform  def-set-up  through  dummy-return-1.\n*>\n     if       a < 33\n              perform  def-val.\n*>\n     if       falset\n              go to  def-in.\n*>\n     move     a  to  bdefault.\n     if       def-acs (a) = def-acs (31) or def-acs (32)\n              move 1 to vat-flag\n     else\n              move zero to vat-flag\n     end-if.\n*>\n post-in.\n*>******\n*>\n     display  \"Enter <DR> or <CR>           \" at 1851 with foreground-color 2.\n     display  \"DR - Debits the A/c posted to\" at 1951 with foreground-color 2.\n     display  \"   & Credits the default A/c \" at 2051 with foreground-color 2.\n     display  \"<Esc> - to back-up one field \" at 2151 with foreground-color 2.\n*>\n     move     \"CR\" to convention2.\n     accept   convention2 at 0736 with foreground-color 3 update.\n     move     function upper-case (convention2) to convention.\n     if       cob-crt-status = cob-scr-esc\n              go to  def-in.\n*>\n     if       convention  not = \"DR\" and not = \"CR\"\n              go to  post-in.\n*>\n default-pc.\n*>*********\n*>\n     display  space at 1851 with erase eol.\n     display  space at 1951 with erase eol.\n     display  space at 2051 with erase eol.\n     display  space at 2151 with erase eol.\n     if       not profit-centres\n       and    not branches\n              go to  def-date.\n*>\n *>    display  batch-def-pc at 1036 with foreground-color 3.\n     accept   batch-def-pc at 1036 with foreground-color 3 update.\n     if       cob-crt-status = cob-scr-esc\n              go to  post-in.\n*>\n     perform  validate-pc.\n     if       falset\n              go to  default-pc.\n*>\n def-date.\n*>*******\n*>\n     perform  store-defaults.\n*>\n     if       not auto-vat\n              go to  jump-1.\n     if       batch-def-vat =  \"I\"\n              display \"Input VAT\" at 0470 with foreground-color 2.\n     if       batch-def-vat =  \"O\"\n              display \"Output VAT\" at 0470 with foreground-color 2.\n     if       batch-def-vat =  \"N\"\n              display \"No VAT\" at 0470 with foreground-color 2.\n*>\n jump-1.\n*>-----\n*>\n     move     ws-date  to  tran-date.\n *>    display  tran-date at 1336 with foreground-color 3.\n     accept   tran-date at 1336 with foreground-color 3 update.\n     if       cob-crt-status = cob-scr-esc\n        and   not profit-centres\n        and   not branches\n              go to post-in.\n*>\n     if       cob-crt-status = cob-scr-esc\n              go to  default-pc.\n*>\n     perform  val-date.\n     if       falset\n              go to  def-date.\n*>\n batch-in.\n*>*******\n*>\n     move     1  to  WS-Ledger.\n     move     zero to batch-status cleared-status proofed posted\n                      stored actual-gross actual-vat.\n*>\n     move     scycle of system-record to  bcycle of WS-Batch-Record.\n*>\n     add      postings  1  giving   batch-start.\n     move     WS-Batch-Nos  to  display-batch.\n*>\n     display  ws-space-44 at 1703.\n     display  ws-space-44 at 1803.\n     display  ws-space-44 at 1903.\n     display  \"Assigned Batch :- {     }\"        at 1701 with foreground-color 2.\n     display  \"Enter Cycle    :- [  ]\"           at 1801 with foreground-color 2.\n     display  \"Number of Items:- [  ]\"           at 1901 with foreground-color 2.\n     display  \"Gross Amount   :- [            ]\" at 2001 with foreground-color 2.\n     display  \"Vat   Amount   :- [            ]\" at 2101 with foreground-color 2.\n     display  \"Batch Desc.    :- [\"              at 2201 with foreground-color 2.\n     display  \"]\"                                at 2245 with foreground-color 2.\n     display  display-batch                      at 1720 with foreground-color 3.\n*>\n cycle-in.\n*>*******\n*>\n *>    display  bcycle of WS-Batch-Record at 1820 with foreground-color 3.\n     accept   bcycle of WS-Batch-Record at 1820 with foreground-color 3 update.\n*>\n     if       cob-crt-status = cob-scr-esc\n              go to  def-date.\n*>\n     if       bcycle of WS-Batch-Record < scycle of system-record\n              display GL052 at 1824 with foreground-color 4\n              go to cycle-in.\n*>\n     subtract scycle of system-record from bcycle of WS-Batch-Record giving  y.\n*>\n     if       y  >  1\n              display GL053 at 1824 with foreground-color 4\n              go to cycle-in.\n     display  \"                    \" at 1824.\n*>\n items-in.\n*>*******\n*>\n     accept   items at 1920 with foreground-color 3 update.\n     if       cob-crt-status = cob-scr-esc\n              go to  cycle-in.\n*>\n     if       items = zero\n              display GL054 at 1924 with foreground-color 2.\n*>\n gross-in.\n*>*******\n*>\n     move     2020 to curs2.\n     perform  accept-money9.\n     if       cob-crt-status = cob-scr-esc\n              go to  items-in.\n     move     amt-ok9 to input-gross.\n*>\n vat-in.\n*>*****\n*>\n     if       not auto-vat\n              go to  desc-in.\n*>\n     move     2120 to curs2.\n     perform  accept-money9.\n     if       cob-crt-status = cob-scr-esc\n              go to  gross-in.\n     move     amt-ok9 to input-vat.\n*>\n desc-in.\n*>******\n*>\n     accept   description at 2220 with foreground-color 3 update.\n     if       cob-crt-status not = cob-scr-esc\n              go to  main-end.\n     if       auto-vat\n              go to  vat-in.\n     go       to  gross-in.\n*>\n*>*****************************************************************\n*>                     P R O C E D U R E S                        *\n*>*****************************************************************\n*>\n batch-outline.\n*>============\n*>\n     display  ws-space-44 at 1601.\n     display  ws-space-44 at 1701.\n     display  ws-space-44 at 1801.\n     display  ws-space-44 at 1901.\n     display  ws-space-44 at 2001.\n     display  ws-space-44 at 2101.\n     display  ws-space-44 at 2201.\n     display  ws-space-44 at 2301.\n     move     15  to  lin.\n     display  display-star-46 at 1501 with foreground-color 2.\n     display  display-star-46 at 2301 with foreground-color 2.\n*>\n b-o-loop2.\n*>\n     add      1  to  lin.\n     move     1 to cole.\n     display  \"*\" at curs with foreground-color 2.\n     move     46 to cole.\n     display  \"*\" at curs with foreground-color 2.\n     if       lin  <  22\n              go to  b-o-loop2.\n*>\n b-o-data.\n*>\n     display  \"Batch Data\" at 1618 with foreground-color 2.\n*>\n help-outline.\n*>===========\n*>\n     move     15  to  lin.\n     display  display-plus-31 at 1550 with foreground-color 2.\n     display  display-plus-31 at 2350 with foreground-color 2.\n*>\n h-o-loop2.\n*>\n     add      1  to  lin.\n     move     50 to cole.\n     display  \"+\" at curs with foreground-color 2.\n     move     80 to cole.\n     display  \"+\" at curs with foreground-color 2.\n     if       lin  <  22\n              go to  h-o-loop2.\n*>\n h-o-data.\n*>\n     display  \"Help Data\" at 1661 with foreground-color 2.\n*>\n*>  This is all remarked out as function depleted.\n*>  Nope coming back in to match IRS.\n*>\n def-set-up.\n*>=========\n*>\n    move     16  to  lin.\n    move     2 to cole.\n*>\n d-s-loop1.\n     display  ws-space-44 at curs.\n     add      1  to  lin.\n     if       lin  <  23\n              go to  d-s-loop1.\n*>\n     display  \"Default Set-Up\"   at 1716 with foreground-color 2.\n     display  \"A/C  - [       ]\" at 1903 with foreground-color 2.\n     display  \"VAT  - [ ]\"       at 2003 with foreground-color 2.\n     display  \"Code - [  ]\"      at 2103 with foreground-color 2.\n*>\n get-ac.\n     move     zero  to  truth.\n     move     1911 to curs2.\n     perform  accept-account.\n     move     acc-ok to def-acs (33).\n     if       acc-ok =  zero\n              go to  dummy-return-1.\n*>\n     move     33  to  a.\n     move     zero  to  batch-def-pc.\n     perform  get-description.\n     if       falset\n              go to  get-ac.\n*>\n     display  ledger-name at 1920 with foreground-color 3.\n*>\n get-vat.\n*>\n     display  \"<I> - Input  VAT             \" at 1851  with foreground-color 2.\n     display  \"<O> - Output VAT             \" at 1951  with foreground-color 2.\n     display  \"<N> - No     VAT             \" at 2051  with foreground-color 2.\n*>\n     move     def-vat (33) to ws-vat2.\n *>    display  ws-vat2 at 2011 with foreground-color 3.\n     accept   ws-vat2 at 2011 with foreground-color 3 update.\n     move     function upper-case (ws-vat2) to ws-vat.\n     if       cob-crt-status = cob-scr-esc\n              go to  get-ac.\n*>\n     if       ws-vat not = \"I\" and not = \"O\" and not = \"N\"\n              go to  get-vat.\n*>\n     move     ws-vat to def-vat (33).\n*>\n get-code.\n*>\n     display  space at 1851 with erase eol.\n     display  space at 1951 with erase eol.\n     display  space at 2051 with erase eol.\n*>\n     move     def-codes (33) to ws-codes2.\n *>    display  ws-codes2 at 2111 with foreground-color 3.\n     accept   ws-codes2 at 2111 with foreground-color 3 update.\n     if       cob-crt-status = cob-scr-esc\n              go to  get-vat.\n*>\n     move     function upper-case (ws-codes2) to def-codes (33).\n*>\n     if       preserve-batch\n              perform  batch-outline.\n*>\n     move     1  to  truth.\n*>\n dummy-return-1.\n    exit.\n*>\n validate-pc.\n*>==========\n*>\n     if       batch-def-pc = zero\n              move  1  to  truth\n     else\n      if      p-b-codes  (batch-def-pc) = \"Y\" OR \"E\"\n              move  1  to  truth\n       else\n              move  0  to  truth.\n*>\n     if       truet\n              perform  get-description.\n*>\n     if       truet\n              display ledger-name at 0441 with foreground-color 3\n       else\n              display \"Unrecognised Account/P.C.\" at 0441 with foreground-color 2.\n*>\n dummy-return-2.\n     exit.\n*>\n get-description.\n*>--------------\n*>\n     move     zero  to  we-error.\n     multiply def-acs (a)  by  100  giving  WS-Ledger-Nos.\n*>\n     if       falset\n              move zeros to  ledger-pc\n     else\n              move  batch-def-pc  to  ledger-pc\n     end-if\n     perform  GL-Nominal-Read-Indexed.           *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = 255\n              move  0  to  truth\n     else\n              move  1  to  truth.\n*>\n def-val.\n*>======\n*>\n     if       def-acs (a) = zero\n              move  0  to  truth\n     else\n              move  1  to  truth\n     end-if\n     perform  get-description.\n*>\n store-defaults.\n*>=============\n*>\n     multiply def-acs (a)   by  100  giving  batch-def-ac.\n     move     def-vat (a)   to  batch-def-vat.\n     move     def-codes (a) to  batch-def-code.\n*>\n val-date.\n*>=======\n*>\n     move     tran-date  to  ws-test-date.\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              move   0  to  truth\n     else\n              move   1  to  truth\n              move   u-bin  to  entered.\n*>\n dummy-return-x.\n     exit.\n*>\n program-exit.\n     exit program.\n*>\n main-end.\n*>*******\n*>\n     perform  GL-Nominal-Close.       *> close ledger-file.\n*>\n main-exit.   exit.\n*>********    ****\n*>\n gl050b section.\n*>*************\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"General Ledger - Posting Input\"  at 0126 with foreground-color 2.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n     perform  help-outline  through  h-o-data.\n*>\n     perform  GL-Nominal-Open-Input.         *> open input  ledger-file.\n*>\n     move     zero  to  w.\n     if       batch-def-vat = \"O\"\n              move  32  to  w.\n     if       batch-def-vat = \"I\"\n              move  31  to  w.\n*>\n define-vat-rate.\n*>**************\n*>\n     if       w = zero\n              go to  jump-tag.\n*>\n Reget-Vat-Rate.\n*>\n     move     1  to  v.\n*>\n     display  \"VAT Rate :- [ ]\" at 0401 with foreground-color 2.\n *>    display  v at 0414 with foreground-color 3.\n     accept   v at 0414 with foreground-color 3 update.\n*>\n     if       v  <  1  or  >  3\n              go to  Reget-Vat-Rate.\n*>\n     move     vat-rate (v)  to  display-vat ws-vat-rate.\n     display  display-vat at 0417 with foreground-color 3.\n     display  \"% OK (Y/N) :- [Y]\" at 0422 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     accept   ws-reply at 0437 with foreground-color 3 update.\n*>\n     if       ws-reply = \"N\"  OR  \"n\"\n              go to  Reget-Vat-Rate.\n*>\n jump-tag.\n*>\n     move     WS-Batch-Nos  to  display-batch.\n*>\n     display  \"Batch      - \" at 0456 with foreground-color 2.\n     display  display-batch   at 0469 with foreground-color 2.\n     display  \"/\"             at 0474 with foreground-color 2.\n     display  \"Default    - \" at 0656 with foreground-color 2.\n     display  bdefault        at 0669 with foreground-color 2.\n     display  \"Contra A/C - \" at 0856 with foreground-color 2.\n     display  batch-def-ac    at 0869 with foreground-color 2.\n*>\n     if       batch-def-pc  not numeric\n              move  zero  to  batch-def-pc.\n*>\n     if       batch-def-pc  not =  zero\n              display \"/\" at 0875 with foreground-color 2\n              display batch-def-pc at 0876 with foreground-color 3.\n*>\n     if       w  not =  zero\n              display \"VAT A/C    - \" at 1056 with foreground-color 2\n              move def-acs (w) to ws-acs\n              display ws-acs at 1069 with foreground-color 3\n     else\n              display \"No VAT on this Batch.\" AT 1056 with foreground-color 2.\n*>\n     display  \"Convention - \" at 1256 with foreground-color 2.\n     display  convention at 1269 with foreground-color 3.\n*>\n     display  \"Date           [          ]\"  at 0601 with foreground-color 2.\n     display  \"Account        [       ]\"     at 0801    with foreground-color 2.\n     if       profit-centres\n              display \"Profit Centre  [  ]\"  at 1001 with foreground-color 2.\n     if       branches\n              display \"Branch         [  ]\"  at 1001 with foreground-color 2.\n*>\n     display  \"Amount         [           ]\" at 1201 with foreground-color 2.\n*>\n     if       auto-vat\n         and  w  not =  zero\n              display \"VAT Code       [ ]  {p or m or space}\" at 1401 with foreground-color 2.\n*>\n     display  \"VAT Amount     [           ]\" at 1601  with foreground-color 2.\n     display  \"Narrative      [\" at 1801   with foreground-color 2.\n     display  \"]\" at 1849 with foreground-color 2.\n*>\n     move     entered  to  u-bin.\n     call     \"maps04\"  using  maps03-ws.\n     move     zero to save-a.\n     move     1  to  a.\n*>\n main-loop.\n*>========\n*>\n     display  a at 0475 with foreground-color 3.\n *>    display  ws-date at 0617 with foreground-color 3.\n     accept   ws-date at 0617 with foreground-color 3 update.\n     move     ws-date to array-date (a).\n*>\n*>  perform  test-escape.\n*>\n*> escape-code = \"B\"\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n         and  w not = zero\n              perform reget-vat-rate\n              go to main-loop.\n*> escape-code = \"B\"  or  \"F\"  *> back / forward\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n           or cob-scr-esc or COB-SCR-PAGE-DOWN or COB-SCR-KEY-DOWN\n              go to  main-loop.\n*>\n     if       z  >  0\n              go to  main-loop.\n*>\n*> escape-code = \"E\"  or  \"Q\" *> esc\n     if       cob-crt-status = cob-scr-esc\n              go to  main-exit.\n     move     zero  to  u-bin.\n     move     array-date (a)  to  ws-test-date.\n     perform  zz050-Validate-Date.\n     move     ws-test-date to  array-date (a).\n*>\n     if       u-bin = zero\n              display \"Invalid Date\" at 0636 with foreground-color 4\n              go to main-loop.\n     display  ws-space-29 at 0626.\n*>\n get-account.\n*>----------\n*>\n     move     0817 to curs2.\n     perform  accept-account.\n     move     acc-ok to account-in.\n*>\n*>     perform  test-escape.\n*>\n*> escape-code = \"B\"  or  \"F\"\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n                       or COB-SCR-PAGE-DOWN or COB-SCR-KEY-DOWN\n       or     z  not =  zero\n              go to  main-loop.\n*>\n*> escape-code = \"E\"  or  \"Q\"\n     if       cob-crt-status = cob-scr-esc\n              go to  main-exit.\n*>\n     move     zero  to  we-error.\n     multiply account-in  by  100  giving  WS-Ledger-Nos.\n     move     array-pc    to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = zero\n              display ledger-name at 0826 with foreground-color 3\n     else\n              display \"Invalid A/C number\" at 0826 with foreground-color 4\n              go to get-account.\n*>\n     if       vat-flag = 1\n       or     account-in = def-acs (31) or def-acs (32)\n              move 1 to vat-flag-2\n     else\n              move zero to vat-flag-2.\n*>\n accept-p-c.\n*>---------\n*>\n     move     zero  to  array-pc.\n*>\n     if       not profit-centres\n        and   not branches\n              go to accept-amount.\n*>\n     display  array-pc at 1017 with foreground-color 3.\n     accept   array-pc at 1017 with foreground-color 3 update.\n*>\n*>     perform  test-escape.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-DOWN\n                            or COB-SCR-KEY-DOWN\n*> escape-code = \"F\"\n       or     z  not =  zero\n              go to  main-loop.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n              go to  get-account.\n*>\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"E\"  or  \"Q\"\n              go to  main-exit.\n*>\n accept-amount.\n*>------------\n*>\n     move     1217 to curs2.\n     if       vat-flag-2 = zero\n              perform  accept-money8s\n              move amt-ok8s to array-amount (a)\n     else\n              move zero to array-amount (a).\n     move     array-amount (a) to display-amt.\n     display  display-amt at 1217 with foreground-color 3.\n*>     perform  test-escape.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-DOWN\n                            or COB-SCR-KEY-DOWN\n*> escape-code = \"F\"\n       or     z  not =  zero\n              go to  main-loop.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n       and    not profit-centres  and  not branches\n              go to  get-account.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n              go to  accept-p-c.\n*>\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"E\"  or  \"Q\"\n              go to  main-exit.\n*>\n accept-vat.\n*>---------\n*>\n     if       not auto-vat  or  w = zero\n              move  zero  to  array-vat-amount (a)\n              go to  vat-amount-input.\n*>\n     move     space  to  array-vat.\n     if       vat-flag-2 = 1\n              move zero to array-vat-amount (a)\n              go to vat-amount-input.\n*>\n     display  array-vat at 1417 with foreground-color 3.\n     accept   array-vat at 1417 with foreground-color 3 update.\n     move     function upper-case (array-vat) to array-vat.\n*>\n*>     perform  test-escape.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-DOWN\n                             or COB-SCR-KEY-DOWN\n*> escape-code = \"F\"\n       or     z  not =  zero\n              go to  main-loop.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n              go to  accept-amount.\n*>\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"E\"  or  \"Q\"\n              go to  main-exit.\n*>\n     if       array-vat = \"P\"\n              perform  net\n              go to vat-amount-input.\n*>\n     if       array-vat = \"M\"\n              perform  gross\n              go to vat-amount-input.\n*>\n     if       array-vat  = space\n              move zero to array-vat-amount (a)\n              go to accept-narative.\n*>\n     display  \"Invalid code\" at 1439 with foreground-color 4.\n     go       to accept-vat.\n*>\n vat-amount-input.\n*>***************\n*>\n*>   check if vat on transaction\n*>\n     if       w = zero\n              go to  accept-narative.\n*>\n     move     1617 to curs2.\n     move     array-vat-amount (a) to amt-ok8s.\n     perform  accept-money8s2.\n*>\n     if       amt-ok8s not = array-vat-amount (a)\n        and   array-amount (a) not = zero\n        and   array-vat = \"M\"\n              add array-vat-amount (a) to array-amount (a)\n              subtract amt-ok8s from array-amount (a).\n*>\n*>    if       amt-ok8s < zero\n*>             multiply -1 by amt-ok8s.\n*>\n     move     amt-ok8s to array-vat-amount (a).\n*>\n*>     perform  test-escape.\n*>\n     if       cob-crt-status = COB-SCR-KEY-DOWN\n                            or COB-SCR-PAGE-DOWN\n*> escape-code = \"F\"\n       or     z  not =  zero\n              go to  main-loop.\n*>\n     if       cob-crt-status = COB-SCR-KEY-UP or COB-SCR-PAGE-UP\n*> escape-code = \"B\"\n              go to  accept-vat.\n*>\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"E\"  or  \"Q\"\n              go to  main-exit.\n*>\n accept-narative.\n*>\n     if       array-amount (a) = zero\n         and  array-vat-amount (a) = zero\n              go to main-loop.\n*>\n     display  \"            \" at 1439.\n     move     spaces  to ws-legend.\n     accept   ws-legend at 1817 with foreground-color 3 update.\n     move     ws-legend to array-legend (a).\n*>\n*>     perform  test-escape.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-DOWN\n                            or COB-SCR-KEY-DOWN\n*> escape-code = \"F\"\n       or     z  not =  zero\n              go to  main-loop.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n       and    auto-vat\n              go to  accept-vat.\n*>\n     if       cob-crt-status = COB-SCR-PAGE-UP or COB-SCR-KEY-UP\n*> escape-code = \"B\"\n              go to  accept-amount.\n*>\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"E\"  or  \"Q\"\n              go to  main-exit.\n*>\n loop-end.\n*>*******\n*>\n*>   Check for negative amount,if so reverse convention\n*>\n*>    if       array-amount (a) < zero\n*>             multiply -1 by array-amount (a)\n*>             move 1 to rev-flag.\n*>\n*>    if       rev-flag = 1\n*>       and   convention = \"CR\"\n*>             move \"DR\" to ws-convention.\n*>    if       rev-flag = 1\n*>       and   convention = \"DR\"\n*>             move \"CR\" to ws-convention.\n*>\n     if       convention = \"DR\"\n              multiply  account-in  by  100\n                        giving  array-dr (a)\n              move  array-pc    to  array-dr-pc (a)\n              move  \"DR\"  to  array-vat-side (a)\n     else\n              multiply  account-in  by  100\n                        giving  array-cr (a)\n              move  array-pc    to  array-cr-pc (a)\n              move  \"CR\"  to  array-vat-side (a).\n*>\n     if       convention = \"DR\"\n              move  batch-def-ac  to  array-cr (a)\n              move  batch-def-pc  to  array-cr-pc (a)\n     else\n              move  batch-def-ac  to  array-dr (a)\n              move  batch-def-pc  to  array-dr-pc (a)\n*>\n     move     batch-def-code  to  array-code (a).\n*>\n     if       w  not =  zero\n              move  def-acs (w)  to  array-vat-ac (a)\n     else\n              move  zero  to  array-vat-ac (a).\n*>\n     move     batch-def-pc       to  array-vat-pc (a).\n*>\n     add      1  to  a.\n     if       a  >  12\n              perform  write-out.\n*>\n*>    move     zero to rev-flag.\n     go to    main-loop.\n*>\n help-outline.\n*>===========\n*>\n     move     14  to  lin.\n     move     54  to  cole.\n     display  display-plus-27 at 1454.\n     display  display-plus-27 at 2354.\n*>\n h-o-loop2.\n*>\n     add      1  to  lin.\n     move     54 to cole.\n     display  \"+\" at curs  with foreground-color 2.\n     move     80 to cole.\n     display  \"+\" at curs with foreground-color 2.\n     if       lin  <  22\n              go to  h-o-loop2.\n*>\n h-o-data.\n*>\n     display  \"Option :- [ ]\"         at 1656 with foreground-color 2.\n     display  \"B - Back-up one field\" at 1856 with foreground-color 2.\n     display  \"E - End\"               at 1956 with foreground-color 2.\n     display  \"F - Force Write\"       at 2056 with foreground-color 2.\n     display  \"Q - Quit Batch\"        at 2156 with foreground-color 2.\n     display  \"n - Back-up n records\" at 2256 with foreground-color 2.\n*>\n net.\n*>==\n*>\n     compute  array-vat-amount (a)  rounded =  array-amount (a)  *  ws-vat-rate / 100.\n     move     array-vat-amount (a) to display-amt.\n     display  display-amt at 1617 with foreground-color 3.\n*>\n gross.\n*>====\n*>\n     compute  array-vat-amount (a)  rounded =\n              array-amount (a) - (array-amount (a) / ((ws-vat-rate  + 100) / 100)).\n     subtract array-vat-amount (a)  from  array-amount (a).\n     move     array-vat-amount (a) to display-amt.\n     display  display-amt at 1617 with foreground-color 3.\n*>\n main-exit.\n*>********\n*>\n     perform  GL-Nominal-Close.          *> close ledger-file.\n     if       cob-crt-status = cob-scr-esc\n*> escape-code = \"Q\"\n              perform  quit-batch\n     else\n              add save-a  to  postings.\n*>\n end-routine. exit.\n*>**********  ****\n*>****************************************************\n*>               P R O C E D U R E S                 *\n*>****************************************************\n write-out                   section.\n*>==================================\n*>\n     if       a  <  1\n              go to  main-exit.\n*>\n     perform  open-posting.\n*>\n     if       escape-code  not =  \"F\"\n              subtract  1  from  a.\n*>\n     perform  write-loop varying y from 1 by 1 until y  >  a.\n*>\n     perform  close-posting.\n     add      a  to  save-a.\n     move     1  to  a.\n     go       to main-exit.\n*>\n write-loop.\n*>*********\n*>\n     move     WS-Batch-Nos  to  batch.\n     add      save-a  y  giving  post-number.\n     add      batch-start  post-number  giving  rrn.\n     move     batch-def-code        to  post-code in WS-Posting-record.\n     move     array-date (y)        to  post-date.\n     move     array-dr (y)          to  post-dr.\n     move     array-dr-pc (y)       to  dr-pc.\n     move     array-cr (y)          to  post-cr.\n     move     array-cr-pc (y)       to  cr-pc.\n     move     array-amount (y)      to  post-amount.\n     move     array-legend (y)      to  post-legend.\n     multiply array-vat-ac (y) by  100 giving  vat-ac of WS-Posting-record.\n     move     array-vat-pc (y)      to  vat-pc.\n     move     array-vat-side (y)    to  post-vat-side.\n     move     array-vat-amount (y)  to  vat-amount.\n*>\n     perform  GL-Posting-Write.                  *> write posting-record.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n back-up                 section.\n*>******************************\n*>\n     if       z  >  a\n              perform  write-out\n       else\n              move  z  to  a\n              go to  main-exit.\n*>\n     subtract 11  from  rrn.\n     subtract z   from  save-a  giving  a.\n*>\n sub-loop.\n*>\n     if       a  >  11\n              subtract  11  from  a\n              go to  sub-loop.\n     perform  open-posting.\n     perform  GL-Posting-Read-Next.       *> read posting-file.\n*>\n     perform  read-loop varying y from 1 by 1 until y > 11.\n     perform  close-posting.\n     go       to main-exit.\n*>\n read-loop.\n*>********\n*>\n     perform  GL-Posting-Read-Next.       *> read posting-file  next record.\n*>\n     move     post-date      to  array-date (y).\n     move     post-dr        to  array-dr (y).\n     move     dr-pc          to  array-dr-pc (y).\n     move     post-cr        to  array-cr (y).\n     move     cr-pc          to  array-cr-pc (y).\n     move     post-amount    to  array-amount (y).\n     move     post-legend    to  array-legend (y).\n     move     vat-ac of WS-Posting-record to  array-vat-ac (y).\n     move     vat-pc         to  array-vat-pc (y).\n     move     post-vat-side  to  array-vat-side (y).\n     move     vat-amount     to  array-vat-amount (y).\n*>\n     perform  GL-Posting-Delete.       *> delete posting-file  record.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n open-posting                section.\n*>----------------------------------\n*>\n     perform  GL-Posting-Open.      *> open i-o  posting-file.\n*>\n main-exit.   exit section.\n*>*********    ****\n*>\n close-posting               section.\n*>----------------------------------\n*>\n     perform  GL-Posting-Close.     *> close posting-file.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n quit-batch                  section.\n*>----------------------------------\n*>\n     perform  open-posting.\n     move     batch-start  to  rrn.\n     perform  GL-Posting-Read-Indexed.      *> read posting-file  record  invalid key\n     if       fs-reply = 21\n              go to  read-next.\n*>\n loop.\n*>***\n*>\n     if       batch = WS-Batch-Nos\n              perform GL-Posting-Delete.       *> delete  posting-file  record.\n*>\n read-next.\n*>********\n*>\n     perform  GL-Posting-Read-Next.          *> read posting-file  next record  at end\n     if       fs-reply = 10\n              go to  main-end.\n*>\n     go       to loop.\n*>\n main-end.\n*>*******\n*>\n     perform  close-posting.\n     move     9  to  z.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps03.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps03.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps03       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 10
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 4,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 153,
      "totalOperators": 143,
      "totalOperands": 286,
      "vocabulary": 154,
      "length": 429,
      "volume": 3117.4514259581124
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
