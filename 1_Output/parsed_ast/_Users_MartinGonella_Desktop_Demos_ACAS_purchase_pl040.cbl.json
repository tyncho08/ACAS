{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl040.cbl",
  "fileName": "pl040.cbl",
  "timestamp": "2025-09-15T16:25:46.474Z",
  "programId": "pl040",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 89
      },
      {
        "name": "file",
        "line": 102
      },
      {
        "name": "working-storage",
        "line": 108
      },
      {
        "name": "linkage",
        "line": 193
      },
      {
        "name": "init01",
        "line": 208
      },
      {
        "name": "delete-details",
        "line": 254
      },
      {
        "name": "program-start",
        "line": 268
      },
      {
        "name": "invoice-details",
        "line": 287
      },
      {
        "name": "zz060-Convert-Date",
        "line": 373
      },
      {
        "name": "exit",
        "line": 406
      },
      {
        "name": "zz070-Convert-Date",
        "line": 408
      },
      {
        "name": "exit",
        "line": 436
      },
      {
        "name": "maps04",
        "line": 438
      },
      {
        "name": "exit",
        "line": 444
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 92
      },
      {
        "name": "file-defs",
        "line": 205
      },
      {
        "name": "done-open",
        "line": 218
      },
      {
        "name": "data-input",
        "line": 229
      },
      {
        "name": "main-exit",
        "line": 241
      },
      {
        "name": "end-perform",
        "line": 263
      },
      {
        "name": "menu-return",
        "line": 275
      },
      {
        "name": "zz060-Exit",
        "line": 405
      },
      {
        "name": "zz070-Exit",
        "line": 435
      },
      {
        "name": "maps04-exit",
        "line": 443
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 441,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 78,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 88,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 95,
        "replacing": null
      },
      {
        "name": "selpinv",
        "line": 96,
        "replacing": null
      },
      {
        "name": "selpdnos",
        "line": 97,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 105,
        "replacing": null
      },
      {
        "name": "fdpinv",
        "line": 106,
        "replacing": null
      },
      {
        "name": "fdpdnos",
        "line": 107,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 111,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 112,
        "replacing": null
      },
      {
        "name": "plwspinv",
        "line": 113,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 117,
        "replacing": null
      },
      {
        "name": "wsfdpinv",
        "line": 118,
        "replacing": null
      },
      {
        "name": "wspdnos",
        "line": 119,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 182,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 196,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 197,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 198,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 446,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "program-start",
        "thru": null,
        "line": 213
      },
      {
        "target": "PInvoice-Open",
        "thru": null,
        "line": 214
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 215
      },
      {
        "target": "DelInvNos-Open",
        "thru": null,
        "line": 216
      },
      {
        "target": "invoice-details",
        "thru": null,
        "line": 220
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 245
      },
      {
        "target": "DelInvNos-Close",
        "thru": null,
        "line": 246
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 247
      },
      {
        "target": "ih-lines",
        "thru": null,
        "line": 258
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 262
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 281
      },
      {
        "target": "PInvoice-Read-Indexed",
        "thru": null,
        "line": 311
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 322
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 327
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 363
      },
      {
        "target": "delete-details",
        "thru": null,
        "line": 364
      },
      {
        "target": "DelInvNos-Write",
        "thru": null,
        "line": 369
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 382
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "spaces",
        "to": "escape-code",
        "line": 219
      },
      {
        "from": "16",
        "to": "lin",
        "line": 225
      },
      {
        "from": "1",
        "to": "cole",
        "line": 226
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 234
      },
      {
        "from": "zero",
        "to": "j",
        "line": 257
      },
      {
        "from": "ih-invoice",
        "to": "invoice-nos\n              move   j to item-nos\n              perform PInvoice-Delete    *>   delete invoice-file\n     end-perform",
        "line": 260
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 273
      },
      {
        "from": "\"Q\"",
        "to": "escape-code\n              go to  main-exit",
        "line": 305
      },
      {
        "from": "ih-invoice",
        "to": "invoice-nos",
        "line": 308
      },
      {
        "from": "zero",
        "to": "item-nos",
        "line": 309
      },
      {
        "from": "WS-Pinvoice-record",
        "to": "PInvoice-Header",
        "line": 316
      },
      {
        "from": "ih-date",
        "to": "u-bin",
        "line": 321
      },
      {
        "from": "1",
        "to": "c-check",
        "line": 325
      },
      {
        "from": "ih-supplier",
        "to": "WS-purch-key",
        "line": 326
      },
      {
        "from": "zero",
        "to": "c-check",
        "line": 329
      },
      {
        "from": "1",
        "to": "a",
        "line": 333
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 337
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 341
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 345
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 349
      },
      {
        "from": "\"N\"",
        "to": "ws-reply",
        "line": 357
      },
      {
        "from": "ih-invoice",
        "to": "WS-del-inv-nos",
        "line": 366
      },
      {
        "from": "ih-date",
        "to": "del-inv-dat",
        "line": 367
      },
      {
        "from": "ih-supplier",
        "to": "del-inv-cus",
        "line": 368
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 384
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 386
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 389
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 393
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 400
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 416
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 419
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 423
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 430
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "needed.\n*>                    Now uses Proc-ACAS-FH-Calls.cob for all FH & DAL calls\n*>                    Added in support for remaining FH & DALs.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n*>\n environment       division.\n*>=========================\n*>\n copy \"envdiv.cob\".\n input-output      section.\n*>------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selpl.cob\".\n*> copy \"selpinv.cob\".\n*> copy \"selpdnos.cob\".\n*>\n data              division.\n*>=========================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpl.cob\".\n*> copy \"fdpinv.cob\".\n*> copy \"fdpdnos.cob\".\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(15) value \"PL040 (3.02.02)\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"plwspinv.cob\".   *> invoice table\n*>\n*>  EX FDs\n*>\n copy \"wspl.cob\".\n copy \"wsfdpinv.cob\". *> replacing Invoice-Record by WS-PInvoice-Record.\n copy \"wspdnos.cob\".   *> replacing delinvnos-record by ws-del-inv-nos-record\n                       *>           del-inv-nos by ws-del-inv-nos\n*>\n*> REMARK OUT, ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n*>     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n*>     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  a               pic 99.\n     03  c-check         pic 9.\n         88  c-exists                    value 1.\n     03  address-line    pic x(36).\n     03  i               pic 99.\n     03  j               pic 99.\n     03  k               pic 99.\n     03  escape-code     pic x.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide\n*>     03  PL003          pic x(28) value \"PL003 Hit Return To Continue\".\n*> Module specific\n     03  PL187          pic x(24) value \"PL187 Folio Not Found !!\".\n     03  PL188          pic x(52) value \"PL188 PO Details Already Passed To Purchase Ledger !\".\n*>\n 01  error-code          pic 999.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n     perform  program-start.\n     perform  PInvoice-Open.  *>  open     i-o  invoice-file.\n     perform  Purch-Open.     *> open     input purchase-file.\n     perform  DelInvNos-Open. *>     open     extend  del-inv-nos-file.\n*>\n done-open.\n     move     spaces to escape-code.\n     perform  invoice-details.\n*>\n     if       escape-code = \"Q\"\n              go to  main-exit.\n*>\n     move     16  to  lin.\n     move     1 to cole.\n     display  \" \" at curs with erase eos.\n*>\n data-input.\n*>**********\n*>\n     display  \"Delete further invoices? (Y/N)  [Y]\"  at 1629 with foreground-color 2.\n*>\n     move     \"Y\"  to   ws-reply.\n     accept   ws-reply at 1662 with foreground-color 6.\n     move     function upper-case (ws-reply) to ws-reply.\n     display  \" \" at 1601 with erase eos.\n     if       ws-reply = \"Y\"\n              go to done-open.\n*>\n main-exit.\n*>********\n*>\n *>    close    purchase-file del-inv-nos-file invoice-file.\n     perform  Purch-Close.\n     perform  DelInvNos-Close.\n     perform  PInvoice-Close.\n     exit     program.\n*>\n*>************************************************\n*>                 Procedures                    *\n*>************************************************\n*>\n delete-details section.\n*>=====================\n*>\n     move     zero  to  j.\n     perform  ih-lines times\n              add    1 to j\n              move   ih-invoice to invoice-nos\n              move   j to item-nos\n              perform PInvoice-Delete    *>   delete invoice-file\n     end-perform.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n program-start  section.\n*>=====================\n*>\n*> Removed test for file-26 exist as created by open i/o.\n*>\n     move     to-day to u-date.\n*>\n menu-return.\n*>**********\n*>\n     display  \" \" at 0101 with erase eos.\n     display  prog-name at 0101 with foreground-color 2.\n     display  \"Order Data Deletion\" at 0133 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n invoice-details section.\n*>======================\n*>\n     display  \"****************************************\" at 0441 with erase eol foreground-color 2.\n     display  \"*Date [  /  /    ]*A/C Nos    [       ]*\" at 0541 with erase eol foreground-color 2.\n     display  \"**                *Order   [          ]*\" at 0641 with erase eol foreground-color 2.\n     display  \"*Folio  [        ]*Invoice [          ]*\" at 0741 with erase eol foreground-color 2.\n     display  \"****************************************\" at 0841 with erase eol foreground-color 2.\n*>\n     display  \"Type [ ]  <1> = Receipt; <2> = Account; <3> = Credit Note\"\n                                                         at 1001 with foreground-color 2.\n*>\n invoice-enter.     *> Invoice is the folio-no in PL\n*>************\n*>\n     accept   ih-invoice at 0750 with foreground-color 3.  *> Folio no\n     display  \" \" at 1640 with erase eol.\n     if       ih-invoice = zero\n              move  \"Q\"  to  escape-code\n              go to  main-exit.\n*>\n     move     ih-invoice  to  invoice-nos.\n     move     zero  to  item-nos.\n*>\n     perform  PInvoice-Read-Indexed.  *>  read     invoice-file  invalid key\n     if       FS-Reply not = zero\n              display PL187 at 1640  with foreground-color 4\n              go to  invoice-enter.\n*>\n     move     WS-Pinvoice-record  to  PInvoice-Header.\n*>\n     if       ih-status = \"z\"\n              display PL188 at 1601 with foreground-color 4\n              go to  invoice-enter.\n     move     ih-date to u-bin.\n     perform  zz060-Convert-Date.                          *> in ws-date\n     display  ih-supplier at 0572 with foreground-color 3.\n*>\n     move     1  to  c-check.\n     move     ih-supplier  to  WS-purch-key.\n     perform  Purch-Read-Indexed.  *> read     purchase-file record invalid key\n     if       FS-Reply not = zero\n              move zero to c-check.\n*>\n     display  purch-name at 0401 with foreground-color 3.\n*>\n     move     1  to  a.\n     unstring purch-address  delimited by  pl-delim  into  address-line  count a  pointer  a.\n     display  address-line at 0501 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited by  pl-delim  into  address-line  count a  pointer  a.\n     display  address-line at 0601 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited by  pl-delim  into  address-line  count a  pointer  a.\n     display  address-line at 0701 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address   into  address-line  pointer  a.\n     display  address-line at 0801 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n*>\n     display  ws-date at 0548 with foreground-color 3.\n     display  ih-order at 0669 with foreground-color 3.\n     display  ih-ref at 0769 with foreground-color 3.\n     display  ih-type at 1007 with foreground-color 3.\n*>\n     display  \"Invoice to be deleted (Y/N) - [ ]\" at 1601  with foreground-color 2.\n     move     \"N\" to ws-reply.\n     accept   ws-reply at 1632 with foreground-color 6 update UPPER.\n *>    move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply not = \"Y\"\n              go to  main-exit.\n*>\n     perform  PInvoice-Delete.  *> delete   invoice-file.\n     perform  delete-details.\n*>\n     move     ih-invoice  to  WS-del-inv-nos.\n     move     ih-date     to  del-inv-dat.\n     move     ih-supplier to  del-inv-cus.\n     perform  DelInvNos-Write.  *> write    del-inv-nos-record.\n*>\n main-exit.   exit section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 45
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 38,
      "totalOperators": 33,
      "totalOperands": 66,
      "vocabulary": 39,
      "length": 99,
      "volume": 523.2548196673627
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
