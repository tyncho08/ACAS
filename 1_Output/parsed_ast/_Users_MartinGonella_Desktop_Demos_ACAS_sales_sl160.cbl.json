{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl160.cbl",
  "fileName": "sl160.cbl",
  "timestamp": "2025-09-15T16:25:31.635Z",
  "programId": "sl160",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 99
      },
      {
        "name": "file",
        "line": 116
      },
      {
        "name": "working-storage",
        "line": 128
      },
      {
        "name": "linkage",
        "line": 296
      },
      {
        "name": "screen",
        "line": 305
      },
      {
        "name": "init01",
        "line": 363
      },
      {
        "name": "Report1",
        "line": 383
      },
      {
        "name": "Report-Selection",
        "line": 408
      },
      {
        "name": "Report-Produce",
        "line": 481
      },
      {
        "name": "Report-Heading-Setup",
        "line": 738
      },
      {
        "name": "zz050-Validate-Date",
        "line": 841
      },
      {
        "name": "exit",
        "line": 874
      },
      {
        "name": "zz070-Convert-Date",
        "line": 876
      },
      {
        "name": "exit",
        "line": 904
      },
      {
        "name": "maps04",
        "line": 906
      },
      {
        "name": "exit",
        "line": 912
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 102
      },
      {
        "name": "file-defs",
        "line": 360
      },
      {
        "name": "menu-exit",
        "line": 376
      },
      {
        "name": "end-if",
        "line": 400
      },
      {
        "name": "Accept-Data",
        "line": 418
      },
      {
        "name": "Read-Loop",
        "line": 490
      },
      {
        "name": "Read-Loop-Tests",
        "line": 515
      },
      {
        "name": "Select-Criteria-Tests-Continued",
        "line": 534
      },
      {
        "name": "Test-Num",
        "line": 587
      },
      {
        "name": "Headings",
        "line": 608
      },
      {
        "name": "Listing",
        "line": 628
      },
      {
        "name": "Delivery-Print",
        "line": 689
      },
      {
        "name": "deliv-address",
        "line": 698
      },
      {
        "name": "l6-letter",
        "line": 710
      },
      {
        "name": "l6-discount",
        "line": 713
      },
      {
        "name": "Notes-Print",
        "line": 719
      },
      {
        "name": "deliv-address",
        "line": 725
      },
      {
        "name": "End-Report",
        "line": 732
      },
      {
        "name": "zz050-Test-date",
        "line": 868
      },
      {
        "name": "zz050-exit",
        "line": 873
      },
      {
        "name": "zz070-Exit",
        "line": 903
      },
      {
        "name": "maps04-exit",
        "line": 911
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "SYSTEM",
        "line": 396,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 909,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 89,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 98,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 105,
        "replacing": null
      },
      {
        "name": "seldel",
        "line": 106,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 107,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 119,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 120,
        "replacing": null
      },
      {
        "name": "fddel",
        "line": 121,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 131,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 132,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 133,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 134,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 135,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 136,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 162,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 222,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 299,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 300,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 301,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 914,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 365
      },
      {
        "target": "Report1",
        "thru": null,
        "line": 374
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 386
      },
      {
        "target": "Delivery-Open-Input",
        "thru": null,
        "line": 387
      },
      {
        "target": "Report-Selection",
        "thru": null,
        "line": 389
      },
      {
        "target": "Report-Heading-setup",
        "thru": null,
        "line": 390
      },
      {
        "target": "Report-Produce",
        "thru": null,
        "line": 391
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 394
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 395
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 471
      },
      {
        "target": "Headings",
        "thru": null,
        "line": 488
      },
      {
        "target": "Sales-Read-Next-Sorted-By-Name",
        "thru": null,
        "line": 503
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 527
      },
      {
        "target": "Test-Num",
        "thru": null,
        "line": 547
      },
      {
        "target": "Test-Num",
        "thru": null,
        "line": 555
      },
      {
        "target": "Test-Num",
        "thru": null,
        "line": 563
      },
      {
        "target": "Test-Num",
        "thru": null,
        "line": 572
      },
      {
        "target": "Test-Num",
        "thru": null,
        "line": 580
      },
      {
        "target": "Listing",
        "thru": null,
        "line": 584
      },
      {
        "target": "Headings",
        "thru": null,
        "line": 632
      },
      {
        "target": "Headings",
        "thru": null,
        "line": 673
      },
      {
        "target": "Delivery-Print",
        "thru": null,
        "line": 679
      },
      {
        "target": "Notes-Print",
        "thru": null,
        "line": 681
      },
      {
        "target": "Headings",
        "thru": null,
        "line": 687
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 695
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 722
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 871
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "prog-name",
        "to": "l1-name",
        "line": 364
      },
      {
        "from": "ws-date",
        "to": "l1-date",
        "line": 366
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 367
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 371
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 372
      },
      {
        "from": "spaces",
        "to": "Cust-In Status-In Credit-Op Invoice-Op\n                        Average-Op Overdue-Op Enter-Date-Op\n                        Enter-Date-In print-out",
        "line": 411
      },
      {
        "from": "zero",
        "to": "Credit-In Invoice-In Average-In Overdue-In",
        "line": 415
      },
      {
        "from": "Cust-In",
        "to": "Customer-In",
        "line": 423
      },
      {
        "from": "Enter-Date-In",
        "to": "ws-Test-date",
        "line": 470
      },
      {
        "from": "u-bin",
        "to": "ws-enter-date",
        "line": 477
      },
      {
        "from": "zero",
        "to": "a",
        "line": 487
      },
      {
        "from": "sales-sort-key",
        "to": "WS-Sales-Key",
        "line": 513
      },
      {
        "from": "Credit-In",
        "to": "Test-1\n              move  sales-credit  to  Test-2\n              move  Credit-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop",
        "line": 544
      },
      {
        "from": "Invoice-In",
        "to": "Test-1\n              move  sales-activety to  Test-2\n              move  Invoice-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop",
        "line": 552
      },
      {
        "from": "Average-In",
        "to": "Test-1\n              move  sales-average to  Test-2\n              move  Average-Op    to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop",
        "line": 560
      },
      {
        "from": "Overdue-In",
        "to": "Test-1\n              subtract  sales-last-inv  from  run-date giving  Test-2\n              move  Overdue-Op    to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop",
        "line": 569
      },
      {
        "from": "ws-enter-date",
        "to": "Test-1\n              move  sales-create-date to  Test-2\n              move  Enter-Date-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop",
        "line": 577
      },
      {
        "from": "1",
        "to": "Truth\n       else\n              move  0  to  Truth",
        "line": 592
      },
      {
        "from": "1",
        "to": "Truth",
        "line": 598
      },
      {
        "from": "1",
        "to": "Truth",
        "line": 602
      },
      {
        "from": "1",
        "to": "Truth",
        "line": 606
      },
      {
        "from": "a",
        "to": "l3-page",
        "line": 612
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 2",
        "line": 616
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 624
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 626
      },
      {
        "from": "WS-Sales-Key",
        "to": "l6-key",
        "line": 633
      },
      {
        "from": "\"Active\"",
        "to": "l6-status\n     else\n              move  \"Dormant\" to  l6-status",
        "line": 636
      },
      {
        "from": "sales-name",
        "to": "l6-name",
        "line": 640
      },
      {
        "from": "sales-address",
        "to": "l7-address",
        "line": 641
      },
      {
        "from": "sales-phone",
        "to": "l6-phone\n       else\n              move 1 to y\n              string sales-phone delimited by \"  \"\n                                 into l6-phone with pointer y\n              add 1 to y\n              if  Sales-Ext not = spaces\n                  string \"x\"       delimited by size\n                         sales-ext delimited by size\n                                 into l6-phone with pointer y",
        "line": 644
      },
      {
        "from": "sales-fax",
        "to": "l6-fax",
        "line": 655
      },
      {
        "from": "Sales-Partial-Ship-Flag",
        "to": "L6-BO",
        "line": 656
      },
      {
        "from": "\"Y\"",
        "to": "l6-charges\n       else\n              move  spaces  to  l6-charges",
        "line": 659
      },
      {
        "from": "\"Y\"",
        "to": "l6-letter\n       else\n              move  spaces  to  l6-letter",
        "line": 664
      },
      {
        "from": "sales-limit",
        "to": "l6-limit",
        "line": 668
      },
      {
        "from": "sales-credit",
        "to": "l6-credit",
        "line": 669
      },
      {
        "from": "sales-discount",
        "to": "l6-discount",
        "line": 670
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 683
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 692
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type",
        "line": 693
      },
      {
        "from": "deliv-name",
        "to": "l6-name",
        "line": 703
      },
      {
        "from": "deliv-address",
        "to": "l7-address",
        "line": 704
      },
      {
        "from": "spaces",
        "to": "l6-phone\n                          l6-charges\n                          L6-BO\n                          l6-letter",
        "line": 707
      },
      {
        "from": "zero",
        "to": "l6-limit\n                          l6-credit\n                          l6-discount",
        "line": 711
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 720
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 721
      },
      {
        "from": "1",
        "to": "y",
        "line": 741
      },
      {
        "from": "spaces",
        "to": "l3-report",
        "line": 742
      },
      {
        "from": "Credit-In",
        "to": "cr-days\n              string  credit-heading  delimited by size\n                               into  l3-report  with  pointer  y",
        "line": 772
      },
      {
        "from": "Invoice-In",
        "to": "act-days\n              string  active-heading  delimited by size\n                               into  l3-report  with  pointer  y",
        "line": 786
      },
      {
        "from": "Average-In",
        "to": "av-days\n              string  average-heading  delimited by size\n                               into  l3-report  with  pointer  y",
        "line": 800
      },
      {
        "from": "Overdue-In",
        "to": "ov-days\n              string  overdue-heading delimited by size\n                               into  l3-report  with  pointer  y",
        "line": 814
      },
      {
        "from": "Enter-Date-In",
        "to": "ed-date\n              string  enter-date-heading  delimited by size\n                               into  l3-report  with  pointer  y",
        "line": 828
      },
      {
        "from": "ws-Test-date",
        "to": "ws-date",
        "line": 850
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 852
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-Test-date",
        "line": 856
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 863
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 869
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 870
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 884
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 887
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 891
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 898
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "using Cobol files else\n*>                        it is a ordered set from rdb.\n*>**\n*>    Version.            see prog-name in ws.\n*>**\n*>    Called modules.     maps04\n*>                        acas012  ->\n*>                         salesMT\n*>                        acas014  ->\n*>                         deliveryMT\n*>**\n*>    Error messages used.\n*>      System Wide\n*>                        SL005\n*>      Module specific\n*>                        SL170\n*>**\n*>    Changes.\n*> 28/02/85 vbc - Support for enter date in report selection.\n*> 03/03/09 vbc - .12 Migration to Open Cobol v3.00.0.\n*> 29/05/09 vbc - .13 Support for Page-Lines instead of fixed number.\n*> 07/09/10 vbc - .14 Mod lpr.\n*> 25/11/11 vbc - .15 Error msgs to SLnnn.Support for dates other than UK\n*> 08/12/11 vbc - .16 Support for path+filenames. clear sort file.\n*> 09/12/11 vbc -     Updated version to 3.01.nn & adjust code for IS delivery file\n*>                    Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 24/10/16 vbc - .17 ALL programs now using wsnames.cob in copybooks\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*> 16/01/17 vbc - .18 Sort requirements removed (sl165) when processing\n*>                    RDB tables as the sort step removed in place of\n*>                    read Table by Order.\n*>                    This code needs to be copied to pl160 & purchase changed.\n*>                    Note: When using RDB tables there is no sorting,\n*>                    Data is from selecting by order.\n*>\n*> 25/01/17 vbc       Dry testing completed.\n*> 15/03/24 vbc   .19 Added support for Sales-Partial-Ship-Flag.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 18/04/24 vbc   .20 Left off the BO head.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n*> copy \"seldel.cob\".\n copy \"selprint.cob\".\n*>\n     select  sales-sort      assign        fn-sales,\n                             access        sequential,\n                             status        fs-reply.\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n copy \"fdprint.cob\".\n*> copy \"fdsl.cob\".\n*> copy \"fddel.cob\".\n*>\n fd  sales-sort.\n*>\n 01  sales-sort-record.\n     03  sales-sort-key       pic x(7).\n*>\n working-storage section.\n*>----------------------\n 77  prog-name          pic x(15) value \"SL160 (3.02.20)\".\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps09.cob\".\n copy \"wssl.cob\".\n copy \"wsdel.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  fn-sales            pic x(12)      value \"custsort.tmp\".\n*>\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  Print-Type      pic x.\n         88  PLabels                    value \"L\".\n         88  PReport                    value \"R\".\n     03  a               pic 99.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  save-tag        pic 9(5).\n     03  print-out       pic x.\n     03  Truth           pic 9.\n       88  A-True   value  1.\n       88  A-False  value  0.\n     03  Test-1          binary-long.   *> was  pic 9(5).\n     03  Test-2          binary-long.   *> was  pic 9(5).\n     03  Test-Op         pic x.\n     03  credit-heading.\n       05  cr-operand    pic xx.\n       05  cr-days       pic z9.\n       05  filler        pic x(12)       value  \" Days Credit\".\n     03  active-heading.\n       05  act-operand   pic xx.\n       05  act-days      pic zzzz9.\n       05  filler        pic x(9)        value  \" Invoices\".\n     03  average-heading.\n       05  av-operand    pic xx.\n       05  av-days       pic zzzz9.\n       05  filler        pic x(10)       value  \" Av. Value\".\n     03  overdue-heading.\n       05  ov-operand    pic xx.\n       05  ov-days       pic zzzz9.\n       05  filler        pic x(13)       value \" days overdue\".\n     03  enter-date-heading.\n       05  ed-operand    pic xx.\n       05  ed-date       pic x(8).\n       05  filler        pic x(11)    value \" Entry Date\".\n     03  ws-enter-date     binary-long  value zero.\n     03  address-line    pic x(32).\n     03  Test-address    pic x(92).\n     03  line-cnt        pic 99   comp value zero.\n     03  Customer-In     pic x(7).\n*>\n     03  Cust-In         pic x(6)         value spaces.\n     03  Status-In       pic x            value space.\n     03  Credit-In       pic 99           value zero.\n     03  Credit-Op       pic x            value space.\n     03  Invoice-In      pic 9(5)         value zero.\n     03  Invoice-Op      pic x            value space.\n     03  Average-In      pic 9(5)         value zero.\n     03  Average-Op      pic x            value space.\n     03  Overdue-In      pic 9(5)         value zero.\n     03  Overdue-Op      pic x            value space.\n     03  Enter-Date-In   pic x(10)        value spaces.\n     03  Enter-Date-Op   pic x            value space.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SL005          pic x(18) value \"SL005 Invalid Date\".\n*> Module specific\n     03  SL170          pic x(18) value \"SL170 Not Found - \".\n*>\n 01  error-code          pic 999.\n*>\n 01  line-1.\n     03  l1-name         pic x(51).\n     03  filler          pic x(73)       value  \"Customer Alphabetical Listing\".\n     03  filler          pic x(5)        value  \"Page \".\n     03  l3-page         pic zz9.\n*>\n 01  line-3.\n     03  l3-user         pic x(40).\n     03  filler          pic x(12)       value  \"Report On : \".\n     03  l3-report       pic x(70)       value  spaces.\n     03  l1-date         pic x(10).\n*>\n 01  line-4.\n     03  filler          pic x(127)      value\n         \"Customer  Status    <---------------Name & Address-------------->     ----Telephone---- -----Fax----- BO  Late       Credit\".\n     03  filler          pic x(5)        value \"Disc \".\n*>\n 01  line-5.\n     03  filler          pic x           value space.\n     03  filler          pic x(103)      value \"Number   ------\".\n     03  filler          pic x(28)       value \"Chg  Let   Limit/Days    %\".\n*>\n 01  line-6.\n     03  l6-key          pic x(10).\n     03  l6-status       pic x(10).\n     03  l6-name         pic x(50).\n     03  l6-phone        pic x(18).\n     03  l6-fax          pic x(13).\n     03  filler          pic xx          value spaces.\n     03  L6-BO           pic xb.\n     03  l6-charges      pic xb(4).\n     03  l6-letter       pic xbb.\n     03  l6-limit        pic z(6)9       blank when zero.\n     03  l6-credit       pic zzz9bbb     blank when zero.\n     03  l6-discount     pic z9.99       blank when zero.\n*>\n 01  line-7.\n     03  filler          pic x(20)       value spaces.\n     03  l7-address      pic x(112).\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n screen section.\n*>*************\n*>\n 01  display-03                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  from prog-name  pic x(15)                 line  1 col  1\n                                                    blank screen.\n     03  value \"Customer File\"                             col 34.\n     03  from ws-date     pic x(10)                line  1 col 71.\n     03  value \"Report Attributes\"                 line  3 col 32.\n     03  value \"Customer Number - [\"               line  8 col  9.\n     03  using Cust-In   pic x(6)                          col 28.\n     03  value \"]\"                                         col 34.\n     03  value \"Enter characters in positions to match\"    col 39.\n     03  value \"Status          - [\"               line 10 col  9.\n     03  using Status-In pic x                             col 28.\n     03  value \"]\"                                         col 29.\n     03  value \"<L> Live;<D> Dormant;< > All\"              col 39.\n     03  value \"Credit Period   - [\"               line 12 col  9.\n     03  using Credit-In pic 99                            col 28.\n     03  value \"]  [\"                                      col 30.\n     03  using Credit-Op pic x                             col 34.\n     03  value \"]\"                                 line 12 col 35.\n     03  value \"Enter number of days & operator\"           col 39.\n     03  value \"<L>  for credit periods < than\"    line 13 col 43.\n     03  value \"<G>  for credit periods > than\"    line 14 col 43.\n     03  value \"<E>  for credit periods = to\"      line 15 col 43.\n     03  value \"Invoice Activity  [\"               line 17 col  9.\n     03  using Invoice-In pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using Invoice-Op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter number of invoices & operator\"       col 39.\n     03  value \"Average Value   - [\"               line 19 col  9.\n     03  using Average-In pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using Average-Op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter invoice value & operator\"            col 39.\n     03  value \"Overdue A/Cs    - [\"               line 21 col  9.\n     03  using Overdue-In pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using Overdue-Op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter number of days & operator\"           col 39.\n     03  value \"Date Entered-[\"                    line 23 col  9.\n     03  using Enter-Date-In pic x(10)                     col 23.\n     03  value \"] [\"                                       col 33.\n     03  using Enter-Date-Op pic x                         col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter date & operator\"                     col 39.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     move     prog-name to l1-name.\n     perform  zz070-Convert-Date.\n     move     ws-date to  l1-date.\n     move     usera   to  l3-user.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     1 to File-Key-No.\n*>\n     perform  Report1.\n*>\n menu-exit.\n     exit     program.\n*>\n*>************************************\n*>            Procedures             *\n*>************************************\n*>\n Report1      section.\n*>===================\n*>\n     perform  Sales-Open-Input.\n     perform  Delivery-Open-Input.    *> open input  sales-file delivery-file.\n*>\n     perform  Report-Selection.\n     perform  Report-Heading-setup.\n     perform  Report-Produce.\n*>\n     close    print-file.             *>   sales-sort.  (Closed on read at end)\n     perform  Sales-Close.\n     perform  Delivery-Close.         *> close    sales-file delivery-file.\n     call     \"SYSTEM\" using Print-Report.\n     if       FS-Cobol-Files-Used             *> Make it a null file\n              open     output sales-sort      *>  but only if processing\n              close    sales-sort             *>   Cobol files.\n     end-if.\n*>\n main-exit.   exit.\n*>\n*>****************************************************************\n*>       S e r v i c e    R o u t i n e s                        *\n*>****************************************************************\n*>\n Report-Selection            section.\n*>==================================\n*>\n     move     spaces to Cust-In Status-In Credit-Op Invoice-Op\n                        Average-Op Overdue-Op Enter-Date-Op\n                        Enter-Date-In print-out.\n*>\n     move     zero to Credit-In Invoice-In Average-In Overdue-In.\n     display  display-03.\n*>\n Accept-Data.\n*>**********\n*>\n     accept   display-03.\n     move     function upper-case (Cust-In) to Cust-In.\n     move     Cust-In to Customer-In.\n     if       Customer-In not = spaces\n              inspect Customer-In replacing all spaces by \"Z\".\n*>\n     move     function upper-case (Status-In) to Status-In.\n     if       Status-In not = \"L\"\n                    and not = \"D\"\n                    and not = space\n              go to  Accept-Data.\n*>\n     move     function upper-case (Credit-Op) to Credit-Op.\n     if       Credit-Op not = \"L\"\n                    and not = \"G\"\n                    and not = \"E\"\n                    and not = space\n              go to  Accept-Data.\n*>\n     move     function upper-case (Invoice-Op) to Invoice-Op.\n     if       Invoice-Op not = \"L\"\n                     and not = \"G\"\n                     and not = \"E\"\n                     and not = space\n              go to  Accept-Data.\n*>\n     move     function upper-case (Average-Op) to Average-Op.\n     if       Average-Op not = \"L\"\n                     and not = \"G\"\n                     and not = \"E\"\n                     and not = space\n              go to  Accept-Data.\n*>\n     move     function upper-case (Overdue-Op) to Overdue-Op.\n     if       Overdue-Op not = \"L\"\n                     and not = \"G\"\n                     and not = \"E\"\n                     and not = space\n              go to  Accept-Data.\n*>\n     move     function upper-case (Enter-Date-Op) to Enter-Date-Op.\n     if       Enter-Date-Op not = \"L\"\n                        and not = \"G\"\n                        and not = \"E\"\n                        and not = space\n              go to  Accept-Data.\n*>\n     if       Enter-Date-In = spaces\n              go to main-end.\n     move     Enter-Date-In to ws-Test-date.\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              display SL005 at 2361  with foreground-color 2    *> this msg may NOT get seen\n              go to Accept-Data.\n*>\n     display  \" \" at 2368 with erase eol.\n     move     u-bin  to ws-enter-date.\n*>\n Main-End.    exit section.\n*>\n Report-Produce              section.\n*>==================================\n*>\n     if       FS-Cobol-Files-Used\n              open     input   sales-sort.\n     open     output  print-file.\n     move     zero  to  a.\n     perform  Headings.\n*>\n Read-Loop.\n*>********\n*>\n*> Here we have two choices\n*> 1: If using files (Cobol), so work via the sort file (from sl165)\n*>    to help select records",
        "line": 21
      },
      {
        "type": "IF",
        "condition": "NOT using files but RDB tables",
        "line": 496
      },
      {
        "type": "IF",
        "condition": "NOT FS-Cobol-Files-Used\n              perform Sales-Read-Next-Sorted-By-Name\n              if      fs-reply not = zero        *>   = 10\n                      go to  End-Report\n              end-if\n              go to Read-Loop-Tests\n     end-if\n     read     sales-sort record at end\n              close Sales-Sort\n              go to  End-Report.\n*>\n     move     sales-sort-key  to  WS-Sales-Key.\n*>\n Read-Loop-Tests.\n     if       Customer-In not = spaces\n         and  WS-Sales-Key < Customer-In\n              go to Read-Loop.\n*>\n     if       Customer-In not = spaces\n         and  WS-Sales-Key > Cust-In\n              go to Read-Loop.\n*>\n     if       NOT FS-Cobol-Files-Used          *> we have the record\n              go   to Select-Criteria-Tests-Continued.\n*>\n     perform  Sales-Read-Indexed.    *> read sales-file invalid key\n     if       fs-reply = 21                *> tested for but should not happen.\n              display SL170        at 2301 with foreground-color 4\n              display WS-Sales-Key at 2319 with foreground-color 4\n              go to  Read-Loop.\n     display  \" \" at 2301 with erase eol.\n*>\n Select-Criteria-Tests-Continued.\n     if       Status-In = \"L\"\n      and     customer-dead\n              go to  Read-Loop\n     else\n       if     Status-In = \"D\"\n        and   customer-live\n              go to  Read-Loop.\n*>\n     if       Credit-Op not = space\n              move  Credit-In     to  Test-1\n              move  sales-credit  to  Test-2\n              move  Credit-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop.\n*>\n     if       Invoice-Op not = space\n              move  Invoice-In     to  Test-1\n              move  sales-activety to  Test-2\n              move  Invoice-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop.\n*>\n     if       Average-Op not = space\n              move  Average-In    to  Test-1\n              move  sales-average to  Test-2\n              move  Average-Op    to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop.\n*>\n     if       Overdue-Op not = space\n        and   sales-current  >  0.00\n              move  Overdue-In    to  Test-1\n              subtract  sales-last-inv  from  run-date giving  Test-2\n              move  Overdue-Op    to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop.\n*>\n     if       Enter-Date-Op not = space\n              move  ws-enter-date     to  Test-1\n              move  sales-create-date to  Test-2\n              move  Enter-Date-Op     to  Test-Op\n              perform  Test-Num\n              if    A-False\n                    go to  Read-Loop.\n*>\n     perform  Listing.\n     go       to Read-Loop.\n*>\n Test-Num.\n*>*******\n*>\n     move     function upper-case (Test-Op) to Test-Op.\n     if       Test-Op = \" \"\n              move  1  to  Truth\n       else\n              move  0  to  Truth.\n*>\n     if       Test-Op = \"L\"\n       and    Test-2  <  Test-1\n              move  1  to  Truth.\n*>\n     if       Test-Op = \"G\"\n       and    Test-2  >  Test-1\n              move  1  to  Truth.\n*>\n     if       Test-Op = \"E\"\n       and    Test-2  =  Test-1\n              move  1  to  Truth.\n*>\n Headings.\n*>*******\n*>\n     add      1  to  a.\n     move     a  to  l3-page.\n     if       a not = 1\n              write print-record  from  line-1 after page\n              write print-record  from  line-3 after 1\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 2.\n     write    print-record  from  line-5 after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     6 to line-cnt.\n*>\n Listing.\n*>******\n*>\n     if       line-cnt > Page-Lines\n              perform Headings.\n     move     WS-Sales-Key  to  l6-key.\n*>\n     if       customer-live\n              move  \"Active\"  to  l6-status\n     else\n              move  \"Dormant\" to  l6-status.\n*>\n     move     sales-name     to  l6-name.\n     move     sales-address  to  l7-address.\n     inspect  l7-address  replacing  all  sl-delim  by  \",\".\n     if       sales-ext = spaces\n              move sales-phone to l6-phone\n       else\n              move 1 to y\n              string sales-phone delimited by \"  \"\n                                 into l6-phone with pointer y\n              add 1 to y\n              if  Sales-Ext not = spaces\n                  string \"x\"       delimited by size\n                         sales-ext delimited by size\n                                 into l6-phone with pointer y.\n*>\n     move     sales-fax to l6-fax.\n     move     Sales-Partial-Ship-Flag to L6-BO.\n*>\n     if       late-charges\n              move  \"Y\"     to  l6-charges\n       else\n              move  spaces  to  l6-charges.\n*>\n     if       dunning-letters\n              move  \"Y\"     to  l6-letter\n       else\n              move  spaces  to  l6-letter.\n*>\n     move     sales-limit   to  l6-limit.\n     move     sales-credit  to  l6-credit.\n     move     sales-discount to l6-discount.\n*>\n     if       line-cnt > Page-Lines - 3\n              perform Headings.\n*>\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n*>\n     if       delivery-tag  >  zero\n              perform  Delivery-Print.\n     if       Notes-Tag > zero\n              perform  Notes-Print.\n*>\n     move     spaces to print-record.\n     write    print-record after 1.\n     add      3 to line-cnt.\n     if       line-cnt > Page-Lines\n              perform Headings.\n*>\n Delivery-Print.\n*>*************\n*>\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     move     \"D\"       to WS-Deliv-Key-Type.\n*>\n     perform  Delivery-Read-Indexed.        *> read delivery-file  invalid key\n     if       fs-reply = 21\n              move  \"Record not found\"  to deliv-name\n                                           deliv-address.\n*>\n     move     \"   Deliver\"   to  l6-key.\n     move     \"y Address\"    to  l6-status.\n*>\n     move     deliv-name     to  l6-name.\n     move     deliv-address  to  l7-address.\n     inspect  l7-address  replacing  all  sl-delim  by  \",\".\n*>\n     move     spaces  to  l6-phone\n                          l6-charges\n                          L6-BO\n                          l6-letter.\n     move     zero    to  l6-limit\n                          l6-credit\n                          l6-discount.\n*>\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n     add      2 to line-cnt.\n*>\n Notes-Print.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     move     \"N\"       to WS-Deliv-Key-Type.\n     perform  Delivery-Read-Indexed.        *> read delivery-file invalid key\n     if       fs-reply = 21\n              move  \"Record not found\"  to deliv-name\n                                           deliv-address.\n*>\n     string   \"Notes: \"     delimited by size\n              deliv-address delimited by size into l7-address.\n     write    print-record from line-7 after 1.\n     add      1 to line-cnt.\n*>\n End-Report.\n*>*********\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n Report-Heading-Setup  section.\n*>============================\n*>\n     move     1  to  y.\n     move     spaces  to  l3-report.\n*>\n     if       Status-In = spaces  and  Credit-Op\n                      and  Invoice-Op   and  Average-Op\n                      and  Overdue-Op   and  Customer-In\n              string  \"All\"  delimited by size\n                               into  l3-report  with  pointer  y\n     else\n              string  \"Matched\"  delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Status-In = \"L\"\n              string  \"Live\"    delimited by size\n                               into  l3-report  with  pointer  y.\n     if       Status-In = \"D\"\n              string  \"Dormant\" delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Credit-Op = \"L\"\n              move    \"< \"  to  cr-operand.\n     if       Credit-Op = \"G\"\n              move    \"> \"   to  cr-operand.\n     if       Credit-Op = \"E\"\n              move    \"= \"  to  cr-operand.\n*>\n     if       Credit-Op not = space\n              move  Credit-In  to  cr-days\n              string  credit-heading  delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Invoice-Op = \"L\"\n              move    \"< \"  to  act-operand.\n     if       Invoice-Op = \"G\"\n              move    \"> \"   to  act-operand.\n     if       Invoice-Op = \"E\"\n              move    \"= \"  to  act-operand.\n*>\n     if       Invoice-Op not = space\n              move  Invoice-In  to  act-days\n              string  active-heading  delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Average-Op = \"L\"\n              move    \"< \"  to  av-operand.\n     if       Average-Op = \"G\"\n              move    \"> \"   to  av-operand.\n     if       Average-Op = \"E\"\n              move    \"= \"  to  av-operand.\n*>\n     if       Average-Op not = space\n              move  Average-In  to  av-days\n              string  average-heading  delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Overdue-Op = \"L\"\n              move    \"< \"  to  ov-operand.\n     if       Overdue-Op = \"G\"\n              move    \"> \"   to  ov-operand.\n     if       Overdue-Op = \"E\"\n              move    \"= \"  to  ov-operand.\n*>\n     if       Overdue-Op not = space\n              move  Overdue-In  to  ov-days\n              string  overdue-heading delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Enter-Date-Op = \"L\"\n              move    \"< \"  to  ed-operand.\n     if       Enter-Date-Op = \"G\"\n              move    \"> \"   to  ed-operand.\n     if       Enter-Date-Op = \"E\"\n              move    \"= \"  to  ed-operand.\n*>\n     if       Enter-Date-Op not = space\n              move  Enter-Date-In  to  ed-date\n              string  enter-date-heading  delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Cust-In not = spaces\n              string  \" Keys Matching - \" delimited by size\n                      Cust-In             delimited by size\n                               into  l3-report  with  pointer  y.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>****************************************************\n*> Input:   ws-Test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-Test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-Test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-Test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-Test-date (1:4) to ws-Year.\n     move     ws-Test-date (6:2) to ws-Month.\n     move     ws-Test-date (9:2) to ws-Days.\n*>\n zz050-Test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 502
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 84,
      "totalOperators": 63,
      "totalOperands": 126,
      "vocabulary": 85,
      "length": 189,
      "volume": 1211.3748869300257
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
