{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/sys002.cbl",
  "fileName": "sys002.cbl",
  "timestamp": "2025-09-15T16:25:37.690Z",
  "programId": "sys002",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 276
      },
      {
        "name": "file",
        "line": 281
      },
      {
        "name": "working-storage",
        "line": 285
      },
      {
        "name": "linkage",
        "line": 592
      },
      {
        "name": "screen",
        "line": 607
      },
      {
        "name": "init01",
        "line": 1033
      },
      {
        "name": "User-Params",
        "line": 1300
      },
      {
        "name": "exit",
        "line": 1477
      },
      {
        "name": "System-Params",
        "line": 1479
      },
      {
        "name": "exit",
        "line": 1615
      },
      {
        "name": "GL-Params",
        "line": 1617
      },
      {
        "name": "exit",
        "line": 1723
      },
      {
        "name": "IRS-Params",
        "line": 1725
      },
      {
        "name": "exit",
        "line": 1761
      },
      {
        "name": "SL-Params",
        "line": 1763
      },
      {
        "name": "exit",
        "line": 1935
      },
      {
        "name": "PL-Params",
        "line": 1937
      },
      {
        "name": "exit",
        "line": 2002
      },
      {
        "name": "Stock-Params",
        "line": 2004
      },
      {
        "name": "exit",
        "line": 2114
      },
      {
        "name": "Print-Params",
        "line": 2116
      },
      {
        "name": "exit",
        "line": 2758
      },
      {
        "name": "SL-Print",
        "line": 2760
      },
      {
        "name": "exit",
        "line": 2920
      },
      {
        "name": "zz050-Validate-Date",
        "line": 2924
      },
      {
        "name": "exit",
        "line": 2961
      },
      {
        "name": "zz060-Convert-Date",
        "line": 2963
      },
      {
        "name": "exit",
        "line": 2997
      },
      {
        "name": "Maps04",
        "line": 2999
      },
      {
        "name": "exit",
        "line": 3005
      },
      {
        "name": "SystemMT-DAL",
        "line": 3007
      }
    ],
    "paragraphs": [
      {
        "name": "Date-compiled",
        "line": 22
      },
      {
        "name": "file-control",
        "line": 277
      },
      {
        "name": "file-defs",
        "line": 1030
      },
      {
        "name": "Init01-Main",
        "line": 1035
      },
      {
        "name": "end-if",
        "line": 1067
      },
      {
        "name": "end-if",
        "line": 1081
      },
      {
        "name": "end-if",
        "line": 1096
      },
      {
        "name": "end-if",
        "line": 1123
      },
      {
        "name": "end-if",
        "line": 1127
      },
      {
        "name": "Menu-Option",
        "line": 1172
      },
      {
        "name": "end-if",
        "line": 1197
      },
      {
        "name": "end-if",
        "line": 1240
      },
      {
        "name": "end-if",
        "line": 1274
      },
      {
        "name": "We-Are-Done",
        "line": 1277
      },
      {
        "name": "Disk-Error-Display",
        "line": 1284
      },
      {
        "name": "end-if",
        "line": 1291
      },
      {
        "name": "Main-Exit",
        "line": 1297
      },
      {
        "name": "Main-User",
        "line": 1307
      },
      {
        "name": "User-Data-Accept",
        "line": 1334
      },
      {
        "name": "end-if",
        "line": 1408
      },
      {
        "name": "Main-Exit",
        "line": 1476
      },
      {
        "name": "ops-main",
        "line": 1486
      },
      {
        "name": "ops-main-2",
        "line": 1581
      },
      {
        "name": "main-exit",
        "line": 1614
      },
      {
        "name": "GL-Params-Main",
        "line": 1624
      },
      {
        "name": "main-exit",
        "line": 1722
      },
      {
        "name": "IRS-Params-Exit",
        "line": 1760
      },
      {
        "name": "SL-Params-Main",
        "line": 1770
      },
      {
        "name": "SL-Params-2",
        "line": 1888
      },
      {
        "name": "main-exit",
        "line": 1934
      },
      {
        "name": "PL-Params-Main",
        "line": 1944
      },
      {
        "name": "main-exit",
        "line": 2001
      },
      {
        "name": "Stock-Params-Main",
        "line": 2011
      },
      {
        "name": "main-exit",
        "line": 2113
      },
      {
        "name": "l5-Data-1",
        "line": 2363
      },
      {
        "name": "main-exit",
        "line": 2757
      },
      {
        "name": "aa1",
        "line": 2770
      },
      {
        "name": "aa2",
        "line": 2784
      },
      {
        "name": "aa3",
        "line": 2799
      },
      {
        "name": "aa4",
        "line": 2810
      },
      {
        "name": "aa5",
        "line": 2820
      },
      {
        "name": "aa6",
        "line": 2836
      },
      {
        "name": "aa7",
        "line": 2847
      },
      {
        "name": "aa8",
        "line": 2860
      },
      {
        "name": "aa9",
        "line": 2871
      },
      {
        "name": "aa10",
        "line": 2879
      },
      {
        "name": "aa11",
        "line": 2887
      },
      {
        "name": "main-exit",
        "line": 2919
      },
      {
        "name": "zz050-test-date",
        "line": 2955
      },
      {
        "name": "zz050-exit",
        "line": 2960
      },
      {
        "name": "zz060-Exit",
        "line": 2996
      },
      {
        "name": "maps04-exit",
        "line": 3004
      },
      {
        "name": "aa100-Check-4-Errors",
        "line": 3010
      },
      {
        "name": "end-if",
        "line": 3029
      },
      {
        "name": "aa100-Exit",
        "line": 3031
      },
      {
        "name": "Exit",
        "line": 3032
      },
      {
        "name": "aa101-Check-4-Errors",
        "line": 3034
      },
      {
        "name": "end-if",
        "line": 3052
      },
      {
        "name": "aa101-Exit",
        "line": 3054
      },
      {
        "name": "Exit",
        "line": 3055
      },
      {
        "name": "aa102-Check-4-Errors",
        "line": 3057
      },
      {
        "name": "end-if",
        "line": 3075
      },
      {
        "name": "aa102-Exit",
        "line": 3077
      },
      {
        "name": "Exit",
        "line": 3078
      },
      {
        "name": "aa103-Check-4-Errors",
        "line": 3080
      },
      {
        "name": "end-if",
        "line": 3098
      },
      {
        "name": "aa103-Exit",
        "line": 3100
      },
      {
        "name": "Exit",
        "line": 3101
      }
    ],
    "entryPoints": [
      {
        "name": "            line 10 col  1.\n     03          value ",
        "line": 967
      }
    ]
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps01",
        "line": 1158,
        "type": "DYNAMIC",
        "using": [
          "maps01-ws"
        ]
      },
      {
        "target": "maps99",
        "line": 1169,
        "type": "DYNAMIC",
        "using": [
          "error-code",
          "ws-calling-data"
        ]
      },
      {
        "target": "maps04",
        "line": 1356,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws",
          "move",
          "u-date",
          "to",
          "p-start",
          "*>",
          "move",
          "u-date",
          "(1:6)",
          "to",
          "IRS-Start-Date",
          "(1:6)",
          "*>",
          "move",
          "u-date",
          "(9:2)",
          "to",
          "IRS-Start-Date",
          "(7:2)",
          "*>",
          "Omit",
          "CC",
          "in",
          "year",
          "for",
          "IRS",
          "end-if",
          "if",
          "u-bin",
          "=",
          "zero",
          "display",
          "SY005",
          "at",
          "1540",
          "with",
          "foreground-color",
          "3",
          "blink",
          "go",
          "to",
          "user-data-accept",
          "else",
          "display",
          "\"",
          "\"",
          "at",
          "1540",
          "with",
          "erase",
          "eol",
          "move",
          "u-bin",
          "to",
          "start-date",
          "end-if",
          "*>",
          "*>",
          "With",
          "start",
          "date",
          "known",
          "(year)",
          "we",
          "can",
          "set",
          "the",
          "stats-date-period"
        ]
      },
      {
        "target": "maps04",
        "line": 1380,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws",
          "move",
          "u-date",
          "to",
          "p-end",
          "*>",
          "move",
          "u-date",
          "(1:6)",
          "to",
          "IRS-End-Date",
          "(1:6)",
          "*>",
          "move",
          "u-date",
          "(9:2)",
          "to",
          "IRS-End-Date",
          "(7:2)",
          "*>",
          "Omit",
          "CC",
          "in",
          "year",
          "for",
          "IRS",
          "end-if",
          "if",
          "u-bin",
          "=",
          "zero",
          "display",
          "SY005",
          "at",
          "1640",
          "with",
          "foreground-color",
          "3",
          "blink",
          "go",
          "to",
          "user-data-accept",
          "else",
          "display",
          "\"",
          "\"",
          "at",
          "1640",
          "with",
          "erase",
          "eol",
          "move",
          "u-bin",
          "to",
          "end-date",
          "end-if",
          "*>",
          "move",
          "s-pass-word",
          "to",
          "pass-word",
          "in",
          "maps01-ws"
        ]
      },
      {
        "target": "maps01",
        "line": 1395,
        "type": "DYNAMIC",
        "using": [
          "maps01-ws",
          "*>",
          "move",
          "pass-word",
          "of",
          "maps01-ws",
          "to",
          "*>",
          "pass-word",
          "of",
          "System-Record",
          "*>",
          "end-if",
          "if",
          "period",
          "=",
          "13",
          "display",
          "\"Weekly",
          "\"",
          "at",
          "2265",
          "with",
          "foreground-color",
          "3",
          "erase",
          "eol",
          "else",
          "if",
          "period",
          "=",
          "6",
          "display",
          "\"Fortnightly\"",
          "at",
          "2265",
          "with",
          "foreground-color",
          "3",
          "erase",
          "eol",
          "else",
          "move",
          "3",
          "to",
          "period",
          "display",
          "\"Monthly",
          "\"",
          "at",
          "2265",
          "with",
          "foreground-color",
          "3",
          "erase",
          "eol",
          "end-if",
          "end-if"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 2755,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 3002,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "*>",
        "line": 67,
        "replacing": null
      },
      {
        "name": "of",
        "line": 266,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 275,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 279,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 284,
        "replacing": null
      },
      {
        "name": "sys-params-versioning",
        "line": 307,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 322,
        "replacing": null
      },
      {
        "name": "wstime",
        "line": 390,
        "replacing": null
      },
      {
        "name": "wsmaps01",
        "line": 411,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 412,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 413,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 415,
        "replacing": null
      },
      {
        "name": "wsfinal",
        "line": 419,
        "replacing": null
      },
      {
        "name": "wssys4",
        "line": 420,
        "replacing": null
      },
      {
        "name": "wsdflt",
        "line": 421,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 424,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 590,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 595,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 597,
        "replacing": null
      },
      {
        "name": "(Y/N)",
        "line": 2124,
        "replacing": null
      },
      {
        "name": "Proc-Get-Env-Set-Files",
        "line": 2922,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-Mapser-RDB",
        "line": 3103,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "systemMT-Close",
        "thru": null,
        "line": 145
      },
      {
        "target": "zz020-Get-Program-Args",
        "thru": null,
        "line": 1039
      },
      {
        "target": "acas000-Open-Input",
        "thru": null,
        "line": 1076
      },
      {
        "target": "acas000-close",
        "thru": null,
        "line": 1078
      },
      {
        "target": "ba000-mapser",
        "thru": null,
        "line": 1079
      },
      {
        "target": "acas000-open",
        "thru": null,
        "line": 1080
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1082
      },
      {
        "target": "acas000-Open",
        "thru": null,
        "line": 1083
      },
      {
        "target": "disk-error-display",
        "thru": null,
        "line": 1085
      },
      {
        "target": "acas000-Read-Indexed",
        "thru": null,
        "line": 1088
      },
      {
        "target": "disk-error-display",
        "thru": null,
        "line": 1091
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1093
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1099
      },
      {
        "target": "User-Params",
        "thru": null,
        "line": 1103
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1105
      },
      {
        "target": "System-Params",
        "thru": null,
        "line": 1107
      },
      {
        "target": "Gl-Params",
        "thru": null,
        "line": 1110
      },
      {
        "target": "Sl-Params",
        "thru": null,
        "line": 1113
      },
      {
        "target": "Pl-Params",
        "thru": null,
        "line": 1116
      },
      {
        "target": "Stock-Params",
        "thru": null,
        "line": 1119
      },
      {
        "target": "IRS-Params",
        "thru": null,
        "line": 1126
      },
      {
        "target": "OE-Params",
        "thru": null,
        "line": 1132
      },
      {
        "target": "EPOS-Params",
        "thru": null,
        "line": 1134
      },
      {
        "target": "Payroll-Params",
        "thru": null,
        "line": 1136
      },
      {
        "target": "Project-Z-Params",
        "thru": null,
        "line": 1138
      },
      {
        "target": "Vat-Return-Params",
        "thru": null,
        "line": 1140
      },
      {
        "target": "Print-Params",
        "thru": null,
        "line": 1142
      },
      {
        "target": "acas000-Rewrite",
        "thru": null,
        "line": 1183
      },
      {
        "target": "disk-error-display",
        "thru": null,
        "line": 1185
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1191
      },
      {
        "target": "acas000-Open",
        "thru": null,
        "line": 1211
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1234
      },
      {
        "target": "acas000-Rewrite",
        "thru": null,
        "line": 1248
      },
      {
        "target": "aa100-Check-4-Errors",
        "thru": "aa100-Exit",
        "line": 1249
      },
      {
        "target": "acas000-write",
        "thru": null,
        "line": 1251
      },
      {
        "target": "aa100-Check-4-Errors",
        "thru": "aa100-Exit",
        "line": 1252
      },
      {
        "target": "acas000-Rewrite",
        "thru": null,
        "line": 1260
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": "aa101-Exit",
        "line": 1261
      },
      {
        "target": "acas000-Rewrite",
        "thru": null,
        "line": 1266
      },
      {
        "target": "aa103-Check-4-Errors",
        "thru": "aa103-Exit",
        "line": 1267
      },
      {
        "target": "acas000-Rewrite",
        "thru": null,
        "line": 1272
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": "aa102-Exit",
        "line": 1273
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 1275
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1317
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1324
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1355
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1379
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2233
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 2248
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2514
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2517
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2520
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2523
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2526
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2529
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2532
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2535
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2538
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2541
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2544
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2547
      },
      {
        "target": "sl-print",
        "thru": null,
        "line": 2550
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2958
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2973
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "1",
        "to": "Used-Once\n              perform  zz020-Get-Program-Args",
        "line": 1038
      },
      {
        "from": "prog-name",
        "to": "l1-name",
        "line": 1046
      },
      {
        "from": "spaces",
        "to": "Display-Blk\n                       string SY902           delimited by size\n                              AA-Size         delimited by size\n                              \" < \"           delimited by size\n                              \"System-Rec = \" delimited by size\n                              BB-Size         delimited by size\n                                         into Display-Blk\n                       end-string\n                       display Display-Blk at 2301 with erase eol     *> BUT WILL REMIND ME TO SET IT UP correctly\n                       display SY008 at 2401 with erase eol\n                       accept Accept-Reply at 2433\n                       move   24 to Return-Code\n                       goback                     *> not yet tested in callers\n     end-if",
        "line": 1054
      },
      {
        "from": "zero",
        "to": "File-System-Used           *> In System-Record\n                       File-Duplicates-In-Use",
        "line": 1072
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 1074
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1075
      },
      {
        "from": "SY101",
        "to": "fs-action",
        "line": 1084
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1087
      },
      {
        "from": "SY102",
        "to": "FS-Action\n              perform  disk-error-display         *> must now exist but JIC\n              move 99 to fs-reply\n              perform acas000-Close\n              move   16 to Return-Code\n              goback                              *> not yet tested for in callers\n     end-if",
        "line": 1090
      },
      {
        "from": "run-date",
        "to": "u-bin",
        "line": 1098
      },
      {
        "from": "u-date",
        "to": "to-day",
        "line": 1100
      },
      {
        "from": "ws-date",
        "to": "ws-test-date            *>  ws-date and now ws-test-date for display\n                          line-1-date",
        "line": 1101
      },
      {
        "from": "usera",
        "to": "pass-name",
        "line": 1156
      },
      {
        "from": "\"N\"",
        "to": "encode",
        "line": 1157
      },
      {
        "from": "1",
        "to": "error-code",
        "line": 1168
      },
      {
        "from": "ws-Sys-Record-Ver-Prime",
        "to": "System-Record-Version-Prime\n     end-if\n*>\n     move     System-Record to WS-Temp-System-Record",
        "line": 1177
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1182
      },
      {
        "from": "SY103",
        "to": "fs-action",
        "line": 1184
      },
      {
        "from": "zeros",
        "to": "FS-Reply WE-Error",
        "line": 1201
      },
      {
        "from": "RDBMS-DB-Name",
        "to": "DB-Schema",
        "line": 1202
      },
      {
        "from": "RDBMS-User",
        "to": "DB-UName",
        "line": 1203
      },
      {
        "from": "RDBMS-Passwd",
        "to": "DB-UPass",
        "line": 1204
      },
      {
        "from": "RDBMS-Port",
        "to": "DB-Port",
        "line": 1205
      },
      {
        "from": "RDBMS-Host",
        "to": "DB-Host",
        "line": 1206
      },
      {
        "from": "RDBMS-Socket",
        "to": "DB-Socket",
        "line": 1207
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 1209
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1210
      },
      {
        "from": "FS-Reply",
        "to": "WS-Saved-FS-Reply\n              display \"File status=\" at 1301\n              display FA-RDBMS-Flat-Statuses at 1313\n              display \"RDB data = \" at 1401\n              display RDBMS-DB-Name at 1501\n              display RDBMS-User    at 1601\n              display RDBMS-Passwd  at 1701\n              display RDBMS-Port    at 1801\n              display RDBMS-Host    at 1901\n              display RDBMS-Socket  at 2001\n              display SY106 at 2201  with erase eol\n              display \"Error was = \" at 2301 with erase eol\n              display WS-Saved-FS-Reply at 2313\n              display \"WE-Error=\" at 2321\n              display WE-Error at 2330\n              display \"on para = \" at 2336\n              display WS-No-Paragraph at 2347\n              display SY110 at 2401 with erase eol\n              perform acas000-Close\n              accept  WS-Reply at 2433            *> Redo setup process?\n              if      WS-Reply = \"Y\" or \"y\"\n                      go to Init01-Main\n              else\n                      go to We-Are-Done           *> Allow user to work out whats wrong\n     end-if",
        "line": 1216
      },
      {
        "from": "WS-Temp-System-Record",
        "to": "System-Record",
        "line": 1244
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 1246
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1247
      },
      {
        "from": "2",
        "to": "File-Key-No\n              move    Default-Record to System-Record\n              perform acas000-Rewrite\n              perform aa101-Check-4-Errors thru aa101-Exit\n     end-if\n     if       Init-Final-File-SW = 1\n              move    3 to File-Key-No\n              move    Final-Record to System-Record\n              perform acas000-Rewrite\n              perform aa103-Check-4-Errors thru aa103-Exit\n     end-if\n     if       Init-Sys4-File-SW = 1\n              move    4 to File-Key-No\n              move    System-Record-4 to System-Record\n              perform acas000-Rewrite\n              perform aa102-Check-4-Errors thru aa102-Exit\n     end-if",
        "line": 1258
      },
      {
        "from": "zero",
        "to": "ws-term-code",
        "line": 1281
      },
      {
        "from": "1",
        "to": "screen-nos",
        "line": 1310
      },
      {
        "from": "start-date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move  ws-date  to  p-start\n     else\n              move spaces to p-start\n     end-if\n     if       end-date not = zero\n              move  end-date  to  u-bin\n              perform zz060-Convert-Date\n              move  ws-date  to  p-end\n     else\n              move spaces to p-end\n     end-if\n *>    move     spaces  to  pass-word of maps01-ws s-pass-word",
        "line": 1316
      },
      {
        "from": "Cyclea",
        "to": "WS-Cyclea",
        "line": 1330
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1350
      },
      {
        "from": "zero",
        "to": "u-bin\n              move  p-start  to  ws-test-date\n              perform zz050-Validate-Date\n*>              call \"maps04\" using maps03-ws\n              move  u-date  to  p-start\n*>              move  u-date (1:6) to IRS-Start-Date (1:6)\n*>              move  u-date (9:2) to IRS-Start-Date (7:2)  *> Omit CC in year for IRS\n     end-if\n     if       u-bin = zero\n              display SY005 at 1540 with foreground-color 3 blink\n              go to user-data-accept\n     else     display \" \" at 1540 with erase eol\n              move  u-bin   to  start-date\n     end-if\n*>\n*> With start date known (year) we can set the stats-date-period",
        "line": 1353
      },
      {
        "from": "WS-Year9",
        "to": "Stats-Date-Period",
        "line": 1373
      },
      {
        "from": "zero",
        "to": "u-bin\n              move  p-end  to  ws-test-date\n              perform zz050-Validate-Date\n*>              call \"maps04\" using maps03-ws\n              move  u-date  to  p-end\n*>              move  u-date (1:6) to IRS-End-Date (1:6)\n*>              move  u-date (9:2) to IRS-End-Date (7:2)  *> Omit CC in year for IRS\n     end-if\n     if       u-bin = zero\n              display SY005 at 1640 with foreground-color 3 blink\n              go to user-data-accept\n\n     else     display \" \" at 1640 with erase eol\n              move  u-bin   to  end-date\n     end-if\n *>    move     s-pass-word to pass-word in maps01-ws",
        "line": 1377
      },
      {
        "from": "\"P\"",
        "to": "encode\n *>             call  \"maps01\"  using  maps01-ws\n *>             move  pass-word of maps01-ws  to\n *>                   pass-word of System-Record\n *>    end-if\n     if       period = 13\n              display \"Weekly     \" at 2265 with foreground-color 3 erase eol\n     else\n      if      period = 6\n              display \"Fortnightly\" at 2265 with foreground-color 3 erase eol\n      else\n              move  3  to  period\n              display \"Monthly    \" at 2265 with foreground-color 3 erase eol\n      end-if\n     end-if",
        "line": 1394
      },
      {
        "from": "56",
        "to": "Page-Lines\n              display SY105 at 1750 with foreground-color 3 blink\n              go to user-data-accept\n     else\n              display \" \" at 1750 with erase eol\n     end-if\n*>\n     display  \"   \" at 2401 with erase eol",
        "line": 1411
      },
      {
        "from": "zero",
        "to": "File-System-Used\n              display \"Range 0 thru 1 only   \"  at 2410 with foreground-color 3 blink\n*>              display \"Range 0 thru 5 only   \"  at 2410 with foreground-color 3 blink\n     else\n      if      FS-Cobol-Files-Used\n              display \"Cobol data files used \"  at 2410 with foreground-color 3\n       else\n        if    FS-MySql-Used\n              display \"MySQL Rdbms used   \"  at 2410 with foreground-color 3",
        "line": 1420
      },
      {
        "from": "zero",
        "to": "File-Duplicates-In-Use\n *>             display \"Range 0 thru 1 only   \"  at 2450 with foreground-color 3 blink\n *>    else\n *>     if      FS-Duplicate-Processing\n *>             display \"Duplicate file processing used\"      at 2441 with foreground-color 3\n *>     else\n *>             display \"Duplicate file processing NOT used\"  at 2441 with foreground-color 3",
        "line": 1446
      },
      {
        "from": "\"N\"",
        "to": "SL-VAT-Printed\n              display SL-VAT-Printed at 2137 with foreground-color 3 blink",
        "line": 1456
      },
      {
        "from": "WS-Cyclea",
        "to": "Cyclea",
        "line": 1459
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1469
      },
      {
        "from": "2",
        "to": "screen-nos",
        "line": 1489
      },
      {
        "from": "1",
        "to": "host\n              display \"Multi-user system assumed\" at 1823 with foreground-color 3 blink\n     else\n      if      host = zero\n              display \"Single-user system       \" at 1823 with foreground-color 3 blink\n      else\n              display \"Multi-user system        \" at 1823 with foreground-color 3 blink",
        "line": 1497
      },
      {
        "from": "\"N\"",
        "to": "Param-Restrict",
        "line": 1506
      },
      {
        "from": "1",
        "to": "op-system\n              display \"MSDOS assumed\" at 2023 with foreground-color 3 blink\n      else\n       if     host = 1\n          and (op-system  < 2 or > 6)\n              move 6 to op-system\n              display \"Linux assumed\" at 2023 with foreground-color 3 blink\n      else    if op-system = 1\n              display \"DOS\"     at 2023 with foreground-color 3 blink\n      else    if op-system = 2\n              display \"Windows\" at 2023 with foreground-color 3 blink\n      else    if op-system = 3\n              display \"Mac OSX\" at 2023 with foreground-color 3 blink\n      else    if op-system = 4\n              display \"OS/2\"    at 2023 with foreground-color 3 blink\n      else    if op-system = 5\n              display \"Unix\"    at 2023 with foreground-color 3 blink\n      else    if op-system = 6\n              display \"Linux\"   at 2023 with foreground-color 3 blink",
        "line": 1514
      },
      {
        "from": "Print-Spool-Name",
        "to": "Print-Spool-Name2\n              end-if\n              if   Print-Spool-Name3 = spaces\n                   move Print-Spool-Name to Print-Spool-Name3\n              end-if\n              display ops-data-2\n              accept  ops-data-2 with update\n              if Print-Spool-Name (1:1) = space\n                 display \" Print Spool Name must be defined\" at 2402 with highlight foreground-color 3\n              else\n                 move Print-Spool-Name to PSN\n              end-if\n     end-if\n*>\n     if       DC-Cobol-Standard\n              display \"Cobol Standard Display  \" at 2054 with foreground-color 3\n     else\n      if      DC-GUI\n              display \"Gui Display             \" at 2054 with foreground-color 3\n      else\n       if     DC-Widget\n              display \"Widget Display          \" at 2054 with foreground-color 3\n       else\n              display \" Invalid - Std selected \" at 2054 with foreground-color 3 highlight\n              move zero to Data-Capture-Used",
        "line": 1536
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1572
      },
      {
        "from": "3",
        "to": "screen-nos",
        "line": 1585
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1608
      },
      {
        "from": "4",
        "to": "screen-nos",
        "line": 1625
      },
      {
        "from": "next-batch",
        "to": "num-6",
        "line": 1629
      },
      {
        "from": "num-6",
        "to": "next-batch",
        "line": 1632
      },
      {
        "from": "space",
        "to": "p-c\n              display \"Not selected  \" at 0732    with foreground-color 3 erase eol\n*>\n     move     function upper-case (p-c-level) to p-c-level",
        "line": 1641
      },
      {
        "from": "space",
        "to": "p-c-level\n     end-if\n     if       p-c not = space\n              and  revenue-only\n              display \"Revenue A/cs only \" at 0832 with foreground-color 3",
        "line": 1647
      },
      {
        "from": "space",
        "to": "p-c-level\n              display \"All A/cs          \" at 0832 with foreground-color 3\n     end-if\n     move     function upper-case(p-c-grouped) to p-c-grouped",
        "line": 1654
      },
      {
        "from": "space",
        "to": "p-c-grouped\n     end-if\n     move     function upper-case (comps) to comps",
        "line": 1663
      },
      {
        "from": "space",
        "to": "comps\n              display \"Not selected    \" at 1032 with foreground-color 3\n     end-if\n     move     function upper-case (ledger-2nd-index) to ledger-2nd-index",
        "line": 1669
      },
      {
        "from": "space",
        "to": "ledger-2nd-index\n              display \"Not selected    \" at 1132 with foreground-color 3 erase eol\n     end-if\n     move     function upper-case (m-v) to m-v",
        "line": 1676
      },
      {
        "from": "space",
        "to": "m-v\n     end-if\n     move     function upper-case (arch) to arch",
        "line": 1684
      },
      {
        "from": "space",
        "to": "arch\n              display \"Not selected    \" at 1332 with foreground-color 3\n     end-if\n     move     function upper-case (vat) to vat",
        "line": 1690
      },
      {
        "from": "space",
        "to": "vat\n              display \"Not selected    \" at 1632 with foreground-color 3\n     end-if\n     move     function upper-case (IRS-Instead) to IRS-Instead",
        "line": 1697
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1715
      },
      {
        "from": "9",
        "to": "screen-nos",
        "line": 1732
      },
      {
        "from": "Op-System",
        "to": "System-Ops",
        "line": 1742
      },
      {
        "from": "Vat-Rate-1",
        "to": "Vat1",
        "line": 1743
      },
      {
        "from": "Vat-Rate-2",
        "to": "Vat2",
        "line": 1744
      },
      {
        "from": "Vat-Rate-3",
        "to": "Vat3",
        "line": 1745
      },
      {
        "from": "Client",
        "to": "User-Code",
        "line": 1746
      },
      {
        "from": "\"1\"",
        "to": "PL-App-Created",
        "line": 1749
      },
      {
        "from": "1",
        "to": "Next-Post",
        "line": 1754
      },
      {
        "from": "zero",
        "to": "IRS-Pass-Value",
        "line": 1756
      },
      {
        "from": "zero",
        "to": "Save-Sequ",
        "line": 1758
      },
      {
        "from": "5",
        "to": "screen-nos",
        "line": 1771
      },
      {
        "from": "Next-Invoice",
        "to": "WS-Next-Invoice",
        "line": 1773
      },
      {
        "from": "1",
        "to": "WS-Next-Invoice\n     end-if\n     move     VAT-AC   to WS-VAT-AC",
        "line": 1775
      },
      {
        "from": "zero",
        "to": "GL-BL-Pay-Ac",
        "line": 1782
      },
      {
        "from": "zero",
        "to": "GL-P-Creditors",
        "line": 1783
      },
      {
        "from": "zero",
        "to": "GL-BL-Purch-Ac",
        "line": 1784
      },
      {
        "from": "zero",
        "to": "GL-SL-Pay-Ac",
        "line": 1785
      },
      {
        "from": "zero",
        "to": "GL-S-Debtors",
        "line": 1786
      },
      {
        "from": "zero",
        "to": "GL-SL-Sales-Ac",
        "line": 1787
      },
      {
        "from": "SL-Limit",
        "to": "WS-SL-Limit",
        "line": 1789
      },
      {
        "from": "WS-Next-Invoice",
        "to": "Next-Invoice",
        "line": 1795
      },
      {
        "from": "WS-SL-Limit",
        "to": "SL-Limit",
        "line": 1796
      },
      {
        "from": "zero",
        "to": "sl-dunning\n              display \"Late letters not selected\" at 0722 with foreground-color 3",
        "line": 1803
      },
      {
        "from": "zero",
        "to": "sl-charges\n              display \"Late charges not selected\" at 0822 with foreground-color 3",
        "line": 1809
      },
      {
        "from": "\"!\"",
        "to": "sl-delim\n     end-if\n     if       ( sl-Delim = \"\\\"      *>\"  just for kate\n                     or = \"/\" )\n          and FS-RDBMS-Used\n              display \"Delimiter <!> reset(RDB)\" at 1422 with foreground-color 3\n              move \"!\" to sl-Delim\n     end-if\n*>\n     move     function upper-case (sl-own-nos) to sl-own-nos",
        "line": 1815
      },
      {
        "from": "\"N\"",
        "to": "SL-Stock-Link\n              display \"Unset and/or No Stock\" at 1940 with foreground-color 3 blink",
        "line": 1842
      },
      {
        "from": "\"N\"",
        "to": "SL-BO-Flag",
        "line": 1846
      },
      {
        "from": "\"N\"",
        "to": "SL-BO-Default",
        "line": 1853
      },
      {
        "from": "WS-VAT-AC",
        "to": "VAT-AC",
        "line": 1871
      },
      {
        "from": "25",
        "to": "SL-Invoice-Lines\n     end-if\n*>\n     move     \"    S-L Data Complete  \"  to  verify-message",
        "line": 1877
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1882
      },
      {
        "from": "6",
        "to": "screen-nos",
        "line": 1889
      },
      {
        "from": "\"N\"",
        "to": "SL-Comp-Head-Inv",
        "line": 1903
      },
      {
        "from": "\"N\"",
        "to": "SL-Comp-Head-Stat",
        "line": 1906
      },
      {
        "from": "\"N\"",
        "to": "SL-Comp-Head-Lets",
        "line": 1909
      },
      {
        "from": "\"N\"",
        "to": "SL-Comp-Head-Pick",
        "line": 1912
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1928
      },
      {
        "from": "7",
        "to": "screen-nos",
        "line": 1945
      },
      {
        "from": "Next-Folio",
        "to": "WS-Next-Folio",
        "line": 1947
      },
      {
        "from": "BL-Pay-AC",
        "to": "BL-Pay-AC",
        "line": 1948
      },
      {
        "from": "P-Creditors",
        "to": "WS-P-Creditors",
        "line": 1949
      },
      {
        "from": "BL-Purch-Ac",
        "to": "WS-BL-Purch-Ac",
        "line": 1950
      },
      {
        "from": "WS-Next-Folio",
        "to": "Next-Folio",
        "line": 1956
      },
      {
        "from": "\"!\"",
        "to": "pl-delim\n     end-if\n     if       (pl-Delim = \"\\\" or = \"/\")        *> \"\n          AND FS-RDBMS-Used\n              display \"Delimiter <!> reset(RDB)\" at 1422\n                          with foreground-color 2\n              move \"!\" to pl-Delim\n     end-if\n*>\n     move     function upper-case (PL-Stock-Link) to PL-Stock-Link",
        "line": 1959
      },
      {
        "from": "\"N\"",
        "to": "PL-Stock-Link\n              display \"Unset and/or No Stock\" at 1528 with erase eol foreground-color 3 blink",
        "line": 1972
      },
      {
        "from": "WS-BL-Pay-AC",
        "to": "BL-Pay-ac",
        "line": 1975
      },
      {
        "from": "WS-BL-Purch-Ac",
        "to": "BL-Purch-Ac",
        "line": 1980
      },
      {
        "from": "WS-P-Creditors",
        "to": "P-Creditors",
        "line": 1985
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 1994
      },
      {
        "from": "8",
        "to": "screen-nos",
        "line": 2012
      },
      {
        "from": "zero",
        "to": "Stk-Debug\n              display \"    UnSet\" at 0720 with erase eol foreground-color 3\n     end-if\n     if       Stk-Manu-Used = 1\n              display \"    Set\" at 0920 with erase eol foreground-color 3\n     else\n              move zero to Stk-Manu-Used\n              display \"    UnSet\" at 0920 with erase eol foreground-color 3\n     end-if\n     if       Stk-OE-Used = 1\n              display \"    Set\" at 1020 with erase eol foreground-color 3\n     else\n              move zero to Stk-OE-Used\n              display \"    UnSet\" at 1020 with erase eol foreground-color 3\n     end-if\n *>    if       Stk-Audit-Used = 1\n *>             display \"    Set\" at 1120 with erase eol foreground-color 3\n *>    else\n *>             move zero to Stk-Audit-Used\n *>             display \"    UnSet\" at 1120 with erase eol foreground-color 3\n *>    end-if\n *>    if       Stk-Mov-Audit = 1\n *>             display \"    Set\" at 1220 with erase eol foreground-color 3\n *>    else\n *>             move zero to Stk-Mov-Audit\n *>             display \"    UnSet\" at 1220 with erase eol foreground-color 3\n *>    end-if\n     move     function upper-case (Stk-Period-Cur) to Stk-Period-Cur",
        "line": 2022
      },
      {
        "from": "\"M\"",
        "to": "Stk-Period-Cur\n              display \"    Unset: Has been set to Monthly\" at 1320\n                   with erase eol foreground-color 3 highlight",
        "line": 2059
      },
      {
        "from": "\"Y\"",
        "to": "Stk-Period-Dat\n              display \"    Unset: Has been set to Yearly\" at 1420\n                                      with erase eol foreground-color 3 highlight",
        "line": 2073
      },
      {
        "from": "zero",
        "to": "Stk-Averaging\n              display \"    UnSet\" at 1520 with erase eol foreground-color 3\n     end-if\n*>\n     if       Stk-Activity-Rep-Run = 1\n              display \"    Set\" at 1820 with erase eol foreground-color 3\n     else\n              move zero to Stk-Activity-Rep-Run\n              display \"    UnSet\" at 1820 with erase eol foreground-color 3\n     end-if\n     if       Stk-Audit-No  > 0 and < 99999\n              display \"  Set\" at 1922 with erase eol foreground-color 3\n     else\n              move zero to Stk-Audit-No\n              display \"  Set to zero\" at 1922 with erase eol foreground-color 4 highlight\n     end-if\n     move     function upper-case(Stk-BO-Active) to Stk-BO-Active",
        "line": 2080
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 2106
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 2125
      },
      {
        "from": "prog-name",
        "to": "l1-name",
        "line": 2131
      },
      {
        "from": "1",
        "to": "page-nos",
        "line": 2132
      },
      {
        "from": "page-nos",
        "to": "l1-page",
        "line": 2133
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2138
      },
      {
        "from": "\"Name\"",
        "to": "l5-name",
        "line": 2139
      },
      {
        "from": "usera",
        "to": "l5-data-1",
        "line": 2140
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2141
      },
      {
        "from": "\"Address\"",
        "to": "l5-name",
        "line": 2152
      },
      {
        "from": "address-1",
        "to": "l5-data-1",
        "line": 2153
      },
      {
        "from": "spaces",
        "to": "l5-name  l5-data-2",
        "line": 2164
      },
      {
        "from": "address-2",
        "to": "l5-data-1",
        "line": 2165
      },
      {
        "from": "spaces",
        "to": "l5-data-2\n     else\n      if      revenue-only\n              move  \"Only for Revenue Accounts\"  to  l5-data-2\n      else\n              move  \"For all Accounts\"  to  l5-data-2",
        "line": 2168
      },
      {
        "from": "address-3",
        "to": "l5-data-1",
        "line": 2177
      },
      {
        "from": "spaces",
        "to": "l5-data-2\n     else\n      if      grouped\n              move  \"P-C / Branches Grouped on 1st Digit\" to  l5-data-2\n      else\n              move  \"P-C / Branches not Grouped\" to  l5-data-2",
        "line": 2180
      },
      {
        "from": "spaces",
        "to": "Line-5\n              move     \"Company Email\" to L5-Name\n              move     Company-Email  to L5-Data-1\n              write    print-record  from  line-5 after 1",
        "line": 2211
      },
      {
        "from": "1",
        "to": "Date-Form\n     else\n      if      Date-Form = 2\n              move \"USA Format\" to l5-data-1\n      else    move \"Intl Format\" to l5-data-1",
        "line": 2219
      },
      {
        "from": "start-date",
        "to": "u-bin",
        "line": 2232
      },
      {
        "from": "spaces",
        "to": "L5-Data-1",
        "line": 2235
      },
      {
        "from": "end-date",
        "to": "u-bin",
        "line": 2247
      },
      {
        "from": "ws-date",
        "to": "l5-data-1",
        "line": 2249
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2258
      },
      {
        "from": "vat-rate-1",
        "to": "num-1",
        "line": 2259
      },
      {
        "from": "vat-rate-4",
        "to": "num-1b",
        "line": 2260
      },
      {
        "from": "spaces",
        "to": "l5-data-1",
        "line": 2261
      },
      {
        "from": "\"(NP)\"",
        "to": "S-Pass-Word",
        "line": 2265
      },
      {
        "from": "spaces",
        "to": "S-Pass-Word",
        "line": 2274
      },
      {
        "from": "Sales-Range",
        "to": "array-2 (41)",
        "line": 2281
      },
      {
        "from": "spaces",
        "to": "l5-data-1",
        "line": 2284
      },
      {
        "from": "vat-rate-2",
        "to": "num-1",
        "line": 2285
      },
      {
        "from": "vat-rate-5",
        "to": "num-1b",
        "line": 2286
      },
      {
        "from": "num-1",
        "to": "l5-data-1",
        "line": 2290
      },
      {
        "from": "Purchase-Range",
        "to": "array-2 (41)",
        "line": 2297
      },
      {
        "from": "vat-rate-3",
        "to": "num-1",
        "line": 2300
      },
      {
        "from": "num-1",
        "to": "l5-data-1",
        "line": 2301
      },
      {
        "from": "spaces",
        "to": "l5-name  l5-data-1",
        "line": 2311
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2312
      },
      {
        "from": "period",
        "to": "num-2",
        "line": 2313
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2314
      },
      {
        "from": "current-quarter",
        "to": "num-4",
        "line": 2318
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2319
      },
      {
        "from": "spaces",
        "to": "l5-data-2 l5-data-1",
        "line": 2324
      },
      {
        "from": "next-batch",
        "to": "num-2",
        "line": 2325
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2326
      },
      {
        "from": "cyclea",
        "to": "num-4",
        "line": 2331
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2332
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2336
      },
      {
        "from": "Page-Lines",
        "to": "Num-9",
        "line": 2338
      },
      {
        "from": "Num-9",
        "to": "l5-data-1",
        "line": 2339
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2344
      },
      {
        "from": "l4-part1",
        "to": "print-record",
        "line": 2346
      },
      {
        "from": "pl-delim",
        "to": "array-2 (29)",
        "line": 2350
      },
      {
        "from": "\"Environment\"",
        "to": "l5-name",
        "line": 2352
      },
      {
        "from": "spaces",
        "to": "Temp-String\n                        Temp-String2\n                        l5-Data-1",
        "line": 2361
      },
      {
        "from": "\"Windows\"",
        "to": "Temp-String\n     else if  Dos      move \"Dos\"       to  Temp-String\n     else if  os2      move \"OS/2\"      to  Temp-String\n     else if  unix     move \"Unix\"      to  Temp-String\n     else if  linux    move \"Linux\"     to  Temp-String",
        "line": 2364
      },
      {
        "from": "25",
        "to": "num-3",
        "line": 2383
      },
      {
        "from": "bl-next-batch",
        "to": "num-6",
        "line": 2384
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2395
      },
      {
        "from": "1",
        "to": "Next-Folio",
        "line": 2398
      },
      {
        "from": "Next-Folio",
        "to": "num-7",
        "line": 2399
      },
      {
        "from": "spaces",
        "to": "line-5 Temp-String",
        "line": 2404
      },
      {
        "from": "zero",
        "to": "File-System-Used",
        "line": 2406
      },
      {
        "from": "zero",
        "to": "File-Duplicates-In-Use\n     end-if\n     move     Temp-String  to l5-data-1",
        "line": 2429
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2433
      },
      {
        "from": "BL-Pay-Ac",
        "to": "num-8",
        "line": 2435
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2440
      },
      {
        "from": "\"Path",
        "to": "BIN\" to l5-name",
        "line": 2441
      },
      {
        "from": "ACAS_BIN",
        "to": "l5-data-1",
        "line": 2442
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2445
      },
      {
        "from": "BL-Purch-Ac",
        "to": "num-8",
        "line": 2447
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2452
      },
      {
        "from": "\"Path",
        "to": "Ledgers\" to l5-name",
        "line": 2453
      },
      {
        "from": "ACAS_LEDGERS",
        "to": "l5-data-1",
        "line": 2454
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2457
      },
      {
        "from": "P-Creditors",
        "to": "num-8",
        "line": 2459
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2464
      },
      {
        "from": "Print-Spool-Name",
        "to": "l5-data-1\n     else\n              move \"Not Used\"       to l5-data-1\n     end-if\n     move     1 to num-3",
        "line": 2467
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2481
      },
      {
        "from": "Print-Spool-Name2",
        "to": "l5-data-1\n     else\n              move \"Not Used\"        to l5-data-1\n     end-if\n     write    print-record from line-5 after 1",
        "line": 2484
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2490
      },
      {
        "from": "Print-Spool-Name3",
        "to": "l5-data-1\n     else\n              move \"Not Used\"        to l5-data-1\n     end-if\n     write    print-record from line-5 after 1",
        "line": 2493
      },
      {
        "from": "spaces",
        "to": "Line-5",
        "line": 2498
      },
      {
        "from": "\"Yes\"",
        "to": "l5-Data-1\n     else\n              move \"No\"  to L5-Data-1\n     end-if\n*>\n*> End of ACAS Params now for S/L and Invoicing (if present)\n*>\n     write    print-record from line-3c after 2",
        "line": 2501
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 2511
      },
      {
        "from": "3",
        "to": "a",
        "line": 2513
      },
      {
        "from": "1",
        "to": "a",
        "line": 2516
      },
      {
        "from": "2",
        "to": "a",
        "line": 2519
      },
      {
        "from": "4",
        "to": "a",
        "line": 2522
      },
      {
        "from": "5",
        "to": "a",
        "line": 2525
      },
      {
        "from": "6",
        "to": "a",
        "line": 2528
      },
      {
        "from": "7",
        "to": "a",
        "line": 2531
      },
      {
        "from": "8",
        "to": "a",
        "line": 2534
      },
      {
        "from": "9",
        "to": "a",
        "line": 2537
      },
      {
        "from": "10",
        "to": "a",
        "line": 2540
      },
      {
        "from": "11",
        "to": "a",
        "line": 2543
      },
      {
        "from": "12",
        "to": "a",
        "line": 2546
      },
      {
        "from": "13",
        "to": "a",
        "line": 2549
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2553
      },
      {
        "from": "1",
        "to": "num-3,\n     string   \"Stock Control Link \" delimited by size into l5-data-2 pointer num-3",
        "line": 2558
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2570
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2571
      },
      {
        "from": "SL-Pay-Ac",
        "to": "num-8",
        "line": 2573
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2581
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2582
      },
      {
        "from": "SL-Sales-Ac",
        "to": "num-8",
        "line": 2584
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2592
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2593
      },
      {
        "from": "S-Debtors",
        "to": "num-8",
        "line": 2595
      },
      {
        "from": "spaces",
        "to": "l5-data-2",
        "line": 2602
      },
      {
        "from": "1",
        "to": "num-3",
        "line": 2603
      },
      {
        "from": "Delivery",
        "to": "num-8",
        "line": 2605
      },
      {
        "from": "2",
        "to": "page-nos",
        "line": 2616
      },
      {
        "from": "page-nos",
        "to": "l1-page",
        "line": 2617
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2622
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else\n              move \"No\" to l5-data-1",
        "line": 2625
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2634
      },
      {
        "from": "\"Manufacturing\"",
        "to": "l5-name",
        "line": 2635
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else\n              move \"No\" to l5-data-1",
        "line": 2637
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else\n              move \"No\" to l5-data-1",
        "line": 2644
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else\n              move \"No\" to l5-data-1",
        "line": 2651
      },
      {
        "from": "\"Monthly\"",
        "to": "l5-data-1\n     else if  Stk-Period-Cur = \"Q\"\n              move \"Quarterly\" to l5-data-1\n     else if  Stk-Period-Cur = \"Y\"\n              move \"Yearly\"    to l5-data-1\n     else     move \"NOT SET\"   to l5-data-1",
        "line": 2658
      },
      {
        "from": "\"Monthly\"",
        "to": "l5-data-1\n     else if  Stk-Period-Dat = \"Q\"\n              move \"Quarterly\" to l5-data-1\n     else if  Stk-Period-Dat = \"Y\"\n              move \"Yearly\"    to l5-data-1\n     else     move \"NOT SET\"   to l5-data-1",
        "line": 2668
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else     move \"No\"  to l5-data-1",
        "line": 2678
      },
      {
        "from": "Stk-Audit-No",
        "to": "Num-7",
        "line": 2683
      },
      {
        "from": "Num-7",
        "to": "l5-data-1",
        "line": 2684
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2695
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n*>     else\n              move \"No\" to l5-data-1",
        "line": 2698
      },
      {
        "from": "RDBMS-DB-Name",
        "to": "l5-data-2 (17:12)",
        "line": 2704
      },
      {
        "from": "spaces",
        "to": "l5-data-1    l5-name\n              move \"RDB User Name   \" to l5-data-2\n              move RDBMS-User         to l5-data-2 (17:12)\n              write print-record  from  line-5 after 1\n              move \"RDB User Passwd \" to l5-data-2         *> Could remove these 4 lines\n              move \"It's SECRET\"      to l5-data-2 (17:12)\n              move line-3e (1:40)     to line-5 (1:40)     *> System Params head\n              write print-record  from  line-5 after 1\n     else\n              write    print-record  from  line-3e after 2",
        "line": 2708
      },
      {
        "from": "spaces",
        "to": "l4-Part2",
        "line": 2720
      },
      {
        "from": "spaces",
        "to": "l5-data-1    l5-name\n              move     \"****************\" to l5-files (15:16)\n              move \"RDB Host        \" to l5-data-2\n              move RDBMS-Host         to l5-data-2 (17:32)\n              write print-record  from  line-5 after 1\n     else\n              write    print-record  from  line-4 after 1",
        "line": 2722
      },
      {
        "from": "spaces",
        "to": "l5-data-1    l5-name\n              move \"RDB Socket      \" to l5-data-2\n              move RDBMS-Socket       to l5-data-2 (17:46)     *> ignoring last 17 chars of field",
        "line": 2731
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2738
      },
      {
        "from": "PL-Approp-AC6",
        "to": "l5-data-1",
        "line": 2741
      },
      {
        "from": "RDBMS-Port",
        "to": "l5-data-2 (17:5)\n              write print-record  from  line-5 after 1\n     else\n              write print-record from line-5 after 2",
        "line": 2745
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 2765
      },
      {
        "from": "extra-desc",
        "to": "l5-data-1",
        "line": 2778
      },
      {
        "from": "extra-desc",
        "to": "l5-data-1",
        "line": 2781
      },
      {
        "from": "extra-rate",
        "to": "num-1",
        "line": 2790
      },
      {
        "from": "num-1",
        "to": "l5-data-1",
        "line": 2793
      },
      {
        "from": "num-1",
        "to": "l5-data-1",
        "line": 2796
      },
      {
        "from": "next-invoice",
        "to": "num-7",
        "line": 2806
      },
      {
        "from": "num-7",
        "to": "l5-data-1",
        "line": 2807
      },
      {
        "from": "sl-credit",
        "to": "num-4",
        "line": 2812
      },
      {
        "from": "15",
        "to": "num-3",
        "line": 2813
      },
      {
        "from": "invoicer",
        "to": "l5-data-1",
        "line": 2817
      },
      {
        "from": "sl-limit",
        "to": "num-5",
        "line": 2822
      },
      {
        "from": "23",
        "to": "num-3",
        "line": 2823
      },
      {
        "from": "extra-charge-ac",
        "to": "num-8",
        "line": 2826
      },
      {
        "from": "num-8",
        "to": "l5-data-1",
        "line": 2829
      },
      {
        "from": "num-8",
        "to": "l5-data-1",
        "line": 2833
      },
      {
        "from": "sl-disc",
        "to": "num-1",
        "line": 2838
      },
      {
        "from": "24",
        "to": "num-3",
        "line": 2839
      },
      {
        "from": "vat-ac",
        "to": "num-8",
        "line": 2843
      },
      {
        "from": "num-8",
        "to": "l5-data-1",
        "line": 2844
      },
      {
        "from": "sl-min",
        "to": "num-2",
        "line": 2849
      },
      {
        "from": "25",
        "to": "num-3",
        "line": 2850
      },
      {
        "from": "\"Yes\"",
        "to": "l5-data-1\n     else\n              move     \"No \"     to l5-data-1",
        "line": 2855
      },
      {
        "from": "sl-max",
        "to": "num-2",
        "line": 2863
      },
      {
        "from": "25",
        "to": "num-3",
        "line": 2864
      },
      {
        "from": "SL-Invoice-Lines",
        "to": "Num-4",
        "line": 2867
      },
      {
        "from": "Num-4",
        "to": "L5-Data-1",
        "line": 2868
      },
      {
        "from": "sl-late-per",
        "to": "num-1",
        "line": 2874
      },
      {
        "from": "24",
        "to": "num-3",
        "line": 2875
      },
      {
        "from": "sl-delim",
        "to": "array-2 (29)",
        "line": 2884
      },
      {
        "from": "25",
        "to": "num-3",
        "line": 2889
      },
      {
        "from": "first-sl-batch",
        "to": "num-6",
        "line": 2890
      },
      {
        "from": "pf-retention",
        "to": "num-9",
        "line": 2893
      },
      {
        "from": "num-9",
        "to": "l5-data-1",
        "line": 2894
      },
      {
        "from": "27",
        "to": "Num-3",
        "line": 2899
      },
      {
        "from": "27",
        "to": "Num-3",
        "line": 2910
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 2937
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2939
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 2943
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 2950
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 2956
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 2957
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 2975
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 2977
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2980
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 2984
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 2991
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "not found.\n*> 16/11/11 vbc - .17 Force case on accepting sl-own-nos, SL-Stock-Link, PL-Stock-Link and some others.\n*>                .18 Added system wide print lines under system params after collecting company address.\n*>                .19 Moved printed system wide print lines to User params.\n*> 17/11/11 vbc - .20 Remove most of Payroll on Open source versions\n*>                .21 In init of NEW system file, set file layout version to rec 1.\n*>                .22 Page-lines not checked > 28.\n*> 18/11/11 vbc - .23 If esc is entered on 1st screen, system-files was not closed\n*> 19/11/11 vbc - .24 Force date format to be UK on creating new system rec 1 in case\n*>                    user does not set it and open system file with lock.\n*> 04/12/11 vbc - .25 Added Delivery on display and report for debugging but temp left as changeable.\n*> 10/12/11 vbc - .26 Support for User Post code/Zip, Country and local tax (or vat rates 4 & 5)\n*>                    Global support for date format and now set into common system data area,\n*>                    raised system version to 3.01 to match across all ACAS sub systems.\n*> 11/12/11 vbc - .27 Removed all proc for stk-date-form from Stock data and replaced with just Date-Form in General.\n*> 26/12/11 vbc - .28 Included common code (zz010, zz020) used by All ACAS modules needed as can be called\n*>                     by any of the sub-systems. Called to dummy area but creates paths etc in WS.\n*> 04/03/12 vbc - .29 Added support for Duplicate file type processing + MS SQL Server rdbms.\n*>                    Added screen function control but only Standard Cobol in use.\n*> 09/04/12 vbc - .30 Added RDBMS screens and reporting.\n*> 17/04/13 vbc - .31 Added init for final record within system.dat.\n*> 20/04/13 vbc - .32 Remarked out code to rebuild file paths etc as done in menus + format issue for delivery tag\n*> 26/04/13 vbc - .33 Force writes for all record types, build paths by including code in .32\n*> 27/04/13 vbc - .34 Make Stk-Page-Lines same as System Page-Lines if zero. Shouldt we only be using system lines?\n*> 15/05/13 vbc - .35 Reworded screen for Stk-Activity-Rep-Run.\n*> 20/05/13 vbc - .36 Added SL screen 2 for Print co. addr info on Invoices, Statements, Delivery, & letters\n*>                    etc. Also added VAT print request in exist user data screen.\n*>                .37 Bug in above in print layout.\n*> 04/06/13 vbc - .38 Missing Name for Print Lines in user params print, adding spool names 2 & 3,\n*>                    remove stk-page-lines as using system page-lines only.\n*> 30/06/13 vbc - .38 Change printed rdbms password from SECRET to 'It's SECRET' just in case someone\n*>                    assumes thats the password :)\n*> 22/09/15 vbc - .39 Added support for Param-Restrict.\n*> 25/06/16 vbc - .40 Added in the RDBMS fields Host, Socket, Port and with increased System-Data-Block\n*>                    from 384 to 512 and removed the unused Order-Entry-Block.\n*>                    System Record version changed from 1.1 to 1.2 > 1.3 (25/08/16).\n*>                    Updated Ops data 3 to include new fields and likewise the report.\n*> 17/07/16 vbc - .41 Added tests for content of \"LC_TIME\" when creating virgin param file.\n*>                    Date type can still be over-ridden by user.\n*>                    Uses \"SET\" to do so.\n*> 25/08/16 vbc - .42 (& see .40 note) increased size of RDBMS-SOCKET from 32 to 64 so increased l5-data-2\n*>                    by 4 and likewise the screen area for it & increased rec version to 1.3.\n*> 17/09/16 vbc - .43 When using initialize on new param file use 'with filler'.\n*>                    initialise IRS-Entry-Block if chars 1 thru 10 = spaces\n*>                    in preparation for usage at some point when I get round to it\n*>                    but needed for rdbms load.\n*>                    if  System-Record-Version-Prime is zero set to 1.\n*>                    as old bug not cleared in data.\n*> 18/09/16 vbc - .44 For PL & SL the delimiter MUST not be '\\' or '/' if using\n*>                    RDBMS (Mysql or Mariadb) if it is entered its changed to\n*>                    the default '!' - they don't like it no idea why as cannot see\n*>                    it in a manual as a problem. Also if space entered changed to '!'.\n*>                    Finding this took 6 hours !!!\n*> 19/09/16 vbc - .45 Removed cosmetic error on printing no addr4 with postcode,country.\n*>                    Adding in RDB processing using DAL - systemLD .\n*>                    Increased versioning from 3.01 to 3.02.\n*>                    This program will directly use cobol files AND call the RDB DAL\n*>                    as the system parameter file MUST be first accessed for RDB connect\n*>                    data.\n*> 29/09/16 vbc - .46 Forgot to perform systemMT-Close and spurious if test in rdb error test\n*>                    was going to be some thing but have forgotten so remed out for now.\n*>                    Also forgot to set up DB- vars from param files RDBMS vars.\n*> 16/10/16 vbc - .47 Changes to support integrated irs that uses RDB with\n*>                    normal param file (system) along with dflt replacing\n*>                    irsub2, 3 & 5 with acasirs2, 3 & 5 along with\n*>                    systemMT, dfltMT & finalMT .\n*>                    This version can use Cobol files instead of rdb but\n*>                    using the same directory for the rest of ACAS with IRS.\n*>                    version will be 3.02.nnn for all new changes where\n*>                    nnn is the build number as usual.\n*>                    Reposition report for G/L with Question regarding\n*>                    IRS Usage. Do need to NOT printout G/L only data if IRS used.\n*>                    Cleaned up Address & Postcode on report if addr-4 space (.44).\n*>                    Add space before prog name in reports for idiot printers\n*>                    loosing 1st char on 2nd page\n*>  2Badded -         New block instead of O/E for IRS unique data IF USED.\n*> 29/10/16 vbc - .48 Added in all Mapser processing instead of being in each\n*>                    of the sub systems e.g., General, Sales, Purchase, Stock & IRS.\n*>                    REMEMBER TO REMOVE such code from those !!!\n*> 26/11/16 vbc - .49 Added in system set up & screens from irs.\n*>                    Modified request if IRS to be used to include :\n*>                    YES | NO | BOTH\n*>                    Printed out in place of redundant O/E.\n*>                    Move first three ACAS vat rates to IRS vat1,2 & 3.\n*> 09/12/16 vbc - .50 Put back disp \" \" to erase eol as display SC 01 and\n*>                    erase eol does not work.  Bug in compiler?\n*>                    Removed usage of ACAS_IRS replaced by ACAS_BIN in report.\n*> 11/12/16 vbc - .51 Extra checks for temp sys rec size + setting file-key-no\n*>                    before rewrite of system rec that was missing.\n*> 25/04/17 vbc - .52 At start open param as input to test if exists not I/O\n*>                    as it will create if not exist.\n*> 15/01/18 vbc - .53 Added in User-Data date-form comment for start & end dates\n*>                    and added WS-Year9 with ws-Year for new sys field\n*>                    Stats-Date-Period filled from start date year as stats\n*>                    work on 01 Jan to 31 Dec periods within sales, purch ledgers\n*>                    clearing down at end of year and value moving this to last.\n*> 31/01/18 vbc - .54 Amended comments for ledger-2nd-index as not used and\n*>                    Cleaned up PC or Branch to indicate one or other or blank\n*>                    Updated ACAS list of files and tables at ws-file-names\n*>                    notes for reference.\n*> 03/02/18 vbc - .55 File dups removed.\n*> 07/02/18 vbc - .56 Clean display for user-data cycle msg with erase eol\n*>                    Remove File Dup processing in user-data accept checks\n*>                    Give msgs for printing or not of Co. Name/addr on letters\n*>                    invoices, statements and picking lists.\n*>                    Removed processing for password, bit pointless with Linux\n*>                    and Windows systems user security.\n*>                .57 Under SL-Data added missing VAT-Ac and Next-Invoice.\n*>                    Also test and set etc for both so extended data lines to 23.\n*>                    Those 2 have been missing for 30+ years!\n*>                    but not sure that Vat-ac is in use  anywhere so will check\n*>                    against xref for all modules soon <<---\n*> 10/02/18 vbc - .58 Add missing PL-Approp-AC6 capture and its flag &\n*>                    print under System parameters.\n*> 18/03/18 vbc - .59 Added new field in System params SL-Invoice-Lines.\n*>                    Once supported this will allow the max lines per invoice\n*>                    to be controlled by the user.\n*>                    At the moment this count will be used on Invoices and\n*>                    Picking / Packing lists.\n*>                    This will not affect invoice entry or amend routines.\n*>                    Added print item - Prt Max items in Inv. params. at aa8.\n*> 09/04/18 vbc - .60 Tidy up SL data 1 screen as getting overwrites.\n*> 13/04/18 vbc - .61 Fixed missing Env and op system info added restrict param\n*>                    info.\n*> 15/04/18 vbc - .62 Use WS for binary fields VAT-AC, Next-Invoice as GC\n*>                    does NOT convert. There is more.......\n*>                    So why does GC not handle them and do autoconversion ?\n*> 28/04/18 vbc - .63 Remarked out in Stock section the removed audit stuff\n*>                    that is now compulsory.\n*> 01/06/20 vbc - .64 IN #53 did not add this field to report - added.\n*>                    Underline pos. for System Parameters missing a *\n*> 03/06/20 vbc - .65 Changed validation for RDBMS processing reporting to use\n*>                    MySQL and not generic.\n*> 07/12/22 vbc - .66 Chgd Vars A & B to pic 999 to keep GC v3.2 happy.\n*>                    Add a para name for each section where there is a goto to\n*>                    start of section as GC v3.2 complains.\n*> 03/04/23 vbc - .67 Scrren bad pos. for comment re date types.\n*> 20/04/23 vbc - .68 Updated file table as included 2 new files slautogn and plautogn\n*>                    as files 04  &  30.\n*> 26/06/23 vbc - .69 Added Company Email address collection and reporting.\n*> 23/08/23 vbc       Restored code from nightly backup as wrongly overwritten , DER !\n*> 10/09/23 vbc - .70 Added in OE to Mapser - currently no data entry needed for it.\n*> 15/03/24 vbc - .71 Support for SL-BO-Flag and Stk-BO-Active. File size same.\n*> 20/03/24 vbc - .72 Added SL-BO-Default.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 21/04/24 vbc   .73 BO defaults printed wrong (RH only). in SL-Params-Main added code\n*>                    to zero 6 fields created since 2018 in filler area if any old\n*>                    system params are around. Not sure they are used but...\n*> 18/12/24 vbc   .74 Change default value for Page-Lines to 56 (Portrait).\n*>                    Should have one for Landscape and not hard wired.\n*>                    Display of line 22 cc40+ overwritten moved to Line 23.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n file-control.\n*>\n copy \"selprint.cob\".\n data                    division.\n file section.\n*>-----------\n*>\n copy \"fdprint.cob\".\n working-storage section.\n*>----------------------\n 77  Prog-Name           pic x(16)    value \"SYS002 (3.02.74)\".\n 77  error-code          pic 999.\n 77  Page-Nos            pic 99       value zero.\n 77  OS-Delimiter        pic x        value \"/\".\n 77  ACAS_BIN            pic x(512)   value spaces.  *> added\n 77  ACAS_LEDGERS        pic x(500)   value spaces.\n 77  Display-Blk         pic x(75)    value spaces.\n 77  Arg-Number          pic 9        value zero.\n 77  z                   binary-char  value zero.\n 77  Init-System-File-SW pic 9        value zero.\n 77  Init-Sys4-File-SW   pic 9        value zero.\n 77  Init-Final-File-SW  pic 9        value zero.\n 77  Init-Default-File-SW pic 9        value zero.\n 77  WS-Saved-FS-Reply   pic 99.\n *>\n*> Used For Changes In wssystem After Release\n*>===========================================\n*>  in case file layout upgrade is needed.\n*>   Using a file update program.\n*>\n copy \"sys-params-versioning.cob\".\n*>\n*>\n*> Holds program parameter values from command line\n*>\n 01  Arg-Vals                          value spaces.\n     03  Arg-Value       pic x(525)  occurs 2.\n 01  Arg-Test            pic x(525)    value spaces.\n*>\n*>=========================================================================\n*>  User changeable but may also need to be done system wide\n*>    CUPS lpr command to spool print output & used for Linux, Unix & Mac.\n*>                   Not standard in OS/2 but if so needs to be changed in\n*>                   wssystem.cob and here (sys002).\n*>\n copy \"print-spool-command.cob\".\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  a               binary-char.\n     03  b               binary-char.\n     03  AA-Size         pic 9(4)      value zero.\n     03  BB-Size         pic 9(4)      value zero.\n     03  p-start         pic x(10)     value spaces.\n     03  p-end           pic x(10)     value spaces.\n     03  s-pass-word     pic x(4)      value spaces.\n     03  to-day          pic x(10)     value \"dd/mm/yyyy\".\n     03  Used-Once       pic 9         value zero.\n*>\n     03  option-list     pic x(60).        *> from stock.cbl\n     03  wsmaps-ser.                       *>  ditto\n         05  wsmaps-ser-xx pic xx.\n         05  wsmaps-ser-nn pic 9(4).\n*>\n 01  filler.\n     03  num-1           pic z9.99.\n     03  num-1b          pic z9.99.\n     03  num-2           pic z(4)9.\n     03  num-3           pic 999.\n     03  num-4           pic z9.\n     03  num-5           pic z(6)9.\n     03  num-6           pic 9(5).\n     03  num-7           pic 9(8).\n     03  num-8           pic 9(6).\n     03  num-9           pic zz9.\n     03  Temp-String     pic x(43).\n     03  Temp-String2    pic x(20).\n*>\n*> Display fields from Binary data types.\n*>\n     03  WS-Next-Invoice pic 9(8).\n     03  WS-Vat-AC       pic 9(6).\n     03  WS-BL-Pay-Ac    pic 9(6).\n     03  WS-P-Creditors  pic 9(6).\n     03  WS-BL-Purch-Ac  pic 9(6).\n     03  WS-SL-Limit     pic 9(7).\n     03  WS-Next-Folio   pic 9(7).\n     03  WS-Cyclea       pic 99.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year.\n             07  ws-Year9    pic 9(4).               *> Added 15/01/18.\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n copy \"wstime.cob\".                                         *> used by ba000-Mapser (from stock.cbl)\n*>\n 01  WS-Locale              pic x(16)     value spaces.     *> Holds o/p from env var. LC_TIME but only uses 1st 5 chars\n 01  WS-Local-Time-Zone     pic 9         value 3.          *> Defaults to International, See comments below !\n*>\n*> Set WS-Local-Time-Zone ^~^ to one of these 88 values according to\n*>    your local requirements\n*> NOTE Environment var. LC_TIME is checked for \"en_GB\" for UK (1)\n*>                                          and \"en_US\" for USA (2)\n*>   at start of program.\n*>   For any other, you can add yours if different but let the Lead Programmer\n*>     know, so it can be added to the master sources otherwise default will\n*>      be Unix format\n*>\n*>    Note that 'implies' does NOT mean the program does anything e.g.,\n*>        changes page sizing in the report.\n*>\n     88  LTZ-Unix                         value 3. *> ccyy/mm/dd  Also implies A4 Paper for prints\n     88  LTZ-USA                          value 2. *> mm/dd/ccyy  [en_US] Also implies US Letter Paper for prints\n     88  LTZ-UK                           value 1. *> dd/mm/ccyy  [en_GB] Also implies A4 Paper for prints\n*>\n*> copy \"wsmaps01.cob\".  *> Removed functions for paswords for O/S versions.\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n copy \"wssystem.cob\".\n*>\n 01  WS-Temp-System-Record   pic x(1024).\n*>\n copy \"wsfinal.cob\".\n copy \"wssys4.cob\".\n copy \"wsdflt.cob\".\n*>\n 01  accept-terminator-array pic 9(4)            value zero.\n     copy \"screenio.cpy\".\n*>\n 01  line-1.\n     03  filler             pic x        value space.\n     03  l1-name            pic x(16).\n     03  filler             pic x(34)    value spaces.\n     03  filler             pic x(33)    value \"S Y S T E M   P A R A M E T E R S\".\n     03  filler             pic x(26)    value spaces.\n     03  line-1-date        pic x(10).\n     03  filler             pic x(6)     value spaces.\n     03  filler             pic x(4)     value \"Page\".\n     03  l1-page            pic z9.\n*>\n 01  line-3a.\n     03  filler             pic x(24)    value  spaces.\n     03  filler             pic x(16)    value \"User  Parameters\".\n     03  filler             pic x(40)    value  spaces.\n     03  filler             pic x(16)    value \"G/L   Parameters\".\n*>\n 01  line-3b.\n     03  filler             pic x(24)    value  spaces.\n     03  filler             pic x(16)    value \"ACAS  Parameters\".\n     03  filler             pic x(40)    value  spaces.\n     03  filler             pic x(16)    value \"P/L   Parameters\".\n*>\n 01  line-3c.\n     03  filler             pic x(24)    value  spaces.\n     03  filler             pic x(16)    value \"Inv.  Parameters\".\n     03  filler             pic x(40)    value spaces.\n     03  filler             pic x(16)    value \"S/L   Parameters\".\n*>\n 01  line-3d.\n     03  filler             pic x(24)    value  spaces.\n     03  filler             pic x(16)    value \"Stock Parameters\".\n     03  filler             pic x(40)    value spaces.\n     03  filler             pic x(16)    value \"IRS   Parameters\".\n*>\n 01  line-3d2.\n     03  filler             pic x(22)    value  spaces.\n     03  filler             pic x(18)    value \"Payroll Parameters\".\n     03  filler             pic x(40)    value spaces.\n     03  filler             pic x(16)    value \"RDMBS Parameters\".\n*>\n 01  line-3e.\n     03  filler             pic x(23)    value spaces.\n     03  filler             pic x(17)    value \"System Parameters\".\n     03  filler             pic x(56)    value spaces.\n*>\n 01  line-4.\n     03  l4-part1.\n         05  filler         pic x(24)    value  spaces.\n         05  l4-part1-star  pic x(16)    value  all \"*\".\n     03  l4-part2.\n         05  filler         pic x(40)    value  spaces.\n         05  l4-part2-star  pic x(16)    value  all \"*\".\n*>\n 01  line-5.\n     03  filler             pic x(10)    value  spaces.\n     03  l5-files.\n         05 l5-name         pic x(17)    value  spaces.\n         05 l5-data-1       pic x(43)    value  spaces.\n         05 filler  redefines  l5-data-1.\n            07  array-1     pic x        occurs  43.    *> 70\n         05 l5-data-2       pic x(62)    value  spaces.\n         05 filler  redefines  l5-data-2.\n            07  array-2     pic x        occurs  62.\n*>\n*> spaxx is used in space clearing for displays.\n*>\n 01  line-6.\n     03  spaxx              pic x(51)    value  spaces.\n     03  filler             pic x(30)    value  \"End of System Parameter Report\".\n*>\n 01  line-7.\n     03  filler             pic x(51)    value  spaces.\n     03  filler             pic x(30)    value  all \"=\".\n*>\n*> Last updated 18/12/24.\n*> 2023-04-20 vbc - Added SLautogn and PLautogn file04 & file30 for sales & Purchase\n*>                  respectively for recurring invoices.\n*> This was Effective 2024-03-15 :-\n*> 2024-09-01 vbc - Added BOSTKITM file-31 handles Back Order records from Sales invoicing\n*>                  Used in stock - st020 (stock additions), sl910 (sales invoicing) & sl970 BO reporting.\n*> 2024-12-18 vbc - tidied up file 31 entry.\n*>\n*> This acts as a list of files used within the ACAS system so any changes,  update this block !!\n*>       fillers with 'values space' can used for this purpose but could also be for SQL databases tables\n*>  [File/system numbers with * do not use RDB] As unused or Temporary files used between processes / programs.\n*>   C = Coding in progress.\n*>   Y = Completed coding not dry tested yet.\n*>   X = Completed with dry testing.\n*>   - = Will not be converted as temp type files.\n*>   ? = Not yet done.\n*>   sp = Not used.  [ sp = space ]\n*>\n*>01  ws-file-names.                                     *>     FH DAL created ?\n*>                Sys#  F#                                        LD   created ?\n*>    03  file00   0    10   pic x(16)     value \"system\".      X X X *> Used by all systems: SL, PL, ST, GL, IRS\n*>    03  filler             pic x(16)     value \"glwork\".      - - - *>  DOES NOT APPEAR TO BE USED in general (maybe temp ?)\n*>    03  file02   *    *    pic x(16)     value \"archive\".     - - - *> General - Online and offline copies?\n*>    03  file03   *    *    pic x(16)     value \"final\".       - - - *> General temp file in gl120 P&L print\n*>    03  file04   3    16   pic x(16)     value \"slautogn\".    C - C *>   Sales Recurring invoices\n*>    03  file05   2    11   pic x(16)     value \"ledger\".      X X X *> General\n*>    03  file06   2    12   pic x(16)     value \"posting\".     X X X *> General & Sales & Purchase\n*>    03  file07   2    13   pic x(16)     value \"batch\".       X X X *> General & Sales & Purchase\n*>    03  file08   1    15   pic x(16)     value \"postings2irs\".X X X *>   Sales & Purchase\n*>    03  file09   *    *    pic x(16)     value \"tmp-stock\".   - - - *>  Stock temp file\n*>    03  file10   5    13   pic x(16)     value \"staudit\".     X X X *>  Stock\n*>    03  file11   5    12   pic x(16)     value \"stockctl\".    X X X *>  Stock - RDB\n*>    03  file12   3    11   pic x(16)     value \"salesled\".    X X X *>   Sales & Stock (used in??)\n*>    03  file13   6    13   pic x(16)     value \"value\".       X X X *>   Sales & Purchase\n*>    03  file14   6    12   pic x(16)     value \"delivery\".    X X X *>   Sales & Purchase\n*>    03  file15   6    12   pic x(16)     value \"analysis\".    X X X *>   Stock & Purchase\n*>    03  file16   3    12   pic x(16)     value \"invoice \".    X X X *>   Sales\n*>    03  file17   3    13   pic x(16)     value \"delinvno\".    X X X *>   Sales\n*>    03  file18   3*   14*  pic x(16)     value \"openitm2\".    - - - *>   Sales  Temp file (sl055 -> sl060)\n*>    03  file19   3    15   pic x(16)     value \"openitm3\".    X X X *>   Sales\n*>    03  file20   *    *    pic x(16)     value \"oisort\".      - - - *>   Sales\n*>    03  file21   *    *    pic x(16)     value \"work\".        - - - *>   Sales, Purchase & General (temp)\n*>    03  file22   4    11   pic x(16)     value \"purchled\".    X X X *>   Purchase & Stock (used in??)\n*>    03  file23   4    13   pic x(16)     value \"delfolio\".    X X X *>   Purchase\n*>    03  file24   *    *    pic x(16)     value space.         - - - *> General - dummy for gl080\n*>    03  filler             pic x(16)     value space.               *>  UNUSED\n*>    03  file26   4    12   pic x(16)     value \"pinvoice\".    Y Y Y *>   Purchase\n*>    03  file27   *    *    pic x(16)     value \"poisort\".     - - - *>   Purchase\n*>    03  file28   4*   14*  pic x(16)     value \"openitm4\".    - - - *>   Purchase  temp file (pl055 -> pl060)\n*>    03  file29   4    15   pic x(16)     value \"openitm5\".    Y Y Y *>   Purchase\n*>    03  file30   4    18   pic x(16)     value \"plautogn\".    ? ? ? *>   Purchase Recurring invoices/folios\n*>    03  file31   *    *    pid x(16)     value \"bostkitm\"     - - - *>   Sales Back Orders [ File only as temp file ]\n*>    03  file32   4    16   pic x(16)     value \"pay     \".    X X X *>   Purchase\n*>    03  file33   *    *    pic x(16)     value \"cheque.dat\".  ?     *>   Purchase  temp file.\n*>  IRS files added 19/10/16 & 12/16 (38)\n*>    03  file34   1    11   pic x(16)     value \"irsacnts.dat\".X X X *>   IRS ex file 1 renamed\n*>    03  file35   1    12   pic x(16)     value \"irsdflt.dat\". X X X *>   IRS ex file 3 renamed\n*>    03  file36   1    13   pic x(16)     value \"irspost.dat\". X X X *>   IRS ex file 4 renamed\n*>    03  file37   1    14   pic x(16)     value \"irsfinal.dat\".X X X *>   IRS ex file 5 renamed\n*>    03  file38   *    *    pic x(16)     value \"postsort.dat\".- - - *>   IRS ex irs055 TEMP sort file.\n*>\n*>01  filler     redefines ws-file-names.\n*>    03  ws-file            pic x(16)   occurs 39.          *> change to 38 - there is a file 0 (system)\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY005    pic x(18) value \"SY005 Invalid Date\".\n     03  SY006    pic x(62) value \"SY006 Program Arguments limited to two and you have specified \".\n     03  SY007    pic x(35) value \"SY007 Program arguments incorrect: \".\n     03  SY008    pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY009    pic x(53) value \"SY009 Environment variables not yet set up : ABORTING\".\n     03  SY010    pic x(59) value \"SY010 Problem with opening system file. Hit return to clear\".\n     03  SY044    pic x(66) value \"SY044 The system has detected an unauthorised change of user name.\".\n     03  SY045    pic X(40) value \"SY045 Contact your Supplier or Sys Admin\".\n*> Module Specific\n     03  SY101    pic x(21) value \"SY101 Open I-O Err = \".\n     03  SY102    pic x(19) value \"SY102 Read Err 1 = \".\n     03  SY103    pic x(22) value \"SY103 Rewrite Err 1 = \".\n     03  SY104    pic x(26) value \"SY104 Fix and Press Enter\".\n     03  SY105    pic x(16) value \"SY105 Lines > 28\".\n     03  SY106    pic x(34) value \"SY106 Error on systemMT processing\".\n     03  SY107    pic x(32) value \"SY107 Error on dfltMT processing\".\n     03  SY108    pic x(32) value \"SY108 Error on sys4MT processing\".\n     03  SY109    pic x(33) value \"SY109 Error on finalMT processing\".\n     03  SY110    pic x(29) value \"SY110 Rerun Parameter Set up?\".\n     03  SY111    pic x(38) value \"SY111 Print Spool Name must be defined\".\n*>\n     03  SY902    pic x(32) value \"SY902 Program Error: Temp rec = \".\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n*>\n copy \"wsnames.cob\".\n*> So this block is not needed.\n*>\n *> here deliberately and a dummy in linkage\n*> Now that ALL modules use the full version next can go.\n*>\n*> 01  dummy-file-defs.    *>    Dummy for the sub-system main module to call\n*>     03  filler      pic x(532) occurs 35.\n*>     03  Filler      binary-short  value zero.\n*>\n screen section.\n*>=============\n*>\n*> All encryption sub-systems removed, ditto all high security code\n*>\n 01  Banner        foreground-color 2.\n     03  pic x(16) from prog-name                  line  1 col  1.\n     03  value \"S y s t e m   S e t - U p\"                 col 28.\n     03  from line-1-date  pic x(10)                       col 71.\n     03  value \"++++++++++\"                        line  3 col  1.\n     03  value \"+Screen \"                          line  4 col  1.\n     03  screen-nos       pic 9                            col  9.\n     03                   pic x value \"+\"                  col 10.\n     03  value \"++++++++++\"                        line  5 col  1.\n*>\n 01  User-Data       foreground-color 2.\n     03          value \"Name\"                      line  7 col  1.\n     03          value \"- {\"                               col  9.\n     03  from usera       pic x(32)                        col 12.\n     03          value \"}\"                                 col 44.\n     03          value \"Address - [\"               line  8 col  1.\n     03  using address-1  pic x(24)                        col 12.\n     03          value \"]\"                                 col 36.\n     03          value \"[\"                         line  9 col 11.\n     03  using address-2  pic x(24)                        col 12.\n     03          value \"]\"                                 col 36.\n     03          value \"[\"                         line 10 col 11.\n     03  using address-3  pic x(24)                        col 12.\n     03          value \"]\"                                 col 36.\n     03          value \"[\"                         line 11 col 11.\n     03  using address-4  pic x(24)                        col 12.\n     03          value \"]\"                                 col 36.\n     03          value \"Post Code [\"               line 12 col  1.\n     03  using Post-Code  pic x(12)                        col 12.\n     03          value \"]\"                                 col 24.\n     03          value \"Country - [\"               line 13 col  1.\n     03  using Country    pic x(24)                        col 12.\n     03          value \"]\"                                 col 36.\n     03          value \"Date Format   \"            line 14 col  1.\n     03          value \"- [\"                               col 15.\n     03  using Date-Form  pic 9                            col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = UK, 2 = USA, 3 = Intl)\"     col 20.\n     03          value \"Controls the next 2 fields\"        col 50. *> 03/04/23 - bad pos.\n     03          value \"Period :  Start Date - [\"  line 15 col  1.\n     03  using p-start    pic x(10)                        col 25.\n     03          value \"]\"                                 col 35.\n     03          value \"End   Date - [\"            line 16 col 11.\n     03  using p-end      pic x(10)                        col 25.\n     03          value \"]\"                                 col 35.\n     03          value \"Stats Year [\"                      col 40.   *> 15/01/18.\n     03  using Stats-Date-Period pic 9(4)                  col 52.\n     03          value \"]\"                                 col 56.   *> 03/02/18\n     03          value \"System Print Lines   -\"    line 17 col  1.\n     03          value \"[\"                                 col 24.\n     03  using Page-Lines pic 999                          col 25.\n     03          value \"]\"                                 col 28.\n     03          value \"  (for Laser = 056)\"               col 30.\n *>    03          value \"[\"                                 col 41.\n *>    03  using Page-Lines-Land pic 999                     col 42.  *> Page-Lines-Land needs to be created..\n *>    03          value \"]\"                                 col 45.\n     03          value \"Vat Rates : (1)\"           line 18 col  1.\n     03          value \"- [\"                               col 22.\n     03  using vat-rate-1 pic 99.99                        col 25.\n     03          value \"]\"                                 col 30.\n     03          value \"Local Tax : (4)\"                   col 40.\n     03          value \"- [\"                               col 57.\n     03  using vat-rate-4 pic 99.99                        col 60.\n     03          value \"]\"                                 col 65.\n     03          value \"(2)\"                       line 19 col 13.\n     03          value \"- [\"                               col 22.\n     03  using vat-rate-2 pic 99.99                        col 25.\n     03          value \"]\"                                 col 30.\n     03          value \"Local Tax : (5)\"                   col 40.\n     03          value \"- [\"                               col 57.\n     03  using vat-rate-5 pic 99.99                        col 60.\n     03          value \"]\"                                 col 65.\n     03          value \"(3)\"                       line 20 col 13.\n     03          value \"- [\"                               col 22.\n     03  using vat-rate-3 pic 99.99                        col 25.\n     03          value \"]\"                                 col 30.\n     03          value \"Current Cycle\"                     col 40.\n     03          value \"- [\"                               col 58.\n     03  using ws-cyclea  pic 99                           col 61.\n     03          value \"]\"                                 col 63.\n     03          value \"VAT Reg no - [\"            line 21 col  1.\n     03  using VAT-Reg-Number  pic x(11)                   col 15.\n     03          value \"]\"                                 col 26.\n     03          value \" Printed [\"                        col 27.\n     03  using SL-VAT-Printed                              col 37.\n     03          value \"]\"                                 col 38.\n     03          value \"Current Quarter\"           line 21 col 40.\n     03          value \"- [\"                               col 58.\n     03  using current-quarter pic 99                      col 61.\n     03          value \"]\"                                 col 63.\n     03          value \"Comp. Email Address [\"   line 22 col  1.  *> 21 chars\n     03  using Company-Email  pic x(30)                    col 22.\n     03          value \"]\"                                 col 52.\n*>     03          value \"Pass-Word\"                 line 22 col 60.\n*>     03          value \"- [\"                               col 70.\n*>     03  using s-pass-word pic x(4)                        col 73.\n*>     03          value \"]\"                                 col 77.\n     03          value \"Data File Handling\"        line 23 col  1.\n     03          value \"- [\"                               col 22.\n     03  using File-System-Used pic 9                      col 25.\n     03          value \"]\"                                 col 26.\n     03          value \"(Range 0/1)\"                       col 28. *> char 39\n*>     03          value \"(Range 0/5)\"                       col 28.  *> NOT IN USE\n     03          value \"Cycle Period\"                      col 41.  *> 12 chars\n     03          value \"- [\"                               col 59.  *> 3 chars\n     03  using period     pic 99                           col 62.  *> 2 chars\n     03          value \"] Wk=13, Mth=03\"                   col 64.  *> 15 chars = 32\n     03          value \"Escape to quit\"            line 24 col 02.\n*>\n 01  Verify-Screen   foreground-color 2.\n     03         value \"**************************\" line 11 col 54.\n     03          value \"*\"                         line 12 col 54.\n     03          value \"*\"                                 col 79.\n     03          value \"*\"                         line 13 col 54.\n     03  verify-message  pic x(24)                         col 55.\n     03          value \"*\"                                 col 79.\n     03          value \"*\"                         line 14 col 54.\n     03          value \"*\"                                 col 79.\n     03          value \"* OK to file (Y/N) - [\"    line 15 col 54.\n     03          value \"] *\"                               col 77.\n     03          value \"*\"                         line 16 col 54.\n     03          value \"                        \"          col 55.\n     03          value \"*\"                                 col 79.\n     03         value \"**************************\" line 17 col 54.\n*>\n 01  OPS-Data       foreground-color 2.\n     03      value \"Restrict ACAS Params access [\" line 15 col 2.\n     03  using Param-Restrict     pic X                    col 31.\n     03          value \"]  (Y/N)\"                          col 32.\n     03          value \"Single/Multi-User - [\"     line 17 col 02.\n     03  using host      pic 9                     line 17 col 23.\n     03          value \"]  (0=Single, 1=Multi)\"    line 17 col 24.\n     03          value \"Operating System \"         line 19 col 02.\n     03          value \"- [\"                       line 19 col 20.\n     03  using op-system  pic 9                    line 19 col 23.\n     03          value \"]\"                         line 19 col 24.\n     03          value \"(1=Dos, 2=Windows,\" &\n          \" 3=Mac, 4=OS/2, 5=Unix, 6=Linux)\"       line 19 col 27.\n     03          value \"Data capture System \"      line 21 col 02.\n     03          value \"- [\"                               col 22.\n     03  using Data-Capture-Used  pic 9                    col 25.\n     03          value \"] 0=Std, 1=GUI, 2=Widget\"          col 26.\n*>\n 01  OPS-Data-2     foreground-color 2.\n     03        value \"Cups Print Spooler name 1 - [\" line 21 col 02.\n     03  using Print-Spool-Name  pic x(48)                 col 31.\n     03        value \"]\"                                   col 79.\n     03        value \"Cups Print Spooler name 2 - [\" line 22 col 02.\n     03  using Print-Spool-Name2 pic x(48)                 col 31.\n     03        value \"]\"                                   col 79.\n     03        value \"Cups Print Spooler name 3 - [\" line 23 col 02.\n     03  using Print-Spool-Name3 pic x(48)                 col 31.\n     03        value \"]\"                                   col 79.\n*>\n 01  OPS-Data-3     foreground-color 2.\n     03          value \"RDB Schema name - [\"        line 7 col 02.\n     03  using RDBMS-DB-Name   pic x(12)                   col 21.\n     03          value \"] (ACASDB)\"                        col 33.\n     03          value \"DB Username - [\"            line 8 col 02.\n     03  using RDBMS-User      pic x(12)                   col 17.\n     03          value \"]\"                                 col 29.\n     03          value \"DB User Password - [\"       line 9 col 02.\n     03  using RDBMS-Passwd    pic x(12)                   col 22.\n     03          value \"] \"                                col 34.\n     03          value \"RDB Host - [\"              line 10 col 02.\n     03  using RDBMS-Host      pic x(32)                   col 14.\n     03          value \"] {localhost}\"                     col 46.\n     03          value \"RDB Socket - [\"            line 11 col 02.\n     03  using RDBMS-Socket    pic x(64)                   col 16.\n     03          value \"]\"                                 col 80.\n     03          value \"RDB Port - [\"              line 12 col 02.\n     03  using RDBMS-Port      pic x(5)                    col 14.\n     03          value \"] {3306 }\"                         col 19.\n*>\n 01  GL-Data   foreground-color 2.\n     03        value \"Profit Centres/Branches - [\" line  7 col  1.\n     03  using p-c       pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (P or B or space)\"               col 30.\n     03          value \"P.C./Branches Level\"       line  8 col  1.\n     03          value \"- [\"                               col 25.\n     03  using p-c-level pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (R=Revenue, Space)\"              col 30.\n     03        value \"P.C./Branches Grouped ? - [\" line  9 col  1.\n     03  using p-c-grouped  pic x                          col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Grouped or Space)\"            col 30.\n     03          value \"Comparatives ?\"            line 10 col  1.\n     03          value \"- [\"                               col 25.\n     03  using comps     pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes or Space)\"                col 30.\n     03          value \"Ledger Name Index ?\"       line 11 col  1.\n     03          value \"- [\"                               col 25.\n     03  using ledger-2nd-index pic x                      col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes or Space)\"                col 30.\n     03          value \" [Not currently used]\"             col 50.\n     03          value \"Minimum Validation ?\"      line 12 col  1.\n     03          value \"- [\"                               col 25.\n     03  using m-v       pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes or Space)\"                col 30.\n     03          value \"Archiving ?\"               line 13 col  1.\n     03          value \"- [\"                               col 25.\n     03  using arch      pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes or Space)\"                col 30.\n     03          value \"Sales Range\"               line 14 col  1.\n     03          value \"- [\"                               col 25.\n     03  using Sales-Range pic 9                           col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"Purchase Range\"            line 15 col  1.\n     03          value \"- [\"                               col 25.\n     03  using Purchase-Range pic 9                        col 28.\n     03          value \"]\"                                 col 29.\n     03        value \"Automatic VAT Posting ? - [\" line 16 col  1.\n     03  using vat       pic x                             col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes or Space)\"                col 30.\n     03          value \"Next Batch Number\"         line 17 col  1.\n     03          value \"- [\"                               col 21.\n     03  using num-6 pic 9(5)                              col 24.\n     03          value \"]\"                                 col 29.\n*>     03   value \"----------\"                       line 18 col  1.\n     03        value \"Use IRS instead of GL ? - [\" line 19 col  1.\n     03  using IRS-Instead                                 col 28.\n     03          value \"]\"                                 col 29.\n     03          value \"  (Y=Yes | N=No) B=Both\"           col 30.\n*>\n 01  PL-Data   foreground-color 2.\n     03          value \"Delimiter\"                 line 14 col  1.\n     03          value \"- [\"                               col 15.\n     03  using PL-Delim pic x                              col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"Purch/Stock Link  [\"       line 15 col  1.\n     03  using PL-Stock-Link pic x                         col 20.\n     03          value \"]\"                                 col 21.\n     03          value \"Next Folio Number [\"       line 16 col  1.\n     03  using WS-Next-Folio pic 9(8)                      col 20.\n     03          value \"]\"                                 col 28.\n     03          value \"Next Batch Number [\"       line 17 col  1.\n     03  using BL-Next-Batch  pic 9(5)                     col 20.\n     03          value \"]\"                                 col 25.\n     03         value \"Pay Account       [\"        line 18 col  1.\n     03  using WS-BL-Pay-Ac   pic 9(6)                     col 20.\n     03          value \"]\"                                 col 26.\n     03         value \"Ledger Account    [\"        line 19 col  1.\n     03  using WS-BL-Purch-Ac pic 9(6)                     col 20.\n     03          value \"]\"                                 col 26.\n     03         value \"Creditor Account  [\"        line 20 col  1.\n     03  using WS-P-Creditors   pic 9(6)                   col 20.\n     03          value \"]\"                                 col 26.\n*>\n 01  SL-Data   foreground-color 2.\n     03          value \"Late Letters\"              line  7 col  1.\n     03          value \"- [\"                               col 15.\n     03  using sl-dunning pic 9                            col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n     03          value \"Late Charges\"              line  8 col  1.\n     03          value \"- [\"                               col 15.\n     03  using sl-charges pic 9                            col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n     03          value \"Credit Period - [\"         line  9 col  1.\n     03  using sl-credit pic 99                            col 18.\n     03          value \"]\"                                 col 20.\n     03          value \"Discount\"                  line 10 col 1.\n     03          value \"- [\"                               col 15.\n     03  using sl-disc pic 99.99                           col 18.\n     03          value \"]\"                                 col 23.\n     03          value \"Min Late Bal\"              line 11 col  1.\n     03          value \"- [\"                               col 15.\n     03  using sl-min pic 9(4)                             col 18.\n     03          value \"]\"                                 col 22.\n     03          value \"Max Late Charge [\"         line 12 col  1.\n     03  using sl-max pic 9(4)                             col 18.\n     03          value \"]\"                                 col 22.\n     03          value \"Credit Limit\"              line 13 col  1.\n     03          value \"- [\"                               col 15.\n     03  using WS-SL-Limit pic 9(7)                        col 18.\n     03          value \"]\"                                 col 25.\n     03          value \"Delimiter\"                 line 14 col  1.\n     03          value \"- [\"                               col 15.\n     03  using sl-delim pic x                              col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (Address lines)\"                 col 20.\n     03          value \"Own Inv. Nos\"              line 15 col  1.\n     03          value \"- [\"                               col 15.\n     03  using sl-own-nos pic x                            col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"Next Invoice Number [\"     line 16 col  1.\n     03  using WS-Next-Invoice pic 9(8)                    col 22.\n     03          value \"]\"                                 col 30.\n     03          value \"Items per Invoice - [\"             col 41.\n     03  using SL-Invoice-Lines pic 99                     col 62.\n     03          value \"]\"                                 col 64.\n     03          value \"Late Charge % - [\"         line 17 col  1.\n     03  using sl-late-per pic 9.99                        col 18.\n     03          value \"]\"                                 col 22.\n     03          value \"Next Batch Number [\"       line 18 col  1.\n     03  using first-sl-batch pic 9(5)                     col 20.\n     03          value \"]\"                                 col 25.\n     03          value \"Sales/Stock Link  [\"       line 19 col  1.\n     03  using SL-Stock-Link  pic x                        col 20.\n     03          value \"]\"                                 col 21.\n     03          value \"BO Link - [\"                       col 25.\n     03  using SL-BO-Flag     pic x                        col 36.\n     03          value \"]\"                                 col 37.\n     03          value \"BO Default - [\"                    col 45.\n     03  using SL-BO-Default  pic x                        col 59.\n     03          value \"]\"                                 col 60.\n     03          value \"Pay Account    -  [\"       line 20 col  1.\n     03  using SL-Pay-Ac      pic 9(6)                     col 20.\n     03          value \"]\"                                 col 26.\n     03          value \"Ledger Account -  [\"       line 21 col  1.\n     03  using SL-Sales-Ac    pic 9(6)                     col 20.\n     03          value \"]\"                                 col 26.\n     03          value \"Debtors Account - [\"       line 22 col  1.\n     03  using S-Debtors      pic 9(6)                     col 20.\n     03          value \"]\"                                 col 26.\n     03          value \"VAT Account   - [\"         line 23 col  1.\n     03  using ws-VAT-ac         pic 9(6)                  col 18.\n     03          value \"]\"                                 col 24.\n*>\n 01  SL-Data-2   foreground-color 2.\n     03  value \"Select what report types, company details will be printed to\"\n                                                   line  7 col 01.\n     03          value \"    Invoices   - [\"        line  8 col 01.\n     03  using SL-Comp-Head-Inv   pic x                    col 19.\n     03          value \"]\"                                 col 20.\n     03          value \"    Statements - [\"        line  9 col 01.\n     03  using SL-Comp-Head-Stat  pic x                    col 19.\n     03          value \"]\"                                 col 20.\n     03          value \"  Late Letters - [\"        line 10 col 01.\n     03  using SL-Comp-Head-Lets  pic x                    col 19.\n     03          value \"]\"                                 col 20.\n     03          value \"Delivery Notes - [\"        line 11 col 01.\n     03  using SL-Comp-Head-Pick  pic x                    col 19.\n     03          value \"]\"                                 col 20.\n*>\n 01  Stock-Data   foreground-color 2.\n     03          value \"Debugging     \"            line  7 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-debug      pic 9                        col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n     03          value \"Bomp/Wip used \"            line  9 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-Manu-Used  pic 9                        col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n*>\n     03          value \"Order Entry   \"            line 10 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-OE-Used    pic 9                        col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n*>\n     03          value \"Stock BO Flag \"            line 11 col  1.\n     03          value \"- [\"                               col 15.\n     03  using Stk-BO-Active  pic x                        col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (Y = Yes or N)\"                  col 20.\n*>\n *> ALWAYS ON FOR BOTH.  14/03/18\n*>     03          value \"Audit Used    \"            line 11 col  1.\n*>     03          value \"- [\"                               col 15.\n*>     03  using stk-Audit-Used pic 9                        col 18.\n*>     03          value \"]\"                                 col 19.\n*>     03          value \"  (1 = Yes or 0)\"                  col 20.\n*>     03          value \"Audit Movement\"            line 12 col  1.\n*>     03          value \"- [\"                               col 15.\n*>     03  using stk-Mov-Audit  pic 9                        col 18.\n*>     03          value \"]\"                                 col 19.\n*>     03          value \"  (1 = Yes or 0)\"                  col 20.\n     03          value \"Current Period\"            line 13 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-Period-Cur pic x                        col 18.\n     03          value \"]\"                                 col 19.\n     03   value \"  (W=Weekly, M=Monthly, Q=Quarterly)\"     col 20. *>   14/03/18\n     03          value \"To Date Period\"            line 14 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-Period-Dat pic x                        col 18.  *> chk where used and how\n     03          value \"]\"                                 col 19.\n     03   value \"  (M=Monthly, Q=Quarterly, Y=Yearly)\"     col 20.\n     03          value \"Ave Valuation\"             line 15 col  1.\n     03          value \"- [\"                               col 15.\n     03  using stk-Averaging  pic 9                        col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (1 = Yes or 0)\"                  col 20.\n     03          value \"Next 2, See Manual First\"  line 17 col  1.\n     03          value \"Activity Rep \"             line 18 col  1.\n     03          value \"- [\"                               col 15.\n     03  using Stk-Activity-Rep-Run pic 9                  col 18.\n     03          value \"]\"                                 col 19.\n     03          value \"  (0 = No or 1) leave as 0\"        col 20.\n     03          value \"Audit Number \"             line 19 col  1.\n     03          value \"- [\"                               col 15.\n     03  using Stk-Audit-No pic 999                        col 18.\n     03          value \"]\"                                 col 21.\n     03   value \"  (if 1st time = 0, else leave as is)\"    col 23.\n*>\n*>   IRS Screen  any other IRS data as other needed is from ACAS\n*>      params already requested and/or created.\n*>\n 01  IRS-Data.\n     03          value \"IRS Client    Name - [\"    line  7 col  1.\n     03  using Client  pic x(24)                           col 23.\n     03          value \"]\"                                 col 47.\n     03          value \"P/L Appropriation or Capital A/C [\"\n                                                   line  9 col  1.\n     03  using PL-Approp-AC  pic 9(6)                      col 35.\n     03          value \"]\"                                 col 41.\n*>\n procedure division using ws-calling-data\n                          file-defs.\n*>=======================================\n*>\n init01   section.\n*>*****\n Init01-Main.\n*>\n     if       Used-Once = zero                    *> Make sure we only do this once per run / caller program\n              move 1 to Used-Once\n              perform  zz020-Get-Program-Args.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     move     prog-name to l1-name.\n     display  \"System Parameters\" at 0130 with foreground-color 2.\n*>\n*>  Quick test that temp system rec =>  system-record.\n*>\n     move     function Length (WS-Temp-System-Record) to AA-Size.\n     move     function length (System-Record)         to BB-Size.\n     if       AA-Size < BB-Size\n                       move spaces to Display-Blk\n                       string SY902           delimited by size\n                              AA-Size         delimited by size\n                              \" < \"           delimited by size\n                              \"System-Rec = \" delimited by size\n                              BB-Size         delimited by size\n                                         into Display-Blk\n                       end-string\n                       display Display-Blk at 2301 with erase eol     *> BUT WILL REMIND ME TO SET IT UP correctly\n                       display SY008 at 2401 with erase eol\n                       accept Accept-Reply at 2433\n                       move   24 to Return-Code\n                       goback                     *> not yet tested in callers\n     end-if.\n*>\n*>  WE process for the Cobol parameter file first and if RDB in use\n*>    copy/update the system record to the rdb SYSTEM-REC table\n*>\n     move     zero  to File-System-Used           *> In System-Record\n                       File-Duplicates-In-Use.    *> Force Cobol proc.\n     move     \"00\"  to FA-RDBMS-Flat-Statuses.    *> in fnctn (file-access)\n     move     1 to File-Key-No.                   *> system record\n     perform  acas000-Open-Input.                 *> as input as I/O will create if not present.\n     if       fs-reply not = zero\n *>             perform acas000-close            *> Could produce an error, why ?\n              perform ba000-mapser                *> Now done here instead of in caller,\n              perform acas000-open                *>   see Proc-ACAS-Mapser-RDB.cob\n     end-if.\n     perform  acas000-Close.\n     perform  acas000-Open.                       *> as I/O\n     move     SY101 to fs-action.\n     perform  disk-error-display.                 *> must now exist but JIC\n*>\n     move     1 to File-Key-No.                   *> system record read in as area may be overwritten\n     perform  acas000-Read-Indexed.               *> Cobol file\n     if       fs-reply not = zero\n              move SY102 to FS-Action\n              perform  disk-error-display         *> must now exist but JIC\n              move 99 to fs-reply\n              perform acas000-Close\n              move   16 to Return-Code\n              goback                              *> not yet tested for in callers\n     end-if.\n*>                                                *> Got Cobol param record.\n     move     run-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     u-date  to  to-day.\n     move     ws-date to  ws-test-date            *>  ws-date and now ws-test-date for display\n                          line-1-date.            *>      and printing\n     perform  User-Params.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              perform acas000-Close\n              go to Main-Exit.\n     perform  System-Params.\n*>\n     if       G-L\n              perform  Gl-Params.\n*>\n     if       S-L\n              perform  Sl-Params.\n*>\n     if       B-L\n              perform  Pl-Params.\n*>\n     if       Stock\n              perform  Stock-Params.\n*>\n     if       IRS-Entry-Block (1:10) = spaces\n              initialise IRS-Entry-Block with filler\n     end-if.\n*>\n     if       IRS\n              perform IRS-Params\n     end-if.\n*>\n*>   Omitted systems for O/S versions.\n*>\n*>     if       Order-Entry\n*>              perform  OE-Params.\n*>     if       EPOS-Entry\n*>              perform  EPOS-Params.\n*>     if       Payroll\n*>              perform  Payroll-Params.\n*>     if       Project-Z\n*>              perform Project-Z-Params.\n*>     if       Auto-Vat-Returns\n*>              perform Vat-Return-Params.\n*>\n     perform  Print-Params.\n*>\n*>-----------------------------------------------------------------------\n*> WARNING: SL data and PL data reduced print, eg Not all data is printed\n*>               - Consider make full?\n*>-----------------------------------------------------------------------\n*>\n*>  Bypass security check for Open Source version\n*>\n     go       to Menu-Option.\n*>\n*>\n*> now verify user name not changed.\n*>\n*>     move     usera  to  pass-name.\n*>     move     \"N\"  to  encode.\n*>     call     \"maps01\"  using  maps01-ws.   *> OS modified version, reduced encrypted\n*>              go to  menu-option.           *>   from 1024 bytes/char to 4, simple.\n*>     if       pass-name = user-code         *>  Dropped altogether.\n*>\n*> if here user name does not match encoded name. Possible\n*> un-authorised usage.\n*>\n*>     display  \" \" at 0101 with erase eos.\n*>     display  SY044 at 0501 with foreground-color 4.\n*>     display  SY045 at 0601 with foreground-color 4.\n*>     move     1 to error-code.\n*>     call     \"maps99\" using error-code ws-calling-data.\n*>     go       to main-exit.\n*>\n Menu-Option.\n*>----------\n*>\n     display  \" \" at 0101 with erase eos.\n     if       System-Record-Version-Prime = zero\n              move ws-Sys-Record-Ver-Prime to System-Record-Version-Prime\n     end-if\n*>\n     move     System-Record to WS-Temp-System-Record.  *> Writing others will clears the record\n*>\n     move     1 to File-Key-No.               *> file still open.\n     perform  acas000-Rewrite.                *> update system-record for Cobol file\n     move     SY103 to fs-action.\n     perform  disk-error-display.\n*>\n*>  Now check if we are doing RDB if not skip otherwise\n*>  update / insert row to SYSTEM-REC before closing file so we\n*>  dont lose the data in system-file.\n*>\n     perform  acas000-Close.                  *> cobol file\n     if       FS-Cobol-Files-Used             *> In S-R, so no RDBMS in use\n              go to We-Are-Done\n     end-if\n     if       File-System-Used = zero         *> Insurance\n              go to We-Are-Done\n     end-if.\n*>\n*>  First set up for RDB\n*>\n     move     zeros to FS-Reply WE-Error.\n     move     RDBMS-DB-Name to DB-Schema.\n     move     RDBMS-User    to DB-UName.\n     move     RDBMS-Passwd  to DB-UPass.\n     move     RDBMS-Port    to DB-Port.\n     move     RDBMS-Host    to DB-Host.\n     move     RDBMS-Socket  to DB-Socket.\n*>\n     move     \"66\" to FA-RDBMS-Flat-Statuses.     *> Force RDB processing in wsfnctn\n     move     1 to File-Key-No.\n     perform  acas000-Open.                       *> open rdb I/O\n*>\n*> THIS BLOCK INCLUDES TEST CODE\n*>\n     if       fs-reply not = zero                 *> might have made a mistake in the RDB params\n              move    FS-Reply to WS-Saved-FS-Reply\n              display \"File status=\" at 1301\n              display FA-RDBMS-Flat-Statuses at 1313\n              display \"RDB data = \" at 1401\n              display RDBMS-DB-Name at 1501\n              display RDBMS-User    at 1601\n              display RDBMS-Passwd  at 1701\n              display RDBMS-Port    at 1801\n              display RDBMS-Host    at 1901\n              display RDBMS-Socket  at 2001\n              display SY106 at 2201  with erase eol\n              display \"Error was = \" at 2301 with erase eol\n              display WS-Saved-FS-Reply at 2313\n              display \"WE-Error=\" at 2321\n              display WE-Error at 2330\n              display \"on para = \" at 2336\n              display WS-No-Paragraph at 2347\n              display SY110 at 2401 with erase eol\n              perform acas000-Close\n              accept  WS-Reply at 2433            *> Redo setup process?\n              if      WS-Reply = \"Y\" or \"y\"\n                      go to Init01-Main\n              else\n                      go to We-Are-Done           *> Allow user to work out whats wrong\n     end-if.\n*>\n*> RDB now open so In RDB tables\n*>\n     move     WS-Temp-System-Record to System-Record.  *> restore param rec.\n*>\n     move     \"66\" to FA-RDBMS-Flat-Statuses.     *> Force RDB processing\n     move     1 to File-Key-No.\n     perform  acas000-Rewrite.\n     perform  aa100-Check-4-Errors thru aa100-Exit.\n     if       fs-reply not = zero             *> Creating RDB for 1st time\n              perform acas000-write\n              perform  aa100-Check-4-Errors thru aa100-Exit\n     end-if\n*>\n*> This code block should never be run as SW's are always 0\n*>\n     if       Init-Default-File-SW = 1\n              move    2 to File-Key-No\n              move    Default-Record to System-Record\n              perform acas000-Rewrite\n              perform aa101-Check-4-Errors thru aa101-Exit\n     end-if\n     if       Init-Final-File-SW = 1\n              move    3 to File-Key-No\n              move    Final-Record to System-Record\n              perform acas000-Rewrite\n              perform aa103-Check-4-Errors thru aa103-Exit\n     end-if\n     if       Init-Sys4-File-SW = 1\n              move    4 to File-Key-No\n              move    System-Record-4 to System-Record\n              perform acas000-Rewrite\n              perform aa102-Check-4-Errors thru aa102-Exit\n     end-if.\n     perform  acas000-Close.\n*>\n We-Are-Done.\n*>\n*>  Now write any RDB tables if flags say records created for dflt, final and sys4.\n*>\n     move     zero to ws-term-code.\n     go       to main-exit.\n*>\n Disk-Error-Display.\n     if       fs-reply not = zero\n              display fs-action at 0310\n              display fs-reply at 0333\n              display space at 0410\n              display  SY104 at 2401\n              accept   fs-reply at 2420\n     end-if.\n*> 05/02/18\n*> Disk-Error.\n*>     display  SY104 at 2401.\n*>     accept   fs-reply at 2420.\n*>\n Main-Exit.\n     exit program.\n*>\n User-Params      section.\n*>=======================\n*>\n*>**************************************\n*>  User Parameters Amendment Routine  *\n*>**************************************\n*>\n Main-User.\n*>********\n*>\n     move     1 to screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner with erase eos.\n     display  \"User Data\" at 0436 with foreground-color 2.\n*>\n     if       start-date not = zero\n              move  start-date  to  u-bin\n              perform zz060-Convert-Date\n              move  ws-date  to  p-start\n     else\n              move spaces to p-start\n     end-if\n     if       end-date not = zero\n              move  end-date  to  u-bin\n              perform zz060-Convert-Date\n              move  ws-date  to  p-end\n     else\n              move spaces to p-end\n     end-if\n *>    move     spaces  to  pass-word of maps01-ws s-pass-word.\n     move     Cyclea  to WS-Cyclea.\n*>\n     display  user-data at 0101 with foreground-color 2.\n*>\n User-Data-Accept.\n     accept   user-data with update.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to Main-Exit.\n*>\n     if       Date-Form = 1\n              display \"    Using UK format dd/mm/ccyy  \" at 1420 with erase eol foreground-color 3\n     else\n      if      Date-Form = 2\n              display \"    Using USA format mm/dd/ccyy \" at 1420 with erase eol foreground-color 3\n      else\n       if     Date-Form = 3\n              display \"    Using Intl format ccyy/mm/dd\" at 1420 with erase eol foreground-color 3\n       else\n              display \"    Incorectly Set. You MUST set this\"\n                                        at 1420 with erase eol foreground-color 4 highlight\n              move 1 to Date-Form.\n*>\n     if       p-start not = spaces\n              move  zero  to  u-bin\n              move  p-start  to  ws-test-date\n              perform zz050-Validate-Date\n*>              call \"maps04\" using maps03-ws\n              move  u-date  to  p-start\n*>              move  u-date (1:6) to IRS-Start-Date (1:6)\n*>              move  u-date (9:2) to IRS-Start-Date (7:2)  *> Omit CC in year for IRS\n     end-if\n     if       u-bin = zero\n              display SY005 at 1540 with foreground-color 3 blink\n              go to user-data-accept\n     else     display \" \" at 1540 with erase eol\n              move  u-bin   to  start-date\n     end-if\n*>\n*> With start date known (year) we can set the stats-date-period.\n*>   MUST remember to update these 3 fields at end of years end in XL150\n*>  Mind you it does 'ASSUME' that xl150 will run after EOY and before any new invoices.\n*>  SO, consider putting in support code for this in invoicing programs as well.\n*>\n     move     WS-Year9  to Stats-Date-Period.\n     display  Stats-Date-Period at 1652  with foreground-color 2 highlight.\n*>\n     if       p-end not = spaces\n              move  zero  to  u-bin\n              move  p-end  to  ws-test-date\n              perform zz050-Validate-Date\n*>              call \"maps04\" using maps03-ws\n              move  u-date  to  p-end\n*>              move  u-date (1:6) to IRS-End-Date (1:6)\n*>              move  u-date (9:2) to IRS-End-Date (7:2)  *> Omit CC in year for IRS\n     end-if\n     if       u-bin = zero\n              display SY005 at 1640 with foreground-color 3 blink\n              go to user-data-accept\n\n     else     display \" \" at 1640 with erase eol\n              move  u-bin   to  end-date\n     end-if\n *>    move     s-pass-word to pass-word in maps01-ws.\n *>    if       pass-word of maps01-ws not = spaces\n *>             move  \"P\"  to  encode\n *>             call  \"maps01\"  using  maps01-ws\n *>             move  pass-word of maps01-ws  to\n *>                   pass-word of System-Record\n *>    end-if\n     if       period = 13\n              display \"Weekly     \" at 2265 with foreground-color 3 erase eol\n     else\n      if      period = 6\n              display \"Fortnightly\" at 2265 with foreground-color 3 erase eol\n      else\n              move  3  to  period\n              display \"Monthly    \" at 2265 with foreground-color 3 erase eol\n      end-if\n     end-if.\n*>\n     if       Page-Lines not > 28\n              move 56 to Page-Lines\n              display SY105 at 1750 with foreground-color 3 blink\n              go to user-data-accept\n     else\n              display \" \" at 1750 with erase eol\n     end-if\n*>\n     display  \"   \" at 2401 with erase eol.\n     if       not FS-Valid-Options\n              move zero to File-System-Used\n              display \"Range 0 thru 1 only   \"  at 2410 with foreground-color 3 blink\n*>              display \"Range 0 thru 5 only   \"  at 2410 with foreground-color 3 blink\n     else\n      if      FS-Cobol-Files-Used\n              display \"Cobol data files used \"  at 2410 with foreground-color 3\n       else\n        if    FS-MySql-Used\n              display \"MySQL Rdbms used   \"  at 2410 with foreground-color 3.\n   *>     else\n   *>      if     FS-RDBMS-Used\n   *>             display \"Rdbms is used  \"  at 2410 with foreground-color 3\n*>\n*>       if     FS-Oracle-Used\n*>              display \"Oracle Rdbms used  \"  at 2410 with foreground-color 3\n*>        else\n*>         if   FS-Postgres-Used\n*>              display \"Postgres Rdbms used\"  at 2410 with foreground-color 3\n*>         else\n*>          if  FS-DB2-Used\n*>              display \"IBM DB2 Rdbms used \"  at 2410 with foreground-color 3\n*>          else\n*>           if FS-MS-SQL-Used\n*>              display \"MS SQL Server used \"  at 2410 with foreground-color 3.\n*>\n *>    if       File-Duplicates-In-Use not = zero and not = 1\n *>             move zero to File-Duplicates-In-Use\n *>             display \"Range 0 thru 1 only   \"  at 2450 with foreground-color 3 blink\n *>    else\n *>     if      FS-Duplicate-Processing\n *>             display \"Duplicate file processing used\"      at 2441 with foreground-color 3\n *>     else\n *>             display \"Duplicate file processing NOT used\"  at 2441 with foreground-color 3.\n*>\n     move     function upper-case (SL-VAT-Printed) to SL-VAT-Printed.\n     if       SL-VAT-Printed not = \"Y\" and not = \"N\"\n              move \"N\" to SL-VAT-Printed\n              display SL-VAT-Printed at 2137 with foreground-color 3 blink.\n*>\n     move     WS-Cyclea  to Cyclea.\n     if       Cyclea not > zero\n              display \"Cycle Error\"  at 2065 with foreground-color 3\n              go to user-data-accept\n     else     display space at 2065 with erase eol.\n\n     move     \"   User Data Complete\"  to verify-message.\n*>\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n*>\n     if       ws-reply = \"N\" or \"n\"\n              go to  main-user.\n*>\n Main-Exit.\n     exit     section.\n*>\n System-Params           section.\n*>==============================\n*>\n*>*****************************************\n*>  System Parameters Amendment Routine   *\n*>*****************************************\n*>\n ops-main.\n*>*******\n*>\n     move     2  to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner with erase eos.\n     display  \"OPS  Data 1\" at 0436 with foreground-color 2.\n     display  ops-data at 0101 with foreground-color 2.\n     accept   ops-data with update.\n*>\n     if       host not = 0 and not = 1\n              move 1 to  host\n              display \"Multi-user system assumed\" at 1823 with foreground-color 3 blink\n     else\n      if      host = zero\n              display \"Single-user system       \" at 1823 with foreground-color 3 blink\n      else\n              display \"Multi-user system        \" at 1823 with foreground-color 3 blink.\n     move     function upper-case (Param-Restrict) to Param-Restrict.\n     if       Param-Restrict not = \"N\" and not = \"Y\"\n              move \"N\" to Param-Restrict.\n     display  Param-Restrict at 1531 with foreground-color 3 blink.\n     display  \"]\"            at 1532 with foreground-color 2.\n*>\n*> Clear long comment before overwriting\n*>\n     display  spaxx at 2000.\n     if       host = zero  and (op-system  < 1 or > 6)\n              move 1 to op-system\n              display \"MSDOS assumed\" at 2023 with foreground-color 3 blink\n      else\n       if     host = 1\n          and (op-system  < 2 or > 6)\n              move 6 to op-system\n              display \"Linux assumed\" at 2023 with foreground-color 3 blink\n      else    if op-system = 1\n              display \"DOS\"     at 2023 with foreground-color 3 blink\n      else    if op-system = 2\n              display \"Windows\" at 2023 with foreground-color 3 blink\n      else    if op-system = 3\n              display \"Mac OSX\" at 2023 with foreground-color 3 blink\n      else    if op-system = 4\n              display \"OS/2\"    at 2023 with foreground-color 3 blink\n      else    if op-system = 5\n              display \"Unix\"    at 2023 with foreground-color 3 blink\n      else    if op-system = 6\n              display \"Linux\"   at 2023 with foreground-color 3 blink.\n*>\n     if       op-system = 3 or = 5 or = 6\n              if   Print-Spool-Name2 = spaces\n                   move Print-Spool-Name to Print-Spool-Name2\n              end-if\n              if   Print-Spool-Name3 = spaces\n                   move Print-Spool-Name to Print-Spool-Name3\n              end-if\n              display ops-data-2\n              accept  ops-data-2 with update\n              if Print-Spool-Name (1:1) = space\n                 display \" Print Spool Name must be defined\" at 2402 with highlight foreground-color 3\n              else\n                 move Print-Spool-Name to PSN\n              end-if\n     end-if\n*>\n     if       DC-Cobol-Standard\n              display \"Cobol Standard Display  \" at 2054 with foreground-color 3\n     else\n      if      DC-GUI\n              display \"Gui Display             \" at 2054 with foreground-color 3\n      else\n       if     DC-Widget\n              display \"Widget Display          \" at 2054 with foreground-color 3\n       else\n              display \" Invalid - Std selected \" at 2054 with foreground-color 3 highlight\n              move zero to Data-Capture-Used.\n*>\n     if       Maps-Ser-xx = \"mp\" and Maps-Ser-nn = 9999\n              display \"Using (Free) Open Source Version of ACAS\"   at 1501\n                               with highlight foreground-color 3\n     else\n              display \"Using Supported Commercial Version of ACAS\" at 1501\n                               with highlight foreground-color 3.\n*>\n     move     \"    OPS Data 1 Complete \"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n     if       ws-reply = \"N\" or = \"n\"\n              go to  ops-main.\n*>\n     if       File-System-Used = zero\n              go to main-exit.\n*>\n ops-main-2.\n*>\n*> Requested RDB processing so get more info\n*>\n     move     3  to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner.\n     display  \"OPS  Data 2\" at 0436 with foreground-color 2.\n     display  ops-data-3 at 0101 with foreground-color 2.\n     accept   ops-data-3 with update.\n     if       RDBMS-DB-Name not = spaces\n              display \" Set\"  at 0746 with foreground-color 3.\n     if       RDBMS-User not = spaces\n              display \" Set\"  at 0846 with foreground-color 3.\n     if       RDBMS-Passwd not = spaces\n              display \" Set\"  at 0946 with foreground-color 3\n              display \"************\"                   at 0922.\n     if       RDBMS-Host not = spaces\n              display \" Set          \"  at 1046 with foreground-color 3.\n     if       RDBMS-Socket not = spaces\n              display \"Set \"   at 1177 with foreground-color 3.\n     if       RDBMS-Port not = spaces\n              display \" Set\"  at 1246 with foreground-color 3.\n*>\n     move     \"    OPS Data 2 Complete \"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n     if       ws-reply = \"N\" or = \"n\"\n              go to  ops-main-2.\n*>\n main-exit.\n     exit section.\n*>\n GL-Params               section.\n*>==============================\n*>\n*>*************************************\n*>  G/L Parameters Amendment Routine  *\n*>*************************************\n*>\n GL-Params-Main.\n     move     4 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner at 0101 with foreground-color 2.\n     display  \"G-L  Data\" at 0436 with foreground-color 2.\n     move     next-batch to num-6.\n     display  gl-data at 0101 with foreground-color 2.\n     accept   gl-data with foreground-color 3 update.\n     move     num-6 to next-batch.\n*>\n     move     function upper-case (p-c) to p-c.\n     if       profit-centres\n              display \"Profit centres selected\" at 0732 with foreground-color 3 erase eol\n     else\n      if      branches\n              display \"Branches selected\" at 0732 with foreground-color 3 erase eol\n      else\n              move  space  to  p-c\n              display \"Not selected  \" at 0732    with foreground-color 3 erase eol\n*>\n     move     function upper-case (p-c-level) to p-c-level.\n     if       p-c = space  and\n              p-c-level not = space\n              move  space  to  p-c-level\n     end-if\n     if       p-c not = space\n              and  revenue-only\n              display \"Revenue A/cs only \" at 0832 with foreground-color 3.\n     if       p-c not = space\n              and  not  revenue-only\n              move space  to  p-c-level\n              display \"All A/cs          \" at 0832 with foreground-color 3\n     end-if\n     move     function upper-case(p-c-grouped) to p-c-grouped.\n     display  \"1st digit of P.C./Branch \" at 0932 with foreground-color 3.\n     if       grouped\n              display \"is the group identifier\" at 0957 with foreground-color 3\n     else\n              display \"is not significant\" at 0957 with foreground-color 3\n              move  space  to  p-c-grouped\n     end-if\n     move     function upper-case (comps) to comps.\n     if       comparatives\n              display \"Selected        \" at 1032 with foreground-color 3\n     else\n              move  space  to  comps\n              display \"Not selected    \" at 1032 with foreground-color 3\n     end-if\n     move     function upper-case (ledger-2nd-index) to ledger-2nd-index.\n     if       index-2\n              display \"Selected        \" at 1132 with foreground-color 3 erase eol\n     else\n              move  space  to  ledger-2nd-index\n              display \"Not selected    \" at 1132 with foreground-color 3 erase eol\n     end-if\n     move     function upper-case (m-v) to m-v.\n     if       minimum-validation\n              display \"Selected        \" at 1232 with foreground-color 3\n     else\n              display \"Not selected    \" at 1232 with foreground-color 3\n              move  space  to  m-v\n     end-if\n     move     function upper-case (arch) to arch.\n     if       archiving\n              display \"Selected        \" at 1332 with foreground-color 3\n     else\n              move  space  to  arch\n              display \"Not selected    \" at 1332 with foreground-color 3\n     end-if\n     move     function upper-case (vat) to vat.\n     if       auto-vat\n              display \"Selected        \" at 1632 with foreground-color 3\n     else\n              move  space  to  vat\n              display \"Not selected    \" at 1632 with foreground-color 3\n     end-if\n     move     function upper-case (IRS-Instead) to IRS-Instead.\n     if       IRS-Used\n              display \"IRS Selected\" at 1932 with foreground-color 3 erase eol\n              set IRS to true\n     else\n       if     IRS-Both-Used\n              display \"Both selected\" at 1932 with foreground-color 3 erase eol\n              set IRS to true\n       else\n              display \"Not selected\" at 1932 with foreground-color 3 erase eol\n              set IRS-No to true\n     end-if\n     move     \"    G-L Data Complete  \"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 2.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n*>\n     if       ws-reply = \"N\" or = \"n\"\n              go to  gl-params-Main.\n*>\n main-exit.\n     exit section.\n*>\n IRS-Params               section.\n*>==============================\n*>\n*>*************************************\n*>  IRS Parameters Amendment Routine  *\n*>*************************************\n*>\n     move     9 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner        with erase eos.\n     display  \"IRS  Data\" at 0436 with foreground-color 2.\n     display  IRS-Data            with foreground-color 2.\n     accept   IRS-Data            with foreground-color 3 update.\n*>\n*> Now move the param data collected and store in the IRS Data block.\n*>    Most of which is in the ACAS data areas.\n*>\n*>     move     Op-System    to System-Ops.\n     move     Vat-Rate-1   to Vat1.\n     move     Vat-Rate-2   to Vat2.\n     move     Vat-Rate-3   to Vat3.\n     move     Client       to User-Code.  *> as its unused in O/S versions.\n*>\n     if       PL-Approp-AC6 > zero\n              move  \"1\" to PL-App-Created.\n*>\n*> Clean up if not initialised correctly.\n*>\n     if      Next-Post not numeric\n             move 1 to Next-Post.\n     if      IRS-Pass-Value not numeric\n             move zero to IRS-Pass-Value.\n     if      Save-Sequ not numeric\n             move zero to Save-Sequ.\n*>\n IRS-Params-Exit.\n     exit     section.\n*>\n SL-Params               section.\n*>==============================\n*>\n*>*************************************\n*>  S/L Parameters Amendment Routine  *\n*>*************************************\n*>\n SL-Params-Main.\n     move     5 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     move     Next-Invoice  to WS-Next-Invoice.\n     if       WS-Next-Invoice = zero                         *> GC does not convert for display\n              move 1 to WS-Next-Invoice\n     end-if\n     move     VAT-AC   to WS-VAT-AC.                           *> Ditto\n*>\n*> Clean up for old system files created pre 2018 fir new fields added\n*> within filler as contains spaces in number fields. 21/04/24\n*>\n     if       GL-BL-Pay-Ac   > 99999 move zero to GL-BL-Pay-Ac.\n     if       GL-P-Creditors > 99999 move zero to GL-P-Creditors.\n     if       GL-BL-Purch-Ac > 99999 move zero to GL-BL-Purch-Ac.\n     if       GL-SL-Pay-Ac   > 99999 move zero to GL-SL-Pay-Ac.\n     if       GL-S-Debtors   > 99999 move zero to GL-S-Debtors.\n     if       GL-SL-Sales-Ac > 99999 move zero to GL-SL-Sales-Ac.\n*>\n     move     SL-Limit to WS-SL-Limit.\n*>\n     display  banner.\n     display  \"S-L  Data 1\" at 0436  with foreground-color 2.\n     display  sl-data.\n     accept   sl-data with foreground-color 2 update.\n     move     WS-Next-Invoice to Next-Invoice.               *> GC does not convert for display\n     move     WS-SL-Limit     to SL-Limit.\n\n*>\n\n     if       sl-dunning = 1\n              display \"Late letters selected    \" at 0722 with foreground-color 3\n     else\n              move  zero  to  sl-dunning\n              display \"Late letters not selected\" at 0722 with foreground-color 3.\n*>\n     if       sl-charges = 1\n              display \"Late charges selected    \" at 0822 with foreground-color 3\n     else\n              move  zero  to  sl-charges\n              display \"Late charges not selected\" at 0822 with foreground-color 3.\n*>\n     if       sl-delim = space\n              display \"Delimiter <!> assumed\" at 1422\n                          with foreground-color 2\n              move  \"!\"  to  sl-delim\n     end-if\n     if       ( sl-Delim = \"\\\"      *>\"  just for kate\n                     or = \"/\" )\n          and FS-RDBMS-Used\n              display \"Delimiter <!> reset(RDB)\" at 1422 with foreground-color 3\n              move \"!\" to sl-Delim\n     end-if\n*>\n     move     function upper-case (sl-own-nos) to sl-own-nos.\n     if       SL-own-nos = \"Y\"\n              display \"Selected & Set\" at 1528 with foreground-color 3\n     else\n              display \"Unset         \" at 1528 with foreground-color 3.\n     if       Next-Invoice not = zero\n              display \"Set\"    at 1632 with foreground-color 3\n     else\n              display \"Unset\"  at 1632 with erase eol foreground-color 3 blink.\n*>\n*> Clear text that will be overwritten by verify box & avoid a messing screen.\n*>\n     display  \"                \" at 1641 with erase eol.\n*>\n     move     function upper-case (SL-Stock-Link) to SL-Stock-Link.\n     if       SL-Stock-Link = \"Y\" and Stock\n              display \"Selected & Set       \" at 1940 with foreground-color 3 *> chg from 28 - 15/03/24\n     else\n              move \"N\" to SL-Stock-Link\n              display \"Unset and/or No Stock\" at 1940 with foreground-color 3 blink. *> chg from 28 - 15/03/24\n     move     function UPPER-CASE (SL-BO-Flag) to SL-BO-Flag.\n     if       SL-BO-Flag not = \"Y\" and not = \"N\"\n              move     \"N\" to SL-BO-Flag.\n     if       SL-BO-Flag = \"Y\"\n              display \"Set   /\"   at 1962  with foreground-color 3\n     else\n              display \"Unset /\" at 1962  with foreground-color 3 blink.\n     move     function UPPER-CASE (SL-BO-Default) to SL-BO-Default.\n     if       SL-BO-Default not = \"Y\" and not = \"N\"\n              move     \"N\" to SL-BO-Default.\n     if       SL-BO-Default = \"Y\"\n              display \"Set\"     at 1970  with foreground-color 3\n     else\n              display \"Unset\"   at 1970  with foreground-color 3 blink.\n*>\n     if       sl-pay-ac not = zero\n              display \"Selected & Set\" at 2028 with foreground-color 3\n     else\n              display \"Unset\" at 2028 with erase eol foreground-color 3 blink.\n     if       sl-sales-ac not = zero\n              display \"Selected & Set\" at 2128 with erase eol foreground-color 3\n     else\n              display \"Unset\" at 2128 with erase eol foreground-color 3 blink.\n     if       S-Debtors not = zero\n              display \"Selected & Set\" at 2228 with erase eol foreground-color 3\n     else\n              display \"Unset\" at 2228 with erase eol foreground-color 3 blink.\n     move     WS-VAT-AC to VAT-AC.\n     if       Vat-ac not = zero\n              display \"Selected & Set\" at 2328 with erase eol foreground-color 3\n     else\n              display \"Unset\" at 2328 with erase eol foreground-color 3 blink.\n     if       SL-Invoice-Lines = zero\n              move 25 to SL-Invoice-Lines\n     end-if\n*>\n     move     \"    S-L Data Complete  \"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n     if       ws-reply = \"N\" or = \"n\"\n              go to  sl-params-Main.\n*>\n SL-Params-2.\n     move     6 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner.\n     display  \"S-L  Data 2\" at 0436  with foreground-color 2.\n     display  sl-data-2 with erase eos.\n     accept   sl-data-2 with foreground-color 2 update.\n*>\n     move     function upper-case (SL-Comp-Head-Inv)  to SL-Comp-Head-Inv.\n     move     function upper-case (SL-Comp-Head-Stat) to SL-Comp-Head-Stat.\n     move     function upper-case (SL-Comp-Head-Lets) to SL-Comp-Head-Lets.\n     move     function upper-case (SL-Comp-Head-Pick) to SL-Comp-Head-Pick.\n*>\n     if       SL-Comp-Head-Inv not = \"Y\" and not = \"N\"\n              display \"Error, set to N\" at 0822 with foreground-color 4 highlight beep\n              move \"N\" to SL-Comp-Head-Inv.\n     if       SL-Comp-Head-Stat not = \"Y\" and not = \"N\"\n              display \"Error, set to N\" at 0922 with foreground-color 4 highlight beep\n              move \"N\" to SL-Comp-Head-Stat.\n     if       SL-Comp-Head-Lets not = \"Y\" and not = \"N\"\n              display \"Error, set to N\" at 1022 with foreground-color 4 highlight beep\n              move \"N\" to SL-Comp-Head-Lets.\n     if       SL-Comp-Head-Pick not = \"Y\" and not = \"N\"\n              display \"Error, set to N\" at 1122 with foreground-color 4 highlight beep\n              move \"N\" to SL-Comp-Head-Pick.\n     if       SL-Comp-Head-Inv = \"Y\"\n              display \"Will be printed\" at 0822 with erase eol foreground-color 3\n     else     display \"Will Not be printed\" at 0822 with erase eol foreground-color 3.\n     if       SL-Comp-Head-Stat = \"Y\"\n              display \"Will be printed\" at 0922 with erase eol foreground-color 3\n     else     display \"Will Not be printed\" at 0922 with erase eol foreground-color 3.\n     if       SL-Comp-Head-Lets = \"Y\"\n              display \"Will be printed\" at 1022 with erase eol foreground-color 3\n     else     display \"Will Not be printed\" at 1022 with erase eol foreground-color 3.\n     if       SL-Comp-Head-Pick = \"Y\"\n              display \"Will be printed\" at 1122 with erase eol foreground-color 3\n     else     display \"Will Not be printed\" at 1122 with erase eol foreground-color 3.\n*>\n     move     \"  S-L Data 2 Complete  \"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n     if       ws-reply = \"N\" or = \"n\"\n              go to  sl-params-2.\n*>\n main-exit.\n     exit section.\n*>\n PL-Params               section.\n*>==============================\n*>\n*>*************************************\n*>  P/L Parameters Amendment Routine  *\n*>*************************************\n*>\n PL-Params-Main.\n     move     7 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     move     Next-Folio   to WS-Next-Folio.\n     move     BL-Pay-AC    to BL-Pay-AC.\n     move     P-Creditors  to WS-P-Creditors.\n     move     BL-Purch-Ac  to WS-BL-Purch-Ac.\n     display  banner.\n     display  \"P-L  Data\" AT 0436 with foreground-color 2.\n     display  pl-data.\n     accept   pl-data with foreground-color 2 update.\n*>\n     move     WS-Next-Folio  to Next-Folio.\n     if       pl-delim = space\n              display \"Delimiter <!> assumed\" at 1422 with foreground-color 2\n              move  \"!\"  to  pl-delim\n     end-if\n     if       (pl-Delim = \"\\\" or = \"/\")        *> \"\n          AND FS-RDBMS-Used\n              display \"Delimiter <!> reset(RDB)\" at 1422\n                          with foreground-color 2\n              move \"!\" to pl-Delim\n     end-if\n*>\n     move     function upper-case (PL-Stock-Link) to PL-Stock-Link.\n     if       PL-Stock-Link = \"Y\" and Stock\n              display \"Selected & Set\" at 1528 with erase eol foreground-color 2\n     else\n              move \"N\" to PL-Stock-Link\n              display \"Unset and/or No Stock\" at 1528 with erase eol foreground-color 3 blink.\n*>\n     move     WS-BL-Pay-AC  to BL-Pay-ac.\n     if       BL-Pay-ac not = zero\n              display \"Selected & Set\" at 1828 with erase eol foreground-color 2\n     else\n              display \"Unset\" at 1828 with erase eol foreground-color 3 blink.\n     move     WS-BL-Purch-Ac  to BL-Purch-Ac.\n     if       BL-Purch-ac not = zero\n              display \"Selected & Set\" at 1928 with erase eol foreground-color 2\n     else\n              display \"Unset\" at 1928 with erase eol foreground-color 3 blink.\n     move     WS-P-Creditors to P-Creditors.\n     if       P-Creditors not = zero\n              display \"Selected & Set\" at 2028 with erase eol foreground-color 2\n     else\n              display \"Unset\" at 2028 with erase eol foreground-color 3 blink.\n*>\n     move     \"    P-L Data Complete\"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n*>\n     if       ws-reply = \"N\" or = \"n\"\n              go to  pl-params-Main.\n*>\n main-exit.\n     exit section.\n*>\n Stock-Params            section.\n*>==============================\n*>\n*>***************************************\n*>  Stock Parameters Amendment Routine  *\n*>***************************************\n*>\n Stock-Params-Main.\n     move     8 to  screen-nos.\n     display  \" \" at 0101 with erase eos.\n     display  banner.\n     display  \"Stock Data\" AT 0436 with foreground-color 2.\n     display  Stock-data.\n     accept   Stock-data with foreground-color 2 update.\n*>\n     if       Stk-Debug = 1\n              display \"    Set\" at 0720 with erase eol   foreground-color 3\n     else\n              move zero to Stk-Debug\n              display \"    UnSet\" at 0720 with erase eol foreground-color 3\n     end-if\n     if       Stk-Manu-Used = 1\n              display \"    Set\" at 0920 with erase eol foreground-color 3\n     else\n              move zero to Stk-Manu-Used\n              display \"    UnSet\" at 0920 with erase eol foreground-color 3\n     end-if\n     if       Stk-OE-Used = 1\n              display \"    Set\" at 1020 with erase eol foreground-color 3\n     else\n              move zero to Stk-OE-Used\n              display \"    UnSet\" at 1020 with erase eol foreground-color 3\n     end-if\n *>    if       Stk-Audit-Used = 1\n *>             display \"    Set\" at 1120 with erase eol foreground-color 3\n *>    else\n *>             move zero to Stk-Audit-Used\n *>             display \"    UnSet\" at 1120 with erase eol foreground-color 3\n *>    end-if\n *>    if       Stk-Mov-Audit = 1\n *>             display \"    Set\" at 1220 with erase eol foreground-color 3\n *>    else\n *>             move zero to Stk-Mov-Audit\n *>             display \"    UnSet\" at 1220 with erase eol foreground-color 3\n *>    end-if\n     move     function upper-case (Stk-Period-Cur) to Stk-Period-Cur.\n     if       Stk-Period-Cur = \"M\"\n              display \"    Set to Monthly\" at 1320 with erase eol foreground-color 3\n     else\n      if      Stk-Period-Cur = \"Q\"\n              display \"    Set to Quarterly\" at 1320 with erase eol foreground-color 3\n      else\n *>      if     Stk-Period-Cur = \"W\"\n *>             display \"    Set to Weekly\" at 1320 with erase eol foreground-color 3\n *>      else\n              move \"M\" to Stk-Period-Cur\n              display \"    Unset: Has been set to Monthly\" at 1320\n                   with erase eol foreground-color 3 highlight.\n*>\n     move     function upper-case (Stk-Period-Dat) to Stk-Period-Dat.\n     if       Stk-Period-Dat = \"M\"\n              display \"    Set to Monthly\" at 1420 with erase eol foreground-color 3\n     else\n      if      Stk-Period-Dat = \"Q\"\n              display \"    Set to Quarterly\" at 1420 with erase eol foreground-color 3\n      else\n       if     Stk-Period-Dat = \"Y\"\n              display \"    Set to Yearly\" at 1420 with erase eol foreground-color 3\n       else\n              move \"Y\" to Stk-Period-Dat\n              display \"    Unset: Has been set to Yearly\" at 1420\n                                      with erase eol foreground-color 3 highlight.\n*>\n     if       Stk-Averaging = 1\n              display \"    Set\" at 1520 with erase eol foreground-color 3\n     else\n              move zero to Stk-Averaging\n              display \"    UnSet\" at 1520 with erase eol foreground-color 3\n     end-if\n*>\n     if       Stk-Activity-Rep-Run = 1\n              display \"    Set\" at 1820 with erase eol foreground-color 3\n     else\n              move zero to Stk-Activity-Rep-Run\n              display \"    UnSet\" at 1820 with erase eol foreground-color 3\n     end-if\n     if       Stk-Audit-No  > 0 and < 99999\n              display \"  Set\" at 1922 with erase eol foreground-color 3\n     else\n              move zero to Stk-Audit-No\n              display \"  Set to zero\" at 1922 with erase eol foreground-color 4 highlight\n     end-if\n     move     function upper-case(Stk-BO-Active) to Stk-BO-Active.\n     if       Stk-BO-Active = \"Y\"\n              display \"    Set\"   at 1120 with erase eol foreground-color 3\n     else\n              display \"    UnSet\" at 1120 with erase eol foreground-color 3\n     end-if\n*>\n     move     \"  Stock Data Complete\"  to  verify-message.\n     display  verify-screen at 0101 with foreground-color 2.\n*>\n     move     \"Y\"  to  ws-reply.\n     display  ws-reply at 1576 with foreground-color 6.\n     accept   ws-reply at 1576 with foreground-color 6 update.\n*>\n     if       ws-reply = \"N\" or = \"n\"\n              go to  Stock-Params-Main.\n*>\n main-exit.\n     exit section.\n*>\n Print-Params            section.\n*>==============================\n*>\n*>**********************************\n*>  File Parameters Print Routine  *\n*>**********************************\n*>\n     display  \" \" at 0101 with erase eos.\n     display  \"Do you want printed copy (Y/N) [ ]\" at 1201  with foreground-color 2.\n     move     \"Y\" to ws-reply.\n     accept   ws-reply at 1233 with foreground-color 4 update.\n     if       ws-reply = \"N\" or = \"n\"\n              go to main-exit.\n*>\n     open     output  print-file.\n     move     prog-name to l1-name.\n     move     1 to page-nos.\n     move     page-nos to l1-page.\n     write    print-record  from  line-1 before 1.\n     write    print-record  from  line-3a after 1.\n     write    print-record  from  line-4 after 1.\n*>\n     move     spaces  to  line-5.\n     move     \"Name\"  to  l5-name.\n     move     usera   to  l5-data-1.\n     move     1 to num-3.\n     string   \"Using IRS instead of GL - \" delimited by size into l5-data-2 pointer num-3.\n     if       irs-used\n              string \"Yes\" delimited by size into l5-data-2  pointer num-3\n              end-string\n     else\n              string \"No\" delimited by size into l5-data-2   pointer num-3\n              end-string\n     end-if\n     write    print-record  from  line-5 after 2.\n*>\n     move     \"Address\"  to  l5-name.\n     move     address-1  to  l5-data-1.\n     if       profit-centres\n              move  \"Profit-Centres Selected\"  to  l5-data-2\n     else\n      if      branches\n              move \"Branches Selected\"   to  l5-data-2\n      else\n              move \"Neither P/C or Branches Selected\" to  l5-data-2.\n*>\n     write    print-record  from  line-5 after 1.\n*>\n     move     spaces     to  l5-name  l5-data-2.\n     move     address-2  to  l5-data-1.\n     if       not  profit-centres\n        and   not  branches\n              move spaces  to  l5-data-2\n     else\n      if      revenue-only\n              move  \"Only for Revenue Accounts\"  to  l5-data-2\n      else\n              move  \"For all Accounts\"  to  l5-data-2.\n*>\n     write    print-record  from  line-5 after 1.\n*>\n     move     address-3  to  l5-data-1.\n     if       not  profit-centres\n        and   not  branches\n              move spaces  to  l5-data-2\n     else\n      if      grouped\n              move  \"P-C / Branches Grouped on 1st Digit\" to  l5-data-2\n      else\n              move  \"P-C / Branches not Grouped\" to  l5-data-2.\n*>\n     write    print-record  from  line-5 after 1.\n*>\n     if       address-4 = spaces\n              string   Post-Code      delimited by \"  \"\n                       \", \"           delimited by size\n                       Country        delimited by \"  \" into l5-data-1\n              end-string\n     else\n              string   address-4      delimited by \"  \"\n                       \",\"            delimited by size\n                       Post-Code      delimited by \"  \"\n                       \",\"            delimited by size\n                       Country        delimited by \"  \" into l5-data-1\n              end-string\n     end-if\n*>\n     if       comparatives\n              move \"Comparative Figures Required\"     to l5-data-2\n     else\n              move \"Comparative Figures not Required\" to l5-data-2.\n*>\n     write    print-record  from  line-5 after 1.\n*>\n     if       Company-Email (1:8) not = spaces\n              move     spaces to Line-5\n              move     \"Company Email\" to L5-Name\n              move     Company-Email  to L5-Data-1\n              write    print-record  from  line-5 after 1.\n*>\n     move     \"Date Format\" to l5-name.\n     if       Date-Form = 0 or 1\n              move \"UK Format\" to l5-data-1\n              move 1 to Date-Form\n     else\n      if      Date-Form = 2\n              move \"USA Format\" to l5-data-1\n      else    move \"Intl Format\" to l5-data-1.\n*>\n     if       index-2\n              move \"Alphabetic Ledger Index Selected\" to l5-data-2\n     else\n              move \"Alphabetic Ledger Index not Selected\" to l5-data-2.\n*>\n     write    print-record from line-5 after 1.\n*>\n     move     start-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     \"Period Start\"  to  l5-name.\n     move     spaces to L5-Data-1.\n     string   WS-Date                    delimited by size\n              \"     Statistics Year    \" delimited by size\n              Stats-Date-Period          delimited by size\n                  into  l5-data-1.\n*>\n     if       minimum-validation\n              move  \"Min. Validation During Data Entry\" to  l5-data-2\n     else\n              move  \"Full Validation During Data Entry\" to  l5-data-2.\n     write    print-record  from  line-5 after 1.\n*>\n     move     end-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date  to  l5-data-1.\n     move     \"       End\"  to  l5-name.\n*>\n     if       archiving\n              move \"Transaction Archiving Selected\" to l5-data-2\n     else\n              move \"Transactions Deleted at End of Cycle\" to l5-data-2.\n     write    print-record  from  line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     vat-rate-1 to  num-1.\n     move     vat-rate-4 to  num-1b.\n     move     spaces     to l5-data-1.\n     if       SL-VAT-Printed = \"Y\"\n              move  \"(P) \" to S-Pass-Word\n     else\n              move  \"(NP)\" to S-Pass-Word.\n     string   num-1          delimited by size\n              \" / \"          delimited by size\n              num-1b         delimited by size\n              \"  VAT Reg: \"  delimited by size\n              VAT-Reg-Number delimited by size\n              \" \"            delimited by size\n              S-Pass-Word    delimited by size\n                                 into l5-data-1.\n     move     spaces to S-Pass-Word.\n     move     \"VAT    Rate 1/4.\"  to  l5-name.\n*>\n     if       Sales-Range = zero\n              move  \"No Reserved Sales Range\"  to  l5-data-2\n     else\n              move  \"Sales Range most Significant Digit is - \" to  l5-data-2\n              move  Sales-Range  to  array-2 (41).\n     write    print-record  from  line-5 after 1.\n*>\n     move     spaces to l5-data-1.\n     move     vat-rate-2  to  num-1.\n     move     vat-rate-5  to  num-1b.\n     string   num-1   delimited by size\n              \" / \"   delimited by size\n              num-1b  delimited by size into l5-data-1.\n*>     move     num-1  to  l5-data-1.\n     move     \"       Rate 2/5.\"  to  l5-name.\n*>\n     if       Purchase-Range = zero\n              move  \"No Reserved Purchase Range\" to  l5-data-2\n     else\n              move  \"Purchase Range Most Signif.  Digit is - \" to  l5-data-2\n              move  Purchase-Range  to  array-2 (41).\n     write    print-record  from  line-5 after 1.\n*>\n     move     vat-rate-3  to  num-1.\n     move     num-1  to  l5-data-1.\n     move     \"       Rate 3.\"  to  l5-name.\n*>\n     if       auto-vat\n              move  \"Auto VAT Posting Selected\" to  l5-data-2\n     else\n              move  \"Manual VAT Posting Selected\" to l5-data-2\n     end-if\n     write    print-record  from  line-5 after 1.\n*>\n     move     spaces  to  l5-name  l5-data-1.\n     move     spaces  to  l5-data-2.\n     move     period  to  num-2.\n     move     1  to  num-3.\n     string   \"Cycles per Quarter - \"  delimited by size into  l5-data-2  with  pointer  num-3.\n     string   num-2  delimited by size into  l5-data-2  with  pointer  num-3.\n*>\n     move     current-quarter  to  num-4.\n     move     1  to  num-3.\n     move     \"Current Quarter \" to l5-name.\n     string   num-4  delimited by size into  l5-data-1  with  pointer  num-3.\n     write    print-record  from  line-5 after 1.\n*>\n     move     spaces  to  l5-data-2 l5-data-1.\n     move     next-batch  to  num-2.\n     move     1  to  num-3.\n     string   \"Next Batch Number  - \"  delimited by size into  l5-data-2  with  pointer  num-3.\n     string   num-2  delimited by size into  l5-data-2  with  pointer  num-3.\n*>\n     move     \"Current Cycle\" to l5-name.\n     move     cyclea to num-4.\n     move     1 to num-3.\n     string   num-4 delimited by size into l5-data-1 with pointer num-3.\n     write    print-record  from  line-5 after 1  lines.\n*>\n     move     spaces  to  line-5.\n     move     \"Print Lines\" to l5-Name.\n     move     Page-Lines to Num-9.\n     move     Num-9 to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n*> End of User / G/L params, now ACAS & P/L params\n*>\n     move     spaces to l5-data-2.\n     write    print-record  from  line-3b after 2.\n     move     l4-part1 to print-record.\n     write    print-record  from  line-4  after 1.\n*>\n     move     \"Address Delimiter\" to l5-data-2.\n     move     pl-delim to array-2 (29).\n*>\n     move     \"Environment\"  to  l5-name.\n     if       multi-user\n              move  \"Multi User\"  to  l5-data-1\n     else\n              move  \"Single User\"  to  l5-data-1\n     end-if\n     write    print-record  from  line-5 after 2.\n*>\n     move     \"Op. System\"  to  l5-name.\n     move     spaces to Temp-String\n                        Temp-String2\n                        l5-Data-1.\n     if       windows  move \"Windows\"   to  Temp-String\n     else if  Dos      move \"Dos\"       to  Temp-String\n     else if  os2      move \"OS/2\"      to  Temp-String\n     else if  unix     move \"Unix\"      to  Temp-String\n     else if  linux    move \"Linux\"     to  Temp-String.\n     if       DC-Cobol-Standard\n              move \" & Cobol Standard\" to Temp-String2\n     else\n      if      DC-GUI\n              move \" & Gui Display\" to Temp-String2\n      else\n       if     DC-Widget\n              move \" & Widget Display\" to Temp-String2.\n*>\n     string   Temp-String        delimited by space\n              Temp-String2       delimited by \"  \"\n                              into l5-Data-1.\n*>\n     move     \"Next Batch Number\" to l5-data-2.\n     move     25 to num-3.\n     move     bl-next-batch to num-6.\n     string   num-6 delimited by size into l5-data-2\n                   with pointer num-3.\n     write    print-record from line-5 after 1.\n     move     \"System version\"  to  l5-name.\n     if       Maps-Ser-xx = \"mp\"\n        and   Maps-Ser-nn = 9999\n              move \"Using (Free) Open Source Version of ACAS\" to l5-data-1\n     else\n              move \"Using Commercial Version of ACAS\"         to l5-data-1\n     end-if\n     move     1 to num-3.\n     string   \"Next Folio Number \" delimited by size into l5-data-2 pointer num-3.\n     if       Next-Folio = zero\n              move 1 to Next-Folio.\n     move     Next-Folio  to num-7.\n     add      3 to num-3.\n     string   num-7 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5 Temp-String.\n     if       not FS-Valid-Options\n              move zero to File-System-Used.\n     if       FS-Cobol-Files-Used\n              move \"Cobol Data Files Used\"           to Temp-String\n     else\n *>     if      FS-RDBMS-Used\n *>             move \"Rdbms is used  \"                 to Temp-String.\n*>\n     if       FS-MySql-Used\n              move \"MySQL Database Used\"             to Temp-String.\n*>     else\n*>      if     FS-Oracle-Used\n*>              move \"Oracle Database Used\"            to Temp-String\n*>      else\n*>       if    FS-Postgres-Used\n*>             move \"Postgres Database Used\"          to Temp-String\n*>       else\n*>        if   FS-DB2-Used\n*>             move \"IBM DB2 Database Used\"           to Temp-String\n*>        else\n*>         if  FS-MS-SQL-Used\n*>             move \"MS SQL Server Used\"              to Temp-String.\n*>\n     if       File-Duplicates-In-Use not = zero and not = 1     *> no longer in use so clear it.\n              move zero to File-Duplicates-In-Use\n     end-if\n     move     Temp-String  to l5-data-1.\n*>\n     move     1 to num-3.\n     string   \"Pay      Account \" delimited by size into l5-data-2 pointer num-3.\n     move     BL-Pay-Ac to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Path to BIN\" to l5-name.\n     move     ACAS_BIN  to l5-data-1.\n     if       l5-data-1 = spaces\n              move \"UNSET Environment Variable\" to l5-data-1.\n     move     1 to num-3.\n     string   \"Ledger   Account \" delimited by size into l5-data-2 pointer num-3.\n     move     BL-Purch-Ac to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Path to Ledgers\" to l5-name.\n     move     ACAS_LEDGERS  to l5-data-1.\n     if       l5-data-1 = spaces\n              move \"UNSET Environment Variable\" to l5-data-1.\n     move     1 to num-3.\n     string   \"Creditor Account \" delimited by size into l5-data-2 pointer num-3.\n     move     P-Creditors to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Prt Spool Name 1\" to l5-name.\n     if       not OS-Single\n              move Print-Spool-Name to l5-data-1\n     else\n              move \"Not Used\"       to l5-data-1\n     end-if\n     move     1 to num-3.\n     string   \"Stock Control Link \" delimited by size into l5-data-2 pointer num-3.\n     add      7 to num-3.\n     if       PL-Stock-Link = \"Y\" and Stock\n              string \"Yes\" delimited by size into l5-data-2 pointer num-3\n     else\n              string \"No\" delimited by size into l5-data-2 pointer num-3\n     end-if\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Prt Spool Name 2\"     to l5-name.\n     if       not OS-Single\n              move Print-Spool-Name2 to l5-data-1\n     else\n              move \"Not Used\"        to l5-data-1\n     end-if\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Prt Spool Name 3\"     to l5-name.\n     if       not OS-Single\n              move Print-Spool-Name3 to l5-data-1\n     else\n              move \"Not Used\"        to l5-data-1\n     end-if\n     write    print-record from line-5 after 1.\n     move     spaces to Line-5.\n     move     \"Restrict Params\"      to l5-name.\n     if       Param-Restrict = \"Y\"\n              move \"Yes\" to l5-Data-1\n     else\n              move \"No\"  to L5-Data-1\n     end-if\n*>\n*> End of ACAS Params now for S/L and Invoicing (if present)\n*>\n     write    print-record from line-3c after 2.\n     write    print-record from line-4 after 1.\n*>\n     move     spaces to print-record.\n     write    print-record after 1.\n     move     3 to a.                           *> Invoice # + next inv #\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     1 to a.                           *> Late letters ?, Ext Chg desc, Ex disc. desc\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     2 to a.                           *> Late chgs ?, Ext chg rate, Ext. Disc Rate\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     4 to a.                           *> Credit period, Inv level\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     5 to a.                           *> Credit limit, Ext chg A/C, Ext. Disc A/C\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     6 to a.                           *> Std disc %, Vat #\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     7 to a.                           *> Min. late bal, prt Vat #?\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     8 to a.                           *> Max late chg\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     9 to a.                           *> Late chg rate\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     10 to a.                          *> Addr delim (SL & PL)\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     11 to a.                          *> Next batch #, Proforma Retn\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     12 to a.                          *> Next batch #, Proforma Retn\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n     move     13 to a.                          *> Next batch #, Proforma Retn\n     perform  sl-print.\n     write    print-record from line-5 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Company Heads Pri\" to l5-name.\n     string   \"nt on Delivery notes: \" delimited by size\n              SL-Comp-Head-Pick        delimited by size\n                                              into l5-data-1.\n     move     1 to num-3,\n     string   \"Stock Control Link \" delimited by size into l5-data-2 pointer num-3.\n     add      7 to num-3.\n     if       SL-Stock-Link = \"Y\" and Stock\n              string \"Yes\" delimited by size into l5-data-2 pointer num-3\n     else\n              string \"No\" delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     string   \"nt on Invoices      : \" delimited by size\n              SL-Comp-Head-Inv         delimited by size\n                                              into l5-data-1.\n     move     spaces to l5-data-2.\n     move     1 to num-3.\n     string   \"Pay      Account \" delimited by size into l5-data-2 pointer num-3.\n     move     SL-Pay-Ac to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     string   \"nt on Statements    : \" delimited by size\n              SL-Comp-Head-Stat        delimited by size\n                                              into l5-data-1.\n     move     spaces to l5-data-2.\n     move     1 to num-3.\n     string   \"Ledger   Account \" delimited by size into l5-data-2 pointer num-3.\n     move     SL-Sales-Ac to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n     string   \"nt on Late Letters  : \" delimited by size\n              SL-Comp-Head-Lets        delimited by size\n                                              into l5-data-1.\n     move     spaces to l5-data-2.\n     move     1 to num-3.\n     string   \"Debtors  Account \" delimited by size into l5-data-2 pointer num-3.\n     move     S-Debtors to num-8.\n     add      6 to num-3.\n     string   num-8 delimited by size into l5-data-2 pointer num-3.\n     write    print-record from line-5 after 1.\n*>\n*> Delivery now redundant as done in another way, within customer record.\n*>\n*>     move     spaces to l5-data-2.\n*>     move     1 to num-3.\n*>     string   \"Delivery Tag     \" delimited by size into l5-data-2 pointer num-3.\n*>     move     Delivery  to num-8.\n*>     add      6 to num-3.\n*>     string   num-8 delimited by size into l5-data-2 pointer num-3.\n*>     write    print-record from line-5 after 1.\n*>\n*> Now for Stock & O/E so New page  rem out O/E not supplied for OS vers\n*>\n*>  CHANGES : replaced O/E with IRS.\n*>  so will ONLY print out the IRS specific params that are diff\n*>     rest of ACAS - Client.\n*>\n     move     2 to page-nos.\n     move     page-nos to l1-page.\n     write    print-record  from  line-1 after page.\n     write    print-record  from  line-3d after 2.\n     write    print-record  from  line-4 after 1.\n*>\n     move     spaces to line-5.\n     move     \"Debug Mode\" to l5-name.\n     if       stk-debug = 1\n              move \"Yes\" to l5-data-1\n     else\n              move \"No\" to l5-data-1.\n*>\n     string   \"IRS Client       \" delimited by size\n              Client              delimited by \"  \"\n                  into l5-data-2.\n     write    print-record from line-5 after 2.\n*>\n     move     spaces to line-5.\n     move     \"Manufacturing\" to l5-name.\n     if       Stk-Manu-Used = 1\n              move \"Yes\" to l5-data-1\n     else\n              move \"No\" to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"Audit in Use\" to l5-name.\n     if       Stk-Audit-Used = 1\n              move \"Yes\" to l5-data-1\n     else\n              move \"No\" to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"Movement Audits\" to l5-name.\n     if       Stk-Mov-Audit = 1\n              move \"Yes\" to l5-data-1\n     else\n              move \"No\" to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"Current Period\" to l5-name.\n     if       Stk-Period-Cur = \"M\"\n              move \"Monthly\"   to l5-data-1\n     else if  Stk-Period-Cur = \"Q\"\n              move \"Quarterly\" to l5-data-1\n     else if  Stk-Period-Cur = \"Y\"\n              move \"Yearly\"    to l5-data-1\n     else     move \"NOT SET\"   to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"To Date Period\" to l5-name.\n     if       Stk-Period-Dat = \"M\"\n              move \"Monthly\"   to l5-data-1\n     else if  Stk-Period-Dat = \"Q\"\n              move \"Quarterly\" to l5-data-1\n     else if  Stk-Period-Dat = \"Y\"\n              move \"Yearly\"    to l5-data-1\n     else     move \"NOT SET\"   to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"Stock Averaging\" to l5-name.\n     if       Stock-Averaging\n              move \"Yes\" to l5-data-1\n     else     move \"No\"  to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n     move     \"Current Audit No\" to l5-name.\n     move     Stk-Audit-No to Num-7.\n     move     Num-7 to l5-data-1.\n     write    print-record from line-5 after 1.\n*>\n*>  Payroll\n*>\n     write    print-record  from  line-3d2 after 2.\n     move     \"                      ******************\" to l4-part1.\n     write    print-record  from  line-4 after 1.\n*>\n*>   No Payroll for Open Source version\n*>\n     move     spaces to line-5.\n     move     \"Payroll in Use   \" to l5-name.\n*>     if       Payroll-Used = 1\n*>              move \"Yes\" to l5-data-1\n*>     else\n              move \"No\" to l5-data-1.\n*>\n     if       FS-RDBMS-Used\n              move \"RDBMS DB Schema \" to l5-data-2\n              move RDBMS-DB-Name      to l5-data-2 (17:12).    *> changed these back 4 char\n     write    print-record from line-5 after 2.\n*>\n     if       FS-RDBMS-Used\n              move spaces to l5-data-1    l5-name\n              move \"RDB User Name   \" to l5-data-2\n              move RDBMS-User         to l5-data-2 (17:12)\n              write print-record  from  line-5 after 1\n              move \"RDB User Passwd \" to l5-data-2         *> Could remove these 4 lines\n              move \"It's SECRET\"      to l5-data-2 (17:12)\n              move line-3e (1:40)     to line-5 (1:40)     *> System Params head\n              write print-record  from  line-5 after 1\n     else\n              write    print-record  from  line-3e after 2.  *> & leave this freestanding\n*>\n     move     \"                       *****************\" to l4-part1.\n     move     spaces to l4-Part2.                          *> clears righthand ******\n     if       FS-RDBMS-Used\n              move spaces to l5-data-1    l5-name\n              move     \"****************\" to l5-files (15:16)\n              move \"RDB Host        \" to l5-data-2\n              move RDBMS-Host         to l5-data-2 (17:32)\n              write print-record  from  line-5 after 1\n     else\n              write    print-record  from  line-4 after 1.\n*>\n     if       FS-RDBMS-Used\n              move spaces to l5-data-1    l5-name\n              move \"RDB Socket      \" to l5-data-2\n              move RDBMS-Socket       to l5-data-2 (17:46)     *> ignoring last 17 chars of field.\n              write print-record  from  line-5 after 1.\n*>\n     move     all \"*\" to l4-part2-star\n                         l4-part1-star.           *> in case it get run again\n     move     spaces to line-5.\n*>\n     move     \"PL Approp A/C\" to l5-name.\n     move     PL-Approp-AC6  to l5-data-1.\n*>\n     if       FS-RDBMS-Used\n              move \"RDB Port        \" to l5-data-2\n              move RDBMS-Port         to l5-data-2 (17:5)\n              write print-record  from  line-5 after 1\n     else\n              write print-record from line-5 after 2.\n*>\n*> End of params EOP.\n*>\n     write    print-record  from  line-6 after 2.\n     write    print-record  from  line-7 after 1.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-exit.\n     exit section.\n*>\n SL-Print         section.\n*>***********************\n*>\n     if       a < 1 or > 13\n              go to main-exit.\n     move     spaces to line-5.\n*>\n     go       to aa1 aa2 aa3 aa4 aa5 aa6 aa7 aa8 aa9 aa10 aa11 aa12 aa13\n                      depending on a.\n*>\n aa1.\n     if       sl-dunning = zero\n              move \"Dunning Letters not Selected\" to l5-data-2\n     else\n              move \"Dunning Letters Selected\" to l5-data-2.\n*> C or D\n     if       extra-type = \"C\"\n              move \"Ext. Charge Desc\" to l5-name\n              move extra-desc to l5-data-1.\n     if       extra-type = \"D\"\n              move \"Extra Disc. Desc\" to l5-name\n              move extra-desc to l5-data-1.\n     go       to main-exit.\n*>\n aa2.\n     if       sl-charges = zero\n              move \"Late Charges not Selected\" to l5-data-2\n     else\n              move \"Late Charges Selected\" to l5-data-2.\n*> C or D\n     move     extra-rate to num-1.\n     if       extra-type = \"C\"\n              move \"Ext. Charge Rate\" to l5-name\n              move num-1 to l5-data-1.\n     if       extra-type = \"D\"\n              move \"Ext. Disc. Rate\" to l5-name\n              move num-1 to l5-data-1.\n     go       to main-exit.\n*>\n aa3.\n     if       sl-own-nos = \"N\"\n              move \"Computer Generated Invoice Numbers Selected\" to l5-data-2\n     else\n              move \"Manually Entered Invoice Numbers Selected\"   to l5-data-2.\n*>\n     move     \"Next Inv. Number\" to l5-name.\n     move     next-invoice to num-7.\n     move     num-7 to l5-data-1.\n     go       to main-exit.\n*>\n aa4.\n     move     \"Credit Period nn Days\" to l5-data-2.\n     move     sl-credit  to  num-4.\n     move     15 to num-3.\n     string   num-4 delimited by size into l5-data-2 with pointer num-3.\n*>\n     move     \"Inv. Data Level\" to l5-name.\n     move     invoicer to l5-data-1.\n     go       to main-exit.\n*>\n aa5.\n     move     \"Standard Credit Limit\" to l5-data-2.\n     move     sl-limit to num-5.\n     move     23 to num-3.\n     string   num-5 delimited by size into l5-data-2 with pointer num-3.\n*>\n     move     extra-charge-ac to num-8.              *> This from sl900 only but does not appear to be used any where.\n     if       extra-type = \"C\"\n              move \"Extra Charge A/C\" to l5-name\n              move num-8 to l5-data-1.\n*>\n     if       extra-type = \"D\"\n              move \"Extra Disc. A/C\" to l5-name\n              move num-8 to l5-data-1.\n     go       to main-exit.\n*>\n aa6.\n     move     \"Standard Discount is   nn.nn%\" to l5-data-2.\n     move     sl-disc to num-1.\n     move     24 to num-3.\n     string   num-1 delimited by size into l5-data-2 with pointer num-3.\n*>\n     move     \"VAT Account\" to l5-name.\n     move     vat-ac to num-8.\n     move     num-8 to l5-data-1.\n     go       to main-exit.\n*>\n aa7.\n     move     \"Min. Late Balance\" to l5-data-2.\n     move     sl-min to num-2.\n     move     25 to num-3.\n     string   num-2 delimited by size into l5-data-2 with pointer num-3.\n*>\n     move     \"Print VAT Nunber\" to l5-name.\n     if       SL-VAT-Prints\n              move     \"Yes\"     to l5-data-1\n     else\n              move     \"No \"     to l5-data-1.\n     go       to main-exit.\n*>\n aa8.\n*>\n     move     \"Max. Late Charge\" to l5-data-2.\n     move     sl-max to num-2.\n     move     25 to num-3.\n     string   num-2 delimited by size into l5-data-2 with pointer num-3.\n     move     \"Prt Inv Max Itms\"  to L5-Name.\n     move     SL-Invoice-Lines     to Num-4.\n     move     Num-4 to L5-Data-1.\n     go       to main-exit.\n*>\n aa9.\n*>\n     move     \"Late Charge Rate       nn.nn%\" to l5-data-2.\n     move     sl-late-per to num-1.\n     move     24 to num-3.\n     string   num-1 delimited by size into l5-data-2 with pointer num-3.\n     go       to main-exit.\n*>\n aa10.\n*>\n*> Note these are S/L and P/L params\n*>\n     move     \"Address Delimiter\" to l5-data-2.\n     move     sl-delim to array-2 (29).\n     go       to main-exit.\n*>\n aa11.\n     move     \"Next Batch Number\" to l5-data-2.\n     move     25 to num-3.\n     move     first-sl-batch to num-6.\n     string   num-6 delimited by size into l5-data-2 with pointer num-3.\n     move     \"Proforma Retent.\" to l5-name.\n     move     pf-retention to num-9.\n     move     num-9 to l5-data-1.\n     go       to main-exit.\n*>\n aa12.  *> Right hand side only\n     move     \"BO Link \" to l5-data-2.\n     move     27 to Num-3.\n     if       SL-BO-Flag = \"Y\"\n              string   \"Yes\" delimited by size  into L5-Data-2\n                             with pointer num-3\n     else\n              string   \" No\" delimited by size  into L5-Data-2\n                             with pointer num-3.\n     go       to main-exit.\n*>\n aa13.  *> Right hand side only\n     move     \"BO Default \" to l5-data-2.\n     move     27 to Num-3.\n     if       SL-BO-Default = \"Y\"\n              string   \"Yes\" delimited by size  into L5-Data-2\n                             with pointer num-3\n     else\n              string   \" No\" delimited by size  into L5-Data-2\n                             with pointer num-3.\n     go       to main-exit.\n*>\n main-exit.\n     exit     section.\n*>\n copy \"Proc-Get-Env-Set-Files.cob\".\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So it's International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>          u-date = UK date format, if not spaces\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero or > 3\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n Maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n SystemMT-DAL section.\n*>*******************\n*>\n aa100-Check-4-Errors.\n*>\n*> System-Record - if any errors",
        "line": 86
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n *>        and  SQL-Err =\n     if       fs-reply not = zero\n              display SY106            at 0601 with erase eos  *> acas000/SystemMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n              display \"SQL Err = \"     at 0901\n              display SQL-Err          at 0911\n              display \"Err Msg = \"     at 1001\n              display SQL-Msg (1:229)  at 1011\n              display SY008 at 1301\n              accept  Accept-Reply at 1335\n              go to  aa100-Exit\n     end-if.\n*>\n aa100-Exit.\n     Exit.\n*>\n aa101-Check-4-Errors.\n*>\n*> Default-Record - if any errors",
        "line": 3014
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n *>        and  SQL-Err =\n     if       fs-reply not = zero\n              display SY107            at 0601 with erase eos  *> acas000/DfltMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n              display \"SQL Err = \"     at 0901\n              display SQL-Err          at 0911\n              display \"Err Msg = \"     at 1001\n              display SQL-Msg (1:229)  at 1011\n              display SY008 at 1301\n              accept  Accept-Reply at 1335\n     end-if.\n*>\n aa101-Exit.\n     Exit.\n*>\n aa102-Check-4-Errors.\n*>\n*> Sys4-Record - if any errors",
        "line": 3038
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n *>        and  SQL-Err =\n     if       fs-reply not = zero\n              display SY108            at 0601 with erase eos  *> acas000/Sys4MT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n              display \"SQL Err = \"     at 0901\n              display SQL-Err          at 0911\n              display \"Err Msg = \"     at 1001\n              display SQL-Msg (1:229)  at 1011\n              display SY008 at 1301\n              accept  Accept-Reply at 1335\n     end-if.\n*>\n aa102-Exit.\n     Exit.\n*>\n aa103-Check-4-Errors.\n*>\n*> Final-Record - if any errors",
        "line": 3061
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n *>        and  SQL-Err =\n     if       fs-reply not = zero\n              display SY109            at 0601 with erase eos  *> acas000/finalMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n              display \"SQL Err = \"     at 0901\n              display SQL-Err          at 0911\n              display \"Err Msg = \"     at 1001\n              display SQL-Msg (1:229)  at 1011\n              display SY008 at 1301\n              accept  Accept-Reply at 1335\n     end-if.\n*>\n aa103-Exit.\n     Exit.\n*>\n copy \"Proc-ACAS-Mapser-RDB.cob\". *>  uses ba000- etc  holds acas000 calls.\n*>",
        "line": 3084
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 13,
    "cognitive": 5,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 276,
      "totalOperators": 305,
      "totalOperands": 610,
      "vocabulary": 277,
      "length": 915,
      "volume": 7424.074081935008
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
