{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs060.cbl",
  "fileName": "irs060.cbl",
  "timestamp": "2025-09-15T16:25:48.793Z",
  "programId": "irs060",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 229
      },
      {
        "name": "file",
        "line": 240
      },
      {
        "name": "working-storage",
        "line": 261
      },
      {
        "name": "linkage",
        "line": 482
      },
      {
        "name": "init01",
        "line": 525
      },
      {
        "name": "CR-Total",
        "line": 1151
      },
      {
        "name": "DR-Total",
        "line": 1164
      },
      {
        "name": "Line-Total",
        "line": 1176
      },
      {
        "name": "Group-Total",
        "line": 1256
      },
      {
        "name": "write-out",
        "line": 1301
      },
      {
        "name": "ratio",
        "line": 1372
      },
      {
        "name": "date-validate",
        "line": 1397
      },
      {
        "name": "PL-Capital-AC-Tidyup",
        "line": 1572
      },
      {
        "name": "VAT-AC-TidyUp",
        "line": 1645
      },
      {
        "name": "Reset-Postings",
        "line": 1727
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 230
      },
      {
        "name": "File-Defs",
        "line": 522
      },
      {
        "name": "screen-heads",
        "line": 546
      },
      {
        "name": "sh-ends",
        "line": 552
      },
      {
        "name": "ml-b",
        "line": 569
      },
      {
        "name": "ml-1",
        "line": 584
      },
      {
        "name": "ml-2",
        "line": 593
      },
      {
        "name": "goback",
        "line": 635
      },
      {
        "name": "Read-Loop",
        "line": 641
      },
      {
        "name": "goback",
        "line": 662
      },
      {
        "name": "Read-End",
        "line": 683
      },
      {
        "name": "goback",
        "line": 723
      },
      {
        "name": "loop-1",
        "line": 725
      },
      {
        "name": "loop-1B",
        "line": 731
      },
      {
        "name": "loop-2",
        "line": 745
      },
      {
        "name": "loop-2B",
        "line": 751
      },
      {
        "name": "loop-3",
        "line": 773
      },
      {
        "name": "loop-3B",
        "line": 779
      },
      {
        "name": "loop-4",
        "line": 793
      },
      {
        "name": "loop-4B",
        "line": 799
      },
      {
        "name": "loop-5",
        "line": 835
      },
      {
        "name": "loop-5B",
        "line": 841
      },
      {
        "name": "loop-6",
        "line": 853
      },
      {
        "name": "loop-6B",
        "line": 859
      },
      {
        "name": "loop-8",
        "line": 880
      },
      {
        "name": "loop-8B",
        "line": 886
      },
      {
        "name": "loop-9",
        "line": 914
      },
      {
        "name": "loop-9B",
        "line": 920
      },
      {
        "name": "E-o-P-Option",
        "line": 972
      },
      {
        "name": "e-o-p-comp",
        "line": 988
      },
      {
        "name": "chk-defs",
        "line": 996
      },
      {
        "name": "goback",
        "line": 1007
      },
      {
        "name": "Get-PL",
        "line": 1009
      },
      {
        "name": "get-pl-rest",
        "line": 1021
      },
      {
        "name": "loop-a",
        "line": 1072
      },
      {
        "name": "by-pass",
        "line": 1079
      },
      {
        "name": "loop-b",
        "line": 1093
      },
      {
        "name": "e-o-p-fin",
        "line": 1111
      },
      {
        "name": "jump-back",
        "line": 1120
      },
      {
        "name": "goback",
        "line": 1130
      },
      {
        "name": "update-pl",
        "line": 1137
      },
      {
        "name": "E-o-P-End",
        "line": 1148
      },
      {
        "name": "loop-1",
        "line": 1212
      },
      {
        "name": "by-pass",
        "line": 1217
      },
      {
        "name": "loop-2",
        "line": 1229
      },
      {
        "name": "main-end",
        "line": 1246
      },
      {
        "name": "cr-value",
        "line": 1315
      },
      {
        "name": "dr-value",
        "line": 1326
      },
      {
        "name": "main-print",
        "line": 1337
      },
      {
        "name": "main-end",
        "line": 1364
      },
      {
        "name": "pack-loop-1",
        "line": 1472
      },
      {
        "name": "pack-loop-2",
        "line": 1482
      },
      {
        "name": "pack-end",
        "line": 1501
      },
      {
        "name": "ws-unpack",
        "line": 1515
      },
      {
        "name": "unpack-loop-1",
        "line": 1527
      },
      {
        "name": "unpack-loop-2",
        "line": 1549
      },
      {
        "name": "unpack-loop-3",
        "line": 1556
      },
      {
        "name": "unpack-end",
        "line": 1567
      },
      {
        "name": "pl-start",
        "line": 1574
      },
      {
        "name": "pl-a",
        "line": 1580
      },
      {
        "name": "goback",
        "line": 1604
      },
      {
        "name": "pl-a-end",
        "line": 1607
      },
      {
        "name": "goback",
        "line": 1618
      },
      {
        "name": "goback",
        "line": 1629
      },
      {
        "name": "goback",
        "line": 1639
      },
      {
        "name": "vat-a",
        "line": 1647
      },
      {
        "name": "vat-b",
        "line": 1652
      },
      {
        "name": "goback",
        "line": 1663
      },
      {
        "name": "goback",
        "line": 1672
      },
      {
        "name": "vat-c",
        "line": 1684
      },
      {
        "name": "goback",
        "line": 1707
      },
      {
        "name": "vat-finalize",
        "line": 1711
      },
      {
        "name": "goback",
        "line": 1721
      },
      {
        "name": "vat-exit",
        "line": 1724
      },
      {
        "name": "exit",
        "line": 1725
      },
      {
        "name": "read-n",
        "line": 1748
      },
      {
        "name": "main-end",
        "line": 1795
      },
      {
        "name": "main-exit",
        "line": 1801
      },
      {
        "name": "exit",
        "line": 1802
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 151,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "C$JUSTIFY",
        "line": 544,
        "type": "DYNAMIC",
        "using": [
          "ws-client",
          "\"C\""
        ]
      },
      {
        "target": "C$JUSTIFY",
        "line": 698,
        "type": "DYNAMIC",
        "using": [
          "l2-title",
          "\"C\""
        ]
      },
      {
        "target": "SYSTEM",
        "line": 962,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 220,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 227,
        "replacing": null
      },
      {
        "name": "irsprint-spool-command-p",
        "line": 275,
        "replacing": null
      },
      {
        "name": "irswsfinal",
        "line": 420,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 422,
        "replacing": null
      },
      {
        "name": "irswspost",
        "line": 423,
        "replacing": null
      },
      {
        "name": "irswsdflt",
        "line": 424,
        "replacing": null
      },
      {
        "name": "irsfdwsnl",
        "line": 426,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 427,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 431,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 463,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 485,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 488,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 518,
        "replacing": null
      },
      {
        "name": "if",
        "line": 1084,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 1804,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 152
      },
      {
        "target": "varying",
        "thru": null,
        "line": 560
      },
      {
        "target": "*>",
        "thru": null,
        "line": 562
      },
      {
        "target": "acasirsub5",
        "thru": null,
        "line": 567
      },
      {
        "target": "CR-Total",
        "thru": null,
        "line": 668
      },
      {
        "target": "DR-Total",
        "thru": null,
        "line": 671
      },
      {
        "target": "CR-Total",
        "thru": null,
        "line": 674
      },
      {
        "target": "DR-Total",
        "thru": null,
        "line": 677
      },
      {
        "target": "CR-Total",
        "thru": null,
        "line": 680
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 732
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 736
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 752
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 756
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 768
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 780
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 784
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 800
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 804
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 816
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 842
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 846
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 860
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 864
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 876
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 887
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 891
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 904
      },
      {
        "target": "line-total",
        "thru": null,
        "line": 921
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 925
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 936
      },
      {
        "target": "group-total",
        "thru": null,
        "line": 949
      },
      {
        "target": "ratio",
        "thru": null,
        "line": 960
      },
      {
        "target": "screen-heads",
        "thru": null,
        "line": 966
      },
      {
        "target": "acasirsub3",
        "thru": null,
        "line": 986
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 1033
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1039
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1045
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1051
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1060
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1069
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1070
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1075
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1091
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1096
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1108
      },
      {
        "target": "VAT-AC-TidyUp",
        "thru": null,
        "line": 1114
      },
      {
        "target": "PL-Capital-AC-Tidyup",
        "thru": null,
        "line": 1115
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1123
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1129
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1144
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1145
      },
      {
        "target": "Reset-Postings",
        "thru": null,
        "line": 1146
      },
      {
        "target": "write-out",
        "thru": null,
        "line": 1235
      },
      {
        "target": "write-out",
        "thru": null,
        "line": 1249
      },
      {
        "target": "cr-value",
        "thru": null,
        "line": 1304
      },
      {
        "target": "dr-value",
        "thru": null,
        "line": 1306
      },
      {
        "target": "cr-value",
        "thru": null,
        "line": 1308
      },
      {
        "target": "dr-value",
        "thru": null,
        "line": 1310
      },
      {
        "target": "cr-value",
        "thru": null,
        "line": 1312
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1577
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1578
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1583
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1598
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1603
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1612
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1617
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1628
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1633
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1638
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1655
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1662
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1671
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1687
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1701
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1706
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1715
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1720
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 1733
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1739
      },
      {
        "target": "date-validate",
        "thru": null,
        "line": 1742
      },
      {
        "target": "date-validate",
        "thru": null,
        "line": 1745
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1750
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1792
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1796
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1798
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "y",
        "line": 528
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 532
      },
      {
        "from": "run-date",
        "to": "p-date",
        "line": 534
      },
      {
        "from": "hd-hh",
        "to": "hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time",
        "line": 537
      },
      {
        "from": "client",
        "to": "ws-client",
        "line": 543
      },
      {
        "from": "zeros",
        "to": "total-1 (y) total-2 (y)\n     end-perform\n*>\n*>  Get the Final record for Finished Accounts printing if not space",
        "line": 561
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 566
      },
      {
        "from": "\"N\"",
        "to": "ws-reply",
        "line": 595
      },
      {
        "from": "1",
        "to": "Final-Acs-In-Use",
        "line": 601
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 602
      },
      {
        "from": "end-date",
        "to": "w-date   l10-date",
        "line": 604
      },
      {
        "from": "w-year",
        "to": "l5-year1 l5-year2",
        "line": 605
      },
      {
        "from": "WS-Listing-CC",
        "to": "L5-G1A (9:2)\n                                    L5-G2A (9:2)",
        "line": 614
      },
      {
        "from": "spaces",
        "to": "l5-grp2",
        "line": 618
      },
      {
        "from": "Work-Record",
        "to": "Record-1",
        "line": 647
      },
      {
        "from": "pl-title",
        "to": "l2-title",
        "line": 697
      },
      {
        "from": "spaces",
        "to": "line-3",
        "line": 699
      },
      {
        "from": "end-date",
        "to": "l3b-date\n              move \"For the Year Ended \" to l3b-t1\n     else\n              move \"For the Period From \" to l3a-t1\n              move \" to \"                 to l3a-t2\n              move start-date             to l3a-date1\n              move end-date               to l3a-date2",
        "line": 701
      },
      {
        "from": "ws-client",
        "to": "l1-client",
        "line": 708
      },
      {
        "from": "client",
        "to": "l10-client",
        "line": 709
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 714
      },
      {
        "from": "1",
        "to": "y",
        "line": 716
      },
      {
        "from": "level-11",
        "to": "level-21",
        "line": 737
      },
      {
        "from": "level-12",
        "to": "level-22",
        "line": 738
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 739
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 740
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 742
      },
      {
        "from": "level-21",
        "to": "level-11",
        "line": 759
      },
      {
        "from": "level-22",
        "to": "level-12",
        "line": 760
      },
      {
        "from": "\"T\"",
        "to": "group-level",
        "line": 761
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline2",
        "line": 763
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline4",
        "line": 765
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 767
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 769
      },
      {
        "from": "spaces",
        "to": "print-record  group-level",
        "line": 770
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 787
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 789
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 790
      },
      {
        "from": "level-21",
        "to": "level-11  net-1",
        "line": 807
      },
      {
        "from": "level-22",
        "to": "level-12  net-2",
        "line": 808
      },
      {
        "from": "\"T\"",
        "to": "group-level",
        "line": 809
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline2",
        "line": 811
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline4",
        "line": 813
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 815
      },
      {
        "from": "space",
        "to": "group-level",
        "line": 817
      },
      {
        "from": "zero",
        "to": "level-11  level-12\n                        level-21  level-22",
        "line": 818
      },
      {
        "from": "ws-equals",
        "to": "l8-underline2",
        "line": 820
      },
      {
        "from": "ws-equals",
        "to": "l8-underline4",
        "line": 822
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 824
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 833
      },
      {
        "from": "level-11",
        "to": "level-21",
        "line": 847
      },
      {
        "from": "level-12",
        "to": "level-22",
        "line": 848
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 849
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 850
      },
      {
        "from": "level-21",
        "to": "level-11",
        "line": 867
      },
      {
        "from": "level-22",
        "to": "level-12",
        "line": 868
      },
      {
        "from": "\"T\"",
        "to": "group-level",
        "line": 869
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline2",
        "line": 871
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline4",
        "line": 873
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 875
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 877
      },
      {
        "from": "spaces",
        "to": "print-record  group-level",
        "line": 878
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 894
      },
      {
        "from": "level-21",
        "to": "level-11",
        "line": 895
      },
      {
        "from": "level-22",
        "to": "level-12",
        "line": 896
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline2",
        "line": 897
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline4",
        "line": 899
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 901
      },
      {
        "from": "\"T\"",
        "to": "group-level",
        "line": 902
      },
      {
        "from": "ws-equals",
        "to": "l8-underline2\n     if       j > zero\n              move ws-equals to l8-underline4",
        "line": 905
      },
      {
        "from": "zero",
        "to": "level-11  level-12\n                        level-21  level-22",
        "line": 909
      },
      {
        "from": "spaces",
        "to": "print-record  group-level",
        "line": 911
      },
      {
        "from": "spaces",
        "to": "l8-underline2 l8-underline4",
        "line": 912
      },
      {
        "from": "level-11",
        "to": "level-21",
        "line": 927
      },
      {
        "from": "level-12",
        "to": "level-22",
        "line": 928
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 929
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 931
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 932
      },
      {
        "from": "net-1",
        "to": "level-11",
        "line": 934
      },
      {
        "from": "net-2",
        "to": "level-12",
        "line": 935
      },
      {
        "from": "zero",
        "to": "level-11  level-12",
        "line": 939
      },
      {
        "from": "level-21",
        "to": "level-11",
        "line": 940
      },
      {
        "from": "level-22",
        "to": "level-12",
        "line": 941
      },
      {
        "from": "\"T\"",
        "to": "group-level",
        "line": 942
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline2",
        "line": 944
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline4",
        "line": 946
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 948
      },
      {
        "from": "zero",
        "to": "level-11  level-12\n                        level-21  level-22",
        "line": 950
      },
      {
        "from": "ws-equals",
        "to": "l8-underline2",
        "line": 952
      },
      {
        "from": "ws-equals",
        "to": "l8-underline4",
        "line": 954
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 985
      },
      {
        "from": "PL-Approp-AC",
        "to": "PL-AC\n     end-if\n     display \"Enter P/L Appropriation or Capital A/C :- \" at 1301 with foreground-color 2",
        "line": 1013
      },
      {
        "from": "pl-ac",
        "to": "owning",
        "line": 1042
      },
      {
        "from": "zero",
        "to": "sub-nominal",
        "line": 1043
      },
      {
        "from": "PL-AC",
        "to": "PL-Approp-AC",
        "line": 1066
      },
      {
        "from": "ws-ac2",
        "to": "ws-ac",
        "line": 1068
      },
      {
        "from": "record-1",
        "to": "nl-record",
        "line": 1084
      },
      {
        "from": "dr",
        "to": "dr-last (j)\n     move     cr  to  cr-last (j)",
        "line": 1087
      },
      {
        "from": "zero",
        "to": "dr  cr",
        "line": 1090
      },
      {
        "from": "dr",
        "to": "dr-last (j)\n     move     cr  to  cr-last (j)",
        "line": 1103
      },
      {
        "from": "zero",
        "to": "dr  cr",
        "line": 1106
      },
      {
        "from": "nl-ac",
        "to": "ac",
        "line": 1107
      },
      {
        "from": "pl-ac",
        "to": "owning",
        "line": 1117
      },
      {
        "from": "zero",
        "to": "sub-nominal",
        "line": 1118
      },
      {
        "from": "owning",
        "to": "sub-nominal",
        "line": 1133
      },
      {
        "from": "rec-pointer",
        "to": "owning",
        "line": 1134
      },
      {
        "from": "\"(\"",
        "to": "l7-sign1\n              move  \")\"  to  l7-sign2\n     else\n              move  space  to  l7-sign1  l7-sign2",
        "line": 1200
      },
      {
        "from": "\"(\"",
        "to": "l7-sign5\n              move  \")\"  to  l7-sign6\n     else\n              move  space  to  l7-sign5  l7-sign6",
        "line": 1206
      },
      {
        "from": "record-1",
        "to": "nl-record",
        "line": 1226
      },
      {
        "from": "zero",
        "to": "l7-value1  l7-value3",
        "line": 1269
      },
      {
        "from": "\"(\"",
        "to": "l7-sign3\n*>                            l7-sign1\n              move  \")\"  to  l7-sign4\n*>                            l7-sign2\n     else\n              move  space  to  l7-sign3  l7-sign4",
        "line": 1272
      },
      {
        "from": "\"(\"",
        "to": "l7-sign7\n*>                            l7-sign5\n              move  \")\"  to  l7-sign8\n*>                            l7-sign6\n     else\n              move  space  to  l7-sign7  l7-sign8",
        "line": 1280
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline1",
        "line": 1286
      },
      {
        "from": "ws-hypens",
        "to": "l8-underline3",
        "line": 1288
      },
      {
        "from": "spaces",
        "to": "l7-sign1 l7-sign2 l7-sign3 l7-sign4  l7-sign5\n                        l7-sign6 l7-sign7 l7-sign8",
        "line": 1293
      },
      {
        "from": "zero",
        "to": "l7-value1  l7-value2 l7-value3  l7-value4",
        "line": 1296
      },
      {
        "from": "spaces",
        "to": "line-8",
        "line": 1297
      },
      {
        "from": "zero",
        "to": "work-1",
        "line": 1317
      },
      {
        "from": "zero",
        "to": "work-2",
        "line": 1318
      },
      {
        "from": "zero",
        "to": "work-1",
        "line": 1328
      },
      {
        "from": "zero",
        "to": "work-2",
        "line": 1329
      },
      {
        "from": "\"(\"",
        "to": "l9-sign1\n              move  \")\"  to  l9-sign2\n     else\n              move  space  to  l9-sign1  l9-sign2",
        "line": 1347
      },
      {
        "from": "\"(\"",
        "to": "l9-sign3\n              move  \")\"  to  l9-sign4\n     else\n              move  space  to  l9-sign3  l9-sign4",
        "line": 1353
      },
      {
        "from": "spaces",
        "to": "l9-name",
        "line": 1366
      },
      {
        "from": "zero",
        "to": "work-1  work-2",
        "line": 1367
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1378
      },
      {
        "from": "zero",
        "to": "q",
        "line": 1420
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1461
      },
      {
        "from": "1",
        "to": "ws-work1",
        "line": 1462
      },
      {
        "from": "zero",
        "to": "ws-work2",
        "line": 1463
      },
      {
        "from": "zero",
        "to": "u-bin\n              go to  pack-end",
        "line": 1469
      },
      {
        "from": "zero",
        "to": "u-bin\n              go to pack-end",
        "line": 1484
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1499
      },
      {
        "from": "u-bin",
        "to": "save-date",
        "line": 1518
      },
      {
        "from": "\"00/00/00\"",
        "to": "u-date",
        "line": 1520
      },
      {
        "from": "zero",
        "to": "u-year",
        "line": 1521
      },
      {
        "from": "1",
        "to": "u-month",
        "line": 1522
      },
      {
        "from": "0",
        "to": "u-days",
        "line": 1523
      },
      {
        "from": "1",
        "to": "ws-work1",
        "line": 1524
      },
      {
        "from": "zero",
        "to": "ws-work2",
        "line": 1525
      },
      {
        "from": "365",
        "to": "save-date\n              go to unpack-loop-2",
        "line": 1544
      },
      {
        "from": "31",
        "to": "u-days\n              move  12  to  u-month\n              go to  unpack-end",
        "line": 1552
      },
      {
        "from": "zero",
        "to": "nl-cr nl-dr",
        "line": 1576
      },
      {
        "from": "ac2",
        "to": "ac",
        "line": 1594
      },
      {
        "from": "zero",
        "to": "cr dr",
        "line": 1597
      },
      {
        "from": "pl-ac",
        "to": "owning",
        "line": 1610
      },
      {
        "from": "zero",
        "to": "sub-nominal",
        "line": 1611
      },
      {
        "from": "nl-dr",
        "to": "dr",
        "line": 1631
      },
      {
        "from": "nl-cr",
        "to": "cr",
        "line": 1632
      },
      {
        "from": "zero",
        "to": "sub-nominal",
        "line": 1650
      },
      {
        "from": "rec-pointer",
        "to": "owning\n              go to vat-b",
        "line": 1677
      },
      {
        "from": "record-1",
        "to": "nl-record",
        "line": 1682
      },
      {
        "from": "zero",
        "to": "dr  cr",
        "line": 1699
      },
      {
        "from": "nl-record",
        "to": "Record-1",
        "line": 1714
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 1734
      },
      {
        "from": "3",
        "to": "access-type",
        "line": 1735
      },
      {
        "from": "zero",
        "to": "u-bin pl-ac save-sequ",
        "line": 1740
      },
      {
        "from": "end-date",
        "to": "u-date",
        "line": 1741
      },
      {
        "from": "spaces",
        "to": "u-date",
        "line": 1744
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 1746
      },
      {
        "from": "zero",
        "to": "cr\n       else\n              subtract dr from cr\n              move zero to dr",
        "line": 1764
      },
      {
        "from": "u-date",
        "to": "post-date",
        "line": 1769
      },
      {
        "from": "spaces",
        "to": "post-vat-side",
        "line": 1770
      },
      {
        "from": "pl-ac",
        "to": "post-key",
        "line": 1772
      },
      {
        "from": "zero",
        "to": "vat-ac-def vat-amount",
        "line": 1774
      },
      {
        "from": "sub-nominal",
        "to": "owning",
        "line": 1778
      },
      {
        "from": "owning",
        "to": "post-dr\n              move dr to post-amount\n     else\n      if      cr > zero\n              move owning to post-cr\n              move cr to post-amount",
        "line": 1781
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 1791
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 1797
      },
      {
        "from": "pl-ac",
        "to": "next-post",
        "line": 1799
      }
    ],
    "computes": [
      {
        "target": "u-bin",
        "expression": "u-year * 365",
        "line": 1466
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "the defaults have been set up\n*>                         correctly including accounts 30 and 31 (VAT/GST/sales Tax)]:-\n*>                       IR061 Default A/C 30 or 31 Not setup - As specified\n*>                             A/C 30 = O.T.B Control Account\n*>                             A/C 31 = Vat Input\n*>                             A/C 32 = Vat Output\n*>                       (Default 31 A/C) does not exist..ABORTING\n*>                                      - As this is tested prior\n*>                                         It is more likely a bug\n*>                                         by bad data in defaults.\n*> Possible software bugs :\n*>                       These have never appeared in testing or production\n*>                       in over 30 years\n*>                       but if they do, it indicates very serious errors\n*>                       with the data or more importantly missing data.\n*>                       It could indicate a problem with your hard drive\n*>                       or *lack of free space\n*>                       but definitely now, data corruption. More likely a Bug !\n*>                        - or in other words - Have no idea why!\n*>\n*>                       PE 005946   Error within Read-End  - work file EOF\n*>                                                            (sorted postings).\n*>                       PE 009865   Error within line-total (bypass)\n*>                                                          - Problem with workfile data.\n*>                       PE 009610   Error within jump-back - Missing NL record.\n*>                       *PE 014900  Error within pl-a      - Cannot rewrite record.\n*>                       PE 015000   Error within pl-a-end  - Missing NL rec PL approp.\n*>                       PE 015010   Error within pl-a-end  - PL approp not a Main a/c.\n*>                                  [Last two should not occur as tested for earlier in\n*>                                   the program].\n*>                       PE 015100   Error within pl-a-end  - Cannot Rewrite record.\n*>                       (Default 31 A/C) does not exist..ABORTING - Should not happen as\n*>                                                                   previously tested for.\n*>                       PE VAT01: Problems with CoA file - Bad coding\n*>                                   Error within VAT-AC-TidyUp\n*>                                                          - Fault in NL records.\n*>                       *PE 015370: Problems with CoA file cant rewrite\n*>                                   Error within VAT-AC-TidyUp (vat-c)\n*>                                                          - Cannot Rewrite record.\n*>                       *PE 015470: Problems on rewrite for CoA file\n*>                                   Error within VAT-AC-TidyUp (vat-finalize)\n*>                                                          - Cannot Rewrite record.\n*>\n*>                       IT IS RECOMMENDED THAT you restore your data from the\n*>                       last good back up and rerun HAVING made a back up of\n*>                       your CURRENT data files.\n*>**\n*> Changes.\n*>  1/7/83  vbc - Improve running time, split prog into 2 (irs065)\n*>                thru-put increased by 650%.\n*>  2/7/83  vbc - Tidy up final reports, tb & fa.\n*>  8/7/83  vbc - Correct date-validate routine, for end of year\n*>                 and begining of new year.\n*>  9/7/83  vbc - Fix end of year processing by adding new routine\n*>                PL-Capital-AC-Tidyup.\n*> 13/7/83  vbc - Reset save-sequ if changing post file.\n*> 20/7/83  vbc - Reduce size of nl file.\n*> 22/7/83  vbc - Fix ratios,fix eop processing.\n*> 26/7/83  vbc - Rewrite date vet routine.\n*> 10/8/83  vbc - Validate & reject if ness, p/l account earlier\n*>                squash up vat a/cs,ditto code accounts same as\n*>                P/L account at end of period processing.\n*>  6/9/83  vbc - Fix bugs:- dont create otb post rec at eop;\n*>                           in PL-Capital-AC-Tidyup, group add\n*>                           all records with same type (ac);\n*>                           check otb balance to zero.\n*> 26/03/84 vbc - Y & P on report request 2 b reversed.\n*> 28/05/84 vbc - Hilite display heads.\n*> 14/04/85 vbc - Change print to 79 chars.\n*> 26/09/89 vbc - 2.53\n*>                Mods for cobol/2.\n*> 23/01/09 vbc - Migration to Open Cobol as version 3.\n*> 20/02/09 vbc - Centre client in reports.\n*> 21/02/09 vbc - Added support for envs LINES and COLUMNS as needed.\n*> 21/09/10 vbc - Added print spool.\n*>                .11 fix for portrait printing\n*> 16/12/13 vbc - .12 Removed security test/password prior to print report.\n*> 12/10/16 vbc - .13 Added preload of PL-Approp-AC if PL-App-Created = 1.\n*>                    Prep. of Finished A/Cs for all 9 groups.\n*>                    Sub groups not used so only 1,5,9,11,15,18,21,23.\n*>                    Are the others needed, such as 8,14,20,22,25,26 ? [for] :\n*>                    ( 8) Gross Profit\n*>                    (14) Net Profit\n*>                    (20) Total Assets\n*>                    (22) Net Current Assets\n*>                    (25) Net Profits\n*>                    (26) Net Current Assets\n*> 04/12/16 vbc - v3.02 RDB\n*> 04/12/16 vbc - .14 RDB support via acasirsub(1-5) & DALs and using\n*>                    standard ACAS param file (system.dat) for info pickup\n*>                    passed to IRS-System-Params (renamed from system-record).\n*>                    Replaced all occurances of call \"irsubn\" by\n*>                     perform acasirsubn\n*>                    File-Defs  added to all irsnnn calls as 2nd param.\n*>                    Clean up all msgs to use Pre-Defined ones system/module\n*>                    wide across entire IRS system in compliance with all of\n*>                    ACAS.\n*>                    Replace direct access (open,read,write,close) for NL\n*>                    for FH & DAL. Must have been written before using FH\n*>                    The temp. Work file is ALWAYS a Cobol file.\n*> 20/12/16 vbc -     All irs progs call cpybk Proc-ZZ100-ACAS-IRS-Calls.\n*> 29/01/18 vbc - .15 Added extra error / warning messages although most\n*>                    have never appeared. msgs for Defaults A/C 30 or 31\n*>                    being not present (missing) must be fixed by using the\n*>                    correct program (irs020 - Defaults Maintenance.\n*>                    Changed copies to use copybooks where poss. I.e.,\n*>                    renamed print-spool-commandxxx & wsnl to irsprint-spool-command\n*>                    & irswsnl as moved to copybooks dir.\n*> 07/02/18 vbc - .16 Removed the pls wait while printing msg.\n*> 08/02/18 vbc - .17 Remapped the NL Record-1 with NL-IRSWS-Record so no need\n*>                    to issue move between them so only needed for NL-Record\n*>                    as originally held in WS for a temp. rec.\n*>                    This hopefully will ensure that there is no garbage data.\n*>                    Should have done it the first time.\n*> 10/02/18 vbc - .18 Moved many of the error/warning messages to IR0nn.\n*> 10/02/18 vbc - .19 Renamed IR011-16 to IR911-16 and others.\n*>                .20 After reading Work file move to Record-1 as this is the\n*>                    same as same rec area for work file and nominal record.\n*> 11/02/18 vbc - .21 Close sub1 before gobacks and print-file if open.\n*> 12/02/18 vbc - .22 Y2K problem found when processing accounts of 1989-90 -\n*>                    new WS field WS-Y2K-slide holding 70 if YY < slide, its 20nn\n*>                    else its 19nn.\n*>                    On accepting PL-Approp allow for zero to quit.\n*> 26/03/18 vbc -     Added more notes on error messages including the PE ones.\n*>                    Yep, PE = Program Error or ???\n*> 02/05/18 vbc - .23 Added date/Time to report & do this for most of the\n*>                    reports in IRS as it is hard to work out the latest reports.\n*> 13/05/18 vbc - .24 Added extra field for use with Slide (see .22 note)\n*>                    pre-coded if year is > 2068 and < 2100.\n*>                    Code change will still be needed.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n copy \"envdiv.cob\".\n*>\n input-output section.\n file-control.\n*>\n     select  work-file       assign \"worksort.tmp\"\n                             organization sequential\n                             status fs-reply.\n*>\n     select  print-file      assign \"prt-1\"\n                             organization line sequential.\n*>\n data division.\n file section.\n*>\n fd  work-file.\n*>\n 01  work-record.\n     03  work-key        pic 9(10).\n     03  work-type       pic a.\n     03  work-data.\n         05 work-name    pic x(24).\n         05 work-dr      pic 9(8)v99  comp.\n         05 work-cr      pic 9(8)v99  comp.\n         05 work-dr-last pic 9(8)v99  comp  occurs 4.\n         05 work-cr-last pic 9(8)v99  comp  occurs 4.\n         05 work-ac      pic a.\n    03  filler  redefines work-data.\n        05 work-pointer  pic 9(5).\n*>\n fd  print-file.\n*>\n 01  print-record        pic x(79).\n*>\n working-storage section.\n 77  prog-name           pic x(16)    value \"irs060 (3.02.24)\".\n 77  a                   binary-char  value zero.\n 77  b                   binary-char  value zero.\n 77  C                   binary-char  value zero.\n 77  ws-client           pic x(24)    value spaces.\n 77  Final-Acs-In-Use    pic 9        value zero.  *> 1 if true\n*>\n*> This one will need changing in year 2069 on and only used if processing\n*>  data before 2000.\n*>\n 77  WS-Y2K-slide        pic 99       value 70.    *> dates below = 20 else 19.\n 77  WS-Listing-CC       pic 99       value 19.    *> used in paragraph ML-2\n*>\n copy \"irsprint-spool-command-p.cob\".\n*>\n 01  filler.\n     03  w-date.\n         05  filler      pic x(6).\n         05  w-year      pic 99.\n     03  ws-reply        pic x.\n     03  total-1         pic s9(8)v99  comp occurs 26.\n     03  total-2         pic s9(8)v99  comp occurs 26.\n     03  level-11        pic s9(8)v99  comp value zero.\n     03  level-12        pic s9(8)v99  comp value zero.\n     03  level-21        pic s9(7)v99  comp value zero.\n     03  level-22        pic s9(7)v99  comp value zero.\n     03  net-1           pic s9(7)v99  comp value zero.\n     03  net-2           pic s9(7)v99  comp value zero.\n     03  PL-AC           pic 9(5)     value zero.\n     03  letters         pic x(26)    value \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".\n     03  filler  redefines  letters.\n         05  ar0         pic x       occurs  26  indexed by  w.\n     03  j               pic 9.\n     03  y               pic 99.\n     03  z               pic 99.\n     03  group-level     pic x.\n         88  sub-total                value \"T\".\n     03  work-1          pic s9(9)v99  comp value zero.\n     03  work-2          pic s9(9)v99  comp value zero.\n     03  work-3          pic s9(9)v99  comp value zero.\n     03  PL-Title        pic x(40).\n     03  PL-Rep-Type     pic x.\n     03  PL-Rep-Type2    pic x.\n     03  NL-File         pic x(11).\n*>     03  WS-Pass         pic x(4).\n     03  WS-Hypens       pic x(9)     value \"---------\".\n     03  WS-Equals       pic x(9)     value \"=========\".\n     03  WS-AC           pic x        value space.\n     03  WS-AC2          pic x        value space.\n     03  AC2             pic x.\n*>\n     03  hdtime                          value spaces.\n         05  hd-hh       pic xx.\n         05  hd-mm       pic xx.\n         05  hd-ss       pic xx.\n         05  hd-uu       pic xx.\n     03  HD2-Time.\n         05  filler      pic x     value spaces.\n         05  hd2-hh      pic xx.\n         05  filler      pic x     value \":\".\n         05  hd2-mm      pic xx.\n*>\n*>     03  WS-Pass         pic x(1024).  *> Not on OS versions.\n*>     03  WS-Encript-Pass pic x(1024).\n*>\n 01  filler.\n     03  line-1.\n         05  filler      pic x(28)    value spaces.\n         05  l1-client   pic x(24).\n         05  filler      pic x(13)    value spaces.\n         05  p-date      pic x(8).\n         05  P-Time      pic x(6)     value spaces.\n*>\n     03  line-2.\n         05  filler      pic x(20)    value spaces.\n         05  l2-title    pic x(40).\n         05  filler      pic x(19)    value spaces.\n*>\n     03  line-3.\n       05  line-3a.\n         07  filler      pic x(19).\n         07  l3a-t1      pic x(20).\n         07  l3a-date1   pic x(8).\n         07  l3a-t2      pic xxxx.\n         07  l3a-date2   pic x(8).\n         07  filler      pic x(20).\n       05  line-3b redefines line-3a.\n         07  filler      pic x(25).\n         07  l3b-t1      pic x(19).\n         07  l3b-date    pic x(8).\n         07  filler      pic x(27).\n*>\n     03  line-5.\n       05  filler        pic x(34)    value spaces.\n       05  l5-grp1b.\n         07  l5-g1a      pic x(10)    value \"--------20\".\n         07  l5-year1    pic 99       value zero.\n         07  l5-g1c      pic x(8)     value all \"-\".\n       05  l5-grp1 redefines l5-grp1b pic x(20).\n       05  filler        pic x(5)     value spaces.\n       05  l5-grp2b.\n         07  l5-g2a      pic x(10)    value \"--------20\".\n         07  l5-year2    pic 99       value zero.\n         07  l5-g2c      pic x(8)     value all \"-\".\n       05  l5-grp2 redefines l5-grp2b pic x(20).\n*>\n     03  line-7.\n       05  filler        pic xx       value spaces.\n       05  l7-name       pic x(27).\n       05  filler        pic x(5)     value spaces.\n       05  l7-sign1      pic x.\n       05  l7-value1     pic z(6)9    blank when zero.\n       05  l7-sign2      pic x.\n       05  filler        pic xx       value spaces.\n       05  l7-sign3      pic x.\n       05  l7-value2     pic z(6)9    blank when zero.\n       05  l7-sign4      pic x.\n       05  filler        pic x(5)     value spaces.\n       05  l7-sign5      pic x.\n       05  l7-value3     pic z(6)9    blank when zero.\n       05  l7-sign6      pic x.\n       05  filler        pic xx       value spaces.\n       05  l7-sign7      pic x.\n       05  l7-value4     pic z(6)9    blank when zero.\n       05  l7-sign8      pic x.\n*>\n     03  line-8.\n       05  filler        pic x(34)    value spaces.\n       05  l8-underline1 pic x(9).\n       05  filler        pic x(2)     value spaces.\n       05  l8-underline2 pic x(9).\n       05  filler        pic x(5)     value spaces.\n       05  l8-underline3 pic x(9).\n       05  filler        pic x(2)     value spaces.\n       05  l8-underline4 pic x(9).\n*>\n     03  line-9.\n       05  l9-name       pic x(34).\n       05  l9-sign1      pic x.\n       05  l9-value1     pic z(6)9    blank when zero.\n       05  l9-sign2      pic x.\n       05  filler        pic x(16)    value spaces.\n       05  l9-sign3      pic x.\n       05  l9-value2     pic z(6)9    blank when zero.\n       05  l9-sign4      pic x.\n       05  filler        pic x(11)    value spaces.\n*>\n     03  line-10.\n       05  l10-client    pic x(24).\n       05  filler        pic x(6)     value spaces.\n       05  filler        pic x(23)    value \"    Sales Ratios    \".\n       05  filler        pic x(18)    value \"      Period To - \".\n       05  l10-date      pic x(8).\n*>\n     03  line-11.\n       05  l11-name      pic x(24).\n       05  l11-ratio     pic zzz9.99.\n*>\n copy \"irswsfinal.cob\".\n*>\n copy \"wsfnctn.cob\".\n copy \"irswspost.cob\".\n copy \"irswsdflt.cob\"     replacing Default-Record by WS-IRS-Default-Record.\n*>\n copy \"irsfdwsnl.cob\".               *> Record-1 from old FD\n copy \"irswsnl.cob\" replacing  ==nl-record== by ==WS-IRSNL-Record redefines Record-1==\n                        leading ==NL-==  by ==FD-NL-==\n                                   Owner by FD-NL-Owner.\n*>\n copy \"irswsnl.cob\".                     *> needed for WS ( [NL]-Record ) previous code.\n*>\n*> read in and moved to old FD\n*>\n 01  maps03-ws.\n     03  u-date          pic x(8).\n     03  filler  redefines  u-date.\n       05  u-days        pic 99.\n       05  filler        pic x.\n       05  u-month       pic 99.\n       05  filler        pic x.\n       05  u-year        pic 99.\n     03  u-bin           pic s9(5)    comp.\n*>\n 01  date-fields.\n     03  q                 pic s99    comp  value zero.\n*>\n     03  days-in-month     pic x(24)  value \"312831303130313130313031\".\n     03  filler  redefines  days-in-month.\n       05  days            pic 99     occurs 12.\n*>\n     03  ws-work1          pic s9(5)   comp.\n     03  ws-work2          pic s9(5)   comp.\n     03  save-date         pic s9(5)   comp.\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n  *>     03  WS-IRSNL-Record       pic x.\n  *>     03  WS-IRS-Default-Record pic x.\n  *>     03  Posting-Record        pic x.\n  *>     03  Final-Record          pic x.\n     03  WS-IRS-Posting-Record pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide      USED are : 08\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific  USED are :\n     03  IR060          pic x(52) value \"IR060 Aborting End of year processing. Fix and rerun\".\n     03  IR061          pic x(36) value \"IR061 Default A/C 30 or 31 Not setup\".\n     03  IR062          pic x(35) value \"IR062 Failure to open Work File!!!!\".\n     03  IR063          pic x(41) value \"IR063 Ledgers Incorrectly Coded! Aborting\".\n     03  IR064          pic x(55) value \"IR064 Does not exist. Hit return,",
        "line": 60
      },
      {
        "type": "IF",
        "condition": "hdtime not = \"00000000\"\n              move hd-hh to hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time.\n*>\n*> Fix up client to justified centre\n*>\n     move     client to ws-client.\n     call     \"C$JUSTIFY\" using ws-client \"C\".\n*>\n screen-heads.\n*>\n     display  prog-name                   at 0101 with erase eos foreground-color 2.\n     display  \"Final Accounts Production\" at 0129 with foreground-color 1 background-color 7.\n     display  run-date                    at 0173 with foreground-color 2.\n*>\nsh-ends.\n*>\n*> Password coding simplified /removed for O/S. versions.\n*>     display  \"Enter pass-word - [****]\"  at 0501 with foreground-color 2.\n*>     accept   ws-pass at 0520 with secure.\n*>     if       ws-pass not = pass-word\n*>              go to e-o-p-end.\n*>\n     perform  varying y from 1 by 1 until y > 26\n              move zeros to total-1 (y) total-2 (y)\n     end-perform\n*>\n*>  Get the Final record for Finished Accounts printing if not space.\n*>\n     move     3  to  file-function.                *> Open & Read next, close\n     perform  acasirsub5.\n*>\n ml-b.\n*>---\n*>\n     display  \"Enter comparative to use (0 to 4) -  [ ]\" at 0801 with foreground-color 2.\n     accept   j  at 0839 with foreground-color 3.\n     if       j  <  0  or  >  4\n              go to  ml-b.\n*>\n*> Get profit & loss report title\n*>\n     display  \"Enter Profit & Loss Report Title     [\" at 1001 with foreground-color 2.\n     display  \"]\" at 1079 with foreground-color 2.\n     move     \"Profit and Loss Report\" to pl-title.\n     accept   pl-title at 1039 with update foreground-color 3.\n*>\n ml-1.\n*>---\n*>\n     display  \"Period Report (P) or Year Report (Y) [ ]\" at 1101 with foreground-color 2.\n     accept   pl-rep-type2 at 1139 with foreground-color 6.\n     move     function upper-case (pl-rep-type2) to pl-rep-type.\n     if       pl-rep-type not = \"P\" and not = \"Y\"\n              go to ml-1.\n*>\n ml-2.\n     display  \"Use Finished Account Titles if set up ?  [ ]\" at 1201 with foreground-color 2.\n     move     \"N\" to ws-reply.\n     accept   ws-reply  at 1243 with update foreground-color 6.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply not = \"Y\" and not = \"N\"\n              go to ml-2.\n     if       ws-reply = \"Y\"\n              move  1   to Final-Acs-In-Use.\n     move     space to ws-reply.\n*>\n     move     end-date to w-date   l10-date.\n     move     w-year   to l5-year1 l5-year2.\n     subtract 1  from  l5-year2.\n*>\n*> Check year for Y2K etc and adjust for dates within 19nn else 20\n*>  Found when processing old accounts of 1989-1990. It could happen\n*>   for others. This is for the listing heads.\n*>   Need to increase to 20 else 21 after year 2069.\n*>\n     if       W-Year NOT < WS-Y2K-slide  *> (70)\n              move WS-Listing-CC to L5-G1A (9:2)\n                                    L5-G2A (9:2).\n*>\n     if       j = zero\n              move spaces to l5-grp2.\n*>    display  \"Give Title 1 - [\" at 1301 with foreground-color 2.\n*>    display  \"]\"                at 1337 with foreground-color 2.\n*>    display  l5-grp1            at 1317 with foreground-color 3.\n*>    accept   l5-grp1            at 1317 with foreground-color 3 update.\n*>    if       j not = zero\n*>             display \"2\"        at 1312 with foreground-color 2\n*>             display l5-grp2    at 1317 with foreground-color 3\n*>             accept  l5-grp2    at 1317 with foreground-color 3 update.\n*>\n     display  \"Checking Accounts Please Wait\" at 1601 with foreground-color 2.\n     open     input  work-file.\n     if       fs-reply  not = zero\n              display IR062 at 2401 with foreground-color 2\n              display SY008   at 2441\n              accept ws-reply at 2475\n              close work-file\n              goback.\n*>\n*> This section reads the sorted nominal ledger workfile with\n*> main accounts only. the grand total for each A/C type\n*> and its required comparative are calculated\n*>\n Read-Loop.\n*>--------\n*>\n     read     work-file at end\n              go to  Read-End.\n*>\n     move     Work-Record to Record-1.\n     set      w  to  1.\n     move     function upper-case (ac) to ac2.\n     search   ar0\n              when  ar0 (w)  =  ac2\n              go to  Accumulate.\n     display  space.\n     display  IR063  at 0501 with foreground-color 2.\n     display  \"ACCOUNT  - \" at 0701          with foreground-color 2.\n     display  owning at 0713                 with foreground-color 2.\n     display  \"/\" at 0718                    with foreground-color 2.\n     display  sub-nominal at 0719            with foreground-color 2.\n     display  SY008    at 0801\n     accept   ws-reply at 0835\n     close    work-file.\n     goback.\n*>\n Accumulate.         *> Gets here",
        "line": 536
      },
      {
        "type": "IF",
        "condition": "ac  <  \"E\"\n              perform  CR-Total\n              go to Read-Loop.\n     if       ac  >  \"D\"  and  <  \"I\"\n              perform  DR-Total\n              go to Read-Loop.\n     if       ac  = \"I\"  or  \"J\"\n              perform  CR-Total\n              go to Read-Loop.\n     if       ac  >  \"J\"  and  <  \"U\"\n              perform  DR-Total\n              go to Read-Loop.\n     if       ac  >  \"T\"\n              perform  CR-Total.\n     go       to Read-Loop.\n*>\n Read-End.\n*>-------\n*>\n     close    work-file.\n*>\n*> This section produces the P & L Report\n*>\n*> Reopen nominal ledger (work) & open print-file\n*>\n     open     input  work-file.\n     open     output  print-file.\n*>\n*> Set up title lines\n*>\n     move     pl-title to l2-title.\n     call     \"C$JUSTIFY\" using l2-title \"C\".\n     move     spaces   to line-3.\n     if       pl-rep-type = \"Y\"\n              move end-date to l3b-date\n              move \"For the Year Ended \" to l3b-t1\n     else\n              move \"For the Period From \" to l3a-t1\n              move \" to \"                 to l3a-t2\n              move start-date             to l3a-date1\n              move end-date               to l3a-date2.\n     move     ws-client to l1-client.\n     move     client    to l10-client.\n     write    print-record  from  line-1 after 1.\n     write    print-record  from  line-2 after 2.\n     write    print-record  from  line-3 after 2.\n     write    print-record  from  line-5 after 2.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     1  to  y.\n     read     work-file at end\n              display \"PE 005946\" at 2401\n              display SY008 at 2441\n              accept ws-reply at 2475\n              close work-file\n                    print-file\n              goback.\n*>\n loop-1.\n*>-----\n*>\n*>  Do account types A - D\n*>\n     move     \"Total Income\"  to  l7-name.\n loop-1B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  5\n              go to  loop-1B.\n     perform  group-total.\n     move     level-11  to  level-21.\n     move     level-12  to  level-22.\n     move     zero  to  level-11  level-12.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n*>\n loop-2.\n*>-----\n*>\n*>  Do account types E - H\n*>\n     move     \"Less Total Direct Costs\"  to  l7-name.\n loop-2B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  9\n              go to  loop-2B.\n     perform  group-total.\n     subtract level-11  from  level-21.\n     subtract level-12  from  level-22.\n     move     level-21  to  level-11.\n     move     level-22  to  level-12.\n     move     \"T\"  to  group-level.\n     move     \"Gross Profit\"  to  l7-name.\n     move     ws-hypens to l8-underline2.\n     if       j > zero\n              move ws-hypens to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces  to  line-8.\n     perform  group-total.\n     move     zero  to  level-11  level-12.\n     move     spaces  to  print-record  group-level.\n     write    print-record after 1.\n*>\n loop-3.\n*>-----\n*>\n*>  Do account types I - J.\n*>\n     move     \"Plus Sundry Income\"  to  l7-name.\n loop-3B.\n     perform  line-total.\n     add      1  to  y\n     if       y  <  11\n              go to  loop-3B.\n     perform  group-total.\n     add      level-11  to  level-21.\n     add      level-12  to  level-22.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     zero  to  level-11  level-12.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n*>\n loop-4.\n*>-----\n*>\n*>  Do account types K - N.\n*>\n     move     \"Less Total Indirect Costs\"  to  l7-name.\n loop-4B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  15\n              go to  loop-4B.\n     perform  group-total.\n     subtract level-11  from  level-21.\n     subtract level-12  from  level-22.\n     move     level-21  to  level-11  net-1.\n     move     level-22  to  level-12  net-2.\n     move     \"T\"  to  group-level.\n     move     \"Net Profit\"  to  l7-name.\n     move     ws-hypens to l8-underline2.\n     if       j > zero\n              move ws-hypens to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces to line-8.\n     perform  group-total.\n     move     space to  group-level.\n     move     zero  to  level-11  level-12\n                        level-21  level-22.\n     move     ws-equals to l8-underline2.\n     if       j > zero\n              move ws-equals to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces to line-8.\n*>\n*> This section produces the balance sheet\n*>\n     write    print-record  from  line-1 after page.\n     move     \"             Balance Sheet              \" to l2-title.\n     write    print-record  from  line-2 after 2.\n     write    print-record  from  line-3 after 2.\n     write    print-record  from  line-5 after 2.\n     move     spaces to line-8.\n*>\n loop-5.\n*>-----\n*>\n*>  Do account types O - Q.\n*>\n     move     \"Fixed Asset Total\"  to  l7-name.\n loop-5B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  18\n              go to  loop-5B.\n     perform  group-total.\n     move     level-11  to  level-21.\n     move     level-12  to  level-22.\n     move     zero  to  level-11  level-12.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n*>\n loop-6.\n*>-----\n*>\n*>  Do account types R - T\n*>\n     move     \"Plus Total Current Assets\"  to  l7-name.\n loop-6B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  21\n              go to  loop-6B.\n     perform  group-total.\n     add      level-11  to  level-21.\n     add      level-12  to  level-22.\n     move     level-21  to  level-11.\n     move     level-22  to  level-12.\n     move     \"T\"  to  group-level.\n     move     \"Total Assets\"  to  l7-name.\n     move     ws-hypens to l8-underline2.\n     if       j > zero\n              move ws-hypens to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces to line-8.\n     perform  group-total.\n     move     zero  to  level-11  level-12.\n     move     spaces to print-record  group-level.\n     write    print-record after 1.\n loop-8.\n*>-----\n*>\n*>  do account types U - V\n*>\n     move     \"Less Current Liabilities\"  to  l7-name.\n loop-8B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  23\n              go to  loop-8B.\n     perform  group-total.\n     subtract level-11  from  level-21.\n     subtract level-12  from  level-22.\n     move     zero  to  level-11  level-12.\n     move     level-21  to  level-11.\n     move     level-22  to  level-12.\n     move     ws-hypens to l8-underline2.\n     if       j > zero\n              move ws-hypens to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces to line-8.\n     move     \"T\"  to  group-level.\n     move     \"Net Current Assets\"  to  l7-name.\n     perform  group-total.\n     move     ws-equals to l8-underline2\n     if       j > zero\n              move ws-equals to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     zero  to  level-11  level-12\n                        level-21  level-22.\n     move     spaces  to  print-record  group-level.\n     move     spaces to l8-underline2 l8-underline4.\n     write    print-record after 2.\n loop-9.\n*>-----\n*>\n*>  Do account types W - Z\n*>\n     move     \"Capital Account Total\"  to  l7-name.\n loop-9B.\n     perform  line-total.\n     add      1  to  y.\n     if       y  <  27\n              go to  loop-9B.\n     perform  group-total.\n     write    print-record  from  line-8 after 1.\n     move     level-11  to  level-21.\n     move     level-12  to  level-22.\n     move     zero  to  level-11  level-12.\n     move     \"Net Profits\"  to  l7-name.\n     move     spaces  to  line-8.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     net-1  to  level-11.\n     move     net-2  to  level-12.\n     perform  group-total.\n     add      level-11  to  level-21.\n     add      level-12  to  level-22.\n     move     zero  to  level-11  level-12.\n     move     level-21  to  level-11.\n     move     level-22  to  level-12.\n     move     \"T\"  to  group-level.\n     move     \"Net Current Assets\"  to  l7-name.\n     move     ws-hypens to l8-underline2.\n     if       j > zero\n              move ws-hypens to l8-underline4.\n     write    print-record from line-8 after 1.\n     move     spaces  to  line-8.\n     perform  group-total.\n     move     zero  to  level-11  level-12\n                        level-21  level-22.\n     move     ws-equals to l8-underline2.\n     if       j > zero\n              move ws-equals to l8-underline4.\n     write    print-record from line-8 after 1.\n     close    work-file.\n*>\n*> End of p&l and bal sheet reports\n*>\n     perform  ratio.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n*> End of sales ratio report\n*>\n     perform  screen-heads.\n     display  \"End of period processing outputs the current year f\" &\n              \"igures to a comparative.\" at 0501 with foreground-color 2.\n     display  \"Revenue accounts are zeroed but Capital Accounts re\" &\n              \"tain their value.\" at 0601 with foreground-color 2.\n*>\n E-o-P-Option.\n*>-----------\n*>\n     display  \"Do you require end of period processing (Y/N) :- \" at 0901 with foreground-color 2 erase eos.\n     accept   ws-reply at 0950 with foreground-color 6.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply  = \"N\"\n              go to  E-o-P-End.\n     if       ws-reply not = \"Y\"\n              go to  E-o-P-Option.\n*>\n*>    open input default-file and get record.\n*>\n     move     3 to file-function.\n     perform  acasirsub3.\n*>\n e-o-p-comp.\n*>---------\n*>\n     display  \"Comparative field to use - \" at 1101 with foreground-color 2.\n     accept   j  at 1128 with foreground-color 6.\n     if       j  <  1  or  >  4\n              go to  e-o-p-comp.\n*>\n chk-defs.\n*>-------\n*>              30 = O.T.B , 31 = Vat Input (and 32 = Vat Output).\n*>\n     if       WE-Error not = zero\n         or   FS-Reply not = zero\n         or   def-acs (30) = zeros\n         or   def-acs (31) = zeros          *> default 30 ?? or 31 not present\n              display IR061 at 1201 with foreground-color 4\n              display  SY008 at 1301\n              accept   ws-reply at 1335\n              goback.\n*>\n Get-PL.\n*>------\n*>\n     if      PL-App-Created = \"1\"\n             move  PL-Approp-AC  to PL-AC\n     end-if\n     display \"Enter P/L Appropriation or Capital A/C :- \" at 1301 with foreground-color 2.\n     display \"(enter zero to quit)\"  at 1360 with foreground-color 2.\n     accept   pl-ac at 1343 with update foreground-color 3.\n     if       pl-ac  = zero\n              go to  E-o-P-End.\n*>\n get-pl-rest.\n*>----------\n     display  \"You have selected End of Period processing overwrit\" &\n              \"ing comparative field - \" at 1501 with foreground-color 2.\n     display  j at 1577 with foreground-color 2.\n     display  \"with P/L or Capital A/C - \" at 1601 with foreground-color 2.\n     display  pl-ac at 1627 with foreground-color 2.\n     display  \"Is This Correct ? (Y/N) - \" at 1701 with foreground-color 2.\n     accept   ws-reply at 1727 with foreground-color 6.\n     if       ws-reply not = \"Y\" and not = \"y\"\n              go to  E-o-P-Option.\n*>\n     perform  acasirsub1-Open-Input.          *> was open input NL\n     if       fs-reply not = zero\n              display IR912   at 2001\n              display IR060   at 2101\n              display SY008   at 2201\n              accept ws-reply at 2235 with foreground-color 2\n              perform acasirsub1-Close\n              go to E-O-P-End.\n*>\n     move     pl-ac  to  owning.\n     move     zero   to  sub-nominal.\n*>\n     perform  acasirsub1-Read-Indexed.\n     if       fs-reply not = zero\n              display space at 0101 with erase eos\n              display pl-ac at 0505 with foreground-color 2\n              display IR064 at 0513 with foreground-color 2\n              accept ws-reply at 0575 with foreground-color 2\n              perform acasirsub1-Close\n              go to get-pl.\n*>\n     if       tipe = \"S\"\n              display space  at 0101 with erase eos\n              display  pl-ac at 0501 with foreground-color 2\n              display  IR065 at 0507 with foreground-color 2\n              display SY008 at 0601\n              accept ws-reply at 0635\n              perform acasirsub1-Close\n              go to get-pl.\n*>\n     display space at 0501 with erase eol.\n     display space at 0601 with erase eol.\n*>\n     move     PL-AC to PL-Approp-AC.             *> save back to param file at EOJ.\n     move     function upper-case (ac) to ws-ac2.\n     move     ws-ac2 to ws-ac.\n     perform  acasirsub1-Close.                  *> resets last read pointer.\n     perform  acasirsub1-Open.                   *> As using read-next now.\n*>\n loop-a.\n*>-----\n*>\n     perform  acasirsub1-Read-Next.\n     if       fs-reply = 10\n              go to  e-o-p-fin.\n*>\n by-pass.\n*>------\n*>\n*>     Processing main A/C only\n*>\n     move     record-1  to  nl-record.       *> mv sorted rec to ws copy\n     if       tipe = \"S\"                     *> was sub\n              go to  loop-a.\n     move     dr  to  dr-last (j)\n     move     cr  to  cr-last (j).\n     if       ac  <  \"O\"\n              move  zero  to  dr  cr.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n*>\n loop-b.\n*>-----\n*>\n     perform  acasirsub1-Read-Next.\n     if       fs-reply = 10\n              go to  e-o-p-fin.\n     if       tipe = \"S\"\n              go to loop-b.\n     if       sub-nominal  = zero\n              go to  by-pass.\n     move     dr  to  dr-last (j)\n     move     cr  to  cr-last (j).\n     if       nl-ac  <  \"O\"\n              move  zero  to  dr  cr.\n     move     nl-ac  to  ac.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     go       to loop-b.\n*>\n e-o-p-fin.\n*>--------\n*>\n     perform  VAT-AC-TidyUp.\n     perform  PL-Capital-AC-Tidyup.\n*>\n     move     pl-ac  to  owning.\n     move     zero   to  sub-nominal.\n*>\n jump-back.\n*>--------\n*>\n     perform  acasirsub1-Read-Indexed.\n     if       fs-reply not = zero\n              display \"PE 009610\" at 0505\n              display SY008 at 0701\n              accept ws-reply at 0733\n              close work-file\n              perform acasirsub1-Close\n              goback.\n     if       tipe  = \"O\"\n              go to  update-pl.\n     move     owning  to  sub-nominal.\n     move     rec-pointer  to  owning.\n     go       to jump-back.\n*>\n update-pl.\n*>--------\n*>\n     if       net-1  >  zero\n              add  net-1  to  cr\n     else\n              add  net-1  to  dr.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     perform  acasirsub1-Close.               *>     close    nl\n     perform  Reset-Postings.\n*>\n E-o-P-End.\n     exit     program.\n*>\n CR-Total     section.\n*>-------------------\n*>\n     set      z to w.\n     add      cr  to    total-1 (z).\n     subtract dr  from  total-1 (z).\n     if       j = zero\n              go to main-exit.\n     add      cr-last (j)  to    total-2 (z).\n     subtract dr-last (j)  from  total-2 (z).\n*>\n main-exit.   exit.\n*>\n DR-Total     section.\n*>-------------------\n     set      z to w.\n     add      dr  to    total-1 (z).\n     subtract cr  from  total-1 (z).\n     if       j = zero\n              go to main-exit.\n     add      dr-last (j)  to    total-2 (z).\n     subtract cr-last (j)  from  total-2 (z).\n*>\n main-exit.   exit.\n*>\n Line-Total   section.\n*>-------------------\n*>\n*>  This block is for the Finished Account titles ONLY\n*>   If values are NON spaces (and applies to) the FIRST\n*>     item in the sub group, the default Desc. will be overwritten\n*>      from the Final file of same pointer (1,5,9,11,15,18,21,23).\n*>\n     if       Final-Acs-In-Use = 1\n        and   ar1 (y) not = spaces\n        and   (y = 1  or =  5 or =  9 or = 11\n              or = 15 or = 18 or = 21 or = 23)\n              move     ar1 (y)  to  l7-name\n     end-if\n*>\n*> Back to normal Line Total Processing\n*>\n     multiply total-1 (y)  by  1  giving  l7-value1  rounded.\n     if       j > zero\n              multiply total-2 (y) by 1 giving l7-value3 rounded\n              add total-2 (y)  to  level-12.\n*>\n     add      total-1 (y)  to  level-11.\n     if       total-1 (y)  <  zero\n              move  \"(\"  to  l7-sign1\n              move  \")\"  to  l7-sign2\n     else\n              move  space  to  l7-sign1  l7-sign2.\n*>\n     if       total-2 (y)  <  zero and j > zero\n              move  \"(\"  to  l7-sign5\n              move  \")\"  to  l7-sign6\n     else\n              move  space  to  l7-sign5  l7-sign6.\n     go       to by-pass.\n*>\n loop-1.\n*>\n     read     work-file  at end\n              go to  main-end.\n*>\n by-pass.\n*>\n     if       ac  <   ar0 (y)\n              display \"PE 009865\" at 2001\n              display SY008 at 2411\n              accept ws-reply at 2451\n              go to  loop-1.\n     if       ac > ar0 (y)\n              go to main-end.\n     move     record-1  to  nl-record.\n     move     nl-name of nl-data to  l9-name.\n*>\n loop-2.\n*>\n     read     work-file  at end\n              go to  main-end.\n*>\n     if       sub-nominal  = zero\n              perform  write-out\n              go to  by-pass.\n*>\n     add      dr  to  nl-dr.\n     add      cr  to  nl-cr.\n     if       j = zero\n              go to loop-2.\n     add      dr-last (j)  to  nl-dr-last (j).\n     add      cr-last (j)  to  nl-cr-last (j).\n     go       to loop-2.\n*>\n main-end.\n*>---------\n*>\n     perform  write-out.\n*>\n*>    write    print-record  from  line-7 after 1.\n*>\n main-exit.   exit.\n*>\n*>\n Group-Total  section.\n*>--------------------\n     multiply level-11  by  1  giving  l7-value2  rounded.\n     if       j > zero\n              multiply level-12 by 1 giving l7-value4 rounded.\n*>\n*>    if       not  sub-total\n*>             multiply  level-11  by  1\n*>                       giving  l7-value1  rounded\n*>    if       j > zero\n*>             multiply  level-12  by  1\n*>                       giving  l7-value3  rounded.\n     if       sub-total\n              move  zero  to  l7-value1  l7-value3.\n*>\n     if       level-11  <  zero\n              move  \"(\"  to  l7-sign3\n*>                            l7-sign1\n              move  \")\"  to  l7-sign4\n*>                            l7-sign2\n     else\n              move  space  to  l7-sign3  l7-sign4.\n*>\n     if       level-12  <  zero and j > zero\n              move  \"(\"  to  l7-sign7\n*>                            l7-sign5\n              move  \")\"  to  l7-sign8\n*>                            l7-sign6\n     else\n              move  space  to  l7-sign7  l7-sign8.\n     move     ws-hypens  to  l8-underline1.\n     if       j > zero\n              move ws-hypens to  l8-underline3.\n     if       not  sub-total\n              write  print-record  from  line-8 after 1.\n     write    print-record  from  line-7 after 1.\n*>\n     move     spaces to l7-sign1 l7-sign2 l7-sign3 l7-sign4  l7-sign5\n                        l7-sign6 l7-sign7 l7-sign8.\n*>\n     move     zero  to  l7-value1  l7-value2 l7-value3  l7-value4.\n     move     spaces to line-8.\n*>\n main-exit.   exit.\n*>\n write-out    section.\n*>-------------------\n     if       nl-ac  <  \"E\"\n              perform  cr-value.\n     if       nl-ac  >  \"D\"  AND  <  \"J\"\n              perform  dr-value.\n     if       nl-ac  = \"I\"  OR  \"J\"\n              perform  cr-value.\n     if       nl-ac  >  \"J\"  AND  <  \"U\"\n              perform  dr-value.\n     if       nl-ac  >  \"T\"\n              perform  cr-value.\n     go       to main-print.\n*>\n cr-value.\n*>\n     move     zero  to  work-1.\n     move     zero  to  work-2.\n     add      nl-cr to   work-1.\n     subtract nl-dr from work-1.\n*>\n     if       j > zero\n              add       nl-cr-last (j)  to    work-2\n              subtract  nl-dr-last (j)  from  work-2.\n*>\n dr-value.\n*>\n     move     zero  to  work-1.\n     move     zero  to  work-2.\n     add      nl-dr to   work-1.\n     subtract nl-cr from work-1.\n*>\n     if       j > zero\n              add       nl-dr-last (j)  to    work-2\n              subtract  nl-cr-last (j)  from  work-2.\n*>\n main-print.\n*>\n     if       work-1  = zero\n       and    work-2  = zero\n              go to  main-end.\n*>\n     if       l9-name = spaces\n              go to main-end.\n*>\n     if       work-1  <  zero\n              move  \"(\"  to  l9-sign1\n              move  \")\"  to  l9-sign2\n     else\n              move  space  to  l9-sign1  l9-sign2.\n*>\n     if       work-2  <  zero and j > zero\n              move  \"(\"  to  l9-sign3\n              move  \")\"  to  l9-sign4\n     else\n              move  space  to  l9-sign3  l9-sign4.\n*>\n     multiply work-1  by  1  giving  l9-value1  rounded.\n     if       j > zero\n              multiply work-2 by 1 giving l9-value2 rounded.\n*>\n     write    print-record  from  line-9 after 1.\n*>\n main-end.\n*>\n     move     spaces  to  l9-name.\n     move     zero    to  work-1  work-2.\n*>\n main-exit.   exit.\n*>********    ****\n*>\n ratio        section.\n*>-------------------\n*>\n     write    print-record  from  line-1 after page.\n     write    print-record  from  line-2 after 2.\n     write    print-record  from  line-10 after 2.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n*>\n     add      total-1 (1) total-1 (2) total-1 (3) total-1 (4) giving work-1.\n     add      total-1 (5) total-1 (6) total-1 (7) total-1 (8) giving work-2.\n     subtract work-2 from work-1 giving work-2.\n     divide   work-1 by 100 giving work-3.\n     divide   work-2 by work-3 giving l11-ratio rounded.\n     move     \"Gross Profit % to Sales\"  to  l11-name.\n     write    print-record  from  line-11 after 2  lines.\n*>\n     subtract total-1 (11) total-1 (12) total-1 (13) total-1 (14) from work-2.\n     divide   work-2 by work-3 giving l11-ratio rounded.\n     move     \"Net Profit % to Sales\"  to  l11-name.\n     write    print-record  from  line-11 after  2  lines.\n*>\n main-exit.   exit.\n*>********    ****\n*>\n date-validate section.\n*>--------------------\n*>\n*>************************************************\n*>                                               *\n*>            date vet section.                  *\n*>            =================                  *\n*>                                               *\n*>    format of date must be as follows:-        *\n*>                                               *\n*>       ddxmmxyy                                *\n*>                                               *\n*>    where x can only be one of the following:- *\n*>                                               *\n*>        / , . -                                *\n*>                                               *\n*>     and  dd = 1 thru [days in month]          *\n*>          mm = 1 thru 12                       *\n*>                                               *\n*>************************************************\n*>\n     if       u-bin  >  zero\n              go to  ws-unpack.\n     move     zero to q.\n     inspect  u-date replacing all \".\" by \"/\".\n     inspect  u-date replacing all \",\" by \"/\".\n     inspect  u-date replacing all \"-\" by \"/\".\n     inspect  u-date tallying q for all \"/\".\n*>\n     if       q not = 2 or\n              u-days  not numeric or\n              u-month not numeric or\n              u-year  not numeric or\n              u-days  < 01 or > 31 or\n              u-month < 01 or > 12\n              go to main-exit.\n*>\n     if       u-days > 29 and u-month = 2\n              go to main-exit.\n*>\n     divide   u-year by 4 giving save-date.\n     multiply save-date by 4 giving q.\n     if       u-month = 2 and\n              u-days > 28 and\n              q not = u-year\n              go to main-exit.\n*>\n     if       u-days > days (u-month) and\n              u-month not = 2\n              go to main-exit.\n*>\n*>********************************************\n*>                                           *\n*>       date validation & conversion        *\n*>       ============================        *\n*>                                           *\n*>                                           *\n*>  requires  date input in u-date           *\n*>  & returns  date as binary days since     *\n*>    01/01/2000  in  u-bin                  *\n*>  date errors returned as u-bin equal zero *\n*>                                           *\n*>********************************************\n*>\n     move     zero  to  u-bin.\n     move     1     to  ws-work1.\n     move     zero  to  ws-work2.\n*>\n     if       u-year not = zero\n              compute u-bin = u-year * 365.\n*>\n     if       u-bin <   zero\n              move  zero  to  u-bin\n              go to  pack-end.\n*>\n pack-loop-1.\n     if       u-year  >  ws-work2\n              add  1  to  u-bin\n              add  4  to  ws-work2\n              go to  pack-loop-1.\n*>\n     if       u-year =  ws-work2\n       and    u-month  >  2\n              add  1  to  u-bin.\n*>\n pack-loop-2.\n     if       u-month  >  12\n              move  zero  to  u-bin\n              go to pack-end.\n     if       u-month  >  ws-work1\n              add  days (ws-work1)  to  u-bin\n              add  1  to  ws-work1\n              go to pack-loop-2.\n*>\n     if       u-days  not  >  days (ws-work1)\n              add  u-days  to  u-bin\n              go to  pack-end.\n     if       u-days   = 29\n        and   u-month  = 2\n        and   u-year   = ws-work2\n              add  u-days  to   u-bin\n     else\n              move  zero  to u-bin.\n*>\n pack-end.\n     go       to main-exit.\n*>\n*>*************************************\n*>                                    *\n*>   binary date conversion routine   *\n*>   ==============================   *\n*>                                    *\n*>                                    *\n*>  requires  binary input in u-bin   *\n*>  &  returns date  in u-date        *\n*>                                    *\n*>*************************************\n*>\n ws-unpack.\n*>========\n*>\n     move     u-bin  to  save-date.\n*>\n     move     \"00/00/00\"  to  u-date.\n     move     zero  to  u-year.\n     move     1  to  u-month.\n     move     0  to  u-days.\n     move     1  to  ws-work1.\n     move     zero  to  ws-work2.\n*>\n unpack-loop-1.\n*>\n     subtract 365  from  save-date.\n*>\n     if       save-date  >  zero\n              add  1  to  u-year\n     else\n              add  365  to  save-date\n              go to  unpack-loop-2.\n*>\n     if       u-year = ws-work2\n          and save-date > 59\n              add  4  to  ws-work2\n              subtract  1   from  save-date.\n*>\n     if       save-date  = zero\n              subtract  1  from  u-year\n              move  365  to  save-date\n              go to unpack-loop-2.\n*>\n     go       to unpack-loop-1.\n*>\n unpack-loop-2.\n*>\n     if       save-date  = 365\n              move  31  to   u-days\n              move  12  to  u-month\n              go to  unpack-end.\n*>\n unpack-loop-3.\n*>\n     subtract days (ws-work1)  from  save-date.\n*>\n     if       save-date  >  zero\n              add  1  to  ws-work1\n              add  1  to  u-month\n              go to  unpack-loop-3.\n*>\n     add      save-date  days (ws-work1)  to  u-days.\n*>\n unpack-end.\n*>\n main-exit.   exit.\n*>********    ****\n*>\n PL-Capital-AC-Tidyup  section.\n*>****************************\n pl-start.\n*>\n     move     zero to nl-cr nl-dr.\n     perform  acasirsub1-Close.       *> resets last read pointer\n     perform  acasirsub1-Open.\n*>\n pl-a.\n*>---\n*>\n     perform  acasirsub1-Read-Next.\n     if       fs-reply = 10\n              go to pl-a-end.\n     move     function upper-case (ac) to ac2.\n     if       ac2 not = ws-ac\n              go to pl-a.\n     if       tipe = \"S\"\n              go to pl-a.\n*>\n*>   Got record with same type as PL/capital record\n*>\n     move     ac2 to ac.\n     add      cr to nl-cr.\n     add      dr to nl-dr.\n     move     zero to cr dr.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     if       fs-reply not = zero\n              display \"PE 014900\" at 2301\n              display SY008 at 2401\n              accept ws-reply at 2433\n              perform acasirsub1-Close\n              goback.\n     go       to pl-a.\n*>\n pl-a-end.\n*>-------\n*>\n     move     pl-ac to owning.\n     move     zero  to sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n     if       fs-reply not = zero\n              display \"PE 015000\" at 2301 erase eos\n              display SY008 at 2401\n              accept ws-reply at 2433\n              perform acasirsub1-Close\n              goback.\n*>\n*> These PE errors (above and below) should never happen but still must test for them . .\n*>\n     if       tipe = \"S\"\n              display  pl-ac at 2201 with foreground-color 2 erase eos\n              display  IR065 at 2207 with foreground-color 2\n              display \"PE 015010\" at 2301\n              display SY008 at 2441\n              accept ws-reply at 2474\n              perform acasirsub1-Close\n              goback.\n*>\n     move     nl-dr to dr.\n     move     nl-cr to cr.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     if       fs-reply not = zeros\n              display \"PE 015100\" at 2301\n              display SY008 at 2401\n              accept ws-reply at 2433\n              perform acasirsub1-Close\n              goback.\n     go       to pl-exit.\n*>\n pl-exit.     exit.\n*>******      ****\n*>\n VAT-AC-TidyUp         section.\n*>****************************\n vat-a.\n*>\n     move     def-acs (31) to owning.    *> Vat Input\n     move     zero    to sub-nominal.\n*>\n vat-b.\n*>----\n*>\n     perform  acasirsub1-Read-Indexed.\n     if       fs-reply not = zero\n              display space  at 0101 with erase eos\n              display owning at 0501  with foreground-color 2\n              display \"(Default 31 A/C) does not exist..ABORTING\" at 0507 with foreground-color 2\n              display SY008  at 2441\n              accept ws-reply at 2474\n              perform  acasirsub1-Close       *> close nl\n              goback.\n*>\n     if       tipe = \"S\" and\n              rec-pointer = owning\n              display space at 0101 with erase eos\n              display \"PE VAT01: Problems with CoA file - Bad coding\" at 2301\n              display SY008 at 2441\n              accept ws-reply at 2474\n              perform  acasirsub1-Close       *> close nl\n              goback.\n*>\n*>    Get pointer to Sub nominal to find main a/c but again should not happen\n*>\n     if       tipe = \"S\"\n              move rec-pointer to owning\n              go to vat-b.\n*>\n*>    At this point, we have got the VAT control Main Account\n*>\n     move     record-1 to nl-record.\n*>\n vat-c.\n*>----\n*>\n     perform  acasirsub1-Read-Next.\n     if       fs-reply = 10\n              go to vat-finalize.\n*>\n     if       owning not = nl-owning\n              go to vat-finalize.\n*>\n     if       tipe = \"S\"\n              go to vat-c.\n*>\n     add      dr   to nl-dr.\n     add      cr   to nl-cr.\n     move     zero to dr  cr.\n*>\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     if       fs-reply not = zero\n              display \"PE 015370: Problems with CoA file cant rewrite\" at 2301\n              display SY008 at 2401\n              accept ws-reply at 2433\n              perform acasirsub1-Close\n              goback.\n*>\n     go       to vat-c.\n*>\n vat-finalize.\n*>-----------\n*>\n     move     nl-record to Record-1.\n     perform  acasirsub1-Rewrite.             *>     rewrite  record-1.\n     if       fs-reply not = zero\n              display \"PE 015470: Problems on rewrite for CoA file\" at 2301\n              display SY008 at 2401\n              accept ws-reply at 2433\n              perform acasirsub1-Close\n              goback.\n     go       to vat-exit.\n*>\n vat-exit.\n     exit.\n*>\n Reset-Postings        section.\n*>****************************\n*>\n*>  Clear posting file down",
        "line": 667
      },
      {
        "type": "IF",
        "condition": "fs-reply = 10\n              go to main-end.\n     if       nl-sub-ac\n              go to read-n.\n     if       cr = zero and\n              dr = zero\n              go to read-n.\n*>\n     if       dr = cr\n              go to read-n.\n*>\n     if       dr > cr\n              subtract cr from dr\n              move zero to cr\n       else\n              subtract dr from cr\n              move zero to dr.\n*>\n     move     u-date to post-date.\n     move     spaces to post-vat-side.\n     add      1 to pl-ac.\n     move     pl-ac to post-key.\n     move     def-codes (30) to post-code.\n     move     zero to vat-ac-def vat-amount.\n     move     \"Balance Forward\" to post-legend.\n     move     def-acs (30) to post-cr post-dr.\n     if       sub-nominal not = zero\n              move sub-nominal to owning.\n*>\n     if       dr > zero\n              move owning to post-dr\n              move dr to post-amount\n     else\n      if      cr > zero\n              move owning to post-cr\n              move cr to post-amount.\n*>\n     if       def-acs (30) = post-cr and post-dr\n              go to read-n.\n*>\n     move     5 to file-function.\n     perform  acasirsub4.\n     go       to read-n.\n*>\n main-end.\n     perform  acasirsub1-Close.\n     move     2 to file-function.\n     perform  acasirsub4.\n     move     pl-ac to next-post.\n*>\n main-exit.\n     exit.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 1751
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 10,
    "cognitive": 4,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 123,
      "totalOperators": 171,
      "totalOperands": 340,
      "vocabulary": 125,
      "length": 511,
      "volume": 3559.5157694623263
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
