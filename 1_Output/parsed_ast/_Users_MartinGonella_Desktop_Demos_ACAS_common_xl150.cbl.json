{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/xl150.cbl",
  "fileName": "xl150.cbl",
  "timestamp": "2025-09-15T16:25:35.874Z",
  "programId": "xl150",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 333
      },
      {
        "name": "file",
        "line": 356
      },
      {
        "name": "working-storage",
        "line": 390
      },
      {
        "name": "linkage",
        "line": 589
      },
      {
        "name": "aa00-Main",
        "line": 605
      },
      {
        "name": "AB00-SL-Processing",
        "line": 1525
      },
      {
        "name": "exit",
        "line": 1789
      },
      {
        "name": "AE00-Kill-Invoices",
        "line": 1791
      },
      {
        "name": "exit",
        "line": 1841
      },
      {
        "name": "AC00-PL-Processing",
        "line": 1843
      },
      {
        "name": "exit",
        "line": 2027
      },
      {
        "name": "AD00-kill-invoicep",
        "line": 2029
      },
      {
        "name": "exit",
        "line": 2079
      },
      {
        "name": "BD00-Check-End-of-Cycle",
        "line": 2081
      },
      {
        "name": "exit",
        "line": 2153
      },
      {
        "name": "BA00-Value-Reset",
        "line": 2155
      },
      {
        "name": "exit",
        "line": 2220
      },
      {
        "name": "zz070-Convert-Date",
        "line": 2222
      },
      {
        "name": "exit",
        "line": 2250
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 336
      },
      {
        "name": "File-Defs",
        "line": 603
      },
      {
        "name": "aa010-Acpt-Reply",
        "line": 646
      },
      {
        "name": "aa012-Display-Warnings",
        "line": 662
      },
      {
        "name": "aa015-Recheck-for-Issues",
        "line": 679
      },
      {
        "name": "aa024-Test-EoC",
        "line": 771
      },
      {
        "name": "aa025-OTM-Checks",
        "line": 776
      },
      {
        "name": "aa030-Display-Heads",
        "line": 798
      },
      {
        "name": "aa040-Display-End",
        "line": 805
      },
      {
        "name": "aa050-EOY-Processing",
        "line": 814
      },
      {
        "name": "aa100-Phase-6",
        "line": 829
      },
      {
        "name": "aa110-Phase-7",
        "line": 911
      },
      {
        "name": "aa120-Phase-8",
        "line": 985
      },
      {
        "name": "aa130-Phase-9",
        "line": 1062
      },
      {
        "name": "aa140-Phase-10",
        "line": 1141
      },
      {
        "name": "aa150-Phase-11",
        "line": 1215
      },
      {
        "name": "aa800-Error-on-Read-OTM3",
        "line": 1296
      },
      {
        "name": "aa801-Error-on-Read-Sales",
        "line": 1300
      },
      {
        "name": "aa802-Error-on-Write-Temp-Sales",
        "line": 1305
      },
      {
        "name": "aa803-Error-on-Read-Temp-Sales",
        "line": 1310
      },
      {
        "name": "aa804-Error-on-Write-Sales",
        "line": 1315
      },
      {
        "name": "aa805-Error-On-Write-OTM3",
        "line": 1320
      },
      {
        "name": "aa806-Error-on-Write-Temp-OTM3",
        "line": 1325
      },
      {
        "name": "aa807-Error-on-Read-Temp-OTM3",
        "line": 1330
      },
      {
        "name": "aa808-Error-on-Read-SInvoices",
        "line": 1335
      },
      {
        "name": "aa809-Error-on-Write-Temp-SInvoices",
        "line": 1340
      },
      {
        "name": "aa810-Error-on-Read-Temp-SInvoices",
        "line": 1345
      },
      {
        "name": "aa811-Error-on-Write-SInvoices",
        "line": 1350
      },
      {
        "name": "aa812-Error-on-Open-Sales",
        "line": 1355
      },
      {
        "name": "aa813-Error-on-Open-Temp-Sales",
        "line": 1360
      },
      {
        "name": "aa814-Error-on-Open-OTM3",
        "line": 1365
      },
      {
        "name": "aa815-Error-on-Open-Temp-OTM3",
        "line": 1370
      },
      {
        "name": "aa816-Error-on-Open-SInvoices",
        "line": 1375
      },
      {
        "name": "aa817-Error-on-Open-Temp-SInvoices",
        "line": 1380
      },
      {
        "name": "aa900-Error-on-Read-OTM5",
        "line": 1388
      },
      {
        "name": "aa901-Error-on-Read-Purchase",
        "line": 1392
      },
      {
        "name": "aa902-Error-on-Write-Temp-Purchase",
        "line": 1397
      },
      {
        "name": "aa903-Error-on-Read-Temp-Purchase",
        "line": 1402
      },
      {
        "name": "aa904-Error-on-Write-Purchase",
        "line": 1407
      },
      {
        "name": "aa905-Error-On-Write-OTM5",
        "line": 1412
      },
      {
        "name": "aa906-Error-on-Write-Temp-OTM5",
        "line": 1417
      },
      {
        "name": "aa907-Error-on-Read-Temp-OTM5",
        "line": 1422
      },
      {
        "name": "aa908-Error-on-Read-PInvoices",
        "line": 1427
      },
      {
        "name": "aa909-Error-on-Write-Temp-PInvoices",
        "line": 1432
      },
      {
        "name": "aa910-Error-on-Read-Temp-PInvoices",
        "line": 1437
      },
      {
        "name": "aa911-Error-on-Write-PInvoices",
        "line": 1442
      },
      {
        "name": "aa912-Error-on-Open-Purchase",
        "line": 1447
      },
      {
        "name": "aa913-Error-on-Open-Temp-Purchase",
        "line": 1452
      },
      {
        "name": "aa914-Error-on-Open-OTM5",
        "line": 1457
      },
      {
        "name": "aa915-Error-on-Open-Temp-OTM5",
        "line": 1462
      },
      {
        "name": "aa916-Error-on-Open-PInvoices",
        "line": 1467
      },
      {
        "name": "aa917-Error-on-Open-Temp-PInvoices",
        "line": 1472
      },
      {
        "name": "aa950-Display-File-Error",
        "line": 1478
      },
      {
        "name": "aa970-Menu-Exit",
        "line": 1490
      },
      {
        "name": "aa980-Menu-Exit",
        "line": 1501
      },
      {
        "name": "goback",
        "line": 1502
      },
      {
        "name": "aa990-Menu-Error",
        "line": 1504
      },
      {
        "name": "goback",
        "line": 1506
      },
      {
        "name": "aa991-File-Error-Exit",
        "line": 1509
      },
      {
        "name": "goback",
        "line": 1511
      },
      {
        "name": "Sales-Activety",
        "line": 1573
      },
      {
        "name": "AB020-Phase-1-End",
        "line": 1580
      },
      {
        "name": "AB060-Phase-2-Read",
        "line": 1590
      },
      {
        "name": "AB070-Phase-2-End",
        "line": 1624
      },
      {
        "name": "AB100-Phase-3-Begin",
        "line": 1628
      },
      {
        "name": "AB140-Phase-4-End",
        "line": 1716
      },
      {
        "name": "AB170-Phase-6-Sys4-Reset",
        "line": 1720
      },
      {
        "name": "SL-credit-notes-This-month",
        "line": 1729
      },
      {
        "name": "AB995-Eval-Status",
        "line": 1732
      },
      {
        "name": "end-if",
        "line": 1763
      },
      {
        "name": "AB996-Error-on-OTM3-Rewrite",
        "line": 1765
      },
      {
        "name": "AB997-Error-on-OTM3-Delete",
        "line": 1773
      },
      {
        "name": "AB998-Error-On-Sales-Rewrite",
        "line": 1781
      },
      {
        "name": "AB999-main-exit",
        "line": 1788
      },
      {
        "name": "AE020-Actual-Delete",
        "line": 1836
      },
      {
        "name": "AE999-Kill-Exit",
        "line": 1840
      },
      {
        "name": "Purch-Activety",
        "line": 1879
      },
      {
        "name": "AC020-Phase-1-End",
        "line": 1886
      },
      {
        "name": "AC060-Phase-2-Read",
        "line": 1896
      },
      {
        "name": "AC070-Phase-2-End",
        "line": 1929
      },
      {
        "name": "AC140-Phase-4-End",
        "line": 1991
      },
      {
        "name": "AC170-Phase-6-Sys4-Reset",
        "line": 1994
      },
      {
        "name": "PL-credit-notes-This-month",
        "line": 2000
      },
      {
        "name": "AC996-Error-on-OTM5-Rewrite",
        "line": 2003
      },
      {
        "name": "AC997-Error-on-OTM5-Delete",
        "line": 2011
      },
      {
        "name": "AC998-Error-On-Purch-Rewrite",
        "line": 2019
      },
      {
        "name": "AC999-main-exit",
        "line": 2026
      },
      {
        "name": "AD010-Test-for-Subs",
        "line": 2062
      },
      {
        "name": "AD020-Actual-Delete",
        "line": 2074
      },
      {
        "name": "AD999-Kill-Exit",
        "line": 2078
      },
      {
        "name": "BD010-Monthly-Check",
        "line": 2095
      },
      {
        "name": "new-quarter",
        "line": 2104
      },
      {
        "name": "BD020-Weekly-Check",
        "line": 2106
      },
      {
        "name": "new-quarter",
        "line": 2115
      },
      {
        "name": "BD030-Query-Check",
        "line": 2117
      },
      {
        "name": "BD032-Skip-Question",
        "line": 2136
      },
      {
        "name": "new-quarter",
        "line": 2150
      },
      {
        "name": "BD999-main-exit",
        "line": 2152
      },
      {
        "name": "BA000-Start",
        "line": 2166
      },
      {
        "name": "BA020-End",
        "line": 2216
      },
      {
        "name": "BA00-Exit",
        "line": 2219
      },
      {
        "name": "zz070-Exit",
        "line": 2249
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 644,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 778,
        "type": "DYNAMIC",
        "using": [
          "File-29",
          "*>",
          "OTM5",
          "(Purch)",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "and",
          "PL-EoC",
          "=",
          "1",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "XL106",
          "at",
          "0501",
          "with",
          "foreground-color",
          "4",
          "erase",
          "eos",
          "move",
          "zero",
          "to",
          "PL-EoC"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 785,
        "type": "DYNAMIC",
        "using": [
          "File-19",
          "*>",
          "OTM3",
          "(Sales)",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "and",
          "SL-EoC",
          "=",
          "1",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "XL107",
          "at",
          "0601",
          "with",
          "foreground-color",
          "4",
          "erase",
          "eos",
          "move",
          "zero",
          "to",
          "SL-EoC"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 323,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 332,
        "replacing": null
      },
      {
        "name": "slselois",
        "line": 339,
        "replacing": null
      },
      {
        "name": "slfdois",
        "line": 359,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 361,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 380,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 410,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 411,
        "replacing": null
      },
      {
        "name": "wsval",
        "line": 413,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 417,
        "replacing": null
      },
      {
        "name": "slwsoi3",
        "line": 419,
        "replacing": null
      },
      {
        "name": "slwssoi",
        "line": 421,
        "replacing": null
      },
      {
        "name": "slwsinv2",
        "line": 430,
        "replacing": null
      },
      {
        "name": "slwsinv",
        "line": 438,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 442,
        "replacing": null
      },
      {
        "name": "plwsoi5B",
        "line": 444,
        "replacing": null
      },
      {
        "name": "plwssoi",
        "line": 445,
        "replacing": null
      },
      {
        "name": "plwspinv2",
        "line": 455,
        "replacing": null
      },
      {
        "name": "plwspinv",
        "line": 460,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 492,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 592,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 593,
        "replacing": null
      },
      {
        "name": "wssys4",
        "line": 594,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 595,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 1733,
        "replacing": null
      },
      {
        "name": "to",
        "line": 1808,
        "replacing": null
      },
      {
        "name": "to",
        "line": 2046,
        "replacing": null
      },
      {
        "name": "Proc-Get-Env-Set-Files",
        "line": 2252,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2254,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz020-Get-Program-Args",
        "thru": null,
        "line": 624
      },
      {
        "target": "aa030-Display-Heads",
        "thru": null,
        "line": 638
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 801
      },
      {
        "target": "BD00-Check-End-of-Cycle",
        "thru": null,
        "line": 806
      },
      {
        "target": "AB00-SL-Processing",
        "thru": null,
        "line": 808
      },
      {
        "target": "AC00-PL-Processing",
        "thru": null,
        "line": 811
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 838
      },
      {
        "target": "aa812-Error-on-Open-Sales",
        "thru": null,
        "line": 840
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 841
      },
      {
        "target": "aa813-Error-on-Open-Temp-Sales",
        "thru": null,
        "line": 846
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 848
      },
      {
        "target": "until",
        "thru": null,
        "line": 852
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 853
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 855
      },
      {
        "target": "aa801-Error-on-Read-Sales",
        "thru": null,
        "line": 858
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 860
      },
      {
        "target": "aa802-Error-on-Write-Temp-Sales",
        "thru": null,
        "line": 865
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 867
      },
      {
        "target": "close",
        "thru": null,
        "line": 870
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 872
      },
      {
        "target": "aa813-Error-on-Open-Temp-Sales",
        "thru": null,
        "line": 877
      },
      {
        "target": "Sales-Open-Output",
        "thru": null,
        "line": 881
      },
      {
        "target": "aa812-Error-on-Open-Sales",
        "thru": null,
        "line": 883
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 885
      },
      {
        "target": "until",
        "thru": null,
        "line": 888
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 890
      },
      {
        "target": "aa803-Error-on-Read-Temp-Sales",
        "thru": null,
        "line": 893
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 895
      },
      {
        "target": "Sales-Write",
        "thru": null,
        "line": 898
      },
      {
        "target": "aa804-Error-on-Write-Sales",
        "thru": null,
        "line": 900
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 902
      },
      {
        "target": "perform",
        "thru": null,
        "line": 905
      },
      {
        "target": "aa815-Error-on-Open-Temp-OTM3",
        "thru": null,
        "line": 915
      },
      {
        "target": "OTM3-Open-Input",
        "thru": null,
        "line": 919
      },
      {
        "target": "aa814-Error-on-Open-OTM3",
        "thru": null,
        "line": 921
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 922
      },
      {
        "target": "until",
        "thru": null,
        "line": 926
      },
      {
        "target": "OTM3-Read-Next",
        "thru": null,
        "line": 927
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 929
      },
      {
        "target": "aa800-Error-on-Read-OTM3",
        "thru": null,
        "line": 932
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 933
      },
      {
        "target": "aa806-Error-on-Write-Temp-OTM3",
        "thru": null,
        "line": 939
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 940
      },
      {
        "target": "close",
        "thru": null,
        "line": 944
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 946
      },
      {
        "target": "aa815-Error-on-Open-Temp-OTM3",
        "thru": null,
        "line": 950
      },
      {
        "target": "OTM3-Open-Output",
        "thru": null,
        "line": 954
      },
      {
        "target": "aa814-Error-on-Open-OTM3",
        "thru": null,
        "line": 956
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 958
      },
      {
        "target": "until",
        "thru": null,
        "line": 962
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 964
      },
      {
        "target": "aa807-Error-on-Read-Temp-OTM3",
        "thru": null,
        "line": 967
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 969
      },
      {
        "target": "OTM3-Write",
        "thru": null,
        "line": 972
      },
      {
        "target": "aa805-Error-on-Write-OTM3",
        "thru": null,
        "line": 974
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 976
      },
      {
        "target": "perform",
        "thru": null,
        "line": 979
      },
      {
        "target": "Invoice-Open-Input",
        "thru": null,
        "line": 987
      },
      {
        "target": "aa816-Error-on-Open-SInvoices",
        "thru": null,
        "line": 989
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 990
      },
      {
        "target": "aa817-Error-on-Open-Temp-SInvoices",
        "thru": null,
        "line": 995
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 997
      },
      {
        "target": "until",
        "thru": null,
        "line": 1001
      },
      {
        "target": "Invoice-Read-Next",
        "thru": null,
        "line": 1002
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1004
      },
      {
        "target": "aa808-Error-on-Read-SInvoices",
        "thru": null,
        "line": 1007
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1009
      },
      {
        "target": "aa809-Error-on-Write-Temp-SInvoices",
        "thru": null,
        "line": 1014
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1016
      },
      {
        "target": "close",
        "thru": null,
        "line": 1019
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1021
      },
      {
        "target": "aa817-Error-on-Open-Temp-SInvoices",
        "thru": null,
        "line": 1026
      },
      {
        "target": "Invoice-Open-Output",
        "thru": null,
        "line": 1030
      },
      {
        "target": "aa816-Error-on-Open-SInvoices",
        "thru": null,
        "line": 1032
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1034
      },
      {
        "target": "until",
        "thru": null,
        "line": 1037
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1039
      },
      {
        "target": "aa810-Error-on-Read-Temp-SInvoices",
        "thru": null,
        "line": 1042
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1044
      },
      {
        "target": "Invoice-Write",
        "thru": null,
        "line": 1047
      },
      {
        "target": "aa811-Error-on-Write-SInvoices",
        "thru": null,
        "line": 1049
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1051
      },
      {
        "target": "perform",
        "thru": null,
        "line": 1054
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 1068
      },
      {
        "target": "aa912-Error-on-Open-Purchase",
        "thru": null,
        "line": 1070
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1071
      },
      {
        "target": "aa913-Error-on-Open-Temp-Purchase",
        "thru": null,
        "line": 1076
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1078
      },
      {
        "target": "until",
        "thru": null,
        "line": 1082
      },
      {
        "target": "Purch-Read-Next",
        "thru": null,
        "line": 1083
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1085
      },
      {
        "target": "aa901-Error-on-Read-Purchase",
        "thru": null,
        "line": 1088
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1090
      },
      {
        "target": "aa902-Error-on-Write-Temp-Purchase",
        "thru": null,
        "line": 1095
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1097
      },
      {
        "target": "close",
        "thru": null,
        "line": 1100
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1102
      },
      {
        "target": "aa913-Error-on-Open-Temp-Purchase",
        "thru": null,
        "line": 1107
      },
      {
        "target": "Purch-Open-Output",
        "thru": null,
        "line": 1111
      },
      {
        "target": "aa912-Error-on-Open-Purchase",
        "thru": null,
        "line": 1113
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1115
      },
      {
        "target": "until",
        "thru": null,
        "line": 1118
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1120
      },
      {
        "target": "aa903-Error-on-Read-Temp-Purchase",
        "thru": null,
        "line": 1123
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1125
      },
      {
        "target": "Purch-Write",
        "thru": null,
        "line": 1128
      },
      {
        "target": "aa904-Error-on-Write-Purchase",
        "thru": null,
        "line": 1130
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1132
      },
      {
        "target": "perform",
        "thru": null,
        "line": 1135
      },
      {
        "target": "aa915-Error-on-Open-Temp-OTM5",
        "thru": null,
        "line": 1145
      },
      {
        "target": "OTM5-Open-Input",
        "thru": null,
        "line": 1149
      },
      {
        "target": "aa914-Error-on-Open-OTM5",
        "thru": null,
        "line": 1151
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1152
      },
      {
        "target": "until",
        "thru": null,
        "line": 1156
      },
      {
        "target": "OTM5-Read-Next",
        "thru": null,
        "line": 1157
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1159
      },
      {
        "target": "aa900-Error-on-Read-OTM5",
        "thru": null,
        "line": 1162
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1163
      },
      {
        "target": "aa906-Error-on-Write-Temp-OTM5",
        "thru": null,
        "line": 1169
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1170
      },
      {
        "target": "close",
        "thru": null,
        "line": 1174
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1176
      },
      {
        "target": "aa915-Error-on-Open-Temp-OTM5",
        "thru": null,
        "line": 1180
      },
      {
        "target": "OTM5-Open-Output",
        "thru": null,
        "line": 1184
      },
      {
        "target": "aa914-Error-on-Open-OTM5",
        "thru": null,
        "line": 1186
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1188
      },
      {
        "target": "until",
        "thru": null,
        "line": 1192
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1194
      },
      {
        "target": "aa907-Error-on-Read-Temp-OTM5",
        "thru": null,
        "line": 1197
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1199
      },
      {
        "target": "OTM5-Write",
        "thru": null,
        "line": 1202
      },
      {
        "target": "aa905-Error-on-Write-OTM5",
        "thru": null,
        "line": 1204
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1206
      },
      {
        "target": "perform",
        "thru": null,
        "line": 1209
      },
      {
        "target": "PInvoice-Open-Input",
        "thru": null,
        "line": 1217
      },
      {
        "target": "aa916-Error-on-Open-PInvoices",
        "thru": null,
        "line": 1219
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1220
      },
      {
        "target": "aa917-Error-on-Open-Temp-PInvoices",
        "thru": null,
        "line": 1225
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1227
      },
      {
        "target": "until",
        "thru": null,
        "line": 1231
      },
      {
        "target": "PInvoice-Read-Next",
        "thru": null,
        "line": 1232
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1234
      },
      {
        "target": "aa908-Error-on-Read-PInvoices",
        "thru": null,
        "line": 1237
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1239
      },
      {
        "target": "aa909-Error-on-Write-Temp-PInvoices",
        "thru": null,
        "line": 1244
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1246
      },
      {
        "target": "close",
        "thru": null,
        "line": 1249
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1251
      },
      {
        "target": "aa917-Error-on-Open-Temp-PInvoices",
        "thru": null,
        "line": 1256
      },
      {
        "target": "PInvoice-Open-Output",
        "thru": null,
        "line": 1260
      },
      {
        "target": "aa916-Error-on-Open-PInvoices",
        "thru": null,
        "line": 1262
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1264
      },
      {
        "target": "until",
        "thru": null,
        "line": 1267
      },
      {
        "target": "end-read",
        "thru": null,
        "line": 1269
      },
      {
        "target": "aa910-Error-on-Read-Temp-PInvoices",
        "thru": null,
        "line": 1272
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1274
      },
      {
        "target": "PInvoice-Write",
        "thru": null,
        "line": 1277
      },
      {
        "target": "aa911-Error-on-Write-PInvoices",
        "thru": null,
        "line": 1279
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1281
      },
      {
        "target": "perform",
        "thru": null,
        "line": 1284
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1299
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1304
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1309
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1314
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1319
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1324
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1329
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1334
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1339
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1344
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1349
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1354
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1359
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1364
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1369
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1374
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1379
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1384
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1391
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1396
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1401
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1406
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1411
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1416
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1421
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1426
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1431
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1436
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1441
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1446
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1451
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1456
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1461
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1466
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1471
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1476
      },
      {
        "target": "AB995-Eval-Status",
        "thru": null,
        "line": 1482
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1549
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 1552
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1575
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1581
      },
      {
        "target": "OTM3-Open",
        "thru": null,
        "line": 1587
      },
      {
        "target": "Invoice-Open",
        "thru": null,
        "line": 1588
      },
      {
        "target": "OTM3-Read-Next",
        "thru": null,
        "line": 1591
      },
      {
        "target": "AE00-Kill-Invoices",
        "thru": null,
        "line": 1597
      },
      {
        "target": "OTM3-Delete",
        "thru": null,
        "line": 1598
      },
      {
        "target": "OTM3-Delete",
        "thru": null,
        "line": 1606
      },
      {
        "target": "OTM3-Rewrite",
        "thru": null,
        "line": 1618
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 1625
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1626
      },
      {
        "target": "BA00-Value-Reset",
        "thru": null,
        "line": 1634
      },
      {
        "target": "Invoice-Open",
        "thru": null,
        "line": 1640
      },
      {
        "target": "Invoice-Read-Next",
        "thru": null,
        "line": 1644
      },
      {
        "target": "AB130-Skip-Reader",
        "thru": null,
        "line": 1656
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1658
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1660
      },
      {
        "target": "else",
        "thru": null,
        "line": 1661
      },
      {
        "target": "Invoice-Delete-All",
        "thru": null,
        "line": 1663
      },
      {
        "target": "AB130-Skip-Reader",
        "thru": null,
        "line": 1672
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1673
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1675
      },
      {
        "target": "move",
        "thru": null,
        "line": 1676
      },
      {
        "target": "Invoice-Rewrite",
        "thru": null,
        "line": 1679
      },
      {
        "target": "AB130-Skip-Reader",
        "thru": null,
        "line": 1683
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1685
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1687
      },
      {
        "target": "else",
        "thru": null,
        "line": 1688
      },
      {
        "target": "Invoice-Delete-All",
        "thru": null,
        "line": 1690
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1701
      },
      {
        "target": "Invoice-Rewrite",
        "thru": null,
        "line": 1708
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1712
      },
      {
        "target": "Invoice-Read-Next",
        "thru": null,
        "line": 1712
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1718
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1768
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 1769
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1770
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1776
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 1777
      },
      {
        "target": "Invoice-Close",
        "thru": null,
        "line": 1778
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 1784
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1785
      },
      {
        "target": "Invoice-Read-Indexed",
        "thru": null,
        "line": 1805
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1811
      },
      {
        "target": "Invoice-Delete-All",
        "thru": null,
        "line": 1813
      },
      {
        "target": "AE020-Actual-Delete",
        "thru": null,
        "line": 1821
      },
      {
        "target": "Invoice-Read-Indexed",
        "thru": null,
        "line": 1826
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1831
      },
      {
        "target": "Invoice-Delete",
        "thru": null,
        "line": 1838
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 1855
      },
      {
        "target": "Purch-Read-Next",
        "thru": null,
        "line": 1858
      },
      {
        "target": "Purch-Rewrite",
        "thru": null,
        "line": 1881
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1887
      },
      {
        "target": "OTM5-Open",
        "thru": null,
        "line": 1893
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 1894
      },
      {
        "target": "OTM5-Read-Next",
        "thru": null,
        "line": 1897
      },
      {
        "target": "AD00-kill-invoicep",
        "thru": null,
        "line": 1904
      },
      {
        "target": "OTM5-Delete",
        "thru": null,
        "line": 1905
      },
      {
        "target": "OTM5-Delete",
        "thru": null,
        "line": 1912
      },
      {
        "target": "OTM5-Rewrite",
        "thru": null,
        "line": 1923
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 1930
      },
      {
        "target": "Pinvoice-Close",
        "thru": null,
        "line": 1931
      },
      {
        "target": "BA00-Value-Reset",
        "thru": null,
        "line": 1936
      },
      {
        "target": "Pinvoice-Open",
        "thru": null,
        "line": 1939
      },
      {
        "target": "Pinvoice-Read-Next",
        "thru": null,
        "line": 1943
      },
      {
        "target": "AC130-Skip-Reader",
        "thru": null,
        "line": 1955
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1957
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 1959
      },
      {
        "target": "else",
        "thru": null,
        "line": 1960
      },
      {
        "target": "PInvoice-Delete-All",
        "thru": null,
        "line": 1962
      },
      {
        "target": "AC130-Skip-Reader",
        "thru": null,
        "line": 1973
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1974
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 1976
      },
      {
        "target": "move",
        "thru": null,
        "line": 1977
      },
      {
        "target": "PInvoice-Rewrite",
        "thru": null,
        "line": 1984
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1992
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 2006
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 2007
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 2008
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 2014
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 2015
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 2016
      },
      {
        "target": "aa950-Display-File-Error",
        "thru": null,
        "line": 2022
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 2023
      },
      {
        "target": "PInvoice-Read-Indexed",
        "thru": null,
        "line": 2043
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 2049
      },
      {
        "target": "PInvoice-Delete-All",
        "thru": null,
        "line": 2051
      },
      {
        "target": "AD020-Actual-Delete",
        "thru": null,
        "line": 2059
      },
      {
        "target": "PInvoice-Read-Indexed",
        "thru": null,
        "line": 2064
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 2069
      },
      {
        "target": "PInvoice-Delete",
        "thru": null,
        "line": 2076
      },
      {
        "target": "BD010-Monthly-Check",
        "thru": null,
        "line": 2086
      },
      {
        "target": "BD020-Weekly-Check",
        "thru": null,
        "line": 2089
      },
      {
        "target": "BD030-Query-Check",
        "thru": null,
        "line": 2091
      },
      {
        "target": "Value-Open-Output",
        "thru": null,
        "line": 2169
      },
      {
        "target": "Value-Delete-All",
        "thru": null,
        "line": 2172
      },
      {
        "target": "Value-Open",
        "thru": null,
        "line": 2189
      },
      {
        "target": "Value-Read-Next",
        "thru": null,
        "line": 2192
      },
      {
        "target": "Value-ReWrite",
        "thru": null,
        "line": 2204
      },
      {
        "target": "Value-Close",
        "thru": null,
        "line": 2211
      },
      {
        "target": "Value-Close",
        "thru": null,
        "line": 2217
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines",
        "line": 628
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 642
      },
      {
        "from": "to-day",
        "to": "u-Date",
        "line": 643
      },
      {
        "from": "space",
        "to": "WS-Found-Error",
        "line": 647
      },
      {
        "from": "\"N\"",
        "to": "WS-Reply",
        "line": 648
      },
      {
        "from": "zeros",
        "to": "WS-Term-Code",
        "line": 685
      },
      {
        "from": "WS-Calling-Data",
        "to": "WS-Backup-Calling-Data\n                       move \"sl130\" to WS-Called\n                       move \"xl150\" to WS-Caller\n                       call WS-caller using  WS-calling-data\n                                             System-Record\n                                             to-day\n                                             file-defs\n              end-if\n              move     WS-Term-Code to Return-Code\n              if       P-Flag-A = 1\n                       move WS-Calling-Data to WS-Backup-Calling-Data\n                       move \"pl130\" to WS-Called\n                       move \"xl150\" to WS-Caller\n                       call WS-caller using  WS-calling-data\n                                             System-Record\n                                             to-day\n                                             file-defs\n              end-if\n              ADd      WS-Term-Code to Return-Code\n              move     Return-Code to WS-Term-Code *> JIC there is a later Test for it\n              if       Return-Code  > zero       *> had errors running pl130 or sl130\n                       display XL119    at 1601 with foreground-color 4\n                       display XL001    at 1701 with foreground-color 2\n                       ACcept  WS-Reply at 1732 with foreground-color 2\n                       go to aa990-Menu-Error\n              end-if\n              move WS-Backup-Calling-Data to WS-Calling-Data\n     end-if\n*>\n*> Now the Errors that the user MUST fix, e",
        "line": 691
      },
      {
        "from": "\"Y\"",
        "to": "WS-Found-Error\n     end-if\n     if      (S-Flag-P = 1 or 2)        *>  Sales   or\n         or  (P-Flag-P = 1 or 2)        *>  Purchase payments Proofed not posted",
        "line": 725
      },
      {
        "from": "\"Y\"",
        "to": "WS-Found-Error\n     end-if\n*>\n*> Check if errors found and ABort as I cannot know if amended invoices exist or any other\n*>   reason for a invoice reprint via sl930 and likewise for packing/picking notes sl950\n*>     Running is too risky so let user decide",
        "line": 730
      },
      {
        "from": "1",
        "to": "SL-EoC",
        "line": 746
      },
      {
        "from": "1",
        "to": "PL-EoC",
        "line": 751
      },
      {
        "from": "1",
        "to": "SL-EoC",
        "line": 764
      },
      {
        "from": "1",
        "to": "PL-EoC",
        "line": 769
      },
      {
        "from": "zero",
        "to": "PL-EoC",
        "line": 782
      },
      {
        "from": "zero",
        "to": "SL-EoC",
        "line": 789
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 803
      },
      {
        "from": "u-bin",
        "to": "S-End-Cycle-Date",
        "line": 809
      },
      {
        "from": "u-bin",
        "to": "BL-End-Cycle-Date",
        "line": 812
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1297
      },
      {
        "from": "802",
        "to": "Error-Code",
        "line": 1298
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1302
      },
      {
        "from": "801",
        "to": "Error-Code",
        "line": 1303
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1307
      },
      {
        "from": "804",
        "to": "Error-Code",
        "line": 1308
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1312
      },
      {
        "from": "804",
        "to": "Error-Code",
        "line": 1313
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1317
      },
      {
        "from": "801",
        "to": "Error-Code",
        "line": 1318
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1322
      },
      {
        "from": "802",
        "to": "Error-Code",
        "line": 1323
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1327
      },
      {
        "from": "805",
        "to": "Error-Code",
        "line": 1328
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1332
      },
      {
        "from": "805",
        "to": "Error-Code",
        "line": 1333
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1337
      },
      {
        "from": "803",
        "to": "Error-Code",
        "line": 1338
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1342
      },
      {
        "from": "806",
        "to": "Error-Code",
        "line": 1343
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1347
      },
      {
        "from": "806",
        "to": "Error-Code",
        "line": 1348
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1352
      },
      {
        "from": "803",
        "to": "Error-Code",
        "line": 1353
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1357
      },
      {
        "from": "801",
        "to": "Error-Code",
        "line": 1358
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1362
      },
      {
        "from": "804",
        "to": "Error-Code",
        "line": 1363
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1367
      },
      {
        "from": "802",
        "to": "Error-Code",
        "line": 1368
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1372
      },
      {
        "from": "805",
        "to": "Error-Code",
        "line": 1373
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1377
      },
      {
        "from": "803",
        "to": "Error-Code",
        "line": 1378
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1382
      },
      {
        "from": "806",
        "to": "Error-Code",
        "line": 1383
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1389
      },
      {
        "from": "808",
        "to": "Error-Code",
        "line": 1390
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1394
      },
      {
        "from": "807",
        "to": "Error-Code",
        "line": 1395
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1399
      },
      {
        "from": "810",
        "to": "Error-Code",
        "line": 1400
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1404
      },
      {
        "from": "810",
        "to": "Error-Code",
        "line": 1405
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1409
      },
      {
        "from": "807",
        "to": "Error-Code",
        "line": 1410
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1414
      },
      {
        "from": "808",
        "to": "Error-Code",
        "line": 1415
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1419
      },
      {
        "from": "811",
        "to": "Error-Code",
        "line": 1420
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1424
      },
      {
        "from": "811",
        "to": "Error-Code",
        "line": 1425
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1429
      },
      {
        "from": "809",
        "to": "Error-Code",
        "line": 1430
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1434
      },
      {
        "from": "812",
        "to": "Error-Code",
        "line": 1435
      },
      {
        "from": "2",
        "to": "WS-Operation",
        "line": 1439
      },
      {
        "from": "812",
        "to": "Error-Code",
        "line": 1440
      },
      {
        "from": "3",
        "to": "WS-Operation",
        "line": 1444
      },
      {
        "from": "809",
        "to": "Error-Code",
        "line": 1445
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1449
      },
      {
        "from": "807",
        "to": "Error-Code",
        "line": 1450
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1454
      },
      {
        "from": "810",
        "to": "Error-Code",
        "line": 1455
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1459
      },
      {
        "from": "808",
        "to": "Error-Code",
        "line": 1460
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1464
      },
      {
        "from": "811",
        "to": "Error-Code",
        "line": 1465
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1469
      },
      {
        "from": "809",
        "to": "Error-Code",
        "line": 1470
      },
      {
        "from": "1",
        "to": "WS-Operation",
        "line": 1474
      },
      {
        "from": "812",
        "to": "Error-Code",
        "line": 1475
      },
      {
        "from": "WS-Operation",
        "to": "XL118B",
        "line": 1483
      },
      {
        "from": "WS-File-Name",
        "to": "XL118C",
        "line": 1484
      },
      {
        "from": "\"Y\"",
        "to": "oi-3-flag",
        "line": 1497
      },
      {
        "from": "\"Y\"",
        "to": "oi-5-flag",
        "line": 1499
      },
      {
        "from": "2",
        "to": "WS-term-code",
        "line": 1505
      },
      {
        "from": "3",
        "to": "WS-Term-Code",
        "line": 1510
      },
      {
        "from": "then",
        "to": "last etc and save recs\n*>   setting accct to Dead if no activity\n*> 2nd",
        "line": 1532
      },
      {
        "from": "zero",
        "to": "Sales-Status",
        "line": 1559
      },
      {
        "from": "zero",
        "to": "Sales-Current",
        "line": 1564
      },
      {
        "from": "Sales-Current",
        "to": "Sales-Last",
        "line": 1566
      },
      {
        "from": "zero",
        "to": "STurnover-Q (Current-Quarter)",
        "line": 1569
      },
      {
        "from": "zero",
        "to": "Sales-Average\n                           Sales-Activety",
        "line": 1572
      },
      {
        "from": "WS-OTM3-Record",
        "to": "Soi-Header",
        "line": 1594
      },
      {
        "from": "zero",
        "to": "soi-deduct-amt",
        "line": 1613
      },
      {
        "from": "\"Z\"",
        "to": "soi-applied",
        "line": 1615
      },
      {
        "from": "zero",
        "to": "soi-p-c",
        "line": 1616
      },
      {
        "from": "\"S\"",
        "to": "WS-Value-System",
        "line": 1633
      },
      {
        "from": "SInvoice-Record",
        "to": "SInvoice-Header",
        "line": 1647
      },
      {
        "from": "\"B\"",
        "to": "sih-day-book-flag",
        "line": 1668
      },
      {
        "from": "zero",
        "to": "sih-lines\n              move SInvoice-Header to SInvoice-Record\n              perform  Invoice-Rewrite",
        "line": 1677
      },
      {
        "from": "SInvoice-Header",
        "to": "SInvoice-Record",
        "line": 1707
      },
      {
        "from": "SL-os-bal-This-month",
        "to": "SL-os-bal-Last-month",
        "line": 1725
      },
      {
        "from": "zeros",
        "to": "SL-os-bal-This-month       SL-variance\n                       SL-invoices-This-month     SL-payments\n                       SL-credit-deductions       SL-cn-unappl-This-month\n                       SL-credit-notes-This-month",
        "line": 1726
      },
      {
        "from": "\"Sales\"",
        "to": "WS-File-Name\n                when 802  move \"OTM3\"          to WS-File-Name\n                when 803  move \"SInvoice\"      to WS-File-Name\n                when 804  move \"Temp Sales\"    to WS-File-Name\n                when 805  move \"Temp OTM3\"     to WS-File-Name\n                when 806  move \"Temp SInvoice\" to WS-File-Name\n                when 807  move \"Purchase\"      to WS-File-Name\n                when 808  move \"OTM5\"          to WS-File-Name\n                when 809  move \"PInvoice\"      to WS-File-Name\n                when 810  move \"Temp Purchase\" to WS-File-Name\n                when 811  move \"Temp OTM5\"     to WS-File-Name\n                when 812  move \"Temp PInvoice\" to WS-File-Name\n                when other\n                          move \"Error in AB995\" to WS-File-Name\n              end-evaluate\n     end-if\n     if       WS-Error-Op not = zero\n              evaluate WS-Error-Op\n                when 1    move \"Open \"   to WS-Operation\n                when 2    move \"Read \"   to WS-Operation\n                when 3    move \"Write\"   to WS-Operation\n                when 4    move \"Rewrite\" to WS-Operation\n                when 5    move \"Delete\"  to WS-Operation\n                when other\n                          move \"ab995bug\" to WS-Operation\n              end-evaluate\n     end-if",
        "line": 1737
      },
      {
        "from": "4",
        "to": "WS-Operation",
        "line": 1766
      },
      {
        "from": "802",
        "to": "Error-Code",
        "line": 1767
      },
      {
        "from": "5",
        "to": "WS-Operation",
        "line": 1774
      },
      {
        "from": "802",
        "to": "Error-Code",
        "line": 1775
      },
      {
        "from": "4",
        "to": "WS-Operation",
        "line": 1782
      },
      {
        "from": "801",
        "to": "Error-Code",
        "line": 1783
      },
      {
        "from": "soi-invoice",
        "to": "Sinvoice-Nos",
        "line": 1802
      },
      {
        "from": "zeros",
        "to": "Sitem-Nos",
        "line": 1803
      },
      {
        "from": "SInvoice-Record",
        "to": "SInvoice-Header",
        "line": 1808
      },
      {
        "from": "zero",
        "to": "Purch-Status",
        "line": 1865
      },
      {
        "from": "zero",
        "to": "Purch-Current",
        "line": 1870
      },
      {
        "from": "Purch-Current",
        "to": "Purch-Last",
        "line": 1872
      },
      {
        "from": "zero",
        "to": "PTurnover-Q (Current-Quarter)",
        "line": 1875
      },
      {
        "from": "zero",
        "to": "Purch-Average\n                           Purch-Activety",
        "line": 1878
      },
      {
        "from": "zero",
        "to": "poi-deduct-amt",
        "line": 1918
      },
      {
        "from": "\"Z\"",
        "to": "poi-applied",
        "line": 1920
      },
      {
        "from": "zero",
        "to": "poi-p-c",
        "line": 1921
      },
      {
        "from": "\"P\"",
        "to": "WS-Value-System",
        "line": 1935
      },
      {
        "from": "WS-PInvoice-Record",
        "to": "PInvoice-Header",
        "line": 1946
      },
      {
        "from": "\"B\"",
        "to": "pih-day-book-flag",
        "line": 1967
      },
      {
        "from": "zero",
        "to": "pih-lines",
        "line": 1978
      },
      {
        "from": "PInvoice-Header",
        "to": "WS-PInvoice-Record",
        "line": 1983
      },
      {
        "from": "PL-os-bal-This-month",
        "to": "PL-os-bal-Last-month",
        "line": 1996
      },
      {
        "from": "zeros",
        "to": "PL-os-bal-This-month       PL-variance\n                       PL-invoices-This-month     PL-payments\n                       PL-credit-deductions       PL-cn-unappl-This-month\n                       PL-credit-notes-This-month",
        "line": 1997
      },
      {
        "from": "4",
        "to": "WS-Operation",
        "line": 2004
      },
      {
        "from": "808",
        "to": "Error-Code",
        "line": 2005
      },
      {
        "from": "5",
        "to": "WS-Operation",
        "line": 2012
      },
      {
        "from": "808",
        "to": "Error-Code",
        "line": 2013
      },
      {
        "from": "4",
        "to": "WS-Operation",
        "line": 2020
      },
      {
        "from": "807",
        "to": "Error-Code",
        "line": 2021
      },
      {
        "from": "poi-invoice",
        "to": "Pinvoice-Nos",
        "line": 2040
      },
      {
        "from": "zeros",
        "to": "Pitem-Nos",
        "line": 2041
      },
      {
        "from": "WS-PInvoice-Record",
        "to": "PInvoice-Header",
        "line": 2046
      },
      {
        "from": "1",
        "to": "new-quarter\n     else\n      if      cyclea = 13\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter",
        "line": 2098
      },
      {
        "from": "1",
        "to": "new-quarter\n     else\n      if      cyclea = 53\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter",
        "line": 2109
      },
      {
        "from": "\"Y\"",
        "to": "WS-Reply\n       else\n        if    function lower-case (WS-CD-Args (8:1)) = \"n\"\n              move \"N\" to WS-Reply\n        end-if\n       end-if\n       go     to BD032-Skip-Question\n     end-if\n\n     display  \"Is this the end of a quarter (Y/N) - [ ]\" at 1601 with foreground-color 2",
        "line": 2123
      },
      {
        "from": "1",
        "to": "new-quarter\n       else\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter",
        "line": 2145
      },
      {
        "from": "zero",
        "to": "WS-Count-Rows\n              if      FS-RDBMS-Used              *> Extra step for RDB processing\n                      perform  Value-Delete-All\n                      move zero to File-Function\n              end-if\n              display XL116  at 1401 with foreground-color 2 underline\n              if      FS-RDBMS-Used\n                      move WS-Count-Rows  to Z9\n                      display \" Delete count = \" at 1437 with foreground-color 4\n                      Display Z9                 at 1453 with foreground-color 4\n              end-if\n              move    \"Y\" to WS-Value-ClearDown\n              go to BA020-End\n     end-if\n     if       New-Year = 1                  *> clear down all data\n        and   WS-Value-ClearDown = \"Y\"\n              go to BA020-End\n     end-if\n*>\n     perform  Value-Open",
        "line": 2170
      },
      {
        "from": "VA-T-This",
        "to": "VA-T-Last",
        "line": 2199
      },
      {
        "from": "zero",
        "to": "VA-T-This",
        "line": 2200
      },
      {
        "from": "VA-V-This",
        "to": "VA-V-Last",
        "line": 2201
      },
      {
        "from": "zero",
        "to": "VA-V-This",
        "line": 2202
      },
      {
        "from": "to-day",
        "to": "WS-Date",
        "line": 2230
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2233
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit",
        "line": 2237
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-Date",
        "line": 2244
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "closed   *\n*>       and paid.                                      *\n*>       Note that there are two invoice files for each *\n*>       ledger - the main, which contains invoice line *\n*>       items and the header record - these are        *\n*>       deleted after a proof report, invoices printed *\n*>       and posted to the OTM file.\n*>\n*>       The second is                                  *\n*>       OTM (Open Item File) which contains unpaid     *\n*>       invoices and these are deleted after being     *\n*>       paid and closed after months end & statement   *\n*>       produced by email or printing.                 *\n*>\n*>       As Deleted records will still take up space in *\n*>       the Cobol files are well as most RDBMS another *\n*>       process is run at start of a new year to clear *\n*>       these out by saving data to temp files and     *\n*>",
        "line": 69
      },
      {
        "type": "IF",
        "condition": "using Autorun you MUST ensure that all         *\n*>    required computers are on likewise ALL required   *\n*>    printers are on with plenty of paper.             *\n*>\n*>    These process could produce (if not already run,  *\n*>    Proof reports for Sales and Purchase ledgers,     *\n*>    Printed all outstanding :                         *\n*>    Invoices and Purchase Orders, Sales Picking &     *\n*>    Packing lists, Posting reports for both Sales and *\n*>    Purchase Ledgers.                                 *\n*>                                                      *\n*> WARNING This program will only autorun sl130 & pl130 *\n*>    but should have been run during normal processing *\n*>    prior to running End of Cycle                     *\n*>\n*>    At end of month, as in before End of Day these    *\n*>    processes should have been run prior to running   *\n*>    xl150 System End of Cycle processing.             *\n*>                                                      *\n*>    YES, mentioned twice.                             *\n*>\n*>  If you do not follow these procedures you run the   *\n*>   likely risk of losing data that you might rely on  *\n*>   for quarterly and End of year ACcounting.          *\n*>\n*>  For this reason, this program will check as much as *\n*>  possible that proofs and posting have occured when  *\n*>  xl150 (End of Period processing) runs.              *\n*>  NOTE that is cannot check if you have run data      *\n*>  Backups which by default is run every time you exit *\n*>  any of the systems.                                 *\n*>                                                      *\n*>*******************************************************\n*>\n identification          division.\n*>===============================\n*>\n*>**\n     Program-Id.         xl150.\n*>**\n*>   Author.             Cis Cobol Conversion By V B Coen FBCS, FIDM, FIDPM,\n*>                       25/10/83,\n*>                       For Applewood Computers.\n*>**\n*>   Remarks.            End of Cycle Processing.\n*>\n*>                       This program must be run before ANY ACAS processing\n*>                       on the FIRST day of the month or the last day of the\n*>                       current month after all processes have been run.\n*>\n*>                       TIMINGS: For small to medium business the total time\n*>                       is within 10 minutes even on a slow system.\n*>                       Current systems are within 1 - 3 minutes.\n*>                       Yes, it is quick - subject to number of invoices\n*>                       produced monthly (timing Based on < 2,500 per month)\n*>                       with > 70% paid by end of month.\n*>**\n*>   Security.           Copyright (C) 1976-2025 and later, Vincent Bryan Coen.\n*>                       Distributed under the GNU General Public License\n*>                       v2.0. Only. See the file COPYING for details.\n*>\n*>                       This does not give you the rights to sell or rent on this\n*>                       software or any component of the same.\n*>                       For such right contact the lead programmer as indicated at\n*>                       inside front page of all manuals with your business proposals.\n*>**\n*>   Version.            See Prog-Name In Ws.\n*>**\n*>   Called Modules.\n*>                       maps04.\n*>                       ACas013 ->   --- Will run sl130 and pl130 if not run already\n*>                        valueMT\n*>                       ACas012 ->\n*>                        salesMT\n*>                       ACas019 ->\n*>                        OTM3MT\n*>                       ACas022 ->\n*>                        purchMT\n*>                       ACas029 ->\n*>                        OTM5MT\n*>\n*>**\n*>   Temporary files.\n*>                       Invoice     -  Data cleared down after usage.\n*>                       Open-Item   -  Data cleared down after usage.\n*>                       Ledgers     -  Data cleared down after usage.\n*>                                         for both sales and purchasing.\n*>                                      E.g., zero size.\n*>**\n*>   Error messages used.\n*>                       SL006\n*>                       SL007\n*>                       SL008\n*>                       SL009\n*>\n*>                       XL001\n*>\n*>                       XL101\n*>                       XL102\n*>                       XL103\n*>                       XL104\n*>                       XL105\n*>                       XL106\n*>                       XL107\n*>                       XL108\n*>                       XL116\n*>                       XL117.\n*>                       XL118.\n*>                       XL119.\n*>**\n*>   Error Codes.\n*>                       WS-Term-Code = 3 for File status Error.\n*>  Changes.\n*>   ------ vbc -     To Zero Paid This Month (Oi-P-C)\n*> 05/03/83 vbc -     Remove 92 day old PF invoices from invoice file.\n*> 31/03/83 vbc -     Fix for new invoice file layout.\n*> 21/02/83 vbc -     To strip closed records from invoice file.\n*> 07/10/83 vbc -     Zap io-deduct-amt from payment records.\n*> 25/10/83 vbc -     CIS Cobol conversion.\n*> 09/12/83 vbc -     Change error messages to hit return.\n*> 19/12/83 vbc -     Allow for system record 4.\n*> 01/03/84 vbc -     Support Sales-Unapplied in phase1 routine.\n*> 10/03/84 vbc -     Support for ih-day-book-flag.\n*> 01/04/84 vbc -     If openitm3 inv closed delete inv from inv file\n*>                    but only if SL-own-nos not = y.\n*>                    At end of year kill value file,also ACcept pass\n*>                    before starting & Test.\n*> 17/05/84 vbc -     If end of quarter/year remove deleted records\n*>                    from Sales-file. remove deleted recs from itm3.\n*> 24/08/84 vbc -     Tidy up phase display,remove new year Test in phase 3.\n*> 25/09/84 vbc -     Support for PL-payments in wssys4.\n*> 08/03/85 vbc -     Build prog to include pl150 & sl150.\n*> 13/02/02 vbc -     VA-Systems = p corrected & Y2K.\n*> 29/01/09 vbc -     Migration to Open Cobol.\n*> 19/03/09 vbc -     Updated Sales file layouts. 3.00.02.\n*> 21/12/11 vbc - .03 Support for dates other than UK & clean up msgs\n*>                    Error msgs to GLnnn,\n*>                    Support for path+filenames.\n*>                    replaced copies in common to sales, purchase etc\n*>                    changing field names to suit.\n*> 10/10/16 vbc - .04 Init. upgrades for RDB.  LOTS MORE NEEDED.\n*>                    ACas013 Added replacing value file\n*>                    Replace temp file records with fdsl & fdpl\n*>                    renaming used fields in prog.\n*> 14/01/18 vbc - .05 Update including RDB for v3.02.\n*>   to               Removed usage of maps99 for displays.\n*> 27/01/18           Added BA00-Value-Reset performed in phase-2B-End reducing\n*>                    dup code and now only done once.\n*>                    Cleaned up section and paragraph names.\n*>                    For OTM3 and sales inv files update or delete it instead\n*>                    of using temp files and re-creating data.\n*>                    At start of New Year using themp files to flush indexes\n*>                    and deleted records areas on disk.\n*>                    Init Tests for non posted invoice, payments etc will\n*>                    be displayed all at once if found, before terminating.\n*>                    Removed usage of dummy file defs.\n*>                    Added new error messages and better file status displays.\n*>                    Cleaned them up to use standard routines.\n*>                    Removed the check for own invoice nos so now deletes\n*>                    as well (Sales Ledger). See comments for 01/04/84.\n*>                    Value records are cleared down at New Year not deleted\n*>                    as they will need to be recreated by system.\n*>                    This does 'assume' that codes are not discontinued over time.\n*>                    May need to review this decision.\n*> 21/03/18 vbc - .06 Start Adding code for Autorun (also needed in PL, SL etc.\n*> 22/03/18 vbc -     Extra code for running if needed pl130 and/or sl130 value\n*>                    reports and these have been changed so they will not stop\n*>                    if no file or data exists.\n*> 18/06/20 vbc - .07 'Have you' warning message one line too high.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 30/12/24 vbc - .08 change WS-Temp-Code to use 8 not 12 as its pic 9.\n*> 05/01/25 vbc       Changed sl130 and pl130 to read and rewrite param rec\n*>                    after field change in each. This needs to be done for EVERY\n*>                    ACAS program that does ANY param field changes.\n*>\n*>    TO BE CODED.\n*>    ^^^^^^^^^^^\n*>                    If using Autorun, will run any outstanding processes such as:\n*>                    Sales invoice proof, printing (invoices and packing notes) & posting.\n*>                    Purchase PO proof, print Purchase orders &",
        "line": 102
      },
      {
        "type": "IF",
        "condition": "not using Autorun will stop with error / warning messages if\n*>                    needed to be ACtioned.\n*>\n*>                    MORE CODING NEEDED !!!!!!\n*>\n*>                    IT IS NOT RECOMMENDED TO RUN XL150 in Autorun as there are required\n*>                    processes that might well not have been run.\n*>\n*>   Functions Added: TO BE Added....\n*>\n*>                    IRS   ---- NO - done within at user request.\n*>                    Stock ---- NO - done within at user request.\n*>                    General -- NO - done within at user request.\n*>\n*>*************************************************************************\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers ACcounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me ABout the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            Section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n copy \"slselois.cob\".\n*>\n     select Temp-Sales-File     assign file-21\n                                ACcess sequential\n                                status FS-Reply.\n*>\n     select Temp-Purchase-File  assign file-21\n                                ACcess sequential\n                                status FS-Reply.\n*>\n     select Temp-Invoice-File   assign file-21,\n                                ACcess sequential,\n                                status FS-Reply.\n*>\n data                    division.\n*>===============================\n*>\n file Section.\n*>-----------\n*>\n COPY \"slfdois.cob\".  *> this is the longer one by 5 bytes (118 -113)\n*>\n copy \"fdsl.cob\"    replacing\n                          Sales-File      by Temp-Sales-File\n                          Sales-Record    by Temp-Sales-Record\n                          Sales-Current   by Temp-sales-Current\n                          Sales-Last      by temp-sales-Last\n                          Sales-Unapplied by temp-sales-Unapplied\n                          Sales-Status    by temp-Sales-Status\n                          Sales-Average   by temp-sales-Average\n                          Sales-Activety  by temp-sales-Activety\n                          STurnover-Q     by temp-STurnover-Q.\n*>\n fd  temp-invoice-file.\n*>\n 01  temp-invoice-record.\n     03  temp-invoice-key   pic x(10).\n     03  filler             pic x(128).  *> APPLIES TO Purchase only of 100 and SL of 137.\n*>                                            So using the largest as sales ledger layout.\n*>  Added 25/01/18\n*>\n copy \"fdpl.cob\"   replacing\n                          Purchase-File   by Temp-Purchase-File\n                          Purch-Record    by Temp-Purch-Record\n                          purch-current   by Temp-Purch-Current\n                          purch-last      by temp-Purch-Last\n                          purch-unapplied by temp-Purch-Unapplied\n                          purch-status    by temp-Purch-status\n                          purch-average   by temp-Purch-Average\n                          purch-activety  by temp-Purch-Activety\n                          pturnover-q     by temp-STurnover-Q.\n\n working-storage Section.\n*>----------------------\n 77  prog-name           pic x(16) value \"xl150 (3.02.08)\".\n 77  OS-Delimiter        pic x        value \"/\".\n 77  ACAS_BIN            pic x(512)   value spaces.  *> Added\n 77  ACAS_LEDGERS        pic x(500)   value spaces.\n 77  Arg-Number          pic 9        value zero.\n 77  z                   binary-char  value zero.\n 77  z9                  pic z(6)9    value zero.\n*>\n*> holds program parameter values from command line\n 01  Arg-Vals                         value spaces.\n     03  Arg-Value       pic x(525)  occurs 2.\n 01  Arg-Test            pic x(525)   value spaces.\n*>\n*> Here for extra code to get args for BAtch processing via crontab etc.\n*>\n 01  Saved-CD-Args       pic x(13).\n*>\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n copy \"wsval.cob\".   *> DONE\n*>\n*> SL\n*>\n COPY \"wssl.cob\".    *> WS-Sales-Record (WS-Sales-Key) of 300 bytes - Test length.\n*>\n COPY \"slwsoi3.cob\".    *> WS-OTM3-Record, redefs o-t-m-3 & OI-Header (slwsoi)\n*>   Moves to ; OR from  so remove these moves.  */\n copy \"slwssoi.cob\"  replacing\n                    ==si-header==  by ==soi-header redefines WS-OTM3-Record==\n                    si-invoice    by soi-invoice\n                    si-type       by soi-type\n                    si-p-c        by soi-p-c\n                    si-s-closed   by ss-closed\n                    si-deduct-amt by soi-deduct-amt\n                    si-applied    by soi-applied.\n*>\n COPY \"slwsinv2.cob\"  replacing\n                          Invoice-Record by SInvoice-Record\n                          Invoice-Key    by Sinvoice-Key\n                          Invoice-Nos    by Sinvoice-Nos\n                          Item-Nos       by Sitem-Nos.\n 01  WS-Invoice-Record  redefines SInvoice-Record\n                        pic x(137).      *> Needed for FH.\n*>\n copy \"slwsinv.cob\".  *> Holds header (SInvoice-Header) and 40 lines (SInvoice-Bodies)\n*>                        as sih-                           sil-\n*> PL / BL\n*>\n COPY \"wspl.cob\".    *> WS-Purch-Record (WS-Purch-Key) of 302 bytes - Test length.\n*>\n COPY \"plwsoi5B.cob\".  *> WS-OTM5-Record\n copy \"plwssoi.cob\"  replacing\n                    ==si-header==  by ==poi-header redefines WS-OTM5-Record==\n                    si-header     by poi-header\n                    si-invoice    by poi-invoice\n                    si-type       by poi-type\n                    si-p-c        by poi-p-c\n                    si-s-closed   by ps-closed\n                    si-deduct-amt by poi-deduct-amt\n                    si-applied    by poi-applied.\n*>\n COPY \"plwspinv2.cob\"   replacing\n                          invoice-key    by Pinvoice-Key\n                          invoice-nos    by Pinvoice-Nos\n                          item-nos       by Pitem-Nos.\n*>\n copy \"plwspinv.cob\"  replacing\n       *>                invoice-header   by PInvoice-Header\n                    ih-Test          by pih-Test\n                    ih-type          by pih-type\n                    applied          by papplied\n                    ih-lines         by pih-lines\n                    ih-day-book-flag by pih-day-book-flag.\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n*>     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.   *> for GL\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.   *> For IRS\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x. *> Sales ledger rec.\n*>     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.   *> Sales delivery details rec.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.  *> Purch ledger rec.\n     03  WS-Pay-Record          pic x.\n*>     03  WS-Invoice-Record      pic x.   *> Sales invoice rec.\n*>     03  WS-OTM3-Record         pic x.\n*>     03  WS-PInvoice-Record     pic x.   *> Purch invoice rec.\n*>     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-Testing to zero to stop logging.\n*>\n 01  File-Info                          value zero.       *> Layout as per GNU v2 manual\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.    *> Mod date.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.    *> Mod time\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  WS-data.\n     03  WS-Reply        pic x.\n     03  WS-Passwd       pic x(4)        value spaces.\n     03  WS-Backup-Calling-Data\n                         pic x(28)       value spaces.\n     03  new-quarter     pic 9           value zero.\n     03  New-Year        pic 9           value zero.\n     03  Test-invoice    pic 9(8)        value zero.\n     03  a               pic 99.\n     03  pf-Test         binary-long     value zero.\n     03  inv-Test        pic 9(5)  comp  value zero.\n     03  SL-EoC          pic 9           value zero.\n     03  PL-EoC          pic 9           value zero.\n*>\n     03  WS-Value-System pic x           value space.\n*>\n     03  WS-Proc-Month.\n         05  WS-Proc-Mth pic 99                  value zero.\n             88  WS-Good-Month                   values 01 thru 12.\n     03  WS-Value-ClearDown pic x        value \"N\".\n*>\n     03  WS-env-lines    pic 999              value zero.\n     03  WS-lines        binary-char unsigned value zero.\n     03  WS-22-lines     binary-char unsigned value zero.\n     03  WS-23-lines     binary-char unsigned value zero.\n*>\n     03  WS-Found-Error  pic x           value space.  *> = Y if found on prerun Tests\n     03  WS-Msg          pic x(24)       value spaces. *> See AB995-Eval-Status\n     03  WS-File-Name    pic x(14)       value spaces. *>  Ditto.\n     03  WS-Operation    pic x(7)        value spaces. *>  Ditto.\n     03  Error-Code      pic 999         value zero.   *>  Ditto.\n     03  WS-Error-Op     pic 99          value zero.   *>  Ditto.\n*>\n 01  WS-Test-Date            pic x(10).\n 01  WS-Date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-Date             pic x(10).\n     03  WS-UK redefines WS-Date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-Date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-Date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide    Used are 6,7,8,9\n     03  SY006           pic x(62) value \"SY006 Program Arguments limited to two and you have specified \".\n     03  SY007           pic x(35) value \"SY007 Program arguments incorrect: \".\n     03  SY008           pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY009           pic x(53) value \"SY009 Environment variables not yet set up : ABORTING\".\n*>\n     03  XL001          pic x(31) value \"XL001 ABorting. Press return   \".\n*>    03  XL011           pic x(25) value \"XL011 Note and hit Return\".\n*> Module specific\n     03  XL101          pic x(37) value \"XL101 Proofed but NOT posted invoices\".\n     03  XL102          pic x(37) value \"XL102 Proofed but NOT posted payments\".\n     03  XL103          pic x(37) value \"XL103 Sales/Purchase Analysis NOT run\".\n     03  XL104          pic x(64) value \"XL104 I'm confused: You appear to have rejected the run, ABorted\".\n     03  XL105          pic x(32) value \"XL105 ERROR.... Processing file \".\n     03  XL106          pic x(38) value \"XL106 Purchase Transactions Not Posted\".\n     03  XL107          pic x(35) value \"XL107 Sales Transactions Not Posted\".\n     03  XL108          pic x(45) value \"XL108 Running Sales/Purchase Analysis reports\".\n     03  XL116          pic x(35) value \"XL116 End of year; VALUE Data reset\".\n     03  XL117          pic x(27) value \"XL117 Value Data on Update \".\n     03  XL118.       *> 47 chars  Used for common file error reporting.\n         05  filler     pic x(15) value \"XL118 Error on \".\n         05  XL118B     pic x(08) value spaces.    *> Open, Read, Write, delete, rewrite.\n         05  filler     pic x(10) value \"with File \".\n         05  XL118C     pic x(14) value spaces.\n                        *> Sales, Purchase, OTM3, OTM5, Sinvoice, Pinvoice.\n     03  XL119          pic x(43) value \"XL119 Error/s when running Analysis Report.\".\n*>\n linkage Section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wssys4.cob\".\n copy \"wsnames.cob\".\n*>\n 01  To-Day              pic x(10).\n*>\n procedure division using WS-Calling-Data\n                          System-Record\n                          System-Record-4\n                          To-Day\n                          File-Defs.\n*>=======================================\n aa00-Main Section.\n*>\n*> Prior to being called, System param & the system total records have been\n*>   read in and passed via linkage by sales, purchase.\n*>         THIS program is only called by these two.14/01/18.\n*>\n*> During the run, program will check to see if RDB processing is on and if so\n*>   reduce the usage of intermediate file processing by just deleting dead rows.\n*>\n*> For Cobol files the file clean ups will occur at start New Year only.\n*>  and all temp files cleared done to zero size.\n*>\n*> So existing code modified to process for new quarter deleting dead records.\n*>\n*>  New Year processing to use intermediate Cobol files if processing files.\n*>  For RDB will use a sql utility to clean up tables or the BAsic method of\n*>   making a BAck up of the SQL and data and",
        "line": 283
      },
      {
        "type": "IF",
        "condition": "WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines.\n     subtract 2 from WS-lines giving WS-22-lines.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     perform  aa030-Display-Heads.\n*>\n*> get today as binary to use in compares with data files\n*>\n     move     zero  to  u-bin.\n     move     to-day to u-Date.\n     call     \"maps04\"  using  maps03-ws.\n*>\n aa010-Acpt-Reply.\n     move     space to WS-Found-Error.  *> JIC\n     move     \"N\" to WS-Reply.\n*>\n*> First block is for AUTO run via sales or purchase menu program when given 2 params\n*>   sales    NULL xl150spx\n*>    OR\n*>   purchase NULL xl150spx\n*>\n     if       function lower-case (WS-CD-Args (1:5)) not = \"xl150\"\n              go to aa012-Display-Warnings.\n*>\n*>  So it is AUTO RUN\n*>\n     go       to aa015-Recheck-for-Issues.\n*>\n aa012-Display-Warnings.\n     display  \"THIS PROGRAM IS DESTRUCTIVE - ENSURE YOU HAVE RUN A BACK UP FIRST\" at 0301 with foreground-color 4 highlight.\n     display  \"WARNING: MAKE SURE THAT DATE IS AT END OF CYCLE. I.E., END OF MONTH\" at 0501 with foreground-color 4.\n     display  \"All Invoices, Payments have been proofed & posted and Analysis reports run\" at 0601 with foreground-color 4.\n     display   \"  For both Sales and Purchase Ledgers\" at 0701 with foreground-color 4.\n     display   \"  That NO ONE else is using the ACAS system\" at 0801 with foreground-color 4.\n     display  \"Have you made a Backup of ALL DATA FILES? If so; \"               at 1012 with foreground-color 2.\n     display  \"Confirm end of Cycle Processing to be Run (Y/N) - [ ]\" at 1112 with foreground-color 2.\n     ACcept   WS-Reply at 1163 with foreground-color 6 update UPPER.\n*>\n     if       WS-Reply = \"N\"        *> WS-Term-Code = 2\n              go to  aa990-Menu-Error.\n*>\n     if       WS-Reply not = \"Y\"\n              go to aa010-Acpt-Reply.\n     display  space at 0301 with erase eos.\n*>\n aa015-Recheck-for-Issues.\n*>\n*> Check code changed so that all warnings will be displayed if problems found\n*>  But first check for analysis reports as xl150 can be run from sales, purchase\n*>      or standalone and if not, will run sl130 and/or pl130 if not run.\n*>\n     move     zeros to WS-Term-Code.\n     if       S-Flag-A = 1             *> Sales    or\n          or  P-Flag-A = 1             *> Purchase Analysis not run.\n              display XL103   at 1401 with foreground-color 4\n              display XL108   at 1501 with foreground-color 2\n              if       S-Flag-A = 1\n                       move WS-Calling-Data to WS-Backup-Calling-Data\n                       move \"sl130\" to WS-Called\n                       move \"xl150\" to WS-Caller\n                       call WS-caller using  WS-calling-data\n                                             System-Record\n                                             to-day\n                                             file-defs\n              end-if\n              move     WS-Term-Code to Return-Code\n              if       P-Flag-A = 1\n                       move WS-Calling-Data to WS-Backup-Calling-Data\n                       move \"pl130\" to WS-Called\n                       move \"xl150\" to WS-Caller\n                       call WS-caller using  WS-calling-data\n                                             System-Record\n                                             to-day\n                                             file-defs\n              end-if\n              ADd      WS-Term-Code to Return-Code\n              move     Return-Code to WS-Term-Code *> JIC there is a later Test for it\n              if       Return-Code  > zero       *> had errors running pl130 or sl130\n                       display XL119    at 1601 with foreground-color 4\n                       display XL001    at 1701 with foreground-color 2\n                       ACcept  WS-Reply at 1732 with foreground-color 2\n                       go to aa990-Menu-Error\n              end-if\n              move WS-Backup-Calling-Data to WS-Calling-Data\n     end-if\n*>\n*> Now the Errors that the user MUST fix, e.g., by running uncompleted processes.\n*>\n     if       S-Flag-I = 1      *> Sales Ledger    - Unposted invoices exist\n        or    P-Flag-I = 1      *> Purchase Ledger - Unposted invoices exist\n              display XL101 at 1101 with foreground-color 4\n              move \"Y\" to WS-Found-Error\n     end-if\n     if      (S-Flag-P = 1 or 2)        *>  Sales   or\n         or  (P-Flag-P = 1 or 2)        *>  Purchase payments Proofed not posted.\n              display XL102 at 1201 with foreground-color 4\n              move \"Y\" to WS-Found-Error\n     end-if\n*>\n*> Check if errors found and ABort as I cannot know if amended invoices exist or any other\n*>   reason for a invoice reprint via sl930 and likewise for packing/picking notes sl950\n*>     Running is too risky so let user decide.\n*>\n      if      WS-Found-Error = \"Y\"\n              display XL001 at 1301 with foreground-color 2   *> was 1301\n              ACcept WS-Reply at 1331  with foreground-color 2 update\n              go to aa990-Menu-Error.\n*>\n aa020-Request-Ledgers.  *> automation by calling xl150 with arguments via BAsh command etc.\n     if       function lower-case (WS-CD-Args (1:5)) = \"xl150\"\n        if    (function lower-case (WS-CD-Args (6:1)) = \"s\"\n           or function lower-case (WS-CD-Args (7:1)) = \"s\")\n              move 1 to SL-EoC.    *> will run SL\n*>\n     if       function lower-case (WS-CD-Args (1:5)) = \"xl150\"\n        if    (function lower-case (WS-CD-Args (6:1)) = \"p\"\n           or function lower-case (WS-CD-Args (7:1)) = \"p\")\n              move 1 to PL-EoC.    *> Will run PL\n*>\n     if       function lower-case (WS-CD-Args (1:5)) = \"xl150\"\n        and   PL-EoC = zero\n        and   SL-EoC = zero\n              go to aa024-Test-EoC.\n     if       function lower-case (WS-CD-Args (1:5)) = \"xl150\"\n              go to aa025-OTM-Checks.\n*>\n     if       S-L\n              display \"Do you wish to run Sales Ledger? (Y/N) - [ ]\"   at 1801 with foreground-color 2\n              ACcept WS-Reply at 1843 with foreground-color 6 UPPER\n              if  WS-Reply = \"Y\"\n                  move 1 to SL-EoC.\n     if       B-L\n              display \"Do you wish to run Purchase Ledger? (Y/N) - [ ]\" at 1901 with foreground-color 2.\n              ACcept WS-Reply at 1946 with foreground-color 6 UPPER\n              if  WS-Reply = \"Y\"\n                  move 1 to PL-EoC.\n*>\n aa024-Test-EoC.\n     if       zero = SL-EoC and PL-EoC             *> if none selected",
        "line": 627
      },
      {
        "type": "IF",
        "condition": "FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-29     *> OTM5 (Purch)\n                                                 File-Info\n              if    return-code not = zero  and PL-EoC = 1   *> not = zero - No file found\n                    display XL106   at 0501 with foreground-color 4 erase eos\n                    move zero to PL-EoC.               *> As no transactions. Omit processing\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-19     *> OTM3 (Sales)\n                                                 File-Info\n              if    return-code not = zero and SL-EoC = 1    *> not = zero - No file found\n                    display XL107   at 0601 with foreground-color 4 erase eos\n                    move zero to SL-EoC.               *> As no transactions. Omit processing\n*>\n*> Final run check in case OTM3 or OTM5 not exist\n*>\n     if      zero = SL-EoC and PL-EoC             *> if none so quit.\n             display XL106   at 0501 with foreground-color 4 erase eos\n             display XL107   at 0601 with foreground-color 4\n             go to aa990-Menu-Error.\n*>\n aa030-Display-Heads.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"End of Cycle Processing\" at 0130  with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-Date at 0171 with foreground-color 2.\n     move     1  to File-Key-No.\n*>\n aa040-Display-End.\n     perform  BD00-Check-End-of-Cycle.\n     if       SL-EoC = 1\n              perform AB00-SL-Processing\n              move u-bin to S-End-Cycle-Date.\n     if       PL-EoC = 1\n              perform AC00-PL-Processing\n              move u-bin to BL-End-Cycle-Date.\n*>\n aa050-EOY-Processing.\n*>\n*> New period / quarter / year has been done so now to remove dead records\n*>  cleaning up indexes and empty space on Cobol files.\n*>\n*>  If using RDBMS tables",
        "line": 777
      },
      {
        "type": "IF",
        "condition": "not FS-Cobol-Files-Used    *> I.e., RDBMS\n              go to aa970-Menu-Exit.\n*>\n     if       New-Year not = 1           *> Only do at year end.\n              go to aa970-Menu-Exit.\n*>\n aa100-Phase-6.\n*>\n*> Get on with read / write to temp files and reload ISAM files.\n*>   First Sales ledger, OTM3 and invoice files.\n*>\n*> Tests for all open, read, write on prime and temp files.\n*>   Yes, a bit of over kill but JIC.\n*>\n     display  \"6A - Sales\" at 1207 with foreground-color 2.\n     perform  Sales-Open-Input.\n     if       FS-Reply not = zero\n              perform aa812-Error-on-Open-Sales\n              perform  Sales-Close\n              go to aa991-File-Error-Exit\n     end-if\n     open     output Temp-Sales-File.\n     if       FS-Reply not = zero\n              perform  aa813-Error-on-Open-Temp-Sales\n              close    Temp-Sales-File\n              perform  Sales-Close\n              go to aa991-File-Error-Exit\n     end-if\n*>\n     perform  until FS-Reply = 10\n              perform  Sales-Read-Next\n              if       FS-Reply = 10   *> extra protection\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform  aa801-Error-on-Read-Sales\n                       close    Temp-Sales-File\n                       perform  Sales-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              write    Temp-Sales-Record from WS-Sales-Record\n              if       FS-Reply not = zero\n                       perform aa802-Error-on-Write-Temp-Sales\n                       close    Temp-Sales-File\n                       perform  Sales-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Temp-Sales-File.\n     perform  Sales-Close.\n*>\n     display  \"B\"  at 1208 with foreground-color 2.\n     open     input Temp-Sales-File.\n     if       FS-Reply not = zero\n              perform  aa813-Error-on-Open-Temp-Sales\n              close Temp-Sales-File\n              go to aa991-File-Error-Exit\n     end-if\n     perform  Sales-Open-Output.\n     if       FS-Reply not = zero\n              perform aa812-Error-on-Open-Sales\n              close   Temp-Sales-File\n              perform Sales-Close\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              read Temp-Sales-File into WS-Sales-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa803-Error-on-Read-Temp-Sales\n                       close   Temp-Sales-File\n                       perform Sales-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  Sales-Write\n              if       FS-Reply not = zero\n                       perform aa804-Error-on-Write-Sales\n                       close   Temp-Sales-File\n                       perform Sales-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  Sales-Close.\n     close    Temp-Sales-File.\n     open     output Temp-Sales-File.     *> Clear the temp file. keep things tidy.\n     close    Temp-Sales-File.\n*>\n aa110-Phase-7.\n     display  \"7A\" at 1207 with foreground-color 2.\n     open     output Open-Item-File-S.\n     if       FS-Reply not = zero\n              perform aa815-Error-on-Open-Temp-OTM3\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  OTM3-Open-Input.\n     if       FS-Reply not = zero\n              perform aa814-Error-on-Open-OTM3\n              perform  OTM3-Close\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              perform  OTM3-Read-Next\n              if       FS-Reply = 10\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform aa800-Error-on-Read-OTM3\n                       perform  OTM3-Close\n                       close Open-Item-File-S\n                       go to aa991-File-Error-Exit\n              end-if\n              write  Open-Item-Record-S from WS-OTM3-Record\n              if       FS-Reply not = zero\n                       perform aa806-Error-on-Write-Temp-OTM3\n                       perform  OTM3-Close\n                       close Open-Item-File-S\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Open-Item-File-S.\n     perform  OTM3-Close.\n*>\n     open     input Open-Item-File-S.\n     if       FS-Reply not = zero\n              perform aa815-Error-on-Open-Temp-OTM3\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  OTM3-Open-Output.\n     if       FS-Reply not = zero\n              perform aa814-Error-on-Open-OTM3\n              close Open-Item-File-S\n              perform  OTM3-Close\n              go to aa991-File-Error-Exit\n     end-if\n     display  \"B\" at 1208 with foreground-color 2.\n     perform  until FS-Reply = 10\n              read Open-Item-File-S into WS-OTM3-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa807-Error-on-Read-Temp-OTM3\n                       close Open-Item-File-S\n                       perform  OTM3-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  OTM3-Write\n              if       FS-Reply not = zero\n                       perform aa805-Error-on-Write-OTM3\n                       close Open-Item-File-S\n                       perform  OTM3-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  OTM3-Close.\n     close    Open-Item-File-S.\n     open     output Open-Item-File-S.     *> Clear the temp OTM file.\n     close    Open-Item-File-S.\n*>\n aa120-Phase-8.\n     display  \"8A\" at 1207 with foreground-color 2.\n     perform  Invoice-Open-Input.    *> SALES\n     if       FS-Reply not = zero\n              perform aa816-Error-on-Open-SInvoices\n              perform  Invoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n     open     output  Temp-Invoice-File.\n     if       FS-Reply not = zero\n              perform aa817-Error-on-Open-Temp-SInvoices\n              close  Temp-Invoice-File\n              perform  Invoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n*>\n     perform  until FS-Reply = 10\n              perform  Invoice-Read-Next\n              if       FS-Reply = 10   *> extra protection\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform aa808-Error-on-Read-SInvoices\n                       close  Temp-Invoice-File\n                       perform  Invoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              write  Temp-Invoice-Record from WS-Invoice-Record\n              if       FS-Reply not = zero\n                       perform aa809-Error-on-Write-Temp-SInvoices\n                       close  Temp-Invoice-File\n                       perform  Invoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Temp-Invoice-File.\n     perform  Invoice-Close.\n*>\n     display  \"B\" at 1208 with foreground-color 2.\n     open     Input Temp-Invoice-File.\n     if       FS-Reply not = zero\n              perform aa817-Error-on-Open-Temp-SInvoices\n              close Temp-Invoice-File\n              go to aa991-File-Error-Exit\n     end-if\n     perform  Invoice-Open-Output.\n     if       FS-Reply not = zero\n              perform aa816-Error-on-Open-SInvoices\n              close Temp-Invoice-File\n              perform Invoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              read Temp-Invoice-File into WS-Invoice-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa810-Error-on-Read-Temp-SInvoices\n                       close Temp-Invoice-File\n                       perform Invoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  Invoice-Write\n              if       FS-Reply not = zero\n                       perform aa811-Error-on-Write-SInvoices\n                       close Temp-Invoice-File\n                       perform Invoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  Invoice-Close.\n     close    Temp-Invoice-File.\n     open     output Temp-Invoice-File.     *> Clear the temp invoice file. keep things tidy.\n     close    Temp-Invoice-File.\n*>\n*>  PL\n*>\n aa130-Phase-9.\n     display  \" 9A - Purchase\" at 1207 with foreground-color 2.\n*>\n*> Get on with read /write to temp files and reload ISAM files.\n*>   For Purchase Ledger, OTM5 and Pinvoice files.\n*>\n     perform  Purch-Open-Input.\n     if       FS-Reply not = zero\n              perform aa912-Error-on-Open-Purchase\n              perform  Purch-Close\n              go to aa991-File-Error-Exit\n     end-if\n     open     output Temp-Purchase-File.\n     if       FS-Reply not = zero\n              perform  aa913-Error-on-Open-Temp-Purchase\n              close    Temp-Purchase-File\n              perform  Purch-Close\n              go to aa991-File-Error-Exit\n     end-if\n*>\n     perform  until FS-Reply = 10\n              perform  Purch-Read-Next\n              if       FS-Reply = 10   *> extra protection\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform  aa901-Error-on-Read-Purchase\n                       close    Temp-Purchase-File\n                       perform  Purch-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              write    Temp-Purch-Record from WS-Purch-Record\n              if       FS-Reply not = zero\n                       perform aa902-Error-on-Write-Temp-Purchase\n                       close    Temp-Purchase-File\n                       perform  Purch-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Temp-Purchase-File.\n     perform  Purch-Close.\n*>\n     display  \"B\"  at 1209 with foreground-color 2.\n     open     input Temp-Purchase-File.\n     if       FS-Reply not = zero\n              perform  aa913-Error-on-Open-Temp-Purchase\n              close Temp-Purchase-File\n              go to aa991-File-Error-Exit\n     end-if\n     perform  Purch-Open-Output.\n     if       FS-Reply not = zero\n              perform aa912-Error-on-Open-Purchase\n              close   Temp-Purchase-File\n              perform Purch-Close\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              read Temp-Purchase-File into WS-Purch-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa903-Error-on-Read-Temp-Purchase\n                       close   Temp-Purchase-File\n                       perform Purch-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  Purch-Write\n              if       FS-Reply not = zero\n                       perform aa904-Error-on-Write-Purchase\n                       close   Temp-Purchase-File\n                       perform Purch-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  Purch-Close.\n     close    Temp-Purchase-File.\n     open     output Temp-Purchase-File.     *> Clear the temp file.\n     close    Temp-Purchase-File.\n*>\n aa140-Phase-10.\n     display  \"10A\" at 1207 with foreground-color 2.\n     open     output Open-Item-File-S.\n     if       FS-Reply not = zero\n              perform aa915-Error-on-Open-Temp-OTM5\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  OTM5-Open-Input.\n     if       FS-Reply not = zero\n              perform aa914-Error-on-Open-OTM5\n              perform  OTM5-Close\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              perform  OTM5-Read-Next\n              if       FS-Reply = 10\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform aa900-Error-on-Read-OTM5\n                       perform  OTM5-Close\n                       close Open-Item-File-S\n                       go to aa991-File-Error-Exit\n              end-if\n              write  Open-Item-Record-S from WS-OTM5-Record\n              if       FS-Reply not = zero\n                       perform aa906-Error-on-Write-Temp-OTM5\n                       perform  OTM5-Close\n                       close Open-Item-File-S\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Open-Item-File-S.\n     perform  OTM5-Close.\n*>\n     open     input Open-Item-File-S.\n     if       FS-Reply not = zero\n              perform aa915-Error-on-Open-Temp-OTM5\n              close Open-Item-File-S\n              go to aa991-File-Error-Exit\n     end-if\n     perform  OTM5-Open-Output.\n     if       FS-Reply not = zero\n              perform aa914-Error-on-Open-OTM5\n              close Open-Item-File-S\n              perform  OTM5-Close\n              go to aa991-File-Error-Exit\n     end-if\n     display  \"B\" at 1209 with foreground-color 2.\n     perform  until FS-Reply = 10\n              read Open-Item-File-S into WS-OTM5-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa907-Error-on-Read-Temp-OTM5\n                       close Open-Item-File-S\n                       perform  OTM5-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  OTM5-Write\n              if       FS-Reply not = zero\n                       perform aa905-Error-on-Write-OTM5\n                       close Open-Item-File-S\n                       perform  OTM5-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  OTM5-Close.\n     close    Open-Item-File-S.\n     open     output Open-Item-File-S.     *> Clear the temp OTM file.\n     close    Open-Item-File-S.\n*>\n aa150-Phase-11.\n     display  \"11A\" at 1207 with foreground-color 2.\n     perform  PInvoice-Open-Input.    *> PURCHASE\n     if       FS-Reply not = zero\n              perform aa916-Error-on-Open-PInvoices\n              perform  PInvoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n     open     output  Temp-Invoice-File.\n     if       FS-Reply not = zero\n              perform aa917-Error-on-Open-Temp-PInvoices\n              close  Temp-Invoice-File\n              perform  PInvoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n*>\n     perform  until FS-Reply = 10\n              perform  PInvoice-Read-Next\n              if       FS-Reply = 10   *> extra protection\n                       exit perform\n              end-if\n              if       FS-Reply not = zero\n                       perform aa908-Error-on-Read-PInvoices\n                       close  Temp-Invoice-File\n                       perform  PInvoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              write  Temp-Invoice-Record from WS-PInvoice-Record\n              if       FS-Reply not = zero\n                       perform aa909-Error-on-Write-Temp-PInvoices\n                       close  Temp-Invoice-File\n                       perform  PInvoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     close    Temp-Invoice-File.\n     perform  PInvoice-Close.\n*>\n     display  \"B\" at 1209 with foreground-color 2.\n     open     Input Temp-Invoice-File.\n     if       FS-Reply not = zero\n              perform aa917-Error-on-Open-Temp-PInvoices\n              close Temp-Invoice-File\n              go to aa991-File-Error-Exit\n     end-if\n     perform  PInvoice-Open-Output.\n     if       FS-Reply not = zero\n              perform aa916-Error-on-Open-PInvoices\n              close Temp-Invoice-File\n              perform PInvoice-Close\n              go to aa991-File-Error-Exit\n     end-if\n     perform  until FS-Reply = 10\n              read Temp-Invoice-File into WS-PInvoice-Record at end\n                   exit perform\n              end-read\n              if       FS-Reply not = zero\n                       perform aa910-Error-on-Read-Temp-PInvoices\n                       close Temp-Invoice-File\n                       perform PInvoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n              perform  PInvoice-Write\n              if       FS-Reply not = zero\n                       perform aa911-Error-on-Write-PInvoices\n                       close Temp-Invoice-File\n                       perform PInvoice-Close\n                       go to aa991-File-Error-Exit\n              end-if\n     end-perform\n     perform  PInvoice-Close.\n     close    Temp-Invoice-File.\n     open     output Temp-Invoice-File.     *> Clear the temp invoice file.\n     close    Temp-Invoice-File.\n*>\n     go       to aa970-Menu-Exit.           *> EOJ\n*>\n*> Error Routines used in aa-Main.\n*>\n*>   SL Error Routines.\n*>\n aa800-Error-on-Read-OTM3.\n     move     2 to WS-Operation.\n     move     802 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa801-Error-on-Read-Sales.\n     move     2 to WS-Operation.\n     move     801 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa802-Error-on-Write-Temp-Sales.\n     move     3 to WS-Operation.\n     move     804 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa803-Error-on-Read-Temp-Sales.\n     move     2 to WS-Operation.\n     move     804 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa804-Error-on-Write-Sales.\n     move     3 to WS-Operation.\n     move     801 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa805-Error-On-Write-OTM3.\n     move     3 to WS-Operation.\n     move     802 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa806-Error-on-Write-Temp-OTM3.\n     move     3 to WS-Operation.\n     move     805 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa807-Error-on-Read-Temp-OTM3.\n     move     2 to WS-Operation.\n     move     805 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa808-Error-on-Read-SInvoices.\n     move     2 to WS-Operation.\n     move     803 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa809-Error-on-Write-Temp-SInvoices.\n     move     3 to WS-Operation.\n     move     806 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa810-Error-on-Read-Temp-SInvoices.\n     move     2 to WS-Operation.\n     move     806 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa811-Error-on-Write-SInvoices.\n     move     3 to WS-Operation.\n     move     803 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa812-Error-on-Open-Sales.\n     move     1 to WS-Operation.\n     move     801 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa813-Error-on-Open-Temp-Sales.\n     move     1 to WS-Operation.\n     move     804 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa814-Error-on-Open-OTM3.\n     move     1 to WS-Operation.\n     move     802 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa815-Error-on-Open-Temp-OTM3.\n     move     1 to WS-Operation.\n     move     805 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa816-Error-on-Open-SInvoices.\n     move     1 to WS-Operation.\n     move     803 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa817-Error-on-Open-Temp-SInvoices.\n     move     1 to WS-Operation.\n     move     806 to Error-Code.\n     perform  aa950-Display-File-Error.\n*>\n*>  PL / BL Error Routines.\n*>\n aa900-Error-on-Read-OTM5.\n     move     2 to WS-Operation.\n     move     808 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa901-Error-on-Read-Purchase.\n     move     2 to WS-Operation.\n     move     807 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa902-Error-on-Write-Temp-Purchase.\n     move     3 to WS-Operation.\n     move     810 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa903-Error-on-Read-Temp-Purchase.\n     move     2 to WS-Operation.\n     move     810 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa904-Error-on-Write-Purchase.\n     move     3 to WS-Operation.\n     move     807 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa905-Error-On-Write-OTM5.\n     move     3 to WS-Operation.\n     move     808 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa906-Error-on-Write-Temp-OTM5.\n     move     3 to WS-Operation.\n     move     811 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa907-Error-on-Read-Temp-OTM5.\n     move     2 to WS-Operation.\n     move     811 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa908-Error-on-Read-PInvoices.\n     move     2 to WS-Operation.\n     move     809 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa909-Error-on-Write-Temp-PInvoices.\n     move     3 to WS-Operation.\n     move     812 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa910-Error-on-Read-Temp-PInvoices.\n     move     2 to WS-Operation.\n     move     812 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa911-Error-on-Write-PInvoices.\n     move     3 to WS-Operation.\n     move     809 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa912-Error-on-Open-Purchase.\n     move     1 to WS-Operation.\n     move     807 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa913-Error-on-Open-Temp-Purchase.\n     move     1 to WS-Operation.\n     move     810 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa914-Error-on-Open-OTM5.\n     move     1 to WS-Operation.\n     move     808 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa915-Error-on-Open-Temp-OTM5.\n     move     1 to WS-Operation.\n     move     811 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa916-Error-on-Open-PInvoices.\n     move     1 to WS-Operation.\n     move     809 to Error-Code.\n     perform  aa950-Display-File-Error.\n\n aa917-Error-on-Open-Temp-PInvoices.\n     move     1 to WS-Operation.\n     move     812 to Error-Code.\n     perform  aa950-Display-File-Error.\n*>\n aa950-Display-File-Error.\n*>\n*> Have WS-File-Name, WS-Operation and WS-Msg.\n*>\n     perform  AB995-Eval-Status.\n     move     WS-Operation  to XL118B.\n     move     WS-File-Name  to XL118C.\n     display  XL118 at line WS-23-Lines col  1 with foreground-color 4 erase eos.\n     display  XL001 at line WS-Lines    col  1 with foreground-color 4.\n     ACcept   WS-Reply at line WS-Lines col 31 with foreground-color 2.\n *>    go       to aa991-File-Error-Exit.\n*>\n aa970-Menu-Exit.\n*>\n*>  Really ?  This should already be set by sales and purchase\n*>       When OTM3 and OTM5 has data or been created for files in\n*>            sl060  and pl060. But as it only says run p/sl115 sort leave it.\n*>\n     if       SL-EoC = 1\n              move \"Y\" to oi-3-flag. *> sl060 sets S-Flag-I=2,S-Flag-A=1\n     if       PL-EoC = 1\n              move \"Y\" to oi-5-flag. *> pl060 sets P-Flag-I=2(invoice lines),P-Flag-A=1(Applied recs)\n*>\n aa980-Menu-Exit.\n     goback.\n*>\n aa990-Menu-Error.\n     move     2 to WS-term-code.\n     goback.\n *> was 14/01/18    go       to aa970-Menu-Exit.\n*>\n aa991-File-Error-Exit.\n     move     3 to WS-Term-Code.\n     goback.\n*>\n*>******************************************************\n*>                     Procedures                      *\n*>******************************************************\n*>\n*> Sections :\n*> AB00-SL-Processing\n*> AC00-PL-Processing\n*> AD00-kill-invoicep\n*> AE00-Kill-Invoices\n*> BA00-Value-Reset\n*> BD00-Check-End-of-Cycle\n*>\n AB00-SL-Processing           Section.\n*>==============================\n*>\n     display  \"Phase 1  - Sales\" at 1201 with foreground-color 2.\n     display  \"*******\" at 1301 with foreground-color 2.\n     display  \"Please wait.\" at 1501 with foreground-color 2.\n*>\n*> 1st. Read ledger recs & Update stats and move",
        "line": 823
      },
      {
        "type": "IF",
        "condition": "no activity\n*> 2nd. Invoices & OTM3 - if OTM3 inv. closed delete rec and Inv. recs\n*>\n*>\n\n\n*>     This is done quarterly? Monthly - could it only be yearly ?\n*>  Processing Sales Ledger file & @ EOC reload ledger from temp file\n*>   only will clear out deleted rec areas in index & file so temp\n*>    process not needed for RDB processing NOR ISAM Cobol files.\n*>\n*>  LATER Code now skipped as ISAM recs will be updated or deleted and\n*>   End of year the files will be clean up removing empty data areas on\n*>    the hard drive/s. For RDB users run the RDB clean up process instead.\n*>\n     display \"A\" at 1208 with foreground-color 2.\n     perform  Sales-Open.\n*>\n AB010-Phase-1-Read.    *> Sales-Ledger file/record\n     perform  Sales-Read-Next.\n     if       FS-Reply = 10\n              go to  AB020-Phase-1-End.\n*> Not live ?\n     if       Sales-Current = zero\n         and  Sales-Last    = zero\n         and  Sales-Unapplied = zero\n              move zero to  Sales-Status.  *> no activity so Set status to Dead\n*>\n     if       Sales-Current is negative\n              multiply -1 by Sales-Current\n              ADd Sales-Current to Sales-Unapplied\n              move zero to Sales-Current.\n*>\n     move     Sales-Current  to  Sales-Last.\n*>\n     if       new-quarter = 1\n              move  zero  to  STurnover-Q (Current-Quarter).\n*>\n     if       New-Year = 1\n              move zero to Sales-Average\n                           Sales-Activety.\n*>\n     perform  Sales-Rewrite.\n     if       FS-Reply not = zero\n              go to AB998-Error-On-Sales-Rewrite.\n     go to    AB010-Phase-1-Read.\n*>\n AB020-Phase-1-End.\n     perform  Sales-Close.\n*>\n*>  Now for OTM3 - Open Item & Sales invoices data\n*>\n     display  \"2A\" at 1207 with foreground-color 2.\n*>\n     perform  OTM3-Open.\n     perform  Invoice-Open.\n*>\n AB060-Phase-2-Read.\n     perform  OTM3-Read-Next.\n     if       FS-Reply = 10\n              go to  AB070-Phase-2-End.\n *>     move     WS-OTM3-Record to Soi-Header.    *> is redefines\n*>\n     if       ss-closed\n              perform AE00-Kill-Invoices    *> all for inv. no.\n              perform  OTM3-Delete       *> new 19/01/18\n              if       FS-Reply not = zero\n                       go to AB997-Error-on-OTM3-Delete\n              end-if\n              go to AB060-Phase-2-Read.\n*>\n     if       soi-type = 1        *> receipt (not wanted)\n *> NEW CODE 19/01/18\n              perform  OTM3-Delete\n              if       FS-Reply not = zero\n                       go to AB997-Error-on-OTM3-Delete\n              end-if\n              go to AB060-Phase-2-Read.\n*>\n     if       soi-type = 5 or 6   *> payment or Jnl unapplied cash\n              move zero to soi-deduct-amt.\n*>\n     move     \"Z\" to soi-applied.             *> UC 18/01/18\n     move     zero  to  soi-p-c.\n*>\n     perform  OTM3-Rewrite.\n     if       FS-Reply not = zero\n              go to AB996-Error-on-OTM3-Rewrite\n     end-if\n     go       to AB060-Phase-2-Read.\n*>\n AB070-Phase-2-End.\n     perform  OTM3-Close.\n     perform  Invoice-Close.\n*>\n AB100-Phase-3-Begin.\n*>\n*> Here we remove dead records\n*>\n     display  \"3 \" at 1207 with foreground-color 2.\n     move     \"S\" to WS-Value-System.   *> see Test in Phase-3\n     perform  BA00-Value-Reset.\n     display  \"4A\" at 1207 with foreground-color 2.\n*>\n     subtract pf-retention from u-bin giving pf-Test.\n     subtract 92           from u-bin giving inv-Test.\n*>\n     perform  Invoice-Open.             *> open     input  sinvoice-file.\n *>**    open     output temp-invoice-file.\n*>\n AB110-Phase-4-Read.    *> Sales invoice file/record\n     perform  Invoice-Read-Next.        *> read   sinvoice-file next record at end\n     if       FS-Reply = 10\n              go to AB140-Phase-4-End.\n     move     SInvoice-Record to SInvoice-Header.\n*>\n     if       sih-Test not = zero              *> Keep it.\n              go to AB110-Phase-4-Read.      *>   go to AB120-Copy-Record-Out.\n*>\n     if       not sapplied                     *> Keep it.\n              go to AB110-Phase-4-Read.     *> go to AB120-Copy-Record-Out.\n*>\n     if       sih-type = 4 and              *> Kill out of date Proformas\n              pf-Test > sih-Date           *> perform AB130-Skip-Reader sih-lines times\n       if     FS-Cobol-Files-Used                     *>    go to AB120-Copy-Record-Out.\n              perform  varying  Sitem-Nos from zero by 1\n                        until   Sitem-Nos > Sih-Lines\n                       perform  Invoice-Delete\n              end-perform\n       else\n              perform  Invoice-Delete-All               *> delete all recs for inv\n       end-if\n       go to AB110-Phase-4-Read.\n*>\n     if       sih-type < 4\n              move \"B\" to sih-day-book-flag.\n*>\n     if       sih-lines not = zero and\n              sih-type = 2                  *> ACcount\n                                   *> perform AB130-Skip-Reader sih-lines times\n              perform  varying  Sitem-Nos from 1 by 1  *> do item-lines only\n                         until   Sitem-Nos > Sih-Lines\n                       perform  Invoice-Delete\n              end-perform\n              move zero to sih-lines\n              move SInvoice-Header to SInvoice-Record\n              perform  Invoice-Rewrite.       *> go to AB120-Copy-Record-Out.\n              go to AB110-Phase-4-Read.\n*>\n     if       sih-type = 1 or 3             *> Receipt or Cr. Note\n                                       *> perform AB130-Skip-Reader sih-lines times\n       if     FS-Cobol-Files-Used                     *>    go to AB120-Copy-Record-Out.\n              perform  varying  Sitem-Nos from zero by 1\n                        until   Sitem-Nos > Sih-Lines\n                       perform  Invoice-Delete\n              end-perform\n       else\n              perform  Invoice-Delete-All               *> delete all recs for inv\n       end-if\n       go to AB110-Phase-4-Read.\n*> ??\n *>    if       SL-own-nos not = \"Y\"\n *>             go to AB120-Copy-Record-Out.\n*>\n*> at this point if ih-type = 2",
        "line": 1533
      },
      {
        "type": "IF",
        "condition": "sih-type = 2                  *> ACcount\n        and   inv-Test > sih-Date\n              perform Invoice-Delete\n              go to AB110-Phase-4-Read.\n*>\n*> No longer used as file now ISAM\n*>\n *> AB120-Copy-Record-Out.\n *>    move     SInvoice-Header to SInvoice-Record.\n *>    perform  Invoice-Rewrite.      *>  write    temp-invoice-record from SInvoice-Header.\n *>    go       to AB110-Phase-4-Read.\n*>\n *> AB130-Skip-Reader.\n *>    perform     *>  perform  Invoice-Read-Next.            *> read     sinvoice-file next record at end\n *>    if       FS-Reply = 10\n *>             go to AB140-Phase-4-End.\n*>\n AB140-Phase-4-End.\n    *>   close    temp-invoice-file.            *> sinvoice-file\n     perform  Invoice-Close.\n*>\n AB170-Phase-6-Sys4-Reset.\n*>\n*>  Sales now finished.\n*>\n     display  \"5 \" at 1207 with foreground-color 2.\n     move     SL-os-bal-This-month to SL-os-bal-Last-month.\n     move     zeros to SL-os-bal-This-month       SL-variance\n                       SL-invoices-This-month     SL-payments\n                       SL-credit-deductions       SL-cn-unappl-This-month\n                       SL-credit-notes-This-month.\n     go       to AB999-main-exit.\n *>\n AB995-Eval-Status.\n  copy \"FileStat-Msgs.cpy\" replacing STATUS by FS-Reply\n                                     MSG by WS-Msg.\n     if       Error-Code not zero\n              evaluate  Error-Code\n                when 801  move \"Sales\"         to WS-File-Name\n                when 802  move \"OTM3\"          to WS-File-Name\n                when 803  move \"SInvoice\"      to WS-File-Name\n                when 804  move \"Temp Sales\"    to WS-File-Name\n                when 805  move \"Temp OTM3\"     to WS-File-Name\n                when 806  move \"Temp SInvoice\" to WS-File-Name\n                when 807  move \"Purchase\"      to WS-File-Name\n                when 808  move \"OTM5\"          to WS-File-Name\n                when 809  move \"PInvoice\"      to WS-File-Name\n                when 810  move \"Temp Purchase\" to WS-File-Name\n                when 811  move \"Temp OTM5\"     to WS-File-Name\n                when 812  move \"Temp PInvoice\" to WS-File-Name\n                when other\n                          move \"Error in AB995\" to WS-File-Name\n              end-evaluate\n     end-if\n     if       WS-Error-Op not = zero\n              evaluate WS-Error-Op\n                when 1    move \"Open \"   to WS-Operation\n                when 2    move \"Read \"   to WS-Operation\n                when 3    move \"Write\"   to WS-Operation\n                when 4    move \"Rewrite\" to WS-Operation\n                when 5    move \"Delete\"  to WS-Operation\n                when other\n                          move \"ab995bug\" to WS-Operation\n              end-evaluate\n     end-if.\n*>\n AB996-Error-on-OTM3-Rewrite.\n     move     4   to WS-Operation.\n     move     802 to Error-Code.\n     perform  aa950-Display-File-Error.\n     perform  OTM3-Close.\n     perform  Invoice-Close.\n     go       to aa990-Menu-Error.\n *>\n AB997-Error-on-OTM3-Delete.\n     move     5   to WS-Operation.\n     move     802 to Error-Code.\n     perform  aa950-Display-File-Error.\n     perform  OTM3-Close.\n     perform  Invoice-Close.\n     go       to aa990-Menu-Error.\n*>\n AB998-Error-On-Sales-Rewrite.\n     move     4   to WS-Operation.\n     move     801 to Error-Code.\n     perform  aa950-Display-File-Error.\n     perform  Sales-Close.\n     go       to aa990-Menu-Error.\n*>\n AB999-main-exit.\n     exit     Section.\n*>\n AE00-Kill-Invoices Section.     *> In Sales invoice file/table.\n*>=========================\n*>\n*> WE have the OTM3 record at this point.\n*>\n*> Orig code read record before deleting - now just delete them.\n*> NOTE: For RDB we can delete in one perform.\n*>\n     if       soi-type not = 2     *>   ACcount - Only kill these\n              go to AE999-Kill-Exit.\n*>\n     move     soi-invoice to Sinvoice-Nos.  *> set for header from OTM3-rec\n     move     zeros       to Sitem-Nos.\n*>\n     perform  Invoice-Read-Indexed.           *> read     sinvoice-file invalid key\n     if       FS-Reply not = zero\n              go to AE010-Test-for-Subs.\n     move     SInvoice-Record to SInvoice-Header.  *> Copy to WS area.\n*>  Delete header\n     if       FS-Cobol-Files-Used\n              perform  Invoice-Delete                *> delete   sinvoice-file invalid key\n     else\n              perform  Invoice-Delete-All             *> delete all recs for inv\n              go to AE999-Kill-Exit\n     end-if\n*>\n*>  From here we only deal with Cobol file.\n*>\n     if       sih-lines = zero              *> no, none present\n              go to AE999-Kill-Exit.\n     perform  AE020-Actual-Delete sih-lines times.\n     go       to AE999-Kill-Exit.\n*>\n AE010-Test-for-Subs.                      *> used if header missing.\n     ADd      1 to Sitem-Nos.\n     perform  Invoice-Read-Indexed.            *> read     sinvoice-file invalid key\n     if       FS-Reply = 21\n              go to AE999-Kill-Exit.\n     if       sinvoice-nos not = soi-invoice\n              go to AE999-Kill-Exit.\n     perform  Invoice-Delete.               *> delete   sinvoice-file invalid key\n     if       FS-Reply = 21\n              go to AE999-Kill-Exit.\n     go       to AE010-Test-for-Subs.\n*>\n AE020-Actual-Delete.\n     Add      1 to Sitem-Nos.\n     perform  Invoice-Delete.                  *> delete   sinvoice-file line recs.\n*>\n AE999-Kill-Exit.\n     exit     Section.\n*>\n AC00-PL-Processing Section.\n*>*************************\n*>\n     display  \"Phase 1  - Purchase\" at 1201 with foreground-color 2.\n     display  \"*******\"             at 1301 with foreground-color 2.\n     display  \"Please Wait\"         at 1501 with foreground-color 2 blink.\n*>\n *>    if       new-quarter = 1\n *>             open output Temp-Purchase-File\n *>             open input  Purchase-file\n              display \"A\" at 1208 with foreground-color 2\n *>      else\n     perform  Purch-Open.        *>  open i-o  Purchase-file.\n*>\n AC010-Phase-1-Read.    *> Purch-Ledger files/record\n     perform  Purch-Read-Next.     *> read     Purchase-file  next record  at end\n     if       FS-Reply = 10\n              go to  AC020-Phase-1-End.\n*>\n     if       Purch-Current = zero\n         and  Purch-Last    = zero\n         and  Purch-Unapplied = zero\n              move  zero  to  Purch-Status.\n*>\n     if       Purch-Current is negative\n              multiply -1 by Purch-Current\n              ADd Purch-Current to Purch-Unapplied\n              move zero to Purch-Current.\n*>\n     move     Purch-Current  to  Purch-Last.\n*>\n     if       new-quarter = 1\n              move  zero  to  PTurnover-Q (Current-Quarter).\n*>\n     if       New-Year = 1\n              move zero to Purch-Average\n                           Purch-Activety.\n*>\n     perform  Purch-Rewrite.           *> rewrite  Purch-record.\n     if       FS-Reply not = zero\n              go to AC998-Error-On-Purch-Rewrite.\n     go       to    AC010-Phase-1-Read.\n*>\n AC020-Phase-1-End.\n     perform  Purch-Close.           *> close    Purchase-file.\n*>\n*> Now for OTM5 - Open Item & Purchase invoices data\n*>\n     display  \"2A\" at 1207 with foreground-color 2.\n*>\n     perform  OTM5-Open.    *>  Its I-O    *> open     input  WS-OTM5-Record.\n     perform  Purch-Open.                  *> open     i-o pinvoice-file.\n*>\n AC060-Phase-2-Read.\n     perform  OTM5-Read-Next.    *> read     WS-OTM5-Record next record into poi-header at end\n     if       FS-Reply = 10\n              go to  AC070-Phase-2-End.\n*>\n*>  Data area is now a redefine. (poi-abc, etc)\n*>\n     if       ps-closed\n              perform AD00-kill-invoicep     *> All for inv. no#\n              perform  OTM5-Delete       *> new 19/01/18\n              if       FS-Reply not = zero\n                       go to AC997-Error-on-OTM5-Delete\n              end-if\n              go to AC060-Phase-2-Read.\n     if       poi-type = 1             *> receipt (not wanted)\n*> new code 26/01/18\n              perform  OTM5-Delete\n              if       FS-Reply not = zero\n                       go to AC997-Error-on-OTM5-Delete\n              end-if\n              go to AC060-Phase-2-Read.\n     if       poi-type = 5 or 6        *> payment or Jnl unapplied cash\n              move zero to poi-deduct-amt.\n*>\n     move     \"Z\" to poi-applied.\n     move     zero  to  poi-p-c.\n*>\n     perform  OTM5-Rewrite.\n     if       FS-Reply not = zero\n              go to AC996-Error-on-OTM5-Rewrite\n     end-if\n     go       to AC060-Phase-2-Read.\n*>\n AC070-Phase-2-End.\n     perform  OTM5-Close.    *> close    WS-OTM5-Record open-item-file-s pinvoice-file.\n     perform  Pinvoice-Close.\n     display  \"2B\" at 1207 with foreground-color 2.\n*>\n     display  \"3 \" at 1207 with foreground-color 2.\n     move     \"P\" to WS-Value-System.   *> see Test in Phase-3\n     perform  BA00-Value-Reset.         *> new 17/01/18.\n     display  \"4A\" at 1207 with foreground-color 2.\n*>\n     perform  Pinvoice-Open.         *> open     input  pinvoice-file.\n *>**    open     output temp-invoice-file.\n*>\n AC110-Phase-4-Read.    *> Purchase invoices file/record\n     perform  Pinvoice-Read-Next.     *> read  pinvoice-file next record at end\n     if       FS-Reply = 10\n              go to  AC140-Phase-4-End.\n     move     WS-PInvoice-Record to PInvoice-Header.\n*>\n     if       pih-Test not = zero         *> Keep it\n              go to  AC110-Phase-4-Read.    *> go to AC120-Copy-Record-Out.\n*>\n     if       not papplied                *> Keep it.\n              go to  AC110-Phase-4-Read.    *> go to AC120-Copy-Record-Out.\n*>\n     if       pih-type = 1 or 3             *> Receipt or Cr. Note\n                             *>  perform AC130-Skip-Reader pih-lines times\n       if     FS-Cobol-Files-Used                     *>    go to AC120-Copy-Record-Out.\n              perform  varying  Pitem-Nos from zero by 1\n                        until   Pitem-Nos > Pih-Lines\n                       perform  PInvoice-Delete\n              end-perform\n       else\n              perform  PInvoice-Delete-All               *> delete all recs for inv\n       end-if\n       go to AC110-Phase-4-Read.\n*>\n     if       pih-type < 4\n              move \"B\" to pih-day-book-flag.\n*>\n*> Kill body lines (& count) keeping header\n*>\n     if       pih-lines not = zero and\n              pih-type = 2\n                          *> perform AC130-Skip-Reader pih-lines times\n              perform  varying  Pitem-Nos from 1 by 1  *> do item-lines only\n                         until   Pitem-Nos > Pih-Lines\n                       perform  PInvoice-Delete\n              end-perform\n              move zero to pih-lines.\n*>\n*> at this point if PIH-type = 2",
        "line": 1699
      },
      {
        "type": "IF",
        "condition": "poi-type not = 2     *>   ACcount - Only kill these\n              go to AD999-Kill-Exit.\n*>\n     move     poi-invoice to Pinvoice-Nos.\n     move     zeros       to Pitem-Nos.\n*>\n     perform  PInvoice-Read-Indexed.      *> read     pinvoice-file invalid key\n     if       FS-Reply not = zero\n              go to AD010-Test-for-Subs.\n     move     WS-PInvoice-Record to PInvoice-Header.  *> Copy to WS area.\n*>  Delete header\n     if       FS-Cobol-Files-Used\n              perform  PInvoice-Delete            *> delete pinvoice-file invalid key\n     else\n              perform  PInvoice-Delete-All             *> delete all recs for inv\n              go to AD999-Kill-Exit\n     end-if\n*>\n*>  From here we only deal with Cobol file.\n*>\n     if       pih-lines = zero\n              go to AD999-Kill-Exit.\n     perform  AD020-Actual-Delete pih-lines times.\n     go       to AD999-Kill-Exit.\n*>\n AD010-Test-for-Subs.\n     ADd      1 to Pitem-Nos.\n     perform  PInvoice-Read-Indexed.    *> read     pinvoice-file invalid key\n     if       FS-Reply = 21\n              go to AD999-Kill-Exit.\n     if       Pinvoice-Nos not = poi-invoice\n              go to AD999-Kill-Exit.\n     perform  PInvoice-Delete.          *> delete   pinvoice-file invalid key\n     if       FS-Reply = 21\n              go to AD999-Kill-Exit.\n     go       to AD010-Test-for-Subs.\n*>\n AD020-Actual-Delete.\n     ADd      1 to Pitem-Nos.\n     perform  PInvoice-Delete.       *> delete   pinvoice-file.\n*>\n AD999-Kill-Exit.\n     exit     Section.\n*>\n BD00-Check-End-of-Cycle      Section.\n*>===================================\n*>\n     ADd      1  to  cyclea.\n     if       period = 3\n              perform  BD010-Monthly-Check\n     else\n      if      period = 13\n              perform  BD020-Weekly-Check\n       else\n              perform  BD030-Query-Check.\n*>\n     go       to BD999-main-exit.\n*>\n BD010-Monthly-Check.\n     if       cyclea = 4  or  7  or 10\n              ADd   1  to  Current-Quarter\n              move  1  to  new-quarter\n     else\n      if      cyclea = 13\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter.\n*>\n BD020-Weekly-Check.\n     if       cyclea = 14  or  27  or  40\n              ADd   1  to  Current-Quarter\n              move  1  to  new-quarter\n     else\n      if      cyclea = 53\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter.\n*>\n BD030-Query-Check.\n*>\n*> First Tests if in autorun using Args (8:1) = \"y\" or \"n\"\n*>\n     if       function lower-case (WS-CD-Args (1:5)) = \"xl150\"\n       if     function lower-case (WS-CD-Args (8:1)) = \"y\"\n              move \"Y\" to WS-Reply\n       else\n        if    function lower-case (WS-CD-Args (8:1)) = \"n\"\n              move \"N\" to WS-Reply\n        end-if\n       end-if\n       go     to BD032-Skip-Question\n     end-if\n\n     display  \"Is this the end of a quarter (Y/N) - [ ]\" at 1601 with foreground-color 2.\n     ACcept   WS-Reply at 1639 with foreground-color 6.\n     move     function upper-case (WS-Reply) to WS-Reply.\n*>\n BD032-Skip-Question.\n     if       WS-Reply = \"N\"\n              go to  BD999-Main-Exit.\n*>\n     if       WS-Reply not = \"Y\"\n              go to  BD030-Query-Check.\n*>\n     if       Current-Quarter not = 4\n              ADd   1  to  Current-Quarter\n              move  1  to  new-quarter\n       else\n              move 1 to cyclea\n                        Current-Quarter\n                        New-Year\n                        new-quarter.\n*>\n BD999-main-exit.\n     exit     Section.\n*>\n BA00-Value-Reset       Section.\n*>*****************************\n*>\n*>  Reset the values in the Value file/table.\n*>   performed for both Sales and Purchase data at END OF YEAR.\n*>\n*> Input-Flags.     WS-Value-System = \"S\" or \"P\"\n*> Output.          Updated or deleted Value records.\n*> Error-Cond.      Can exit or goto aa990-Menu-Error with WS-Term-Code = 2\n*>",
        "line": 2037
      },
      {
        "type": "IF",
        "condition": "New-Year = 1                  *> clear down all data\n        and   WS-Value-ClearDown = \"N\"\n              perform Value-Open-Output                           *> open output value-file\n              move    zero to WS-Count-Rows\n              if      FS-RDBMS-Used              *> Extra step for RDB processing\n                      perform  Value-Delete-All\n                      move zero to File-Function\n              end-if\n              display XL116  at 1401 with foreground-color 2 underline\n              if      FS-RDBMS-Used\n                      move WS-Count-Rows  to Z9\n                      display \" Delete count = \" at 1437 with foreground-color 4\n                      Display Z9                 at 1453 with foreground-color 4\n              end-if\n              move    \"Y\" to WS-Value-ClearDown\n              go to BA020-End\n     end-if\n     if       New-Year = 1                  *> clear down all data\n        and   WS-Value-ClearDown = \"Y\"\n              go to BA020-End\n     end-if\n*>\n     perform  Value-Open.               *> open     i-o  value-file.\n*>\n BA010-Read.        *> Not New Year.\n     perform  Value-Read-Next.                  *> read value-file  next record   at end\n     if       FS-Reply = 10\n              go to  BA020-End.\n*>\n     if       VA-System not = WS-Value-System         *> = \"S\" here!\n              go to BA010-Read.\n*>\n     move     VA-T-This  to  VA-T-Last.\n     move     zero       to  VA-T-This.\n     move     VA-V-This  to  VA-V-Last.\n     move     zero       to  VA-V-This.\n*>\n     perform  Value-ReWrite.                   *> rewrite  value-record.\n     if       FS-Reply not = zero\n              display XL105  at line WS-22-Lines col 1 with foreground-color 4 highlight erase eos\n              display XL117  at line WS-22-Lines col 35\n                                                       with foreground-color 4 highlight\n              display XL001           at line WS-23-Lines col 01 with foreground-color 4 highlight\n              ACcept  WS-Reply        at line WS-23-Lines col 32\n              perform Value-Close\n              go to aa990-Menu-Error\n     end-if\n     go       BA010-Read.\n*>\n BA020-End.\n     perform  Value-Close.               *> close    value-file.\n*>\n BA00-Exit.\n     exit     section.\n*>\n zz070-Convert-Date     Section.\n*>*****************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-Date as uk/US/Inlt date format\n*>\n     move     to-day to WS-Date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-Date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.\n     exit     Section.\n*>\n copy \"Proc-Get-Env-Set-Files.cob\".  *> Only uses ACAS_LEDGERS now\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 2167
      }
    ],
    "evaluates": [
      {
        "content": "Error-Code\n                when 801  move \"Sales\"         to WS-File-Name\n                when 802  ...",
        "line": 1736,
        "whenCount": 13
      },
      {
        "content": "WS-Error-Op\n                when 1    move \"Open \"   to WS-Operation\n                when 2    move ...",
        "line": 1754,
        "whenCount": 6
      }
    ],
    "validations": []
  },
  "complexity": {
    "mccabe": 33,
    "cognitive": 48,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 108,
      "totalOperators": 160,
      "totalOperands": 320,
      "vocabulary": 109,
      "length": 480,
      "volume": 3248.7284758929245
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
