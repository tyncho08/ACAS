{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl085.cbl",
  "fileName": "pl085.cbl",
  "timestamp": "2025-09-15T16:25:46.981Z",
  "programId": "pl085",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 93
      },
      {
        "name": "file",
        "line": 104
      },
      {
        "name": "working-storage",
        "line": 110
      },
      {
        "name": "linkage",
        "line": 247
      },
      {
        "name": "init01",
        "line": 262
      },
      {
        "name": "new-payment",
        "line": 302
      },
      {
        "name": "payment-appropriate",
        "line": 488
      },
      {
        "name": "erase-screen",
        "line": 572
      },
      {
        "name": "zz050-Validate-Date",
        "line": 580
      },
      {
        "name": "exit",
        "line": 613
      },
      {
        "name": "zz060-Convert-Date",
        "line": 615
      },
      {
        "name": "exit",
        "line": 648
      },
      {
        "name": "zz070-Convert-Date",
        "line": 650
      },
      {
        "name": "exit",
        "line": 678
      },
      {
        "name": "maps04",
        "line": 680
      },
      {
        "name": "exit",
        "line": 686
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 96
      },
      {
        "name": "file-defs",
        "line": 259
      },
      {
        "name": "display-heads",
        "line": 272
      },
      {
        "name": "dh-exit",
        "line": 280
      },
      {
        "name": "menu-exit",
        "line": 289
      },
      {
        "name": "main-exit",
        "line": 295
      },
      {
        "name": "goback",
        "line": 296
      },
      {
        "name": "New-Payment-Main",
        "line": 305
      },
      {
        "name": "main-display-end",
        "line": 315
      },
      {
        "name": "get-batch",
        "line": 321
      },
      {
        "name": "customer-input",
        "line": 330
      },
      {
        "name": "find-trans-loop",
        "line": 348
      },
      {
        "name": "value-input",
        "line": 408
      },
      {
        "name": "value-input-req",
        "line": 420
      },
      {
        "name": "value-input-2",
        "line": 429
      },
      {
        "name": "data-input",
        "line": 441
      },
      {
        "name": "skip-pay-approp",
        "line": 446
      },
      {
        "name": "more-data",
        "line": 455
      },
      {
        "name": "accept-money",
        "line": 467
      },
      {
        "name": "accept-money2",
        "line": 476
      },
      {
        "name": "pay-loop",
        "line": 497
      },
      {
        "name": "get-deduct",
        "line": 526
      },
      {
        "name": "by-pass-deduct",
        "line": 547
      },
      {
        "name": "main-end",
        "line": 557
      },
      {
        "name": "zz050-test-date",
        "line": 607
      },
      {
        "name": "zz050-exit",
        "line": 612
      },
      {
        "name": "zz060-Exit",
        "line": 647
      },
      {
        "name": "zz070-Exit",
        "line": 677
      },
      {
        "name": "maps04-exit",
        "line": 685
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 683,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 83,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 92,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 99,
        "replacing": null
      },
      {
        "name": "seloi5",
        "line": 100,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 107,
        "replacing": null
      },
      {
        "name": "fdoi5",
        "line": 108,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 113,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 114,
        "replacing": null
      },
      {
        "name": "wsoi",
        "line": 146,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 147,
        "replacing": null
      },
      {
        "name": "plwsoi5C",
        "line": 148,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 245,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 250,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 251,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 252,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 688,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 277
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 283
      },
      {
        "target": "OTM5-Open",
        "thru": null,
        "line": 284
      },
      {
        "target": "new-payment",
        "thru": null,
        "line": 285
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 286
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 287
      },
      {
        "target": "display-heads",
        "thru": null,
        "line": 293
      },
      {
        "target": "display-heads",
        "thru": null,
        "line": 307
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 318
      },
      {
        "target": "OTM5-Start",
        "thru": null,
        "line": 346
      },
      {
        "target": "OTM5-Read-Next",
        "thru": null,
        "line": 351
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 378
      },
      {
        "target": "accept-money2",
        "thru": null,
        "line": 413
      },
      {
        "target": "OTM5-Delete",
        "thru": null,
        "line": 435
      },
      {
        "target": "payment-appropriate",
        "thru": null,
        "line": 444
      },
      {
        "target": "Purch-Rewrite",
        "thru": null,
        "line": 450
      },
      {
        "target": "erase-screen",
        "thru": null,
        "line": 452
      },
      {
        "target": "OTM5-Start",
        "thru": null,
        "line": 495
      },
      {
        "target": "OTM5-Read-Next",
        "thru": null,
        "line": 500
      },
      {
        "target": "accept-money",
        "thru": null,
        "line": 536
      },
      {
        "target": "OTM5-Rewrite",
        "thru": null,
        "line": 550
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 610
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 624
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "k",
        "line": 282
      },
      {
        "from": "\"Y\"",
        "to": "oi-5-flag",
        "line": 292
      },
      {
        "from": "4",
        "to": "lin",
        "line": 306
      },
      {
        "from": "spaces",
        "to": "oi5-supplier",
        "line": 323
      },
      {
        "from": "zero",
        "to": "display-n",
        "line": 333
      },
      {
        "from": "oi5-key",
        "to": "save-key",
        "line": 344
      },
      {
        "from": "open-item-record-5",
        "to": "oi-header",
        "line": 354
      },
      {
        "from": "oi-type",
        "to": "transaction-type",
        "line": 368
      },
      {
        "from": "oi-supplier",
        "to": "pay-customer",
        "line": 370
      },
      {
        "from": "oi-date",
        "to": "pay-date",
        "line": 371
      },
      {
        "from": "oi-paid",
        "to": "pay-value hold-pay",
        "line": 372
      },
      {
        "from": "oi-approp",
        "to": "approp-amount",
        "line": 373
      },
      {
        "from": "pay-customer",
        "to": "WS-Purch-Key",
        "line": 376
      },
      {
        "from": "zero",
        "to": "c-check",
        "line": 380
      },
      {
        "from": "purch-address",
        "to": "address1",
        "line": 382
      },
      {
        "from": "1",
        "to": "a",
        "line": 386
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 390
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 394
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 398
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 402
      },
      {
        "from": "purch-current",
        "to": "display-s",
        "line": 404
      },
      {
        "from": "pay-value",
        "to": "amt-ok",
        "line": 411
      },
      {
        "from": "0749",
        "to": "curs",
        "line": 412
      },
      {
        "from": "amt-ok",
        "to": "pay-value",
        "line": 414
      },
      {
        "from": "oi-deduct-amt",
        "to": "si-deduct-amt",
        "line": 439
      },
      {
        "from": "14",
        "to": "lin",
        "line": 451
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 457
      },
      {
        "from": "zero",
        "to": "ws-poundsd2 amt-ok2 ws-penced2",
        "line": 470
      },
      {
        "from": "ws-pound2",
        "to": "amt-wk-pds2",
        "line": 473
      },
      {
        "from": "ws-pence2",
        "to": "amt-wk-pence2",
        "line": 474
      },
      {
        "from": "amt-wk-pence",
        "to": "ws-pence",
        "line": 479
      },
      {
        "from": "amt-wk-pds",
        "to": "ws-pound",
        "line": 480
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 483
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 484
      },
      {
        "from": "zero",
        "to": "save-invoice",
        "line": 492
      },
      {
        "from": "save-key",
        "to": "oi5-key",
        "line": 493
      },
      {
        "from": "open-item-record-5",
        "to": "oi-header",
        "line": 504
      },
      {
        "from": "zero",
        "to": "oi-b-nos oi-b-item oi-cr oi-status",
        "line": 520
      },
      {
        "from": "si-deduct-amt",
        "to": "si-display",
        "line": 529
      },
      {
        "from": "1224",
        "to": "curs",
        "line": 535
      },
      {
        "from": "amt-ok2",
        "to": "oi-deduct-amt",
        "line": 537
      },
      {
        "from": "approp-amount",
        "to": "display-8\n              move si-deduct-amt to display-s\n              display display-8 at 1304 with foreground-color 3\n              display display-s at 1317 with foreground-color 3\n              display PL003     at 1401 with foreground-color 2\n              accept ws-reply at 1430 with foreground-color 2",
        "line": 562
      },
      {
        "from": "1",
        "to": "cole",
        "line": 575
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 589
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 591
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 595
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 602
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 608
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 609
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 626
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 628
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 631
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 635
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 642
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 658
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 661
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 665
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 672
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selpl.cob\".\n*> copy \"seloi5.cob\".\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpl.cob\".\n*> copy \"fdoi5.cob\".\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(15) value \"PL085 (3.02.05)\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(7).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(7).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic 9(7).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic 9(7)v99.\n*>\n 01  ws-amount-screen-display2.\n     03  ws-poundsd2     pic 999.\n     03  ws-period2      pic x     value \".\".\n     03  ws-penced2      pic v99.\n 01  ws-amount-screen-accept2 redefines ws-amount-screen-display2.\n     03  ws-pound2       pic 999.\n     03  filler          pic x.\n     03  ws-pence2       pic v99.\n*>\n 01  ws-amount-work2.\n     03  amt-wk-pds2     pic 999.\n     03  amt-wk-pence2   pic v99.\n 01  ws-amount-ok2 redefines ws-amount-work2.\n     03  amt-ok2         pic 999v99.\n*>\n*> copy \"wsoi.cob\".\n copy \"wspl.cob\".\n copy \"plwsoi5C.cob\".  *> ITM5-rec redefs oi-header o-t-m-rec.\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n*>     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  a               pic 99                   value zero.\n     03  c-check         pic 9                    value zero.\n         88  c-exists                             value 1.\n     03  work-1          pic s9(6)v99.\n     03  display-8       pic -(5)9.99.\n     03  display-s       pic z(5)9.99cr.\n     03  display-n       pic 9(5).\n     03  display-inv     pic z(7)9.\n     03  si-deduct-amt   pic s999v99     comp     value zero.\n     03  si-display      pic -zz9.99.\n     03  k               pic 999                  value zero.\n     03  approp-amount   pic s9(6)v99    comp-3   value zero.\n     03  pay-customer    pic x(7).\n     03  pay-date        binary-long.\n     03  pay-value       pic s9(6)v99    comp-3   value zero.\n     03  address1        pic x(96).\n     03  address-line    pic x(36).\n     03  transaction-type pic 9                   value zero.\n         88  trans-payment                        value 5.\n         88  trans-unapplied                      value 6.\n     03  hold-pay        pic s9(6)v99     comp-3  value zero.\n     03  save-key.\n         05 save-supplier   pic x(7).\n         05 save-invoice    binary-long.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  PL003           pic x(28) value \"PL003 Hit Return To Continue\".\n*> Module specific\n     03  PL140           pic x(36) value \"PL140 Not Yet Supporting Corrections\".\n     03  PL141           pic x(42) value \"PL141 Amount Approp Or Deduct Amt Not Zero\".\n     03  PL142           pic x(39) value \"PL142 No Payments To Correct/Proof/Post\".\n*>\n*> 01  error-code          pic 999.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     if       p-flag-p = 0\n              display PL142   at 2301 erase eos\n              display PL003   at 2401\n              accept ws-reply at 2430\n              go to main-exit\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n display-heads.\n*>------------\n*>\n     display  prog-name at 0101 with erase eos foreground-color 2.\n     display  \"Payment Data Amend\" at 0133 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n dh-exit.\n*>\n     move     zero  to  k.\n     perform  Purch-Open. *> open     i-o purchase-file open-item-file-5.\n     perform  OTM5-Open.\n     perform  new-payment.\n     perform  Purch-Close.  *> close    purchase-file open-item-file-5.\n     perform  OTM5-Close.\n*>\n menu-exit.\n*>********\n*>\n     move     \"Y\" to oi-5-flag.\n     perform  display-heads.\n*>\n main-exit.\n     goback.\n*>\n*>***************************************\n*>             procedures               *\n*>***************************************\n*>\n new-payment             section.\n*>==============================\n*>\n New-Payment-Main.\n     move     4  to  lin.\n     perform  display-heads.\n*>\n     display  \"****************************************\" at 0441 with foreground-color 2.\n     display  \"*Date  [  /  /    ]*A/C Nos   [       ]*\" at 0541 with foreground-color 2.\n     display  \"***                                  ***\" at 0641 with foreground-color 2.\n     display  \"*Value [          ]*Batch   [     /   ]*\" at 0741 with foreground-color 2.\n     display  \"****************************************\" at 0841 with foreground-color 2.\n*>\n main-display-end.\n*>***************\n*>\n     perform  zz070-Convert-Date.\n     display  ws-date at 0549 with foreground-color 3.\n*>\n get-batch.\n*>\n     move     spaces to oi5-supplier.\n     accept   oi5-supplier at 0572 with foreground-color 3 update UPPER.\n *>    move     function upper-case (oi5-supplier) to oi5-supplier.\n     display  oi5-supplier at 0572 with foreground-color 3.\n     if       oi5-supplier = spaces\n              go to main-exit.\n*>\n customer-input.\n*>*************\n*>\n     move     zero to display-n.\n     accept   display-n at 0770 with foreground-color 3 update.\n     if       display-n = zero\n              go to  main-exit.\n*>\n     accept   k at 0776 with foreground-color 3 update.\n*>\n     if       k = zero\n              go to customer-input.\n     multiply display-n by 1000 giving oi5-invoice.\n     add      k to oi5-invoice.\n     move     oi5-key to save-key.\n     set      fn-not-less-than to true.\n     perform  OTM5-Start.  *> start open-item-file-5 key not < oi5-key.\n*>\n find-trans-loop.\n*>**************\n*>\n     perform  OTM5-Read-Next. *>   read open-item-file-5 next record at end\n     if       fs-reply = 10\n              go to  get-batch.\n *>    move     open-item-record-5  to  oi-header.  *> redefs oi-header otm5\n*>\n     if       oi-supplier not = save-supplier\n         or   oi-invoice not = save-invoice\n              go to get-batch.\n*>\n     if       oi-b-nos not = display-n\n           or oi-b-item not = k\n           or (oi-type not = 5 and not = 6)\n              go to  find-trans-loop.\n*>\n     if       oi-type = 6\n              display \"Warning Unapplied Balance Journal\" at 0645  with foreground-color 2\n*>\n     move     oi-type to transaction-type.\n*>\n     move     oi-supplier  to  pay-customer.\n     move     oi-date      to  pay-date.\n     move     oi-paid      to  pay-value hold-pay.\n     move     oi-approp    to  approp-amount.\n*>\n     display  pay-customer at 0572 with foreground-color 3.\n     move     pay-customer to  WS-Purch-Key.\n*>\n     perform  Purch-Read-Indexed. *>  read     purchase-file  record  invalid key\n     if       fs-reply = 21\n              move  zero  to  c-check.\n*>\n     move     purch-address  to  address1.\n*>\n     display  purch-name at 0401 with foreground-color 3.\n*>\n     move     1  to  a.\n     unstring address1  delimited  by pl-delim  into  address-line count a pointer  a.\n     display  address-line at 0501 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address1  delimited  by pl-delim  into  address-line count a pointer  a.\n     display  address-line at 0601 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address1  delimited  by pl-delim  into  address-line count a pointer  a.\n     display  address-line at 0701 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring address1 into address-line pointer  a.\n     display  address-line at 0801 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n*>\n     move     purch-current  to  display-s.\n     display  \"Current Balance - \" at 1001  with foreground-color 2.\n     display  display-s at 1019 with foreground-color 3.\n*>\n value-input.\n*>**********\n*>\n     move     pay-value to amt-ok.\n     move     0749 to curs.\n     perform  accept-money2.\n     move     amt-ok to pay-value.\n     if       pay-value not = oi-paid\n              go to value-input-2.\n     display  \"Confirm No action? i.e. Request cancelled (Y/N)..[ ]\"\n                                   at 1201 with foreground-color 2.\n*>\n value-input-req.\n*>\n     accept   ws-reply at 1251 with foreground-color 2.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply = \"Y\"\n              go to new-payment-Main.\n     if       ws-reply not = \"N\"\n              go to value-input-req.\n*>\n value-input-2.\n*>\n     if       pay-value not = zero\n              display PL140 at 1201 with erase eol foreground-color 2\n              go to value-input.\n*>\n     perform  OTM5-Delete.  *>  delete   open-item-file-5.\n*>\n     if       oi-approp = zero\n              go to  skip-pay-approp.\n     move     oi-deduct-amt  to si-deduct-amt.\n*>\n data-input.\n*>**********\n*>\n     perform  payment-appropriate.\n*>\n skip-pay-approp.\n*>\n     if       trans-unapplied\n              add hold-pay to purch-unapplied\n              perform Purch-Rewrite  *> rewrite purch-record.\n     move     14  to  lin.\n     perform  erase-screen.\n     display  \"Make further corrections? (Y/N)  [Y]\" at 1629 with foreground-color 2.\n*>\n more-data.\n*>\n     move     \"Y\"  to   ws-reply.\n     accept   ws-reply at 1663 with foreground-color 6 update.\n     move     function upper-case (ws-reply) to ws-reply.\n*>\n     if       ws-reply = \"Y\"\n              go to  new-payment-Main.\n     if       ws-reply not = \"N\"\n              go to more-data.\n     go       to main-exit.\n*>\n accept-money.\n*>-----------\n*>\n     move     zero to ws-poundsd2 amt-ok2 ws-penced2.\n     display  ws-amount-screen-display2 at curs  with foreground-color 3.\n     accept   ws-amount-screen-accept2 at curs   with foreground-color 3 update.\n     move     ws-pound2 to amt-wk-pds2.\n     move     ws-pence2 to amt-wk-pence2.\n*>\n accept-money2.\n*>------------\n*>\n     move     amt-wk-pence to ws-pence.\n     move     amt-wk-pds to ws-pound.\n     display  ws-amount-screen-display at curs  with foreground-color 3.\n     accept   ws-amount-screen-accept at curs   with foreground-color 3 update.\n     move     ws-pound to amt-wk-pds.\n     move     ws-pence to amt-wk-pence.\n*>\n main-exit.   exit section.\n*>\n payment-appropriate     section.\n*>==============================\n*>\n     display  \"Reversing please wait\" at 1101  with foreground-color 2.\n     move     zero to save-invoice.\n     move     save-key to oi5-key.\n     set      fn-not-less-than to true.\n     perform  OTM5-Start. *>  start open-item-file-5 key not < oi5-key.\n*>\n pay-loop.\n*>*******\n*>\n     perform  OTM5-Read-Next. *>  read     open-item-file-5 next record  at end\n     if       fs-reply = 10\n              go to  main-end.\n*>\n *>    move     open-item-record-5  to  oi-header. *> redefs\n*>\n     if       oi-type not = 2\n              go to  pay-loop.\n*>\n     if       oi-supplier not = pay-customer\n              go to main-end.\n*>\n     if       oi-b-nos not = display-n\n        or    oi-b-item not = k\n              go to pay-loop.\n*>\n     divide   oi-cr by 100 giving work-1.\n     subtract work-1 from oi-paid.\n     subtract work-1 from oi-p-c.\n     subtract work-1 from approp-amount.\n     move     zero to oi-b-nos oi-b-item oi-cr oi-status.\n*>\n     if       si-deduct-amt = zero\n          or  oi-deduct-amt not = zero\n              go to  by-pass-deduct.\n*>\n get-deduct.\n*>*********\n*>\n     move     si-deduct-amt  to  si-display.\n     display  \"For Folio  No.  \" at 1301 with foreground-color 2.\n     display  oi-invoice at 1317 with foreground-color 3.\n     display  \"Enter Deduct Amount - [      ]\" at 1201 with foreground-color 2.\n     display  \"Amount Available = \" at 1240            with foreground-color 2.\n     display  si-display at 1259 with foreground-color 3.\n     move     1224 to curs.\n     perform  accept-money.\n     move     amt-ok2 to oi-deduct-amt.\n     if       oi-deduct-amt  >  si-deduct-amt\n              go to  get-deduct\n     else\n              add oi-deduct-amt to oi-net\n              subtract  oi-deduct-amt  from  si-deduct-amt.\n*>\n     display  space at 1201 with erase eol.\n     display  space at 1301 with erase eol.\n*>\n by-pass-deduct.\n*>*************\n*>\n     perform  OTM5-Rewrite. *>  rewrite  open-item-record-5 from oi-header.\n     if       approp-amount = zero\n        and   si-deduct-amt = zero\n              go to main-end.\n*>\n     go       to pay-loop.\n*>\n main-end.\n*>\n     if       approp-amount not = zero\n          or  si-deduct-amt not = zero\n              display PL141  at 1201 with foreground-color 2\n              move approp-amount to display-8\n              move si-deduct-amt to display-s\n              display display-8 at 1304 with foreground-color 3\n              display display-s at 1317 with foreground-color 3\n              display PL003     at 1401 with foreground-color 2\n              accept ws-reply at 1430 with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n erase-screen section.\n*>===================\n*>\n     move     1 to cole.\n     display  space at curs with erase eos.\n*>\n main-exit.   exit.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 80
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 69,
      "totalOperators": 58,
      "totalOperands": 116,
      "vocabulary": 70,
      "length": 174,
      "volume": 1066.4952449484242
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
