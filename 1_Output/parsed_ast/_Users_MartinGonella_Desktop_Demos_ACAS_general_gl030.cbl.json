{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/general/gl030.cbl",
  "fileName": "gl030.cbl",
  "timestamp": "2025-09-15T16:25:32.107Z",
  "programId": "gl030",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 148
      },
      {
        "name": "file",
        "line": 164
      },
      {
        "name": "working-storage",
        "line": 178
      },
      {
        "name": "linkage",
        "line": 463
      },
      {
        "name": "init01",
        "line": 478
      },
      {
        "name": "gl030a",
        "line": 626
      },
      {
        "name": "gl030b",
        "line": 855
      },
      {
        "name": "gl030c",
        "line": 1259
      },
      {
        "name": "deletion",
        "line": 1505
      },
      {
        "name": "ledger-rewrite",
        "line": 1547
      },
      {
        "name": "ledger-delete",
        "line": 1564
      },
      {
        "name": "gl030e",
        "line": 1581
      },
      {
        "name": "exit",
        "line": 1687
      },
      {
        "name": "Compute-Placement",
        "line": 1689
      },
      {
        "name": "gl030f",
        "line": 1718
      },
      {
        "name": "display-chart",
        "line": 1929
      },
      {
        "name": "gl030f-screen-clear",
        "line": 1993
      },
      {
        "name": "exit",
        "line": 2026
      },
      {
        "name": "gl030g",
        "line": 2028
      },
      {
        "name": "exit",
        "line": 2129
      },
      {
        "name": "gl030h",
        "line": 2131
      },
      {
        "name": "exit",
        "line": 2161
      },
      {
        "name": "ea-Export-CoA",
        "line": 2163
      },
      {
        "name": "exit",
        "line": 2185
      },
      {
        "name": "exit",
        "line": 2243
      },
      {
        "name": "fa-Import-CoA",
        "line": 2245
      },
      {
        "name": "exit",
        "line": 2278
      },
      {
        "name": "exit",
        "line": 2335
      },
      {
        "name": "exit",
        "line": 2339
      },
      {
        "name": "zz050-Validate-Date",
        "line": 2341
      },
      {
        "name": "exit",
        "line": 2378
      },
      {
        "name": "zz060-Convert-Date",
        "line": 2380
      },
      {
        "name": "exit",
        "line": 2413
      },
      {
        "name": "zz070-Convert-Date",
        "line": 2415
      },
      {
        "name": "exit",
        "line": 2443
      },
      {
        "name": "zz100-Load-Ledger-Table",
        "line": 2445
      },
      {
        "name": "exit",
        "line": 2473
      },
      {
        "name": "zz200-Copy-and-Move-Account",
        "line": 2475
      },
      {
        "name": "exit",
        "line": 2570
      },
      {
        "name": "maps03",
        "line": 2572
      },
      {
        "name": "exit",
        "line": 2578
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 151
      },
      {
        "name": "file-defs",
        "line": 475
      },
      {
        "name": "Menu-Input",
        "line": 499
      },
      {
        "name": "menu-exit",
        "line": 614
      },
      {
        "name": "goback",
        "line": 615
      },
      {
        "name": "displaya",
        "line": 617
      },
      {
        "name": "main",
        "line": 629
      },
      {
        "name": "main-continue",
        "line": 642
      },
      {
        "name": "Est-Input",
        "line": 674
      },
      {
        "name": "re-input",
        "line": 687
      },
      {
        "name": "Loop",
        "line": 691
      },
      {
        "name": "Loop-2",
        "line": 716
      },
      {
        "name": "p-c-b-accept",
        "line": 720
      },
      {
        "name": "Loop-2-return",
        "line": 733
      },
      {
        "name": "p-c-b-end",
        "line": 743
      },
      {
        "name": "ledger-q4",
        "line": 775
      },
      {
        "name": "Loop-3",
        "line": 779
      },
      {
        "name": "Loop-3-back",
        "line": 794
      },
      {
        "name": "Loop-3-return",
        "line": 823
      },
      {
        "name": "Loop-3-clear",
        "line": 834
      },
      {
        "name": "write-ledger",
        "line": 843
      },
      {
        "name": "rewrite-ledger",
        "line": 846
      },
      {
        "name": "Loop-3-end",
        "line": 849
      },
      {
        "name": "by-pass-pc",
        "line": 886
      },
      {
        "name": "get-input",
        "line": 890
      },
      {
        "name": "Loop",
        "line": 901
      },
      {
        "name": "Accept-Ledger",
        "line": 916
      },
      {
        "name": "accept-pc",
        "line": 945
      },
      {
        "name": "accept-name",
        "line": 960
      },
      {
        "name": "accept-type",
        "line": 966
      },
      {
        "name": "accept-placement",
        "line": 981
      },
      {
        "name": "accept-header",
        "line": 1002
      },
      {
        "name": "accept-end",
        "line": 1013
      },
      {
        "name": "detail-check",
        "line": 1034
      },
      {
        "name": "header-check",
        "line": 1055
      },
      {
        "name": "Loop-end",
        "line": 1101
      },
      {
        "name": "multi-add",
        "line": 1109
      },
      {
        "name": "Loop-add",
        "line": 1128
      },
      {
        "name": "addition-end",
        "line": 1134
      },
      {
        "name": "screen-clear",
        "line": 1149
      },
      {
        "name": "main-end",
        "line": 1159
      },
      {
        "name": "ledger-read",
        "line": 1165
      },
      {
        "name": "ledger-write",
        "line": 1202
      },
      {
        "name": "PC-Code-Check",
        "line": 1208
      },
      {
        "name": "pc-code-main-check",
        "line": 1229
      },
      {
        "name": "aloop",
        "line": 1250
      },
      {
        "name": "PC-Code-Check-exit",
        "line": 1256
      },
      {
        "name": "exit",
        "line": 1257
      },
      {
        "name": "by-pass-pc",
        "line": 1288
      },
      {
        "name": "get-input",
        "line": 1293
      },
      {
        "name": "Loop",
        "line": 1303
      },
      {
        "name": "Accept-Ledger",
        "line": 1318
      },
      {
        "name": "accept-pc",
        "line": 1330
      },
      {
        "name": "A-Test-Key",
        "line": 1347
      },
      {
        "name": "accept-type",
        "line": 1398
      },
      {
        "name": "accept-placement",
        "line": 1411
      },
      {
        "name": "accept-header",
        "line": 1428
      },
      {
        "name": "accept-end",
        "line": 1441
      },
      {
        "name": "Loop-end",
        "line": 1443
      },
      {
        "name": "multi-add",
        "line": 1451
      },
      {
        "name": "Loop-add",
        "line": 1470
      },
      {
        "name": "addition-end",
        "line": 1476
      },
      {
        "name": "Addition-End-2",
        "line": 1480
      },
      {
        "name": "screen-clear",
        "line": 1490
      },
      {
        "name": "main-end",
        "line": 1499
      },
      {
        "name": "Loop-end",
        "line": 1508
      },
      {
        "name": "multi-add",
        "line": 1516
      },
      {
        "name": "Loop-add",
        "line": 1534
      },
      {
        "name": "addition-end",
        "line": 1539
      },
      {
        "name": "ledger-pc",
        "line": 1569
      },
      {
        "name": "P-Loop",
        "line": 1618
      },
      {
        "name": "Detail-Jump",
        "line": 1645
      },
      {
        "name": "Page-Heading",
        "line": 1662
      },
      {
        "name": "End-Report",
        "line": 1677
      },
      {
        "name": "Main-End",
        "line": 1681
      },
      {
        "name": "Main-Exit",
        "line": 1686
      },
      {
        "name": "d-head-1",
        "line": 1728
      },
      {
        "name": "d-head-end",
        "line": 1734
      },
      {
        "name": "main-target",
        "line": 1737
      },
      {
        "name": "main-loop",
        "line": 1797
      },
      {
        "name": "subsid-loop",
        "line": 1810
      },
      {
        "name": "print-out",
        "line": 1849
      },
      {
        "name": "p-loop",
        "line": 1865
      },
      {
        "name": "detail-jump",
        "line": 1889
      },
      {
        "name": "page-heading",
        "line": 1904
      },
      {
        "name": "end-report",
        "line": 1919
      },
      {
        "name": "main-end",
        "line": 1923
      },
      {
        "name": "second-head",
        "line": 1937
      },
      {
        "name": "main-pass",
        "line": 1956
      },
      {
        "name": "detail-display",
        "line": 1959
      },
      {
        "name": "gate",
        "line": 1996
      },
      {
        "name": "ask-clear",
        "line": 2003
      },
      {
        "name": "do-clear",
        "line": 2009
      },
      {
        "name": "Loop",
        "line": 2016
      },
      {
        "name": "main-exit",
        "line": 2025
      },
      {
        "name": "print-out",
        "line": 2064
      },
      {
        "name": "p-loop",
        "line": 2072
      },
      {
        "name": "Loop-3",
        "line": 2075
      },
      {
        "name": "Loop-3-back",
        "line": 2091
      },
      {
        "name": "Loop-3-return",
        "line": 2100
      },
      {
        "name": "page-heading",
        "line": 2107
      },
      {
        "name": "end-report",
        "line": 2121
      },
      {
        "name": "main-end",
        "line": 2125
      },
      {
        "name": "main-exit",
        "line": 2128
      },
      {
        "name": "GL030h-Main",
        "line": 2136
      },
      {
        "name": "gl030h-Exit",
        "line": 2160
      },
      {
        "name": "ea010-Warning-Notice",
        "line": 2166
      },
      {
        "name": "ea020-Open-Output",
        "line": 2187
      },
      {
        "name": "ea999-exit",
        "line": 2242
      },
      {
        "name": "fa010-Warning-Notice",
        "line": 2247
      },
      {
        "name": "fa020-Open-Files",
        "line": 2280
      },
      {
        "name": "fa030-Read-Input",
        "line": 2303
      },
      {
        "name": "fa040-End-Of-Input",
        "line": 2325
      },
      {
        "name": "fa999-Exit",
        "line": 2334
      },
      {
        "name": "main-exit",
        "line": 2338
      },
      {
        "name": "zz050-test-date",
        "line": 2372
      },
      {
        "name": "zz050-exit",
        "line": 2377
      },
      {
        "name": "zz060-Exit",
        "line": 2412
      },
      {
        "name": "zz070-Exit",
        "line": 2442
      },
      {
        "name": "end-perform",
        "line": 2466
      },
      {
        "name": "zz100-Exit",
        "line": 2472
      },
      {
        "name": "zz200-Start",
        "line": 2493
      },
      {
        "name": "Ledger-N-2",
        "line": 2502
      },
      {
        "name": "zz200-Exit",
        "line": 2569
      },
      {
        "name": "maps04-exit",
        "line": 2577
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "SYSTEM",
        "line": 1679,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1921,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 2123,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 2575,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "&",
        "line": 87,
        "replacing": null
      },
      {
        "name": "existing",
        "line": 87,
        "replacing": null
      },
      {
        "name": "of",
        "line": 138,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 147,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 160,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 176,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 182,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 187,
        "replacing": null
      },
      {
        "name": "glwspc",
        "line": 188,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 189,
        "replacing": null
      },
      {
        "name": "wsledger",
        "line": 190,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 216,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 251,
        "replacing": null
      },
      {
        "name": "wsledger",
        "line": 376,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 466,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 467,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 468,
        "replacing": null
      },
      {
        "name": "of",
        "line": 2167,
        "replacing": null
      },
      {
        "name": "of",
        "line": 2169,
        "replacing": null
      },
      {
        "name": "of",
        "line": 2259,
        "replacing": null
      },
      {
        "name": "-",
        "line": 2478,
        "replacing": null
      },
      {
        "name": "existing",
        "line": 2478,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2580,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 502
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 514
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 525
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 530
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 536
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 541
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 546
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 552
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 558
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 564
      },
      {
        "target": "displaya",
        "thru": null,
        "line": 570
      },
      {
        "target": "gl030a",
        "thru": null,
        "line": 584
      },
      {
        "target": "gl030b",
        "thru": null,
        "line": 588
      },
      {
        "target": "gl030c",
        "thru": null,
        "line": 592
      },
      {
        "target": "gl030e",
        "thru": null,
        "line": 598
      },
      {
        "target": "gl030f",
        "thru": null,
        "line": 602
      },
      {
        "target": "gl030g",
        "thru": null,
        "line": 607
      },
      {
        "target": "gl030h",
        "thru": null,
        "line": 610
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 630
      },
      {
        "target": "GL-Nominal-Open-Output",
        "thru": null,
        "line": 632
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 640
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 643
      },
      {
        "target": "GL-Nominal-Open",
        "thru": null,
        "line": 644
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 649
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 666
      },
      {
        "target": "write-ledger",
        "thru": null,
        "line": 757
      },
      {
        "target": "rewrite-ledger",
        "thru": null,
        "line": 759
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 763
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 787
      },
      {
        "target": "write-ledger",
        "thru": null,
        "line": 816
      },
      {
        "target": "rewrite-ledger",
        "thru": null,
        "line": 818
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 844
      },
      {
        "target": "GL-Nominal-Rewrite",
        "thru": null,
        "line": 847
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 850
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 858
      },
      {
        "target": "main",
        "thru": null,
        "line": 860
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 861
      },
      {
        "target": "GL-Nominal-Open",
        "thru": null,
        "line": 862
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 871
      },
      {
        "target": "PC-Code-Check",
        "thru": "PC-Code-Check-exit",
        "line": 953
      },
      {
        "target": "detail-check",
        "thru": null,
        "line": 1020
      },
      {
        "target": "header-check",
        "thru": null,
        "line": 1022
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1038
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1048
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1057
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1065
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1068
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1079
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1082
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1092
      },
      {
        "target": "ledger-read",
        "thru": null,
        "line": 1095
      },
      {
        "target": "ledger-write",
        "thru": null,
        "line": 1106
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1114
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1121
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1124
      },
      {
        "target": "ledger-write",
        "thru": null,
        "line": 1130
      },
      {
        "target": "ledger-write",
        "thru": null,
        "line": 1136
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1160
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 1183
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 1206
      },
      {
        "target": "aloop",
        "thru": null,
        "line": 1243
      },
      {
        "target": "aloop",
        "thru": null,
        "line": 1246
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 1264
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1269
      },
      {
        "target": "GL-Nominal-Open",
        "thru": null,
        "line": 1270
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 1279
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 1290
      },
      {
        "target": "PC-Code-Check",
        "thru": "PC-Code-Check-exit",
        "line": 1340
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 1359
      },
      {
        "target": "deletion",
        "thru": null,
        "line": 1384
      },
      {
        "target": "zz200-Copy-and-Move-Account",
        "thru": null,
        "line": 1396
      },
      {
        "target": "ledger-rewrite",
        "thru": null,
        "line": 1448
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1456
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1463
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1466
      },
      {
        "target": "ledger-rewrite",
        "thru": null,
        "line": 1472
      },
      {
        "target": "ledger-rewrite",
        "thru": null,
        "line": 1478
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1500
      },
      {
        "target": "ledger-delete",
        "thru": null,
        "line": 1513
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1521
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1528
      },
      {
        "target": "Loop-add",
        "thru": null,
        "line": 1531
      },
      {
        "target": "ledger-delete",
        "thru": null,
        "line": 1536
      },
      {
        "target": "ledger-delete",
        "thru": null,
        "line": 1541
      },
      {
        "target": "GL-Nominal-Rewrite",
        "thru": null,
        "line": 1553
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 1558
      },
      {
        "target": "GL-Nominal-Delete",
        "thru": null,
        "line": 1576
      },
      {
        "target": "zz100-Load-Ledger-Table",
        "thru": null,
        "line": 1586
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 1587
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 1594
      },
      {
        "target": "page-heading",
        "thru": null,
        "line": 1612
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 1625
      },
      {
        "target": "Compute-Placement",
        "thru": null,
        "line": 1650
      },
      {
        "target": "Page-Heading",
        "thru": null,
        "line": 1658
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1684
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 1722
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 1730
      },
      {
        "target": "gl030f-screen-clear",
        "thru": null,
        "line": 1743
      },
      {
        "target": "display-chart",
        "thru": null,
        "line": 1777
      },
      {
        "target": "GL-Nominal-Start",
        "thru": null,
        "line": 1781
      },
      {
        "target": "GL-Nominal-Read-Next",
        "thru": null,
        "line": 1786
      },
      {
        "target": "display-chart",
        "thru": null,
        "line": 1802
      },
      {
        "target": "GL-Nominal-Read-Next",
        "thru": null,
        "line": 1815
      },
      {
        "target": "ask-clear",
        "thru": null,
        "line": 1831
      },
      {
        "target": "d-head-1",
        "thru": null,
        "line": 1838
      },
      {
        "target": "second-head",
        "thru": null,
        "line": 1840
      },
      {
        "target": "display-chart",
        "thru": null,
        "line": 1846
      },
      {
        "target": "page-heading",
        "thru": null,
        "line": 1863
      },
      {
        "target": "GL-Nominal-Read-Next",
        "thru": null,
        "line": 1866
      },
      {
        "target": "Compute-Placement",
        "thru": null,
        "line": 1886
      },
      {
        "target": "page-heading",
        "thru": null,
        "line": 1900
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 1924
      },
      {
        "target": "Compute-Placement",
        "thru": null,
        "line": 1985
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 2033
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 2040
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 2048
      },
      {
        "target": "page-heading",
        "thru": null,
        "line": 2070
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 2084
      },
      {
        "target": "page-heading",
        "thru": null,
        "line": 2097
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2126
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 2139
      },
      {
        "target": "ea-Export-CoA",
        "thru": null,
        "line": 2155
      },
      {
        "target": "fa-Import-CoA",
        "thru": null,
        "line": 2157
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 2199
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2203
      },
      {
        "target": "until",
        "thru": null,
        "line": 2208
      },
      {
        "target": "GL-Nominal-Read-Next",
        "thru": null,
        "line": 2209
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2211
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 2213
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2225
      },
      {
        "target": "*>",
        "thru": null,
        "line": 2227
      },
      {
        "target": "*>",
        "thru": null,
        "line": 2230
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2239
      },
      {
        "target": "GL-Nominal-Open-Output",
        "thru": null,
        "line": 2289
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2293
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 2313
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2317
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2332
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 2375
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 2389
      },
      {
        "target": "GL-Nominal-Open-Input",
        "thru": null,
        "line": 2451
      },
      {
        "target": "varying",
        "thru": null,
        "line": 2452
      },
      {
        "target": "GL-Nominal-Read-Next",
        "thru": null,
        "line": 2455
      },
      {
        "target": "exit",
        "thru": null,
        "line": 2457
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 2458
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 2462
      },
      {
        "target": "GL-Nominal-Close",
        "thru": null,
        "line": 2467
      },
      {
        "target": "GL-Nominal-Read-Indexed",
        "thru": null,
        "line": 2543
      },
      {
        "target": "GL-Nominal-Write",
        "thru": null,
        "line": 2557
      },
      {
        "target": "GL-Nominal-Delete",
        "thru": null,
        "line": 2567
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 485
      },
      {
        "from": "ws-env-lines",
        "to": "ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 493
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 497
      },
      {
        "from": "10",
        "to": "lin",
        "line": 509
      },
      {
        "from": "2",
        "to": "a",
        "line": 510
      },
      {
        "from": "1",
        "to": "a\n              perform displaya",
        "line": 513
      },
      {
        "from": "2",
        "to": "a",
        "line": 524
      },
      {
        "from": "3",
        "to": "a",
        "line": 529
      },
      {
        "from": "4",
        "to": "a\n              perform displaya\n              display \"Print Alphabetic List\" at curs with foreground-color 2\n              add 1  to  lin",
        "line": 535
      },
      {
        "from": "5",
        "to": "a\n     perform  displaya",
        "line": 540
      },
      {
        "from": "6",
        "to": "a\n     perform  displaya",
        "line": 545
      },
      {
        "from": "7",
        "to": "a\n              perform displaya\n              display \"Print Report on Profit Centres\" at curs with foreground-color 2\n              add   1 to lin",
        "line": 551
      },
      {
        "from": "7",
        "to": "a\n              perform displaya\n              display \"Print Report on Branch Codes\" at curs with foreground-color 2",
        "line": 557
      },
      {
        "from": "8",
        "to": "a\n     perform  displaya",
        "line": 563
      },
      {
        "from": "9",
        "to": "a",
        "line": 568
      },
      {
        "from": "1",
        "to": "cole",
        "line": 618
      },
      {
        "from": "2",
        "to": "cole",
        "line": 620
      },
      {
        "from": "3",
        "to": "cole",
        "line": 622
      },
      {
        "from": "6",
        "to": "cole",
        "line": 624
      },
      {
        "from": "low-values",
        "to": "ledger-name\n              move  999999 to  WS-Ledger-nos\n              move  99     to  ledger-pc\n              move zeros to ledger-type Ledger-Place ledger-level\n                   ledger-balance ledger-last ledger-q1 ledger-q2\n                   ledger-q3 ledger-q4\n              perform  GL-Nominal-Write",
        "line": 634
      },
      {
        "from": "999999",
        "to": "WS-Ledger-nos",
        "line": 646
      },
      {
        "from": "zero",
        "to": "ledger-pc",
        "line": 647
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 651
      },
      {
        "from": "spaces",
        "to": "p-c-Branches\n     else\n              move  WS-Ledger-Record  to  p-c-Branches",
        "line": 654
      },
      {
        "from": "999999",
        "to": "pc-ledg",
        "line": 658
      },
      {
        "from": "zero",
        "to": "pc-pc est",
        "line": 659
      },
      {
        "from": "\"E\"",
        "to": "p-b-codes (est)",
        "line": 684
      },
      {
        "from": "7",
        "to": "lin",
        "line": 688
      },
      {
        "from": "1",
        "to": "cole y",
        "line": 689
      },
      {
        "from": "curs",
        "to": "curs2",
        "line": 692
      },
      {
        "from": "7",
        "to": "lin\n              add  11  to  cole\n              go to  Loop",
        "line": 706
      },
      {
        "from": "7",
        "to": "lin  cole",
        "line": 710
      },
      {
        "from": "1",
        "to": "y",
        "line": 711
      },
      {
        "from": "ws-codes",
        "to": "p-b-codes (y)",
        "line": 724
      },
      {
        "from": "space",
        "to": "p-b-codes (y)\n              go to  p-c-b-end",
        "line": 726
      },
      {
        "from": "7",
        "to": "lin\n              add  11  to cole\n              go to  Loop-2",
        "line": 739
      },
      {
        "from": "\"Y\"",
        "to": "ws-reply",
        "line": 746
      },
      {
        "from": "spaces",
        "to": "WS-Ledger-Record",
        "line": 752
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 761
      },
      {
        "from": "4",
        "to": "lin",
        "line": 771
      },
      {
        "from": "1",
        "to": "y",
        "line": 772
      },
      {
        "from": "zero",
        "to": "ledger-pc  ledger-type ledger-balance\n                      ledger-last ledger-q1 ledger-q2 ledger-q3\n                      ledger-q4",
        "line": 773
      },
      {
        "from": "space",
        "to": "Ledger-Place",
        "line": 777
      },
      {
        "from": "y",
        "to": "z",
        "line": 783
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 784
      },
      {
        "from": "z",
        "to": "ledger-pc",
        "line": 785
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 789
      },
      {
        "from": "spaces",
        "to": "ledger-name",
        "line": 792
      },
      {
        "from": "1",
        "to": "cole",
        "line": 795
      },
      {
        "from": "8",
        "to": "cole",
        "line": 797
      },
      {
        "from": "11",
        "to": "cole",
        "line": 799
      },
      {
        "from": "45",
        "to": "cole",
        "line": 801
      },
      {
        "from": "21",
        "to": "cole",
        "line": 803
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 820
      },
      {
        "from": "4",
        "to": "lin",
        "line": 831
      },
      {
        "from": "1",
        "to": "cole",
        "line": 832
      },
      {
        "from": "4",
        "to": "lin",
        "line": 840
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 868
      },
      {
        "from": "zero",
        "to": "ledger-pc",
        "line": 869
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 873
      },
      {
        "from": "spaces",
        "to": "p-c-Branches\n     else\n              move  WS-Ledger-Record  to  p-c-Branches",
        "line": 876
      },
      {
        "from": "999999",
        "to": "pc-ledg",
        "line": 880
      },
      {
        "from": "zero",
        "to": "pc-pc est",
        "line": 881
      },
      {
        "from": "6",
        "to": "lin",
        "line": 899
      },
      {
        "from": "1",
        "to": "cole",
        "line": 902
      },
      {
        "from": "16",
        "to": "cole\n              display \"[  ]\" at curs with foreground-color 2",
        "line": 906
      },
      {
        "from": "23",
        "to": "cole",
        "line": 909
      },
      {
        "from": "48",
        "to": "cole",
        "line": 911
      },
      {
        "from": "zero",
        "to": "ledger-n ledger-s",
        "line": 914
      },
      {
        "from": "2",
        "to": "cole",
        "line": 917
      },
      {
        "from": "curs",
        "to": "curs2",
        "line": 923
      },
      {
        "from": "1",
        "to": "col2",
        "line": 925
      },
      {
        "from": "11",
        "to": "cole",
        "line": 932
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "ledger-check",
        "line": 935
      },
      {
        "from": "zero",
        "to": "ledger-pc\n              go to  accept-name",
        "line": 947
      },
      {
        "from": "spaces",
        "to": "pc-code",
        "line": 950
      },
      {
        "from": "17",
        "to": "cole",
        "line": 951
      },
      {
        "from": "17",
        "to": "col2\n              display \"Invalid! Code must be numeric or <n*>",
        "line": 956
      },
      {
        "from": "24",
        "to": "cole",
        "line": 962
      },
      {
        "from": "spaces",
        "to": "ledger-name",
        "line": 963
      },
      {
        "from": "52",
        "to": "cole",
        "line": 970
      },
      {
        "from": "zero",
        "to": "ledger-type",
        "line": 971
      },
      {
        "from": "52",
        "to": "col2\n              display \"Invalid type! [0,1 & 9]\" at curs2 with foreground-color 2 erase eol\n              go to  accept-type",
        "line": 976
      },
      {
        "from": "61",
        "to": "cole",
        "line": 982
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 988
      },
      {
        "from": "61",
        "to": "col2\n              display \"Invalid Placement! [A - Z]\" at curs2 with foreground-color 2 erase eol\n              go to  accept-placement",
        "line": 992
      },
      {
        "from": "61",
        "to": "col2\n              display \"PC/BR, Revenue only [A - N]\"  at curs2 with foreground-color 2\n              go to  Accept-Ledger",
        "line": 998
      },
      {
        "from": "zero",
        "to": "ledger-level",
        "line": 1003
      },
      {
        "from": "70",
        "to": "cole col2",
        "line": 1005
      },
      {
        "from": "zero",
        "to": "ledger-balance  ledger-last\n                        ledger-q1       ledger-q2\n                        ledger-q3       ledger-q4",
        "line": 1014
      },
      {
        "from": "ledger-s",
        "to": "save-s\n              perform  detail-check\n       else\n              perform  header-check",
        "line": 1019
      },
      {
        "from": "52",
        "to": "cole",
        "line": 1024
      },
      {
        "from": "70",
        "to": "cole",
        "line": 1026
      },
      {
        "from": "zero",
        "to": "ledger-sub",
        "line": 1035
      },
      {
        "from": "\"D\"",
        "to": "a-test",
        "line": 1036
      },
      {
        "from": "space",
        "to": "a-test",
        "line": 1040
      },
      {
        "from": "save-s",
        "to": "ledger-sub  ledger-s",
        "line": 1041
      },
      {
        "from": "1",
        "to": "col2\n              display \"INVALID! Header Missing '1'\" at curs2 with foreground-color 2 with erase eol\n              move  1  to  truth\n       else\n              perform  ledger-read",
        "line": 1044
      },
      {
        "from": "1",
        "to": "ledger-type",
        "line": 1051
      },
      {
        "from": "zero",
        "to": "ledger-level",
        "line": 1053
      },
      {
        "from": "1",
        "to": "ledger-level",
        "line": 1058
      },
      {
        "from": "2",
        "to": "ledger-level\n              move      header-1  to  save-h-1\n              move      zero      to  header-1\n              perform   ledger-read\n              move      save-h-1  to  header-1\n              if        a-true\n                        perform  ledger-read\n                 else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '2'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth",
        "line": 1062
      },
      {
        "from": "3",
        "to": "ledger-level\n              move      header-2  to  save-h-2\n              move      zero      to  header-2\n              perform   ledger-read\n              move      save-h-2  to  header-2\n              if        a-true\n                        perform  ledger-read\n                   else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '3'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth",
        "line": 1076
      },
      {
        "from": "4",
        "to": "ledger-level\n              move      header-3  to  save-h-3\n              move      zero      to  header-3\n              perform   ledger-read\n              move      save-h-3  to  header-3\n              if        a-true\n                        perform  ledger-read\n               else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '4'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth",
        "line": 1089
      },
      {
        "from": "pc-code",
        "to": "y",
        "line": 1105
      },
      {
        "from": "zero",
        "to": "ledger-pc  y",
        "line": 1110
      },
      {
        "from": "1",
        "to": "y\n              perform  Loop-add  99  times\n              go to  addition-end",
        "line": 1113
      },
      {
        "from": "pc-code1",
        "to": "y",
        "line": 1117
      },
      {
        "from": "zero",
        "to": "y",
        "line": 1135
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1139
      },
      {
        "from": "6",
        "to": "lin",
        "line": 1146
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1147
      },
      {
        "from": "6",
        "to": "lin\n              go to  Loop",
        "line": 1156
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1170
      },
      {
        "from": "ledger-check",
        "to": "WS-Ledger-Nos",
        "line": 1171
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1172
      },
      {
        "from": "\"00\"",
        "to": "n-pc\n              move     \"00\"  to  ledger-pc\n     else\n              move     pc-code     to  n-pc  ledger-pc",
        "line": 1175
      },
      {
        "from": "WS-Ledger-Record",
        "to": "dummy-record",
        "line": 1180
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 1181
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1185
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1187
      },
      {
        "from": "Ledger-Place",
        "to": "save-place\n              if    ledger-type  numeric\n                    move  ledger-type  to  save-type\n              else\n                    move  zero  to  save-type",
        "line": 1190
      },
      {
        "from": "dummy-record",
        "to": "WS-Ledger-Record",
        "line": 1196
      },
      {
        "from": "save-type",
        "to": "ledger-type\n              move  save-place to  Ledger-Place",
        "line": 1199
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1203
      },
      {
        "from": "y",
        "to": "n-pc  ledger-pc",
        "line": 1204
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1209
      },
      {
        "from": "\"00\"",
        "to": "pc-code",
        "line": 1212
      },
      {
        "from": "zero",
        "to": "truth\n              go to  PC-Code-Check-exit",
        "line": 1220
      },
      {
        "from": "zero",
        "to": "truth\n              go to  PC-Code-Check-exit",
        "line": 1226
      },
      {
        "from": "pc-code",
        "to": "z\n              if     p-b-codes (z) = \"E\"  or  \"Y\"\n                     go to  PC-Code-Check-exit\n                else\n                     move   zero  to  truth\n                     go to  PC-Code-Check-exit",
        "line": 1231
      },
      {
        "from": "pc-code1",
        "to": "z",
        "line": 1238
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1240
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1252
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 1276
      },
      {
        "from": "zero",
        "to": "ledger-pc",
        "line": 1277
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1281
      },
      {
        "from": "spaces",
        "to": "p-c-Branches\n       else\n              move  WS-Ledger-Record  to  p-c-Branches",
        "line": 1284
      },
      {
        "from": "6",
        "to": "lin",
        "line": 1301
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1304
      },
      {
        "from": "11",
        "to": "cole",
        "line": 1306
      },
      {
        "from": "16",
        "to": "cole\n              display \"[  ]\" at curs with foreground-color 2",
        "line": 1310
      },
      {
        "from": "23",
        "to": "cole",
        "line": 1313
      },
      {
        "from": "48",
        "to": "cole",
        "line": 1315
      },
      {
        "from": "zeros",
        "to": "WS-Ledger-Nos",
        "line": 1319
      },
      {
        "from": "2",
        "to": "cole",
        "line": 1320
      },
      {
        "from": "12",
        "to": "cole",
        "line": 1327
      },
      {
        "from": "lin",
        "to": "lin2",
        "line": 1331
      },
      {
        "from": "zero",
        "to": "pc-code\n              go to  A-Test-Key",
        "line": 1335
      },
      {
        "from": "17",
        "to": "cole",
        "line": 1338
      },
      {
        "from": "17",
        "to": "col2",
        "line": 1342
      },
      {
        "from": "1",
        "to": "col2",
        "line": 1349
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 1351
      },
      {
        "from": "\"A\"",
        "to": "a-test\n              move  pc-code  to  save-code\n              move  \"00\"  to  pc-code",
        "line": 1354
      },
      {
        "from": "pc-code",
        "to": "ledger-pc",
        "line": 1357
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1361
      },
      {
        "from": "1",
        "to": "col2\n              display WS-Ledger-Nos at curs2 with foreground-color 2\n              move 7 to col2\n              display \"/\"       at curs2 with foreground-color 2\n              move 8 to col2\n              display ledger-pc at curs2 with foreground-color 2\n              move 11 to col2\n              display GL039     at curs2 with foreground-color 2\n              go to  Accept-Ledger",
        "line": 1364
      },
      {
        "from": "save-code",
        "to": "pc-code\n              move  space  to  a-test",
        "line": 1374
      },
      {
        "from": "24",
        "to": "col2 cole",
        "line": 1377
      },
      {
        "from": "ledger-name",
        "to": "name-test",
        "line": 1382
      },
      {
        "from": "a/c",
        "to": "new a/c re\n              perform  zz200-Copy-and-Move-Account\n              go to Addition-End-2",
        "line": 1395
      },
      {
        "from": "1",
        "to": "col2",
        "line": 1401
      },
      {
        "from": "52",
        "to": "cole col2",
        "line": 1402
      },
      {
        "from": "61",
        "to": "cole col2",
        "line": 1414
      },
      {
        "from": "zero",
        "to": "Ledger-Level\n     end-if\n     move     70 to cole col2",
        "line": 1432
      },
      {
        "from": "pc-code",
        "to": "y",
        "line": 1447
      },
      {
        "from": "zero",
        "to": "ledger-pc  y",
        "line": 1452
      },
      {
        "from": "1",
        "to": "y\n              perform  Loop-add  99  times\n              go to  addition-end",
        "line": 1455
      },
      {
        "from": "pc-code1",
        "to": "y",
        "line": 1459
      },
      {
        "from": "zero",
        "to": "y",
        "line": 1477
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1482
      },
      {
        "from": "6",
        "to": "lin",
        "line": 1488
      },
      {
        "from": "pc-code",
        "to": "y",
        "line": 1512
      },
      {
        "from": "zero",
        "to": "ledger-pc  y",
        "line": 1517
      },
      {
        "from": "1",
        "to": "y\n              perform  Loop-add  99  times\n              go to  addition-end",
        "line": 1520
      },
      {
        "from": "pc-code1",
        "to": "y",
        "line": 1524
      },
      {
        "from": "zero",
        "to": "y",
        "line": 1540
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1542
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1550
      },
      {
        "from": "y",
        "to": "n-pc  ledger-pc",
        "line": 1551
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1567
      },
      {
        "from": "y",
        "to": "n-pc\n                                 ledger-pc",
        "line": 1568
      },
      {
        "from": "zero",
        "to": "truth\n              display GL035   at line ws-lines col 01 with foreground-color 2\n              go to  main-exit",
        "line": 1572
      },
      {
        "from": "prog-name",
        "to": "l1-prog",
        "line": 1588
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1598
      },
      {
        "from": "spaces",
        "to": "l4-filler-2",
        "line": 1607
      },
      {
        "from": "ws-date",
        "to": "l1-date",
        "line": 1609
      },
      {
        "from": "zero",
        "to": "page-nos",
        "line": 1610
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 1611
      },
      {
        "from": "zero",
        "to": "WS-TBL-Sub",
        "line": 1616
      },
      {
        "from": "spaces",
        "to": "l5-level-filler l5-placement l5-name",
        "line": 1632
      },
      {
        "from": "zero",
        "to": "l5-header       l5-detail    l5-pc z",
        "line": 1633
      },
      {
        "from": "ledger-level",
        "to": "z",
        "line": 1638
      },
      {
        "from": "ledger-level",
        "to": "l5-level (i)",
        "line": 1641
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1642
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code\n              divide  n-code      by  100  giving  l5-detail",
        "line": 1647
      },
      {
        "from": "ledger-pc",
        "to": "l5-pc",
        "line": 1652
      },
      {
        "from": "ledger-name",
        "to": "l5-name",
        "line": 1653
      },
      {
        "from": "page-nos",
        "to": "l3-page",
        "line": 1664
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1673
      },
      {
        "from": "5",
        "to": "line-cnt",
        "line": 1675
      },
      {
        "from": "1",
        "to": "z\n     else\n      if      Ledger-Place  less  \"I\"\n              move  2  to  z\n      else\n       if     Ledger-Place  less  \"K\"\n              move  3  to  z\n       else\n        if    Ledger-Place  less  \"O\"\n              move  4  to  z\n        else\n         if   Ledger-Place  less  \"R\"\n              move  5  to  z\n         else\n          if  Ledger-Place  less  \"U\"\n              move  6  to  z\n          else\n           if Ledger-Place  less  \"W\"\n              move  7  to  z\n           else\n              move  8  to  z",
        "line": 1693
      },
      {
        "from": "prog-name",
        "to": "l1-prog",
        "line": 1721
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1735
      },
      {
        "from": "3",
        "to": "lin",
        "line": 1742
      },
      {
        "from": "zero",
        "to": "ledger-n  ledger-s Ledger-PC",
        "line": 1745
      },
      {
        "from": "\"Q\"",
        "to": "seek\n              move  0  to  truth\n              go to  main-end",
        "line": 1758
      },
      {
        "from": "zero",
        "to": "ledger-pc",
        "line": 1762
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "save-ledger",
        "line": 1767
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1768
      },
      {
        "from": "ledger-pc",
        "to": "n-pc",
        "line": 1769
      },
      {
        "from": "4",
        "to": "lin",
        "line": 1770
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1771
      },
      {
        "from": "1",
        "to": "gate-sw",
        "line": 1774
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1779
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1783
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1788
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 1794
      },
      {
        "from": "\"I\"",
        "to": "seek",
        "line": 1800
      },
      {
        "from": "0",
        "to": "truth\n              go to  main-end",
        "line": 1807
      },
      {
        "from": "2",
        "to": "gate-sw",
        "line": 1812
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1817
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "save-ledger",
        "line": 1827
      },
      {
        "from": "1",
        "to": "gate-sw\n              set  DoClear to true\n              go to main-target\n        else\n              perform d-head-1\n              move 4 to lin\n              perform second-head\n              move  6   to  lin",
        "line": 1834
      },
      {
        "from": "spaces",
        "to": "l6-filler-2",
        "line": 1858
      },
      {
        "from": "to-day",
        "to": "l1-date",
        "line": 1860
      },
      {
        "from": "zero",
        "to": "page-nos",
        "line": 1861
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 1862
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 1868
      },
      {
        "from": "spaces",
        "to": "l7-level-filler l7-placement l7-name",
        "line": 1874
      },
      {
        "from": "zero",
        "to": "l7-header l7-detail l7-pc z",
        "line": 1875
      },
      {
        "from": "ledger-level",
        "to": "z",
        "line": 1880
      },
      {
        "from": "ledger-level",
        "to": "l7-level (i)",
        "line": 1883
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code",
        "line": 1884
      },
      {
        "from": "WS-Ledger-Nos",
        "to": "n-code\n              divide  n-code      by  100  giving  l7-detail",
        "line": 1891
      },
      {
        "from": "ledger-pc",
        "to": "l7-pc",
        "line": 1894
      },
      {
        "from": "ledger-name",
        "to": "l7-name",
        "line": 1895
      },
      {
        "from": "page-nos",
        "to": "l3-page",
        "line": 1906
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1915
      },
      {
        "from": "5",
        "to": "line-cnt",
        "line": 1917
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1938
      },
      {
        "from": "11",
        "to": "cole",
        "line": 1940
      },
      {
        "from": "18",
        "to": "cole",
        "line": 1943
      },
      {
        "from": "26",
        "to": "cole",
        "line": 1952
      },
      {
        "from": "2",
        "to": "cole",
        "line": 1960
      },
      {
        "from": "11",
        "to": "cole",
        "line": 1962
      },
      {
        "from": "20",
        "to": "cole",
        "line": 1964
      },
      {
        "from": "25",
        "to": "cole",
        "line": 1967
      },
      {
        "from": "53",
        "to": "cole",
        "line": 1975
      },
      {
        "from": "64",
        "to": "cole\n              display ledger-level at curs with foreground-color 2\n              perform  Compute-Placement\n              move 68 to cole\n              move place (z) to ws-place\n              display ws-place at curs with foreground-color 2",
        "line": 1983
      },
      {
        "from": "2",
        "to": "gate-sw",
        "line": 2012
      },
      {
        "from": "lin",
        "to": "save-lin",
        "line": 2014
      },
      {
        "from": "1",
        "to": "cole",
        "line": 2017
      },
      {
        "from": "save-lin",
        "to": "lin",
        "line": 2023
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 2044
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 2045
      },
      {
        "from": "zero",
        "to": "ledger-pc",
        "line": 2046
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 2050
      },
      {
        "from": "spaces",
        "to": "p-c-Branches\n       else\n              move  WS-Ledger-Record  to  p-c-Branches",
        "line": 2053
      },
      {
        "from": "999999",
        "to": "pc-ledg",
        "line": 2057
      },
      {
        "from": "zero",
        "to": "pc-pc est",
        "line": 2058
      },
      {
        "from": "to-day",
        "to": "l11-date",
        "line": 2067
      },
      {
        "from": "zero",
        "to": "page-nos",
        "line": 2068
      },
      {
        "from": "usera",
        "to": "l13-user",
        "line": 2069
      },
      {
        "from": "1",
        "to": "y",
        "line": 2073
      },
      {
        "from": "zero",
        "to": "z",
        "line": 2079
      },
      {
        "from": "999999",
        "to": "WS-Ledger-Nos",
        "line": 2081
      },
      {
        "from": "z",
        "to": "ledger-pc",
        "line": 2082
      },
      {
        "from": "255",
        "to": "we-error",
        "line": 2086
      },
      {
        "from": "spaces",
        "to": "ledger-name",
        "line": 2089
      },
      {
        "from": "ledger-pc",
        "to": "l15-nos",
        "line": 2092
      },
      {
        "from": "ledger-name",
        "to": "l15-name",
        "line": 2093
      },
      {
        "from": "page-nos",
        "to": "l13-page",
        "line": 2109
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 2117
      },
      {
        "from": "5",
        "to": "line-cnt",
        "line": 2119
      },
      {
        "from": "zero",
        "to": "ws-Menu",
        "line": 2148
      },
      {
        "from": "space",
        "to": "Menu-Reply",
        "line": 2174
      },
      {
        "from": "zero",
        "to": "counter",
        "line": 2198
      },
      {
        "from": "WS-Ledger-Key9",
        "to": "ECoA-Ledger-Key9\n              move  Ledger-Type  to ECoA-Ledger-Type\n              move  Ledger-Place to ECoA-Ledger-Place\n              move  Ledger-Level to ECoA-ledger-Level\n              move  Ledger-Name  to ECoA-Ledger-Name\n              move  space        to ECoA-Filler\n              write Export-CoA-Text\n              if   fs-reply not = zero\n                   display \"Problem writing to Export File, Hit return to quit action\" at 2301\n                   accept  ws-reply at 2360\n                   perform  GL-Nominal-Close\n                   close    Saved-CoA\n                   exit perform     *> at least close files and get totals\n              end-if\n              add 1 to counter\n     end-perform\n*>\n*> Close file\n*>\n     display  \"Total record count written out = \"   at 2001",
        "line": 2215
      },
      {
        "from": "\"1\"",
        "to": "menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be Imported [12345678901234567890123456789012]\" at 1501 with\n                 foreground-color cob-color-yellow",
        "line": 2268
      },
      {
        "from": "zero",
        "to": "Counter",
        "line": 2297
      },
      {
        "from": "ECoA-Ledger-Key9",
        "to": "WS-Ledger-Key9",
        "line": 2307
      },
      {
        "from": "ECoA-Ledger-Type",
        "to": "Ledger-Type",
        "line": 2308
      },
      {
        "from": "ECoA-Ledger-Place",
        "to": "Ledger-Place",
        "line": 2309
      },
      {
        "from": "ECoA-ledger-Level",
        "to": "Ledger-Level",
        "line": 2310
      },
      {
        "from": "ECoA-Ledger-Name",
        "to": "Ledger-Name",
        "line": 2311
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 2354
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2356
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 2360
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 2367
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 2373
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 2374
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 2391
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 2393
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2396
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 2400
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 2407
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 2423
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2426
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 2430
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 2437
      },
      {
        "from": "WS-Ledger-Key9",
        "to": "WS-TBL-Ledger  (WS-TBL-Entry-Cnt)\n              move  Ledger-Name    to WS-TBL-Name    (WS-TBL-Entry-Cnt)\n     end-perform",
        "line": 2464
      },
      {
        "from": "1",
        "to": "col2",
        "line": 2494
      },
      {
        "from": "11",
        "to": "col2",
        "line": 2498
      },
      {
        "from": "zeros",
        "to": "Ledger-S-2\n                       Ledger-N-2",
        "line": 2501
      },
      {
        "from": "2",
        "to": "col2",
        "line": 2503
      },
      {
        "from": "12",
        "to": "col2",
        "line": 2510
      },
      {
        "from": "zero",
        "to": "pc-code\n     else\n              move     17 to col2\n              accept   pc-code at curs with foreground-color 3 update",
        "line": 2518
      },
      {
        "from": "WS-Ledger-Record",
        "to": "Saved-Ledger-Record",
        "line": 2527
      },
      {
        "from": "Ledger-N-2",
        "to": "Ledger-N",
        "line": 2535
      },
      {
        "from": "Ledger-S-2",
        "to": "Ledger-S",
        "line": 2536
      },
      {
        "from": "PC-Code",
        "to": "Ledger-PC",
        "line": 2537
      },
      {
        "from": "Saved-Ledger-Record",
        "to": "WS-Ledger-Record",
        "line": 2552
      },
      {
        "from": "Ledger-N-2",
        "to": "Ledger-N",
        "line": 2553
      },
      {
        "from": "Ledger-S-2",
        "to": "Ledger-S",
        "line": 2554
      },
      {
        "from": "PC-Code",
        "to": "Ledger-PC",
        "line": 2555
      },
      {
        "from": "Saved-Ledger-Record",
        "to": "WS-Ledger-Record\n              perform  GL-Nominal-Delete",
        "line": 2566
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*>  This is a Cobol text file that is Im/Exported.\n*>\n     select  Saved-CoA      assign       Archive-Name\n                            organization line sequential\n                            status       fs-reply.\n*>\n copy \"selprint.cob\".\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n fd  Saved-CoA.\n 01  Export-CoA-Text.\n     03  ECoA-Ledger-Key9  pic 9(8).\n     03  ECoA-Ledger-Type  pic 9.\n     03  ECoA-Ledger-Place pic x.\n     03  ECoA-Ledger-Level pic 9.\n     03  ECoA-filler       pic x.\n     03  ECoA-Ledger-Name  pic x(24).\n*>\n copy \"fdprint.cob\" replacing ==x(132)== by ==x(100)==.\n*>\n working-storage section.\n*>----------------------\n*>\n 77  prog-name           pic x(15)       value \"GL030 (3.02.17)\".\n copy \"print-spool-command.cob\".\n 77  gate-sw             pic 9           value 1.  *> removed ALTER verb - obsolete.\n     88  DoClear                         value 1.\n     88  AskClear                        value 2.\n*>\n copy \"wsmaps03.cob\".\n copy \"glwspc.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsledger.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n*>     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  work-fields.\n     03  ws-reply        pic x.\n     03  Ws-Menu         pic 9.\n     03  Menu-Reply      pic x.\n     03  ws-codes        pic x.\n     03  ws-num          pic 9.\n     03  line-cnt        binary-char     value zero.\n     03  page-nos        binary-char     value zero.\n     03  counter         pic 9(4).\n     03  seek            pic x.\n     03  a               pic 9.\n     03  i               pic 9.\n     03  xx              pic 99.\n     03  y               pic 999.\n     03  z               pic 99.\n     03  est             pic 99.\n     03  ws-ledger-desc  pic x(7).\n     03  ws-place        pic x(13).\n     03  Archive-Name    PIC X(32)     VALUE \"glcoa-archived.txt\".\n*>\n *>    03  ws-env-columns  pic 999       value zero.\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n *>    03  ws-columns      binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>\n*>     03  ws-show-lines   binary-char unsigned value zero.\n*>     03  ws-amend-lines  binary-char unsigned value zero.\n*>     03  ws-setup-lines  binary-char unsigned value zero.\n*>     03  ws-accept-lines binary-char unsigned value zero.\n\n 01  accept-terminator-array pic 9(4)   value zero.\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY008           pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY010           pic x(46) value \"SY010 Terminal program not set to length => 24\".\n*> Module specific\n     03  GL031           pic x(44) value \"GL031 A code for Establishment must be input\".\n     03  GL032           pic x(51) value \"GL032 Error! Ledger Code must be not less than 1000\".\n     03  GL033           pic x(30) value \"GL033 No Ledger File to update\".\n     03  GL034           pic x(44) value \"GL034 Rewrite Error-01. Hit return to finish\".\n     03  GL035           pic x(55) value \"GL035 Deletion Request Denied! Current Balance Not Zero\".\n     03  GL036           pic x(32) value \"GL036 Ledger File Does Not Exist\".\n     03  GL037           pic x(45) value \"GL037 Account has postings - Request rejected\".\n     03  GL038           pic x(43) value \"GL038 Invalid! Code must be numeric or <n*>\".\n     03  GL039           pic x(21) value \"GL039 Does not exist!\".\n     03  GL03A           pic x(38) value \"GL03A Requested account already exists\".\n     03  GL03B           pic x(50) value \"GL03B Got error on writing new GL record, reply = \".\n*>\n 01  ledger-codes.\n     03  name-test.\n         05  first-char  pic x.\n         05  filler      pic x(23).\n     03  ledger-test     pic 9(5).\n     03  ledger-check.\n         05  ledger-first-four.\n             07  ledger-first  pic 9.\n             07  filler        pic 999.\n         05  ledger-sub  pic 99.\n     03  filler  redefines  ledger-check.\n         05  filler      pic 9.\n         05  header-1    pic 999.\n         05  filler      pic 99.\n     03  filler  redefines  ledger-check.\n         05  filler      pic 99.\n         05  header-2    pic 99.\n         05  filler      pic 99.\n     03  filler  redefines  ledger-check.\n         05  filler      pic 999.\n         05  header-3    pic 9.\n         05  filler      pic 99.\n     03  pc-code.\n         05  pc-code1    pic x.\n         05  pc-code2    pic x.\n     03  numeric-key.\n         05  filler      pic x(4)          value \"0000\".\n         05  n-code      pic 9(6).\n         05  n-pc        pic 99.\n     03  truth           pic 9.\n         88  a-true                        value  1.\n         88  a-false                       value  0.\n*>\n     03  Save-N          pic 9(4).\n     03  Save-S          pic 99.\n     03  Save-H-1        pic 999.\n     03  Save-H-2        pic 99.\n     03  Save-H-3        pic 9.\n     03  A-Test          pic x.\n     03  Save-Type       pic 9.\n     03  Save-Place      pic x.\n     03  Save-Code       pic xx.\n     03  Save-Lin        pic 99.\n     03  Save-Ledger     pic 9(6).\n     03  Ledger-N-2      pic 9(4)      value zero.  *> Used in zz200\n     03  Ledger-S-2      pic 99        value zero.  *> Used in zz200\n*>\n     03  types.\n         05  filler      pic x(7)      value \"Header \".\n         05  filler      pic x(7)      value \"Detail \".\n         05  filler      pic x(7)      value \"Sales  \".\n         05  filler      pic x(7)      value \"Purch. \".\n         05  filler      pic x(7)      value \"Special\".\n     03  filler  redefines  types.\n         05  ledger-desc pic x(7)       occurs  5.\n*>\n     03  account-placement.\n       05  filler        pic x(13)     value \"Direct Income\".\n       05  filler        pic x(13)     value \"Direct Costs \".\n       05  filler        pic x(13)     value \"Sundry Income\".\n       05  filler        pic x(13)     value \"Indirect Cost\".\n       05  filler        pic x(13)     value \"Fixed Assets \".\n       05  filler        pic x(13)     value \"Current Asset\".\n       05  filler        pic x(13)     value \"Current Liab.\".\n       05  filler        pic x(13)     value \"Capital A/Cs \".\n     03  filler  redefines  account-placement.\n       05  place         pic x(13)      occurs  8.\n*>\n*>  Table for holding a/c keys and names sorted by name\n*>   used by print alpha order process as Alt. key not set up.\n*>\n 01  WS-TBL-Ledgers                         value high-values.    *> so sorting keep unused to the end of table.\n     03  WS-TBL-Group            occurs 2000.\n         05  WS-TBL-Ledger pic 9(8).\n         05  WS-TBL-Name   pic x(24).\n*>\n 01  WS-TBL-Ledgers-Size   pic s9(4)   comp value 2000.   *> as in above occurs and MUST be the same.\n 01  WS-TBL-Entry-Cnt      pic s9(4)   comp value zero.\n 01  WS-TBL-Sub            pic s9(4)   comp value zero.\n*>\n*> Hold old a/c rec when using F8 / F9.\n*>\n copy \"wsledger.cob\"     replacing WS-Ledger-Record by Saved-Ledger-Record\n                                 leading  ==Ledger==       by ==Saved-Ledger==\n                                 ==Quarters==     by ==Saved-Quarters==\n                                 WS-Ledger-Key    by WS-Saved-Ledger-Key\n                                 WS-Ledger-Key9   by WS-Saved-Ledger-Key9\n                                 WS-Ledger-Nos    by WS-Saved-Ledger-Nos.\n*>\n 01  print-lines.\n     03  line-1.                   *> Len = 100\n       05  l1-prog         pic x(15).\n       05  filler          pic x(27)     value spaces.\n       05  filler          pic x(17)     value \"Chart of Accounts\".\n       05  filler          pic x(31)     value spaces.\n       05  l1-date         pic x(10).\n*>\n     03  line-3.                   *> Len = 100\n       05  l3-user         pic x(32).\n       05  filler          pic x(60)     value spaces.\n       05  filler          pic x(6)      value \"Page -\".\n       05  l3-page         pic z9.\n*>\n     03  line-4.                   *> Len = 100\n       05  filler          pic x(24)     value \"----------Name----------\".\n       05  filler          pic x(36)     value \"---Level---   Header       Detail   \".\n       05  l4-filler-1     pic x(4)      value spaces.\n       05  l4-filler-2     pic x(17)     value spaces.\n       05  filler          pic x(19)     value \"--Placement--\".\n*>\n     03  line-5.                   *> Len = 100\n       05  l5-name         pic x(24).\n       05  l5-level-filler pic x(10).\n       05  filler  redefines  l5-level-filler.\n         07  l5-level      pic 9          occurs 10.\n       05  filler          pic x(3)       value spaces.\n       05  l5-header       pic zzz9.99    blank when zero.\n       05  filler          pic x(7)       value spaces.\n       05  l5-detail       pic zzz9.99    blank when zero.\n       05  filler          pic x(6)       value spaces.\n       05  l5-pc           pic b(5)z9     blank when zero.\n       05  filler          pic x(10)      value spaces.\n       05  l5-placement    pic x(13).\n       05  filler          pic x(6)       value spaces.\n*>\n     03  line-6.                   *> Len = 100\n       05  filler          pic x(36)     value \"---Level---   Header       Detail   \".\n       05  l6-filler-1     pic x(4)      value spaces.\n       05  l6-filler-2     pic x(17)     value spaces.\n       05  filler          pic x(43)     value \"--Placement--      ----------Name----------\".\n*>\n     03  line-7.                   *> Len = 100\n       05  l7-level-filler pic x(10).\n       05  filler  redefines  l7-level-filler.\n         07  l7-level      pic x          occurs 10.\n       05  filler          pic x(3)       value spaces.\n       05  l7-header       pic zzz9.99    blank when zero.\n       05  filler          pic x(7)       value spaces.\n       05  l7-detail       pic zzz9.99    blank when zero.\n       05  filler          pic x(6)       value spaces.\n       05  l7-pc           pic b(5)z9     blank when zero.\n       05  filler          pic x(10)      value spaces.\n       05  l7-placement    pic x(13).\n       05  filler          pic x(6)       value spaces.\n       05  l7-name         pic x(24).\n*>\n     03  line-11.                   *> Len = 100\n       05  l11-prog        pic x(15).\n       05  filler          pic x(29)     value spaces.\n       05  filler          pic x(14)     value \"Profit Centres\".\n       05  filler          pic x(32)     value spaces.\n       05  l11-date        pic x(10).\n*>\n     03  line-13.                   *> Len = 100\n       05  l13-user        pic x(32).\n       05  filler          pic x(60)     value spaces.\n       05  filler          pic x(6)      value \"Page -\".\n       05  l13-page        pic z9.\n*>\n     03  line-14.\n       05  filler          pic x(36)     value \"Number        Name\".\n*>\n     03  line-15.\n       05  l15-nos         pic z9.\n       05  filler          pic x(10)     value spaces.\n       05  l15-name        pic x(32).\n*>\n 01  dummy-record          pic x(128).\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day                pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n init01 section.\n*>*************\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n*>\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              display SY010    at 0101 with erase eos\n              accept  ws-reply at 0133\n              goback\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     move     1  to File-Key-No.\n*>\n Menu-Input.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Chart Of Account Utilities\" at 0128 with foreground-color 2.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 3.\n*>\n     display  \"Select one of the following by number :- [ ] or by Function key\" at 0801\n                 with foreground-color 2.\n*>\n     move     10 to  lin.\n     move     2  to  a.\n*>\n     if       Profit-Centres or Branches\n              move  1  to  a\n              perform displaya.\n*>\n     if       Profit-Centres    *>gl030a  Est  Opt=1\n              display \"Set-up or Amend Profit Centres\" at curs with foreground-color 2\n              add  1  to  lin.\n*>\n     if       Branches          *>gl030a  Est  Opt=1\n              display \"Set-up or Amend Branch Codes\" at curs with foreground-color 2\n              add  1  to  lin.\n*>\n      move     2  to  a.\n     perform  displaya.         *> gl030b  Opt=2\n     display  \"Add New Accounts\" at curs with foreground-color 2.\n     add      1  to  lin.\n*>\n      move     3  to  a.\n     perform  displaya.         *> gl030c  Opt=3\n     display  \"Amend/Delete Existing Accounts\" at curs with foreground-color 2.\n     add      1  to  lin.\n*>\n     if       index-2           *> gl030e  Opt=4  *> don't need the test as not using alt keys\n              move  4  to  a\n              perform displaya\n              display \"Print Alphabetic List\" at curs with foreground-color 2\n              add 1  to  lin.\n*>\n     move  5  to  a\n     perform  displaya.         *> gl030f  Opt=5\n     display  \"Display Chart of Accounts\" at curs with foreground-color 2.\n     add      1  to  lin.\n*>\n     move  6  to  a\n     perform  displaya.         *>         Opt=6\n     display  \"Print Chart of Accounts\" at curs  with foreground-color 2.\n     add      1  to  lin.\n*>\n     if       Profit-Centres     *> gl030g  PC OR Branches    Opt=7\n               move  7  to  a\n              perform displaya\n              display \"Print Report on Profit Centres\" at curs with foreground-color 2\n              add   1 to lin.\n*>\n     if       Branches\n               move  7  to  a\n              perform displaya\n              display \"Print Report on Branch Codes\" at curs with foreground-color 2.\n*>\n     add      1  to  lin.\n*>\n     move  8  to  a\n     perform  displaya.        *> gl030??   Import   opt=8\n     display  \"Import/Export Chart of Accounts from a Text file\" at curs with foreground-color 2.\n*>\n     add      3  to  lin\n     move     9  to  a.\n*>\n     perform  displaya.\n     display  \"Exit to system menu\" at curs with foreground-color 2.\n*>\n     accept   ws-menu at 0843  with foreground-color 6 auto.\n*>\n     if       ws-menu = 9\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  menu-exit.\n*>\n *>    if       p-c = space           *> WHY ON EARTH IS THIS DONE ????\n *>             add  1  to  ws-menu.\n*>\n     if       ws-menu = 1         *> PC setup or Branch setup\n           or Cob-Crt-Status = Cob-Scr-F1\n              perform gl030a\n              go to Menu-Input.\n     if       ws-menu = 2         *> CoA set up\n           or Cob-Crt-Status = Cob-Scr-F2\n              perform gl030b\n              go to Menu-Input.\n     if       ws-menu = 3         *> Update CoA\n           or Cob-Crt-Status = Cob-Scr-F3\n              perform gl030c\n              go to Menu-Input.\n *>    if       not  index-2\n *>             add  1  to  ws-menu.\n     if       ws-menu = 4         *> Alpha listing\n           or Cob-Crt-Status = Cob-Scr-F4\n              perform gl030e\n              go to Menu-Input.\n     if       ws-menu = 5  or  = 6\n           or Cob-Crt-Status = Cob-Scr-F5 or Cob-Scr-F6\n              perform gl030f\n              go to Menu-Input.\n*>\n     if       ws-menu = 7         *> Print PC or Branches\n           or Cob-Crt-Status = Cob-Scr-F7\n              perform gl030g.\n     if       ws-menu = 8\n           or Cob-Crt-Status = Cob-Scr-F8\n              perform gl030h.\n*>\n     go       to Menu-Input.\n*>\n menu-exit.\n     goback.\n*>\n displaya.\n     move     1 to cole.\n     display  \"(\" at curs with foreground-color 2.\n     move     2 to cole.\n     display  a at curs with foreground-color 2.\n     move     3 to cole.\n     display  \")\" at curs with foreground-color 2.\n     move     6 to cole.\n*>\n gl030a section.       *> Set up Branches or PC (1)\n*>*************\n*>\n main.\n     perform  GL-Nominal-Open-Input.          *> open input ledger-file.\n     if       fs-reply not = zero\n              perform  GL-Nominal-Open-Output      *>  open  output  ledger-file\n              initialise WS-Ledger-Record\n              move low-values to ledger-name\n              move  999999 to  WS-Ledger-nos\n              move  99     to  ledger-pc\n              move zeros to ledger-type Ledger-Place ledger-level\n                   ledger-balance ledger-last ledger-q1 ledger-q2\n                   ledger-q3 ledger-q4\n              perform  GL-Nominal-Write.      *> write WS-Ledger-Record.\n*>\n main-continue.\n     perform  GL-Nominal-Close.               *> close ledger-file.\n     perform  GL-Nominal-Open.                *> open i-o ledger-file.\n*>\n     move     999999 to  WS-Ledger-nos.\n     move     zero   to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.   *> read ledger-file  record invalid  key\n     if       fs-reply = 21\n              move     255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces  to  p-c-Branches\n     else\n              move  WS-Ledger-Record  to  p-c-Branches.\n*>\n     move     999999  to  pc-ledg.\n     move     zero    to  pc-pc est.\n*>\n     set      pc  to  1.\n     search   p-b-codes\n              when p-b-codes (pc) = \"E\"  set est to pc.\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n     if       Profit-Centres\n              display \"Set-Up for Profit Centres\" at 0127 with foreground-color 2\n      else\n              display \"Set-Up for Branches\" at 0130 with foreground-color 2.\n*>\n Est-Input.\n     display  \"Establishment Code :- [  ]\" at 0401  with foreground-color 2.\n     display  est at 0424 with foreground-color 2.\n     accept   est at 0424 with foreground-color 3 update.\n*>\n     if       est = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n              display GL031 at 0501 with foreground-color 2\n              go to Est-Input.\n*>\n     move     \"E\" to p-b-codes (est).\n     display  space at 0501 with erase eol.\n*>\n re-input.\n     move     7  to  lin.\n     move     1  to  cole y.\n*>\n Loop.\n     move     curs to curs2.\n     display  y at curs2 with foreground-color 2.\n     add      3 to col2.\n     display  \". [\" at curs2 with foreground-color 2.\n     add      3 to col2.\n     move     p-b-codes (y) to ws-codes.\n     display  ws-codes at curs2 with foreground-color 3.\n     add      1 to col2.\n     display  \"]\" at curs2 with foreground-color 2.\n     add      1  to  lin.\n     add      1  to  y\n     if       lin  <  ws-23-lines  and  y  <  100\n              go to  Loop.\n     if       y  <  100\n              move  7  to  lin\n              add  11  to  cole\n              go to  Loop.\n*>\n     move     7  to  lin  cole.\n     move     1  to  y.\n*>\n     display  \"Enter <Y> to select the code. Space to de-select\" &\n              \" the code.<Q> to finish\" at line ws-23-lines col 1  with foreground-color 2.\n*>\n Loop-2.\n     if       p-b-codes (y) = \"E\"\n              go to  Loop-2-return.\n*>\n p-c-b-accept.\n     move     p-b-codes (y) to ws-codes.\n     accept   ws-codes at curs with foreground-color 3 update.\n     move     function upper-case (ws-codes) to ws-codes.\n     move     ws-codes to p-b-codes (y).\n     if       ws-codes = \"Q\"\n              move  space  to  p-b-codes (y)\n              go to  p-c-b-end.\n     if       p-b-codes (y) = space or = \"Y\"\n              next sentence\n       else\n              go to  p-c-b-accept.\n*>\n Loop-2-return.\n     add      1  to  lin.\n     add      1  to  y\n     if       lin  <  ws-23-lines and  y  <  100\n              go to  Loop-2.\n     if       y  <  100\n              move  7  to  lin\n              add  11  to cole\n              go to  Loop-2.\n*>\n p-c-b-end.\n     display  space at line ws-23-lines col 01 with erase eol.\n     display  \"Details OK to save ? (Y/N) :- [Y]\" at line ws-23-lines col 01 with foreground-color 2.\n     move     \"Y\"  to  ws-reply.\n     accept   ws-reply at line ws-23-lines col 32 with foreground-color 6 update.\n*>\n     if       ws-reply = \"N\" or \"n\"\n              go to  re-input.\n*>\n     move     spaces  to  WS-Ledger-Record.\n     string   p-c-Branches  delimited  by size\n              into  WS-Ledger-Record.\n*>\n     if       we-error = 255\n              perform   write-ledger\n     else\n              perform   rewrite-ledger.\n*>\n     move     zero  to  we-error.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n     if       Profit-Centres\n              display \"Name the Profit Centres\" at 0128 with foreground-color 2\n     else\n              display \"Name the Branches\" at 0131 with foreground-color 2.\n*>\n     move     4  to  lin.\n     move     1  to  y.\n     move     zero to ledger-pc  ledger-type ledger-balance\n                      ledger-last ledger-q1 ledger-q2 ledger-q3\n                      ledger-q4.\n*>\n     move     space  to  Ledger-Place.\n*>\n Loop-3.\n     if       p-b-codes (y)  = space\n              go to  Loop-3-return.\n*>\n     move     y  to  z.\n     move     999999 to  WS-Ledger-Nos.\n     move     z      to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.       *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces  to  ledger-name.\n*>\n Loop-3-back.\n     move     1 to cole.\n     display  \"Code - \" at curs with foreground-color 2.\n     move     8 to cole.\n     display  y at curs with foreground-color 2.\n     move     11 to cole.\n     display  \" Name :- [\" at curs with foreground-color 2.\n     move     45 to cole.\n     display  \"]\" at curs with foreground-color 2.\n     move     21 to cole.\n     display  ledger-name at curs with foreground-color 2.\n     accept   ledger-name at curs with foreground-color 3 update.\n*>\n     if       ledger-name = \"QUIT\" OR = \"quit\"\n        or    cob-crt-status = cob-scr-esc\n              go to  Loop-3-end.\n*>\n     if       we-error = 255\n              and  ledger-name = space\n              go to  Loop-3-back.\n*>\n     if       we-error = 255\n              perform   write-ledger\n     else\n              perform   rewrite-ledger.\n*>\n     move     zero  to  we-error.\n     add      1  to  lin.\n*>\n Loop-3-return.\n     add      1  to  y.\n     if       y  >  99\n              go to  Loop-3-end.\n*>\n     if       lin  <  ws-22-lines\n              go to  Loop-3.\n*>\n     move     4  to  lin.\n     move     1 to cole.\n*>\n Loop-3-clear.\n     display  space at curs with erase eol.\n     add      1  to  lin.\n     if       lin  <  ws-22-lines\n              go to  Loop-3-clear.\n*>\n     move     4  to  lin.\n     go       to Loop-3.\n*>\n write-ledger.\n     perform  GL-Nominal-Write.       *>  write WS-Ledger-Record.\n*>\n rewrite-ledger.\n     perform  GL-Nominal-Rewrite.     *> rewrite WS-Ledger-Record.\n*>\n Loop-3-end.\n     perform  GL-Nominal-Close.       *> close ledger-file.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n gl030b section.    *> CoA set up for PC, Branch or none.\n*>*************\n*>\n     perform  GL-Nominal-Open-Input.      *> open input ledger-file.\n     if       fs-reply not = zero\n              perform main in gl030a.\n     perform  GL-Nominal-Close.           *> close ledger-file.\n     perform  GL-Nominal-Open.            *> open i-o ledger-file.\n*>\n     if       not  Profit-Centres\n          and not  Branches\n              go to  by-pass-pc.\n*>\n     move     999999 to  WS-Ledger-Nos.\n     move     zero   to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *> read ledger-file  record invalid  key\n     if       fs-reply = 21\n              move     255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces  to  p-c-Branches\n     else\n              move  WS-Ledger-Record  to  p-c-Branches.\n*>\n     move     999999  to  pc-ledg.\n     move     zero    to  pc-pc est.\n*>\n     set      pc  to  1.\n     search   p-b-codes when  p-b-codes (pc)  =  \"E\"  set   est  to  pc.\n*>\n by-pass-pc.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  to-day at 0171 with foreground-color 2.\n*>\n get-input.\n     display  \"Chart of Accounts Set-Up\" at 0129  with foreground-color 2.\n     display  \"Ledger    Sub\" at 0401 with foreground-color 2.\n*>\n     if       Profit-Centres\n              display \"P/C\" at 0417 with foreground-color 2.\n     if       Branches\n              display \"Branch\" at 0415 with foreground-color 2.\n     display  \"-----------Name-----------  Type  Placement  Level\" at 0423 with foreground-color 2.\n     move     6  to  lin.\n*>\n Loop.\n     move     1 to cole.\n     display  \"[    ]   [  ]\" at curs with foreground-color 2.\n*>\n     if       Profit-Centres  or  Branches\n              move 16 to cole\n              display \"[  ]\" at curs with foreground-color 2.\n*>\n     move     23 to cole.\n     display  \"[\" at curs with foreground-color 2.\n     move     48 to cole.\n     display  \"]  [ ]      [ ]      [ ]\" at curs with foreground-color 2.\n*>\n     move     zero  to  ledger-n ledger-s.\n*>\n Accept-Ledger.\n     move     2 to cole.\n     accept   ledger-n at curs with foreground-color 3 update.\n     if       ledger-n = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  main-end.\n*>\n     move     curs to curs2.\n     add      1 to lin2.\n     move     1 to col2.\n     if       ledger-n  <  1000\n              display GL032 at curs2  with foreground-color 2\n              go to  Accept-Ledger.\n*>\n     display  space at curs2 with erase eol.\n*>\n     move     11 to cole.\n     accept   ledger-s at curs with foreground-color 3 update.\n*>\n     move     WS-Ledger-Nos  to  ledger-check.\n     if       ledger-first = sales-range\n        or    purchase-range\n              display \"Invalid start number!\" at curs2 with foreground-color 2 erase eol\n              go to  Accept-Ledger.\n*>\n     if       ledger-first-four = \"9999\"\n              display \"<9999>  Is reserved!\" at curs2 with foreground-color 2 erase eol\n              go to  Accept-Ledger.\n*>\n accept-pc.\n     if       not Profit-Centres and not Branches\n              move  zero  to  ledger-pc\n              go to  accept-name.\n*>\n     move     spaces  to  pc-code.\n     move     17 to cole.\n     accept   pc-code at curs with foreground-color 2 update.\n     perform  PC-Code-Check thru PC-Code-Check-exit.\n*>\n     if       a-false\n              move 17 to col2\n              display \"Invalid! Code must be numeric or <n*>.\" at curs2 with foreground-color 2 erase eol\n              go to  accept-pc.\n*>\n accept-name.\n     display  space at curs2 with erase eol.\n     move     24 to cole.\n     move     spaces to ledger-name.\n     accept   ledger-name at curs with foreground-color 3 update.\n*>\n accept-type.\n     if       ledger-sub  not = zero\n              go to  accept-end.\n*>\n     move     52 to cole.\n     move     zero to ledger-type.\n *>    display  \"0\" at curs with foreground-color 2.\n     accept   ledger-type at curs with foreground-color 3 update.\n*>\n     if       ledger-type  not = zero  and  1  and  9\n              move 52 to col2\n              display \"Invalid type! [0,1 & 9]\" at curs2 with foreground-color 2 erase eol\n              go to  accept-type.\n     display  space at curs2 with erase eol.\n*>\n accept-placement.\n     move     61 to cole.\n     display  space at curs.\n*>\n     if       ledger-type  not = zero\n              go to  accept-end.\n*>\n     move     space to ws-reply.\n     accept   ws-reply at curs with foreground-color 3 update.\n     move     function upper-case (ws-reply) to Ledger-Place.\n     if       Ledger-Place  <  \"A\"  or  >  \"Z\"\n              move 61 to col2\n              display \"Invalid Placement! [A - Z]\" at curs2 with foreground-color 2 erase eol\n              go to  accept-placement.\n*>\n     if       revenue-only  and  Ledger-Place >  \"N\"\n       and    pc-code  not = \"00\"\n              move 61 to col2\n              display \"PC/BR, Revenue only [A - N]\"  at curs2 with foreground-color 2\n              go to  Accept-Ledger.\n*>\n accept-header.\n     move     zero  to  ledger-level.\n*>\n     move     70 to cole col2.\n *>    display  space at curs.\n     accept   ledger-level at curs with foreground-color 3 update.\n*>\n     if       ledger-level  <  1  or  >  4\n              display \"Invalid! [1 - 4]\" at curs2 with foreground-color 2 erase eol\n              go to  accept-header.\n*>\n accept-end.\n     move     zero  to  ledger-balance  ledger-last\n                        ledger-q1       ledger-q2\n                        ledger-q3       ledger-q4.\n*>\n     if       ledger-s  not = zero\n              move  ledger-s  to  save-s\n              perform  detail-check\n       else\n              perform  header-check.\n*>\n     move     52 to cole.\n     display  ledger-type at curs with foreground-color 2.\n     move     70 to cole.\n     display  ledger-level at curs with foreground-color 2.\n*>\n     if       a-true\n              go to  Accept-Ledger\n       else\n              go to  Loop-end.\n*>\n detail-check.\n     move     zero  to  ledger-sub.\n     move     \"D\"  to  a-test.\n*>\n     perform  ledger-read.\n*>\n     move     space to  a-test.\n     move     save-s  to  ledger-sub  ledger-s.\n*>\n     if       a-false\n              move 1 to col2\n              display \"INVALID! Header Missing '1'\" at curs2 with foreground-color 2 with erase eol\n              move  1  to  truth\n       else\n              perform  ledger-read.\n*>\n     if       ledger-type  not = 9\n              move  1  to  ledger-type.\n*>\n     move     zero  to  ledger-level.\n*>\n header-check.\n     if       header-1 = 0\n              perform   ledger-read\n              move      1  to  ledger-level.\n*>\n     if       header-1  not = 0\n       and    header-2 = 0\n              move      2  to  ledger-level\n              move      header-1  to  save-h-1\n              move      zero      to  header-1\n              perform   ledger-read\n              move      save-h-1  to  header-1\n              if        a-true\n                        perform  ledger-read\n                 else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '2'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth.\n*>\n     if       header-2  not = 0\n       and    header-3 = 0\n              move      3  to  ledger-level\n              move      header-2  to  save-h-2\n              move      zero      to  header-2\n              perform   ledger-read\n              move      save-h-2  to  header-2\n              if        a-true\n                        perform  ledger-read\n                   else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '3'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth.\n*>\n     if       header-3  not = 0\n              move      4  to  ledger-level\n              move      header-3  to  save-h-3\n              move      zero      to  header-3\n              perform   ledger-read\n              move      save-h-3  to  header-3\n              if        a-true\n                        perform  ledger-read\n               else\n                        move 1 to col2\n                        display \"INVALID! Header Missing '4'\" at curs2 with foreground-color 2 with erase eol\n                        move  1  to  truth.\n*>\n Loop-end.\n     if       pc-code2 = \"*\"\n              go to  multi-add.\n*>\n     move     pc-code  to  y.\n     perform  ledger-write.\n     go       to addition-end.\n*>\n multi-add.\n     move     zero  to  ledger-pc  y.\n*>\n     if       pc-code1 = \"*\"\n              move  1  to  y\n              perform  Loop-add  99  times\n              go to  addition-end.\n*>\n     move     pc-code1  to  y.\n     multiply y  by  10  giving  y.\n*>\n     if       y  >  0\n              perform  Loop-add  10  times\n       else\n              add  1  to  y\n              perform  Loop-add  9   times.\n*>\n     go       to addition-end.\n*>\n Loop-add.\n     if       p-b-codes (y) = \"E\"  or  \"Y\"\n              perform  ledger-write.\n*>\n     add      1  to  y.\n*>\n addition-end.\n     move     zero  to  y.\n     perform  ledger-write.\n*>\n     add      1 to  lin.\n     move     1 to cole.\n     display  space at curs with erase eol.\n     display  space at line ws-23-lines col 01 with erase eol.\n*>\n     if       lin  <  ws-22-lines\n              go to  Loop.\n*>\n     move     6  to  lin.\n     move     1 to cole.\n*>\n screen-clear.\n     display  space at curs with erase eol.\n     add      1  to  lin.\n*>\n     if       lin  <  ws-22-lines\n              go to  screen-clear\n      else\n              move  6  to  lin\n              go to  Loop.\n*>\n main-end.\n     perform  GL-Nominal-Close.     *> close ledger-file.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ledger-read.\n*>**********\n*>\n*> Set status false initialy. If record exists set to true.\n*>\n     move     zero  to  truth.\n     move     ledger-check  to  WS-Ledger-Nos.\n     move     WS-Ledger-Nos  to  n-code.\n*>\n     if       pc-code2 = \"*\"\n              move     \"00\"  to  n-pc\n              move     \"00\"  to  ledger-pc\n     else\n              move     pc-code     to  n-pc  ledger-pc.\n\n     move     WS-Ledger-Record  to  dummy-record.\n     move     zero  to  we-error.\n*>\n     perform  GL-Nominal-Read-Indexed.      *> read ledger-file  record  invalid\n     if       fs-reply = 21\n              move  255  to  we-error.\n     if       we-error  not = 255\n              move  1  to  truth.\n*>\n     if       a-test = \"D\"\n              move  Ledger-Place to  save-place\n              if    ledger-type  numeric\n                    move  ledger-type  to  save-type\n              else\n                    move  zero  to  save-type.\n*>\n     move     dummy-record  to  WS-Ledger-Record.\n*>\n     if       a-test = \"D\"\n              move  save-type  to  ledger-type\n              move  save-place to  Ledger-Place.\n*>\n ledger-write.\n     move     WS-Ledger-Nos  to  n-code.\n     move     y to  n-pc  ledger-pc.\n*>\n     perform  GL-Nominal-Write.      *>  write WS-Ledger-Record.\n*>\n PC-Code-Check.\n     move     1  to  truth.\n*>\n     if       pc-code = spaces\n              move  \"00\"  to  pc-code.\n     if       pc-code = \"**\"\n              go to  PC-Code-Check-exit.\n*>\n     if       pc-code  not <  \"00\"  and  not >  \"99\"\n              go to  PC-Code-Check-exit.\n*>\n     if       pc-code2  not = \"*\"\n              move   zero  to  truth\n              go to  PC-Code-Check-exit.\n*>\n     if       pc-code1  not <  \"0\"  and  not >  \"9\"\n              go to  pc-code-main-check\n     else\n              move   zero  to  truth\n              go to  PC-Code-Check-exit.\n*>\n pc-code-main-check.\n     if       pc-code2  not = \"*\"\n              move   pc-code  to  z\n              if     p-b-codes (z) = \"E\"  or  \"Y\"\n                     go to  PC-Code-Check-exit\n                else\n                     move   zero  to  truth\n                     go to  PC-Code-Check-exit.\n*>\n     move     pc-code1  to  z.\n     multiply z  by  10  giving  z.\n     move     zero  to  truth.\n*>\n     if       z  >  0\n              perform aloop  10  times\n       else\n              add  1  to  z\n              perform aloop  9   times.\n*>\n     go       to PC-Code-Check-exit.\n*>\n aloop.\n     if       p-b-codes (z) = \"E\"  or  \"Y\"\n              move  1  to  truth.\n*>\n     add      1  to  z.\n*>\n PC-Code-Check-exit.\n     exit.\n*>\n gl030c section.      *> CoA update\n*>*************\n*>\n*> New (29/05/18) Support for Esc, F8 and F9 on accept Name.\n*>\n     perform  GL-Nominal-Open-Input.      *> open input ledger-file as cant do I/O - it might create.\n     if       fs-reply not = zero\n              display space\n              display GL033 at 0901 with foreground-color 2\n              go to main-exit.\n     perform  GL-Nominal-Close.     *> close ledger-file.\n     perform  GL-Nominal-Open.            *> open i-o ledger-file.\n*>\n     if       not  Profit-Centres\n       and    not  Branches\n              go to  by-pass-pc.\n*>\n     move     999999  to  WS-Ledger-Nos.\n     move     zero    to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *> read ledger-file  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces            to  p-c-Branches\n       else\n              move  WS-Ledger-Record  to  p-c-Branches.\n*>\n by-pass-pc.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.                                    *> to users format.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n get-input.\n     display  \"Chart Of Accounts Amend\" at 0129 with foreground-color 2.\n     display  \"Ledger    Sub\" at 0401 with foreground-color 2.\n     if       Profit-Centres\n              display \"P/C\" at 0417 with foreground-color 2.\n     if       Branches\n              display \"Branch\" at 0415 with foreground-color 2.\n     display  \"-----------Name-----------  Type  Placement  Level\" at 0423 with foreground-color 2.\n     move     6  to  lin.\n*>\n Loop.\n     move     1 to cole.\n     display  \"[    ]\" at curs with foreground-color 2 erase eol.\n     move     11 to cole.\n     display  \"[  ]\" at curs with foreground-color 2.\n*>\n     if       Profit-Centres  or  Branches\n              move 16 to cole\n              display \"[  ]\" at curs with foreground-color 2.\n*>\n     move     23 to cole.\n     display  \"[\" at curs with foreground-color 2.\n     move     48 to cole.\n     display  \"]  [ ]      [ ]      [ ]\" at curs with foreground-color 2.\n*>\n Accept-Ledger.\n     move     zeros to WS-Ledger-Nos.\n     move     2 to cole.\n     accept   ledger-n at curs with foreground-color 3 update.\n*>\n     if       ledger-n = zero\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  main-end.\n*>\n     move     12 to cole.\n     accept   ledger-s at curs with foreground-color 3 update.\n*>\n accept-pc.\n     move     lin to lin2.\n     add      1 to lin2.\n     if       not  Profit-Centres\n          and not  Branches\n              move  zero  to  pc-code\n              go to  A-Test-Key.\n*>\n     move     17 to cole.\n     accept   pc-code at curs with foreground-color 3 update.\n     perform  PC-Code-Check thru PC-Code-Check-exit.\n*>\n     move     17 to col2.\n     if       a-false\n              display GL038 at curs2 with foreground-color 2\n              go to  accept-pc.\n*>\n A-Test-Key.\n     display  space at curs2 with erase eol.\n     move     1 to col2.\n*>\n     move     zero        to  we-error.\n*>\n     if       pc-code2 = \"*\"\n              move  \"A\"  to  a-test\n              move  pc-code  to  save-code\n              move  \"00\"  to  pc-code.\n     move     pc-code     to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *> read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = 255\n              move 1 to col2\n              display WS-Ledger-Nos at curs2 with foreground-color 2\n              move 7 to col2\n              display \"/\"       at curs2 with foreground-color 2\n              move 8 to col2\n              display ledger-pc at curs2 with foreground-color 2\n              move 11 to col2\n              display GL039     at curs2 with foreground-color 2\n              go to  Accept-Ledger.\n     if       a-test = \"A\"\n              move  save-code  to  pc-code\n              move  space  to  a-test.\n*>\n     move     24 to col2 cole.\n     display  \"<+> = Delete, F9 = Copy/Replace, F8 = Move, ESC = Quit\" at curs2 with foreground-color 2.\n     accept   ledger-name at curs with foreground-color 3 update.\n*>\n     display  space at curs2 with erase eol.\n     move     ledger-name  to  name-test.\n     if       first-char = \"+\"\n              perform  deletion\n              go to    addition-end-2.\n*>\n     if       Cob-Crt-Status = Cob-Scr-Esc               *> Quit back to a/c accept.\n              go to Loop.\n     if      (Cob-Crt-Status = Cob-Scr-F9 or  Cob-Scr-F8)\n         and (Ledger-Balance not = zero\n          or  Ledger-Last not = zero)\n              display GL037 at curs2 with foreground-color 2 erase eol\n              go to Accept-Ledger.\n     if       Cob-Crt-Status = Cob-Scr-F9\n          or  Cob-Crt-Status = Cob-Scr-F8                *> move a/c to new a/c re\n              perform  zz200-Copy-and-Move-Account\n              go to Addition-End-2.\n\n accept-type.\n     display  space at curs2 with erase eol.\n     move     1 to col2.\n     move     52 to cole col2.\n     accept   ledger-type at curs with foreground-color 3 update.\n*>\n     if       ledger-type not = zero\n          and not = 1\n          and not = 9\n              display \"Invalid type!\" at curs2 with foreground-color 2\n              go to  accept-type.\n*>\n accept-placement.\n     display  space at curs2 with erase eol.\n*>\n     move     61 to cole col2.\n     accept   Ledger-Place at curs with foreground-color 3 update.\n     move     function upper-case (Ledger-Place) to Ledger-Place.\n     if       Ledger-Place  <  \"A\"  or  >  \"Z\"\n              display \"Invalid Placement!\" at curs2 with foreground-color 2\n              go to  accept-placement.\n*>\n*>    Profit centres/Branches only valid for Revenue Accounts\n*>\n     if       revenue-only  and  Ledger-Place >  \"N\"\n              and  ledger-pc  not = zero\n              display \"PC/BR, Revenue only\"  at curs2 with foreground-color 2\n              go to  Accept-Ledger.\n*>\n accept-header.\n     if       ledger-type not = zero\n              go to accept-end\n     else\n              move zero to Ledger-Level\n     end-if\n     move     70 to cole col2.\n     accept   ledger-level at curs with foreground-color 3 update.\n     if       ledger-level  <  1  or  >  4\n              display \"Invalid!\" at curs2 with foreground-color 2\n              go to  accept-header.\n     display  space at curs2 with erase eol.\n*>\n accept-end.\n*>\n Loop-end.\n     if       pc-code2 = \"*\"\n              go to  multi-add.\n*>\n     move     pc-code  to  y.\n     perform  ledger-rewrite.\n     go       to addition-end.\n*>\n multi-add.\n     move     zero  to  ledger-pc  y.\n*>\n     if       pc-code1 = \"*\"\n              move  1  to  y\n              perform  Loop-add  99  times\n              go to  addition-end.\n*>\n     move     pc-code1  to  y.\n     multiply y  by  10  giving  y.\n*>\n     if       y  >  0\n              perform  Loop-add  10  times\n       else\n              add  1  to  y\n              perform  Loop-add  9   times.\n*>\n     go       to addition-end.\n*>\n Loop-add.\n     if       p-b-codes (y) = \"E\"  or  \"Y\"\n              perform  ledger-rewrite.\n*>\n     add      1  to  y.\n*>\n addition-end.\n     move     zero  to  y.\n     perform  ledger-rewrite.\n*>\n Addition-End-2.\n     add      1  to  lin.\n     move     1 to cole.\n     display  space at curs with erase eol.\n*>\n     if       lin  <  ws-22-lines\n              go to  Loop.\n*>\n     move     6  to  lin.\n*>\n screen-clear.\n     display  space at curs with erase eol.\n     add      1  to  lin.\n*>\n     if       lin  <  ws-22-lines\n              go to screen-clear\n      else\n              go to  Loop.\n*>\n main-end.\n     perform  GL-Nominal-Close.     *> close ledger-file.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n deletion                section.   *> Delete entries in CoA\n*>------------------------------\n*>\n Loop-end.\n     if       pc-code2 = \"*\"\n              go to  multi-add.\n*>\n     move     pc-code  to  y.\n     perform  ledger-delete.\n     go       to addition-end.\n*>\n multi-add.\n     move     zero  to  ledger-pc  y.\n*>\n     if       pc-code1 = \"*\"\n              move  1  to  y\n              perform  Loop-add  99  times\n              go to  addition-end.\n*>\n     move     pc-code1  to  y.\n     multiply y  by  10  giving  y.\n*>\n     if       y  >  0\n              perform  Loop-add  10  times\n       else\n              add  1  to  y\n              perform  Loop-add  9   times.\n     go       to addition-end.\n*>\n Loop-add.\n     if       p-b-codes (y) = \"E\"  or  \"Y\"\n              perform  ledger-delete.\n     add      1  to  y.\n*>\n addition-end.\n     move     zero  to  y.\n     perform  ledger-delete.\n     move     1  to  truth.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ledger-rewrite          section.\n*>------------------------------\n*>\n     move     WS-Ledger-Nos  to  n-code.\n     move     y           to  n-pc  ledger-pc.\n*>\n     perform  GL-Nominal-Rewrite.      *> rewrite WS-Ledger-Record.\n     if       fs-reply not = zero\n              display GL034    at line ws-23-lines col 01 with foreground-color 4\n              display FS-Reply at line ws-23-Lines col 20 with foreground-color 4\n              accept ws-reply  at line ws-23-lines col 46 with foreground-color 2\n              perform  GL-Nominal-Write.      *>   write WS-Ledger-Record.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n*>\n ledger-delete           section.\n*>------------------------------\n*>\n     move     WS-Ledger-Nos  to  n-code.\n     move     y              to  n-pc\n                                 ledger-pc.\n*>\n     if       ledger-balance  not = zero\n              move  zero  to  truth\n              display GL035   at line ws-lines col 01 with foreground-color 2\n              go to  main-exit.\n*>\n     perform  GL-Nominal-Delete.  *> delete ledger-file  record.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n gl030e section.       *> Produce Alphabetic sorted listing\n*>*************\n*>\n*>  Now works with a pre-loaded (zz100) table of ledger acs and Names\n*>\n     perform  zz100-Load-Ledger-Table.       *> loads from ledgers and",
        "line": 135
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display GL035 at line ws-lines col 01 with foreground-color 2\n              go to main-exit.\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  \"Chart Of Accounts Alphabetic Print\" at 0123 with foreground-color 2.\n*>\n     move     zero  to  truth.\n     open     output  print-file.\n*>\n     if       Profit-Centres\n              move  \"Profit Centre    \"  to  l4-filler-2\n     else\n      if      Branches\n              move  \"    Branch       \"  to  l4-filler-2\n      else\n              move  spaces               to  l4-filler-2.\n*>\n     move     ws-date  to  l1-date.\n     move     zero    to  page-nos.\n     move     usera   to  l3-user.\n     perform  page-heading.\n*>\n*> New code 24/5/18 for table search",
        "line": 1589
      },
      {
        "type": "IF",
        "condition": "WS-TBL-Sub > WS-TBL-Entry-Cnt\n         or   WS-TBL-Ledger  (WS-TBL-Sub) = high-values\n              go to End-Report\n     end-if\n     move     WS-TBL-Ledger (WS-TBL-Sub)  to WS-Ledger-Key9.\n     perform  GL-Nominal-Read-Indexed.\n     if       FS-Reply not = zero            *> cant read a record that should be present ??\n              go to End-Report.\n*>\n     if       ledger-n = 9999\n              go to  P-Loop.\n*>\n     move     spaces  to  l5-level-filler l5-placement l5-name.\n     move     zero    to  l5-header       l5-detail    l5-pc z.\n*>\n     if       ledger-level = zero\n              go to  Detail-Jump.\n*>\n     move     ledger-level  to  z.\n     multiply z  by  2  giving  i.\n     add      1  to  i.\n     move     ledger-level  to  l5-level (i).\n     move     WS-Ledger-Nos    to  n-code.\n     divide   n-code  by  100   giving  l5-header.\n*>\n Detail-Jump.\n     if       ledger-level = zero\n              move    WS-Ledger-Nos  to  n-code\n              divide  n-code      by  100  giving  l5-detail.\n*>\n     perform  Compute-Placement.\n     move     place (z)    to  l5-placement.\n     move     ledger-pc    to  l5-pc.\n     move     ledger-name  to  l5-name.\n*>\n     write    print-record  from  line-5 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > Page-Lines\n              perform  Page-Heading.\n*>\n     go       to p-loop.\n*>\n Page-Heading.\n     add      1  to  page-nos.\n     move     page-nos  to  l3-page.\n*>\n     if       page-nos not = 1\n              write print-record  from  line-1 after page\n     else\n              write print-record  from  line-1 after 1.\n     write    print-record  from  line-3 after 1.\n     write    print-record  from  line-4 after 2  lines.\n*>\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     5 to line-cnt.\n*>\n End-Report.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n Main-End.\n*>*******\n*>\n     perform  GL-Nominal-Close.     *> close ledger-file.\n*>\n Main-Exit.\n     exit section.\n*>\n Compute-Placement section.\n*>------------------------\n*>\n     if       Ledger-Place  less  \"E\"\n              move  1  to  z\n     else\n      if      Ledger-Place  less  \"I\"\n              move  2  to  z\n      else\n       if     Ledger-Place  less  \"K\"\n              move  3  to  z\n       else\n        if    Ledger-Place  less  \"O\"\n              move  4  to  z\n        else\n         if   Ledger-Place  less  \"R\"\n              move  5  to  z\n         else\n          if  Ledger-Place  less  \"U\"\n              move  6  to  z\n          else\n           if Ledger-Place  less  \"W\"\n              move  7  to  z\n           else\n              move  8  to  z.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n gl030f section.         *> Display (5) or print (6) CoA\n*>*************\n*>\n     move     prog-name to l1-prog.\n     perform  GL-Nominal-Open-Input.             *> open input  ledger-file.\n     if       fs-reply not = zero\n              display space at 0101 with erase eos\n              display GL036 at 0901 with foreground-color 2\n              go to main-exit.\n*>\n d-head-1.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  \"Chart Of Accounts Display\" at 0127 with foreground-color 2.\n*>\n d-head-end.\n     move     zero  to  truth.\n*>\n main-target.\n     if       ws-menu = 6\n              display \"Print Out\" at 0145 with foreground-color 2\n              go to  print-out.\n*>\n     move     3  to  lin.\n     perform  gl030f-screen-clear.\n*>\n     move     zero  to  ledger-n  ledger-s Ledger-PC.\n*>\n     display  \"Enter the start Account - [      ]\" at 0401 with foreground-color 2.\n     if       Profit-Centres  or  Branches\n              display \"/  ]\" at 0434 with foreground-color 2.\n*>\n     display  space at line ws-23-lines col 01 with erase eol.\n     display  \"Press <Esc> key to exit\" at line ws-23-lines col 01 with foreground-color 2.\n*>\n     accept   WS-Ledger-Nos at 0428 with foreground-color 3 update.\n     display  \"                \" at 0841 with foreground-color 2\n*>\n     if       cob-crt-status = cob-scr-esc\n              move  \"Q\"  to  seek\n              move  0  to  truth\n              go to  main-end.\n*>\n     move     zero  to  ledger-pc.\n*>\n     if       Profit-Centres  or  Branches\n              accept ledger-pc at 0435  with foreground-color 3 update.\n*>\n     move     WS-Ledger-Nos  to  save-ledger.\n     move     WS-Ledger-Nos  to  n-code.\n     move     ledger-pc   to  n-pc.\n     move     4   to  lin.\n     move     1   to  truth.\n*>\n*>     alter    gate  to  do-clear\n *>    move     1 to gate-sw.\n     set      DoClear to true.\n*>\n     perform  display-chart.\n*>\n     move     1 to File-Key-No.\n     set      fn-Not-Less-Than to true.\n     perform  GL-Nominal-Start.  *> start ledger-file key not < ledger-key invalid key\n     if       FS-Reply not = zero\n              move  255  to  we-error.\n*>\n     if       we-error = zero\n              perform  GL-Nominal-Read-Next      *>   read  ledger-file   next record  at end\n              if     fs-reply = 10\n                     move 255 to we-error.\n*>\n     if       we-error = 255\n              display \"No match found !\" at 0841 with foreground-color 2\n              go to  main-target.\n*>\n     move     zero  to  truth.\n     add      2  to  lin.\n*>\n main-loop.\n     display  \"<N> Next; <I> Next ignore same code; <C> Cont; <Q> Quit :- [I]\"\n                                            at line ws-23-lines col 01  with foreground-color 2.\n     move     \"I\"  to  seek.\n*>\n     perform  display-chart.\n     accept   seek at line ws-23-lines col 61 with foreground-color 3 update auto.\n     move     function upper-case (seek) to seek.\n*>\n     if       seek = \"Q\"\n              move  0  to  truth\n              go to  main-end.\n*>\n subsid-loop.\n*>     alter    gate  to  ask-clear.\n *>    move     2 to gate-sw.\n     set      AskClear to true.\n*>\n     perform  GL-Nominal-Read-Next.      *>  read     ledger-file  next record  at end\n     if       fs-reply = 10\n              move  255 to we-error.\n*>\n     if       we-error = 255\n           or ledger-n = 9999\n              go to  main-target.\n*>\n     if       seek = \"I\"\n        and   WS-Ledger-Nos = save-ledger\n              go to  subsid-loop.\n*>\n     move     WS-Ledger-Nos  to  save-ledger.\n*>\n     add      1  to  lin.\n     if       lin = ws-22-lines\n              perform ask-clear\n       if     cob-crt-status = cob-scr-esc\n*>              alter gate to do-clear\n *>             move 1 to gate-sw\n              set  DoClear to true\n              go to main-target\n        else\n              perform d-head-1\n              move 4 to lin\n              perform second-head\n              move  6   to  lin.\n*>\n     if       seek  not = \"C\" and \"I\"\n              go to  main-loop\n        else\n              perform  display-chart\n              go to  subsid-loop.\n*>\n print-out.\n     open     output  print-file.\n*>\n     if       Profit-Centres\n              move  \"Profit Centre    \"  to  l6-filler-2\n     else\n      if      Branches\n              move  \"   Branch       \"   to  l6-filler-2\n      else\n              move  spaces               to  l6-filler-2.\n*>\n     move     to-day  to  l1-date.\n     move     zero    to  page-nos.\n     move     usera   to  l3-user.\n     perform  page-heading.\n*>\n p-loop.\n     perform  GL-Nominal-Read-Next.      *>  read ledger-file  next record  at end\n     if       fs-reply = 10\n              move  255 to we-error.\n*>\n     if       we-error = 255\n           or ledger-n = 9999\n              go to  end-report.\n*>\n     move     spaces  to  l7-level-filler l7-placement l7-name.\n     move     zero    to  l7-header l7-detail l7-pc z.\n*>\n     if       ledger-level = zero\n              go to  detail-jump.\n*>\n     move     ledger-level  to  z.\n     multiply z  by  2  giving  i.\n     add      1  to  i.\n     move     ledger-level  to  l7-level (i).\n     move     WS-Ledger-Nos    to  n-code.\n     divide   n-code  by  100   giving  l7-header.\n     perform  Compute-Placement.\n     move     place (z)    to  l7-placement.\n*>\n detail-jump.\n     if       ledger-level = zero\n              move    WS-Ledger-Nos  to  n-code\n              divide  n-code      by  100  giving  l7-detail.\n*>\n     move     ledger-pc     to  l7-pc.\n     move     ledger-name  to  l7-name.\n*>\n     write    print-record  from  line-7 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > Page-Lines\n              perform  page-heading.\n*>\n     go       to p-loop.\n*>\n page-heading.\n     add      1  to  page-nos.\n     move     page-nos  to  l3-page.\n*>\n     if       page-nos not = 1\n              write print-record  from  line-1 after page\n     else\n              write print-record  from  line-1 after 1.\n     write    print-record  from  line-3 after 1.\n     write    print-record  from  line-6 after 2.\n*>\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     5 to line-cnt.\n*>\n end-report.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-end.\n     perform  GL-Nominal-Close.     *> close ledger-file.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n display-chart section.\n*>--------------------\n*>\n*>  If true set-up headings else display a line of data\n*>\n     if       a-false\n              go to  detail-display.\n*>\n second-head.\n     move     1 to cole.\n     display  \"Ledger    \" at curs with foreground-color 2.\n     move     11 to cole.\n     display  \"Sub    \" at curs with foreground-color 2.\n*>\n     move     18 to cole.\n     if       Profit-Centres\n              display \"  P/C   \" at curs with foreground-color 2\n     else\n      if      Branches\n              display \"Branch  \" at curs with foreground-color 2\n      else\n              display \"        \" at curs.\n*>\n     move     26 to cole.\n     display  \"<---------Name--------->    Type    Level --Placement--\" at\n                 curs with foreground-color 2.\n*>\n main-pass.\n     go       to main-exit.\n*>\n detail-display.\n     move     2 to cole.\n     display  ledger-n at curs with foreground-color 2.\n     move     11 to cole.\n     display  ledger-s at curs with foreground-color 2.\n     move     20 to cole.\n     if       Profit-Centres or Branches\n              display  ledger-pc at curs with foreground-color 2.\n     move     25 to cole.\n     display  ledger-name at curs with foreground-color 2.\n*>\n     if       ledger-type = 9\n              subtract  4  from  ledger-type\n      else\n              add 1 to ledger-type.\n*>\n     move     53 to cole.\n     if       ledger-type < 1 or > 5\n              move \"ERROR in type [1 - 4]?\" to ws-ledger-desc\n       else\n              move ledger-desc (ledger-type) to ws-ledger-desc.\n     display  ws-ledger-desc at curs with foreground-color 2.\n*>\n     if       ledger-level not =  zero\n              move 64 to cole\n              display ledger-level at curs with foreground-color 2\n              perform  Compute-Placement\n              move 68 to cole\n              move place (z) to ws-place\n              display ws-place at curs with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n gl030f-screen-clear         section.\n*>----------------------------------\n*>\n gate.\n     if       askclear\n              go to ask-clear.\n     if       doclear\n              go to do-clear.\n*>      go to  do-clear.\n*>\n ask-clear.\n*>\n     display  \"Press Return for next screen\" at line ws-23-lines col 01\n                with foreground-color 2 erase eol.\n     accept   ws-reply at line ws-23-lines col 41 with foreground-color 2.\n*>\n do-clear.\n*>\n*>     alter    gate  to  ask-clear.\n*>     move     2 to gate-sw.\n     set      AskClear to true.\n     move     lin  to  save-lin.\n*>\n Loop.\n     move     1 to cole.\n     display  space at curs with erase eol.\n     add      1  to  lin.\n     if       lin  <  ws-23-lines\n              go to  Loop.\n*>\n     move     save-lin  to  lin.\n*>\n main-exit.\n     exit     section.\n*>\n gl030g section.      *> PC report  OR Branches looking at menu ??\n*>*************\n*>\n*>  LOOKS LIKE ONLY printing Establishments or are they PCs/Branches. need tests.\n*>\n     perform  GL-Nominal-Open-Input.           *> open input  ledger-file.\n     if       fs-reply not = zero\n              display space at 0101 with erase eos\n              display GL036 at 0901 with foreground-color 2\n              go to main-exit.\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  \"Profit Centres Report\" at 0127 with foreground-color 2.\n*>\n     move     zero  to  truth.\n     move     999999 to  WS-Ledger-Nos.\n     move     zero   to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *>  read ledger-file  record invalid  key\n     if       fs-reply = 21\n              move     255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces            to  p-c-Branches\n       else\n              move  WS-Ledger-Record  to  p-c-Branches.\n*>\n     move     999999  to  pc-ledg.\n     move     zero    to  pc-pc est.\n*>\n     set      pc  to  1.\n     search   p-b-codes when p-b-codes (pc) = \"E\"\n              set   est  to  pc.\n*>\n print-out.\n     open     output  print-file.\n*>\n     move     to-day  to  l11-date.\n     move     zero    to  page-nos.\n     move     usera   to  l13-user.\n     perform  page-heading.\n*>\n p-loop.\n     move     1  to  y.\n*>\n Loop-3.\n     if       p-b-codes (y)  = space\n              go to  Loop-3-return.\n*>\n     move     zero   to  z.\n     add      y      to  z.\n     move     999999 to  WS-Ledger-Nos.\n     move     z      to  ledger-pc.\n*>\n     perform  GL-Nominal-Read-Indexed.      *>  read ledger-file  record  invalid key\n     if       fs-reply = 21\n              move  255  to  we-error.\n*>\n     if       we-error = 255\n              move  spaces  to  ledger-name.\n*>\n Loop-3-back.\n     move     ledger-pc    to  l15-nos.\n     move     ledger-name  to  l15-name.\n     write    print-record  from  line-15 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > Page-Lines\n              perform  page-heading.\n     add      1  to  lin.\n*>\n Loop-3-return.\n     add      1  to  y.\n     if       y  <  99\n              go to  Loop-3.\n*>\n     go       to end-report.\n*>\n page-heading.\n     add      1  to  page-nos.\n     move     page-nos  to  l13-page.\n*>\n     if       page-nos not = 1\n              write print-record from line-1 after page\n     else\n              write print-record from line-1 after 1.\n     write    print-record  from  line-13 after 1.\n     write    print-record  from  line-14 after 2.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     5 to line-cnt.\n*>\n end-report.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-end.\n     perform  GL-Nominal-Close.\n*>\n main-exit.\n     exit section.\n*>\n gl030h section.      *> Import/Export CoA from text file al la irs010\n*>*************\n*>\n*> First we need to ask import or export\n*>\n GL030h-Main.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Import / Export CoA File\" at 0129 with foreground-color 2.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 3.\n*>\n     display  \"Select one of the following by number :- [ ] or by Function key\" at 0801 with foreground-color 2.\n     display  \"(1)    Export the Chart of Accounts\"  at 1001 with foreground-color 2.\n     display  \"(2)    Import the Chart of Accounts\"  at 1201 with foreground-color 2.\n     display  \"(9)    Exit to system menu\"           at 1401 with foreground-color 2.\n*>\n     move     zero to ws-Menu.\n     accept   ws-Menu at 0843  with foreground-color 6 auto.\n*>\n     if       ws-Menu = 9\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  gl030h-Exit.\n     if       ws-Menu = 1\n              perform ea-Export-CoA.\n     if       ws-Menu = 2\n              perform fa-Import-CoA.\n     go       to GL030h-Main.\n*>\n gl030h-Exit.\n     exit     section.\n*>\n ea-Export-CoA section.\n*>--------------------\n*>\n ea010-Warning-Notice.\n     display  \"This process will export a copy of the current CoA (Chart of Accounts)\"\n                 at 0101 with foreground-color  cob-color-yellow erase eos.\n     display  \"overwriting any copy of the file if it exists.\"\n                 at 0221 with foreground-color cob-color-yellow.\n     display  \"Continue Y/N [ ]\"      at 0401 with background-color cob-color-red\n                                         foreground-color cob-color-white.\n*>\n     move     space to Menu-Reply.\n     accept   menu-reply at 0415.\n     if       menu-reply = \"N\" or = \"n\"\n              exit section\n     end-if\n*>\n     display  \"File name to be created [12345678901234567890123456789012]\"\n                                 at 0601 with foreground-color cob-color-yellow.\n     accept   Archive-Name at 0626 with update.\n     if       Archive-Name = spaces or Cob-Crt-Status = Cob-Scr-Esc\n              display \"Quiting to Sub Menu\" at 1001 with erase eol\n              exit section.\n*>\n ea020-Open-Output.\n     open     Output Saved-CoA.\n     if       fs-reply not = zero\n              display  \"Problem opening Export File, hit return to quit action\" at 2301\n              accept   ws-reply at 2360\n              close    Saved-CoA\n              exit section\n     end-if\n*>\n*> Open nominal ledger\n*>\n     move     zero to counter.\n     perform  GL-Nominal-Open-Input.\n     if       FS-Reply not = zero\n              display \"Problem opening CoA, Hit return to quit action\" at 2301\n              accept  ws-reply at 2360\n              perform  GL-Nominal-Close\n              close    Saved-CoA\n              exit section\n     end-if\n*>\n     perform  until fs-Reply not = zero     *> initially on open, and checked lower down\n              perform GL-Nominal-Read-Next\n              if   Fs-Reply not = zero       *> eof\n                   perform  GL-Nominal-Close\n                   close    Saved-CoA\n                   exit perform\n              end-if\n              move  WS-Ledger-Key9  to ECoA-Ledger-Key9\n              move  Ledger-Type  to ECoA-Ledger-Type\n              move  Ledger-Place to ECoA-Ledger-Place\n              move  Ledger-Level to ECoA-ledger-Level\n              move  Ledger-Name  to ECoA-Ledger-Name\n              move  space        to ECoA-Filler\n              write Export-CoA-Text\n              if   fs-reply not = zero\n                   display \"Problem writing to Export File, Hit return to quit action\" at 2301\n                   accept  ws-reply at 2360\n                   perform  GL-Nominal-Close\n                   close    Saved-CoA\n                   exit perform     *> at least close files and get totals\n              end-if\n              add 1 to counter\n     end-perform\n*>\n*> Close file\n*>\n     display  \"Total record count written out = \"   at 2001.\n     display  Counter                               at 2034.\n     display  \"Note count & hit return to continue\" at 2201.\n     accept   ws-reply                              at 2237.\n*>\n     perform  GL-Nominal-Close.\n     close    Saved-CoA.\n*>\n ea999-exit.\n     exit     section.\n*>\n fa-Import-CoA section.\n*>--------------------\n fa010-Warning-Notice.\n*>\n     display  \"This process will import a CoA (Chart of Accounts) in TEXT format \" at 0101\n                 with foreground-color cob-color-yellow erase eos.\n     display  \"overwriting any existing G-L Chart of Accounts.\"    at 0201\n                  with foreground-color cob-color-yellow.\n     display  \"This must only be done for a new set of accounts for a new business\" at 0301\n                  with foreground-color cob-color-yellow.\n     display  \"Otherwise, If you have not made a back up of it you should quit this process.\"\n                   at 0401 with foreground-color cob-color-yellow.\n     display  \"Warning: This is NON RECOVERABLE, so think about it\"       at 0714\n                     with foreground-color cob-color-red.\n     display  \"Before responding (Y)es ensure you have a back copy of the original file\"\n                    at 0901 with   foreground-color cob-color-yellow.\n     display  \"Otherwise respond (N)o and",
        "line": 1620
      },
      {
        "type": "IF",
        "condition": "menu-reply = \"N\" or = \"n\"\n              move \"1\" to menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be Imported [12345678901234567890123456789012]\" at 1501 with\n                 foreground-color cob-color-yellow.\n     accept   Archive-Name at 1527 with foreground-color cob-color-yellow update.\n     if       Archive-Name = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              display \"Quiting to menu\" at 1501 with erase eol\n              exit section.\n*>\n fa020-Open-Files.\n     open     Input Saved-CoA.\n     if       fs-reply not = zero\n              display \"Problem opening Import File, hit return to quit action\" at 2301\n              accept  ws-reply at 2360\n              close    Saved-CoA\n              exit section\n     end-if\n*>\n     perform  GL-Nominal-Open-Output.\n     if       FS-Reply not = zero\n              display \"Problem opening Accounts for output, hit return to quit action\" at 2301\n              accept  ws-reply at 2365\n              perform  GL-Nominal-Close\n              close    Saved-CoA\n              exit section\n     end-if\n     move     zero to Counter.\n*>\n*>  Set all amounts to zero, cannot use initialize owing to presence of redefines\n*>\n     initialise WS-Ledger-Record with filler.\n*>\n fa030-Read-Input.\n     read     Saved-CoA record at end\n              go to fa040-End-Of-Input.\n*>\n     move    ECoA-Ledger-Key9   to WS-Ledger-Key9.\n     move    ECoA-Ledger-Type   to Ledger-Type.\n     move    ECoA-Ledger-Place  to Ledger-Place.\n     move    ECoA-ledger-Level  to Ledger-Level.\n     move    ECoA-Ledger-Name   to Ledger-Name.\n*>\n     perform  GL-Nominal-Write.\n     if       FS-Reply not = zero\n              display \"Problem writing to Accounts, hit return to quit action\" at 2301\n              close    Saved-CoA\n              perform  GL-Nominal-Close\n              accept  ws-reply at 2365\n              exit section\n     end-if\n\n     add      1  to Counter.\n     go       to fa030-Read-Input.\n*>\n fa040-End-Of-Input.\n     display  \"Total records created = \" at 2001.\n     display  Counter                    at 2026.\n     display  \"Note count & hit return to continue\" at 2201.\n     accept   ws-reply                   at 2237.\n*>\n     close    Saved-CoA.\n     perform  GL-Nominal-Close.\n*>\n fa999-Exit.\n     exit     section.\n\n*>\n main-exit.\n     exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps03.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps03.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n zz100-Load-Ledger-Table  section.\n*>*******************************\n*>\n*>  Read the ledger file/table building the searchable table by name\n*>   sorted by Name high-value will be present on both fields for unused entries.\n*>\n     perform  GL-Nominal-Open-Input.       *> open input  ledger-file.\n     perform  varying WS-TBL-Entry-Cnt from 1 by 1\n                    until FS-Reply not = zero\n                      or   WS-TBL-Entry-Cnt >  WS-TBL-Ledgers-Size\n              perform  GL-Nominal-Read-Next\n              if       FS-Reply = 10\n                       subtract 1 from WS-TBL-Entry-Cnt   *> was increased by 1 in perform\n                       exit perform\n              end-if\n              if    WS-Ledger-Key9 = zeros\n                    subtract 1 from WS-TBL-Entry-Cnt\n                    exit perform cycle\n              end-if\n              move  WS-Ledger-Key9 to WS-TBL-Ledger  (WS-TBL-Entry-Cnt)\n              move  Ledger-Name    to WS-TBL-Name    (WS-TBL-Entry-Cnt)\n     end-perform.\n     perform  GL-Nominal-Close.\n     sort     WS-TBL-Group\n               on ascending key WS-TBL-Name\n                with duplicates.\n*>\n zz100-Exit.\n     exit     section.\n*>\n zz200-Copy-and-Move-Account  section.\n*>***********************************\n*>\n*>   Copy           - Using F9 at Name Req, copy existing a/c info\n*>                    into a new a/c # that is requested on new line.\n*>                    New a/c must not exist.\n*>   Move           - Using F8 same but existing record is deleted.\n*>\n*>   USAGE: After accepting the Account/subnominal details and\n*>          moving to new a/c, clearing\n*>          Balance and last totals to zero as well as the quarter totals\n*>          for the new a/c #.\n*>          The old a/c # is kept.\n*>          The New a/c must not exist.\n*>\n*>  at end we will continue with next line overwriting the update info line\n*>   otherwise the line count might get confusing.\n*>\n zz200-Start.\n     move     1 to col2.\n     Display  space at curs with erase eol.\n*>\n     display  \"[    ]\" at curs2 with foreground-color 2.\n     move     11 to col2.\n     display  \"[  ]\"   at curs2 with foreground-color 2.\n*>\n     move     zeros to Ledger-S-2\n                       Ledger-N-2.\n     move     2 to col2.\n     accept   Ledger-N-2 at curs2 with foreground-color 3 update.\n*>\n     if       Ledger-N-2 = zero                          *> Check if user aborting copy/move request\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  zz200-Exit.\n*>\n     move     12 to col2.\n     accept   Ledger-S-2 at curs2 with foreground-color 3 update.\n     if       Ledger-S-2 = zero                          *> Check if user aborting copy/move request\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to  zz200-Exit.\n*>\n     if       not  Profit-Centres\n          and not  Branches\n              move  zero  to  pc-code\n     else\n              move     17 to col2\n              accept   pc-code at curs with foreground-color 3 update.\n*>\n*> So now to save the current ledger record, check that there is no rec for the new account\n*>   before we can create new rec having cleared all totals.\n*>   If Move was requested (F8) we will delete the original rec.\n*>\n     move     WS-Ledger-Record to Saved-Ledger-Record.\n     if       Saved-Ledger-Balance not =  zero\n          or  Saved-Ledger-Last not = zero\n              display GL037    at line lin2 col  1 with erase eol\n              display SY008    at line lin2 col 41\n              accept  ws-reply at line lin2 col 74\n              go to zz200-Exit.\n*>\n     move     Ledger-N-2   to Ledger-N.\n     move     Ledger-S-2   to Ledger-S.\n     move     PC-Code      to Ledger-PC.\n*>\n*> Now we could, check pc-code for 'AL'",
        "line": 2267
      },
      {
        "type": "IF",
        "condition": "fs-reply = zero                            *>  Opps we found a record\n              display GL03A    at line lin2 col  1 with erase eol\n              display SY008    at line lin2 col 41\n              accept  ws-reply at line lin2 col 74\n              go to zz200-Exit.\n*>\n*>  All looks good so we can move rec.\n*>\n     move     Saved-Ledger-Record to WS-Ledger-Record.\n     move     Ledger-N-2   to Ledger-N.\n     move     Ledger-S-2   to Ledger-S.\n     move     PC-Code      to Ledger-PC.\n     initialise Saved-Quarters.\n     perform  GL-Nominal-Write.\n     if       fs-reply not = zero\n              display \"Got error on writing new GL record, reply=  \" at line ws-22-lines col 1\n              display FS-Reply  at line ws-22-lines col 43\n              display SY008     at line ws-23-lines col 1\n              accept  ws-reply  at line ws-23-lines col 33\n              go to zz200-Exit.\n*>\n     if       Cob-Crt-Status = Cob-Scr-F8\n              move     Saved-Ledger-Record to WS-Ledger-Record\n              perform  GL-Nominal-Delete.\n*>\n zz200-Exit.\n     exit     section.\n*>\n maps03       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 2544
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 10,
    "cognitive": 5,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 213,
      "totalOperators": 317,
      "totalOperands": 634,
      "vocabulary": 214,
      "length": 951,
      "volume": 7362.135104067491
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
