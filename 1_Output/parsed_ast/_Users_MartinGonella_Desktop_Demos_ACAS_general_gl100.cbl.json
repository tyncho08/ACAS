{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/general/gl100.cbl",
  "fileName": "gl100.cbl",
  "timestamp": "2025-09-15T16:25:32.895Z",
  "programId": "gl100",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 94
      },
      {
        "name": "file",
        "line": 115
      },
      {
        "name": "working-storage",
        "line": 160
      },
      {
        "name": "linkage",
        "line": 180
      },
      {
        "name": "gl100-Main",
        "line": 195
      },
      {
        "name": "disk-change",
        "line": 221
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 97
      },
      {
        "name": "file-defs",
        "line": 192
      },
      {
        "name": "menu-exit",
        "line": 218
      },
      {
        "name": "goback",
        "line": 219
      },
      {
        "name": "accept-option",
        "line": 255
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "of",
        "line": 84,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 93,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 164,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 183,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 184,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 185,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "disk-change",
        "thru": null,
        "line": 199
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "5",
        "to": "ws-term-code\n              go to menu-exit",
        "line": 201
      },
      {
        "from": "4",
        "to": "ws-term-code\n              go to menu-exit",
        "line": 206
      },
      {
        "from": "space",
        "to": "Arg-Test",
        "line": 232
      },
      {
        "from": "Arg-Test",
        "to": "file-2",
        "line": 239
      },
      {
        "from": "space",
        "to": "Arg-Test",
        "line": 243
      },
      {
        "from": "Arg-Test",
        "to": "arc-out-name",
        "line": 250
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n     select  archive    assign  file-2\n                        access  sequential\n                        status  fs-reply\n                        organization  line sequential.\n*>\n     select  arch-out   assign  arc-out-name\n                        access  sequential\n                        status  fs-reply\n                        organization  line sequential.\n*>\n     select  sort-file  assign file-21.\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n fd  archive.\n*>\n 01  arc-trans-record.\n   03  arc-batch         pic 9(5).\n   03  arc-post          pic 9(5).\n   03  arc-code          pic xx.\n   03  arc-date          pic x(8).\n   03  arc-ac            pic 9(6).\n   03  arc-pc            pic 99.\n   03  arc-amount        pic s9(8)v99.\n   03  arc-legend        pic x(32).\n   03  arc-c-ac          pic 9(6).\n   03  arc-c-pc          pic 99.\n*>\n fd  arch-out.\n*>\n 01  arc-trans-out.\n   03  out-batch         pic 9(5).\n   03  out-post          pic 9(5).\n   03  out-code          pic xx.\n   03  out-date          pic x(8).\n   03  out-ac            pic 9(6).\n   03  out-pc            pic 99.\n   03  out-amount        pic s9(8)v99.\n   03  out-legend        pic x(32).\n   03  out-c-ac          pic 9(6).\n   03  out-c-pc          pic 99.\n*>\n sd  sort-file.\n*>\n 01  srt-trans-srt.\n   03  srt-batch         pic 9(5).\n   03  srt-post          pic 9(5).\n   03  srt-code          pic xx.\n   03  srt-date          pic x(8).\n   03  srt-ac            pic 9(6).\n   03  srt-pc            pic 99.\n   03  srt-amount        pic s9(8)v99.\n   03  srt-legend        pic x(32).\n   03  srt-c-ac          pic 9(6).\n   03  srt-c-pc          pic 99.\n*>\n working-storage section.\n*>----------------------\n*>\n 77  prog-name           pic x(15)  value \"gl100 (3.02.03)\".\n copy \"wsfnctn.cob\".\n*>\n 77  a                   pic 9      value zero.\n 77  keyed-reply         pic x      value space.\n 77  ws-eval-msg         pic x(25)  value spaces.\n*>\n 01  Arg-Test            pic x(525) value spaces.\n*>\n 01  arc-out-name        pic x(532) value \"workarc.tmp\".\n*>\n 01  Error-Messages.\n*> System Wide\n*> Module specific\n    03  GL101            pic x(70)  value \"GL101 Enter <0> to signify change made or <9> to abort this run :- [ ]\".\n    03  GL105            pic x(48)  value \"GL105 Ensure Archive USB Memory Stick is in path\".\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 77  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n gl100-Main section.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Ledger Print - Sort\" at 0131  with foreground-color 2.\n*>\n     perform  disk-change.\n     if       a  equal  9   *> abort procedure\n              move 5 to ws-term-code\n              go to menu-exit.\n*>\n     open     input archive.\n     if       fs-reply not = zero\n              move 4 to ws-term-code\n              go to menu-exit.\n     close    archive.\n*>\n     sort     sort-file\n              on ascending key  srt-ac\n                                srt-pc\n                                srt-batch\n                                srt-post\n              using   archive\n              giving  arch-out.\n*>\n menu-exit.\n     goback.\n*>\n disk-change  section.\n*>-------------------\n*>     Copied from gl080\n*>     *****************\n*>\n*> Build path for archive file/s\n*>    this set up for testing but need to change to accept\n*>     path to usb memory stick (full path) but will work as is\n*>       assuming users changes path and the system KNOWS about\n*>         the memory stick\n*>\n     move     space to Arg-Test.             *> this lot needs checking !!!!!\n     string   file-24        delimited by space\n              \"archives\"     delimited by size\n              file-defs-os-delimiter\n                             delimited by size\n                file-2      delimited by space\n                            into Arg-Test.\n     move     Arg-Test to file-2.\n*>\n*>  This is for the temp file used by gl105 (the Ledger Print)\n*>\n     move     space to Arg-Test.\n     string   file-24        delimited by space\n              \"archives\"     delimited by size\n              file-defs-os-delimiter\n                             delimited by size\n              arc-out-name   delimited by space\n                            into Arg-Test.\n     move     Arg-Test to arc-out-name.\n*>\n     display  GL105 at 1201 with erase eol foreground-color 2.\n     display  GL101 at 1301 with erase eol foreground-color 2.\n*>\n accept-option.\n     accept   a at 1369.\n     if       a = 9\n              go to  main-exit.\n     if       a  not = zero\n              go to  accept-option.\n*>\n*>  Hopefully can remove these after testing\n*>\n     display  \"Current path/name is :\" at 1401 with foreground-color 2 erase eol.\n*>     display  file-2             at 1501 with foreground-color 2 erase eol.\n     accept   file-2             at 1501 with foreground-color 2 update.\n     if       file-2 (1:1) = space\n              go to accept-option.\n*>\n main-exit.   exit.\n*>********    ****",
        "line": 81
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 2,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 7,
      "totalOperators": 6,
      "totalOperands": 12,
      "vocabulary": 8,
      "length": 18,
      "volume": 54
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
