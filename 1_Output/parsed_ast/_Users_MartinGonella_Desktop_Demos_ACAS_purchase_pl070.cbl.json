{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl070.cbl",
  "fileName": "pl070.cbl",
  "timestamp": "2025-09-15T16:25:48.506Z",
  "programId": "pl070",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 116
      },
      {
        "name": "file",
        "line": 129
      },
      {
        "name": "working-storage",
        "line": 139
      },
      {
        "name": "linkage",
        "line": 271
      },
      {
        "name": "init01",
        "line": 286
      },
      {
        "name": "create",
        "line": 400
      },
      {
        "name": "amend",
        "line": 480
      },
      {
        "name": "report1",
        "line": 550
      },
      {
        "name": "show",
        "line": 635
      },
      {
        "name": "display-heading",
        "line": 708
      },
      {
        "name": "display-outline",
        "line": 736
      },
      {
        "name": "analysis-data",
        "line": 775
      },
      {
        "name": "p-a-setup",
        "line": 793
      },
      {
        "name": "zz070-Convert-Date",
        "line": 904
      },
      {
        "name": "exit",
        "line": 932
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 119
      },
      {
        "name": "file-defs",
        "line": 283
      },
      {
        "name": "menu-return",
        "line": 320
      },
      {
        "name": "menu-input",
        "line": 324
      },
      {
        "name": "end-if",
        "line": 372
      },
      {
        "name": "end-if",
        "line": 391
      },
      {
        "name": "Menu-Exit",
        "line": 393
      },
      {
        "name": "goback",
        "line": 394
      },
      {
        "name": "product-input",
        "line": 407
      },
      {
        "name": "product-loop",
        "line": 411
      },
      {
        "name": "get-details",
        "line": 446
      },
      {
        "name": "main-output",
        "line": 458
      },
      {
        "name": "main-end",
        "line": 475
      },
      {
        "name": "product-input",
        "line": 487
      },
      {
        "name": "product-loop",
        "line": 491
      },
      {
        "name": "get-details",
        "line": 510
      },
      {
        "name": "main-output",
        "line": 518
      },
      {
        "name": "main-end",
        "line": 545
      },
      {
        "name": "read-loop",
        "line": 559
      },
      {
        "name": "headings",
        "line": 605
      },
      {
        "name": "end-report",
        "line": 622
      },
      {
        "name": "main-end",
        "line": 628
      },
      {
        "name": "show-read",
        "line": 647
      },
      {
        "name": "sread",
        "line": 651
      },
      {
        "name": "product-display",
        "line": 667
      },
      {
        "name": "accept-of-show",
        "line": 685
      },
      {
        "name": "main-end",
        "line": 699
      },
      {
        "name": "main-loop",
        "line": 745
      },
      {
        "name": "get-pa-desc",
        "line": 781
      },
      {
        "name": "get-pa-print",
        "line": 785
      },
      {
        "name": "create-value",
        "line": 882
      },
      {
        "name": "zz070-Exit",
        "line": 931
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 311,
        "type": "DYNAMIC",
        "using": [
          "File-15",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "perform",
          "p-a-setup",
          "end-if",
          "end-if",
          "if",
          "ws-Process-Func",
          "=",
          "1",
          "*>",
          "Called",
          "by",
          "Stock",
          "so",
          "we",
          "are",
          "done",
          "go",
          "to",
          "Menu-Exit"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 631,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 106,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 115,
        "replacing": null
      },
      {
        "name": "selanal",
        "line": 122,
        "replacing": null
      },
      {
        "name": "selval",
        "line": 123,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 124,
        "replacing": null
      },
      {
        "name": "fdanal",
        "line": 132,
        "replacing": null
      },
      {
        "name": "fdval",
        "line": 133,
        "replacing": null
      },
      {
        "name": "print-spool-command-p",
        "line": 142,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 143,
        "replacing": null
      },
      {
        "name": "wsanal",
        "line": 144,
        "replacing": null
      },
      {
        "name": "wsval",
        "line": 145,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 240,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 274,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 275,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 276,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 934,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "p-a-setup",
        "thru": null,
        "line": 314
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 322
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 339
      },
      {
        "target": "create",
        "thru": null,
        "line": 341
      },
      {
        "target": "amend",
        "thru": null,
        "line": 343
      },
      {
        "target": "report1",
        "thru": null,
        "line": 346
      },
      {
        "target": "report1",
        "thru": null,
        "line": 350
      },
      {
        "target": "show",
        "thru": null,
        "line": 352
      },
      {
        "target": "aa020-Rollback",
        "thru": null,
        "line": 367
      },
      {
        "target": "aa020-Rollback",
        "thru": null,
        "line": 386
      },
      {
        "target": "Analysis-Open",
        "thru": null,
        "line": 403
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 405
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 408
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 420
      },
      {
        "target": "product-display",
        "thru": null,
        "line": 422
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 426
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 434
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 439
      },
      {
        "target": "analysis-data",
        "thru": null,
        "line": 451
      },
      {
        "target": "get-pa-desc",
        "thru": null,
        "line": 460
      },
      {
        "target": "Analysis-Write",
        "thru": null,
        "line": 465
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 467
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 471
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 476
      },
      {
        "target": "Analysis-Open",
        "thru": null,
        "line": 483
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 485
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 488
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 500
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 505
      },
      {
        "target": "product-display",
        "thru": null,
        "line": 508
      },
      {
        "target": "analysis-data",
        "thru": null,
        "line": 511
      },
      {
        "target": "get-pa-desc",
        "thru": null,
        "line": 520
      },
      {
        "target": "Analysis-Delete",
        "thru": null,
        "line": 527
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 529
      },
      {
        "target": "Analysis-Rewrite",
        "thru": null,
        "line": 533
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 535
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 541
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 546
      },
      {
        "target": "Analysis-Open-Input",
        "thru": null,
        "line": 554
      },
      {
        "target": "headings",
        "thru": null,
        "line": 557
      },
      {
        "target": "Analysis-Read-Next",
        "thru": null,
        "line": 561
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 565
      },
      {
        "target": "headings",
        "thru": null,
        "line": 588
      },
      {
        "target": "headings",
        "thru": null,
        "line": 601
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 608
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 630
      },
      {
        "target": "Analysis-Open-Input",
        "thru": null,
        "line": 639
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 641
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 643
      },
      {
        "target": "Analysis-Read-Next",
        "thru": null,
        "line": 653
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 658
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 695
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 700
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 712
      },
      {
        "target": "Value-Open",
        "thru": null,
        "line": 796
      },
      {
        "target": "Analysis-Open-Output",
        "thru": null,
        "line": 797
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 799
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 806
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 809
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 812
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 815
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 819
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 823
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 827
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 830
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 833
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 836
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 844
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 848
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 852
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 855
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 858
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 861
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 864
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 867
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 870
      },
      {
        "target": "create-value",
        "thru": null,
        "line": 873
      },
      {
        "target": "Value-Close",
        "thru": null,
        "line": 875
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 876
      },
      {
        "target": "Value-Read-Indexed",
        "thru": null,
        "line": 887
      },
      {
        "target": "Value-Write",
        "thru": null,
        "line": 892
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 894
      },
      {
        "target": "Analysis-Write",
        "thru": null,
        "line": 898
      },
      {
        "target": "aa101-Check-4-Errors",
        "thru": null,
        "line": 900
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "references",
        "to": "File-Status - discontinued",
        "line": 60
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 289
      },
      {
        "from": "prog-name",
        "to": "l1-version",
        "line": 300
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 304
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 305
      },
      {
        "from": "zero",
        "to": "menu-reply",
        "line": 321
      },
      {
        "from": "spaces",
        "to": "l5-led-lit\n              perform  report1",
        "line": 345
      },
      {
        "from": "\"Lgr\"",
        "to": "l5-led-lit\n              move \"A\" to Print-Mode\n              perform  report1",
        "line": 348
      },
      {
        "from": "6",
        "to": "lin",
        "line": 409
      },
      {
        "from": "spaces",
        "to": "pa-group",
        "line": 412
      },
      {
        "from": "2",
        "to": "cole",
        "line": 413
      },
      {
        "from": "\"P\"",
        "to": "pa-system",
        "line": 418
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 419
      },
      {
        "from": "WS-PA-Code",
        "to": "save-code",
        "line": 428
      },
      {
        "from": "space",
        "to": "pa-second",
        "line": 432
      },
      {
        "from": "save-code",
        "to": "WS-PA-Code",
        "line": 447
      },
      {
        "from": "zero",
        "to": "pa-gl",
        "line": 448
      },
      {
        "from": "spaces",
        "to": "pa-desc",
        "line": 449
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 453
      },
      {
        "from": "6",
        "to": "lin",
        "line": 472
      },
      {
        "from": "6",
        "to": "lin",
        "line": 489
      },
      {
        "from": "2",
        "to": "cole",
        "line": 492
      },
      {
        "from": "spaces",
        "to": "pa-group",
        "line": 493
      },
      {
        "from": "\"P\"",
        "to": "pa-system",
        "line": 498
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 499
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 513
      },
      {
        "from": "1",
        "to": "File-Key-No\n              perform Analysis-Delete  *> delete  analysis-file\n              if       fs-Reply not = zero\n                       perform  aa101-Check-4-Errors\n              end-if\n     else\n*>              rewrite analysis-record",
        "line": 526
      },
      {
        "from": "6",
        "to": "lin",
        "line": 542
      },
      {
        "from": "zero",
        "to": "a",
        "line": 556
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n              add   1 to line-cnt\n              move  \"Group\"  to  l6-type\n              if  Print-All\n                  move pa-system to l6-ledger\n              end-if\n     else\n              move  \"Detail\" to l6-type\n              move space to l6-ledger\n     end-if\n     if       line-cnt > 70\n              perform headings",
        "line": 576
      },
      {
        "from": "1",
        "to": "ws-err-flag",
        "line": 592
      },
      {
        "from": "pa-group",
        "to": "l6-code",
        "line": 593
      },
      {
        "from": "pa-gl",
        "to": "l6-gl",
        "line": 594
      },
      {
        "from": "pa-desc",
        "to": "l6-desc",
        "line": 595
      },
      {
        "from": "pa-print",
        "to": "l6-print",
        "line": 596
      },
      {
        "from": "a",
        "to": "l1-page",
        "line": 607
      },
      {
        "from": "ws-date",
        "to": "l2-date",
        "line": 609
      },
      {
        "from": "usera",
        "to": "l2-user",
        "line": 610
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record from line-1 before 1",
        "line": 614
      },
      {
        "from": "5",
        "to": "line-cnt",
        "line": 620
      },
      {
        "from": "6",
        "to": "lin",
        "line": 642
      },
      {
        "from": "6",
        "to": "lin",
        "line": 644
      },
      {
        "from": "ws-lines",
        "to": "lin\n              go to  accept-of-show",
        "line": 655
      },
      {
        "from": "ws-lines",
        "to": "lin\n              go to accept-of-show",
        "line": 664
      },
      {
        "from": "2",
        "to": "cole",
        "line": 668
      },
      {
        "from": "8",
        "to": "cole",
        "line": 670
      },
      {
        "from": "20",
        "to": "cole",
        "line": 672
      },
      {
        "from": "\"Group\"",
        "to": "l6-type\n     else\n              move  \"Detail\" to  l6-type",
        "line": 677
      },
      {
        "from": "48",
        "to": "cole",
        "line": 680
      },
      {
        "from": "55",
        "to": "cole",
        "line": 682
      },
      {
        "from": "6",
        "to": "lin\n              go to     show-read",
        "line": 696
      },
      {
        "from": "6",
        "to": "lin",
        "line": 742
      },
      {
        "from": "1",
        "to": "cole",
        "line": 743
      },
      {
        "from": "8",
        "to": "cole",
        "line": 778
      },
      {
        "from": "20",
        "to": "cole",
        "line": 782
      },
      {
        "from": "pa-group",
        "to": "pa-print",
        "line": 787
      },
      {
        "from": "48",
        "to": "cole",
        "line": 788
      },
      {
        "from": "zeros",
        "to": "pa-gl",
        "line": 801
      },
      {
        "from": "spaces",
        "to": "pa-print",
        "line": 802
      },
      {
        "from": "\"S\"",
        "to": "pa-system",
        "line": 803
      },
      {
        "from": "\"vi\"",
        "to": "pa-group",
        "line": 807
      },
      {
        "from": "\"vj\"",
        "to": "pa-group",
        "line": 810
      },
      {
        "from": "\"zc\"",
        "to": "pa-group",
        "line": 816
      },
      {
        "from": "\"P&P\"",
        "to": "pa-print",
        "line": 818
      },
      {
        "from": "\"zd\"",
        "to": "pa-group",
        "line": 820
      },
      {
        "from": "\"LCG\"",
        "to": "pa-print",
        "line": 822
      },
      {
        "from": "\"vo\"",
        "to": "pa-group",
        "line": 824
      },
      {
        "from": "spaces",
        "to": "pa-print",
        "line": 825
      },
      {
        "from": "\"vp\"",
        "to": "pa-group",
        "line": 828
      },
      {
        "from": "\"a1\"",
        "to": "pa-group",
        "line": 834
      },
      {
        "from": "\"P\"",
        "to": "pa-system",
        "line": 840
      },
      {
        "from": "\"za\"",
        "to": "pa-group",
        "line": 841
      },
      {
        "from": "\"P&P\"",
        "to": "pa-print",
        "line": 843
      },
      {
        "from": "\"zb\"",
        "to": "pa-group",
        "line": 845
      },
      {
        "from": "\"LCG\"",
        "to": "pa-print",
        "line": 847
      },
      {
        "from": "spaces",
        "to": "pa-print",
        "line": 849
      },
      {
        "from": "\"a1\"",
        "to": "pa-group",
        "line": 853
      },
      {
        "from": "\"a2\"",
        "to": "PA-Group",
        "line": 856
      },
      {
        "from": "\"a3\"",
        "to": "PA-Group",
        "line": 859
      },
      {
        "from": "\"a4\"",
        "to": "PA-Group",
        "line": 862
      },
      {
        "from": "\"a5\"",
        "to": "PA-Group",
        "line": 865
      },
      {
        "from": "\"a6\"",
        "to": "PA-Group",
        "line": 868
      },
      {
        "from": "\"a7\"",
        "to": "PA-Group",
        "line": 871
      },
      {
        "from": "WS-PA-Code",
        "to": "va-code",
        "line": 884
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 886
      },
      {
        "from": "Ws-Analysis-Record",
        "to": "WS-Value-Record\n              move zero to va-v-this va-v-last va-v-year\n                           va-t-this va-t-last va-t-year\n              perform  Value-Write\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     perform  Analysis-Write",
        "line": 889
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 912
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 915
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 919
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 926
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "Pa-System Not = \"P\".\n*> 08/08/84 Vbc - Disp Print In Get-Pa-Print & Remove Stop In Line6\n*> 22/03/09 vbc - Migration to Open Cobol v3.00.00.\n*> 26/03/09 vbc - Support long screens.\n*> 05/04/09 vbc - Additional report for all ledgers and a warning if any\n*>                PA codes contain zero as a GL number.\n*> 14/12/11 vbc - .08 Error msgs to SLnnn.Support for dates other than UK\n*>                    Support for path+filenames.\n*>                    Updated version to 3.01.nn\n*> 11/12/11 vbc - .09 Changed usage of Stk-Date-Form to the global field Date-Form making former redundent.\n*> 12/05/13 vbc - .10 Force setup of Default group a, a1 for sales and purchases\n*>                    as std codes.\n*> 18/05/13 vbc - .11 Support for direct call from Stock to create default PA codes.\n*> 24/07/16 vbc - .12 Support for RDB processing. at least for the analysis file/table...\n*> 24/10/16 vbc - .13 ALL programs now using wsnames.cob in copybooks\n*> 30/10/16 vbc - .14 Remove references to File-Status - discontinued.\n*>                    Support for RDB value & Analysis records with file proc dropped.\n*> 09/01/18 vbc - .15 Support for RDB on ALL other tables\n*>                    instead of just cobol files. Update version to v3.02\n*>                    Replaced use of maps99 with display if needed.\n*>                    Now uses Proc-ACAS-FH-Calls.cob for all FH & DAL calls\n*> 08/04/18 vbc - .16 Support for call by ACAS on init. system use where ws-Process-Func = 1\n*>                    keeps code in balance with sl070, but sl070 used as does both ledgers.\n*> 29/04/18 vbc - .17 Make zeriosed GL vals zero and not blank when\n*>                    printing GL fields giving all 6 GL A/C digits.\n*> 03/04/23 vbc - .18 Change printer FD from 132 to 80 - same as sl070.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 18/01/25 vbc - .19 On tests for Value FS-Reply = 21 also test for 23 - JIC\n*>                    Analysis will create for both Sales and Purchases.\n*>                    Do same for sl070.\n*> 24/08/25 vbc   .20 Minor adjusts for heads. Ditto SL070.\n*>                    Make warnngs of zero a/c entries the same - PL & SL.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selanal.cob\".\n*> copy \"selval.cob\".\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdanal.cob\".\n*> copy \"fdval.cob\".\n*>\n fd  print-file.\n*>\n 01  print-record            pic x(80).\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"PL070 (3.02.20)\".\n copy \"print-spool-command-p.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsanal.cob\".\n copy \"wsval.cob\".\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  a               pic 99.\n     03  ws-err-flag     pic 9           value zero.\n     03  escape-code     pic x.\n     03  Print-Mode      pic x           value space.\n         88  Print-All                   value \"A\".\n     03  save-code       pic xxx.\n     03  line-cnt        binary-char     value zero.\n*>\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-21-lines     binary-char unsigned value zero.\n     03  ws-20-lines     binary-char unsigned value zero.\n     03  ws-19-lines     binary-char unsigned value zero.\n     03  ws-18-lines     binary-char unsigned value zero.\n     03  ws-17-lines     binary-char unsigned value zero.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n*>     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n*>     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  Error-Messages.\n*> System Wide\n     03  PL008          pic x(32) value \"PL008 P.A. Code Already Exists!!\".\n     03  PL009          pic x(38) value \"PL009 P.A. Group Code Does Not Exist!!\".\n     03  PL010          pic x(45) value \"PL010 P.A. Group Code Used As Analysis Code!!\".\n     03  PL011          pic x(32) value \"PL011 P.A. Code Does Not Exist!!\".\n     03  PLA12          pic x(33) value \"PLA12 Error on analMT processing\".\n     03  PLA13          pic x(25) value \"PLA13 Hit return for Menu\".\n     03  PLA14          pic x(34) value \"PLA14 Error on valueMT processing\".\n*> Module specific\n*>       NONE\n*>\n 01  error-code          pic 999.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  line-1.   *> 78\n     03  l1-version      pic x(31)       value spaces.\n     03  filler          pic x(39)       value \"Product Analysis Codes\".\n     03  filler          pic x(5)        value \"Page \".\n     03  l1-page         pic zz9.\n*>\n 01  line-2.   *> 78\n     03  l2-user         pic x(30)       value spaces.\n     03  filler          pic x(38)       value spaces.\n     03  l2-date         pic x(10).\n*>\n 01  line-4.\n     03  l5-led-lit      pic x(4)        value \"Lgr\".\n     03  filler          pic x(59)       value \"Code    GL.No.       <-----Description------>  Print\".\n     03  filler          pic x(6)        value  \"-Type-\".\n*>\n 01  line-6.\n     03  filler          pic x           value space.\n     03  l6-ledger       pic x           value spaces.\n     03  filler          pic xxx         value space.\n     03  l6-code         pic x(7).\n     03  l6-gl           pic 9(6).\n     03  filler          pic x(7)        value spaces.\n     03  l6-desc         pic x(24)       value spaces.\n     03  filler          pic x(4)        value spaces.\n     03  l6-print        pic xxx.\n     03  filler          pic x(7)        value spaces.\n     03  l6-type         pic x(6).\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-21-lines.\n     subtract 4 from ws-lines giving ws-20-lines.\n     subtract 5 from ws-lines giving ws-19-lines.\n     subtract 6 from ws-lines giving ws-18-lines.\n     subtract 7 from ws-lines giving ws-17-lines.\n     move     prog-name to l1-version.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     1 to File-Key-No.\n*>\n *>    if       ws-Process-Func not = 1   *> not Called by Stock\n *>             display  \" \" at 0101 with erase eos.\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-15\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    perform  p-a-setup\n              end-if\n     end-if\n     if       ws-Process-Func = 1       *> Called by Stock so we are done\n              go to Menu-Exit.\n*>\n menu-return.\n     move     zero  to  menu-reply.\n     perform  display-heading.\n*>\n menu-input.\n     display  \"Select one of the following by number :- [ ]\" at 0701 with foreground-color 2.\n     display  \"(1)  Set-up P/A records\" at 1004       with foreground-color 2.\n     display  \"(2)  Amend/Delete P/A records\" at 1204 with foreground-color 2.\n     display  \"(3)  Print P/A records\" at 1404        with foreground-color 2.\n     display  \"(4)  Print All P/A records\" at 1604    with foreground-color 2.\n     display  \"(5)  Display P/A records\" at 1804      with foreground-color 2.\n     display  \"(9)  Return to system menu\" at 2004    with foreground-color 2.\n*>\n     accept   menu-reply at 0743 with foreground-color 6 update auto.\n*>\n     if       menu-reply = 9\n              go to  menu-exit.\n     if       menu-reply  <  1  or  >  5\n              go to  menu-input.\n     perform  display-heading.\n     if       menu-reply = 1\n              perform  create.\n     if       menu-reply = 2\n              perform  amend.\n     if       menu-reply = 3\n              move spaces to l5-led-lit\n              perform  report1.\n     if       menu-reply = 4\n              move \"Lgr\" to l5-led-lit\n              move \"A\" to Print-Mode\n              perform  report1.\n     if       menu-reply = 5\n              perform  show.\n     go       to menu-return.\n*>\n aa101-Check-4-Errors.                       *> Analysis-Record - if any errors",
        "line": 45
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display PLA12            at 0601 with erase eos  *> acas015/analMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n*>\n              display \"Keys = \"        at 0720\n              display va-code          at 0727\n*>\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n *>             if      FS-RDBMS-Used\n *>                     perform aa020-Rollback\n *>             end-if\n              display PLA13 at 1101 with erase eol\n              accept  Accept-Reply at 1135\n              go to  menu-Exit\n     end-if.\n*>\n aa102-Check-4-Errors.                       *> Value-Record - if any errors",
        "line": 356
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display PLA14            at 0601 with erase eos  *> acas013/valueMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n*>\n              display \"Keys = \"        at 0720\n              display WS-Pa-Code       at 0727\n*>\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n *>             if      FS-RDBMS-Used\n *>                     perform aa020-Rollback\n *>             end-if\n              display PLA13 at 1101 with erase eol\n              accept  Accept-Reply at 1135\n              go to  Menu-Exit\n     end-if.\n*>\n Menu-Exit.\n     goback.\n*>\n*>****************************************************************\n*>      P R O C E D U R E S                                      *\n*>****************************************************************\n*>\n create       section.\n*>===================\n*>\n     perform  Analysis-Open.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n product-input.\n     perform  display-outline.\n     move     6  to  lin.\n*>\n product-loop.\n     move     spaces  to  pa-group.\n     move     2 to cole.\n     accept   pa-group at curs with foreground-color 3 update.\n     if       pa-group = spaces\n              go to  main-end.\n*>\n     move     \"P\" to pa-system.\n     move     1 to File-Key-No.\n     perform  Analysis-Read-Indexed.  *> read analysis-file not invalid key\n     if       FS-Reply not = 21 and not = 23\n              perform  product-display of show\n              display  PL008 at line ws-23-lines col 01 with foreground-color 3\n              go to    product-loop.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n     move     WS-PA-Code  to  save-code.\n     if       pa-second = space\n              go to  get-details.\n*>\n     move     space    to  pa-second.\n*>\n     perform  Analysis-Read-Indexed.  *> read analysis-file invalid key\n     if       FS-Reply = 21 or = 23\n              display  PL009 at line ws-23-lines col 01 with foreground-color 3\n              go to  product-loop.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n     if       pa-gl not = zero\n              display  PL010 at line ws-23-lines col 01 with foreground-color 3\n              go to  product-loop.\n     display  \" \" at line ws-23-lines col 01 with erase eol.\n*>\n get-details.\n     move     save-code  to  WS-PA-Code.\n     move     zero       to  pa-gl.\n     move     spaces     to  pa-desc.\n*>\n     perform  analysis-data.\n*>\n     move     \"S\"  to   escape-code.\n     display  escape-code at line ws-18-lines col 77  with foreground-color 6.\n     accept   escape-code at line ws-18-lines col 77  with foreground-color 6 update.\n     move     function upper-case (escape-code) to escape-code.\n*>\n main-output.\n     if       escape-code = \"B\"\n              perform  get-pa-desc of analysis-data through  main-exit of analysis-data.\n*>\n     if       escape-code = \"Q\" or \"K\"\n              go to  main-end.\n*>\n     perform  Analysis-Write.  *> write analysis-record.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n     add      1  to  lin.\n*>\n     if       lin  >  ws-22-lines\n              perform  display-outline\n              move  6  to  lin.\n     go to    product-loop.\n*>\n main-end.\n     perform  Analysis-Close.\n*>\n main-exit.   exit section.\n*>\n amend        section.\n*>===================\n*>\n     perform  Analysis-Open.  *> open i-o  analysis-file.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n product-input.\n     perform  display-outline.\n     move     6  to  lin.\n*>\n product-loop.\n     move     2 to cole.\n     move     spaces to pa-group.\n     accept   pa-group at curs with foreground-color 3 update.\n     if       pa-group = spaces\n              go to  main-end.\n*>\n     move     \"P\" to pa-system.\n     move     1 to File-Key-No.\n     perform  Analysis-Read-Indexed.  *> read analysis-file  invalid key\n     if       FS-Reply = 21 or = 23\n              display  PL009 at line ws-23-lines col 01 with foreground-color 3\n              go to  product-loop.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n     display  \" \" at line ws-23-lines col 1 with erase eol.\n     perform  product-display  of  show.\n*>\n get-details.\n     perform  analysis-data.\n*>\n     move     \"S\"  to   escape-code.\n     display  escape-code at line ws-18-lines col 77 with foreground-color 6.\n     accept   escape-code at line ws-18-lines col 77 with foreground-color 6 update.\n     move     function upper-case (escape-code) to escape-code.\n*>\n main-output.\n     if       escape-code = \"B\"\n              perform  get-pa-desc of analysis-data through  main-exit of analysis-data.\n*>\n     if       escape-code = \"Q\"\n              go to  main-end.\n*>\n     if       escape-code = \"K\"\n              move     1 to File-Key-No\n              perform Analysis-Delete  *> delete  analysis-file\n              if       fs-Reply not = zero\n                       perform  aa101-Check-4-Errors\n              end-if\n     else\n*>              rewrite analysis-record.\n              perform Analysis-Rewrite\n              if       fs-Reply not = zero\n                       perform  aa101-Check-4-Errors\n              end-if\n     end-if\n*>\n     add      1  to  lin.\n     if       lin  >  ws-21-lines\n              perform  display-outline\n              move  6  to  lin.\n     go to    product-loop.\n*>\n main-end.\n     perform  Analysis-Close.    *>     close    analysis-file.\n*>\n main-exit.   exit section.\n*>\n report1      section.\n*>===================\n*>\n*>     open     input  analysis-file.\n     perform  Analysis-Open-Input.\n     open     output  print-file.\n     move     zero  to  a.\n     perform  headings.\n*>\n read-loop.\n*>     read     analysis-file  next record  at end\n     perform  Analysis-Read-Next.\n     if       FS-Reply = 10\n              go to  end-report.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n*> AS PA-SYSTEM = P or S therefore 1st time read of S is eof for\n*>  logical end of purchase records.  Do ALL Ledgers\n*>\n     if       pa-system not = \"P\"\n          and not Print-All\n              go to end-report.\n*>\n     if       pa-second = space\n       and    pa-gl = zero\n              move  spaces  to  print-record\n              write print-record after 1\n              add   1 to line-cnt\n              move  \"Group\"  to  l6-type\n              if  Print-All\n                  move pa-system to l6-ledger\n              end-if\n     else\n              move  \"Detail\" to l6-type\n              move space to l6-ledger\n     end-if\n     if       line-cnt > 70\n              perform headings.\n*>\n     if       pa-second not = spaces\n         and  pa-gl = zero\n              move 1 to ws-err-flag.\n     move     pa-group  to  l6-code.\n     move     pa-gl to l6-gl.\n     move     pa-desc  to  l6-desc.\n     move     pa-print  to  l6-print.\n*>\n     write    print-record  from  line-6 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > 70\n              perform  headings.\n*>\n     go       to read-loop.\n*>\n headings.\n     add      1  to  a.\n     move     a  to  l1-page.\n     perform  zz070-Convert-Date.\n     move     ws-date  to  l2-date.\n     move     usera to  l2-user.\n*>\n     if       a not = 1\n              write print-record from line-1 after page\n              move spaces to print-record\n              write print-record after 1\n     else\n              write print-record from line-1 before 1.\n     write    print-record  from  line-2 after 1.\n     write    print-record  from  line-4 after 2.\n     move     5 to line-cnt.\n*>\n end-report.\n     if       ws-err-flag not = zero\n              move \"Warning: One or more P.A. codes contain a zero value for IRS / GL numbers\"\n                              to print-record\n              write print-record after 2.\n*>\n main-end.\n     close    print-file.\n     perform  Analysis-Close.    *>     close    analysis-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-exit.   exit section.\n*>\n show         section.\n*>===================\n*>\n*>     open     input  analysis-file.\n     perform  Analysis-Open-Input.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n     move     6  to  lin.\n     perform  display-outline.\n     move     6  to  lin.\n     display  \"Enter <X> to exit or <Return> to continue...[ ]\" at line ws-23-lines col 31 with foreground-color 2.\n*>\n show-read.\n     if       lin > ws-21-lines\n              go to main-end.\n*>\n sread.\n*>     read     analysis-file  next record at end\n     perform  Analysis-Read-Next.\n     if       FS-Reply = 10\n              move  ws-lines  to  lin\n              go to  accept-of-show.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n*> AS PA-SYSTEM = P or S therefore 1st time read of S is eof for\n*>  logical end of purchase records.\n*>\n     if       pa-system not = \"P\"\n              move  ws-lines  to  lin\n              go to accept-of-show.\n*>\n product-display.\n     move     2 to cole.\n     display  pa-group at curs with foreground-color 3.\n     move     8 to cole.\n     display  pa-gl at curs with foreground-color 3.\n     move     20 to cole.\n     display  pa-desc at curs with foreground-color 3.\n*>\n     if       pa-second  = space\n       and    pa-gl = zero\n              move  \"Group\"  to  l6-type\n     else\n              move  \"Detail\" to  l6-type.\n     move     48 to cole.\n     display  pa-print at curs with foreground-color 3.\n     move     55 to cole.\n     display  l6-type at curs with foreground-color 3.\n*>\n accept-of-show.\n     add      1  to  lin.\n     if       lin  <  ws-22-lines\n              go to  show-read.\n*>\n     accept   ws-reply at line ws-23-lines col 76  with foreground-color 6 update.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       lin > ws-23-lines\n              go to main-end.\n     if       ws-reply not = \"X\"\n              perform   display-outline\n              move  6   to  lin\n              go to     show-read.\n*>\n main-end.\n     perform  Analysis-Close.        *>     close    analysis-file.\n*>\n main-exit.   exit section.\n*>\n*>****************************************************************\n*>       S E R V I C E    R O U T I N E S                        *\n*>****************************************************************\n*>\n display-heading         section.\n*>==============================\n*>\n     display  prog-name at 0101 with erase eos foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171 with foreground-color 2.\n*>\n     if       menu-reply = 0\n              display \"Product Analysis File Set-Up & Maintenance\"  at 0120 with foreground-color 2\n              display \"Function  Menu\" at 0434     with foreground-color 2.\n*>\n     if       menu-reply = 1\n              display \"Set-Up P/A Records\" at 0132  with foreground-color 2.\n*>\n     if       menu-reply = 2\n              display \"Amend/Delete P/A Records\" at 0129 with foreground-color 2.\n*>\n     if       menu-reply = 3\n              display \"Print P/A Records\" at 0132   with foreground-color 2.\n*>\n     if       menu-reply = 4\n              display \"Print All P/A Records\" at 0132 with foreground-color 2.\n*>\n     if       menu-reply = 5\n              display \"Display P/A Records\" at 0131 with foreground-color 2.\n*>\n main-exit.   exit section.\n*>\n display-outline section.\n*>======================\n*>\n     display  \"Code   G/L Nos          Description\" at 0401  with foreground-color 2.\n     display  \"Ref\" at 0448 with foreground-color 2.\n     display  \"Type\" at 0456 with foreground-color 2.\n     move     6  to  lin.\n     move     1 to cole.\n*>\n main-loop.\n     display  \"[  ]  [      ]    [                        ]  [   ]          \" at curs with foreground-color 2.\n*>\n     add      1  to  lin.\n     if       lin  <  ws-23-lines\n              go to   main-loop.\n*>\n     if       menu-reply  not =  5\n              display \"*******************\" at line ws-17-lines col 62 with foreground-color 2\n              display \"*\" at line ws-18-lines col 62  with foreground-color 2\n              display \"*\" at line ws-18-lines col 80  with foreground-color 2\n              display \"*\" at line ws-19-lines col 62  with foreground-color 2\n              display \"*\" at line ws-19-lines col 80  with foreground-color 2\n              display \"*\" at line ws-20-lines col 62  with foreground-color 2\n              display \"*\" at line ws-20-lines col 80  with foreground-color 2\n              display \"*\" at line ws-21-lines col 62  with foreground-color 2\n              display \"*\" at line ws-21-lines col 80  with foreground-color 2\n              display \"*\" at line ws-22-lines col 62  with foreground-color 2\n              display \"*\" at line ws-22-lines col 80  with foreground-color 2\n              display \"*******************\"  at line ws-23-lines col 62 with foreground-color 2.\n*>\n     if       menu-reply not = 5\n              display \"Escape Code [ ]\" at line ws-18-lines col 64   with foreground-color 2\n              display \"<B> = Back\" at line ws-19-lines col 64        with foreground-color 2\n              display \"<S> = Save\" at line ws-20-lines col 64        with foreground-color 2\n              display \"<Q> = Quit\" at line ws-21-lines col 64        with foreground-color 2\n              display \"<K> = Deleted\" at line ws-22-lines col 64     with foreground-color 2.\n*>\n main-exit.   exit section.\n*>\n analysis-data  section.\n*>=====================\n*>\n     move     8 to cole.\n     accept   pa-gl at curs with foreground-color 3 update.\n*>\n get-pa-desc.\n     move     20 to cole.\n     accept   pa-desc  at curs with foreground-color 3 update.\n*>\n get-pa-print.\n     if       menu-reply = 1\n              move  pa-group  to  pa-print.\n     move     48 to cole.\n     accept   pa-print at curs with foreground-color 3 update.\n*>\n main-exit.   exit section.\n*>\n p-a-setup    section.\n*>===================\n*>\n     perform  Value-Open.\n     perform  Analysis-Open-Output.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*> SALES\n     move     zeros  to pa-gl.\n     move     spaces to pa-print.\n     move     \"S\" to pa-system.\n     move     \"v \" to pa-group.\n     move     \"VAT Control\" to pa-desc.\n     perform  create-value.\n     move     \"vi\" to pa-group.\n     move     \"VAT Input Invoices/CN's\" to pa-desc.\n     perform  create-value.\n     move     \"vj\" to pa-group.\n     move     \"VAT Input Receipts\" to pa-desc.\n     perform  create-value.\n     move     \"z \" to pa-group.\n     move     \"Computer Control\" to pa-desc.\n     perform  create-value.\n     move     \"zc\" to pa-group.\n     move     \"Sales Carriage Charges\" to pa-desc.\n     move     \"P&P\"   to pa-print.\n     perform  create-value.\n     move     \"zd\" to pa-group.\n     move     \"Sales Late Charges\" to pa-desc.\n     move     \"LCG\"   to pa-print.\n     perform  create-value.\n     move     \"vo\" to pa-group.\n     move     spaces   to pa-print.\n     move     \"VAT Output Invoices/CN's\" to pa-desc.\n     perform  create-value.\n     move     \"vp\" to pa-group.\n     move     \"VAT Output Receipts\" to pa-desc.\n     perform  create-value.\n     move     \"a \" to pa-group.\n     move     \"Default Group\" to pa-desc.\n     perform  create-value.\n     move     \"a1\" to pa-group.\n     move     \"Default Sales\" to pa-desc.\n     perform  create-value.\n*>\n*> PURCHASE\n*>\n     move     \"P\" to pa-system.\n     move     \"za\" to pa-group.\n     move     \"Purch Carriage Charges\" to pa-desc.\n     move     \"P&P\"   to pa-print.\n     perform  create-value.\n     move     \"zb\" to pa-group.\n     move     \"Purch Late Charges\" to pa-desc.\n     move     \"LCG\"   to pa-print.\n     perform  create-value.\n     move     spaces  to pa-print.\n     move     \"a \" to pa-group.\n     move     \"Default Group\" to pa-desc.\n     perform  create-value.\n     move     \"a1\" to pa-group.\n     move     \"Default Purchases\" to pa-desc.\n     perform  create-value.\n     move     \"a2\" to PA-Group.\n     move     \"Purch for Stock\" to pa-desc.\n     perform  create-value.\n     move     \"a3\" to PA-Group.\n     move     \"Purch for Office Furnit\"  to pa-desc.\n     perform  create-value.\n     move     \"a4\" to PA-Group.\n     move     \"Purch for Office Consum\"  to pa-desc.\n     perform  create-value.\n     move     \"a5\" to PA-Group.\n     move     \"Purch for Office Equipmt\" to pa-desc.\n     perform  create-value.\n     move     \"a6\" to PA-Group.\n     move     \"Purch for Office Autos\"   to pa-desc.\n     perform  create-value.\n     move     \"a7\" to PA-Group.\n     move     \"Purch for Travel\" to pa-desc.\n     perform  create-value.\n*>\n     perform  Value-Close.\n     perform  Analysis-Close.\n*>\n     if       ws-Process-Func not = 1\n              display  \" \" at line ws-23-lines col 01 with erase eol.\n     go       to main-exit.\n*>\n create-value.\n*>\n     move     WS-PA-Code to va-code.\n*>     read     value-file invalid key\n     move     1 to File-Key-No.\n     perform  Value-Read-Indexed\n     if       fs-Reply = 21 or = 23\n              move Ws-Analysis-Record to WS-Value-Record\n              move zero to va-v-this va-v-last va-v-year\n                           va-t-this va-t-last va-t-year\n              perform  Value-Write\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     perform  Analysis-Write.\n     if       fs-Reply not = zero\n              perform  aa101-Check-4-Errors.\n*>\n main-exit.   exit section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 375
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 85,
      "totalOperators": 90,
      "totalOperands": 180,
      "vocabulary": 86,
      "length": 270,
      "volume": 1735.0914837695664
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
