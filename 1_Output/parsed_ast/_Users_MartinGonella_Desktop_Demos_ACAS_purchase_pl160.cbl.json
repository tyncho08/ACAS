{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl160.cbl",
  "fileName": "pl160.cbl",
  "timestamp": "2025-09-15T16:25:47.758Z",
  "programId": "pl160",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 89
      },
      {
        "name": "file",
        "line": 105
      },
      {
        "name": "working-storage",
        "line": 115
      },
      {
        "name": "linkage",
        "line": 272
      },
      {
        "name": "screen",
        "line": 281
      },
      {
        "name": "init01",
        "line": 339
      },
      {
        "name": "report1",
        "line": 359
      },
      {
        "name": "report-selection",
        "line": 382
      },
      {
        "name": "report-produce",
        "line": 434
      },
      {
        "name": "report-heading-setup",
        "line": 623
      },
      {
        "name": "zz050-Validate-Date",
        "line": 716
      },
      {
        "name": "exit",
        "line": 749
      },
      {
        "name": "zz070-Convert-Date",
        "line": 751
      },
      {
        "name": "exit",
        "line": 779
      },
      {
        "name": "maps04",
        "line": 781
      },
      {
        "name": "exit",
        "line": 787
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 92
      },
      {
        "name": "file-defs",
        "line": 336
      },
      {
        "name": "menu-exit",
        "line": 352
      },
      {
        "name": "end-if",
        "line": 374
      },
      {
        "name": "accept-data",
        "line": 390
      },
      {
        "name": "read-loop",
        "line": 443
      },
      {
        "name": "Read-Loop-Tests",
        "line": 468
      },
      {
        "name": "Select-Criteria-Tests-Continued",
        "line": 487
      },
      {
        "name": "test-num",
        "line": 540
      },
      {
        "name": "headings",
        "line": 561
      },
      {
        "name": "listing",
        "line": 581
      },
      {
        "name": "end-report",
        "line": 617
      },
      {
        "name": "zz050-test-date",
        "line": 743
      },
      {
        "name": "zz050-exit",
        "line": 748
      },
      {
        "name": "zz070-Exit",
        "line": 778
      },
      {
        "name": "maps04-exit",
        "line": 786
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "SYSTEM",
        "line": 370,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 784,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 79,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 88,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 95,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 96,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 108,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 109,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 118,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 119,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 120,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 121,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 147,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 203,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 275,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 276,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 277,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 789,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 341
      },
      {
        "target": "report1",
        "thru": null,
        "line": 350
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 362
      },
      {
        "target": "report-selection",
        "thru": null,
        "line": 364
      },
      {
        "target": "report-heading-setup",
        "thru": null,
        "line": 365
      },
      {
        "target": "report-produce",
        "thru": null,
        "line": 366
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 369
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 425
      },
      {
        "target": "headings",
        "thru": null,
        "line": 441
      },
      {
        "target": "Purch-Read-Next-Sorted-ByName",
        "thru": null,
        "line": 456
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 480
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 500
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 508
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 516
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 525
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 533
      },
      {
        "target": "listing",
        "thru": null,
        "line": 537
      },
      {
        "target": "headings",
        "thru": null,
        "line": 585
      },
      {
        "target": "headings",
        "thru": null,
        "line": 609
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 746
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "prog-name",
        "to": "l1-name",
        "line": 340
      },
      {
        "from": "ws-date",
        "to": "l1-date",
        "line": 342
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 343
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 347
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 348
      },
      {
        "from": "spaces",
        "to": "overdue-op  status-in credit-op invoice-op\n                        average-op cust-in print-out",
        "line": 385
      },
      {
        "from": "zero",
        "to": "credit-in invoice-in average-in overdue-in",
        "line": 387
      },
      {
        "from": "cust-in",
        "to": "customer-in",
        "line": 395
      },
      {
        "from": "enter-date-in",
        "to": "ws-test-date",
        "line": 424
      },
      {
        "from": "u-bin",
        "to": "ws-enter-date",
        "line": 430
      },
      {
        "from": "zero",
        "to": "a",
        "line": 440
      },
      {
        "from": "sales-sort-key",
        "to": "WS-Purch-Key",
        "line": 466
      },
      {
        "from": "credit-in",
        "to": "test-1\n              move  purch-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 497
      },
      {
        "from": "invoice-in",
        "to": "test-1\n              move  purch-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 505
      },
      {
        "from": "average-in",
        "to": "test-1\n              move  purch-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 513
      },
      {
        "from": "overdue-in",
        "to": "test-1\n              subtract  purch-last-inv  from  run-date giving  test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 522
      },
      {
        "from": "ws-enter-date",
        "to": "test-1\n              move  purch-create-date to  test-2\n              move  enter-date-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 530
      },
      {
        "from": "1",
        "to": "truth\n     else\n              move  0  to  truth",
        "line": 545
      },
      {
        "from": "1",
        "to": "truth",
        "line": 551
      },
      {
        "from": "1",
        "to": "truth",
        "line": 555
      },
      {
        "from": "1",
        "to": "truth",
        "line": 559
      },
      {
        "from": "a",
        "to": "l3-page",
        "line": 565
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1",
        "line": 569
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 577
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 579
      },
      {
        "from": "WS-Purch-Key",
        "to": "l6-key",
        "line": 586
      },
      {
        "from": "1",
        "to": "y",
        "line": 587
      },
      {
        "from": "\"Active\"",
        "to": "l6-status\n     else\n              move  \"Dormant\" to  l6-status",
        "line": 589
      },
      {
        "from": "spaces",
        "to": "l6-phone",
        "line": 592
      },
      {
        "from": "purch-name",
        "to": "l6-name",
        "line": 593
      },
      {
        "from": "purch-address",
        "to": "l7-address",
        "line": 594
      },
      {
        "from": "purch-phone",
        "to": "l6-phone\n     else\n              string purch-phone delimited by \"  \"\n                     \"x\"         delimited by size\n                     purch-ext   delimited by size  into l6-phone with pointer y",
        "line": 597
      },
      {
        "from": "purch-fax",
        "to": "l6-fax",
        "line": 603
      },
      {
        "from": "purch-limit",
        "to": "l6-limit",
        "line": 604
      },
      {
        "from": "purch-credit",
        "to": "l6-credit",
        "line": 605
      },
      {
        "from": "purch-discount",
        "to": "l6-discount",
        "line": 606
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 613
      },
      {
        "from": "1",
        "to": "y",
        "line": 626
      },
      {
        "from": "spaces",
        "to": "l3-report",
        "line": 627
      },
      {
        "from": "credit-in",
        "to": "cr-days\n              string  credit-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 653
      },
      {
        "from": "invoice-in",
        "to": "act-days\n              string  active-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 666
      },
      {
        "from": "average-in",
        "to": "av-days\n              string  average-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 679
      },
      {
        "from": "overdue-in",
        "to": "ov-days\n              string  overdue-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 692
      },
      {
        "from": "enter-date-in",
        "to": "ed-date\n              string  enter-date-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 705
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 725
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 727
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 731
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 738
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 744
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 745
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 759
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 762
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 766
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 773
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selpl.cob\".\n copy \"selprint.cob\".\n*>\n     select  sales-sort      assign        fn-sales,\n                             access        sequential,\n                             status        fs-reply.\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpl.cob\".\n copy \"fdprint.cob\".\n fd  sales-sort.\n*>\n 01  sales-sort-record.\n     03  sales-sort-key       pic x(7).\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(15) value \"PL160 (3.02.07)\".\n copy \"print-spool-command.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps03.cob\".\n copy \"wspl.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  fn-sales        pic x(12)       value \"suppsort.inx\".\n*>\n 01  ws-data.\n     03  ws-reply        pic x.\n     03  a               pic 99.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  print-out       pic x.\n     03  truth           pic 9.\n         88  a-true                        value  1.\n         88  a-false                       value  zero.\n     03  test-1          binary-long.\n     03  test-2          binary-long.\n     03  test-op         pic x.\n     03  credit-heading.\n         05  cr-operand  pic xx.\n         05  cr-days     pic z9.\n         05  filler      pic x(12)       value  \" Days Credit\".\n     03  active-heading.\n         05  act-operand pic xx.\n         05  act-days    pic zzzz9.\n         05  filler      pic x(9)        value  \" Invoices\".\n     03  average-heading.\n         05  av-operand  pic xx.\n         05  av-days     pic zzzz9.\n         05  filler      pic x(10)       value  \" Av. Value\".\n     03  overdue-heading.\n         05  ov-operand  pic xx.\n         05  ov-days     pic zzzz9.\n         05  filler      pic x(13)       value\n           \" days overdue\".\n     03  enter-date-heading.\n         05  ed-operand  pic xx.\n         05  ed-date     pic x(8).\n         05  filler      pic x(11)       value  \" Entry Date\".\n     03  ws-enter-date   binary-long     value zero.\n     03  address-line    pic x(32).\n     03  test-address    pic x(92).\n     03  line-cnt        binary-char     value zero.\n     03  customer-in     pic x(7).\n     03  cust-in         pic x(6)        value spaces.\n     03  status-in       pic x           value space.\n     03  credit-in       pic 99          value zero.\n     03  credit-op       pic x           value space.\n     03  invoice-in      pic 9(5)        value zero.\n     03  invoice-op      pic x           value space.\n     03  average-in      pic 9(5)        value zero.\n     03  average-op      pic x           value space.\n     03  overdue-in      pic 9(5)        value zero.\n     03  overdue-op      pic x           value space.\n     03  enter-date-in   pic x(10)       value spaces.\n     03  enter-date-op   pic x           value space.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  PL005          pic x(18) value \"PL005 Invalid Date\".\n*> Module specific\n     03  PL170          pic x(18) value \"PL170 Not Found - \".\n*>\n 01  error-code          pic 999.\n*>\n 01  line-1.\n     03  l1-name         pic x(51).\n     03  filler          pic x(73)       value \"Supplier Alphabetical Listing\".\n     03  filler          pic x(5)        value \"Page \".\n     03  l3-page         pic zz9.\n*>\n 01  line-3.\n     03  l3-user         pic x(40).\n     03  filler          pic x(12)       value  \"Report on : \".\n     03  l3-report       pic x(70)       value  spaces.\n     03  l1-date         pic x(10).\n*>\n 01  line-4.\n     03  filler          pic x(51)       value \"Supplier  Status    <----------------Name & Address\".\n     03  filler          pic x(51)       value \"---------------->   ----Telephone----    ----Fax---\".\n     03  filler          pic x(30)       value \"    ----Credit----   Discount \".\n*>\n 01  line-5.\n     03  filler          pic x(87)       value \" Number   ------\".\n     03  filler          pic x(45)       value \"                   Limit   Period\".\n*>\n 01  line-6.\n     03  l6-key          pic x(10).\n     03  l6-status       pic x(10).\n     03  l6-name         pic x(51).\n     03  l6-phone        pic x(17).\n     03  l6-fax          pic x(14).\n     03  l6-limit        pic z(9)9bbbb   blank when zero.\n     03  l6-credit       pic z9bbbbbb    blank when zero.\n     03  l6-discount     pic z9.99       blank when zero.\n*>\n 01  line-7.\n     03  filler          pic x(20)       value spaces.\n     03  l7-address      pic x(96).\n*>\n linkage section.\n*>***************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n screen section.\n*>**************\n*>\n 01  display-03                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  from prog-name  pic x(15)                 line  1 col  1\n                                                    blank screen.\n     03  value \"Supplier File\"                             col 34.\n     03  from to-day     pic x(10)                 line  1 col 71.\n     03  value \"Report Attributes\"                 line  3 col 32.\n     03  value \"Supplier Number - [\"               line  8 col  9.\n     03  using cust-in   pic x(6)                          col 28.\n     03  value \"]\"                                         col 34.\n     03  value \"Enter characters in positions to match\"    col 39.\n     03  value \"Status          - [\"               line 10 col  9.\n     03  using status-in pic x                             col 28.\n     03  value \"]\"                                         col 29.\n     03  value \"<L> Live;<D> Dormant;< > All\"              col 39.\n     03  value \"Credit Period   - [\"               line 12 col  9.\n     03  using credit-in pic 99                            col 28.\n     03  value \"]  [\"                                      col 30.\n     03  using credit-op pic x                             col 34.\n     03  value \"]\"                                 line 12 col 35.\n     03  value \"Enter number of days & operator\"           col 39.\n     03  value \"<L>  for credit periods < than\"    line 13 col 43.\n     03  value \"<G>  for credit periods > than\"    line 14 col 43.\n     03  value \"<E>  for credit periods = to\"      line 15 col 43.\n     03  value \"Invoice Activity  [\"               line 17 col  9.\n     03  using invoice-in pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using invoice-op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter number of orders & operator\"       col 39.\n     03  value \"Average Value   - [\"               line 19 col  9.\n     03  using average-in pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using average-op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter order value & operator\"            col 39.\n     03  value \"Overdue A/Cs    - [\"               line 21 col  9.\n     03  using overdue-in pic 9(5)                         col 28.\n     03  value \"] [\"                                       col 33.\n     03  using overdue-op pic x                            col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter number of days & operator\"           col 39.\n     03  value \"Date Entered-[\"                    line 23 col  9.\n     03  using enter-date-in pic x(10)                     col 23.\n     03  value \"] [\"                                       col 33.\n     03  using enter-date-op pic x                         col 36.\n     03  value \"]\"                                         col 37.\n     03  value \"Enter date & operator\"                     col 39.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     move     prog-name to l1-name.\n     perform  zz070-Convert-Date.\n     move     ws-date to  l1-date.\n     move     usera   to  l3-user.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     1 to File-Key-No.\n*>\n     perform  report1.\n*>\n menu-exit.\n     exit     program.\n*>\n*>*************************************************\n*>               Procedures                       *\n*>*************************************************\n*>\n report1      section.\n*>===================\n*>\n     perform  Purch-Open-Input.     *> open input purchase-file.\n*>\n     perform  report-selection.\n     perform  report-heading-setup.\n     perform  report-produce.\n*>\n     close    print-file.             *>  sales-sort. (closed on read at end)\n     perform  Purch-Close.           *>  close    purchase-file.\n     call     \"SYSTEM\" using Print-Report.\n     if       FS-Cobol-Files-Used             *> Make it a null file\n              open     output sales-sort      *>  but only if processing\n              close    sales-sort             *>   Cobol files\n     end-if.\n*>\n main-exit.   exit section.\n*>\n*>****************************************************************\n*>       S e r v i c e    R o u t i n e s                        *\n*>****************************************************************\n*>\n report-selection section.\n*>***********************\n*>\n     move     spaces to overdue-op  status-in credit-op invoice-op\n                        average-op cust-in print-out.\n     move     zero to credit-in invoice-in average-in overdue-in.\n     display  display-03.\n*>\n accept-data.\n*>**********\n*>\n     accept   display-03.\n     move     function upper-case (cust-in) to cust-in.\n     move     cust-in to customer-in.\n     inspect  customer-in replacing all space by \"Z\".\n*>\n     move     function upper-case (status-in) to status-in.\n     if       status-in  not = \"L\" and not \"D\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (credit-op) to credit-op.\n     if       credit-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (invoice-op) to invoice-op.\n     if       invoice-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (average-op) to average-op.\n     if       average-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (overdue-op) to overdue-op.\n     if       overdue-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (enter-date-op) to enter-date-op.\n     if       enter-date-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     if       enter-date-in = spaces\n              go to main-exit.\n     move     enter-date-in to ws-test-date.\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              display PL005 at 2368 with foreground-color 2   *> this msg may NOT get seen\n              go to accept-data.\n     display  \" \" at 2368 with erase eol.\n     move     u-bin to ws-enter-date.\n*>\n main-exit.   exit section.\n*>\n report-produce              section.\n*>==================================\n*>\n     if       FS-Cobol-Files-Used\n              open     input   sales-sort.\n     open     output  print-file.\n     move     zero  to  a.\n     perform  headings.\n*>\n read-loop.\n*>********\n*>\n*> Here we have two choices\n*> 1: If using files (Cobol), so work via the sort file\n*>    to help select records",
        "line": 76
      },
      {
        "type": "IF",
        "condition": "NOT using files but RDB tables",
        "line": 449
      },
      {
        "type": "IF",
        "condition": "NOT FS-Cobol-Files-Used\n              perform Purch-Read-Next-Sorted-ByName\n              if      fs-reply not = zero        *>   = 10\n                      go to  End-Report\n              end-if\n              go to Read-Loop-Tests\n     end-if\n     read     sales-sort record at end\n              close Sales-Sort\n              go to  end-report.\n*>\n     move     sales-sort-key  to  WS-Purch-Key.\n*>\n Read-Loop-Tests.\n     if       customer-in not = spaces\n         and  WS-Purch-Key < cust-in\n              go to read-loop.\n*>\n     if       customer-in not = spaces\n         and  WS-Purch-Key > customer-in\n              go to read-loop.\n*>\n     if       NOT FS-Cobol-Files-Used\n              go       to Select-Criteria-Tests-Continued.\n*>\n     perform  Purch-Read-Indexed.          *> read purchase-file invalid key\n     if       fs-reply = 21\n              display PL170 at 2301 with foreground-color 4\n              display WS-Purch-Key at 2313 with foreground-color 4\n              go to  read-loop.\n     display  \" \" at 2301 with erase eol.\n*>\n Select-Criteria-Tests-Continued.\n     if       status-in = \"L\"\n         and  supplier-dead\n              go to  read-loop\n      else\n       if    status-in = \"D\"\n         and  supplier-live\n              go to  read-loop.\n*>\n     if       credit-op not = space\n              move  credit-in     to  test-1\n              move  purch-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       invoice-op not = space\n              move  invoice-in     to  test-1\n              move  purch-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       average-op not = space\n              move  average-in    to  test-1\n              move  purch-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       overdue-op not = space\n        and   purch-current  >  0.00\n              move  overdue-in    to  test-1\n              subtract  purch-last-inv  from  run-date giving  test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       enter-date-op not = space\n              move  ws-enter-date     to  test-1\n              move  purch-create-date to  test-2\n              move  enter-date-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     perform  listing.\n     go       to read-loop.\n*>\n test-num.\n*>*******\n*>\n     move     function upper-case (test-op) to test-op.\n     if       test-op = space\n              move  1  to  truth\n     else\n              move  0  to  truth.\n*>\n     if       test-op = \"L\"\n       and    test-2  <  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"G\"\n       and    test-2  >  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"E\"\n       and    test-2  =  test-1\n              move  1  to  truth.\n*>\n headings.\n*>*******\n*>\n     add      1  to  a.\n     move     a  to  l3-page.\n     if       a not = 1\n              write print-record  from  line-1 after page\n              write print-record  from  line-3 after 1\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1.\n     write    print-record  from  line-5 after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     6 to line-cnt.\n*>\n listing.\n*>******\n*>\n     if       line-cnt > Page-Lines\n              perform headings.\n     move     WS-Purch-Key  to  l6-key.\n     move     1 to y.\n     if       supplier-live\n              move  \"Active\"  to  l6-status\n     else\n              move  \"Dormant\" to  l6-status.\n     move     spaces to l6-phone.\n     move     purch-name     to  l6-name.\n     move     purch-address  to  l7-address.\n     inspect  l7-address  replacing  all  pl-delim  by  \",\".\n     if       purch-ext = spaces\n              move purch-phone to l6-phone\n     else\n              string purch-phone delimited by \"  \"\n                     \"x\"         delimited by size\n                     purch-ext   delimited by size  into l6-phone with pointer y.\n*>\n     move     purch-fax to l6-fax.\n     move     purch-limit   to  l6-limit.\n     move     purch-credit  to  l6-credit.\n     move     purch-discount to l6-discount.\n*>\n     if       line-cnt > Page-Lines - 3\n              perform headings.\n*>\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n     move     spaces to print-record.\n     write    print-record after 1.\n     add      3 to line-cnt.\n*>\n end-report.\n*>*********\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-heading-setup  section.\n*>=============================\n*>\n     move     1  to  y.\n     move     spaces  to  l3-report.\n*>\n     if       space = status-in  and  credit-op\n               and  invoice-op   and  average-op\n               and  overdue-op   and  customer-in\n              string  \"All\"  delimited by size  into  l3-report  with  pointer  y\n     else\n              string  \"Matched\"  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       status-in = \"L\"\n              string  \"Live\"  delimited by size  into  l3-report  with  pointer  y.\n     if       status-in = \"D\"\n              string  \"Dormant\"  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       credit-op = \"L\"\n              move    \"< \"  to  cr-operand.\n     if       credit-op = \"G\"\n              move    \"> \"   to  cr-operand.\n     if       credit-op = \"E\"\n              move    \"= \"  to  cr-operand.\n*>\n     if       credit-op not = space\n              move  credit-in  to  cr-days\n              string  credit-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       invoice-op = \"L\"\n              move    \"< \"  to  act-operand.\n     if       invoice-op = \"G\"\n              move    \"> \"   to  act-operand.\n     if       invoice-op = \"E\"\n              move    \"= \"  to  act-operand.\n*>\n     if       invoice-op not = space\n              move  invoice-in  to  act-days\n              string  active-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       average-op = \"L\"\n              move    \"< \"  to  av-operand.\n     if       average-op = \"G\"\n              move    \"> \"   to  av-operand.\n     if       average-op = \"E\"\n              move    \"= \"  to  av-operand.\n*>\n     if       average-op not = space\n              move  average-in  to  av-days\n              string  average-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       overdue-op = \"L\"\n              move    \"< \"  to  ov-operand.\n     if       overdue-op = \"G\"\n              move    \"> \"   to  ov-operand.\n     if       overdue-op = \"E\"\n              move    \"= \"  to  ov-operand.\n*>\n     if       overdue-op not = space\n              move  overdue-in  to  ov-days\n              string  overdue-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       enter-date-op = \"L\"\n              move    \"< \"  to  ed-operand.\n     if       enter-date-op = \"G\"\n              move    \"> \"   to  ed-operand.\n     if       enter-date-op = \"E\"\n              move    \"= \"  to  ed-operand.\n*>\n     if       enter-date-op not = space\n              move  enter-date-in  to  ed-date\n              string  enter-date-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       cust-in not = spaces\n              string  \" Keys Matching - \"  delimited by size\n                      cust-in              delimited by size into  l3-report  with  pointer  y.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 455
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 72,
      "totalOperators": 54,
      "totalOperands": 108,
      "vocabulary": 73,
      "length": 162,
      "volume": 1002.7515785385629
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
