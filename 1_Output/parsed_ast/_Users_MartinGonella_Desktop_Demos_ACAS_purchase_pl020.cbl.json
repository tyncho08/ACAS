{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl020.cbl",
  "fileName": "pl020.cbl",
  "timestamp": "2025-09-15T16:25:47.142Z",
  "programId": "pl020",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 151
      },
      {
        "name": "file",
        "line": 160
      },
      {
        "name": "working-storage",
        "line": 163
      },
      {
        "name": "linkage",
        "line": 357
      },
      {
        "name": "init01",
        "line": 372
      },
      {
        "name": "running-totals",
        "line": 441
      },
      {
        "name": "write-details",
        "line": 467
      },
      {
        "name": "Eval-Status",
        "line": 492
      },
      {
        "name": "comm-routines",
        "line": 502
      },
      {
        "name": "inv-level-1",
        "line": 541
      },
      {
        "name": "Get-Data-1",
        "line": 596
      },
      {
        "name": "erase-screen",
        "line": 713
      },
      {
        "name": "End-Totals",
        "line": 721
      },
      {
        "name": "Total-Screen",
        "line": 798
      },
      {
        "name": "invoice-details",
        "line": 898
      },
      {
        "name": "Get-a-Deleted-Invoice",
        "line": 1045
      },
      {
        "name": "exit",
        "line": 1094
      },
      {
        "name": "CR-Note",
        "line": 1096
      },
      {
        "name": "exit",
        "line": 1163
      },
      {
        "name": "Program-Start",
        "line": 1165
      },
      {
        "name": "zz050-Validate-Date",
        "line": 1222
      },
      {
        "name": "exit",
        "line": 1255
      },
      {
        "name": "zz060-Convert-Date",
        "line": 1257
      },
      {
        "name": "exit",
        "line": 1290
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1292
      },
      {
        "name": "exit",
        "line": 1320
      },
      {
        "name": "zz100-Read-System-Record",
        "line": 1324
      },
      {
        "name": "exit",
        "line": 1338
      },
      {
        "name": "zz110-Write-System-Record",
        "line": 1340
      },
      {
        "name": "exit",
        "line": 1364
      },
      {
        "name": "maps04",
        "line": 1366
      },
      {
        "name": "exit",
        "line": 1372
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 154
      },
      {
        "name": "file-defs",
        "line": 369
      },
      {
        "name": "main",
        "line": 388
      },
      {
        "name": "data-input",
        "line": 402
      },
      {
        "name": "more-data",
        "line": 417
      },
      {
        "name": "Main-Exit",
        "line": 432
      },
      {
        "name": "ih-vat",
        "line": 446
      },
      {
        "name": "accept-money6c",
        "line": 505
      },
      {
        "name": "accept-money7a",
        "line": 515
      },
      {
        "name": "accept-money7b",
        "line": 520
      },
      {
        "name": "accept-money7c",
        "line": 528
      },
      {
        "name": "loop",
        "line": 555
      },
      {
        "name": "Get-Data-1-Main",
        "line": 599
      },
      {
        "name": "get-code",
        "line": 609
      },
      {
        "name": "get-net",
        "line": 653
      },
      {
        "name": "Get-Vat-Code",
        "line": 662
      },
      {
        "name": "get-vat-rate",
        "line": 696
      },
      {
        "name": "End-Totals-Main",
        "line": 724
      },
      {
        "name": "confirmation",
        "line": 745
      },
      {
        "name": "Retry-Write-PInv-Rec",
        "line": 765
      },
      {
        "name": "Total-Screen-Main",
        "line": 801
      },
      {
        "name": "get-days",
        "line": 837
      },
      {
        "name": "get-extra",
        "line": 849
      },
      {
        "name": "get-carriage",
        "line": 867
      },
      {
        "name": "get-carriage-vat",
        "line": 875
      },
      {
        "name": "Invoice-Details-Main",
        "line": 901
      },
      {
        "name": "Date-Input",
        "line": 916
      },
      {
        "name": "Supplier-Input",
        "line": 933
      },
      {
        "name": "supplier-test",
        "line": 939
      },
      {
        "name": "type-input",
        "line": 1008
      },
      {
        "name": "new-supplier",
        "line": 1032
      },
      {
        "name": "l70ab-read",
        "line": 1050
      },
      {
        "name": "l70ab-read-2",
        "line": 1064
      },
      {
        "name": "l70ac-close",
        "line": 1077
      },
      {
        "name": "l70ad-terminate",
        "line": 1087
      },
      {
        "name": "l70ae-exit",
        "line": 1093
      },
      {
        "name": "main",
        "line": 1101
      },
      {
        "name": "main-input",
        "line": 1108
      },
      {
        "name": "No-Inv-Restart",
        "line": 1159
      },
      {
        "name": "Main-Exit",
        "line": 1162
      },
      {
        "name": "menu-exit",
        "line": 1209
      },
      {
        "name": "goback",
        "line": 1217
      },
      {
        "name": "zz050-test-date",
        "line": 1249
      },
      {
        "name": "zz050-exit",
        "line": 1254
      },
      {
        "name": "zz060-Exit",
        "line": 1289
      },
      {
        "name": "zz070-Exit",
        "line": 1319
      },
      {
        "name": "zz100-Exit",
        "line": 1337
      },
      {
        "name": "end-if",
        "line": 1350
      },
      {
        "name": "File-Duplicates-In-Use",
        "line": 1355
      },
      {
        "name": "zz110-Exit",
        "line": 1363
      },
      {
        "name": "maps04-exit",
        "line": 1371
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "pl025",
        "line": 1038,
        "type": "DYNAMIC",
        "using": [
          "WS-calling-data",
          "system-record",
          "to-day",
          "file-defs"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1171,
        "type": "DYNAMIC",
        "using": [
          "File-15",
          "*>",
          "Analysis",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "move",
          "1",
          "to",
          "WS-Process-Func",
          "WS-Sub-Function",
          "call",
          "\"pl070\"",
          "using",
          "WS-calling-data",
          "system-record",
          "to-day",
          "file-defs",
          "call",
          "\"CBL_CHECK_FILE_EXIST\"",
          "using",
          "File-15",
          "*>",
          "Only",
          "if",
          "the",
          "call",
          "failed",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "PL191",
          "at",
          "2301",
          "display",
          "PL003",
          "at",
          "2401",
          "accept",
          "WS-Reply",
          "at",
          "2430",
          "end-if",
          "end-if",
          "end-if",
          "*>",
          "perform",
          "Purch-Open"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1195,
        "type": "DYNAMIC",
        "using": [
          "File-26",
          "*>",
          "Invoice",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "perform",
          "PInvoice-Open-Output",
          "perform",
          "PInvoice-Close",
          "end-if",
          "end-if",
          "*>",
          "move",
          "zero",
          "to",
          "menu-reply"
        ]
      },
      {
        "target": "maps04",
        "line": 1369,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 140,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 149,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 167,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 168,
        "replacing": null
      },
      {
        "name": "wsanal",
        "line": 215,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 217,
        "replacing": null
      },
      {
        "name": "plwsoi5C",
        "line": 218,
        "replacing": null
      },
      {
        "name": "wsfdpinv",
        "line": 219,
        "replacing": null
      },
      {
        "name": "wspdnos",
        "line": 220,
        "replacing": null
      },
      {
        "name": "plwspinv",
        "line": 225,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 301,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 327,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 360,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 361,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 362,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 496,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1374,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 383
      },
      {
        "target": "program-start",
        "thru": null,
        "line": 386
      },
      {
        "target": "invoice-details",
        "thru": null,
        "line": 392
      },
      {
        "target": "inv-level-1",
        "thru": null,
        "line": 410
      },
      {
        "target": "End-Totals",
        "thru": null,
        "line": 415
      },
      {
        "target": "varying",
        "thru": null,
        "line": 448
      },
      {
        "target": "*>",
        "thru": null,
        "line": 451
      },
      {
        "target": "PInvoice-Write",
        "thru": null,
        "line": 476
      },
      {
        "target": "Eval-Status",
        "thru": null,
        "line": 479
      },
      {
        "target": "varying",
        "thru": null,
        "line": 558
      },
      {
        "target": "*>",
        "thru": null,
        "line": 570
      },
      {
        "target": "Get-Data-1",
        "thru": null,
        "line": 582
      },
      {
        "target": "Analysis-Read-Indexed",
        "thru": null,
        "line": 644
      },
      {
        "target": "accept-money7a",
        "thru": "accept-money7b",
        "line": 657
      },
      {
        "target": "accept-money6c",
        "thru": null,
        "line": 698
      },
      {
        "target": "Running-Totals",
        "thru": null,
        "line": 705
      },
      {
        "target": "Total-Screen",
        "thru": null,
        "line": 726
      },
      {
        "target": "erase-screen",
        "thru": null,
        "line": 731
      },
      {
        "target": "PInvoice-Write",
        "thru": null,
        "line": 766
      },
      {
        "target": "zz100-Read-System-Record",
        "thru": null,
        "line": 768
      },
      {
        "target": "zz110-Write-System-Record",
        "thru": null,
        "line": 772
      },
      {
        "target": "Eval-Status",
        "thru": null,
        "line": 776
      },
      {
        "target": "write-details",
        "thru": null,
        "line": 787
      },
      {
        "target": "DelInvNos-Delete",
        "thru": null,
        "line": 790
      },
      {
        "target": "erase-screen",
        "thru": null,
        "line": 794
      },
      {
        "target": "accept-money7c",
        "thru": null,
        "line": 854
      },
      {
        "target": "accept-money7a",
        "thru": "accept-money7b",
        "line": 869
      },
      {
        "target": "accept-money6c",
        "thru": null,
        "line": 877
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 904
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 926
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 954
      },
      {
        "target": "Get-a-Deleted-Invoice",
        "thru": null,
        "line": 967
      },
      {
        "target": "zz100-Read-System-Record",
        "thru": null,
        "line": 969
      },
      {
        "target": "zz110-Write-System-Record",
        "thru": null,
        "line": 975
      },
      {
        "target": "CR-Note",
        "thru": null,
        "line": 1025
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1035
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1036
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 1037
      },
      {
        "target": "program-start",
        "thru": null,
        "line": 1039
      },
      {
        "target": "DelInvNos-Start",
        "thru": null,
        "line": 1059
      },
      {
        "target": "DelInvNos-Read-Next",
        "thru": null,
        "line": 1066
      },
      {
        "target": "DelInvNos-Close",
        "thru": null,
        "line": 1083
      },
      {
        "target": "DelInvNos-Open-Output",
        "thru": null,
        "line": 1084
      },
      {
        "target": "OTM5-Read-Indexed",
        "thru": null,
        "line": 1136
      },
      {
        "target": "main",
        "thru": null,
        "line": 1160
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 1189
      },
      {
        "target": "Analysis-Open",
        "thru": null,
        "line": 1190
      },
      {
        "target": "PInvoice-Open-Output",
        "thru": null,
        "line": 1198
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1199
      },
      {
        "target": "PInvoice-Open",
        "thru": null,
        "line": 1204
      },
      {
        "target": "DelInvNos-Open",
        "thru": null,
        "line": 1205
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1213
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 1214
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 1215
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1252
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 1266
      },
      {
        "target": "System-Open-Input",
        "thru": null,
        "line": 1331
      },
      {
        "target": "System-Read-Indexed",
        "thru": null,
        "line": 1334
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 1335
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 1346
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 1348
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 1349
      },
      {
        "target": "System-Open",
        "thru": null,
        "line": 1358
      },
      {
        "target": "System-Rewrite",
        "thru": null,
        "line": 1360
      },
      {
        "target": "System-Close",
        "thru": null,
        "line": 1361
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines",
        "line": 375
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 384
      },
      {
        "from": "16",
        "to": "lin",
        "line": 398
      },
      {
        "from": "1",
        "to": "cole",
        "line": 399
      },
      {
        "from": "zero",
        "to": "ih-deduct-days ih-deduct-amt ih-discount\n                      ih-p-c ih-net ih-vat",
        "line": 406
      },
      {
        "from": "zero",
        "to": "I",
        "line": 409
      },
      {
        "from": "zero",
        "to": "cob-crt-status",
        "line": 420
      },
      {
        "from": "\"Y\"",
        "to": "WS-reply",
        "line": 421
      },
      {
        "from": "zero",
        "to": "ih-net\n                        ih-vat",
        "line": 445
      },
      {
        "from": "ih-net",
        "to": "display-9",
        "line": 453
      },
      {
        "from": "ih-vat",
        "to": "display-9",
        "line": 456
      },
      {
        "from": "ih-invoice",
        "to": "il-invoice (J)",
        "line": 472
      },
      {
        "from": "J",
        "to": "il-line (J)",
        "line": 473
      },
      {
        "from": "ih-type",
        "to": "il-type (J)",
        "line": 474
      },
      {
        "from": "spaces",
        "to": "exception-msg",
        "line": 495
      },
      {
        "from": "amt-wk-pence6",
        "to": "WS-pence6",
        "line": 508
      },
      {
        "from": "amt-wk-pds6",
        "to": "WS-pound6",
        "line": 509
      },
      {
        "from": "WS-pound6",
        "to": "amt-wk-pds6",
        "line": 512
      },
      {
        "from": "WS-pence6",
        "to": "amt-wk-pence6",
        "line": 513
      },
      {
        "from": "zero",
        "to": "WS-poundsd7 WS-penced7 amt-ok7",
        "line": 518
      },
      {
        "from": "WS-pound7",
        "to": "amt-wk-pds7",
        "line": 525
      },
      {
        "from": "WS-pence7",
        "to": "amt-wk-pence7",
        "line": 526
      },
      {
        "from": "amt-wk-pence7",
        "to": "WS-pence7",
        "line": 531
      },
      {
        "from": "amt-wk-pds7",
        "to": "WS-pound7",
        "line": 532
      },
      {
        "from": "WS-pound7",
        "to": "amt-wk-pds7",
        "line": 535
      },
      {
        "from": "WS-pence7",
        "to": "amt-wk-pence7",
        "line": 536
      },
      {
        "from": "1",
        "to": "cole\n              display \"(\" at curs  with erase eol foreground-color 2\n              move    2 to cole\n              display I at curs with foreground-color 2\n              move    4 to cole\n              display \") [  ]\" at curs with foreground-color 2\n              move    36 to cole\n              display \"[          ] [ ]   {         } (\" at curs with foreground-color 2\n              move    78 to cole\n              display \")\" at curs with foreground-color 2\n     end-perform\n*>\n*> I = no",
        "line": 560
      },
      {
        "from": "1",
        "to": "I ?????\n*>\n     subtract 16 from WS-23-lines giving M",
        "line": 573
      },
      {
        "from": "1",
        "to": "i\n     subtract M  from  I",
        "line": 575
      },
      {
        "from": "1",
        "to": "J",
        "line": 577
      },
      {
        "from": "1",
        "to": "I",
        "line": 579
      },
      {
        "from": "zero",
        "to": "cob-crt-status",
        "line": 581
      },
      {
        "from": "1",
        "to": "new-screen\n              go to  Main-Exit",
        "line": 604
      },
      {
        "from": "zero",
        "to": "new-screen",
        "line": 607
      },
      {
        "from": "7",
        "to": "cole",
        "line": 617
      },
      {
        "from": "WS-pa",
        "to": "il-pa (I) pa-group",
        "line": 624
      },
      {
        "from": "spaces",
        "to": "il-description (I)",
        "line": 625
      },
      {
        "from": "\"P\"",
        "to": "pa-system",
        "line": 640
      },
      {
        "from": "11",
        "to": "cole",
        "line": 641
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 643
      },
      {
        "from": "pa-desc",
        "to": "il-description (I)",
        "line": 651
      },
      {
        "from": "37",
        "to": "cole",
        "line": 656
      },
      {
        "from": "amt-ok7",
        "to": "il-net (I) WS-net",
        "line": 660
      },
      {
        "from": "\"S\"",
        "to": "Vat-Code-X",
        "line": 667
      },
      {
        "from": "50",
        "to": "cole",
        "line": 668
      },
      {
        "from": "1",
        "to": "Vat-Code\n      else\n       If     Vat-Code-X = \"R\"                   *> Reduced  code 2 (05% - 21/08/25)\n              move 2 to Vat-Code\n        else\n         If   Vat-Code-X = \"Z\"                   *> Zero     code 3 (00% - 21/08/25)\n              move 3 to Vat-Code",
        "line": 675
      },
      {
        "from": "Vat-Code",
        "to": "il-Vat-Code (I)",
        "line": 686
      },
      {
        "from": "zero",
        "to": "Amt-OK6\n     else\n              move VAT-Rate (Vat-Code) to WS-VAT-Rate\n              compute  Amt-OK6 rounded = (WS-Net * WS-VAT-Rate) / 100",
        "line": 689
      },
      {
        "from": "WS-VAT",
        "to": "Display-9 il-VAT (I)",
        "line": 694
      },
      {
        "from": "56",
        "to": "cole",
        "line": 697
      },
      {
        "from": "Amt-OK6",
        "to": "Il-Vat (I) WS-Vat",
        "line": 699
      },
      {
        "from": "68",
        "to": "cole",
        "line": 702
      },
      {
        "from": "1",
        "to": "cole",
        "line": 716
      },
      {
        "from": "zero",
        "to": "cob-crt-status",
        "line": 725
      },
      {
        "from": "15",
        "to": "lin",
        "line": 730
      },
      {
        "from": "\"Y\"",
        "to": "WS-reply",
        "line": 746
      },
      {
        "from": "\"P\"",
        "to": "ih-status",
        "line": 759
      },
      {
        "from": "I",
        "to": "ih-lines",
        "line": 761
      },
      {
        "from": "Pinvoice-header",
        "to": "WS-PInvoice-Record",
        "line": 763
      },
      {
        "from": "Next-Folio",
        "to": "Ih-Invoice  *> was updated\n                                     invoice-nos  *> details recs updated\n              add      1 to Next-Folio\n              perform  zz110-Write-System-Record\n              go to    Retry-Write-PInv-Rec\n     end-if\n     if       fs-reply not = zero                  *> for the pinvoice write but not key exists\n              perform Eval-Status\n              display pl180         at line WS-23-lines col  1 with erase eol foreground-color 4\n              display fs-reply      at line WS-23-lines col 36 with foreground-color 3\n              display exception-msg at line WS-23-lines col 39 with foreground-color 3\n              display invoice-key   at line WS-23-lines col 64 with foreground-color 3\n              display pl006         at line WS-lines    col  1 with foreground-color 3\n              accept  WS-reply      at line WS-lines    col 30\n              display \"  \"          at line WS-23-lines col  1 with erase eos\n     end-if\n*>\n     move     zero to  J",
        "line": 769
      },
      {
        "from": "11",
        "to": "lin",
        "line": 792
      },
      {
        "from": "1",
        "to": "p-flag-i",
        "line": 793
      },
      {
        "from": "1",
        "to": "cole",
        "line": 802
      },
      {
        "from": "11",
        "to": "lin",
        "line": 803
      },
      {
        "from": "ih-net",
        "to": "display-9",
        "line": 828
      },
      {
        "from": "ih-vat",
        "to": "display-8",
        "line": 831
      },
      {
        "from": "zero",
        "to": "ih-days ih-carriage",
        "line": 838
      },
      {
        "from": "purch-credit",
        "to": "ih-days",
        "line": 840
      },
      {
        "from": "ih-days",
        "to": "WS-dayes",
        "line": 841
      },
      {
        "from": "WS-dayes",
        "to": "ih-days",
        "line": 847
      },
      {
        "from": "zero",
        "to": "ih-extra ih-e-vat ih-deduct-amt\n                      ih-deduct-vat ih-deduct-days",
        "line": 850
      },
      {
        "from": "1726",
        "to": "curs",
        "line": 852
      },
      {
        "from": "ih-deduct-amt",
        "to": "amt-ok7",
        "line": 853
      },
      {
        "from": "amt-ok7",
        "to": "ih-deduct-amt display-9",
        "line": 857
      },
      {
        "from": "WS-dayes",
        "to": "ih-deduct-days",
        "line": 865
      },
      {
        "from": "1926",
        "to": "curs",
        "line": 868
      },
      {
        "from": "amt-ok7",
        "to": "ih-carriage",
        "line": 870
      },
      {
        "from": "1941",
        "to": "curs",
        "line": 876
      },
      {
        "from": "amt-ok6",
        "to": "ih-c-vat",
        "line": 878
      },
      {
        "from": "1",
        "to": "z\n              go to  Main-Exit",
        "line": 922
      },
      {
        "from": "WS-Date",
        "to": "WS-Test-Date",
        "line": 925
      },
      {
        "from": "U-Bin",
        "to": "ih-date",
        "line": 930
      },
      {
        "from": "WS-Date",
        "to": "WS-Test-Date",
        "line": 931
      },
      {
        "from": "zero",
        "to": "cob-crt-status",
        "line": 934
      },
      {
        "from": "spaces",
        "to": "ih-supplier",
        "line": 935
      },
      {
        "from": "\"Q\"",
        "to": "escape-code\n              go to  Main-Exit",
        "line": 947
      },
      {
        "from": "1",
        "to": "c-check",
        "line": 950
      },
      {
        "from": "ih-supplier",
        "to": "WS-Purch-Key",
        "line": 951
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 953
      },
      {
        "from": "zero",
        "to": "c-check",
        "line": 956
      },
      {
        "from": "zeros",
        "to": "Ih-Invoice",
        "line": 965
      },
      {
        "from": "1",
        "to": "Next-Folio\n              end-if\n              move Next-Folio  to  Ih-invoice\n              add  1 to Next-Folio          *> Remove same code else where <<<<<<<<<<<<<<<<<<<<<<<\n              perform zz110-Write-System-Record",
        "line": 971
      },
      {
        "from": "1",
        "to": "z",
        "line": 981
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 985
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 989
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 993
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 997
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 1001
      },
      {
        "from": "spaces",
        "to": "ih-ref ih-order",
        "line": 1003
      },
      {
        "from": "zero",
        "to": "ih-type",
        "line": 1011
      },
      {
        "from": "space",
        "to": "WS-named",
        "line": 1013
      },
      {
        "from": "zero",
        "to": "ih-cr",
        "line": 1023
      },
      {
        "from": "zero",
        "to": "z",
        "line": 1029
      },
      {
        "from": "zeros",
        "to": "WS-Del-Inv-Nos",
        "line": 1055
      },
      {
        "from": "zeros",
        "to": "ih-invoice",
        "line": 1056
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1057
      },
      {
        "from": "\"N\"",
        "to": "WS-Using-Del-Inv-No\n              go to l70ac-close",
        "line": 1068
      },
      {
        "from": "WS-Del-Inv-Nos",
        "to": "ih-invoice",
        "line": 1072
      },
      {
        "from": "\"Y\"",
        "to": "WS-Using-Del-Inv-No",
        "line": 1074
      },
      {
        "from": "next-invoice",
        "to": "ih-invoice",
        "line": 1090
      },
      {
        "from": "zero",
        "to": "ws-delinv",
        "line": 1091
      },
      {
        "from": "zero",
        "to": "WS-Cr",
        "line": 1113
      },
      {
        "from": "\"Q\"",
        "to": "escape-code\n              go to Main-Exit",
        "line": 1117
      },
      {
        "from": "WS-Cr",
        "to": "ih-cr",
        "line": 1119
      },
      {
        "from": "\"Z\"",
        "to": "WS-named\n              go to  no-inv-restart\n     else\n              move  space  to  WS-named",
        "line": 1121
      },
      {
        "from": "\"Q\"",
        "to": "escape-code\n              go to Main-Exit\n     else\n              move space to escape-code",
        "line": 1127
      },
      {
        "from": "ih-supplier",
        "to": "oi5-supplier",
        "line": 1132
      },
      {
        "from": "ih-cr",
        "to": "oi5-invoice",
        "line": 1133
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1135
      },
      {
        "from": "to-day",
        "to": "U-Date",
        "line": 1169
      },
      {
        "from": "1",
        "to": "WS-Process-Func WS-Sub-Function\n                    call \"pl070\" using WS-calling-data\n                                       system-record\n                                       to-day\n                                       file-defs\n                    call  \"CBL_CHECK_FILE_EXIST\" using File-15   *> Only if the call failed\n                                                       File-Info\n                    if    return-code not = zero          *> not = zero - No file found\n                          display   PL191 at 2301\n                          display   PL003 at 2401\n                          accept WS-Reply at 2430\n                    end-if\n              end-if\n     end-if\n*>\n     perform  Purch-Open",
        "line": 1174
      },
      {
        "from": "zero",
        "to": "menu-reply",
        "line": 1203
      },
      {
        "from": "1",
        "to": "WS-delinv",
        "line": 1206
      },
      {
        "from": "zero",
        "to": "pass-value",
        "line": 1212
      },
      {
        "from": "WS-Test-Date",
        "to": "WS-Date",
        "line": 1231
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1233
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz050-test-date",
        "line": 1237
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "WS-Date",
        "line": 1244
      },
      {
        "from": "WS-Date",
        "to": "U-Date",
        "line": 1250
      },
      {
        "from": "zero",
        "to": "U-Bin",
        "line": 1251
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 1268
      },
      {
        "from": "U-Date",
        "to": "WS-Date",
        "line": 1270
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1273
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz060-Exit",
        "line": 1277
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-Date",
        "line": 1284
      },
      {
        "from": "to-day",
        "to": "WS-Date",
        "line": 1300
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1303
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz070-Exit",
        "line": 1307
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-Date",
        "line": 1314
      },
      {
        "from": "zeros",
        "to": "File-System-Used\n                       File-Duplicates-In-Use",
        "line": 1327
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 1329
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1330
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1333
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses\n              move     1 to File-Key-No\n              perform  System-Open\n              move     1 to File-Key-No\n              perform  System-Rewrite\n              perform  System-Close\n     end-if",
        "line": 1344
      },
      {
        "from": "zeros",
        "to": "File-System-Used\n                       File-Duplicates-In-Use",
        "line": 1354
      },
      {
        "from": "\"00\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 1356
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1357
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1359
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "Next-Folio = Zero\n*> 08/08/84 Vbc - Open Files After Calling Pl025.\n*> 07/01/85 Vbc - Fix Bug In Cr-Notes (Clear Screen).\n*> 22/03/09 vbc - Migration to Open Cobol v3.00.00.\n*> 04/04/09 vbc - Support for F1 (or NEW) on supplier no. to create new\n*>                account.  Added support for deleted folio no. and\n*>                deleting record after re-use, matches SL910.\n*> 12/12/11 vbc - .07 Error msgs to SLnnn.Support for dates other than UK\n*>                    Support for path+filenames.\n*>                    Updated version to 3.01.nn\n*> 18/04/13 vbc - .08 Clear F1 display after supplier found. Matches sl010.\n*> 30/04/15 vbc - .09 Changed file access for delinvoices (and for Sales sl910)\n*>                    to ISAM - other modules need changing?\n*> 24/10/16 vbc - .   ALL programs now using wsnames.cob in copybooks\n*> 31/10/16 vbc - .10 Support for RDB on  Analysis tables\n*>                    instead of Just cobol files\n*>                    using acas015. Update version to v3.02\n*> 29/04/17 vbc - .11 Replaced use of maps99.\n*> 06/05/17           Now uses Proc-ACAS-FH-Calls.cob for all FH & DAL calls\n*>                    Added in support for remaining FH & DALs.\n*> 07/11/17 vbc - .12 Changed all ref for il (n) table to sil (n) n = 1 to 40.\n*> 01/01/18 vbc - .13 Redoing fd/ws group records etc as screwed up last time.\n*>                    Same for all of the other programs that use Invoice and\n*>                    OTM files/WS group areas etc.\n*> 29/03/18 vbc - .14 Change msg 180 from file to rec.\n*>                    On CR notes changed check from invoice to OTM5 rec as\n*>                    should not be issuing CR for unposted invoices - same\n*>                    as SL and for the same reason. Just as well no one seems\n*>                    to use this option but wrong anyway and if inv not found\n*>                    Just offer re-input of inv.\n*>                    Changed CR-Notes to use OTM5 file (& chk it exists) and\n*>                    if inv not found Just offer re-input of inv.\n*>                    Also added tests for on hold or closed & renamed err msgs\n*> 09/12/22 vbc - .15 Added para to start of sections 4 GC 3.2 warning.\n*> 10/03/24 vbc - .16 When writing out invoices/folios if status = dup key read\n*>                    system rec & get next-folio, use it and add 1",
        "line": 58
      },
      {
        "type": "IF",
        "condition": "using a Del Inv. no as it still\n*>                    has to get done. Yes this progran reads and rewrite system\n*>                    rec.  Also as done in SL 910.  NEEDS TESTING.\n*> 12/04/24 vbc - .17 Remove rem'd out old file access verbs and chg case for 1\n*>                    char vars.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 23/04/24 vbc   .18 set I = 1 if zero for get-inv-1 as runtime test shows it as 0.\n*>                    why has this never shown up before in normal running ?\n*>                    Copied over from sl910 - JIC.\n*> 05/01/25 vbc   .19 Add in missing read, rewrite system param rec after\n*>                    updating Next-Folio.\n*> 19/08/25 vbc   .20 See notes ^ for 04/04/09 Remove dup add 1 to next-folio.\n*> 22/08/25 vbc - .21 Support for Vat-Code-X for S(tandard), R(educed), Z(ero)\n*>                    In place of 1, 2, 3. To Match Sales ledger SL910,920\n*>                    On error messages change 'Invoice' to 'Folio'.\n*> 25/08/25 vbc   .22 On running totals missing line #.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n*>\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>------------\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>------------\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"PL020 (3.02.22)\".\n 77  Exception-Msg       pic x(25) value spaces.\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n 01  WS-amount-screen-display6.\n     03  WS-poundsd6     pic 9(6).\n     03  WS-period6      pic x     value \".\".\n     03  WS-penced6      pic v99.\n 01  WS-amount-screen-accept6 redefines WS-amount-screen-display6.\n     03  WS-pound6       pic 9(6).\n     03  filler          pic x.\n     03  WS-pence6       pic v99.\n*>\n 01  WS-amount-work6.\n     03  amt-wk-pds6     pic 9(6).\n     03  amt-wk-pence6   pic v99.\n 01  WS-amount-ok6 redefines WS-amount-work6.\n     03  amt-ok6         pic 9(6)v99.\n*>\n 01  WS-amount-screen-display7.\n     03  WS-poundsd7     pic 9(7).\n     03  WS-period7      pic x     value \".\".\n     03  WS-penced7      pic v99.\n 01  WS-amount-screen-accept7 redefines WS-amount-screen-display7.\n     03  WS-pound7       pic 9(7).\n     03  filler          pic x.\n     03  WS-pence7       pic v99.\n*>\n 01  WS-amount-work7.\n     03  amt-wk-pds7     pic 9(7).\n     03  amt-wk-pence7   pic v99.\n 01  WS-amount-ok7 redefines WS-amount-work7.\n     03  amt-ok7         pic 9(7)v99.\n*>\n 01  WS-discount-display.\n     03  WS-disca1       pic 99.\n     03  WS-disca2       pic x        value \".\".\n     03  WS-disca3       pic v99.\n 01  WS-discount-accept redefines WS-discount-display.\n     03  WS-discb1       pic 99.\n     03  filler          pic x.\n     03  WS-discb3       pic v99.\n 01  WS-discount-work.\n     03  WS-disc-wka     pic 99.\n     03  WS-disc-wkb     pic v99.\n 01  WS-discount redefines WS-discount-work pic 99v99.\n*>\n*>  FD replacements in WS.\n*>\n copy \"wsanal.cob\".     *>  replacing Analysis-Record by WS-Analysis-Record\n                        *>           Pa-Code by WS-Pa-Code\n copy \"wspl.cob\".\n copy \"plwsoi5C.cob\".   *> WS-OTM5-Record.\n copy \"wsfdpinv.cob\".   *> replacing Invoice-Record by WS-PInvoice-Record.\n copy \"wspdnos.cob\".    *> replacing delinvnos-record by ws-del-inv-nos-record\n                        *>           del-inv-nos by ws-del-inv-nos\n*>\n*> Now for WS - invoice table\n*>\n  copy \"plwspinv.cob\".     *> WS record data for head & 40 lines with il- & ih-\n*>\n*> REMARK OUT, ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n*>     03  WS-Analysis-Record     pic x.\n*>     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n*>     03  WS-PInvoice-Record     pic x.\n*>     03  WS-OTM5-Record         pic x.\n*>\n 01  WS-data.\n     03  test-product.\n         05  filler      pic x.\n             88  il-comment              value \"/\".\n         05  filler      pic x(11).\n     03  menu-reply      pic 9.\n     03  WS-reply        pic x.\n     03  c-check         pic 9.\n         88  c-exists                    value 1.\n     03  WS-delinv       pic 9           value zero.\n         88  del-exists                  value 1.\n     03  address-line.\n         05  add-line1   pic x(15).\n         05  add-line2   pic x(21).\n     03  WS-named        pic x           value \" \".\n     03  WS-dash         pic x(80)       value all \"-\".\n     03  work-1          pic 9(7)v99.\n     03  work-n          pic 9(7)v99.\n     03  work-d          pic 9(7)v99.\n     03  display-8       pic z(5)9.99.\n     03  display-9       pic z(6)9.99.\n     03  Vat-Code-X.                           *> this for S, R, Z = Std,Reduced,Zero\n         05  Vat-Code    pic 9.                *> 21/08/25\n     03  I               pic 99.\n     03  J               pic 99.\n     03  K               pic 99.\n     03  M               pic 99.\n     03  Z               pic 99.\n     03  escape-code     pic x.\n     03  new-screen      pic 9(8).\n     03  altypes         pic x(45)       value \"Receipt <<<    Account <<<    Credit Note <<<\".\n     03  filler redefines altypes.\n         05  d-types     pic x(15) occurs 3.\n     03  WS-vat-rate     pic 99v99.\n     03  WS-pa           pic xx.\n     03  WS-product      pic x(12).\n     03  WS-description  pic x(24).\n     03  WS-qty          pic 9(5).\n     03  WS-net          pic 9(7)v99.\n     03  WS-vat          pic 9(7)v99.\n     03  WS-unit         pic 9(6)v99.\n     03  WS-Cr           pic 9(8).\n     03  WS-dayes        pic 99.\n     03  WS-Using-Del-Inv-No pic x       value space.\n*>\n     03  WS-env-lines    pic 999       value zero.\n     03  WS-lines        binary-char unsigned value zero.\n     03  WS-23-lines     binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  WS-Test-Date            pic x(10).\n 01  WS-Date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-Date             pic x(10).\n     03  WS-UK redefines WS-Date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-Date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-Date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  Error-Messages.\n*> System Wide\n     03  PL003          pic x(28) value \"PL003 Hit Return To Continue\".\n     03  PL006          pic x(43) value \"PL006 Note Details & Hit Return to continue\".\n*> Module specific\n     03  PL180          pic x(32) value \"PL180 Err on Folio Rec. write : \".\n     03  PL181          pic x(44) value \"PL181 Folio To Credit Does Not Exist On ITM5\".\n     03  PL182          pic x(29) value \"PL182 Folio To Credit Is Paid\".\n     03  PL183          pic x(40) value \"PL183 Folio To Credit Has Query Flag Set\".\n     03  PL184          pic x(62) value \"PL184 You Can Only Credit Invoices. Not Receipts, Credit Notes\".\n     03  PL185          pic x(56) value \"PL185 Credit of Prompt Pay/Late Charge will be Automatic\".\n     03  PL190          pic x(62) value \"PL190 You can only credit a Folio with the same account number\".\n     03  PL191          pic x(30) value \"PL191 P.A. File Does Not Exist\".\n     03  PL192          pic x(30) value \"PL192 P.A. Code Does Not Exist\".\n     03  PL193          pic x(22) value \"PL193 No such Supplier\".\n*>\n*> 01  error-code          pic 999.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     accept   WS-env-lines   from lines.\n     if       WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines   to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     perform  zz070-Convert-Date.   *> WS-Date now local disp date\n     move     1 to File-Key-No.\n*>\n     perform  program-start.\n*>\n main.\n*>***\n*>\n     initialize Pinvoice-header.\n     perform  invoice-details\n*>\n     if       Z not = zero\n       or     escape-code = \"Q\"\n              go to  Main-Exit.\n*>\n     move     16  to  lin.\n     move     1 to cole.\n     display  space at curs with erase eos.\n*>\n data-input.\n*>*********\n*>\n     initialize Pinvoice-Bodies.\n     move     zero to ih-deduct-days ih-deduct-amt ih-discount\n                      ih-p-c ih-net ih-vat.\n*>\n     move     zero to  I.\n     perform  inv-level-1\n     if       cob-crt-status = cob-scr-esc\n              go to main.\n*>\n     if       I not = 1\n              perform End-Totals.\n*>\n more-data.\n*>\n     display \"Enter Further Invoices? (Y/N) [Y] \" at line WS-lines col 29 with foreground-color 2.\n     move     zero to cob-crt-status.\n     move     \"Y\"  to   WS-reply.\n     accept   WS-reply at line WS-lines col 60 with foreground-color 6 update.\n     move     function upper-case (ws-reply) to WS-reply.\n*>\n     display  space at line WS-lines col 01 with erase eol.\n*>\n     if       WS-reply = \"Y\"\n              go to main.\n     if       WS-reply not = \"N\"\n              go to more-data.\n*>\n Main-Exit.\n*>********\n*>\n     go to    menu-exit  of  program-start.\n*>\n*>****************************************************************\n*>                P R O C E D U R E S                            *\n*>****************************************************************\n*>\n running-totals          section.\n*>==============================\n*>\n     display  I at 1223 with foreground-color 3.\n     move     zero  to  ih-net\n                        ih-vat.\n*>\n     perform  varying K from 1 by 1 until K > i\n              add il-net (K) to ih-net\n              add il-vat (K) to ih-vat\n     end-perform\n*>\n     move     ih-net  to  display-9.\n     display  display-9 at 1237 with foreground-color 3.\n*>\n     move     ih-vat  to  display-9.\n     display  display-9 at 1255 with foreground-color 3.\n*>\n     add      ih-net  ih-vat  giving  display-9.\n*>\n     display  display-9 at 1268 with foreground-color 3.\n     go       to Main-Exit.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n write-details           section.\n*>==============================\n*>\n     add      1  to  J.\n*>\n     move     ih-invoice  to  il-invoice (J).\n     move     J  to  il-line (J).\n     move     ih-type to il-type (J).\n     move     invoice-line (J)  to  WS-PInvoice-Record.\n     perform  PInvoice-Write.\n*>\n     if       fs-reply not = zero\n              perform Eval-Status\n              display pl180         at 2001 with erase eol foreground-color 4\n              display fs-reply      at 2036 with foreground-color 3\n              display exception-msg at 2039 with foreground-color 3\n              display invoice-key   at 2064 with foreground-color 3\n              display pl006         at 2101 with foreground-color 3\n              accept  WS-reply at 2130\n              display space at 2001 with erase eol\n              display space at 2101 with erase eol.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Eval-Status        section.\n*>=========================\n*>\n     move     spaces to exception-msg.\n copy \"FileStat-Msgs.cpy\"  replacing STATUS by fs-reply\n                                     msg    by exception-msg.\n*>\n Main-Exit.   exit section.\n*>************************\n*>\n comm-routines section.\n*>********************\n*>\n accept-money6c.\n*>-------------\n*>\n     move     amt-wk-pence6 to WS-pence6.\n     move     amt-wk-pds6 to WS-pound6.\n     display  WS-amount-screen-display6 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept6 at curs  with foreground-color 3 update.\n     move     WS-pound6 to amt-wk-pds6.\n     move     WS-pence6 to amt-wk-pence6.\n*>\n accept-money7a.\n*>-------------\n*>\n     move     zero to WS-poundsd7 WS-penced7 amt-ok7.\n*>\n accept-money7b.\n*>-------------\n*>\n     display  WS-amount-screen-display7 at curs  with foreground-color 3.\n     accept   WS-amount-screen-accept7 at curs   with foreground-color 3 update.\n     move     WS-pound7 to amt-wk-pds7.\n     move     WS-pence7 to amt-wk-pence7.\n*>\n accept-money7c.\n*>-------------\n*>\n     move     amt-wk-pence7 to WS-pence7.\n     move     amt-wk-pds7 to WS-pound7.\n     display  WS-amount-screen-display7 at curs  with foreground-color 3.\n     accept   WS-amount-screen-accept7 at curs   with foreground-color 3 update.\n     move     WS-pound7 to amt-wk-pds7.\n     move     WS-pence7 to amt-wk-pence7.\n*>\n comm-exit.   exit section.\n*>--------    ----\n*>\n inv-level-1  section.\n*>===================\n*>\n     display  WS-dash   at 1101 with foreground-color 2.\n     display  \"Level 1\" at 1201 with foreground-color 2.\n     display  \"Line - \" at 1216 with foreground-color 2.        *> 23 for # - 2 digit ?\n*>\n     display  \"[          ]\" at 1236 with foreground-color 2.\n     display  \"[          ]\" at 1254 with foreground-color 2.\n     display  \"[          ]\" at 1267 with foreground-color 2.\n*>\n     display  \"Code\" at 1405 with foreground-color 2.\n     display  \"<---Net----> Vat   Vat Amount  Gross Amount\" at 1436 with foreground-color 2.\n*>\n loop.\n*>***\n*>\n     perform  varying lin from 16 by 1 until lin > WS-23-lines\n              add     1  to  i\n              move    1 to cole\n              display \"(\" at curs  with erase eol foreground-color 2\n              move    2 to cole\n              display I at curs with foreground-color 2\n              move    4 to cole\n              display \") [  ]\" at curs with foreground-color 2\n              move    36 to cole\n              display \"[          ] [ ]   {         } (\" at curs with foreground-color 2\n              move    78 to cole\n              display \")\" at curs with foreground-color 2\n     end-perform\n*>\n*> I = no. lines on screen for items,",
        "line": 95
      },
      {
        "type": "IF",
        "condition": "I = zero\n              move  1 to I.\n     display  I at 1223 with foreground-color 3.\n     move     zero to cob-crt-status.\n     perform  Get-Data-1.\n     if       cob-crt-status = cob-scr-esc\n              go to Main-Exit.\n*>\n     if       new-screen = 1\n              go to loop.\n*>\n     if       il-description (I) not = spaces\n        and   I not = 40\n              go to  loop.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Get-Data-1   section.\n*>===================\n*>\n Get-Data-1-Main.\n     add      J  15  giving  lin.\n*>\n     if       lin  >  WS-23-lines\n              subtract 1 from i\n              move 1 to new-screen\n              go to  Main-Exit.\n*>\n     move     zero to new-screen.\n*>\n get-code.\n*>*******\n*>\n     if       I > 1\n         and  il-pa (I) = spaces\n              move il-pa (I - 1) to il-pa (I).\n*>\n     move     il-pa (I) to WS-pa.\n     move     7 to cole.\n     display  WS-pa at curs with foreground-color 3.\n     accept   WS-pa at curs with foreground-color 3 update.\n     if       WS-pa = spaces\n              go to  Main-Exit.\n     if       cob-crt-status = cob-scr-esc\n              go to Main-Exit.\n     move     WS-pa to il-pa (I) pa-group.\n     move     spaces to il-description (I).\n*>\n     if       WS-pa = \"<<\"\n         and  I = 1\n              go to get-code.\n*>\n     if       WS-pa = \"<<\"\n              subtract  1  from  lin\n              if    lin  >  15\n                    subtract  1  from  I\n                    subtract 1 from J\n                    go to  get-code\n              else\n                    subtract  8  from  I\n                    go to  Get-Data-1-Main.\n     move     \"P\" to pa-system.\n     move     11 to cole.\n*>     read     analysis-file  record  invalid key\n     move     1 to File-Key-No.\n     perform  Analysis-Read-Indexed.\n     if       FS-Reply = 21\n              display PL192 at line WS-23-Lines col 1 with foreground-color 4 BEEP\n              go to  get-code.\n     display  \" \" at line WS-23-Lines col 1 with erase eol.\n*>\n     display  pa-desc at curs with foreground-color 3.\n     move     pa-desc to il-description (I).\n*>\n get-net.\n*>******\n*>\n     move     37 to cole.\n     perform  accept-money7a thru accept-money7b.\n     if       amt-ok7 = zero\n              go to get-code.\n     move     amt-ok7 to il-net (I) WS-net.\n*>\n Get-Vat-Code.\n*>\n*>  Only using 1st three as last 2 are for local sales tax (not in UK)\n*>   NOTE that Is Is not currently programmed for (e.g., last 2).\n*>\n     move     \"S\" to Vat-Code-X.\n     move     50 to cole.\n     display  Vat-Code-X at curs with foreground-color 3.\n     accept   Vat-Code-X at curs with foreground-color 3 update UPPER.\n*>\n*>   Accept S, R and Z replacing with 1, 2 & 3.      Rating   %   - Effective (supposed )\n*>\n     If       Vat-Code-X = \"S\"                   *> Standard code 1 (20% - 21/08/25)\n              move 1 to Vat-Code\n      else\n       If     Vat-Code-X = \"R\"                   *> Reduced  code 2 (05% - 21/08/25)\n              move 2 to Vat-Code\n        else\n         If   Vat-Code-X = \"Z\"                   *> Zero     code 3 (00% - 21/08/25)\n              move 3 to Vat-Code.\n*>\n     If       Vat-Code < 1 or > 5                *> using 1st three as last 2 are Sales tax, Not used In the UK but USA ?. 11/09/24\n              go to  Get-Vat-Code.\n*>\n     move     Vat-Code  to  il-Vat-Code (I).\n*>\n     If       Vat-Code = zero\n              move  zero  to  Amt-OK6\n     else\n              move VAT-Rate (Vat-Code) to WS-VAT-Rate\n              compute  Amt-OK6 rounded = (WS-Net * WS-VAT-Rate) / 100.\n*>\n     move     WS-VAT to  Display-9 il-VAT (I).\n*>\n get-vat-rate.\n     move     56 to cole.\n     perform  accept-money6c.\n     move     Amt-OK6 to Il-Vat (I) WS-Vat.\n*>\n     add      WS-Vat WS-Net giving  Display-9.\n     move     68 to cole.\n     display  Display-9 at curs with foreground-color 3.\n*>\n     perform  Running-Totals.\n*>\n     add      1 to J.\n     add      1  to  I.\n     go       to Get-Data-1-Main.\n*>\n Main-Exit.   exit section.\n*>\n erase-screen section.\n*>===================\n*>\n     move     1 to cole.\n     display  space at curs with erase eos.\n*>\n Main-Exit.   exit section.\n*>\n End-Totals   section.\n*>===================\n*>\n End-Totals-Main.\n     move     zero to cob-crt-status.\n     perform  Total-Screen.\n     if       cob-crt-status = cob-scr-esc\n              go to Main-Exit.\n*>\n     move     15  to  lin.\n     perform  erase-screen.\n*>\n     display  \"*********************\" at 1660  with foreground-color 2.\n     display  \"*\" at 1760 with foreground-color 2.\n     display  \"*\" at 1780 with foreground-color 2.\n     display  \"*\" at 1860 with foreground-color 2.\n     display  \"*\" at 1880 with foreground-color 2.\n     display  \"*\" at 1960 with foreground-color 2.\n     display  \"*\" at 1980 with foreground-color 2.\n     display  \"*********************\" at 2060    with foreground-color 2.\n*>\n     display  \"Order ok to store\" at 1761      with foreground-color 2.\n     display  \"(Y/N) ? [Y]\" at 1968 with foreground-color 2.\n*>\n confirmation.\n     move     \"Y\"  to   WS-reply.\n     accept   WS-reply at 1977 with foreground-color 6 update UPPER.\n *>    move     function upper-case (ws-reply) to WS-reply.\n*>\n     if       cob-crt-status = cob-scr-esc\n              go to Main-Exit.\n*>\n     if       WS-reply = \"N\"\n              go to  End-Totals-Main.\n*>\n     if       WS-reply not = \"Y\"\n              go to  confirmation.\n*>\n     move     \"P\"  to  ih-status.\n     subtract 1  from  I.\n     move     I    to  ih-lines.\n*>\n     move     Pinvoice-header  to  WS-PInvoice-Record.\n*>\n Retry-Write-PInv-Rec.\n     perform  PInvoice-Write.\n     if       FS-Reply = 22       *> Key exists get next folio & same param rec\n              perform  zz100-Read-System-Record\n              move     Next-Folio to Ih-Invoice  *> was updated\n                                     invoice-nos  *> details recs updated\n              add      1 to Next-Folio\n              perform  zz110-Write-System-Record\n              go to    Retry-Write-PInv-Rec\n     end-if\n     if       fs-reply not = zero                  *> for the pinvoice write but not key exists\n              perform Eval-Status\n              display pl180         at line WS-23-lines col  1 with erase eol foreground-color 4\n              display fs-reply      at line WS-23-lines col 36 with foreground-color 3\n              display exception-msg at line WS-23-lines col 39 with foreground-color 3\n              display invoice-key   at line WS-23-lines col 64 with foreground-color 3\n              display pl006         at line WS-lines    col  1 with foreground-color 3\n              accept  WS-reply      at line WS-lines    col 30\n              display \"  \"          at line WS-23-lines col  1 with erase eos\n     end-if\n*>\n     move     zero to  J.\n     perform  write-details  I  times.\n*>\n     if       del-exists\n              perform  DelInvNos-Delete.  *> No care if reply not = 0\n*>\n     move     11  to  lin.\n     move     1 to p-flag-i.\n     perform  erase-screen.\n*>\n Main-Exit.   exit section.\n*>\n Total-Screen section.\n*>===================\n*>\n Total-Screen-Main.\n     move     1 to cole.\n     move     11 to lin.\n     display  space at curs with erase eos.\n     display  WS-dash at 1101        with foreground-color 2.\n     display  \"Level 1\" at 1201      with foreground-color 2.\n     display  \"<---Net---->   <---Vat--->\" at 1225  with foreground-color 2.\n     display  \"<---Gross-->     Days\" at 1254       with foreground-color 2.\n     display  \"Sub-Totals\" at 1404   with foreground-color 2.\n     display  \"{          }   {         }\" at 1425  with foreground-color 2.\n     display  \"{          }     [  ]\" at 1454       with foreground-color 2.\n*>\n     display  \"Prompt Payment Disc\" at 1704         with foreground-color 2.\n     display  \"[          ]\" at 1725 with foreground-color 2.\n     display  \"{          }     [  ]\" at 1754       with foreground-color 2.\n*>\n     display  \"Shipping & Handling\" at 1904         with foreground-color 2.\n     display  \"[          ]   [         ]\" at 1925  with foreground-color 2.\n     display  \"{          }\" at 1954 with foreground-color 2.\n*>\n     display  \"------------   -----------\" at 2225  with foreground-color 2.\n     display  \"------------\" at 2254 with foreground-color 2.\n*>\n     display  \"Itemised Totals\" at 2304 with foreground-color 2.\n     display  \"{          }   {         }\" at 2325  with foreground-color 2.\n     display  \"{          }\" at 2354  with foreground-color 2.\n*>\n     move     ih-net  to  display-9.\n     display  display-9 at 1426 with foreground-color 3.\n*>\n     move     ih-vat  to  display-8.\n     display  display-8 at 1441 with foreground-color 3.\n*>\n     add      ih-net  ih-vat  giving  display-9.\n     display  display-9 at 1455 with foreground-color 3.\n*>\n get-days.\n     move     zero to ih-days ih-carriage.\n     if       ih-type = 2\n              move purch-credit to ih-days.\n     move     ih-days to WS-dayes.\n     display  WS-dayes at 1472 with foreground-color 3.\n     if       ih-type not = 2\n              go to get-carriage.\n*>\n     accept   WS-dayes at 1472 with foreground-color 3 update.\n     move     WS-dayes to ih-days.\n*>\n get-extra.\n     move     zero to ih-extra ih-e-vat ih-deduct-amt\n                      ih-deduct-vat ih-deduct-days.\n     move     1726 to curs.\n     move     ih-deduct-amt to amt-ok7.\n     perform  accept-money7c.\n     if       amt-ok7 not < 1000\n              go to get-extra.\n     move     amt-ok7 to ih-deduct-amt display-9.\n*>\n     if       ih-deduct-amt equal  zero\n              go to get-carriage.\n*>\n     display  display-9 at 1755 with foreground-color 3.\n     display  WS-dayes at 1772 with foreground-color 3.\n     accept   WS-dayes at 1772 with foreground-color 3 update.\n     move     WS-dayes to ih-deduct-days.\n*>\n get-carriage.\n     move     1926 to curs.\n     perform  accept-money7a thru accept-money7b.\n     move     amt-ok7 to ih-carriage.\n     compute  amt-ok6 rounded  = ih-carriage * vat-rate-1 / 100.\n*>\n*> Note that vat-rate-1 must be standard rate for p & p\n*>\n get-carriage-vat.\n     move     1941 to curs.\n     perform  accept-money6c.\n     move     amt-ok6 to ih-c-vat.\n     add      ih-carriage  ih-c-vat  giving  display-9.\n     display  display-9 at 1955 with foreground-color 3.\n*>\n     add      ih-net ih-carriage giving  display-9.\n     display  display-9 at 2326 with foreground-color 3.\n*>\n     add      ih-vat ih-c-vat giving  display-8.\n     display  display-8 at 2341 with foreground-color 3.\n*>\n     add      ih-net ih-carriage ih-vat ih-c-vat giving display-9.\n     display  display-9 at 2355 with foreground-color 3.\n     display  \"ok  [ ]\" at 2374 with foreground-color 2.\n     accept   WS-reply at 2379 with foreground-color 3.\n     move     function upper-case (ws-reply) to WS-reply.\n     if       WS-reply not = \"Y\"\n              go to Total-Screen-Main.\n*>\n Main-Exit.   exit section.\n*>\n invoice-details section.\n*>=======================\n*>\n Invoice-Details-Main.\n     display  prog-name at 0101 with erase eos foreground-color 2.\n     display  \"Order Data Entry\" at 0133               with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  WS-Date at 0171 with foreground-color 2.\n*>\n     display  \"****************************************\" at 0441 with foreground-color 2.\n     display  \"*Date [  /  /    ]*A/C Nos    [       ]*\" at 0541 with foreground-color 2.\n     display  \"**                *Order   [          ]*\" at 0641 with foreground-color 2. *> ORd = 69\n     display  \"*Folio  {        }*Ref/Inv [          ]*\" at 0741 with foreground-color 2. *> inv = Ref =  69\n     display  \"****************************************\" at 0841 with foreground-color 2.\n     display  \"F1 = Setup new Supplier\" at 0911                  with foreground-color 2.\n     display   \"Type [ ]  <1> = Receipt; <2> = Account; <3> = Credit Note\"\n                                                         at 1001 with foreground-color 2.\n*>\n Date-Input.\n     display  WS-Date at 0548 with foreground-color 3.\n     accept   WS-Date at 0548 with foreground-color 3 update.\n*>\n     if       cob-crt-status = cob-scr-esc\n        or    WS-Date = spaces\n              move 1 to z\n              go to  Main-Exit.\n*>\n     move     WS-Date to WS-Test-Date.\n     perform  zz050-Validate-Date.\n     if       U-Bin = zero\n              go to  Date-Input.\n*>\n     move     U-Bin  to  ih-date.\n     move     WS-Date to WS-Test-Date.  *> still need orig. disp date as WS-Date now UK\n*>\n Supplier-Input.\n     move     zero to cob-crt-status.\n     move     spaces to ih-supplier.\n     accept   ih-supplier at 0572 with foreground-color 3 UPPER.\n *>    move     function upper-case (ih-supplier) to ih-supplier.\n*>\n supplier-test.\n*>************\n*>\n     if       Ih-Supplier = \"NEW\"\n         or   Cob-Crt-Status = Cob-Scr-F1\n              go to new-supplier.\n*>\n     if       ih-supplier = spaces\n              move  \"Q\"  to  escape-code\n              go to  Main-Exit.\n*>\n     move     1  to  c-check.\n     move     ih-supplier  to  WS-Purch-Key.\n*>\n     move     1 to File-Key-No.\n     perform  Purch-Read-Indexed.\n     if       FS-Reply not = zero\n              move  zero  to  c-check.\n*>\n     if       not  c-exists\n              display  PL193 line WS-23-lines col 1 with foreground-color 4\n                                                         erase eol BEEP\n              go to  Supplier-Input.\n*>\n     display  \"                       \" at 0911.    *> Clear F1 display\n     display  space at line WS-23-lines col 1 with erase eol.\n     move     zeros to Ih-Invoice.\n     if       del-exists\n              perform Get-a-Deleted-Invoice.\n     if       Ih-Invoice = zeros\n              perform zz100-Read-System-Record\n              if      Next-Folio = zero\n                      move 1 to Next-Folio\n              end-if\n              move Next-Folio  to  Ih-invoice\n              add  1 to Next-Folio          *> Remove same code else where <<<<<<<<<<<<<<<<<<<<<<<\n              perform zz110-Write-System-Record.\n*>\n     display  ih-invoice at 0750 with foreground-color 3.  *> Is folio-no\n*>\n     display  purch-name at 0301 with foreground-color 3.\n*>\n     move     1  to  z.\n     unstring purch-address  delimited  by  pl-delim   into  address-line  count Z  pointer  z.\n     display  address-line at 0401 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited  by  pl-delim   into  address-line  count Z  pointer  z.\n     display  address-line at 0501 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited  by  pl-delim   into  address-line  count Z  pointer  z.\n     display  address-line at 0601 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited  by  pl-delim   into  address-line  count Z  pointer  z.\n     display  address-line at 0701 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address   into  address-line  pointer  z.\n     display  address-line at 0801 with foreground-color 3.\n*>\n     move     spaces  to  address-line.\n*>\n     move     spaces to ih-ref ih-order.\n     accept   ih-order at 0669 with foreground-color 3.\n*>\n     accept   ih-ref at 0769 with foreground-color 3.  *> In invoice field\n*>\n type-input.\n*>*********\n*>\n     move     zero to ih-type.\n     accept   ih-type at 1007 with foreground-color 3.\n     move     space to WS-named.\n     if       ih-type = zero\n              go to invoice-details-Main.\n*>\n     if       ih-type  >  3 or = zero\n              go to  type-input.\n     display  space at 1001 with erase eol.\n     display  \">>> \" at 1031 with foreground-color 2.\n     move     d-types (ih-type) to add-line1.\n     display  add-line1 at 1035 with foreground-color 2.\n     move     zero to ih-cr.\n     if       ih-type = 3\n              perform  CR-Note\n              if    escape-code = \"Q\"\n                    go to  invoice-details-Main.\n*>\n     move     zero to z.\n     go       to Main-Exit.\n*>\n new-supplier.\n*>***********\n*>\n     perform  Purch-Close.\n     perform  PInvoice-Close.\n     perform  Analysis-Close.\n     call     \"pl025\" using WS-calling-data system-record to-day file-defs.\n     perform  program-start.\n     go       to invoice-details-Main.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Get-a-Deleted-Invoice section.\n*>============================\n*>\n     if       not del-exists\n              go to l70ad-terminate.\n l70ab-read.\n*>---------\n*>\n*> 30/4/15 new code for ISAM instead of seq\n*>\n     move     zeros to WS-Del-Inv-Nos.\n     move     zeros to ih-invoice.  *> so we can test for it\n     move     1 to File-Key-No.\n     set      fn-not-less-than to true.\n     perform  DelInvNos-Start.\n*>     start    Del-Inv-Nos-File key not < WS-Del-Inv-Nos invalid key\n     if       FS-Reply not = zero\n              go to l70ad-terminate.\n*>\n l70ab-read-2.\n*>-----------\n     perform  DelInvNos-Read-Next.\n     if       fs-reply = 10\n              move     \"N\" to WS-Using-Del-Inv-No\n              go to l70ac-close.\n     if       WS-Del-Inv-Nos = zero\n              go to l70ab-read-2.\n     move     WS-Del-Inv-Nos to ih-invoice.  *> del rec will be deleted after o/p of PO.\n     display  \"Using Deleted Folio Numbers\" at 0345 with foreground-color 2 blink.\n     move     \"Y\" to WS-Using-Del-Inv-No.\n     go       to l70ae-exit.\n*>\n l70ac-close.\n*>==========\n*>\n*> If open as output clear down file and if RDB *MT deletes all records with\n*>  key below 99999999 so same thing\n*>\n     perform  DelInvNos-Close.\n     perform  DelInvNos-Open-Output.\n     display  \"                             \" at 0345.\n*>\n l70ad-terminate.\n*>==============\n*>\n *>    move     next-invoice to ih-invoice.\n     move     zero to ws-delinv.\n*>\n l70ae-exit.\n     exit     section.\n*>\n CR-Note      section.\n*>===================\n*>\n*>  CRs are only processed against posted invoices, hence using OTM5.\n*>\n main.\n     display  space at 1201 with erase eol.\n     display  space at 1301 with erase eol.\n     display  space at 1401 with erase eol.\n     display  space at 1501 with erase eol.\n     display  space at 1601 with erase eol.\n*>\n main-input.\n*>*********\n*>\n     display  \"Folio # to Credit - [        ]\" at 1201  with foreground-color 2.\n*>\n     move     zero  to  WS-Cr.\n*>\n     accept   WS-Cr at 1222 with foreground-color 3 update.\n     if       cob-crt-status = cob-scr-esc\n              move \"Q\" to escape-code\n              go to Main-Exit.\n     move     WS-Cr to ih-cr.\n     if       ih-cr = zero\n              move  \"Z\"  to  WS-named\n              go to  no-inv-restart\n     else\n              move  space  to  WS-named.\n*>\n     if       ih-cr = 99999999\n              move \"Q\" to escape-code\n              go to Main-Exit\n     else\n              move space to escape-code.\n*>\n     move     ih-supplier to oi5-supplier.\n     move     ih-cr       to oi5-invoice.\n*>\n     move     1 to File-Key-No.\n     perform  OTM5-Read-Indexed.\n     if       fs-reply not = zero\n              display PL181 at line WS-23-lines col 01 with foreground-color 4 BEEP\n              go to  Main.     *> was check-inv-no-ok.\n*>\n     display  space at line WS-23-lines col 01 with erase eol.\n     if       invoice-type not = 2\n              display PL184 at line WS-23-lines col 01 with foreground-color 4 BEEP\n              go to main-input.\n*>\n     if       s-closed                  *> Error invoice is Paid\n              display PL182  at line WS-23-lines col 01 with foreground-color 2 highlight BEEP\n              go to main-input\n     else\n              display space at line WS-23-lines col 01 with erase eol.\n*>\n     if       oi-hold-flag = \"Q\"        *> Warning Invoice has query flag set but we can continue\n              display PL183  at line WS-23-lines col 01  with foreground-color 2 highlight.\n*>\n     if       invoice-supplier not = WS-Purch-Key    *> cant happen\n              display PL190 at line WS-23-lines col 01 with foreground-color 4\n              go to main-input.\n*>\n No-Inv-Restart.\n     perform  main.       *> Clear screen lines 12 - 16\n*>\n Main-Exit.\n     exit     section.\n*>\n Program-Start section.\n*>====================\n*>\n     display  space at 0101 with erase eos.\n     move     to-day to U-Date.          *> in UK date form\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-15        *> Analysis\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    move 1 to WS-Process-Func WS-Sub-Function\n                    call \"pl070\" using WS-calling-data\n                                       system-record\n                                       to-day\n                                       file-defs\n                    call  \"CBL_CHECK_FILE_EXIST\" using File-15   *> Only if the call failed\n                                                       File-Info\n                    if    return-code not = zero          *> not = zero - No file found\n                          display   PL191 at 2301\n                          display   PL003 at 2401\n                          accept WS-Reply at 2430\n                    end-if\n              end-if\n     end-if\n*>\n     perform  Purch-Open.\n     perform  Analysis-Open.\n*>\n*> Create Invoice (PO) file if not exist.\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-26      *> Invoice\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    perform  PInvoice-Open-Output\n                    perform  PInvoice-Close\n              end-if\n     end-if\n*>\n     move     zero  to  menu-reply.\n     perform  PInvoice-Open.\n     perform  DelInvNos-Open.\n     move     1 to WS-delinv.        *> above forces file creation.\n     go       to Main-Exit.\n*>\n menu-exit.\n*>********\n*>\n     move     zero to  pass-value.\n     perform  Purch-Close.\n     perform  PInvoice-Close.\n     perform  Analysis-Close.\n*>\n     goback.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   WS-Test-Date\n*> output:  U-Date/WS-Date as uk date format\n*>          U-Bin not zero if valid date\n*>\n     move     WS-Test-Date to WS-Date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to WS-Date.  *> swap Intl to UK form\n     move     WS-Test-Date (1:4) to WS-Year.\n     move     WS-Test-Date (6:2) to WS-Month.\n     move     WS-Test-Date (9:2) to WS-Days.\n*>\n zz050-test-date.\n     move     WS-Date to U-Date.\n     move     zero    to U-Bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   U-Bin\n*> output:  WS-Date as uk/US/Inlt date format\n*>          U-Date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       U-Date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     U-Date to WS-Date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-Date.  *> swap Intl to UK form\n     move     U-Date (7:4) to WS-Intl-Year.\n     move     U-Date (4:2) to WS-Intl-Month.\n     move     U-Date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-Date as uk/US/Inlt date format\n*>\n     move     to-day to WS-Date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days  to WS-swap\n              move WS-month to WS-days\n              move WS-swap  to WS-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-Date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n*> Used when next-invoice and saving it when creating invoice recs.\n*>\n zz100-Read-System-Record  section.\n*>********************************\n*>\n     move     zeros to File-System-Used\n                       File-Duplicates-In-Use.  *> Only use param FILE\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.  *> Force Cobol proc.\n     move     1 to File-Key-No.\n     perform  System-Open-Input.\n*>\n     move     1 to File-Key-No.\n     perform  System-Read-Indexed.\n     perform  System-Close.\n*>\n zz100-Exit.\n     exit     section.\n*>\n zz110-Write-System-Record  section.\n*>*********************************\n*>\n     if       File-System-Used NOT = zero   *> Force RDB processing\n              move     \"66\" to FA-RDBMS-Flat-Statuses\n              move     1 to File-Key-No\n              perform  System-Open\n              move     1 to File-Key-No\n              perform  System-Rewrite\n              perform  System-Close\n     end-if.\n*>\n*> Now do the same for the Cobol file.\n*>\n     move     zeros to File-System-Used\n                       File-Duplicates-In-Use.\n     move     \"00\" to  FA-RDBMS-Flat-Statuses.   *> Force Cobol proc.\n     move     1 to File-Key-No.\n     perform  System-Open.                       *> Open cobol file params as I/O\n     move     1 to File-Key-No.\n     perform  System-Rewrite.                    *> Update Cobol file params\n     perform  System-Close.                      *> Close the Cobol param file.\n*>\n zz110-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 578
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 8,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 138,
      "totalOperators": 148,
      "totalOperands": 296,
      "vocabulary": 139,
      "length": 444,
      "volume": 3160.8098362892374
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
