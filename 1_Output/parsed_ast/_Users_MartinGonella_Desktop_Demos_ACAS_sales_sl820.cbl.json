{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl820.cbl",
  "fileName": "sl820.cbl",
  "timestamp": "2025-09-15T16:25:31.471Z",
  "programId": "sl820",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 90
      },
      {
        "name": "file",
        "line": 102
      },
      {
        "name": "working-storage",
        "line": 106
      },
      {
        "name": "linkage",
        "line": 352
      },
      {
        "name": "init01",
        "line": 366
      },
      {
        "name": "Headings-1",
        "line": 572
      },
      {
        "name": "Analysis-Print",
        "line": 592
      },
      {
        "name": "Extra-Analysis",
        "line": 633
      },
      {
        "name": "zz060-Convert-Date",
        "line": 662
      },
      {
        "name": "zz070-Convert-Date",
        "line": 696
      },
      {
        "name": "Maps04",
        "line": 725
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 94
      },
      {
        "name": "file-defs",
        "line": 363
      },
      {
        "name": "Menu-Return",
        "line": 378
      },
      {
        "name": "Get-Invoice-Record",
        "line": 407
      },
      {
        "name": "Main-End",
        "line": 508
      },
      {
        "name": "Main12",
        "line": 575
      },
      {
        "name": "Cont-HDs",
        "line": 586
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 384,
        "type": "DYNAMIC",
        "using": [
          "File-4",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "SL120",
          "at",
          "0501",
          "with",
          "foreground-color",
          "4",
          "if",
          "WS-Caller",
          "not",
          "=",
          "\"xl150\"",
          "*>",
          "Might",
          "be",
          "called",
          "by",
          "XL150",
          "EOC",
          "(End",
          "of",
          "Cycle)",
          "accept",
          "WS-reply",
          "at",
          "0563",
          "with",
          "foreground-color",
          "6",
          "end-if",
          "goback"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 568,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 728,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 80,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 89,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 97,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 105,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 109,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 110,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 111,
        "replacing": null
      },
      {
        "name": "slwsinv2",
        "line": 205,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 208,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 350,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 355,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 356,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 357,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 732,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "4",
        "thru": null,
        "line": 368
      },
      {
        "target": "*>",
        "thru": null,
        "line": 371
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 374
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 393
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 404
      },
      {
        "target": "SLautogen-Open-Input",
        "thru": null,
        "line": 405
      },
      {
        "target": "SLautogen-Read-Next",
        "thru": null,
        "line": 408
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 416
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 427
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 497
      },
      {
        "target": "Analysis-Print",
        "thru": null,
        "line": 504
      },
      {
        "target": "Extra-Analysis",
        "thru": null,
        "line": 505
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 509
      },
      {
        "target": "SLautogen-Close",
        "thru": null,
        "line": 510
      },
      {
        "target": "main12",
        "thru": null,
        "line": 516
      },
      {
        "target": "4",
        "thru": null,
        "line": 522
      },
      {
        "target": "*>",
        "thru": null,
        "line": 533
      },
      {
        "target": "above",
        "thru": null,
        "line": 543
      },
      {
        "target": "3",
        "thru": null,
        "line": 544
      },
      {
        "target": "if",
        "thru": null,
        "line": 553
      },
      {
        "target": "2",
        "thru": null,
        "line": 556
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 565
      },
      {
        "target": "SLautogen-Read-Next",
        "thru": null,
        "line": 597
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 609
      },
      {
        "target": "headings-1",
        "thru": null,
        "line": 637
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 671
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 367
      },
      {
        "from": "prog-Name",
        "to": "l1-version",
        "line": 373
      },
      {
        "from": "WS-date",
        "to": "l1-date",
        "line": 375
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 376
      },
      {
        "from": "zero",
        "to": "j",
        "line": 403
      },
      {
        "from": "zero",
        "to": "l",
        "line": 412
      },
      {
        "from": "ih-customer",
        "to": "WS-Sales-Key  l5-cust",
        "line": 413
      },
      {
        "from": "space",
        "to": "WS-reply",
        "line": 414
      },
      {
        "from": "\"X\"",
        "to": "WS-reply",
        "line": 418
      },
      {
        "from": "1",
        "to": "WS-error\n     else\n              move Sales-Name  to  l5-Name",
        "line": 422
      },
      {
        "from": "ih-date",
        "to": "u-bin",
        "line": 426
      },
      {
        "from": "WS-date",
        "to": "l5-date",
        "line": 428
      },
      {
        "from": "ih-Deduct-Amt",
        "to": "WS-Deduct-Amt",
        "line": 430
      },
      {
        "from": "ih-Deduct-VAT",
        "to": "WS-Deduct-VAT",
        "line": 431
      },
      {
        "from": "spaces",
        "to": "lb-a  lb-code\n              move  zero    to  lb-amount\n     else\n              move  \"Late Charge \"  to  lb-a\n              move  spaces          to  lb-code\n              move  WS-Deduct-Amt   to  lb-amount",
        "line": 434
      },
      {
        "from": "spaces",
        "to": "lc-a  lc-code  lc-c\n              move  zero    to  lc-amount  lc-VAT\n     else\n              move  \"Discount    \"  to lc-a\n              move  spaces          to lc-code  lc-c\n              move  ih-discount     to lc-amount\n              move  zero            to lc-VAT",
        "line": 442
      },
      {
        "from": "spaces",
        "to": "ld-a  ld-code  ld-c\n              move  zero    to  ld-amount  ld-VAT\n     else\n              move  \"Carriage    \"  to  ld-a\n              move  spaces          to  ld-code  ld-c\n              move  ih-carriage     to  ld-amount\n              if    ih-c-VAT = zero\n                    move  zero  to  ld-VAT\n              else\n                    move  1  to  ld-VAT",
        "line": 451
      },
      {
        "from": "spaces",
        "to": "le-a  le-code  le-c\n              move  zero    to  le-amount  le-VAT\n     else\n              move  extra-desc to  le-a\n              move  spaces     to  le-code\n              move  ih-extra  to  le-amount\n              if    ih-e-VAT = zero\n                    move  zero to  le-VAT\n              else\n                    move  1  to  le-VAT",
        "line": 463
      },
      {
        "from": "ih-Type",
        "to": "a\n              move     WS-lit (a) to L5-Type",
        "line": 475
      },
      {
        "from": "ih-net",
        "to": "l5-goods",
        "line": 480
      },
      {
        "from": "zero",
        "to": "fs-Reply",
        "line": 502
      },
      {
        "from": "ih-Lines",
        "to": "WS-Lines",
        "line": 503
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 3\n     else\n              perform  main12\n     end-if\n     write    print-record from Line-7 after 2",
        "line": 513
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 519
      },
      {
        "from": "zero",
        "to": "a",
        "line": 521
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 541
      },
      {
        "from": "zero",
        "to": "i",
        "line": 543
      },
      {
        "from": "i",
        "to": "l8-VAT-code\n              move  vat-rate (i) to l8-VAT-rate\n              move  Total-cvat (1, i) to l8-amount1\n              move  Total-cvat (2, i) to l8-amount2\n              move  Total-cvat (3, i) to l8-amount3\n              move  Total-cvat (4, i) to l8-amount4\n              write print-record from Line-8 after 1\n     end-perform\n     if       Vat-Rate (4) not = zero    *> test if local tax in use & print if so\n         or   Vat-Rate (5) not = zero    *>  Both - Not used in the UK (so far)\n              perform  2 times\n                       add   1 to i\n                       move  i to l8-VAT-code\n                       move  vat-rate (i) to l8-VAT-rate\n                       move  Total-cvat (1, i) to l8-amount1\n                       move  Total-cvat (2, i) to l8-amount2\n                       move  Total-cvat (3, i) to l8-amount3\n                       move  Total-cvat (4, i) to l8-amount4\n                       write print-record from Line-8 after 1\n              end-perform\n     end-if\n     close    print-file",
        "line": 546
      },
      {
        "from": "j",
        "to": "l3-page",
        "line": 577
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 579
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 589
      },
      {
        "from": "5",
        "to": "Line-cnt",
        "line": 590
      },
      {
        "from": "99",
        "to": "fs-Reply\t\t*> Just in case\n              go to Main-Exit",
        "line": 599
      },
      {
        "from": "il-product",
        "to": "test-product",
        "line": 602
      },
      {
        "from": "spaces",
        "to": "Line-5B\n              move     il-description to L5B-Item-Desc\n              move     il-VAT-Code    to L5B-VAT-Code\n              move     il-pa          to L5B-pa\n              move     il-net         to l5B-goods\n              move     il-Net         to L5B-Net\n              move     il-VAT         to L5B-VAT\n              add      il-Net il-VAT giving L5B-Gross\n              write    print-record from Line-5B after 1\n              add      1 to Line-cnt",
        "line": 611
      },
      {
        "from": "il-pa",
        "to": "la-code",
        "line": 622
      },
      {
        "from": "il-net",
        "to": "la-amount",
        "line": 623
      },
      {
        "from": "il-VAT-code",
        "to": "la-VAT k",
        "line": 624
      },
      {
        "from": "spaces",
        "to": "la-a  la-b  la-c",
        "line": 628
      },
      {
        "from": "spaces",
        "to": "lb-a",
        "line": 642
      },
      {
        "from": "spaces",
        "to": "lc-a",
        "line": 647
      },
      {
        "from": "spaces",
        "to": "ld-a",
        "line": 652
      },
      {
        "from": "spaces",
        "to": "le-a",
        "line": 657
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 673
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 675
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 678
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit",
        "line": 682
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 689
      },
      {
        "from": "to-day",
        "to": "WS-date",
        "line": 704
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 707
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit",
        "line": 711
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 718
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n copy \"fdprint.cob\".  *>  x(132)\n working-storage section.\n*>----------------------\n 77  prog-Name           pic x(15) value \"SL820 (3.02.01)\".\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n*>     03  WS-Invoice-Record      pic x.  *> Used for SLautogen rec\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  WS-data.\n     03  test-product.\n         05  filler      pic x.\n             88  il-comment             value \"/\".\n         05  filler      pic x(11).\n     03  WS-reply        pic x.\n     03  WS-error        pic 9          value zero.\n         88  Sales-missing              value 1.\n     03  a               pic 9          value zero.\n     03  i               pic 99         value zero.\n     03  j               pic 999        value zero.\n     03  k               pic 99         value zero.\n     03  l               pic 99         value zero.\n     03  Total-group    occurs 4     comp-3.\n         05 Total-ded    pic s9(8)v99.\n         05 Total-gds    pic s9(8)v99.\n         05 Total-car    pic s9(8)v99.\n         05 Total-net    pic s9(8)v99.\n         05 Total-VAT    pic s9(8)v99.\n         05 Total-grs    pic s9(8)v99.\n         05 Total-dis    pic s9(8)v99.\n         05 Total-cvat   pic s9(8)v99    occurs 5.\n     03  WS-Deduct-Amt   pic s999v99 comp-3 value zero.\n     03  WS-Deduct-VAT   pic s999v99 comp-3 value zero.\n     03  Line-cnt        binary-char        value zero.\n     03  WS-Lines        pic 99             value zero.     *> 07/08/23\n*>\n 01  WS-Test-Date            pic x(10).\n 01  WS-date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-date             pic x(10).\n     03  WS-UK redefines WS-date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  Error-Messages.\n*> System Wide\n*>       NONE\n*> Module specific\n     03  SL120          pic x(66) value \"SL120 No Autogen Transactions to report! .. Press return for menu.\".\n     03  SL121          pic x(59) value \"SL121 Sales Ledger file not found .. Press return for menu.\".\n*>\n copy \"slwsinv2.cob\".\n 01  WS-Invoice-Record  redefines Invoice-Record\n                         pic x(137).\n copy \"wssl.cob\".\n*>\n 01  WS-group-lits.\n     03  filler          pic x(17)      value \"Receipts\".\n     03  filler          pic x(17)      value \"Invoices\".\n     03  filler          pic x(17)      value \"Credit Notes\".\n     03  filler          pic x(17)      value \"Pro-Formas\".\n 01  filler  redefines WS-group-lits.\n     03  WS-lit          pic x(17)   occurs 4.\n*>\n 01  Line-1.\n     03  l1-version      pic x(44)      value spaces.\n     03  filler          pic x(80)      value \"  Sales Autogen Report\".\n     03  filler          pic x(5)       value \"Page \".\n     03  l3-page         pic zz9.\n*>\n 01  Line-2.\n     03  l3-user         pic x(49)      value spaces.\n     03  filler          pic x(34)      value spaces.\n     03  filler          pic x(39)      value spaces.\n     03  l1-date         pic x(10).\n*>\n 01  Line-4.\n     03  filler          pic x(66)      value \"Invoice  ---Date--- <------------Customer------------>  --Type--\".\n     03  filler          pic x(9)       value spaces.\n     03  filler          pic x(57)      value \"Goods   Anal Vat      <---Net-->  <---VAT-->  <--Gross->\".\n*>\n 01 Line-4B.\n     03  filler          pic x(75)       value space.\n     03  filler          pic x(08)       value spaces.\n     03  filler          pic x(8)        value \"<-Code->\".\n*>\n 01  Line-5.\n     03  filler          pic x(9).\n     03  l5-date         pic x(11).\n     03  l5-cust         pic x(8).\n     03  l5-Name         pic x(25).\n     03  l5-marker       pic x(2)       value spaces.\n     03  l5-type         pic x(15).\n     03  l5-goods        pic z(6)9.99cr.\n     03  filler          pic x(13)      value spaces.\n     03  l5-net          pic z(6)9.99cr.\n     03  l5-VAT          pic z(6)9.99cr.\n     03  l5-gross        pic z(6)9.99cr.\n*>\n*> Line item print\n*>\n 01 Line-5B.\n     03  filler          pic x(45)      value spaces.\n     03  L5B-Item-Desc   pic x(25).\n     03  l5B-Goods       pic z(6)9.99cr.\n     03  filler          pic xx         value spaces.\n     03  L5B-pa          pic xx         value spaces.\n     03  filler          pic xx         value spaces.\n     03  L5B-VAT-Code    pic 9.\n     03  filler          pic x(6)       value spaces.\n     03  l5B-Net         pic z(6)9.99cr.\n     03  l5B-VAT         pic z(6)9.99cr.\n     03  l5B-Gross       pic z(6)9.99cr.\n*>\n*> Totals by type\n*>\n 01  Line-6.\n     03  filler          pic x(7)       value spaces.\n     03  filler          pic x(6)       value \"Total\".\n     03  l6-lit          pic x(18).\n     03  l6-goods        pic z(6)9.99cr.\n     03  l6-disc         pic z(6)9.99cr.\n     03  l6-ded          pic z(6)9.99cr.\n     03  l6-carr         pic z(6)9.99cr.\n     03  l6-net          pic z(6)9.99cr.\n     03  l6-VAT          pic z(6)9.99cr.\n     03  l6-gross        pic z(6)9.99cr.\n*>\n 01  Line-7.\n     03  filler          pic x(36)      value spaces.\n     03  filler          pic x(78)      value \"Goods    Discount  Prompt Pay    Carriage         Net         Vat       Gross\".\n*>\n 01  Line-8.\n     03  filler          pic x(9)       value \"Vat Code\".\n     03  L8-Code-Number.\n         05  l8-VAT-code pic 9.\n         05  filler      pic xxx         value spaces.\n     03  L8-VAT-Type   redefines L8-Code-Number\n                         pic xxxB.\n     03  l8-VAT-rate     pic z9.99.\n     03  filler          pic x(5)       value \"%\".\n     03  l8-amount1      pic z(7)9.99cr.\n     03  l8-amount2      pic z(9)9.99cr.\n     03  l8-amount3      pic z(9)9.99cr.\n     03  l8-amount4      pic z(9)9.99cr.\n*>\n 01  Line-9.\n     03  filler          pic x(79)      value \"V.A.T. Reconciliation       Receipts       Invoices   Credit Notes   Proformas\".\n*>\n 01  Line-a.\n     03  filler          pic x(45)       value spaces.\n     03  la-a            pic x(12).\n     03  la-code         pic x(6).\n     03  la-b            pic x(8).\n     03  la-amount       pic z(6)9.99cr   blank when zero.\n     03  filler          pic x(2)        value spaces.\n     03  la-c            pic x(9).                   *> \"Vat Code\"\n     03  la-VAT          pic z.\n*>\n 01  Line-b.\n     03  filler          pic x(45)       value spaces.\n     03  lb-a            pic x(12)       value spaces.\n     03  lb-code         pic x(6).\n     03  lb-b            pic x(8)        value spaces.\n     03  lb-amount       pic z(6)9.99cr   blank when zero.\n*>\n 01  Line-c.\n     03  filler          pic x(45)       value spaces.\n     03  lc-a            pic x(12).\n     03  lc-code         pic x(6)        value spaces.\n     03  lc-b            pic x(8)        value spaces.\n     03  lc-amount       pic z(6)9.99cr   blank when zero.\n     03  filler          pic x(2)        value spaces.\n     03  lc-c            pic x(9).\n     03  lc-VAT          pic z.\n*>\n 01  Line-d.\n     03  filler          pic x(45)       value spaces.\n     03  ld-a            pic x(12).\n     03  ld-code         pic x(6)        value spaces.\n     03  ld-b            pic x(8)        value spaces.\n     03  ld-amount       pic z(6)9.99cr   blank when zero.\n     03  filler          pic x(2)        value spaces.\n     03  ld-c            pic x(9).\n     03  ld-VAT          pic z.\n*>\n 01  Line-e.\n     03  filler          pic x(45)       value spaces.\n     03  le-a            pic x(12).\n     03  le-code         pic x(6)        value spaces.\n     03  le-b            pic x(8)        value spaces.\n     03  le-amount       pic z(6)9.99cr   blank when zero.\n     03  filler          pic x(2)        value spaces.\n     03  le-c            pic x(9).\n     03  le-VAT          pic z.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n 01  to-day              pic x(10).\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     move     Print-Spool-Name to PSN.\n     perform  4 times\n              add  1 to a\n              initialize Total-Group (a)\n     end-perform\n*>\n     move     prog-Name to l1-version.\n     perform  zz070-Convert-Date.\n     move     WS-date to l1-date.\n     move     1  to File-Key-No.\n*>\n Menu-Return.\n     display  Prog-Name        at 0101 with foreground-color 2 erase eos.\n     display  \"Autogen Report\" at 0136 with foreground-color 2.\n     display  WS-date          at 0171 with foreground-color 2.\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-4\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    display SL120   at 0501 with foreground-color 4\n                    if     WS-Caller not = \"xl150\"    *> Might be called by XL150 EOC (End of Cycle)\n                           accept WS-reply at 0563 with foreground-color 6\n                    end-if\n                    goback.                         *> As no transactions.\n*>\n     perform  Sales-Open-Input.\n     if       FS-Reply not = zero\n                    display SL121   at 0501 with foreground-color 4\n                    if     WS-Caller not = \"xl150\"    *> Might be called by XL150 EOC\n                           accept WS-reply at 0563 with foreground-color 6\n                    end-if\n                    goback.                         *> As no transactions.\n*>\n     open     output print-file.\n*>\n     move     zero  to  j.\n     perform  headings-1.\n     perform  SLautogen-Open-Input.\n*>\n Get-Invoice-Record.\n     perform  SLautogen-Read-Next.\n     if       fs-reply = 10\n              go to  Main-End.\n*>\n     move     zero to l.\n     move     ih-customer to WS-Sales-Key  l5-cust.\n     move     space to WS-reply.\n\n     perform  Sales-Read-Indexed.\n     if       fs-reply  = 21\n              move \"X\" to WS-reply.\n*>\n     if       WS-reply = \"X\"\n              move \"!! Customer Unknown\" to l5-Name\n              move 1 to WS-error\n     else\n              move Sales-Name  to  l5-Name.\n*>\n     move     ih-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     WS-date  to  l5-date.\n*>\n     move     ih-Deduct-Amt to WS-Deduct-Amt.\n     move     ih-Deduct-VAT to WS-Deduct-VAT.\n*>\n     if       WS-Deduct-Amt = zero\n              move  spaces  to  lb-a  lb-code\n              move  zero    to  lb-amount\n     else\n              move  \"Late Charge \"  to  lb-a\n              move  spaces          to  lb-code\n              move  WS-Deduct-Amt   to  lb-amount.\n*>\n     if       ih-discount = zero\n              move  spaces  to  lc-a  lc-code  lc-c\n              move  zero    to  lc-amount  lc-VAT\n     else\n              move  \"Discount    \"  to lc-a\n              move  spaces          to lc-code  lc-c\n              move  ih-discount     to lc-amount\n              move  zero            to lc-VAT.\n*>\n     if       ih-carriage = zero\n              move  spaces  to  ld-a  ld-code  ld-c\n              move  zero    to  ld-amount  ld-VAT\n     else\n              move  \"Carriage    \"  to  ld-a\n              move  spaces          to  ld-code  ld-c\n              move  ih-carriage     to  ld-amount\n              if    ih-c-VAT = zero\n                    move  zero  to  ld-VAT\n              else\n                    move  1  to  ld-VAT.\n*>\n     if       ih-extra = zero\n              move  spaces  to  le-a  le-code  le-c\n              move  zero    to  le-amount  le-VAT\n     else\n              move  extra-desc to  le-a\n              move  spaces     to  le-code\n              move  ih-extra  to  le-amount\n              if    ih-e-VAT = zero\n                    move  zero to  le-VAT\n              else\n                    move  1  to  le-VAT.\n*>\n     if       Ih-Type > 0 and < 5\n              move     ih-Type to a\n              move     WS-lit (a) to L5-Type.\n*>\n     add      ih-c-VAT ih-e-VAT to Total-cvat (a, 1).\n*>\n     move     ih-net  to  l5-goods.\n     add      ih-VAT  ih-c-VAT  ih-e-VAT  WS-Deduct-VAT giving  l5-VAT.\n     add      ih-net  ih-extra  ih-carriage  ih-discount WS-Deduct-Amt giving  l5-net.\n     add      ih-VAT  ih-c-VAT  ih-e-VAT  WS-Deduct-VAT\n              ih-net  ih-extra  ih-carriage  ih-discount WS-Deduct-Amt giving  l5-gross.\n*>\n     add      ih-net  to  Total-gds (a).\n     add      ih-discount  ih-extra  to  Total-dis (a).\n     add      WS-Deduct-Amt to Total-ded (a).\n     add      ih-carriage  to  Total-car (a).\n     add      ih-VAT  ih-c-VAT  ih-e-VAT  WS-Deduct-VAT to  Total-VAT (a).\n     add      ih-net  ih-extra  ih-carriage  ih-discount WS-Deduct-Amt to  Total-net (a).\n     add      ih-VAT  ih-c-VAT  ih-e-VAT  WS-Deduct-VAT\n              ih-net  ih-extra  ih-carriage  ih-discount\n              WS-Deduct-Amt to  Total-grs (a).\n*>\n     if       Line-cnt > Page-Lines - 2\n              perform headings-1.\n*>\n     write    print-record from Line-5 after 2.\n     add      2 to Line-cnt.\n*>\n     move     zero to fs-Reply.\n     move     ih-Lines to WS-Lines.\n     perform  Analysis-Print  WS-Lines times.\n     perform  Extra-Analysis.\n     go       to Get-Invoice-Record.\n*>\n Main-End.\n     perform  Sales-Close.\n     perform  SLautogen-Close.\n*>\n     if       Line-cnt < Page-Lines - 16\n              move spaces to print-record\n              write print-record after 3\n     else\n              perform  main12\n     end-if\n     write    print-record from Line-7 after 2.\n     move     spaces to print-record.\n     write    print-record after 1.\n     move     zero to a.\n     perform  4 times\n              add   1 to a\n              move  Total-gds (a) to  l6-goods\n              move  Total-dis (a) to  l6-disc\n              move  Total-car (a) to  l6-carr\n              move  Total-net (a) to  l6-net\n              move  Total-VAT (a) to  l6-VAT\n              move  Total-grs (a) to  l6-gross\n              move  Total-ded (a) to  l6-ded\n              move  WS-lit (a)    to  l6-lit\n              write print-record from Line-6 after 1\n     end-perform\n*>\n     if       Sales-missing                    *> Should never happen but ...\n              move \"Warning Record/s Missing In Sales File\" to print-record\n              write print-record after 2\n              write print-record after 2.    *> yes twice\n*>\n     write    print-record from Line-9 after 2.\n     move     spaces to print-record.\n     write    print-record after 1.\n     move     zero to i.\t\t*> moved from within the perform above\n     perform  3 times   *> the three vat rates\n              add   1 to i\n              move  i to l8-VAT-code\n              move  vat-rate (i) to l8-VAT-rate\n              move  Total-cvat (1, i) to l8-amount1\n              move  Total-cvat (2, i) to l8-amount2\n              move  Total-cvat (3, i) to l8-amount3\n              move  Total-cvat (4, i) to l8-amount4\n              write print-record from Line-8 after 1\n     end-perform\n     if       Vat-Rate (4) not = zero    *> test if local tax in use & print if so\n         or   Vat-Rate (5) not = zero    *>  Both - Not used in the UK (so far)\n              perform  2 times\n                       add   1 to i\n                       move  i to l8-VAT-code\n                       move  vat-rate (i) to l8-VAT-rate\n                       move  Total-cvat (1, i) to l8-amount1\n                       move  Total-cvat (2, i) to l8-amount2\n                       move  Total-cvat (3, i) to l8-amount3\n                       move  Total-cvat (4, i) to l8-amount4\n                       write print-record from Line-8 after 1\n              end-perform\n     end-if\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n Menu-Call.   exit program.\n*>\n Headings-1 section.\n*>*****************\n*>\n Main12.\n     add      1  to  j.\n     move     j  to  l3-page.\n*>\n     move     usera  to  l3-user.\n     if       j not = 1\n              write print-record from Line-1 after page\n     else\n              write print-record from Line-1 after 1.\n     write    print-record from Line-2 after 1.\n*>\n Cont-HDs.\n     write    print-record from Line-4 after 2.\n     write    print-record from Line-4B after 1.\n     move     spaces  to  print-record.\n     move     5 to Line-cnt.\n*>\n Analysis-Print          section.\n*>==============================\n*>\n     if       fs-reply = 99\t\t\t*> Just in case\n              go to Main-Exit.\n     perform  SLautogen-Read-Next.\n     if       fs-reply = 10\n              move 99 to fs-Reply\t\t*> Just in case\n              go to Main-Exit.\n*>\n     move     il-product   to  test-product.\n     if       il-comment\n              go to  main-exit.\n*>\n*> Process line items\n*>\n     if       Line-cnt > Page-Lines - 2\n              perform headings-1.\n     if       ih-test not = zeros           *> JIC but SHOULD be line items\n              move     spaces to Line-5B\n              move     il-description to L5B-Item-Desc\n              move     il-VAT-Code    to L5B-VAT-Code\n              move     il-pa          to L5B-pa\n              move     il-net         to l5B-goods\n              move     il-Net         to L5B-Net\n              move     il-VAT         to L5B-VAT\n              add      il-Net il-VAT giving L5B-Gross\n              write    print-record from Line-5B after 1\n              add      1 to Line-cnt.\n*>\n     move     il-pa       to la-code.\n     move     il-net      to la-amount.\n     move     il-VAT-code to la-VAT k.\n     if       k > zero\n              add il-VAT  to Total-cvat (a, k).\n*>\n     move  spaces     to la-a  la-b  la-c.\n*>\n Main-Exit.   exit section.\n*>********    ****\n*>\n Extra-Analysis          section.\n*>==============================\n*>\n     if       Line-cnt > Page-Lines - 4\n              perform headings-1.\n*>\n     if       lb-a  not equal  spaces\n              write  print-record  from  Line-b after 1\n              add 1 to Line-cnt\n              move  spaces  to  lb-a.\n*>\n     if       lc-a  not equal  spaces\n              write  print-record  from  Line-c after 1\n              add 1 to Line-cnt\n              move  spaces  to  lc-a.\n*>\n     if       ld-a  not equal  spaces\n              write  print-record  from  Line-d after 1\n              add 1 to Line-cnt\n              move  spaces  to  ld-a.\n*>\n     if       le-a  not equal  spaces\n              write  print-record  from  Line-e after 1\n              add 1 to Line-cnt\n              move  spaces  to  le-a.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     u-date to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.  exit section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  WS-date as uk/US/Inlt date format\n*>\n     move     to-day to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     to-day (7:4) to WS-Intl-Year.\n     move     to-day (4:2) to WS-Intl-Month.\n     move     to-day (1:2) to WS-Intl-Days.\n*>\n zz070-Exit.  exit section.\n*>\n Maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit. exit section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 77
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 5,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 70,
      "totalOperators": 52,
      "totalOperands": 104,
      "vocabulary": 71,
      "length": 156,
      "volume": 959.3605506427305
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
