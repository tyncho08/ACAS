{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs010.cbl",
  "fileName": "irs010.cbl",
  "timestamp": "2025-09-15T16:25:48.734Z",
  "programId": "irs010",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 137
      },
      {
        "name": "file",
        "line": 150
      },
      {
        "name": "working-storage",
        "line": 171
      },
      {
        "name": "linkage",
        "line": 293
      },
      {
        "name": "screen",
        "line": 331
      },
      {
        "name": "inita",
        "line": 441
      },
      {
        "name": "set-up",
        "line": 517
      },
      {
        "name": "exit",
        "line": 684
      },
      {
        "name": "amend",
        "line": 686
      },
      {
        "name": "exit",
        "line": 857
      },
      {
        "name": "show",
        "line": 859
      },
      {
        "name": "exit",
        "line": 935
      },
      {
        "name": "listing",
        "line": 937
      },
      {
        "name": "exit",
        "line": 993
      },
      {
        "name": "file-init",
        "line": 995
      },
      {
        "name": "exit",
        "line": 1012
      },
      {
        "name": "delete-record",
        "line": 1014
      },
      {
        "name": "exit",
        "line": 1058
      },
      {
        "name": "ea-Export-CoA",
        "line": 1060
      },
      {
        "name": "exit",
        "line": 1082
      },
      {
        "name": "exit",
        "line": 1091
      },
      {
        "name": "exit",
        "line": 1168
      },
      {
        "name": "fa-Import-CoA",
        "line": 1170
      },
      {
        "name": "exit",
        "line": 1204
      },
      {
        "name": "exit",
        "line": 1284
      },
      {
        "name": "zz000-clear-NL",
        "line": 1286
      },
      {
        "name": "exit",
        "line": 1362
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 138
      },
      {
        "name": "reverse-video",
        "line": 338
      },
      {
        "name": "highlight",
        "line": 359
      },
      {
        "name": "reverse-video",
        "line": 366
      },
      {
        "name": "reverse-video",
        "line": 374
      },
      {
        "name": "reverse-video",
        "line": 394
      },
      {
        "name": "highlight",
        "line": 399
      },
      {
        "name": "reverse-video",
        "line": 425
      },
      {
        "name": "File-Defs",
        "line": 438
      },
      {
        "name": "end-if",
        "line": 461
      },
      {
        "name": "main01-loop",
        "line": 473
      },
      {
        "name": "main01-exit",
        "line": 514
      },
      {
        "name": "main02",
        "line": 520
      },
      {
        "name": "input02-loop",
        "line": 549
      },
      {
        "name": "jump02-1",
        "line": 584
      },
      {
        "name": "jump02-1-1",
        "line": 596
      },
      {
        "name": "input02-sub",
        "line": 610
      },
      {
        "name": "jump02-2",
        "line": 637
      },
      {
        "name": "main02-output",
        "line": 644
      },
      {
        "name": "main02-return",
        "line": 655
      },
      {
        "name": "return02-loop",
        "line": 665
      },
      {
        "name": "main02-end",
        "line": 675
      },
      {
        "name": "main02-exit",
        "line": 683
      },
      {
        "name": "main03",
        "line": 689
      },
      {
        "name": "setup-display",
        "line": 695
      },
      {
        "name": "end-perform",
        "line": 706
      },
      {
        "name": "main03-loop",
        "line": 708
      },
      {
        "name": "input03-headings",
        "line": 717
      },
      {
        "name": "input03-loop",
        "line": 722
      },
      {
        "name": "jump03-1",
        "line": 747
      },
      {
        "name": "jump03-1-0",
        "line": 762
      },
      {
        "name": "jump03-1-1",
        "line": 767
      },
      {
        "name": "input03-sub",
        "line": 781
      },
      {
        "name": "jump03-1-s",
        "line": 806
      },
      {
        "name": "jump03-2",
        "line": 815
      },
      {
        "name": "main03-output",
        "line": 826
      },
      {
        "name": "main03-return",
        "line": 836
      },
      {
        "name": "main03-end",
        "line": 848
      },
      {
        "name": "main03-exit",
        "line": 856
      },
      {
        "name": "main04-loop",
        "line": 874
      },
      {
        "name": "main04-display",
        "line": 912
      },
      {
        "name": "main04-end",
        "line": 918
      },
      {
        "name": "main04-end2",
        "line": 926
      },
      {
        "name": "main04-exit",
        "line": 934
      },
      {
        "name": "list-exit",
        "line": 992
      },
      {
        "name": "main05-exit",
        "line": 1011
      },
      {
        "name": "loop06",
        "line": 1031
      },
      {
        "name": "main06-exit",
        "line": 1057
      },
      {
        "name": "ea010-Warning-Notice",
        "line": 1063
      },
      {
        "name": "ea020-Open-Output",
        "line": 1093
      },
      {
        "name": "ea999-exit",
        "line": 1167
      },
      {
        "name": "fa010-Warning-Notice",
        "line": 1172
      },
      {
        "name": "fa020-Open-Files",
        "line": 1206
      },
      {
        "name": "fa030-Read-Input",
        "line": 1244
      },
      {
        "name": "fa040-End-Of-Input",
        "line": 1273
      },
      {
        "name": "fa999-Exit",
        "line": 1283
      },
      {
        "name": "zz010-main",
        "line": 1289
      },
      {
        "name": "end-if",
        "line": 1337
      },
      {
        "name": "zz020-Read-A-Record",
        "line": 1339
      },
      {
        "name": "zz030-Exit",
        "line": 1361
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 75,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "SYSTEM",
        "line": 990,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1291,
        "type": "DYNAMIC",
        "using": [
          "file-34",
          "File-Info"
        ]
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 1299,
        "type": "DYNAMIC",
        "using": [
          "file-36",
          "File-Info"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 128,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 135,
        "replacing": null
      },
      {
        "name": "irsprint-spool-command-p",
        "line": 173,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 228,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 229,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 237,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 241,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 275,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 296,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 299,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 329,
        "replacing": null
      },
      {
        "name": "of",
        "line": 1064,
        "replacing": null
      },
      {
        "name": "of",
        "line": 1066,
        "replacing": null
      },
      {
        "name": "of",
        "line": 1186,
        "replacing": null
      },
      {
        "name": "of",
        "line": 1314,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 1364,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 76
      },
      {
        "target": "display",
        "thru": null,
        "line": 414
      },
      {
        "target": "zz000-clear-NL",
        "thru": null,
        "line": 482
      },
      {
        "target": "set-up",
        "thru": null,
        "line": 493
      },
      {
        "target": "amend",
        "thru": null,
        "line": 496
      },
      {
        "target": "show",
        "thru": null,
        "line": 499
      },
      {
        "target": "listing",
        "thru": null,
        "line": 502
      },
      {
        "target": "ea-Export-CoA",
        "thru": null,
        "line": 505
      },
      {
        "target": "fa-Import-CoA",
        "thru": null,
        "line": 508
      },
      {
        "target": "file-init",
        "thru": null,
        "line": 530
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 539
      },
      {
        "target": "setup-display",
        "thru": null,
        "line": 543
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 568
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 623
      },
      {
        "target": "acasirsub1-Write",
        "thru": null,
        "line": 653
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 681
      },
      {
        "target": "varying",
        "thru": null,
        "line": 701
      },
      {
        "target": "varying",
        "thru": null,
        "line": 702
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 715
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 738
      },
      {
        "target": "delete-record",
        "thru": null,
        "line": 753
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 794
      },
      {
        "target": "acasirsub1-Write",
        "thru": null,
        "line": 831
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 834
      },
      {
        "target": "main03",
        "thru": null,
        "line": 845
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 854
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 869
      },
      {
        "target": "main04-display",
        "thru": null,
        "line": 870
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 880
      },
      {
        "target": "main04-display",
        "thru": null,
        "line": 909
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 932
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 950
      },
      {
        "target": "until",
        "thru": null,
        "line": 954
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 956
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 958
      },
      {
        "target": "*>",
        "thru": null,
        "line": 983
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 988
      },
      {
        "target": "acasirsub1-Open-Output",
        "thru": null,
        "line": 1003
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1005
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1020
      },
      {
        "target": "acasirsub1-Delete",
        "thru": null,
        "line": 1024
      },
      {
        "target": "acasirsub1-Start",
        "thru": null,
        "line": 1029
      },
      {
        "target": "acasirsub1-Delete",
        "thru": null,
        "line": 1037
      },
      {
        "target": "acasirsub1-Delete",
        "thru": null,
        "line": 1042
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1045
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1048
      },
      {
        "target": "acasirsub1-Start",
        "thru": null,
        "line": 1053
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 1104
      },
      {
        "target": "until",
        "thru": null,
        "line": 1107
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1108
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1110
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1115
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1127
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1148
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1152
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1164
      },
      {
        "target": "acasirsub1-Open-Output",
        "thru": null,
        "line": 1218
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1225
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1228
      },
      {
        "target": "acasirsub1-Write",
        "thru": null,
        "line": 1269
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1281
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1331
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1334
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1343
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1346
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1358
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 448
      },
      {
        "from": "80",
        "to": "ws-env-columns ws-columns\n *>    else\n  *>            move  ws-env-columns to ws-columns\n *>    end-if\n     accept   ws-env-lines   from lines",
        "line": 452
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if",
        "line": 458
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 465
      },
      {
        "from": "hd-hh",
        "to": "hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time",
        "line": 469
      },
      {
        "from": "1",
        "to": "First-Time-Flag",
        "line": 484
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 486
      },
      {
        "from": "\"0\"",
        "to": "menu-reply",
        "line": 488
      },
      {
        "from": "2",
        "to": "access-type\n     else\n              go to main02",
        "line": 532
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 538
      },
      {
        "from": "6",
        "to": "lin",
        "line": 544
      },
      {
        "from": "1",
        "to": "cole",
        "line": 551
      },
      {
        "from": "zero",
        "to": "nl-owning nl-sub-nominal",
        "line": 557
      },
      {
        "from": "3",
        "to": "cole",
        "line": 558
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 567
      },
      {
        "from": "47",
        "to": "cole",
        "line": 575
      },
      {
        "from": "curs",
        "to": "curs2",
        "line": 577
      },
      {
        "from": "1",
        "to": "col2",
        "line": 579
      },
      {
        "from": "21",
        "to": "cole",
        "line": 587
      },
      {
        "from": "47",
        "to": "cole",
        "line": 592
      },
      {
        "from": "spaces",
        "to": "nl-name",
        "line": 593
      },
      {
        "from": "76",
        "to": "cole",
        "line": 598
      },
      {
        "from": "\"O\"",
        "to": "nl-type",
        "line": 606
      },
      {
        "from": "1",
        "to": "First-Time-Flag",
        "line": 607
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 612
      },
      {
        "from": "37",
        "to": "cole",
        "line": 613
      },
      {
        "from": "\"N\"",
        "to": "input-type\n              subtract 1 from  lin\n              go to main02-return",
        "line": 616
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 622
      },
      {
        "from": "47",
        "to": "cole",
        "line": 639
      },
      {
        "from": "spaces",
        "to": "nl-name",
        "line": 640
      },
      {
        "from": "\"S\"",
        "to": "nl-type",
        "line": 642
      },
      {
        "from": "zero",
        "to": "nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4)",
        "line": 646
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 652
      },
      {
        "from": "1",
        "to": "cole",
        "line": 659
      },
      {
        "from": "6",
        "to": "lin",
        "line": 663
      },
      {
        "from": "1",
        "to": "cole",
        "line": 667
      },
      {
        "from": "6",
        "to": "lin",
        "line": 672
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 680
      },
      {
        "from": "2",
        "to": "cole\n*>\n*> display extra lines if above 24 line display (if lines = 24 this wont run)\n*>\n *>    perform  varying lin from 22 by 1 until lin > ws-accept-lines\n     perform  varying lin from 6 by 1 until lin > ws-accept-lines\n              display \"[     ]           [ ]             [     ]\" &\n                         \"   [                        ]   [ ]\" at curs\n                                                with foreground-color cob-color-green\n     end-perform",
        "line": 697
      },
      {
        "from": "2",
        "to": "access-type",
        "line": 713
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 714
      },
      {
        "from": "6",
        "to": "lin",
        "line": 720
      },
      {
        "from": "spaces",
        "to": "input-type",
        "line": 725
      },
      {
        "from": "1",
        "to": "cole",
        "line": 726
      },
      {
        "from": "zero",
        "to": "nl-owning  nl-sub-nominal",
        "line": 727
      },
      {
        "from": "3",
        "to": "cole",
        "line": 728
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 737
      },
      {
        "from": "47",
        "to": "cole",
        "line": 744
      },
      {
        "from": "21",
        "to": "cole",
        "line": 749
      },
      {
        "from": "47",
        "to": "cole",
        "line": 764
      },
      {
        "from": "76",
        "to": "cole",
        "line": 769
      },
      {
        "from": "\"O\"",
        "to": "nl-type  input-type",
        "line": 778
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 783
      },
      {
        "from": "37",
        "to": "cole",
        "line": 784
      },
      {
        "from": "\"N\"",
        "to": "input-type\n              subtract 1  from  lin\n              go to main03-return",
        "line": 787
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 793
      },
      {
        "from": "47",
        "to": "cole",
        "line": 800
      },
      {
        "from": "\"O\"",
        "to": "input-type",
        "line": 802
      },
      {
        "from": "\"O\"",
        "to": "nl-type",
        "line": 803
      },
      {
        "from": "76",
        "to": "cole",
        "line": 808
      },
      {
        "from": "47",
        "to": "cole",
        "line": 817
      },
      {
        "from": "\"S\"",
        "to": "nl-type input-type",
        "line": 819
      },
      {
        "from": "zero",
        "to": "nl-dr           nl-cr\n                      nl-dr-last (1)  nl-dr-last (2)\n                      nl-dr-last (3)  nl-dr-last (4)\n                      nl-cr-last (1)  nl-cr-last (2)\n                      nl-cr-last (3)  nl-cr-last (4)",
        "line": 820
      },
      {
        "from": "5",
        "to": "file-function\n              perform  acasirsub1-Write\n     else\n *>             move 7  to  file-function",
        "line": 830
      },
      {
        "from": "1",
        "to": "cole",
        "line": 838
      },
      {
        "from": "6",
        "to": "lin",
        "line": 843
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 853
      },
      {
        "from": "zero",
        "to": "counter",
        "line": 862
      },
      {
        "from": "7",
        "to": "lin",
        "line": 863
      },
      {
        "from": "1",
        "to": "file-function  access-type",
        "line": 868
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 879
      },
      {
        "from": "nl-owning",
        "to": "p-owning",
        "line": 883
      },
      {
        "from": "nl-sub-nominal",
        "to": "p-sub",
        "line": 884
      },
      {
        "from": "zero",
        "to": "p-owning",
        "line": 886
      },
      {
        "from": "12",
        "to": "cole",
        "line": 887
      },
      {
        "from": "space",
        "to": "ws-reply2",
        "line": 902
      },
      {
        "from": "7",
        "to": "lin",
        "line": 908
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 923
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 931
      },
      {
        "from": "run-date",
        "to": "p-date",
        "line": 941
      },
      {
        "from": "client",
        "to": "p-client",
        "line": 942
      },
      {
        "from": "suser",
        "to": "p-user",
        "line": 943
      },
      {
        "from": "suser",
        "to": "p-user",
        "line": 944
      },
      {
        "from": "zero",
        "to": "counter",
        "line": 948
      },
      {
        "from": "1",
        "to": "file-function  access-type",
        "line": 949
      },
      {
        "from": "85",
        "to": "line-cnt",
        "line": 952
      },
      {
        "from": "3",
        "to": "file-function   *> read next record\n              perform acasirsub1-Read-Next\n              if   we-error = 3\n                   exit perform\n              end-if\n              if   line-cnt > 80\n                   add 1  to  counter\n                   move  counter  to  p-page\n                   if    counter not = 1\n                         write print-record from line-1 after page\n                   else\n                         write print-record  from  line-1 after 1\n                   end-if\n                   write print-record  from  line-3 after 2\n                   write print-record  from  line-4 after 2\n                   move  spaces  to  print-record\n                   write print-record after 1\n                   move  6 to line-cnt\n              end-if\n              move  nl-owning      to p6-owning\n              move  nl-sub-nominal to p6-sub\n              if    nl-sub-nominal not = zero\n                    move zero to  p6-owning\n              end-if\n              move  nl-name to  p-description\n              move  nl-ac   to  p-ac\n              write print-record from line-6 after 1\n              add 1 to line-cnt\n     end-perform\n*>\n*> Close file\n*>\n *>    move     2  to  file-function",
        "line": 955
      },
      {
        "from": "1",
        "to": "file-function         *> Open output\n *>             move 3  to  access-type\n              perform acasirsub1-Open-Output\n *>             move  2 to file-function           *> Close file\n              perform acasirsub1-Close\n*>     else\n*>              move  \"Z\"  to  ws-reply\n*>     end-if\n     move     2 to access-type",
        "line": 1001
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 1019
      },
      {
        "from": "8",
        "to": "file-function",
        "line": 1023
      },
      {
        "from": "nl-owning",
        "to": "save-owning",
        "line": 1025
      },
      {
        "from": "9",
        "to": "file-function",
        "line": 1026
      },
      {
        "from": "6",
        "to": "access-type",
        "line": 1027
      },
      {
        "from": "8",
        "to": "file-function",
        "line": 1036
      },
      {
        "from": "nl-owning",
        "to": "save-owning",
        "line": 1038
      },
      {
        "from": "nl-sub-nominal",
        "to": "nl-owning\n              move zero  to  nl-sub-nominal\n              perform acasirsub1-Delete\n              move save-owning  to nl-owning",
        "line": 1040
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 1044
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 1046
      },
      {
        "from": "2",
        "to": "access-type",
        "line": 1047
      },
      {
        "from": "9",
        "to": "file-function",
        "line": 1049
      },
      {
        "from": "6",
        "to": "access-type",
        "line": 1050
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1051
      },
      {
        "from": "space",
        "to": "Menu-Reply",
        "line": 1070
      },
      {
        "from": "\"1\"",
        "to": "menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be created [12345678901234567890123456789012]\"\n                                                                          at 0601 with foreground-color cob-color-yellow",
        "line": 1073
      },
      {
        "from": "\"T\"",
        "to": "ws-Export-Format",
        "line": 1087
      },
      {
        "from": "zero",
        "to": "counter",
        "line": 1103
      },
      {
        "from": "ws-Export-Format",
        "to": "ECoA-Data-Type",
        "line": 1106
      },
      {
        "from": "nl-Owning",
        "to": "ECoA-owning\n                   move  nl-Sub-Nominal to ECoA-sub\n                   move  nl-Name to  ECoA-nl-name\n                   move  nl-ac   to  ECoA-nl-ac\n                   move  nl-Type to  ECoA-nl-Type\n                   write Export-CoA-Text\n                   if  fs-reply not = zero\n                       display \"Problem writing to Export File, hit return to quit action\" at 2301\n                       accept  ws-reply at 2360\n                       exit perform     *> at least close files and get totals\n                   end-if\n                   add 1 to counter\n              else   *> = \"C\", comma delimited\n                   string  nl-owning      delimited by size\n                           \",\"            delimited by size\n                           nl-sub-nominal delimited by size\n                           \",\"            delimited by size\n                         quote            delimited by size\n                         nl-name          delimited by size\n                         quote            delimited by size\n                         \",\"              delimited by size\n                         nl-ac            delimited by size\n                         \",\"              delimited by size\n                         nl-type          delimited by size\n                         \" \"              delimited by size into Saved-CoA-Data\n                   end-string\n                   write Saved-CoA-Comma\n                   if  fs-reply not = zero\n                       display \"Problem writing to Export File, hit return to quit action\" at 2301\n                       accept  ws-reply at 2360\n                       exit perform     *> at least close files and get totals\n                   end-if\n                   add 1 to counter\n              end-if\n     end-perform\n*>\n*> Close file\n*>\n     display  \"Total record count written out = \"   at 2001",
        "line": 1118
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 1163
      },
      {
        "from": "\"1\"",
        "to": "menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be Imported [12345678901234567890123456789012]\" at 1501 with foreground-color cob-color-yellow",
        "line": 1195
      },
      {
        "from": "1",
        "to": "file-function         *> Open output\n *>    move     3  to  access-type\n     perform  acasirsub1-Open-Output",
        "line": 1216
      },
      {
        "from": "2",
        "to": "file-function           *> Close file\n     perform  acasirsub1-Close",
        "line": 1224
      },
      {
        "from": "2",
        "to": "access-type",
        "line": 1226
      },
      {
        "from": "1",
        "to": "File-Function",
        "line": 1227
      },
      {
        "from": "zero",
        "to": "Counter",
        "line": 1234
      },
      {
        "from": "zero",
        "to": "nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4)",
        "line": 1238
      },
      {
        "from": "ECoA-Owning",
        "to": "nl-owning",
        "line": 1257
      },
      {
        "from": "ECoA-Sub",
        "to": "nl-sub-nominal",
        "line": 1258
      },
      {
        "from": "\"O\"",
        "to": "ECoA-nl-Type\n     else\n              move \"S\" to ECoA-nl-Type\n     end-if\n     move     ECoA-nl-Type to nl-type",
        "line": 1260
      },
      {
        "from": "ECoA-nl-Name",
        "to": "nl-name",
        "line": 1265
      },
      {
        "from": "ECoA-nl-AC",
        "to": "nl-ac",
        "line": 1266
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 1268
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 1280
      },
      {
        "from": "\"0\"",
        "to": "Menu-Reply\n              exit section\n     end-if\n*>\n*>    We now have the CoA but do we have any postings?\n*>\n     call     \"CBL_CHECK_FILE_EXIST\" using file-36 File-Info",
        "line": 1293
      },
      {
        "from": "\"0\"",
        "to": "Menu-Reply\n              exit section\n     end-if\n*>\n*>   We now have a CoA with NO posting file so we can clear, lets ask!\n*>\n     display  \"This appears to be the first time you are running IRS and there is a\"\n                                                                          at 0101 with foreground-color cob-color-yellow erase eos",
        "line": 1301
      },
      {
        "from": "\"1\"",
        "to": "menu-reply\n              exit section\n     end-if\n*>\n     display  \"Wait while I clear the Chart of Accounts down \" at 1501 with foreground-color cob-color-yellow blink",
        "line": 1323
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 1329
      },
      {
        "from": "2",
        "to": "access-type",
        "line": 1330
      },
      {
        "from": "2",
        "to": "file-function                    *>  but as we tested for the file, this SHOULD NOT happen\n              perform  acasirsub1-Close\n              move \"1\" to menu-reply                     *>  ok, we are done\n              exit section\n     end-if",
        "line": 1333
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 1342
      },
      {
        "from": "2",
        "to": "file-function                    *> close\n              perform  acasirsub1-Close\n              move \"0\" to menu-reply                     *>  ok, we are done\n              exit section\n     end-if\n*>                                                           clear all amounts\n     move     zero  to  nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4)",
        "line": 1345
      },
      {
        "from": "7",
        "to": "file-function",
        "line": 1357
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "sub-nominal = zero as allowed\n*>                    recs are Owner. Subs are only a pointer.\n*> 02/05/18 vbc - .19 Added Time to report (in Listing) & do this for most of the\n*>                    reports in IRS as it is hard to work out the latest reports.\n*>                    Change title to Chart of Accounts instead of accounts\n*>                    directory for display and printing.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n copy  \"envdiv.cob\".\n*>\n input-output section.\n file-control.\n*>\n     select  print-file     assign       \"prt-1\"\n                            organization line sequential.\n*>\n*>  This is a Cobol or text file that is imported.\n*>\n     select  Saved-CoA      assign       Archive-Name\n                            organization line sequential\n                            status       fs-reply.\n*>\n data division.\n file section.\n*>\n fd  print-file.\n*>\n 01  print-record        pic x(80).\n*>\n fd  Saved-CoA.\n 01  Export-CoA-Text.\n     03  ECoA-Data-Type  pic x.\n     03  ECoA-Owning     pic 9(5).\n     03  ECoA-Sub        pic 9(5).\n     03  ECoA-nl-Type    pic x.\n         88 ECoA-nl-sub-ac               value \"S\".\n         88 ECoA-nl-owner                value \"O\".\n     03  ECoA-nl-Name    pic x(24).\n     03  ECoA-nl-AC      pic x.\n*>\n 01  Saved-CoA-Comma.\n     03  ECoA-Data-TypeB pic x.\n     03  Saved-CoA-Data  pic x(43).\n*>\n working-storage section.\n 77  prog-name           pic x(16)  value \"irs010 (3.02.19)\".\n copy \"irsprint-spool-command-p.cob\".\n 77  menu-reply          pic x      value space.\n*>\n 01  work-fields.\n     03  ws-reply        pic x.\n     03  ws-reply2       pic x.\n     03  ws-Export-Format pic x     value \"T\".\n     03  input-type      pic x.\n         88  sub-input        value \"y\" \"Y\".\n     03  input-type2     pic x.\n         88  sub-input2       value \"y\" \"Y\".\n     03  counter         pic 9(4).\n     03  ws-pass         pic x(4).\n     03  nl-ac2          pic a.\n     03  save-owning     pic 9(5).\n     03  Save-Subs-Cnt   pic 9(5)   value zero.\n     03  count2          pic 9.\n     03  prt-file        pic x(11).\n     03  Archive-Name    PIC X(32)     VALUE \"coa-archived.txt\".\n     03  line-cnt        pic 99   comp value 99.\n     03  ws-spaces                     value  spaces.\n         05  ws-spaces78 pic x(78).\n         05  filler      pic xx.\n     03  p-owning        pic zzzzz blank when zero.\n     03  p-sub           pic zzzzz blank when zero.\n*>     03  ws-env-columns  pic 999       value zero.\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n*>     03  ws-columns      binary-char unsigned value zero.\n*>     03  ws-show-lines   binary-char unsigned value zero.\n*>     03  ws-amend-lines  binary-char unsigned value zero.\n     03  ws-setup-lines  binary-char unsigned value zero.\n     03  ws-accept-lines binary-char unsigned value zero.\n*>\n     03  hdtime                          value spaces.\n         05  hd-hh       pic xx.\n         05  hd-mm       pic xx.\n         05  hd-ss       pic xx.\n         05  hd-uu       pic xx.\n     03  HD2-Time.\n         05  filler      pic x     value spaces.\n         05  hd2-hh      pic xx.\n         05  filler      pic x     value \":\".\n         05  hd2-mm      pic xx.\n*>\n 01  File-Info                          value zero.       *> Layout as per GNU v2 manual\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n copy \"wsfnctn.cob\".\n copy \"irswsnl.cob\" replacing NL-Record by WS-IRSNL-Record.\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n     03  WS-IRS-Default-Record pic x.\n     03  Posting-Record        pic x.\n     03  Final-Record          pic x.\n     03  WS-IRS-Posting-Record pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n*>  for date conversion from ACAS\n*>\n copy \"wsmaps03.cob\".\n     03  U-Date8           pic x(8).\n*>\n 01  print-lines.\n     03  line-1.\n         05  p-user        pic x(24).\n         05  filler        pic x(4)    value spaces.\n         05  l1-a          pic x(26)   value \"Incomplete Records System\".\n         05  filler        pic x(12)   value spaces.\n         05  p-date        pic x(8).\n         05  P-Time        pic x(6)    value spaces.\n     03  line-3.\n         05  p-client      pic x(24).\n         05  filler        pic x(7)    value spaces.\n         05  L3-A          pic x(18)   value \"Chart of Accounts\".\n         05  filler        pic x(22)   value spaces.\n         05  l3-b          pic x(6)    value \"Page -\".\n         05  p-page        pic zz9.\n     03  line-4.\n         05  filler        pic x(11)   value spaces.\n         05  l4-a          pic x(56)   value\n         \"  Main A/C       Sub-Account     ------Description------\".\n         05  l4-b          pic x(12)   value \"    A/C Type\".\n     03  line-6.\n         05  filler        pic x(14)   value spaces.\n         05  p6-owning     pic zzzz9   blank when zero.\n         05  filler        pic x(12)   value spaces.\n         05  p6-sub        pic zzzz9   blank when zero.\n         05  filler        pic x(8)    value spaces.\n         05  p-description pic x(24).\n         05  filler        pic x(7)    value spaces.\n         05  p-ac          pic x.\n*>\n 01  All-My-Constants      pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR914          pic x(51) value \"IR914 Error on irspostingMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific\n     03  IR010          pic x(37) value \"IR010 Record already exists re-enter!\".\n     03  IR011          pic x(9)  value \"Key is - \".\n     03  IR012          pic x(56) value\n         \"IR012 Enter <N> for Next screen or <X> to Quit.......[ ]\".\n     03  IR013          pic x(42) value \"IR013 End of display. Hit return for Menu \".\n*>\n linkage section.\n*>---------------\n*>\n copy \"irswssystem.cob\"\n              replacing system-record  by IRS-System-Params. *> (01 level)\n*>\n copy \"wssystem.cob\" in \"../copybooks\"    *> NEW for v3.02\n             replacing  System-Record by WS-System-Record\n                        Run-Date   by ACAS-Run-Date     *> these 3 are in binary\n                        Start-Date by ACAS-Start-Date   *> IRS expects as x(8)\n                        End-Date   by ACAS-End-Date     *>  dd/mm/yy\n                        suser      by ACAS-suser\n                        Address-1  by ACAS-Address-1\n                        Address-2  by ACAS-Address-2\n                        Address-3  by ACAS-Address-3\n                        Address-4  by ACAS-Address-4\n                        Post-Code  by ACAS-Post-Code\n                        Print-Spool-Name by ACAS-Print-Spool-Name\n                        Pass-Value by ACAS-Pass-Value\n                        Pass-Word  by ACAS-Pass-Word\n                        OP-System  By ACAS-Op-System\n                        Client     by IRS-Client\n                        System-Ops by IRS-System-Ops\n                        Next-Post  by IRS-Next-Post\n                        Vat-Rates2 by IRS-Vat-Rates2\n                        Vat1       by IRS-Vat1\n                        Vat2       by IRS-Vat2\n                        Vat3       by IRS-Vat3\n                        Vat-Group  by IRS-Vat-Group\n                        Vat-Psent  by IRS-Vat-Psent\n                        Save-Sequ  by IRS-Save-Sequ\n                        System-Work-Group by IRS-System-Work-Group\n                        PL-App-Created by IRS-PL-App-Created\n                        PL-Approp-AC   by IRS-PL-Approp-AC\n                        1st-Time-Flag  by IRS-First-Time-Flag.\n*>\n copy \"wsnames.cob\".  *> uses the full version\n*>\n screen section.\n*>--------------\n 01  menu-screen-1                                      background-color cob-color-black\n                                                        foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col  1    blank screen.\n     03  value \"Accounts File Utilities\"   line 1 col 29 foreground-color cob-color-white\n                                                         background-color cob-color-blue\n                                                            reverse-video.\n     03  pic x(8) from Run-Date            line 1 col 73.\n     03  value \"Client -\"                  line 3 col  1.\n     03  pic x(24) from Client             line 3 col 10 foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line 3 col 39.\n     03  pic x(8) from Start-Date          line 3 col 52 foreground-color cob-color-cyan.\n     03  value \"End date -\"                line 3 col 62.\n     03  pic x(8) from End-Date            line 3 col 73 foreground-color cob-color-cyan.\n     03  value \"Select the required function by number    [\"\n                                           line 5 col  1.\n     03  pic x using menu-reply  auto      line 5 col 44 foreground-color cob-color-yellow.\n     03  value \"]\"                         line 5 col 45.\n     03  value \"(1)  Set-Up Chart of Accounts\" line  8 col 6.\n     03  value \"(2)  Amend  Chart of Accounts\" line 10 col 6.\n     03  value \"(3)  Display the Chart\"    line 12 col 6.\n     03  value \"(4)  Print   the Chart\"    line 14 col 6.\n     03  value \"(5)  Export  the Chart\"    line 15 col 6.\n     03  value \"(6)  Import  the Chart\"    line 16 col 6.\n     03  value \"(9)  Return to System Menu\" line 18 col 6.\n     03  value \"F1 to F6 = options 1 to 6;  Return to Accept \" &\n             \"data;   Escape to quit\"      line 23 col 1 foreground-color cob-color-white\n                                                               highlight.\n*>\n 01  Amend-Screen-1                                      background-color cob-color-black\n                                                         foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col  1   blank screen.\n     03  value \"Chart of Accounts Amendments\" line 1 col 28 foreground-color cob-color-white\n                                                            background-color cob-color-blue\n                                                                  reverse-video.\n     03  pic x(8)  from run-date           line 1 col 73.\n*>\n 01  Setup-Screen-1                                      background-color cob-color-black\n                                                         foreground-color cob-color-green.\n     03  pic x(16) from prog-name          line 1 col  1          blank screen.\n     03  value \"Chart of Accounts Setup\"   line 1 col 30 foreground-color cob-color-white\n                                                         background-color cob-color-blue\n                                                                  reverse-video.\n     03  pic x(8) from run-date            line 1 col 73.\n*>\n 01  Setup-Screen-2Q.\n     03  value \"Client -\"                  line  3 col  1.\n     03  pic x(24) from client             line  3 col 10 foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line  3 col 39.\n     03  pic x(8) from start-date          line  3 col 52 foreground-color cob-color-cyan.\n     03  value \"End date -\"                line  3 col 62.\n     03  pic x(8) from end-date            line  3 col 73 foreground-color cob-color-cyan.\n     03  value \"Add to Existing Chart (Y/N) ? - [\" line 5 col 1.\n     03  pic x to menu-reply  auto         line  5 col 34 foreground-color cob-color-yellow.\n     03  value \"]\"                         line  5 col 35.\n     03  value \"N.B. (1) If first time setup for this client answer no (N)\"\n                                           line  7 col  1 background-color cob-color-red\n                                                          foreground-color cob-color-white.\n     03  value \"(2) Answering no (N)\"      line  8 col  6 background-color cob-color-red\n                                                          foreground-color cob-color-white.\n     03  value \"destroys\"                  line  8 col 27 foreground-color cob-color-white\n                                                          background-color cob-color-red\n                                                                reverse-video.\n     03  value \"the existing chart\"        line  8 col 36 background-color cob-color-red\n                                                          foreground-color cob-color-white.\n     03  value \"Escape to quit;    Return to Accept data\"\n                                           line 23 col  1  foreground-color cob-color-white\n                                                                highlight.\n*>\n 01  Setup-Amend-Screen-3                                 background-color cob-color-black\n                                                          foreground-color cob-color-green.\n     03  value \"Client -\"                  line  3 col  1.\n     03  pic x(24) from client             line  3 col 10 foreground-color cob-color-cyan.\n     03  value \"Start date -\"              line  3 col 39.\n     03  pic x(8) from start-date          line  3 col 52 foreground-color cob-color-cyan.\n     03  value \"End date -\"                line  3 col 62.\n     03  pic x(8) from end-date            line  3 col 73 foreground-color cob-color-cyan.\n     03  value \"Main A/C      Sub-Nominal       Sub-Account     \" &\n         \"  Description          A/C Type\" line  4 col  2 highlight.\n     03  value \" \"  erase eol              line  5 col  1.\n*>\n*>  Remed out as does not work in GnuCobol and created by a\n*>    perform  display in setup-display\n*>\n*>     03  occurs 16\n*>         value \"[     ]           [ ]             [     ]\" &\n*>         \"   [                        ]   [ ]\" line plus 1 col 2.\n*>\n 01  Display-Screen-1                                     background-color cob-color-black\n                                                          foreground-color cob-color-green.\n     03  pic x(24) from suser              line  1 col 1  blank screen.\n     03  value \"Incomplete Records System\" line  1 col 28 foreground-color cob-color-white\n                                                          background-color cob-color-blue\n                                                                reverse-video.\n     03  pic x(8) from run-date            line  1 col 73.\n     03  value \"Client -\"                  line  3 col 1.\n     03  pic x(24) from client             line  3 col 10 foreground-color cob-color-cyan.\n     03  value \"Chart of Accounts\"         line  3 col 32.\n     03  value \"Page\"                      line  3 col 73.\n     03  pic zz9 from counter              line  3 col 78 foreground-color cob-color-cyan.\n     03  value \"  Main       Sub             Description         \" &\n               \"     Type \"                line  5 col 11 background-color cob-color-blue\n                                                          foreground-color cob-color-white.\n*>\n procedure division using IRS-System-Params\n                          WS-System-Record\n                          File-Defs.\n*>*****************************************\n*>\n inita  section.\n*>\n*>   first get Date & User Information.\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n *>    accept   ws-env-columns from columns.\n *>    if       ws-env-columns < 80\n *>             move 80 to ws-env-columns ws-columns\n *>    else\n  *>            move  ws-env-columns to ws-columns\n *>    end-if\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to hd2-hh\n              move hd-mm to hd2-mm\n              move HD2-Time  to P-Time.\n*>\n main01-loop.\n*>-----------\n*>\n*> First check if this is first time setting up a/cs\n*>  if so does accounts exist in which case a/cs are from\n*> inported from sample data and if so, offer to clear down\n*>  all values before any thing else happens\n*>\n     if       First-Time-Flag = zero\n              perform zz000-clear-NL\n              if   menu-reply = \"0\"\n                   move 1 to First-Time-Flag.\n*>\n     move     1 to File-Key-No.               *> 1 = Primary\n*>\n     move     \"0\" to menu-reply.\n     display  Menu-Screen-1.\n     accept   Menu-Screen-1.\n*>\n     if       menu-reply = 1  or Cob-Crt-Status = Cob-Scr-F1\n              perform set-up\n              go to main01-loop.\n     if       menu-reply = 2  or Cob-Crt-Status = Cob-Scr-F2\n              perform amend\n              go to main01-loop.\n     if       menu-reply = 3  or Cob-Crt-Status = Cob-Scr-F3\n              perform show\n              go to main01-loop.\n     if       menu-reply = 4  or Cob-Crt-Status = Cob-Scr-F4\n              perform listing\n              go to main01-loop.\n     if       menu-reply = 5  or Cob-Crt-Status = Cob-Scr-F5\n              perform ea-Export-CoA\n              go to main01-loop.\n     if       menu-reply = 6  or Cob-Crt-Status = Cob-Scr-F6\n              perform fa-Import-CoA\n              go to main01-loop.\n     if       menu-reply = 9  or Cob-Crt-Status = Cob-Scr-Esc\n              go to main01-exit.\n     go       to main01-loop.\n*>\n main01-exit.\n     exit     program.\n*>\n set-up section.\n*>--------------\n*>\n main02.\n*>-----\n*>\n     display  Setup-Screen-1.\n     accept   Setup-Screen-2Q.\n     subtract 1 from ws-lines giving ws-accept-lines.\n*>\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to main02-exit.\n     if       function upper-case (menu-reply) = \"N\"\n              perform  file-init.\n     if       function upper-case (menu-reply) = \"Y\" OR \"N\"\n              move 2 to access-type\n     else\n              go to main02.\n*>\n*> Open the Nominal Ledger\n*>\n *>    move     1  to  file-function.\n     perform  acasirsub1-Open.\n*>\n     display  setup-screen-1.\n     display  Setup-Amend-Screen-3.\n     perform  setup-display.\n     move     6  to  lin.\n*>\n*> screen refresh after using last data accept on screen might be screwed\n*>   if so, perf setup-display\n*>\n input02-loop.\n*>-----------\n     move     1 to cole.\n     display  \" [     ]           [ ]             [     ]   [      \" &\n              \"                  ]   [ ]\" at curs with\n                                 foreground-color cob-color-green.\n     if       sub-input\n              go to input02-sub.\n     move     zero  to  nl-owning nl-sub-nominal.\n     move     3  to  cole.\n     accept   nl-owning at curs with update foreground-color cob-color-yellow.\n     if       nl-owning = zero\n              go to main02-end.\n     if       access-type = 3           *> file opened as output so key check bypassed\n              go to jump02-1.\n*>\n*> check that key is unique\n*>\n *>    move     4  to  file-function.    *> read indexed\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2             *> record not found\n              display  ws-spaces78 at line ws-lines col 01\n              go to jump02-1.\n*>\n*> Record already exists\n*>\n     move     47 to cole.\n     display  nl-name at curs with foreground-color cob-color-yellow.\n     move     curs to curs2.\n     add      1 to lin2.\n     move     1 to col2.\n     display  IR010 at line ws-lines col 01 with blink reverse-video.\n*> 2401\n     go       to input02-loop.\n*>\n jump02-1.\n*>-------\n*>\n     move     21 to cole.\n     accept   input-type2 at curs with update foreground-color cob-color-yellow.\n     move     function upper-case (input-type2) to input-type.\n     if       input-type not = \"N\" and not = \"Y\"\n              go to jump02-1.\n     move     47 to cole.\n     move     spaces to nl-name.\n     accept   nl-name at curs with update foreground-color cob-color-yellow.\n*>\n jump02-1-1.\n*>---------\n     move     76 to cole.\n     accept   nl-ac2 at curs with update foreground-color cob-color-yellow.\n     move     function upper-case (nl-ac2) to nl-ac.\n     if       nl-ac < \"A\" OR > \"Z\"\n              go to jump02-1-1.\n*>\n*>  Output the record.\n*>\n     move     \"O\" to nl-type.\n     move      1 to First-Time-Flag.\n     go       to main02-output.\n*>\n input02-sub.\n*>----------\n     move     zero to nl-sub-nominal.\n     move     37 to cole.\n     accept   nl-sub-nominal at curs with update foreground-color cob-color-yellow.\n     if       nl-sub-nominal = zero\n              move \"N\" to input-type\n              subtract 1 from  lin\n              go to main02-return.\n*>\n*> check that key is unique\n*>\n *>    move     4 to file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              display ws-spaces78 at line ws-lines col 01\n              go to jump02-2.\n*>\n*> Record already exists\n*>\n     display  nl-name at curs.\n     display  IR010 at line ws-lines col 01 with blink reverse-video.\n     display  IR011 at line ws-lines col 40 with blink reverse-video.\n     display  nl-key at line ws-lines col 50 with foreground-color 3.\n*> 2445\n     go       to input02-sub.\n*>\n jump02-2.\n*>-------\n     move     47 to cole.\n     move     spaces to nl-name.\n     accept   nl-name at curs with update foreground-color cob-color-yellow.\n     move     \"S\" to nl-type.\n*>\n main02-output.\n*>------------\n     move     zero  to  nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4).\n*>\n *>    move     5 to file-function.  *> write\n     perform  acasirsub1-Write.\n*>\n main02-return.\n*>------------\n*>\n     add      1 to lin.\n     move     1 to cole.\n     display  ws-spaces  at curs.\n     if       lin  <  ws-accept-lines\n              go to input02-loop.\n     move     6  to  lin.\n*>\n return02-loop.\n*>------------\n     move     1 to cole.\n     display  ws-spaces  at curs.\n     add      1  to  lin.\n     if       lin  <  ws-accept-lines\n              go to return02-loop.\n     move     6  to  lin.\n     go       to input02-loop.\n*>\n main02-end.\n*>---------\n*>\n*> close nominal ledger\n*>\n  *>   move     2 to file-function.\n     perform  acasirsub1-Close.\n*>\n main02-exit.\n     exit     section.\n*>\n amend section.\n*>-------------\n*>\n main03.\n*>\n     display  Amend-screen-1.\n     display  Setup-Amend-Screen-3.\n     subtract 1 from ws-lines giving ws-accept-lines.\n*>\n setup-display.\n*>     subtract 3 from ws-lines giving ws-amend-lines.\n     move     2 to cole\n*>\n*> display extra lines if above 24 line display (if lines = 24 this wont run)\n*>\n *>    perform  varying lin from 22 by 1 until lin > ws-accept-lines\n     perform  varying lin from 6 by 1 until lin > ws-accept-lines\n              display \"[     ]           [ ]             [     ]\" &\n                         \"   [                        ]   [ ]\" at curs\n                                                with foreground-color cob-color-green\n     end-perform.\n*>\n main03-loop.\n*>----------\n*>\n*> now open the nominal ledger\n*>\n *>    move     2  to  access-type.\n *>    move     1  to  file-function.\n     perform  acasirsub1-Open.\n*>\n input03-headings.\n*>---------------\n*>\n     move     6  to  lin.\n*>\n input03-loop.\n*>-----------\n*>\n     move     spaces to input-type.\n     move     1 to cole.\n     move     zero  to  nl-owning  nl-sub-nominal.\n     move     3 to cole.\n     accept   nl-owning  at curs with update foreground-color cob-color-yellow.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n              go to main03-end.\n     if       nl-owning = zero\n              go to main03-end.\n*>\n*> check key.\n*>\n *>    move     4  to  file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              go to input03-loop.\n*>\n*> if here record does exist\n*>\n     move     47 to cole.\n     display  nl-name at curs with foreground-color cob-color-yellow.\n*>\n jump03-1.\n*>-------\n     move     21 to cole.\n     accept   input-type2 at curs with update foreground-color cob-color-yellow.\n     move     function upper-case (input-type2) to input-type.\n     if       input-type = \"D\"\n              perform delete-record\n              go to input03-loop.\n     if       input-type = \"N\"\n              go to jump03-1-0.\n     if       input-type = \"Y\"\n              go to input03-sub\n     else\n              go to jump03-1.\n*>\n jump03-1-0.\n*>---------\n     move     47 to cole.\n     accept   nl-name at curs with update foreground-color cob-color-yellow.\n*>\n jump03-1-1.\n*>---------\n     move     76 to cole.\n     accept   nl-ac2  at curs with update foreground-color cob-color-yellow.\n     move     function upper-case (nl-ac2) to nl-ac.\n*>\n     if       nl-ac < \"A\" or > \"Z\"\n              go to jump03-1-1.\n*>\n*> now output the record.\n*>\n     move     \"O\"  to  nl-type  input-type.\n     go       to main03-output.\n*>\n input03-sub.\n*>----------\n     move     zero  to  nl-sub-nominal.\n     move     37 to cole.\n     accept   nl-sub-nominal at curs with update foreground-color cob-color-yellow.\n     if       nl-sub-nominal = zero\n              move \"N\"  to  input-type\n              subtract 1  from  lin\n              go to main03-return.\n*>\n*> check that key is unique\n*>\n *>    move     4  to  file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              go to jump03-2.\n*>\n*> if here record already exists\n*>\n     move     47 to cole.\n     display  nl-name at curs with foreground-color cob-color-yellow.\n     move     \"O\"  to  input-type.\n     move     \"O\"  to  nl-type.\n     accept   nl-name at curs with update foreground-color cob-color-yellow.\n*>\n jump03-1-s.\n*>---------\n     move     76 to cole.\n     accept   nl-ac2 at curs with update foreground-color cob-color-yellow.\n     move     function upper-case (nl-ac2) to nl-ac.\n     if       nl-ac < \"A\" or > \"Z\"\n              go to jump03-1-s.\n     go       to  main03-output.\n*>\n jump03-2.\n*>-------\n     move     47 to cole.\n     accept   nl-name at curs with update foreground-color cob-color-yellow.\n     move     \"S\" to nl-type input-type.\n     move     zero to nl-dr           nl-cr\n                      nl-dr-last (1)  nl-dr-last (2)\n                      nl-dr-last (3)  nl-dr-last (4)\n                      nl-cr-last (1)  nl-cr-last (2)\n                      nl-cr-last (3)  nl-cr-last (4).\n*>\n main03-output.\n*>------------\n*>\n     if       input-type = \"S\"\n *>             move 5  to  file-function\n              perform  acasirsub1-Write\n     else\n *>             move 7  to  file-function.\n              perform  acasirsub1-Rewrite.\n*>\n main03-return.\n*>------------\n     move     1 to cole.\n     add      1  to  lin.\n*>    display  ws-spaces at curs.\n     if       lin  <  ws-accept-lines   *> 23\n              go to input03-loop.\n     move     6  to  lin.\n*>\n     perform  main03.\n     go       to input03-headings.\n*>\n main03-end.\n*>---------\n*>\n*> close nominal ledger\n*>\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n*>\n main03-exit.\n     exit     section.\n*>\n show section.\n*>------------\n*>\n     move     zero to counter.\n     move     7 to lin.\n     subtract 2 from ws-lines giving ws-accept-lines.\n*>\n*> now open nominal ledger\n*>\n *>    move     1  to  file-function  access-type.\n     perform  acasirsub1-Open-Input.\n     perform  main04-display.\n     if       we-error = 1 *> no file\n              go to main04-end.\n*>\n main04-loop.\n*>----------\n*>\n*> read next record\n*>\n *>    move     3  to  file-function.\n     perform  acasirsub1-Read-Next.\n     if       we-error = 3\n              go to main04-end.\n     move     nl-owning      to p-owning.\n     move     nl-sub-nominal to p-sub.\n     if       nl-sub-nominal  not equal zero\n              move zero to p-owning.\n     move     12 to cole.\n     display  p-owning at curs with foreground-color cob-color-cyan.\n     add      11 to cole.\n     display  p-sub  at curs with foreground-color cob-color-cyan.\n     add      13 to cole.\n     display  nl-name at curs with foreground-color cob-color-cyan.\n     add      30 to cole.\n     display  nl-ac at curs with foreground-color cob-color-cyan.\n     add      1  to  lin.\n     if       lin  <  ws-accept-lines  *> 22\n              go to main04-loop.\n*>\n*> end of screen routine\n*>\n     display  IR012 at line ws-lines col 18 with foreground-color cob-color-yellow.\n     move     space to ws-reply2.\n     accept   ws-reply2 at line ws-lines col 72 with auto foreground-color cob-color-yellow.\n     move     function upper-case (ws-reply2) to ws-reply.\n     if       ws-reply = \"X\"\n              go to    main04-end2.\n     display  \" \" at 0101 with erase eos.\n     move     7 to  lin.\n     perform  main04-display.\n     go to    main04-loop.\n*>\n main04-display.\n*>--------------\n*>\n     add      1 to counter.\n     display  Display-Screen-1.\n*>\n main04-end.\n*>---------\n*>\n     display  IR013 at line ws-lines col 18\n                                 with erase eol foreground-color cob-color-yellow.\n     move     space to ws-reply.\n     accept   ws-reply at line ws-lines col 61 with foreground-color cob-color-yellow.\n*>\n main04-end2.\n*>-----------\n*>\n*> Close file\n*>\n *>    move     2 to file-function.\n     perform  acasirsub1-Close.\n*>\n main04-exit.\n     exit     section.\n*>\n listing section.\n*>---------------\n*>\n *>    display  space.\n     move     run-date to p-date.\n     move     client   to p-client.\n     move     suser    to p-user.\n     move     suser    to p-user.\n*>\n*> Open nominal ledger\n*>\n     move     zero to counter.\n *>    move     1  to  file-function  access-type.\n     perform  acasirsub1-Open-Input.\n     open     output  print-file.\n     move     85 to line-cnt.\n*>\n     perform  until we-error = 3           *> yep, its also checked lower\n *>             move  3  to  file-function   *> read next record\n              perform acasirsub1-Read-Next\n              if   we-error = 3\n                   exit perform\n              end-if\n              if   line-cnt > 80\n                   add 1  to  counter\n                   move  counter  to  p-page\n                   if    counter not = 1\n                         write print-record from line-1 after page\n                   else\n                         write print-record  from  line-1 after 1\n                   end-if\n                   write print-record  from  line-3 after 2\n                   write print-record  from  line-4 after 2\n                   move  spaces  to  print-record\n                   write print-record after 1\n                   move  6 to line-cnt\n              end-if\n              move  nl-owning      to p6-owning\n              move  nl-sub-nominal to p6-sub\n              if    nl-sub-nominal not = zero\n                    move zero to  p6-owning\n              end-if\n              move  nl-name to  p-description\n              move  nl-ac   to  p-ac\n              write print-record from line-6 after 1\n              add 1 to line-cnt\n     end-perform\n*>\n*> Close file\n*>\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n list-exit.\n     exit     section.\n*>\n file-init section.\n*>-----------------\n*>\n *>    display  \"Enter Pass-word - [    ]\" at 0551 with foreground-color 2.\n *>    accept   ws-pass at 0570 with secure.\n *>    if       ws-pass = pass-word\n *>             move 1  to  file-function         *> Open output\n *>             move 3  to  access-type\n              perform acasirsub1-Open-Output\n *>             move  2 to file-function           *> Close file\n              perform acasirsub1-Close\n*>     else\n*>              move  \"Z\"  to  ws-reply\n*>     end-if\n     move     2 to access-type.              *> open i-o\n*>\n main05-exit.\n     exit     section.\n*>\n delete-record section.\n*>---------------------\n*>\n*> check key.\n*>\n *>    move     4  to  file-function.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              go to main06-exit.\n *>    move     8 to file-function.\n     perform  acasirsub1-Delete.\n     move     nl-owning  to  save-owning.\n *>    move     9 to file-function.\n *>    move     6 to access-type.\n     set      fn-less-than to true.\n     perform  acasirsub1-Start.\n*>\n loop06.\n*>-----\n*>\n     if       nl-owning  not = save-owning\n              go to main06-exit.\n *>    move     8  to  file-function.\n     perform  acasirsub1-Delete.\n     move     nl-owning to save-owning.\n     if       nl-sub-nominal not = zero\n              move nl-sub-nominal to nl-owning\n              move zero  to  nl-sub-nominal\n              perform acasirsub1-Delete\n              move save-owning  to nl-owning.\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n *>    move     1  to  file-function.\n *>    move     2  to  access-type.\n     perform  acasirsub1-Open.\n *>    move     9  to  file-function.\n *>    move     6  to  access-type.\n     move     zero  to  nl-sub-nominal.\n     set      fn-less-than to true.\n     perform  acasirsub1-Start.\n     if       we-error = zero\n              go to loop06.\n*>\n main06-exit.\n     exit     section.\n*>\n ea-Export-CoA section.\n*>--------------------\n*>\n ea010-Warning-Notice.\n     display  \"This process will export a copy of the current CoA (Chart of Accounts)\"\n                                                                   at 0101 with foreground-color cob-color-yellow erase eos.\n     display  \"overwriting any copy of the file if it exists.\"     at 0221 with foreground-color cob-color-yellow.\n     display  \"Continue Y/N [ ]\"                                   at 0401 with background-color cob-color-red\n                                                                                foreground-color cob-color-white.\n*>\n     move     space to Menu-Reply.\n     accept   menu-reply at 0415.\n     if       menu-reply = \"N\" or = \"n\"\n              move \"1\" to menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be created [12345678901234567890123456789012]\"\n                                                                          at 0601 with foreground-color cob-color-yellow.\n     accept   Archive-Name at 0626 with update.\n     if       Archive-Name = spaces or Cob-Crt-Status = Cob-Scr-Esc\n              display \"Quiting to menu\" at 1001 with erase eol\n              exit section.\n*>\n     display  \"Warning: Comma delimited files cannot be imported by this program\"\n                                                         at 0701 with foreground-color cob-color-yellow.\n     display  \"Format: T(xt) or (C)omma delimited?  [T]\" at 0801 with foreground-color cob-color-yellow.\n     move     \"T\" to ws-Export-Format.\n     accept   ws-Export-Format  at 0839 with update.\n     move     function upper-case (ws-Export-Format) to ws-Export-Format.\n     if       ws-Export-Format not = \"T\" and not = \"C\"    *> space to quit\n              exit section.\n*>\n ea020-Open-Output.\n     open     Output Saved-CoA.\n     if       fs-reply not = zero\n              display \"Problem opening Export File, hit return to quit action\" at 2301\n              accept  ws-reply at 2360\n              exit section\n     end-if\n*>\n*> Open nominal ledger\n*>\n     move     zero to counter.\n     perform  acasirsub1-Open-Input.\n*>\n     move     ws-Export-Format to ECoA-Data-Type.\n     perform  until we-error = 3      *> initially on open, and checked lower down\n              perform acasirsub1-Read-Next\n              if   we-error = 3       *> eof\n                   exit perform\n              end-if\n              if   NL-Sub-Nominal = zero                   *> This should NOT happen\n                and NL-Pointer numeric\n                   add 1 to Save-Subs-Cnt                  *> so test for it by counting\n                   exit perform cycle\n              end-if\n              if   ws-Export-Format = \"T\"\n                   move  nl-Owning      to ECoA-owning\n                   move  nl-Sub-Nominal to ECoA-sub\n                   move  nl-Name to  ECoA-nl-name\n                   move  nl-ac   to  ECoA-nl-ac\n                   move  nl-Type to  ECoA-nl-Type\n                   write Export-CoA-Text\n                   if  fs-reply not = zero\n                       display \"Problem writing to Export File, hit return to quit action\" at 2301\n                       accept  ws-reply at 2360\n                       exit perform     *> at least close files and get totals\n                   end-if\n                   add 1 to counter\n              else   *> = \"C\", comma delimited\n                   string  nl-owning      delimited by size\n                           \",\"            delimited by size\n                           nl-sub-nominal delimited by size\n                           \",\"            delimited by size\n                         quote            delimited by size\n                         nl-name          delimited by size\n                         quote            delimited by size\n                         \",\"              delimited by size\n                         nl-ac            delimited by size\n                         \",\"              delimited by size\n                         nl-type          delimited by size\n                         \" \"              delimited by size into Saved-CoA-Data\n                   end-string\n                   write Saved-CoA-Comma\n                   if  fs-reply not = zero\n                       display \"Problem writing to Export File, hit return to quit action\" at 2301\n                       accept  ws-reply at 2360\n                       exit perform     *> at least close files and get totals\n                   end-if\n                   add 1 to counter\n              end-if\n     end-perform\n*>\n*> Close file\n*>\n     display  \"Total record count written out = \"   at 2001.\n     display  Counter                               at 2034.\n     display  \"Total records found as SUBS    = \"   at 2101.\n     display  Save-Subs-Cnt                         at 2134.\n     display  \"Note count & hit return to continue\" at 2201.\n     accept   ws-reply                              at 2237.\n*>\n *>    move     2  to  file-function.\n     perform  acasirsub1-Close.\n     close    Saved-CoA.\n*>\n ea999-exit.\n     exit     section.\n*>\n fa-Import-CoA section.\n*>--------------------\n fa010-Warning-Notice.\n*>\n*>*****************************************************\n*> Although allowed for, comma delimited files        *\n*> cannot not be used for input, but just in case     *\n*>  However cvs files has not been coded.             *\n*>*****************************************************\n*>\n     display  \"This process will import a CoA (Chart of Accounts) in TEXT format \" at 0101 with foreground-color cob-color-yellow erase eos.\n     display  \"overwriting any existing IRS Chart of Accounts.\"    at 0201 with foreground-color cob-color-yellow.\n     display  \"This must only be done for a new set of accounts for a new client.\" at 0301 with foreground-color cob-color-yellow.\n     display  \"Otherwise, If you have not made a back up of it you should quit this process.\"\n                                                                          at 0401 with foreground-color cob-color-yellow.\n     display  \"Warning: This is NON RECOVERABLE, so think about it\"       at 0714 with foreground-color cob-color-red.\n     display  \"Before responding (Y)es ensure you have a back copy of the original file\"\n                                                                          at 0901 with foreground-color cob-color-yellow.\n     display  \"Otherwise respond (N)o and",
        "line": 92
      },
      {
        "type": "IF",
        "condition": "menu-reply = \"N\" or = \"n\"\n              move \"1\" to menu-reply\n              exit section\n     end-if\n*>\n     display  \"File name to be Imported [12345678901234567890123456789012]\" at 1501 with foreground-color cob-color-yellow.\n     accept   Archive-Name at 1527 with foreground-color cob-color-yellow update.\n     if       Archive-Name = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              display \"Quiting to menu\" at 1501 with erase eol\n              exit section.\n*>\n fa020-Open-Files.\n     open     Input Saved-CoA.\n     if       fs-reply not = zero\n              display \"Problem opening Import File, hit return to quit action\" at 2301\n              accept  ws-reply at 2360\n              exit section\n     end-if\n*>\n*> Open the Nominal Ledger\n*>\n *>    move     1  to  file-function         *> Open output\n *>    move     3  to  access-type\n     perform  acasirsub1-Open-Output.\n     if       we-error = 1\n              display \"Problem opening Accounts for output, hit return to quit action\" at 2301\n              accept  ws-reply at 2365\n              exit section\n     end-if\n *>    move     2 to file-function           *> Close file\n     perform  acasirsub1-Close.\n *>    move     2 to access-type.              *> open i-o\n *>    move     1 to File-Function.\n     perform  acasirsub1-Open.\n     if       we-error not = zero\n              display \"Problem opening Accounts for output, hit return to quit action\" at 2301\n              accept  ws-reply at 2365\n              exit section\n     end-if\n     move     zero to Counter.\n*>\n*>  Set all amounts to zero, cannot use initialize owing to presence of redefines\n*>\n     move     zero  to  nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4).\n*>\n fa030-Read-Input.\n     read     Saved-CoA record at end\n              go to fa040-End-Of-Input.\n*>\n*>  Output the record if record type = T (Text) and check them all in case user has manually modified them.\n*>\n     if       ECoA-Data-Type not = \"T\"\n              display \"Error: Can only import a Text file (.txt) as exported by this program\"\n                                                 at 2001 with blink highlight\n              display \"Hit return for menu\" at 2101\n              accept  ws-reply at 2122\n              exit section\n     end-if\n     move     ECoA-Owning  to nl-owning.\n     move     ECoA-Sub     to nl-sub-nominal.\n     if       ECoA-Sub = zero                *> In case user has modified file\n              move \"O\" to ECoA-nl-Type\n     else\n              move \"S\" to ECoA-nl-Type\n     end-if\n     move     ECoA-nl-Type to nl-type.\n     move     ECoA-nl-Name to nl-name.\n     move     ECoA-nl-AC   to nl-ac.\n*>\n *>    move     5  to  file-function. *> writing\n     perform  acasirsub1-Write.\n     add      1  to Counter.\n     go       to fa030-Read-Input.\n*>\n fa040-End-Of-Input.\n     display  \"Total records created = \" at 2001.\n     display  Counter                    at 2026.\n     display  \"Note count & hit return to continue\" at 2201.\n     accept   ws-reply                   at 2237.\n*>\n     close    Saved-CoA.\n *>    move     2 to file-function.                   *> close NL file\n     perform  acasirsub1-Close.\n*>\n fa999-Exit.\n     exit     section.\n*>\nzz000-clear-NL section.\n*>--------------------\n*>\nzz010-main.\n*>--------\n     call     \"CBL_CHECK_FILE_EXIST\" using file-34 File-Info.\n     if       Return-Code not = zero  *> file not found so not using a CoA from elsewhere for the 1st time\n              move \"0\" to Menu-Reply\n              exit section\n     end-if\n*>\n*>    We now have the CoA but do we have any postings?\n*>\n     call     \"CBL_CHECK_FILE_EXIST\" using file-36 File-Info.\n     if       Return-Code = zero    *> file found so flag is wrong so skip this process\n              move \"0\" to Menu-Reply\n              exit section\n     end-if\n*>\n*>   We now have a CoA with NO posting file so we can clear, lets ask!\n*>\n     display  \"This appears to be the first time you are running IRS and there is a\"\n                                                                          at 0101 with foreground-color cob-color-yellow erase eos.\n     display  \"set of accounts (Nominal Ledger) present\"                  at 0221 with foreground-color cob-color-yellow.\n     display  \"Can I clear down all amounts from these, so that you can start with a clean\"\n                                                                          at 0401 with foreground-color cob-color-yellow.\n     display  \"set of accounts\"                                           at 0533 with foreground-color cob-color-yellow.\n     display  \"Warning: This is NON RECOVERABLE, so think about it\"       at 0714 with foreground-color cob-color-red.\n     display  \"Before responding (Y)es ensure you have a back copy of the original file\"\n                                                                          at 0901 with foreground-color cob-color-yellow.\n     display  \"Otherwise respond (N)o and",
        "line": 1194
      },
      {
        "type": "IF",
        "condition": "menu-reply = \"N\" or = \"n\"\n              move \"1\" to menu-reply\n              exit section\n     end-if\n*>\n     display  \"Wait while I clear the Chart of Accounts down \" at 1501 with foreground-color cob-color-yellow blink.\n*>\n *>    move     1 to file-function.\n *>    move     2 to access-type.                          *> open for i-o\n     perform  acasirsub1-Open.\n     if       we-error not = zero                        *> we have an error so close and quit\n *>             move 2 to file-function                    *>  but as we tested for the file, this SHOULD NOT happen\n              perform  acasirsub1-Close\n              move \"1\" to menu-reply                     *>  ok, we are done\n              exit section\n     end-if.\n*>\n zz020-Read-A-Record.\n*>------------------\n*>\n *>    move     3 to file-function.                        *> read next\n     perform  acasirsub1-Read-Next.\n     if       we-error = 3                               *> EOF\n *>             move 2 to file-function                    *> close\n              perform  acasirsub1-Close\n              move \"0\" to menu-reply                     *>  ok, we are done\n              exit section\n     end-if\n*>                                                           clear all amounts\n     move     zero  to  nl-dr           nl-cr\n                        nl-dr-last (1)  nl-dr-last (2)\n                        nl-dr-last (3)  nl-dr-last (4)\n                        nl-cr-last (1)  nl-cr-last (2)\n                        nl-cr-last (3)  nl-cr-last (4).\n*>\n *>    move     7 to file-function.                        *> rewrite (sub gives no error check)\n     perform  acasirsub1-Rewrite.\n     go       to zz020-Read-A-Record.\n*>\nzz030-Exit.\n     exit     section.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 1322
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 8,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 97,
      "totalOperators": 132,
      "totalOperands": 264,
      "vocabulary": 98,
      "length": 396,
      "volume": 2619.4250982696226
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
