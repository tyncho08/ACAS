{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl015.cbl",
  "fileName": "pl015.cbl",
  "timestamp": "2025-09-15T16:25:47.688Z",
  "programId": "pl015",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 116
      },
      {
        "name": "file",
        "line": 136
      },
      {
        "name": "working-storage",
        "line": 154
      },
      {
        "name": "linkage",
        "line": 383
      },
      {
        "name": "init01",
        "line": 398
      },
      {
        "name": "enquiry",
        "line": 454
      },
      {
        "name": "print-screen",
        "line": 738
      },
      {
        "name": "set-up-work-file",
        "line": 768
      },
      {
        "name": "exit",
        "line": 842
      },
      {
        "name": "get-unposted",
        "line": 844
      },
      {
        "name": "exit",
        "line": 864
      },
      {
        "name": "set-query-flag",
        "line": 866
      },
      {
        "name": "exit",
        "line": 932
      },
      {
        "name": "zz050-Validate-Date",
        "line": 934
      },
      {
        "name": "exit",
        "line": 967
      },
      {
        "name": "zz060-Convert-Date",
        "line": 969
      },
      {
        "name": "exit",
        "line": 1002
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1004
      },
      {
        "name": "exit",
        "line": 1032
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 119
      },
      {
        "name": "file-defs",
        "line": 395
      },
      {
        "name": "menu-exit",
        "line": 442
      },
      {
        "name": "maps04",
        "line": 445
      },
      {
        "name": "enquiry-Main",
        "line": 457
      },
      {
        "name": "main001",
        "line": 458
      },
      {
        "name": "after-disp-heads",
        "line": 467
      },
      {
        "name": "main-display-end",
        "line": 475
      },
      {
        "name": "work-supplier",
        "line": 489
      },
      {
        "name": "inv-amount",
        "line": 492
      },
      {
        "name": "read-sales",
        "line": 508
      },
      {
        "name": "read-open-item",
        "line": 569
      },
      {
        "name": "item-comp-1",
        "line": 615
      },
      {
        "name": "calc-age",
        "line": 651
      },
      {
        "name": "bypass-ageing",
        "line": 671
      },
      {
        "name": "end-statement",
        "line": 674
      },
      {
        "name": "end-if",
        "line": 690
      },
      {
        "name": "disp-totals",
        "line": 691
      },
      {
        "name": "es-disp",
        "line": 701
      },
      {
        "name": "es-accept",
        "line": 710
      },
      {
        "name": "Heads1",
        "line": 745
      },
      {
        "name": "Heads2",
        "line": 753
      },
      {
        "name": "read-invoice",
        "line": 788
      },
      {
        "name": "invoice-eof",
        "line": 828
      },
      {
        "name": "eof-test",
        "line": 833
      },
      {
        "name": "main004-exit",
        "line": 841
      },
      {
        "name": "read-work",
        "line": 850
      },
      {
        "name": "main005-finish",
        "line": 859
      },
      {
        "name": "main005-exit",
        "line": 863
      },
      {
        "name": "accept006",
        "line": 874
      },
      {
        "name": "open006",
        "line": 883
      },
      {
        "name": "error006",
        "line": 920
      },
      {
        "name": "finish006",
        "line": 926
      },
      {
        "name": "main006-exit",
        "line": 931
      },
      {
        "name": "zz050-test-date",
        "line": 961
      },
      {
        "name": "zz050-exit",
        "line": 966
      },
      {
        "name": "zz060-Exit",
        "line": 1001
      },
      {
        "name": "zz070-Exit",
        "line": 1031
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 421,
        "type": "DYNAMIC",
        "using": [
          "File-29",
          "*>",
          "Open",
          "ITM5",
          "file",
          "File-Info",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "display",
          "PL120",
          "at",
          "2301",
          "display",
          "PL116",
          "at",
          "2401",
          "accept",
          "Accept-Reply",
          "at",
          "2440",
          "go",
          "to",
          "menu-exit"
        ]
      },
      {
        "target": "maps04",
        "line": 448,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 764,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 105,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 114,
        "replacing": null
      },
      {
        "name": "selpinv",
        "line": 122,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 123,
        "replacing": null
      },
      {
        "name": "seloi5",
        "line": 124,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 126,
        "replacing": null
      },
      {
        "name": "fdpinv2",
        "line": 139,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 140,
        "replacing": null
      },
      {
        "name": "fdoi5",
        "line": 141,
        "replacing": null
      },
      {
        "name": "wsfdpinv2",
        "line": 160,
        "replacing": null
      },
      {
        "name": "plwspl",
        "line": 161,
        "replacing": null
      },
      {
        "name": "plwsoi5B",
        "line": 162,
        "replacing": null
      },
      {
        "name": "print-spool-command-p",
        "line": 164,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 165,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 166,
        "replacing": null
      },
      {
        "name": "plwsoi",
        "line": 167,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 231,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 257,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 386,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 387,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 388,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1034,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 411
      },
      {
        "target": "set-up-work-file",
        "thru": null,
        "line": 431
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 433
      },
      {
        "target": "OTM5-Open-Input",
        "thru": null,
        "line": 434
      },
      {
        "target": "enquiry",
        "thru": null,
        "line": 435
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 437
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 438
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 464
      },
      {
        "target": "Purch-Start",
        "thru": null,
        "line": 494
      },
      {
        "target": "OTM5-Start",
        "thru": null,
        "line": 496
      },
      {
        "target": "Purch-Read-Next",
        "thru": null,
        "line": 510
      },
      {
        "target": "get-unposted",
        "thru": null,
        "line": 550
      },
      {
        "target": "OTM5-Read-Next",
        "thru": null,
        "line": 571
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 591
      },
      {
        "target": "print-screen",
        "thru": null,
        "line": 725
      },
      {
        "target": "set-query-flag",
        "thru": null,
        "line": 731
      },
      {
        "target": "varying",
        "thru": null,
        "line": 754
      },
      {
        "target": "Heads1",
        "thru": null,
        "line": 759
      },
      {
        "target": "write",
        "thru": null,
        "line": 760
      },
      {
        "target": "main001",
        "thru": null,
        "line": 774
      },
      {
        "target": "PInvoice-Open-Input",
        "thru": null,
        "line": 781
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 785
      },
      {
        "target": "PInvoice-Read-Next-Header",
        "thru": null,
        "line": 790
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 814
      },
      {
        "target": "PInvoice-Close",
        "thru": null,
        "line": 830
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 881
      },
      {
        "target": "OTM5-Open",
        "thru": null,
        "line": 885
      },
      {
        "target": "OTM5-Read-Indexed",
        "thru": null,
        "line": 892
      },
      {
        "target": "OTM5-Rewrite",
        "thru": null,
        "line": 912
      },
      {
        "target": "OTM5-Close",
        "thru": null,
        "line": 928
      },
      {
        "target": "OTM5-Open-Input",
        "thru": null,
        "line": 929
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 964
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 978
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "references",
        "to": "File-Status - depleted",
        "line": 65
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 401
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 410
      },
      {
        "from": "ws-date",
        "to": "l0-date",
        "line": 412
      },
      {
        "from": "prog-name",
        "to": "l0-version",
        "line": 413
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 417
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 418
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 463
      },
      {
        "from": "spaces",
        "to": "customer-in",
        "line": 476
      },
      {
        "from": "customer-in",
        "to": "WS-Purch-Key\n                             OI-Supplier      oi5-supplier\n                             l2-account\n                             work-supplier",
        "line": 486
      },
      {
        "from": "zero",
        "to": "OI-Invoice       oi5-invoice\n                             work-invoice\n                             inv-amount",
        "line": 490
      },
      {
        "from": "spaces",
        "to": "line-7-19",
        "line": 517
      },
      {
        "from": "purch-name",
        "to": "l1-name",
        "line": 518
      },
      {
        "from": "1",
        "to": "a",
        "line": 520
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 521
      },
      {
        "from": "address-line",
        "to": "l2-address",
        "line": 523
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 525
      },
      {
        "from": "address-line",
        "to": "l3-address",
        "line": 527
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 529
      },
      {
        "from": "address-line",
        "to": "l4-address",
        "line": 531
      },
      {
        "from": "spaces",
        "to": "address-line",
        "line": 533
      },
      {
        "from": "address-line",
        "to": "l5-address",
        "line": 535
      },
      {
        "from": "purch-current",
        "to": "l2-balance",
        "line": 543
      },
      {
        "from": "purch-unapplied",
        "to": "l3-unapplied",
        "line": 544
      },
      {
        "from": "purch-limit",
        "to": "l4-credit-limit",
        "line": 547
      },
      {
        "from": "zero",
        "to": "l4-unposted   a",
        "line": 548
      },
      {
        "from": "zero",
        "to": "a b c",
        "line": 563
      },
      {
        "from": "1",
        "to": "Screen-Start",
        "line": 566
      },
      {
        "from": "Screen-Size",
        "to": "Screen-End",
        "line": 567
      },
      {
        "from": "open-item-record-5",
        "to": "oi-header",
        "line": 577
      },
      {
        "from": "100",
        "to": "a    *> was 40\n              go to item-comp-1",
        "line": 582
      },
      {
        "from": "zero",
        "to": "oi-invoice",
        "line": 586
      },
      {
        "from": "oi-invoice",
        "to": "l7-invoice (a)",
        "line": 588
      },
      {
        "from": "oi-date",
        "to": "u-bin",
        "line": 590
      },
      {
        "from": "ws-date",
        "to": "l7-date (a)",
        "line": 592
      },
      {
        "from": "\"H\"",
        "to": "l7-hold (a)",
        "line": 595
      },
      {
        "from": "spaces",
        "to": "ws-desc",
        "line": 597
      },
      {
        "from": "oi-cr",
        "to": "ws-inv8\n              string  \"CN",
        "line": 605
      },
      {
        "from": "\"Payment\"",
        "to": "ws-desc\n         else\n          if  oi-type = 6\n              move \"Journal Payment\" to ws-desc",
        "line": 609
      },
      {
        "from": "ws-desc",
        "to": "l7-desc (a)",
        "line": 613
      },
      {
        "from": "\"P\"",
        "to": "l7-prompt (a)\n              add oi-date oi-deduct-days giving work-1\n              if   work-1 not < run-date\n                   subtract oi-deduct-amt from inv-amount",
        "line": 620
      },
      {
        "from": "amount-out",
        "to": "l7-balance (a)",
        "line": 638
      },
      {
        "from": "inv-amount",
        "to": "l7-amount (a)",
        "line": 639
      },
      {
        "from": "oi-paid",
        "to": "l7-paid (a)",
        "line": 640
      },
      {
        "from": "inv-amount",
        "to": "l7-amount (a)  l7-paid (a)\n              move zero to l7-balance (a)\n              go to bypass-ageing",
        "line": 643
      },
      {
        "from": "zeros",
        "to": "l7-balance (a) l7-amount (a)\n              go to bypass-ageing",
        "line": 648
      },
      {
        "from": "8000",
        "to": "Screen-End\n               subtract b from Body-Lines giving c\n               add 1 to c\n               add c 7 giving l\n               display \" \" at line l col 1 with erase eos\n            end-if\n     end-if",
        "line": 684
      },
      {
        "from": "bal-0",
        "to": "l21-current",
        "line": 694
      },
      {
        "from": "bal-30",
        "to": "l21-bal30",
        "line": 695
      },
      {
        "from": "bal-60",
        "to": "l21-bal60",
        "line": 696
      },
      {
        "from": "bal-90",
        "to": "l21-bal90",
        "line": 697
      },
      {
        "from": "bal-t",
        "to": "l21-os",
        "line": 698
      },
      {
        "from": "space",
        "to": "s1",
        "line": 712
      },
      {
        "from": "65",
        "to": "cole",
        "line": 713
      },
      {
        "from": "zero",
        "to": "bal-0 bal-30 bal-60 bal-90 bal-t\n              go to enquiry-Main",
        "line": 728
      },
      {
        "from": "14",
        "to": "lin",
        "line": 775
      },
      {
        "from": "zero",
        "to": "cole",
        "line": 776
      },
      {
        "from": "zero",
        "to": "a",
        "line": 777
      },
      {
        "from": "ih-invoice",
        "to": "work-invoice",
        "line": 801
      },
      {
        "from": "ih-supplier",
        "to": "work-supplier",
        "line": 802
      },
      {
        "from": "zero",
        "to": "a\n              add  1 to cole\n              display \"",
        "line": 819
      },
      {
        "from": "zero",
        "to": "cole",
        "line": 824
      },
      {
        "from": "\"Y\"",
        "to": "work-file-data\n              display Pl118 at 1801 with foreground-color 2",
        "line": 838
      },
      {
        "from": "inv-amount",
        "to": "l4-unposted",
        "line": 861
      },
      {
        "from": "zeros",
        "to": "ws-tinv",
        "line": 869
      },
      {
        "from": "customer-in",
        "to": "oi5-supplier",
        "line": 890
      },
      {
        "from": "ws-tinv",
        "to": "oi5-invoice",
        "line": 891
      },
      {
        "from": "open-item-record-5",
        "to": "oi-header",
        "line": 902
      },
      {
        "from": "\"H\"",
        "to": "oi-hold-flag\n      else\n              move space to oi-hold-flag",
        "line": 907
      },
      {
        "from": "oi-Header",
        "to": "Open-Item-Record-5",
        "line": 911
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 943
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 945
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 949
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 956
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 962
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 963
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 980
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 982
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 985
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 989
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 996
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 1012
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1015
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 1019
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1026
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n*>\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n *> copy \"selpinv.cob\".\n *> copy \"selpl.cob\".\n *> copy \"seloi5.cob\".\n*>\n copy \"selprint.cob\".\n     select work-file  assign       file-21\n                       access       dynamic\n                       organization indexed\n                       status       fs-reply\n                       record key   work-key.\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpinv2.cob\".\n*> copy \"fdpl.cob\".\n*> copy \"fdoi5.cob\".\n fd  work-file.\n*>\n 01  work-record.\n     03  work-key.\n         05  work-supplier  pic x(7).\n         05  work-invoice   binary-long.\n     03  work-amount        pic s9(8)v99  comp-3.\n*>\n fd  print-file.\n*>\n 01  print-record            pic x(80).\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(15) value \"PL015 (3.02.11)\".\n*>\n*>\n*> Ex fd block.\n copy \"wsfdpinv2.cob\".   *> ex fd def.\n copy \"plwspl.cob\".      *> ex fd def.\n copy \"plwsoi5B.cob\".     *> ex fd def\n*>  WS.\n copy \"print-spool-command-p.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"plwsoi.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n*>     03  WS-PInvoice-Record     pic x.\n*>     03  WS-OTM5-Record         pic x.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n 01  ws-data.\n     03  a               binary-char     value zero.\n     03  b               binary-char     value zero.\n     03  c               binary-char     value zero.\n     03  l               binary-char     value zero.\n     03  Screen-Size     binary-long     value zero.\n     03  Screen-Start    binary-long     value zero.\n     03  Screen-End      binary-long     value zero.\n     03  ws-inv.\n         05  ws-inv8     pic z(7)9.\n     03  work-1          binary-long     value zero.\n     03  amount-out      pic s9(8)v99  comp-3 value zero.\n     03  inv-amount      pic s9(8)v99  comp-3 value zero.\n     03  customer-in     pic x(7)        value space.\n     03  work-file-data  pic x           value \"N\".\n     03  ws-tinv         pic 9(8)        value zero.\n     03  address-line    pic x(36).\n     03  ws-desc         pic x(20)       value spaces.\n*>\n     03  ws-env-lines    pic 999         value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-21-lines     binary-char unsigned value zero.\n     03  ws-20-lines     binary-char unsigned value zero.\n     03  Body-lines      binary-char unsigned value zero.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide\n*>       NONE\n*> Module specific\n     03  PL111          pic x(53) value \"PL111 Error On Writing Work File. Hit Return To Abort\".\n     03  PL112          pic x(21) value \"PL112 Can't open file\".\n     03  PL113          pic x(19) value \"PL113 Can't find it\".\n     03  PL114          pic x(22) value \"PL114 Record not found\".\n     03  PL115          pic x(22) value \"PL115 Error On Rewrite\".\n     03  PL116          pic x(38) value \"PL116 Note: and hit return to continue\".\n     03  PL117          pic x(35) value \"PL117 No Work File Created..No Data\".\n     03  PL118          pic x(23) value \"PL118 Work file Created\".\n     03  PL119          pic x(22) value \"PL119 Only on invoices\".\n     03  PL120          pic x(38) value \"PL120 Purchase Transactions Not Posted\".\n*>\n 01  error-code          pic 999.\n*>\n 01  balances        comp-3.\n     03  bal-0           pic s9(8)v99 value zero.\n     03  bal-30          pic s9(8)v99 value zero.\n     03  bal-60          pic s9(8)v99 value zero.\n     03  bal-90          pic s9(8)v99 value zero.\n     03  bal-t           pic s9(8)v99 value zero.\n*>\n 01  line-0.\n     03  l0-version      pic x(16).\n     03  filler          pic x(13)    value spaces.\n     03  l0-title        pic x(23)  value \"Purchase Ledger Enquiry\".\n     03  filler          pic x(18)  value spaces.\n     03  l0-date         pic x(10).\n*>\n 01  line-1.\n     03  line-1a.\n         05  l1-lit      pic x(10)  value \"Supplier:\".\n         05  l1-name     pic x(30).\n     03  line-1b.\n         05  filler      pic x(40)  value all \"*\".\n*>\n 01  line-2.\n     03  line-2a.\n         05  l2-lit      pic x(10)   value \"Address :\".\n         05  l2-address  pic x(30).\n     03  line-2b.\n         05  filler      pic x(10)   value \"* A/C No [\".\n         05  l2-account  pic x(7).\n         05  filler      pic x       value \"]\".\n         05  filler      pic x(10)   value \"*Balance [\".\n         05  l2-balance  pic z(6)9.99.\n         05  filler      pic xx      value \"]*\".\n*>\n 01  line-3.\n     03  line-3a.\n         05  filler       pic x(10)  value spaces.\n         05  l3-address   pic x(30).\n     03  line-3b.\n         05  filler       pic x(10)  value \"* Ytd    [\".\n         05  l3-ytd       pic z(6)9.\n         05  filler       pic x(12)  value \"]*Unapplied[\".\n         05  l3-unapplied pic z(5)9.99.\n         05  filler       pic xx     value \"]*\".\n*>\n 01  line-4.\n     03  line-4a.\n          05  filler          pic x(10)       value spaces.\n          05  l4-address      pic x(30).\n     03  line-4b.\n          05  filler          pic x(10)  value \"* Credit [\".\n          05  l4-credit-limit pic z(6)9.\n          05  filler          pic x(11)  value \"]*Unposted[\".\n          05  l4-unposted     pic z(6)9.99.\n          05  filler          pic xx     value \"]*\".\n*>\n 01  line-5.\n     03  line-5a.\n         05  filler      pic x(10)       value spaces.\n         05  l5-address  pic x(30).\n     03  line-5b.\n         05  filler      pic x(40)       value all \"*\".\n*>\n 01  line-6.\n     03  filler          pic x           value space.\n     03  l6-lit1         pic x(06)       value \"Number\".\n     03  filler          pic x(07)       value spaces.\n     03  l6-lit2         pic x(04)       value \"Date\".\n     03  filler          pic x(07)       value spaces.\n     03  l6-lit3         pic x(11)       value \"Description\".\n     03  filler          pic x(10)       value spaces.\n     03  l6-lit4         pic x(08)       value \"Invoiced\".\n     03  filler          pic x(08)       value spaces.\n     03  l6-lit5         pic x(04)       value \"Paid\".\n     03  filler          pic x(05)       value spaces.\n     03  l6-lit6         pic x(07)       value \"Balance\".\n*>\n 01  line-7-19.\n     03  l7-group  occurs 100.\n         05  l7-invoice  pic z(7)9       blank when zero.\n         05  l7-prompt   pic x.\n         05  l7-hold     pic x.\n         05  filler      pic x.\n         05  l7-date     pic x(11).\n         05  l7-desc     pic x(22).\n         05  l7-amount   pic zzzzz,zz9.99.\n         05  l7-paid     pic zzzzz,zz9.99.\n         05  l7-balance  pic zzzzz,zz9.99.\n*>\n 01  line-20.\n     03  l20-t1          pic x(17)   value \"Total Outstanding\".\n     03  filler          pic x(10)   value spaces.\n     03  l20-t2          pic x(7)    value \"Current\".\n     03  filler          pic x(11)   value spaces.\n     03  l20-t3          pic x(2)    value \"30\".\n     03  filler          pic x(13)   value spaces.\n     03  l20-t4          pic x(2)    value \"60\".\n     03  filler          pic x(12)   value spaces.\n     03  l20-t5          pic xxx     value \"90+\".\n*>\n 01  line-21.\n     03  filler          pic x(5)        value spaces.\n     03  l21-os          pic zz,zzz,zz9.99.\n     03  l21-current     pic z(6),zzz,zz9.99.\n     03  l21-bal30       pic zzzz,zzz,zz9.99.\n     03  l21-bal60       pic zzzz,zzz,zz9.99.\n     03  l21-bal90       pic zzzz,zzz,zz9.99.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-21-lines.\n     subtract 4 from ws-lines giving ws-20-lines.\n     subtract 11 from ws-lines giving Body-Lines.\n     move     to-day to ws-date.\n     perform  zz070-Convert-Date.\n     move     ws-date to l0-date.\n     move     prog-name to l0-version.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     1  to File-Key-No.\n*>\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-29    *> Open ITM5 file\n                                                 File-Info\n              if    return-code not = zero          *> not = zero - No file found\n                    display PL120  at 2301\n                    display PL116  at 2401\n                    accept  Accept-Reply at 2440\n                    go to menu-exit.\n*>\n*> First creates a list of active inv & cr. notes with total amt by cust & inv nos\n*>\n     perform  set-up-work-file.\n     open     input work-file.\n     perform  Purch-Open-Input.     *> open     input purchase-file open-item-file-5.\n     perform  OTM5-Open-Input.\n     perform  enquiry.\n     close    work-file.         *>close    purchase-file open-item-file-5.\n     perform  Purch-Close.\n     perform  OTM5-Close.\n     open     output work-file.                    *> clear down workfile, is this safe here?\n     close    work-file.\n*>\n menu-exit.\n     exit     program.\n*>\n maps04.\n*>******\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n*>****************************************************************\n*>                     p r o c e d u r e s                       *\n*>****************************************************************\n*>\n enquiry                 section.\n*>==============================\n*>\n enquiry-Main.\n main001.\n*>\n     display  \" \" at 0101 with erase eos.\n     display  prog-name at 0101 with foreground-color 2.\n     display  \"Purchase Ledger Enquiry\" at 0129  with foreground-color 2.\n     move     to-day to ws-date.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0171    with foreground-color 2.\n*>\n after-disp-heads.\n*>\n     display  \"****************************************\" at 0241 with foreground-color 2.\n     display  \"*A/C Nos [       ]*Balance [          ]*\" at 0341 with foreground-color 2.\n     display  \"*Ytd    [        ]*Unapplied[         ]*\" at 0441 with foreground-color 2.\n     display  \"*Credit [        ]*Unposted[          ]*\" at 0541 with foreground-color 2.\n     display  \"****************************************\" at 0641 with foreground-color 2.\n*>\n main-display-end.\n     move     spaces to customer-in.\n     accept   customer-in at 0351 with foreground-color 3.\n     if       customer-in = spaces\n              go to main-exit.\n     if       cob-crt-status = cob-scr-esc\n              go to main-exit.\n*>\n     move     function upper-case (customer-in) to customer-in.\n     display  customer-in at 0351 with foreground-color 3.\n*>\n     move     customer-in to WS-Purch-Key\n                             OI-Supplier      oi5-supplier\n                             l2-account\n                             work-supplier.\n     move     zero        to OI-Invoice       oi5-invoice\n                             work-invoice\n                             inv-amount.\n     set      fn-not-less-than to true.\n     perform  Purch-Start.       *> start purchase-file key not < WS-Purch-Key.\n     set      fn-not-less-than to true.\n     perform  OTM5-Start.        *> start open-item-file-5 key not < oi5-key.\n     if       fs-reply not = zero          *> not = zero - No file found\n              display PL120  at 2301\n              display PL116  at 2401\n              accept  Accept-Reply at 2440\n              go to menu-exit.\n*>\n     if       work-file-data = \"N\"\n              go to read-sales.\n*>\n     start    work-file  key not < work-key.\n*>\n read-sales.\n*>\n     perform  Purch-Read-Next.         *> read purchase-file next record at end\n     if       fs-reply = 10\n              go to  main-display-end.\n*>\n     if       WS-Purch-Key not = customer-in\n              go to main-display-end.\n*>\n     move     spaces to line-7-19.\n     move     purch-name  to  l1-name.\n*>\n     move     1  to  a.\n     move     spaces  to  address-line.\n     unstring purch-address  delimited by  pl-delim into  address-line  count a  pointer  a.\n     move     address-line  to  l2-address.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited by  pl-delim into  address-line  count a  pointer  a.\n     move     address-line  to  l3-address.\n*>\n     move     spaces  to  address-line.\n     unstring purch-address  delimited by  pl-delim into  address-line  count a  pointer  a.\n     move     address-line  to  l4-address.\n*>\n     move     spaces to address-line.\n     unstring purch-address  delimited by  pl-delim into  address-line  count a  pointer  a.\n     move     address-line  to  l5-address.\n*>\n     display  line-1a at 0201 with foreground-color 2.\n     display  line-2a at 0301 with foreground-color 2.\n     display  line-3a at 0401 with foreground-color 2.\n     display  line-4a at 0501 with foreground-color 2.\n     display  line-5a at 0601 with foreground-color 2.\n*>\n     move     purch-current to l2-balance.\n     move     purch-unapplied to l3-unapplied.\n     add      pturnover-q (1) pturnover-q (2)\n              pturnover-q (3) pturnover-q (4) giving l3-ytd.\n     move     purch-limit to l4-credit-limit.\n     move     zero        to l4-unposted   a.\n*>\n     perform  get-unposted.\n*>\n     display  l2-balance      at 0369 with foreground-color 3.\n     display  l3-ytd          at 0451 with foreground-color 3.\n     if       purch-unapplied not = zero\n              display l3-unapplied at 0470 with foreground-color 3.\n     display  l4-credit-limit at 0551 with foreground-color 3.\n     if       inv-amount not = zero\n              display l4-unposted at 0569 with foreground-color 3.\n*>\n*> PL020 has line6 displaying separate lits\n*>\n     display  line-6 at 0701 with foreground-color 2.\n     move     zero to a b c.\n*>\n     multiply Body-Lines by 80 giving Screen-Size.\n     move     1 to Screen-Start.\n     move     Screen-Size to Screen-End.\n*>\n read-open-item.\n*>\n     perform  OTM5-Read-Next.         *> read open-item-file-5 next record at end\n     if       fs-reply not = zero\n              go to end-statement.\n*>\n     if       OI-Supplier not =  WS-Purch-Key   *> oi5-Supplier\n              go to  end-statement.\n     move     open-item-record-5  to  oi-header.\n*>\n     add      1 to a.\n     if       a > 100   *> was 39\n              move \">> Screen Overflow <<\" to l7-desc (100) *> was 39\n              move 100 to a    *> was 40\n              go to item-comp-1.\n*>\n     if       oi-type = 5 or 6\n              move  zero  to  oi-invoice.\n*>\n     move     oi-invoice  to  l7-invoice (a).\n*>\n     move     oi-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date   to  l7-date (a).\n*>\n     if       oi-hold-flag not = space\n              move \"H\" to l7-hold (a).\n*>\n     move     spaces  to  ws-desc.\n     if       oi-type = 1\n              move \"Receipt \" to ws-desc\n     else\n       if     oi-type = 2\n              string  \"Goods - \"  delimited  by size  oi-ref delimited by \"  \" into ws-desc\n       else\n        if    oi-type = 3\n              move oi-cr to ws-inv8\n              string  \"CN.Re Inv -\" delimited by size ws-inv delimited by size into ws-desc\n        else\n         if   oi-type = 5\n              move  \"Payment\"  to  ws-desc\n         else\n          if  oi-type = 6\n              move \"Journal Payment\" to ws-desc.\n     move     ws-desc to l7-desc (a).\n*>\n item-comp-1.\n*>\n     add      oi-net oi-carriage oi-vat oi-c-vat giving  inv-amount.\n     if       oi-type = 2\n         and  oi-deduct-amt not = zero\n              move \"P\" to l7-prompt (a)\n              add oi-date oi-deduct-days giving work-1\n              if   work-1 not < run-date\n                   subtract oi-deduct-amt from inv-amount.\n*>\n     if       oi-type = 3\n              multiply -1 by oi-paid.\n     if       oi-type = 2 or 3\n              subtract oi-paid from inv-amount giving  amount-out.\n*>\n     if       a > 3100  *> was 39\n         and  (oi-type = 2 or 3)\n              go to calc-age.\n*>\n     if       a > 100   *> was 39\n              go to bypass-ageing.\n*>\n     if       oi-type = 2 or 3\n              move amount-out to l7-balance (a).\n     move     inv-amount to l7-amount (a).\n     move     oi-paid to l7-paid (a).\n*>\n     if       oi-type = 1\n              move inv-amount to l7-amount (a)  l7-paid (a)\n              move zero to l7-balance (a)\n              go to bypass-ageing.\n*>\n     if       oi-type = 5  or  6\n              move zeros to l7-balance (a) l7-amount (a)\n              go to bypass-ageing.\n*>\n calc-age.\n*>\n     subtract oi-date  from  run-date  giving  work-1.\n*>\n*> now work out ageing\n*>  (dont worry if paid in full - routine still works ok)\n*>\n     if       work-1  <  30\n              add  amount-out  to  bal-0\n     else\n      if      work-1  <  60\n              add  amount-out  to  bal-30\n      else\n       if     work-1  <  90\n              add  amount-out  to  bal-60\n       else\n              add  amount-out  to  bal-90.\n*>\n     add      amount-out  to  bal-t.\n*>\n bypass-ageing.\n     go       to read-open-item.\n*>\n end-statement.\n*>************\n*>\n     display  line-7-19 (Screen-Start:Screen-End) at 0801 with foreground-color 2\n     add Body-Lines to b.\n     if     a > b\n            add Screen-Size to Screen-Start\n            add Screen-Size to Screen-End\n            if b > 100\n               subtract 100 from b   *>  = lines to display\n               move 8000 to Screen-End\n               subtract b from Body-Lines giving c\n               add 1 to c\n               add c 7 giving l\n               display \" \" at line l col 1 with erase eos\n            end-if\n     end-if.\n disp-totals.\n     display  line-20 at line ws-21-lines col 1 with foreground-color 2.\n*>\n     move     bal-0   to  l21-current.\n     move     bal-30  to  l21-bal30.\n     move     bal-60  to  l21-bal60.\n     move     bal-90  to  l21-bal90.\n     move     bal-t   to  l21-os.\n     display  line-21 at line ws-22-lines col 1 with foreground-color 2.\n*>\n es-disp.\n*>\n     display  \"Select: 'P'rint, 'N'ext enquiry, 'T'oggle query flag, \"\n                                            at line ws-lines col 01 with foreground-color 2.\n     if       a > b\n              display \"'M'ore or 'E'nd [ ]\" at line ws-lines col 55 with foreground-color 2\n     else\n              display \"or 'E'nd [ ]\"        at line ws-lines col 55 with foreground-color 2.\n*>\n es-accept.\n*>\n     move     space to s1.\n     move     65 to cole.\n     if       a > b\n              add 7 to cole.\n     accept   s1 at line ws-lines col cole  with foreground-color 6 update auto.\n     move     function upper-case (s1) to s1.\n     if       cob-crt-status = cob-scr-esc\n              go to main-exit.\n     if       s1 = \"E\"\n              go to main-exit.\n     if       s1 = \"M\"\n              go to end-statement.\n     if       s1 = \"P\"\n              perform print-screen\n              go to es-disp.\n     if       s1 = \"N\"\n              move zero to bal-0 bal-30 bal-60 bal-90 bal-t\n              go to enquiry-Main.\n     if       s1 = \"T\"\n              perform set-query-flag\n              go to es-disp.\n     go       to es-accept.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n print-screen            section.\n*>==============================\n*>\n     open     output print-file.\n*>\n     write    print-record from line-0 after 1.  *> ex page\n*>\nHeads1.\n     write    print-record from line-1 after 1.\n     write    print-record from line-2 after 1.\n     write    print-record from line-3 after 1.\n     write    print-record from line-4 after 1.\n     write    print-record from line-5 after 1.\n     write    print-record from line-6 after 1.\n*>\n Heads2.\n     perform  varying l from 1 by 1 until l > a\n              move l7-group (l) to print-record\n              write print-record after 1\n              if  l = 59\n                  write print-record from line-0 after page\n                  perform Heads1\n     end-perform\n     write    print-record from line-20 after 2.\n     write    print-record from line-21 after 2.\n     close    print-file.\n     call     \"SYSTEM\" using Print-Report.\n*>\n main-exit.   exit section.\n*>\n set-up-work-file  section.\n*>========================\n*>\n*>  Create work file with unapplied invoices/cr. notes etc so we can\n*>    show them with current invoice/payments per supplier\n*>\n     perform  main001.\n     move     14 to lin.\n     move     zero to cole.\n     move     zero to a.\n     if       p-flag-i not = 1\n              go to eof-test.\n     open     output work-file.\n     perform  PInvoice-Open-Input.       *> open  input  invoice-file.\n*>\n     if       fs-reply not = zero\n              close work-file            *> invoice-file\n              perform PInvoice-Close\n              go to main004-exit.\n*>\n read-invoice.\n*>\n     perform  PInvoice-Read-Next-Header.        *> read     invoice-file next record at end\n     if       fs-reply = 10\n              go to invoice-eof.\n*>\n     if       ih-test not = zero\n              go to read-invoice.\n     if       ih-status = \"z\"\n              go to read-invoice.\n     if       ih-type = 1 or 4\n              go to read-invoice.\n*>\n     move     ih-invoice  to work-invoice.\n     move     ih-supplier to work-supplier.\n     add      ih-net ih-carriage ih-vat ih-c-vat\n                giving work-amount.\n*>\n     if       ih-type = 3\n              multiply -1 by work-amount.\n*>\n     write    work-record.\n     if       fs-reply not = zero\n              display PL111 at line ws-lines col 1 with foreground-color 4\n              accept s1 at line ws-lines col 53 with foreground-color 6\n              close work-file           *> invoice-file\n              perform PInvoice-Close\n              go to menu-exit.\n*>\n     add      1 to a.\n     if       a > 9\n              move zero to a\n              add  1 to cole\n              display \".\" at curs with foreground-color 3.\n     if       cole > 79\n              add 1 to lin\n              move zero to cole.\n*>\n     go       to read-invoice.\n*>\n invoice-eof.\n*>\n     perform  PInvoice-Close.           *> close    invoice-file work-file.\n     close    work-file.\n*>\n eof-test.\n*>\n     if       lin = 14 and cole = zero and a = zero\n              display PL117 at 1801 with foreground-color 2\n     else\n              move \"Y\" to work-file-data\n              display Pl118 at 1801 with foreground-color 2.\n*>\n main004-exit.\n     exit     section.\n*>\n get-unposted  section.\n*>====================\n*>\n     if       work-file-data = \"N\"\n              go to main005-finish.\n*>\n read-work.\n*>\n     read     work-file next record at end\n              go to main005-finish.\n     if       customer-in not = work-supplier\n              go to main005-finish.\n     add      work-amount to inv-amount.\n     go       to read-work.\n*>\n main005-finish.\n*>\n     move     inv-amount to l4-unposted.\n*>\n main005-exit.\n     exit     section.\n*>\n set-query-flag section.\n*>======================\n*>\n     move     zeros to ws-tinv.\n     display  \"For Account:        . Give invoice no. to toggle\" &\n              \" [        ]\" at line ws-23-lines col 1 with foreground-color 2.\n     display  customer-in line ws-23-lines col 14 with foreground-color 3.\n*>\n accept006.\n*>\n     accept   ws-tinv at line ws-23-lines col 51 with foreground-color 3 update.\n     if       ws-tinv = zero\n              go to main006-exit.\n*>\n     display  \" \" at line ws-23-lines col 01 with erase eol.\n     perform  OTM5-Close.            *>  close    open-item-file-5.\n*>\n open006.\n*>\n     perform  OTM5-Open.        *>  open     i-o open-item-file-5.\n     if       fs-reply not = zero\n              display PL112 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     move     customer-in to oi5-supplier.\n     move     ws-tinv to oi5-invoice.\n     perform  OTM5-Read-Indexed.       *> read     open-item-file-5 invalid key\n     if       fs-reply = 21\n              display PL113 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     if       oi5-invoice not = ws-tinv\n       or     oi5-supplier not = customer-in\n              display PL114 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     move     open-item-record-5 to oi-header.\n     if       oi-type not = 2\n              display PL119 at line ws-23-lines col 1 with foreground-color 2\n              go to error006.\n     if       oi-hold-flag = space\n              move \"H\" to oi-hold-flag\n      else\n              move space to oi-hold-flag.\n*>\n     move     oi-Header to Open-Item-Record-5.\n     perform  OTM5-Rewrite.        *> rewrite  open-item-record-5 from oi-header invalid key\n     if       fs-reply = 21 or 22\n          or  WE-Error - 994\n              display PL115 at line ws-23-lines col 1 with foreground-color 4\n              go to error006.\n*>\n     go       to finish006.\n*>\n error006.\n*>\n     display  PL116 at line ws-lines col 1 with foreground-color 2.\n     accept   s1 at line ws-lines col 34 with foreground-color 6\n     display  \" \" at line ws-23-lines col 1 with erase eol.\n*>\n finish006.\n*>\n     perform  OTM5-Close.            *> close    open-item-file-5.\n     perform  OTM5-Open-Input.       *> open     input open-item-file-5.\n*>\n main006-exit.\n     exit     section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 102
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 5,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 109,
      "totalOperators": 85,
      "totalOperands": 170,
      "vocabulary": 110,
      "length": 255,
      "volume": 1729.2467269487884
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
