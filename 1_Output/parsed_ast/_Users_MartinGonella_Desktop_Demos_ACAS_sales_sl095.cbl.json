{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl095.cbl",
  "fileName": "sl095.cbl",
  "timestamp": "2025-09-15T16:25:30.315Z",
  "programId": "sl095",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 97
      },
      {
        "name": "file",
        "line": 110
      },
      {
        "name": "working-storage",
        "line": 116
      },
      {
        "name": "linkage",
        "line": 255
      },
      {
        "name": "init01",
        "line": 270
      },
      {
        "name": "report1",
        "line": 292
      },
      {
        "name": "zz050-Validate-Date",
        "line": 510
      },
      {
        "name": "exit",
        "line": 543
      },
      {
        "name": "zz060-Convert-Date",
        "line": 545
      },
      {
        "name": "exit",
        "line": 578
      },
      {
        "name": "zz070-Convert-Date",
        "line": 580
      },
      {
        "name": "exit",
        "line": 608
      },
      {
        "name": "maps04",
        "line": 610
      },
      {
        "name": "exit",
        "line": 616
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 100
      },
      {
        "name": "file-defs",
        "line": 267
      },
      {
        "name": "menu-exit",
        "line": 285
      },
      {
        "name": "read-loop",
        "line": 312
      },
      {
        "name": "Read-Loop-Tests",
        "line": 339
      },
      {
        "name": "process-invoice",
        "line": 402
      },
      {
        "name": "loop-end",
        "line": 435
      },
      {
        "name": "headings",
        "line": 487
      },
      {
        "name": "zz050-test-date",
        "line": 537
      },
      {
        "name": "zz050-exit",
        "line": 542
      },
      {
        "name": "zz060-Exit",
        "line": 577
      },
      {
        "name": "zz070-Exit",
        "line": 607
      },
      {
        "name": "maps04-exit",
        "line": 615
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "SYSTEM",
        "line": 484,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      },
      {
        "target": "maps04",
        "line": 613,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 87,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 96,
        "replacing": null
      },
      {
        "name": "selsl",
        "line": 103,
        "replacing": null
      },
      {
        "name": "slselois",
        "line": 104,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 105,
        "replacing": null
      },
      {
        "name": "fdsl",
        "line": 113,
        "replacing": null
      },
      {
        "name": "slfdois",
        "line": 114,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 115,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 119,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 120,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 121,
        "replacing": null
      },
      {
        "name": "wsoi",
        "line": 129,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 130,
        "replacing": null
      },
      {
        "name": "slwsoi3",
        "line": 131,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 253,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 258,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 259,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 260,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 618,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 280
      },
      {
        "target": "report1",
        "thru": null,
        "line": 283
      },
      {
        "target": "OTM3-Open-Input",
        "thru": null,
        "line": 302
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 304
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 308
      },
      {
        "target": "headings",
        "thru": null,
        "line": 310
      },
      {
        "target": "OTM3-Read-Next-Sorted-By-Batch",
        "thru": null,
        "line": 325
      },
      {
        "target": "OTM3-Close",
        "thru": null,
        "line": 327
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 359
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 367
      },
      {
        "target": "headings",
        "thru": null,
        "line": 393
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 417
      },
      {
        "target": "headings",
        "thru": null,
        "line": 432
      },
      {
        "target": "headings",
        "thru": null,
        "line": 439
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 479
      },
      {
        "target": "zz070-Convert-Date",
        "thru": null,
        "line": 490
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 540
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 554
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "prog-name",
        "to": "l1-version",
        "line": 273
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 274
      },
      {
        "from": "\"Y\"",
        "to": "oi-3-flag",
        "line": 275
      },
      {
        "from": "2",
        "to": "S-Flag-P",
        "line": 276
      },
      {
        "from": "open-item-record-s",
        "to": "oi-header",
        "line": 337
      },
      {
        "from": "oi-customer",
        "to": "save-customer",
        "line": 348
      },
      {
        "from": "oi-b-nos",
        "to": "l6-b-nos",
        "line": 349
      },
      {
        "from": "\"/\"",
        "to": "l6-slash",
        "line": 350
      },
      {
        "from": "oi-b-item",
        "to": "l6-b-item",
        "line": 351
      },
      {
        "from": "\"J\"",
        "to": "l6-trans\n     else     move \"P\" to l6-trans",
        "line": 353
      },
      {
        "from": "oi-date",
        "to": "u-bin",
        "line": 358
      },
      {
        "from": "ws-date",
        "to": "l6-date",
        "line": 360
      },
      {
        "from": "oi-customer",
        "to": "l6-ac WS-Sales-Key",
        "line": 362
      },
      {
        "from": "space",
        "to": "name-found",
        "line": 366
      },
      {
        "from": "\"X\"",
        "to": "name-found",
        "line": 369
      },
      {
        "from": "sales-name",
        "to": "l6-name",
        "line": 374
      },
      {
        "from": "oi-paid",
        "to": "l6-value",
        "line": 385
      },
      {
        "from": "oi-approp",
        "to": "l6-approp sav-approp",
        "line": 387
      },
      {
        "from": "oi-deduct-amt",
        "to": "l6-dedn",
        "line": 388
      },
      {
        "from": "zero",
        "to": "l6-invoice  l6-i-approp l6-i-balance",
        "line": 389
      },
      {
        "from": "spaces",
        "to": "l6-i-date",
        "line": 390
      },
      {
        "from": "zero",
        "to": "l6-b-nos  l6-b-item l6-dedn\n                        l6-value  l6-approp",
        "line": 397
      },
      {
        "from": "spaces",
        "to": "l6-date   l6-ac     l6-name l6-trans",
        "line": 399
      },
      {
        "from": "oi-invoice",
        "to": "l6-invoice",
        "line": 412
      },
      {
        "from": "oi-date",
        "to": "u-bin",
        "line": 416
      },
      {
        "from": "ws-date",
        "to": "l6-i-date",
        "line": 418
      },
      {
        "from": "spaces",
        "to": "l6-slash",
        "line": 419
      },
      {
        "from": "sav-approp",
        "to": "l6-i-approp\n     else\n              move oi-paid  to  l6-i-approp\n     end-if\n     add      oi-net oi-extra oi-vat oi-discount oi-carriage\n              oi-e-vat  oi-c-vat  oi-deduct-amt  oi-deduct-vat giving  work-1",
        "line": 421
      },
      {
        "from": "cws-pay",
        "to": "l9-desc",
        "line": 443
      },
      {
        "from": "t-pay",
        "to": "l9-value",
        "line": 444
      },
      {
        "from": "cws-approp",
        "to": "l9-desc",
        "line": 447
      },
      {
        "from": "t-approp",
        "to": "l9-value",
        "line": 448
      },
      {
        "from": "cws-unapplied",
        "to": "l9-desc",
        "line": 451
      },
      {
        "from": "cws-deducts",
        "to": "l9-desc",
        "line": 455
      },
      {
        "from": "t-deducts",
        "to": "l9-value",
        "line": 456
      },
      {
        "from": "\"Journal\"",
        "to": "l7-tit",
        "line": 459
      },
      {
        "from": "cws-pay",
        "to": "l9-desc",
        "line": 462
      },
      {
        "from": "j-pay",
        "to": "l9-value",
        "line": 463
      },
      {
        "from": "cws-approp",
        "to": "l9-desc",
        "line": 466
      },
      {
        "from": "j-approp",
        "to": "l9-value",
        "line": 467
      },
      {
        "from": "cws-unapplied",
        "to": "l9-desc",
        "line": 470
      },
      {
        "from": "cws-deducts",
        "to": "l9-desc",
        "line": 474
      },
      {
        "from": "j-deducts",
        "to": "l9-value",
        "line": 475
      },
      {
        "from": "ws-date",
        "to": "l2-date",
        "line": 491
      },
      {
        "from": "page-nos",
        "to": "l1-page",
        "line": 493
      },
      {
        "from": "usera",
        "to": "l2-user",
        "line": 494
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-2 before 1\n     end-if\n     write    print-record  from  line-4 after 2",
        "line": 498
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 506
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 519
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 521
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 525
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 532
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 538
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 539
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 556
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 558
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 561
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 565
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 572
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 588
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 591
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 595
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 602
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n*> copy \"selsl.cob\".\n copy \"slselois.cob\".\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdsl.cob\".\n copy \"slfdois.cob\".\n copy \"fdprint.cob\".\n working-storage section.\n*>-----------------------\n 77  prog-name            pic x(15) value \"SL095 (3.02.09)\".\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n*>\n 01  ws-data.\n     03  work-1          pic 9(6)v99    comp-3 value zero.\n     03  save-customer   pic x(7)              value spaces.\n     03  sav-approp      pic s9(7)v99   comp-3 value zero.\n     03  line-cnt        pic 99         comp   value zero.\n*>\n*> copy \"wsoi.cob\".\n copy \"wssl.cob\".\n copy \"slwsoi3.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n*>     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n*> 01  Error-Messages.\n*> System Wide\n*>       NONE\n*> Module specific\n*>       NONE\n*>\n 01  print-lines.\n     03  line-1.\n         05  l1-version  pic x(48).\n         05  filler      pic x(76)       value \"Payment And Journal Proof Report\".\n         05  filler      pic x(5)        value \"Page \".\n         05  l1-page     pic zz9.\n*>\n     03  line-2.\n         05  l2-user     pic x(48)       value spaces.\n         05  filler      pic x(32)       value spaces.\n         05  filler      pic x(42)       value spaces.\n         05  l2-date     pic x(10).\n*>\n     03  line-4.\n         05  filler      pic x(61)       value \"  Batch  Tp  Pay Date  <-------------Customer------------->\".\n         05  filler      pic x(71)       value \"  Value    Approp.    Ded'n    <--------Payment Appropriation--------->\".\n*>\n     03  line-5.\n         05  filler      pic x(22)       value spaces.\n         05  filler      pic x(70)       value \" A/C               Name\".\n         05  filler      pic x(40)       value \"Invoice   Date      Approp.     Balance \".\n*>\n     03  line-6.\n         05  l6-b-nos    pic z(4)9       blank when zero.\n         05  l6-slash    pic x             value \"/\".\n         05  l6-b-item   pic 999b        blank when zero.\n         05  l6-trans    pic xx.\n         05  l6-date     pic x(11).\n         05  l6-ac       pic x(8).\n         05  l6-name     pic x(29).\n         05  l6-value    pic z(5)9.99bb  blank when zero.\n         05  l6-approp   pic z(5)9.99bb  blank when zero.\n         05  l6-dedn     pic z(3)9.99bb   blank when zero.\n         05  l6-invoice  pic z(7)9b     blank when zero.\n         05  l6-i-date   pic x(10).\n         05  l6-i-approp pic z(5)9.99    blank when zero.\n         05  l6-i-balance pic z(7)9.99cr  blank when zero.\n*>\n     03  line-7.\n         05  filler      pic x(30)       value spaces.\n         05  l7-tit      pic x(7)        value \"Payment\".\n         05  filler      pic x(7)        value \" Totals\".\n*>\n     03  line-8.\n         05  filler      pic x(30)       value spaces.\n         05  filler      pic x(14)       value \"**************\".\n*>\n     03  line-9.\n         05  filler      pic x(23)       value spaces.\n         05  l9-desc     pic x(17).\n         05  l9-value    pic z(6)9.99.\n*>\n 01  report-fields.\n     03  t-pay           pic s9(7)v99   comp-3 value zero.\n     03  t-approp        pic s9(7)v99   comp-3 value zero.\n     03  t-deducts       pic s9(7)v99   comp-3 value zero.\n     03  j-pay           pic s9(7)v99   comp-3 value zero.\n     03  j-approp        pic s9(7)v99   comp-3 value zero.\n     03  j-deducts       pic s9(7)v99   comp-3 value zero.\n     03  page-nos        pic 99          value zero.\n     03  name-found      pic x.\n     03  cws-pay         pic x(16)      value \"Payments\".\n     03  cws-approp      pic x(16)      value \"Appropriations\".\n     03  cws-unapplied   pic x(16)      value \"Unapplied Cash\".\n     03  cws-deducts     pic x(16)      value \"Deductions Taken\".\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n*>\n init01 section.\n     if       s-flag-p = zero\n              go to menu-exit.\n     move     prog-name to l1-version.\n     move     Print-Spool-Name to PSN.\n     move     \"Y\" to oi-3-flag.\n     move     2  to  S-Flag-P.\n*>\n     display  prog-name at 0101         with erase eos foreground-color 2.\n     display  \"Payment Proof Report\" at 0132 with foreground-color 2.\n     perform  zz070-Convert-Date.\n     display  ws-date at 0271 with foreground-color 2.\n     display  \"Printing..... Please Wait\" at 1201 with foreground-color 2.\n     perform  report1.\n*>\n menu-exit.\n     exit     program.\n*>\n*>***************************************\n*>               Procedures             *\n*>***************************************\n*>\n report1      section.\n*>===================\n*>\n     if       FS-Cobol-Files-Used\n              open     input  open-item-file-s\n              if       fs-reply not = zero\n                       close open-item-file-s\n                       go to main-exit\n              end-if\n     else\n              perform  OTM3-Open-Input\n              if       fs-reply not = zero\n                       perform OTM3-Close\n                       go to Main-Exit\n              end-if\n     end-if\n     perform  Sales-Open-Input.          *>  open input  sales-file.\n     open     output  print-file.\n     perform  headings.\n*>\n read-loop.\n*>********\n*>\n*> Here we have two choices\n*> 1: If using files (Cobol), so work via the sort file\n*>    to help select records",
        "line": 84
      },
      {
        "type": "IF",
        "condition": "NOT using files but RDB tables",
        "line": 318
      },
      {
        "type": "IF",
        "condition": "NOT FS-Cobol-Files-Used\n              perform OTM3-Read-Next-Sorted-By-Batch\n              if      fs-reply not = zero     *> = 10\n                      perform OTM3-Close\n                      go to Loop-End\n              end-if\n              go to Read-Loop-Tests\n     end-if\n*>\n     read     open-item-file-s record  at end\n              close  open-item-file-s\n              go to  loop-end.\n*>\n     move     open-item-record-s  to  oi-header.\n*>\n Read-Loop-Tests.\n     if       oi-type  = 2                     *> invoices\n              go to  process-invoice.\n     if       oi-type < 5 or > 6               *> = 5 or 6, payments or unapplied cash\n        or    not s-open\n              go to read-loop.\n*>\n*> Here process payment......wow.\n*>\n     move     oi-customer  to  save-customer.\n     move     oi-b-nos  to  l6-b-nos.\n     move     \"/\" to l6-slash.\n     move     oi-b-item to  l6-b-item.\n     if       oi-type = 6\n              move \"J\" to l6-trans\n     else     move \"P\" to l6-trans.\n*>\n*> Convert payment date\n*>\n     move     oi-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date   to  l6-date.\n*>\n     move     oi-customer  to  l6-ac WS-Sales-Key.\n*>\n*> Get customer name\n*>\n     move     space  to  name-found.\n     perform  Sales-Read-Indexed.           *>   read sales-file record invalid key\n     if       fs-reply = 21\n              move  \"X\"  to  name-found.\n*>\n     if       name-found = \"X\"\n              move  \"!! Customer Unknown\"  to  l6-name\n     else\n              move  sales-name  to  l6-name.\n*>\n     if       oi-type = 6\n              add oi-paid       to j-pay\n              add oi-approp     to j-approp\n              add oi-deduct-amt to j-deducts\n      else if oi-type = 5\n              add oi-paid       to t-pay\n              add oi-approp     to t-approp\n              add oi-deduct-amt to t-deducts.\n*>\n     move     oi-paid  to  l6-value.\n*>\n     move     oi-approp  to  l6-approp sav-approp.\n     move     oi-deduct-amt to l6-dedn.\n     move     zero  to  l6-invoice  l6-i-approp l6-i-balance.\n     move     spaces  to  l6-i-date.\n*>\n     if       line-cnt > Page-Lines\n              perform headings.\n     write    print-record  from  line-6 after 2  lines.\n     add      2 to line-cnt.\n*>\n     move     zero  to  l6-b-nos  l6-b-item l6-dedn\n                        l6-value  l6-approp.\n     move     spaces to l6-date   l6-ac     l6-name l6-trans.\n     go       to read-loop.\n*>\n process-invoice.\n*>**************\n*>\n     if       oi-paid = zero\n              go to  read-loop.\n     if       oi-customer  not equal  save-customer\n              go to  read-loop.\n*>\n*> Here process invoice......wow.\n*>\n     move     oi-invoice  to  l6-invoice.\n*>\n*> Convert invoice date\n*>\n     move     oi-date  to  u-bin.\n     perform  zz060-Convert-Date.\n     move     ws-date   to  l6-i-date.\n     move     spaces to l6-slash.\n     if       oi-paid > sav-approp\n              move sav-approp to l6-i-approp\n     else\n              move oi-paid  to  l6-i-approp\n     end-if\n     add      oi-net oi-extra oi-vat oi-discount oi-carriage\n              oi-e-vat  oi-c-vat  oi-deduct-amt  oi-deduct-vat giving  work-1.\n     subtract oi-paid  from  work-1  giving  l6-i-balance.\n*>\n     write    print-record  from  line-6 after 1.\n     add      1 to line-cnt.\n     if       line-cnt > Page-Lines\n              perform headings.\n     go       to read-loop.\n*>\n loop-end.\n*>*******\n*>\n     if       line-cnt > Page-Lines - 8\n              perform headings.\n     write    print-record  from  line-7 after 4.\n     write    print-record  from  line-8 after 1.\n*>\n     move     cws-pay to  l9-desc.\n     move     t-pay   to  l9-value.\n     write    print-record  from  line-9 after 3.\n*>\n     move     cws-approp to  l9-desc.\n     move     t-approp   to  l9-value.\n     write    print-record  from  line-9 after 1.\n*>\n     move     cws-unapplied to  l9-desc.\n     subtract t-approp  from  t-pay  giving  l9-value.\n     write    print-record  from  line-9 after 1.\n*>\n     move     cws-deducts to l9-desc.\n     move     t-deducts to l9-value.\n     write    print-record from line-9 after 2.\n*>\n     move     \"Journal\" to l7-tit.\n     write    print-record  from  line-7 after 2.\n     write    print-record  from  line-8 after 1.\n     move     cws-pay to  l9-desc.\n     move     j-pay   to  l9-value.\n     write    print-record  from  line-9 after 3.\n*>\n     move     cws-approp to  l9-desc.\n     move     j-approp   to  l9-value.\n     write    print-record  from  line-9 after 1.\n*>\n     move     cws-unapplied to  l9-desc.\n     subtract j-approp  from  j-pay  giving  l9-value.\n     write    print-record  from  line-9 after 1.\n*>\n     move     cws-deducts to l9-desc.\n     move     j-deducts to l9-value.\n     write    print-record from line-9 after 2.\n*>\n     close    print-file.       *> sales-file\n     perform  Sales-Close.\n     if       FS-Cobol-Files-Used             *> Make it a null file\n              open  output open-item-file-s\n              close open-item-file-s\n     end-if\n     call     \"SYSTEM\" using Print-Report.\n     go       to main-exit.\n*>\n headings.\n*>*******\n*>\n     perform  zz070-Convert-Date.\n     move     ws-date to l2-date.\n     add      1  to  page-nos.\n     move     page-nos  to  l1-page.\n     move     usera  to  l2-user.\n     if       page-nos not = 1\n              write print-record from line-1 after page\n              write print-record  from  line-2 after 1\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-2 before 1\n     end-if\n     write    print-record  from  line-4 after 2.\n     write    print-record  from  line-5 after 1.\n     move     6 to line-cnt.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n maps04       section.\n*>*******************\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps04-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 324
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 6,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 80,
      "totalOperators": 63,
      "totalOperands": 126,
      "vocabulary": 81,
      "length": 189,
      "volume": 1198.231650545194
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
