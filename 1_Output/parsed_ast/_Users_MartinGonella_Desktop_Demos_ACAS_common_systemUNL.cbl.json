{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/systemUNL.cbl",
  "fileName": "systemUNL.cbl",
  "timestamp": "2025-09-15T16:25:36.277Z",
  "programId": "SystemUNL",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 111
      },
      {
        "name": "file",
        "line": 125
      },
      {
        "name": "working-storage",
        "line": 142
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 114
      },
      {
        "name": "aa000-Main-Start",
        "line": 193
      },
      {
        "name": "end-string",
        "line": 303
      },
      {
        "name": "System-File",
        "line": 316
      },
      {
        "name": "goback",
        "line": 330
      },
      {
        "name": "Call-Sysout",
        "line": 334
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "ACAS-Sysout",
        "line": 335,
        "type": "DYNAMIC",
        "using": [
          "SO-Print"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 24,
        "replacing": null
      },
      {
        "name": "of",
        "line": 100,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 110,
        "replacing": null
      },
      {
        "name": "selsys",
        "line": 117,
        "replacing": null
      },
      {
        "name": "fdsys",
        "line": 128,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 130,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 169,
        "replacing": null
      },
      {
        "name": "wsdflt",
        "line": 171,
        "replacing": null
      },
      {
        "name": "wsfinal",
        "line": 172,
        "replacing": null
      },
      {
        "name": "wssys4",
        "line": 173,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 174,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 175,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 176,
        "replacing": null
      },
      {
        "name": "Proc-Get-Env-Set-Files",
        "line": 332,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz020-Get-Program-Args",
        "thru": null,
        "line": 194
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 272
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 278
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 304
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 326
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 328
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "0",
        "to": "WS-Log-System",
        "line": 195
      },
      {
        "from": "10",
        "to": "WS-Log-File-no",
        "line": 196
      },
      {
        "from": "zeros",
        "to": "ws-Rec-Cnt-Out ws-Rec-Cnt-In",
        "line": 200
      },
      {
        "from": "128",
        "to": "return-code\n              goback\n     end-if\n     initialise                    *> initialise all secondary records\n              Default-Record\n              Final-Record\n              System-Record-4 with filler",
        "line": 208
      },
      {
        "from": "2",
        "to": "rrn",
        "line": 215
      },
      {
        "from": "3",
        "to": "rrn",
        "line": 225
      },
      {
        "from": "4",
        "to": "rrn",
        "line": 235
      },
      {
        "from": "1",
        "to": "rrn",
        "line": 245
      },
      {
        "from": "128",
        "to": "return-code\n              goback\n     end-if\n     add      1 to ws-Rec-Cnt-In",
        "line": 252
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 266
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 274
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 281
      },
      {
        "from": "4",
        "to": "WS-Rec-Cnt-Out",
        "line": 313
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 317
      },
      {
        "from": "zero",
        "to": "Return-Code",
        "line": 329
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "the file exists but produces any errors because of\n*>                       a bad file** etc, it will attempt to read the RDB table\n*>                       instead, and a message to that effect will be issued.\n*>\n*>                       ** This can occur if a change of ISAM library is used\n*>                       where the new one is incompatable with the old one.\n*>\n*>                       ALL program output goes to file SYS-DISPLAY.log as an\n*>                       extended opened file. So after finishing reading,\n*>                       delete it.\n*>\n*>                       This program creates FOUR records in ORDER :\n*>                       Parameter\n*>                       Default\n*>                       Final\n*>                       Totals - SL & PL.\n*>\n*>                       ALL RECORDS USE 1024 BYTES AS PER THE SIZE OF THE PARAM RECORD.\n*>\n*>                       For use with ACAS v3.02 and later only.\n*>**\n*>   Version.            See prog-name in Ws.\n*>**\n*>   Called Modules.     ACAS-Sysout\n*>**\n*>   Error messages used.\n*>                       SY001A.\n*>                       SY001B.\n*>                       SY001C.\n*>                       SY001D.\n*>                       SY004.\n*>                       SY007.\n*>                       SY008.\n*>                       SY009.\n*>                       SY019.\n*>                       SY020\n*>**\n*>   Changes.\n*> 28/05/23 vbc - .00 systemUNL Source taken from systemLD and vers reset.\n*>                .01 Logic adjust if rdb details in file rec etc.\n*> 29/05/23 vbc - .02 Tidy up o/p to SYS-DISPLAY.log reporting DB status.\n*> 30/05/23 vbc - .03 Add rec counts in, created and total out to rep file.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 07/03/25 vbc   .04 Removed add 1 to ws-Rec-Cnt-R-Out near end - wrong.\n*>**\n*>\n*>*************************************************************************\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n*>\n environment division.\n*>-------------------\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n copy \"selsys.cob\".\n     select  System-File-Seq assign        \"system.seq\"\n                             organization  sequential\n                             status        FS-Reply.\n*>\n data division.\n*>------------\n*>\n file section.\n*>-----------\n*>\n copy \"fdsys.cob\".\n fd   system-file-seq.\n copy \"wssystem.cob\"  replacing System-Record by System-Record-Seq\n                               File-System-Used by WS-File-System-Used\n                               File-Duplicates-In-Use by WS-File-Duplicates-In-Use\n                               FS-Cobol-Files-Used by WS-FS-Cobol-Files-Used\n                               FS-Duplicate-Processing by WS-FS-Duplicate-Processing\n                               RDBMS-DB-Name by WS-RDBMS-DB-Name\n                               RDBMS-User    by WS-RDBMS-User\n                               RDBMS-Passwd  by WS-RDBMS-Passwd\n                               RDBMS-Port    by WS-RDBMS-Port\n                               RDBMS-Host    by WS-RDBMS-Host\n                               RDBMS-Socket  by WS-RDBMS-Socket.\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(20)    value \"SystemUNL (3.02.04)\".\n 77  z                   binary-char  value zero.\n 77  OS-Delimiter        pic x        value \"/\".\n 77  ACAS_BIN            pic x(512)   value spaces.\n 77  ACAS_LEDGERS        pic x(500)   value spaces.\n 77  Arg-Number          pic 9        value zero.\n*>\n*> holds program parameter values from command line\n 01  Arg-Vals                         value spaces.\n     03  Arg-Value       pic x(525)  occurs 2.\n 01  Arg-Test            pic x(525)   value spaces.\n*>\n 01  work-fields.\n     03  ws-Rec-Cnt-In   pic 999       value zero.\n     03  ws-Rec-Cnt-Out  pic 999       value zero.\n     03  ws-Rec-Cnt-R-Out pic 999      value zero.\n     03  ws-reply        pic x.\n     03  WS-Temp-Text    pic x(40)    value spaces.\n     03  WS-Dflt-Flag    pic 9        value 1.       *> record read\n     03  WS-Final-Flag   pic 9        value 1.       *> ditto\n     03  WS-Sys4-Flag    pic 9        value 1.       *> ditto\n     03  WS-Rec-Length-1 pic 9(5)     value zero.\n*>\n 01  SO-Print            pic x(160)    value spaces.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n copy \"wsdflt.cob\".   *> rec 2 - defaults\n copy \"wsfinal.cob\".  *> rec 3 - Final accounts\n copy \"wssys4.cob\".   *> rec 4 - totals for sales and purchase\n copy \"wsfnctn.cob\".\n copy \"wsnames.cob\".\n copy \"wscall.cob\".\n*>\n 01  Error-Messages.\n     03  SY001A         pic x(27) value \"SY001A System 1 read err = \".\n     03  SY001B         pic x(27) value \"SY001B System 2 read err = \".\n     03  SY001C         pic x(27) value \"SY001C System 3 read err = \".\n     03  SY001D         pic x(27) value \"SY001D System 4 read err = \".\n     03  SY004          pic x(38) value \"SY004 Problem with opening system file\".\n     03  SY007          pic x(35) value \"SY007 Program arguments incorrect: \".\n     03  SY008          pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY009          pic x(53) value \"SY009 Environment variables not yet set up : ABORTING\".\n     03  SY019          pic x(37) value \"SY019 DB is NOT set up in Param file.\".\n     03  SY020          pic x(34) value \"SY020 DB IS set up in Param file :\".\n*>\n procedure division.\n*>=================\n*>\n aa000-Main-Start.\n     perform  zz020-Get-Program-Args.\n     move     0      to WS-Log-System.   *> 1 = IRS, 2=GL, 3=SL, 4=PL, 5=Stock used in FH logging, 6=SL & PL\n     move     10     to WS-Log-File-no.  *> for FHlogger\n*>\n*>  Get the system param for the various RDB fields\n*>\n     move     zeros to ws-Rec-Cnt-Out ws-Rec-Cnt-In.\n *>    display  Prog-Name at 0101 with erase eos.\n     open     input System-File.\n     if       fs-reply not = zero\n              display SY001A    at 0401\n              display fs-reply  at 0428\n              display SY004     at 0501\n              close System-File\n              move 128 to return-code\n              goback\n     end-if\n     initialise                    *> initialise all secondary records\n              Default-Record\n              Final-Record\n              System-Record-4 with filler.\n     move     2 to rrn.\n     read     System-File record into Default-Record.\n     if       fs-reply not = zero\n              display SY001B          at 0501\n              display fs-reply        at 0528\n              display \"Not set up ?\"  at 0531\n              add     1 to ws-Rec-Cnt-R-Out\n     else\n              add     1 to ws-Rec-Cnt-In\n     end-if\n     move     3 to rrn.\n     read     System-File record into Final-Record.\n     if       fs-reply not = zero\n              display SY001C          at 0601\n              display fs-reply        at 0628\n              display \"Not set up ?\"  at 0631\n              add     1 to ws-Rec-Cnt-R-Out\n     else\n              add     1 to ws-Rec-Cnt-In\n     end-if\n     move     4 to rrn.\n     read     System-File record into System-Record-4.\n     if       fs-reply not = zero\n              display SY001D         at 0701\n              display fs-reply       at 0728\n              display \"Not set up ?\" at 0731\n              add     1 to ws-Rec-Cnt-R-Out\n     else\n              add     1 to ws-Rec-Cnt-In\n     end-if\n     move     1 to rrn.\n     read     system-file record.\n     if       fs-reply not = zero\n              display SY001A          at 0801\n              display fs-reply        at 0828\n              display \"Not set up ?\"  at 0831\n              close System-File\n              move 128 to return-code\n              goback\n     end-if\n     add      1 to ws-Rec-Cnt-In.\n*>\n*> For the system record we will ony write it out to .seq if present\n*>  as well have no way to find the RDBMS details without it.\n*>\n*> but leave this lot in as it wil be used for other file types.\n*>\n*>  Load up the DB settings from the system record as its not passed on.\n*>\n*> TEMP CODE\n *>    move     FUNCTION LENGTH (System-Record)    to WS-Rec-Length-1.\n *>    move    spaces to SO-Print.\n *>    string\n *>             Prog-Name\n *>             \" System rec size = \"\n *>             WS-Rec-Length-1\n *>                 into SO-Print.\n *>    perform  Call-Sysout.\n*>\n     move     spaces to SO-Print.\n     if       FS-Cobol-Files-Used\n              string   Prog-Name \" \"\n                       \"Cobol files in use \" into SO-Print\n              perform Call-Sysout\n     end-if\n*>\n     move     spaces to SO-Print.\n     if       RDBMS-DB-Name = spaces\n              string   Prog-Name\n                       \" \"\n                       SY019\n                           into SO-Print\n              end-string\n     else\n              string   Prog-Name\n                       \" \"\n                       SY020\n                       \" \"\n                      \"DBName = \" FUNCTION TRIM (RDBMS-DB-Name, TRAILING)\n                      \",\"\n                      \"User = \"   FUNCTION TRIM (RDBMS-User, TRAILING)\n                      \",\"\n                      \"Port = \"   FUNCTION TRIM (RDBMS-Port, TRAILING)\n                      \",\"\n                      \"Host = \"   FUNCTION TRIM (RDBMS-Host, TRAILING)\n                      \",\"\n                      \"Socket = \" FUNCTION TRIM (RDBMS-Socket, TRAILING)\n                         into So-Print\n              end-string.\n     perform  Call-Sysout.\n*>\n*> BYPASS ALL THE STANDARD CODING AS JUST WRITE THE REC OUT\n*>\n     open     output system-file-seq.\n     write    System-Record-Seq from System-Record.   *> rec 1\n     write    System-Record-Seq from Default-Record.  *> rec 2\n     write    System-Record-Seq from Final-Record.    *> rec 3\n     write    System-Record-Seq from System-Record-4. *> rec 4\n     move     4 to WS-Rec-Cnt-Out.\n*>     add      1 to ws-Rec-Cnt-R-Out.\n     close    System-File-Seq\n              System-File.\n     move     spaces to SO-Print.\n     string\n              \"Records in = \"\n              ws-Rec-Cnt-In\n              \" Records Newly Created = \"\n              ws-Rec-Cnt-R-Out\n              \" Records Total out = \"\n              WS-Rec-Cnt-Out\n                     into SO-Print.\n     perform  Call-Sysout.\n     move     \"CLOSE \" to SO-Print.\n     perform  Call-Sysout.\n     move     zero to Return-Code.\n     goback.\n*>\n copy \"Proc-Get-Env-Set-Files.cob\".  *> Only uses ACAS_LEDGERS now\n*>\n Call-Sysout.\n     call     \"ACAS-Sysout\" using SO-Print.\n*>",
        "line": 27
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 19,
      "totalOperators": 15,
      "totalOperands": 30,
      "vocabulary": 20,
      "length": 45,
      "volume": 194.4867642699313
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
