{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/irsnominalMT.cbl",
  "fileName": "irsnominalMT.cbl",
  "timestamp": "2025-09-15T16:25:33.544Z",
  "programId": "irsnominalMT",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 115
      },
      {
        "name": "Working-Storage",
        "line": 117
      },
      {
        "name": "Linkage",
        "line": 211
      },
      {
        "name": "screen",
        "line": 248
      },
      {
        "name": "ba-ACAS-DAL-Process",
        "line": 270
      },
      {
        "name": "bb000-HV-Load",
        "line": 1188
      },
      {
        "name": "exit",
        "line": 1221
      },
      {
        "name": "bb100-UnloadHVs",
        "line": 1223
      },
      {
        "name": "exit",
        "line": 1254
      },
      {
        "name": "bb200-Insert",
        "line": 1256
      },
      {
        "name": "exit",
        "line": 1498
      },
      {
        "name": "bb300-Update",
        "line": 1500
      },
      {
        "name": "exit",
        "line": 1746
      }
    ],
    "paragraphs": [
      {
        "name": "ba010-Initialise",
        "line": 281
      },
      {
        "name": "SQL-Err",
        "line": 291
      },
      {
        "name": "end-evaluate",
        "line": 327
      },
      {
        "name": "ba020-Process-Open",
        "line": 329
      },
      {
        "name": "end-string",
        "line": 337
      },
      {
        "name": "end-string",
        "line": 341
      },
      {
        "name": "end-string",
        "line": 345
      },
      {
        "name": "end-string",
        "line": 349
      },
      {
        "name": "end-string",
        "line": 353
      },
      {
        "name": "end-string",
        "line": 357
      },
      {
        "name": "ba030-Process-Close",
        "line": 373
      },
      {
        "name": "ba040-Process-Read-Next",
        "line": 388
      },
      {
        "name": "ba041-Reread",
        "line": 468
      },
      {
        "name": "end-if",
        "line": 528
      },
      {
        "name": "end-if",
        "line": 535
      },
      {
        "name": "ba050-Process-Read-Indexed",
        "line": 548
      },
      {
        "name": "end-if",
        "line": 571
      },
      {
        "name": "end-if",
        "line": 593
      },
      {
        "name": "ba060-Process-Start",
        "line": 664
      },
      {
        "name": "ba070-Process-Write",
        "line": 782
      },
      {
        "name": "end-if",
        "line": 812
      },
      {
        "name": "ba072-Proc-Write-Subs",
        "line": 814
      },
      {
        "name": "ba073-Fix-Up-Subs",
        "line": 853
      },
      {
        "name": "end-if",
        "line": 864
      },
      {
        "name": "end-if",
        "line": 921
      },
      {
        "name": "end-if",
        "line": 982
      },
      {
        "name": "end-if",
        "line": 1063
      },
      {
        "name": "ba090-Process-Rewrite",
        "line": 1067
      },
      {
        "name": "ba092-Finish-1",
        "line": 1115
      },
      {
        "name": "ba093-Finish-2",
        "line": 1116
      },
      {
        "name": "ba170-Process-Write-Raw",
        "line": 1119
      },
      {
        "name": "end-if",
        "line": 1146
      },
      {
        "name": "ba100-Bad-Function",
        "line": 1153
      },
      {
        "name": "ba998-Free",
        "line": 1165
      },
      {
        "name": "ba999-end",
        "line": 1178
      },
      {
        "name": "end-if",
        "line": 1183
      },
      {
        "name": "ba999-exit",
        "line": 1185
      },
      {
        "name": "end-if",
        "line": 1215
      },
      {
        "name": "bb000-Exit",
        "line": 1220
      },
      {
        "name": "end-if",
        "line": 1251
      },
      {
        "name": "bb100-Exit",
        "line": 1253
      },
      {
        "name": "bb200-Exit",
        "line": 1497
      },
      {
        "name": "bb300-Exit",
        "line": 1745
      },
      {
        "name": "Ca-Process-Logs",
        "line": 1748
      },
      {
        "name": "ACAS-DAL-Common-data",
        "line": 1752
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "MySQL_errno",
        "line": 444,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "call",
          "\"MySQL_error\"",
          "using",
          "WS-MYSQL-Error-Message",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "end-if",
          "move",
          "10",
          "to",
          "fs-reply",
          "*>",
          "move",
          "10",
          "to",
          "WE-Error",
          "move",
          "3",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "move",
          "\"No",
          "Data\"",
          "to",
          "WS-File-Key",
          "go",
          "to",
          "ba999-End",
          "*>",
          "can",
          "clear",
          "the",
          "dup",
          "code",
          "after",
          "testing",
          "end-if",
          "set",
          "Cursor-Active",
          "to",
          "true",
          "move",
          "WS-MYSQL-Count-Rows",
          "to",
          "WS-Temp-Ed",
          "string",
          "\">",
          "0",
          "got",
          "cnt=\"",
          "delimited",
          "by",
          "size",
          "WS-Temp-ED",
          "delimited",
          "by",
          "size",
          "\"",
          "recs\"",
          "into",
          "WS-File-Key",
          "end-string",
          "perform",
          "ba999-End",
          "*>",
          "log",
          "it",
          "end-if"
        ]
      },
      {
        "target": "MySQL_fetch_record",
        "line": 483,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-RESULT",
          "HV-KEY-1",
          "HV-TIPE",
          "HV-NL-NAME",
          "HV-DR",
          "HV-CR",
          "HV-DR-LAST-01",
          "HV-CR-LAST-01",
          "HV-DR-LAST-02",
          "HV-CR-LAST-02",
          "HV-DR-LAST-03",
          "HV-CR-LAST-03",
          "HV-DR-LAST-04",
          "HV-CR-LAST-04",
          "HV-AC",
          "HV-REC-POINTER",
          "*>",
          "/MYSQL-END\\",
          "end-call",
          "*>",
          "if",
          "return-code",
          "=",
          "-1",
          "*>",
          "no",
          "more",
          "data",
          "so",
          "free",
          "cursor",
          "&",
          "return",
          "move",
          "10",
          "to",
          "fs-Reply",
          "*>",
          "WE-Error",
          "move",
          "3",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "move",
          "\"EOF\"",
          "to",
          "WS-File-Key",
          "*>",
          "move",
          "zero",
          "to",
          "Most-Cursor-Set",
          "set",
          "Cursor-Not-Active",
          "to",
          "true",
          "go",
          "to",
          "ba999-End",
          "end-if",
          "*>",
          "if",
          "WS-MYSQL-Count-Rows",
          "=",
          "zero",
          "call",
          "\"MySQL_errno\"",
          "using",
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "WS-MYSQL-Error-Message",
          "move",
          "10",
          "to",
          "fs-reply",
          "*>",
          "EOF",
          "equivilent",
          "!!",
          "*>",
          "move",
          "10",
          "to",
          "WE-Error",
          "move",
          "3",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "initialize",
          "WS-IRSNL-Record",
          "with",
          "filler",
          "move",
          "\"EOF2\"",
          "to",
          "WS-File-Key",
          "end-if",
          "set",
          "Cursor-Not-Active",
          "to",
          "true",
          "go",
          "to",
          "ba999-End",
          "end-if"
        ]
      },
      {
        "target": "MySQL_fetch_record",
        "line": 601,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-RESULT",
          "HV-KEY-1",
          "HV-TIPE",
          "HV-NL-NAME",
          "HV-DR",
          "HV-CR",
          "HV-DR-LAST-01",
          "HV-CR-LAST-01",
          "HV-DR-LAST-02",
          "HV-CR-LAST-02",
          "HV-DR-LAST-03",
          "HV-CR-LAST-03",
          "HV-DR-LAST-04",
          "HV-CR-LAST-04",
          "HV-AC",
          "HV-REC-POINTER",
          "*>",
          "/MYSQL-END\\",
          "end-call",
          "*>",
          "if",
          "WS-MYSQL-Count-Rows",
          "not",
          ">",
          "zero",
          "call",
          "\"MySQL_errno\"",
          "using",
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "move",
          "21",
          "to",
          "fs-reply",
          "*>",
          "from",
          "23",
          "*>",
          "move",
          "990",
          "to",
          "WE-Error",
          "move",
          "2",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "call",
          "\"MySQL_error\"",
          "using",
          "WS-MYSQL-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "spaces",
          "to",
          "WS-File-Key",
          "move",
          "\"Not",
          "found",
          "1\"",
          "to",
          "NL-Name",
          "go",
          "to",
          "ba998-Free",
          "else",
          "move",
          "21",
          "to",
          "fs-reply",
          "*>",
          "from",
          "23",
          "*>",
          "move",
          "989",
          "to",
          "WE-Error",
          "move",
          "2",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "move",
          "zero",
          "to",
          "SQL-Err",
          "move",
          "\"Not",
          "found",
          "2\"",
          "to",
          "NL-Name",
          "move",
          "spaces",
          "to",
          "SQL-Msg",
          "move",
          "spaces",
          "to",
          "WS-File-Key",
          "*>",
          "next",
          "2",
          "is",
          "not",
          "really",
          "needed",
          "go",
          "to",
          "ba998-Free",
          "end-if",
          "end-if",
          "*>",
          "row",
          "count",
          "zero",
          "should",
          "show",
          "up",
          "as",
          "a",
          "MYSQL",
          "error",
          "?",
          "perform",
          "bb100-UnloadHVs",
          "*>",
          "transfer/move",
          "HV",
          "vars",
          "to",
          "ws-Record",
          "layout",
          "move",
          "HV-KEY-1",
          "to",
          "ws-temp-ed"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 750,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "WS-MYSQL-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "21",
          "to",
          "fs-reply",
          "*>",
          "this",
          "may",
          "need",
          "changing",
          "for",
          "val",
          "in",
          "WE-Error!!",
          "move",
          "2",
          "to",
          "WE-Error",
          "*>",
          "as",
          "in",
          "irsub1",
          "go",
          "to",
          "ba999-End",
          "end-if",
          "else",
          "move",
          "zero",
          "to",
          "FS-Reply",
          "WE-Error",
          "*>",
          "next",
          "2",
          "for",
          "testing",
          "move",
          "WS-MYSQL-Count-Rows",
          "to",
          "WS-Temp-Ed",
          "string",
          "MOST-relation",
          "WS-IRSNL-RECord",
          "(K:L)",
          "\"",
          "got",
          "=\"",
          "delimited",
          "by",
          "size",
          "WS-Temp-ED",
          "delimited",
          "by",
          "size",
          "\"",
          "recs\"",
          "into",
          "WS-File-Key",
          "end-string",
          "end-if",
          "perform",
          "ba999-end"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 794,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "if",
          "SQL-Err",
          "(1:4)",
          "=",
          "\"1062\"",
          "or",
          "=",
          "\"1022\"",
          "or",
          "Sql-State",
          "=",
          "\"23000\"",
          "*>",
          "Dup",
          "key",
          "(rec",
          "already",
          "present)",
          "move",
          "22",
          "to",
          "fs-reply",
          "else",
          "move",
          "99",
          "to",
          "fs-reply",
          "*>",
          "this",
          "may",
          "need",
          "changing",
          "for",
          "val",
          "in",
          "WE-Error!!",
          "end-if",
          "end-if",
          "end-if",
          "if",
          "Testing-1",
          "perform",
          "Ca-Process-Logs",
          "end-if"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 907,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "99",
          "to",
          "fs-reply",
          "move",
          "995",
          "to",
          "WE-Error",
          "end-if",
          "go",
          "to",
          "ba999-End",
          "*>",
          "produce",
          "log",
          "else",
          "move",
          "spaces",
          "to",
          "SQL-Msg",
          "SQL-State",
          "move",
          "zero",
          "to",
          "SQL-Err",
          "end-if"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 968,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "99",
          "to",
          "fs-reply",
          "move",
          "995",
          "to",
          "WE-Error",
          "end-if",
          "go",
          "to",
          "ba999-End",
          "else",
          "move",
          "spaces",
          "to",
          "SQL-Msg",
          "SQL-State",
          "move",
          "zero",
          "to",
          "SQL-Err",
          "end-if"
        ]
      },
      {
        "target": "MySQL_query",
        "line": 1003,
        "type": "DYNAMIC",
        "using": [
          "SQLCA-STATEMENT",
          "*>",
          "END-CALL",
          "*>",
          "*>",
          "So",
          "if",
          "this",
          "does",
          "not",
          "work",
          "it",
          "will",
          "be",
          "changed"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 1049,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "99",
          "to",
          "fs-reply",
          "move",
          "995",
          "to",
          "WE-Error",
          "end-if",
          "go",
          "to",
          "ba999-End",
          "else",
          "*>",
          "of",
          "course",
          "there",
          "could",
          "be",
          "no",
          "data",
          "in",
          "table",
          "move",
          "spaces",
          "to",
          "SQL-Msg",
          "move",
          "zero",
          "to",
          "SQL-Err",
          "end-if"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 1094,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "move",
          "99",
          "to",
          "fs-reply",
          "*>",
          "this",
          "may",
          "need",
          "changing",
          "for",
          "val",
          "in",
          "WE-Error!!",
          "move",
          "994",
          "to",
          "WE-Error",
          "end-if",
          "*>",
          "if",
          "Testing-1",
          "perform",
          "Ca-Process-Logs",
          "end-if",
          "go",
          "to",
          "ba092-Finish-1",
          "*>",
          "ba999-exit",
          "[",
          "error",
          "]",
          "end-if",
          "move",
          "zero",
          "to",
          "FS-Reply",
          "WE-Error"
        ]
      },
      {
        "target": "MySQL_errno",
        "line": 1128,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-Error-Number",
          "call",
          "\"MySQL_sqlstate\"",
          "using",
          "WS-MYSQL-SQLstate",
          "move",
          "WS-MYSQL-SqlState",
          "to",
          "SQL-State",
          "if",
          "WS-MYSQL-Error-Number",
          "not",
          "=",
          "\"0",
          "\"",
          "call",
          "\"MySQL_error\"",
          "using",
          "Ws-Mysql-Error-Message",
          "move",
          "WS-MYSQL-Error-Number",
          "to",
          "SQL-Err",
          "move",
          "WS-MYSQL-Error-Message",
          "to",
          "SQL-Msg",
          "if",
          "SQL-Err",
          "(1:4)",
          "=",
          "\"1062\"",
          "or",
          "=",
          "\"1022\"",
          "or",
          "Sql-State",
          "=",
          "\"23000\"",
          "*>",
          "Dup",
          "key",
          "(rec",
          "already",
          "present)",
          "move",
          "22",
          "to",
          "fs-reply",
          "else",
          "move",
          "99",
          "to",
          "fs-reply",
          "*>",
          "this",
          "may",
          "need",
          "changing",
          "for",
          "val",
          "in",
          "WE-Error!!",
          "end-if",
          "end-if",
          "end-if",
          "if",
          "Testing-1",
          "perform",
          "Ca-Process-Logs",
          "end-if"
        ]
      },
      {
        "target": "MySQL_free_result",
        "line": 1173,
        "type": "DYNAMIC",
        "using": [
          "WS-MYSQL-RESULT",
          "end-call",
          "*>",
          "/MYSQL-END\\",
          "*>",
          "move",
          "zero",
          "to",
          "Most-Cursor-Set"
        ]
      },
      {
        "target": "fhlogger",
        "line": 1751,
        "type": "DYNAMIC",
        "using": [
          "File-Access",
          "ACAS-DAL-Common-data"
        ]
      }
    ],
    "copies": [
      {
        "name": "ACAS-SQLstate-error-list",
        "line": 78,
        "replacing": null
      },
      {
        "name": "of",
        "line": 106,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 113,
        "replacing": null
      },
      {
        "name": "mysql-variables",
        "line": 188,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 215,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 219,
        "replacing": null
      },
      {
        "name": "mysql-procedures",
        "line": 1162,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "MYSQL-1000-OPEN",
        "thru": "MYSQL-1090-EXIT",
        "line": 332
      },
      {
        "target": "MYSQL-1000-OPEN",
        "thru": "MYSQL-1090-EXIT",
        "line": 359
      },
      {
        "target": "ba998-Free",
        "thru": null,
        "line": 375
      },
      {
        "target": "MYSQL-1980-CLOSE",
        "thru": "MYSQL-1999-EXIT",
        "line": 383
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 432
      },
      {
        "target": "MYSQL-1220-STORE-RESULT",
        "thru": "MYSQL-1239-EXIT",
        "line": 433
      },
      {
        "target": "ba999-End",
        "thru": null,
        "line": 465
      },
      {
        "target": "bb100-UnloadHVs",
        "thru": null,
        "line": 536
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 584
      },
      {
        "target": "MYSQL-1220-STORE-RESULT",
        "thru": "MYSQL-1239-EXIT",
        "line": 585
      },
      {
        "target": "bb100-UnloadHVs",
        "thru": null,
        "line": 646
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 654
      },
      {
        "target": "ba998-Free",
        "thru": null,
        "line": 680
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 739
      },
      {
        "target": "MYSQL-1220-STORE-RESULT",
        "thru": "MYSQL-1239-EXIT",
        "line": 740
      },
      {
        "target": "ba999-end",
        "thru": null,
        "line": 772
      },
      {
        "target": "bb000-HV-Load",
        "thru": null,
        "line": 786
      },
      {
        "target": "bb200-Insert",
        "thru": null,
        "line": 792
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 811
      },
      {
        "target": "ba090-Process-Rewrite",
        "thru": "ba092-Finish-1",
        "line": 830
      },
      {
        "target": "ba090-Process-Rewrite",
        "thru": "ba092-Finish-1",
        "line": 838
      },
      {
        "target": "ba070-Process-Write",
        "thru": null,
        "line": 855
      },
      {
        "target": "ba090-Process-Rewrite",
        "thru": "ba092-Finish-1",
        "line": 863
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 904
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 924
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 965
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 1046
      },
      {
        "target": "bb000-HV-Load",
        "thru": null,
        "line": 1069
      },
      {
        "target": "bb300-Update",
        "thru": null,
        "line": 1087
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 1106
      },
      {
        "target": "bb000-HV-Load",
        "thru": null,
        "line": 1120
      },
      {
        "target": "bb200-Insert",
        "thru": null,
        "line": 1126
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 1145
      },
      {
        "target": "ba090-Process-Rewrite",
        "thru": "ba092-Finish-1",
        "line": 1149
      },
      {
        "target": "Ca-Process-Logs",
        "thru": null,
        "line": 1182
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 1493
      },
      {
        "target": "MYSQL-1210-COMMAND",
        "thru": "MYSQL-1219-EXIT",
        "line": 1741
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines to ws-lines\n     end-if\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\"",
        "line": 273
      },
      {
        "from": "zero",
        "to": "We-Error                        *> as in irsub1\n                        Fs-Reply",
        "line": 283
      },
      {
        "from": "spaces",
        "to": "WS-MYSQL-Error-Message\n                        WS-MYSQL-Error-Number\n                        WS-Log-Where\n                        WS-File-Key\n                        SQL-Msg\n                        SQL-Err",
        "line": 286
      },
      {
        "from": "1",
        "to": "ws-No-Paragraph",
        "line": 358
      },
      {
        "from": "zero",
        "to": "Most-Cursor-Set\n     go      to ba999-end",
        "line": 370
      },
      {
        "from": "2",
        "to": "ws-No-Paragraph",
        "line": 377
      },
      {
        "from": "spaces",
        "to": "WS-Where\n              move     1   to J\n              string\n                       \"`TIPE`='O' AND \"     delimited by size\n                       \"`\"                   delimited by size\n                       KeyName (KOR-x1)      delimited by space\n                       \"`\"                   delimited by size\n                       \" > \"                 delimited by size   *> 26/12/16 NOT '='\n                       '\"0000000000\"'          delimited by size\n                       ' ORDER BY '          delimited by size\n                       \"`\"                   delimited by size\n                       keyname (KOR-x1)      delimited by space\n                       \"`\"                   delimited by size\n                         ' ASC '             delimited by size\n                                      into ws-Where\n                                      with pointer J\n              end-string\n*>\n              move     ws-Where (1:J)   to WS-Log-Where       *>  For test logging\n              move     3 to ws-No-Paragraph\n*>               /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>                    TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             ws-Where (1:J)      *> KEY-1 > \"0000000000\" ORDER BY IRSNL-REC ASC\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>               /MYSQL-END\\\n           move    \"> 0000000000\" to WS-File-Key\n              if    Testing-2\n                    display Display-Message-1 with erase eos\n              end-if\n*>\n*>  It could be an empty table so test for it\n*>\n              if       WS-MYSQL-Count-Rows = zero\n                       call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n                       call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n                       move  WS-MYSQL-SqlState   to SQL-State\n                       if    WS-MYSQL-Error-Number  not = \"0  \"\n                             move WS-MYSQL-Error-Number  to SQL-Err\n                             call \"MySQL_error\" using WS-MYSQL-Error-Message\n                             move WS-MYSQL-Error-Message to SQL-Msg\n                       end-if\n                       move 10 to fs-reply\n   *>                    move 10 to WE-Error\n                     move 3 to WE-Error                 *> as in irsub1\n                       move    \"No Data\" to WS-File-Key\n                       go to ba999-End       *> can clear the dup code after testing\n              end-if\n              set Cursor-Active to true\n              move     WS-MYSQL-Count-Rows to WS-Temp-Ed\n              string   \"> 0 got cnt=\" delimited by size\n                       WS-Temp-ED delimited by size\n                       \" recs\"\n                        into WS-File-Key\n              end-string\n              perform ba999-End                         *> log it\n     end-if",
        "line": 401
      },
      {
        "from": "spaces",
        "to": "WS-Log-Where",
        "line": 472
      },
      {
        "from": "4",
        "to": "ws-No-Paragraph",
        "line": 473
      },
      {
        "from": "zero",
        "to": "return-code",
        "line": 475
      },
      {
        "from": "TP-IRSNL-REC",
        "to": "WS-MYSQL-RESULT\n           CALL \"MySQL_fetch_record\" USING WS-MYSQL-RESULT\n                    HV-KEY-1\n                    HV-TIPE\n                    HV-NL-NAME\n                    HV-DR\n                    HV-CR\n                    HV-DR-LAST-01\n                    HV-CR-LAST-01\n                    HV-DR-LAST-02\n                    HV-CR-LAST-02\n                    HV-DR-LAST-03\n                    HV-CR-LAST-03\n                    HV-DR-LAST-04\n                    HV-CR-LAST-04\n                    HV-AC\n                    HV-REC-POINTER\n\n*>      /MYSQL-END\\\n     end-call\n*>\n     if       return-code = -1                  *> no more data so free cursor & return\n              move 10 to fs-Reply           *> WE-Error\n            move 3 to WE-Error                              *> as in irsub1\n              move    \"EOF\" to WS-File-Key\n *>             move     zero to Most-Cursor-Set\n              set Cursor-Not-Active to true\n              go to ba999-End\n     end-if\n*>\n     if       WS-MYSQL-Count-Rows = zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move 10 to fs-reply                     *> EOF equivilent !!\n       *>             move 10 to WE-Error\n                   move 3 to WE-Error                       *> as in irsub1\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    initialize WS-IRSNL-Record with filler\n                    move    \"EOF2\" to WS-File-Key\n              end-if\n              set Cursor-Not-Active to true\n              go to ba999-End\n     end-if",
        "line": 482
      },
      {
        "from": "zero",
        "to": "Most-Cursor-Set\n              set Cursor-Not-Active to true\n              move    \"EOF3\" to WS-File-Key\n              go to ba999-End\n     end-if",
        "line": 531
      },
      {
        "from": "HV-KEY-1",
        "to": "ws-temp-ed",
        "line": 543
      },
      {
        "from": "ws-temp-ed",
        "to": "WS-File-Key",
        "line": 544
      },
      {
        "from": "zero",
        "to": "fs-reply WE-Error",
        "line": 545
      },
      {
        "from": "spaces",
        "to": "WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-Record (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-Where (1:J)   to WS-Log-Where",
        "line": 557
      },
      {
        "from": "5",
        "to": "ws-No-Paragraph\n*>      /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>      /MYSQL-END\\\n*>\n     if     WS-MYSQL-Count-Rows = zero\n            move 21  to fs-Reply             *> could also be 23 or 14\n            move 2 to WE-Error               *> as in irsub1\n            go to ba998-Free\n     end-if",
        "line": 572
      },
      {
        "from": "6",
        "to": "ws-No-Paragraph\n*>      /MYSQL FETCH\\\n*>\n*>    Fetch next record\n*>\n*>             TABLE=IRSNL-REC\n           MOVE TP-IRSNL-REC TO WS-MYSQL-RESULT\n           CALL \"MySQL_fetch_record\" USING WS-MYSQL-RESULT\n                    HV-KEY-1\n                    HV-TIPE\n                    HV-NL-NAME\n                    HV-DR\n                    HV-CR\n                    HV-DR-LAST-01\n                    HV-CR-LAST-01\n                    HV-DR-LAST-02\n                    HV-CR-LAST-02\n                    HV-DR-LAST-03\n                    HV-CR-LAST-03\n                    HV-DR-LAST-04\n                    HV-CR-LAST-04\n                    HV-AC\n                    HV-REC-POINTER\n\n*>      /MYSQL-END\\\n     end-call\n*>\n     if       WS-MYSQL-Count-Rows not > zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    move 21 to fs-reply    *> from 23\n *>                   move 990 to WE-Error\n                    move 2 to WE-Error                 *> as in irsub1\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move WS-MYSQL-Error-Number to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move spaces to WS-File-Key\n                    move \"Not found 1\" to NL-Name\n                    go to ba998-Free\n              else\n                    move 21   to fs-reply    *> from 23\n *>                   move 989  to WE-Error\n                    move 2 to WE-Error                 *> as in irsub1\n                    move zero to SQL-Err\n                   move \"Not found 2\" to NL-Name\n                    move spaces to SQL-Msg\n                    move spaces to WS-File-Key     *> next 2 is not really needed\n                    go to ba998-Free\n              end-if\n     end-if                        *> row count zero should show up as a MYSQL error ?\n     perform  bb100-UnloadHVs      *> transfer/move HV vars to ws-Record layout\n     move     HV-KEY-1 to ws-temp-ed",
        "line": 594
      },
      {
        "from": "ws-temp-ed",
        "to": "WS-File-Key",
        "line": 648
      },
      {
        "from": "NL-Owning",
        "to": "NL-Sub-Nominal\n              move NL-Pointer to NL-Owning\n              move \"Not found\" to NL-Name\n              go to  ba050-Process-Read-Indexed",
        "line": 656
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error",
        "line": 661
      },
      {
        "from": "99",
        "to": "FS-Reply\n              move 997 to WE-Error                     *> Invalid calling parameter settings     997\n              go to ba999-end\n     end-if\n*>\n*>  First clear any active cursors\n*>\n     if       Cursor-Active\n              perform ba998-Free",
        "line": 672
      },
      {
        "from": "spaces",
        "to": "MOST-Relation",
        "line": 689
      },
      {
        "from": "1",
        "to": "J",
        "line": 690
      },
      {
        "from": "spaces",
        "to": "WS-Where",
        "line": 704
      },
      {
        "from": "NL-Key",
        "to": "WS-File-Key",
        "line": 722
      },
      {
        "from": "8",
        "to": "ws-No-Paragraph\n*>      /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>      /MYSQL-END\\\n*>\n     if       WS-MYSQL-Count-Rows not zero\n *>             move 1 to Most-Cursor-Set\n              set Cursor-Active to true\n     end-if\n*>\n     if       WS-MYSQL-Count-Rows = zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 21 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    move 2 to WE-Error                   *> as in irsub1\n                    go to ba999-End\n              end-if\n     else\n              move  zero to FS-Reply WE-Error            *> next 2 for testing\n              move     WS-MYSQL-Count-Rows to WS-Temp-Ed\n              string   MOST-relation\n                       WS-IRSNL-RECord (K:L)\n                       \" got =\" delimited by size\n                       WS-Temp-ED delimited by size\n                       \" recs\"\n                        into WS-File-Key\n              end-string\n     end-if\n     perform  ba999-end",
        "line": 727
      },
      {
        "from": "NL-Key",
        "to": "WS-File-Key",
        "line": 787
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error\n     move     spaces to SQL-Msg\n     move     zero to SQL-Err\n     move     10 to ws-No-Paragraph",
        "line": 788
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    if    SQL-Err (1:4) = \"1062\"\n                                     or = \"1022\"\n                        or Sql-State = \"23000\"  *> Dup key (rec already present)\n                          move 22 to fs-reply\n                    else\n                          move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    end-if\n              end-if\n     end-if\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if",
        "line": 796
      },
      {
        "from": "\"S\"",
        "to": "NL-Tipe\n              perform ba090-Process-Rewrite thru ba092-Finish-1\n              go       to ba999-Exit     *> wont bother logging it - special\n     end-if\n*>\n     if       Owner            *> no more processing - we are done & logged",
        "line": 829
      },
      {
        "from": "\"O\"",
        "to": "NL-Tipe",
        "line": 837
      },
      {
        "from": "NL-Owning",
        "to": "NL-Pointer",
        "line": 849
      },
      {
        "from": "NL-Sub-Nominal",
        "to": "NL-Owning",
        "line": 850
      },
      {
        "from": "zero",
        "to": "NL-Sub-Nominal",
        "line": 851
      },
      {
        "from": "\"S\"",
        "to": "NL-Tipe",
        "line": 854
      },
      {
        "from": "NL-Owning",
        "to": "NL-Sub-Nominal",
        "line": 865
      },
      {
        "from": "NL-Pointer",
        "to": "NL-Owning",
        "line": 866
      },
      {
        "from": "spaces",
        "to": "WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n *>             NL-Key\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-IRSNL-Record (K:L)  to WS-File-Key",
        "line": 875
      },
      {
        "from": "13",
        "to": "ws-No-Paragraph",
        "line": 892
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End                       *> produce log\n     else\n              move spaces to SQL-Msg SQL-State\n              move zero   to SQL-Err\n     end-if",
        "line": 909
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error",
        "line": 922
      },
      {
        "from": "nl-sub-nominal",
        "to": "nl-owning",
        "line": 934
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 935
      },
      {
        "from": "14",
        "to": "WS-No-Paragraph",
        "line": 936
      },
      {
        "from": "spaces",
        "to": "WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n *>             NL-Key\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-IRSNL-Record (K:L)  to WS-File-Key",
        "line": 937
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End\n     else\n              move spaces to SQL-Msg SQL-State\n              move zero   to SQL-Err\n     end-if",
        "line": 970
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error",
        "line": 983
      },
      {
        "from": "LOW-VALUES",
        "to": "SQLCA-STATEMENT\n*>   STRING\n*>     \"DELETE \" DELIMITED SIZE\n*>     \"FROM \" DELIMITED SIZE\n*>     \"IRSNL-REC \" DELIMITED SIZE\n*>   INTO SQLCA-STATEMENT\n*>   END-STRING\n*>   CALL \"MySQL_query\" USING SQLCA-STATEMENT\n*>   END-CALL\n*>\n*> So if this does not work it will be changed",
        "line": 996
      },
      {
        "from": "9999999999",
        "to": "NL-Key",
        "line": 1008
      },
      {
        "from": "spaces",
        "to": "WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '<\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     spaces to WS-File-Key\n     string   \"Deleting back from \" delimited by size\n               NL-Key               delimited by size\n                      into WS-File-Key\n     end-string                                   *> for logging\n     move     WS-Where (1:J)   to WS-Log-Where",
        "line": 1014
      },
      {
        "from": "15",
        "to": "ws-No-Paragraph",
        "line": 1034
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End\n     else      *> of course there could be no data in table\n              move spaces to SQL-Msg\n              move zero   to SQL-Err\n     end-if",
        "line": 1051
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error",
        "line": 1064
      },
      {
        "from": "17",
        "to": "ws-No-Paragraph",
        "line": 1070
      },
      {
        "from": "spaces",
        "to": "WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-Record (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-Where (1:J)   to WS-Log-Where",
        "line": 1075
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    move 994 to WE-Error\n              end-if\n*>\n              if       Testing-1\n                       perform Ca-Process-Logs\n              end-if\n              go to ba092-Finish-1    *> ba999-exit  [ error ]\n     end-if\n     move     zero   to FS-Reply WE-Error",
        "line": 1096
      },
      {
        "from": "zero",
        "to": "SQL-Err",
        "line": 1111
      },
      {
        "from": "spaces",
        "to": "SQL-Msg",
        "line": 1112
      },
      {
        "from": "NL-Key",
        "to": "WS-File-Key",
        "line": 1121
      },
      {
        "from": "zero",
        "to": "FS-Reply WE-Error\n     move     spaces to SQL-Msg\n     move     zero to SQL-Err\n     move     18 to ws-No-Paragraph",
        "line": 1122
      },
      {
        "from": "WS-MYSQL-SqlState",
        "to": "SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    if    SQL-Err (1:4) = \"1062\"\n                                     or = \"1022\"\n                        or Sql-State = \"23000\"  *> Dup key (rec already present)\n                          move 22 to fs-reply\n                    else\n                          move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    end-if\n              end-if\n     end-if\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if",
        "line": 1130
      },
      {
        "from": "990",
        "to": "WE-Error",
        "line": 1157
      },
      {
        "from": "99",
        "to": "Fs-Reply",
        "line": 1158
      },
      {
        "from": "20",
        "to": "ws-No-Paragraph",
        "line": 1166
      },
      {
        "from": "TP-IRSNL-REC",
        "to": "WS-MYSQL-RESULT\n           CALL \"MySQL_free_result\" USING WS-MYSQL-RESULT end-call\n*>      /MYSQL-END\\\n *>    move     zero to Most-Cursor-Set",
        "line": 1172
      },
      {
        "from": "NL-Key",
        "to": "HV-KEY-1",
        "line": 1197
      },
      {
        "from": "NL-Tipe",
        "to": "HV-TIPE",
        "line": 1198
      },
      {
        "from": "NL-Pointer",
        "to": "HV-REC-POINTER\n     else\n              move     NL-Name         to HV-NL-NAME\n              move     NL-DR           to HV-DR\n              move     NL-CR           to HV-CR\n              move     NL-AC           to HV-AC\n              move     DR-Last-01      to HV-DR-LAST-01\n              move     CR-Last-01      to HV-CR-LAST-01\n              move     DR-Last-02      to HV-DR-LAST-02\n              move     CR-Last-02      to HV-CR-LAST-02\n              move     DR-Last-03      to HV-DR-LAST-03\n              move     CR-Last-03      to HV-CR-LAST-03\n              move     DR-Last-04      to HV-DR-LAST-04\n              move     CR-Last-04      to HV-CR-LAST-04\n     end-if",
        "line": 1201
      },
      {
        "from": "HV-KEY-1",
        "to": "NL-Key",
        "line": 1234
      },
      {
        "from": "HV-TIPE",
        "to": "NL-Tipe",
        "line": 1235
      },
      {
        "from": "HV-REC-POINTER",
        "to": "NL-Pointer\n     else\n              move     HV-NL-NAME         to NL-Name\n              move     HV-DR              to NL-Dr\n              move     HV-CR              to NL-Cr\n              move     HV-AC              to NL-AC\n              move     HV-DR-LAST-01      to DR-Last-01\n              move     HV-DR-LAST-02      to DR-Last-02\n              move     HV-DR-LAST-03      to DR-Last-03\n              move     HV-DR-LAST-04      to DR-Last-04\n              move     HV-CR-LAST-01      to CR-Last-01\n              move     HV-CR-LAST-02      to CR-Last-02\n              move     HV-CR-LAST-03      to CR-Last-03\n              move     HV-CR-LAST-04      to CR-Last-04\n     end-if",
        "line": 1237
      },
      {
        "from": "1",
        "to": "WS-MYSQL-I\n           STRING 'INSERT INTO '\n                    '`IRSNL-REC` SET '\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`KEY-1`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-KEY-1\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(03:18))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`TIPE`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-TIPE,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`NL-NAME`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-NL-NAME,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1265
      },
      {
        "from": "HV-CR",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1320
      },
      {
        "from": "HV-DR-LAST-01",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1337
      },
      {
        "from": "HV-CR-LAST-01",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1354
      },
      {
        "from": "HV-DR-LAST-02",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1371
      },
      {
        "from": "HV-CR-LAST-02",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1388
      },
      {
        "from": "HV-DR-LAST-03",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1405
      },
      {
        "from": "HV-CR-LAST-03",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1422
      },
      {
        "from": "HV-DR-LAST-04",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1439
      },
      {
        "from": "HV-CR-LAST-04",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1456
      },
      {
        "from": "HV-REC-POINTER",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING \";\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING X\"00\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n       PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>  /MYSQL-END\\\n       ",
        "line": 1482
      },
      {
        "from": "1",
        "to": "WS-MYSQL-I\n           STRING 'UPDATE '\n                    '`IRSNL-REC` SET '\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`KEY-1`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-KEY-1\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(03:18))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`TIPE`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-TIPE,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`NL-NAME`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-NL-NAME,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1509
      },
      {
        "from": "HV-CR",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1564
      },
      {
        "from": "HV-DR-LAST-01",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1581
      },
      {
        "from": "HV-CR-LAST-01",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1598
      },
      {
        "from": "HV-DR-LAST-02",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1615
      },
      {
        "from": "HV-CR-LAST-02",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1632
      },
      {
        "from": "HV-DR-LAST-03",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1649
      },
      {
        "from": "HV-CR-LAST-03",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1666
      },
      {
        "from": "HV-DR-LAST-04",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1683
      },
      {
        "from": "HV-CR-LAST-04",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \"",
        "line": 1700
      },
      {
        "from": "HV-REC-POINTER",
        "to": "WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING \" WHERE \"\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (WS-Where (1:J))\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n           STRING \";\" X\"00\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>  /MYSQL-END\\\n       ",
        "line": 1726
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "testing-1 set on table close.\n*>                    branch to 999-end instead of 998-free when EOF on read next.\n*>                    Seems to auto release if end of cursor data reached\n*>                    and causes an abort ??\n*> 30/07/16 vbc - .04 Change Open and Close to also show table name in operation.\n*> 31/07/16 vbc - .05 Moved mv spaces/zero in Write to before insert.\n*>                    Remove fhlogger file close in Process-Close.\n*>                    Forgot error 989 so commented.\n*> 02/10/16 vbc - .06 Modified for IRS processing & based on irsub1.\n*>                    write, rewrite, start etc.\n*> 22/12/16 vbc - .07 Changed to support fn-delete-all so that all\n*>                    CoA can be cleared down (similarly to open output).\n*>                    Also added fn-write-raw for nominalLD.\n*> 29/12/16 vbc - .08 Fixed bugs in Start for 2->we-error and goto ba041\n*>                    instead of ba040.\n*>                    Fixed bug in Delete forgot to do sub as well if owner.\n*> 30/12/16 vbc - .09 WE-Error is the only field tested for errors in irs so\n*>                    clear it at start and use it replacing if poss. fs-reply.\n*>                    This is only for IRS routines/modules - so far!\n*>                .10 In ba050 when a sub present went to ba051 instead of ba050\n*>                    as should get the isam key from pointer.\n*>                    Now using Sql-State as well.\n*> 01/03/18 vbc - .11 Renamed error messages to SM901, SM004 as needed.\n*>                    Added IR906 - IR908 - also in acasirsub1.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>**\n*>  Module USAGE see irsdflt for details.\n*>\n copy \"ACAS-SQLstate-error-list.cob\".\n*>\n*>********************************************************************************************\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>**********************************************************************************\n*>\n environment division.\n*> copy \"envdiv.cob\".\n*>\n input-output section.\n Data Division.\n Working-Storage Section.\n 77  prog-name           pic x(22)    value \"irsnominalMT (3.02.11)\".\n*>\n*> JC WS requirements here\n*>\n 77  ws-Where            pic x(512).\n*>\n*>  Used within presql generated code\n*>\n 01  WS-Reply            pic x           value space.\n 01  WS-MYSQL-I          PIC S9(4) COMP.\n 01  WS-MYSQL-EDIT       PIC -Z(18)9.9(9).\n *>\n *> TESING data\n *>\n 01  ws-temp-ed          pic 9(10).\n*>\n*> The communication area for the MySQL database changed for free/mysql\n*>\n*>  jc preSQL MySQL stuff ends\n*>\n*> Metadata on primary and alternate keys...  from Prima DAL for IRSNL-REC\n*>\n 01  Table-Of-Keynames.\n     03  filler          pic x(30) value \"KEY-1                         \".\n     03  filler          pic x(8)  value \"00010010\". *> offset/length\n     03  filler          pic xxx   value \"STR\".      *> key is string\n*>\n 01  filler redefines table-of-keynames.\n     03  keyOfReference occurs 1    indexed by KOR-x1.\n         05 KeyName      pic x(30).\n         05 KOR-Offset   pic 9(4).\n         05 KOR-Length   pic 9(4).\n         05 KOR-Type     pic XXX.                    *> Not used currently\n*>\n*> The START condition cannot be compounded, and it must use a\n*> Key of Reference within the record. (These are COBOL rules...)\n*> The interface defines which key and the relation condition.\n*>\n 01  DAL-Data.\n     05  MOST-Relation   pic xxx.                  *> valid are >=, <=, <, >, =\n     05  Most-Cursor-Set pic 9    value zero.\n         88  Cursor-Not-Active    value zero.\n         88  Cursor-Active        value 1.\n*>\n*>  Variables common to all DALs\n*>  ****************************\n*>\n 01  subscripts usage comp-5.\n     12 J                pic s9(4).\n     12 K                pic s9(4).\n     12 L                pic s9(4).\n*>\n 01  work-fields.\n     03  ws-env-lines    pic 999              value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n     03  ws-98-lines     binary-char unsigned value zero.\n     03  ws-99-lines     binary-char unsigned value zero.\n     03  ws-Rec-Cnt      binary-long unsigned value zero.\n*>\n 01  Error-Messages.\n     03  SM901          pic x(31) value \"SM901 Note error and hit return\".\n     03  IR906          pic x(40) value \"IR906 Link/record exists on owning write\".\n     03  IR907          pic x(42) value \"IR907 Link/record exists on rewrite (S->O)\".\n     03  IR908          pic x(37) value \"IR908 link/record exists on sub write\".\n*>\n*> /MYSQL VAR\\\n*>       ACASDB\n*>       TABLE=IRSNL-REC,HV\n COPY \"mysql-variables.cpy\".\n*>\n*>    Definitions for the IRSNL-REC Table\n*>\n       01  TP-IRSNL-REC                          USAGE POINTER.\n       01  TD-IRSNL-REC.\n           05  HV-KEY-1                          PIC  9(18) COMP.\n           05  HV-TIPE                           PIC X(1).\n           05  HV-NL-NAME                        PIC X(24).\n           05  HV-DR                             PIC  9(08)V9(02) COMP.\n           05  HV-CR                             PIC  9(08)V9(02) COMP.\n           05  HV-DR-LAST-01                     PIC  9(08)V9(02) COMP.\n           05  HV-CR-LAST-01                     PIC  9(08)V9(02) COMP.\n           05  HV-DR-LAST-02                     PIC  9(08)V9(02) COMP.\n           05  HV-CR-LAST-02                     PIC  9(08)V9(02) COMP.\n           05  HV-DR-LAST-03                     PIC  9(08)V9(02) COMP.\n           05  HV-CR-LAST-03                     PIC  9(08)V9(02) COMP.\n           05  HV-DR-LAST-04                     PIC  9(08)V9(02) COMP.\n           05  HV-CR-LAST-04                     PIC  9(08)V9(02) COMP.\n           05  HV-AC                             PIC X(1).\n           05  HV-REC-POINTER                    PIC  9(08) COMP.\n*> /MYSQL-END\\\n*>\n Linkage Section.\n*>**************\n*>\n*>**********************************************************************\n copy \"wsfnctn.cob\".                         *> File-Access\n*>\n*>**********************************************************************\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n*>  Record definition for Cobol file here:\n*>\n 01  WS-IRSNL-Record.\n     03  NL-Key             pic 9(10).\n     03  filler redefines NL-Key.\n         05  NL-Owning      pic 9(5).\n         05  NL-Sub-Nominal pic 9(5).\n     03  NL-Tipe            pic x.\n         88  Sub                     value \"S\".\n         88  Owner                   value \"O\".\n     03  NL-Data.\n         05  NL-Name        pic x(24).\n         05  NL-DR          pic 9(8)v99   comp.\n         05  NL-CR          pic 9(8)v99   comp.\n         05  Last-Posts.                      *>  occurs 4.\n             07  DR-Last-01     pic 9(8)v99   comp.\n             07  DR-Last-02     pic 9(8)v99   comp.\n             07  DR-Last-03     pic 9(8)v99   comp.\n             07  DR-Last-04     pic 9(8)v99   comp.\n             07  CR-Last-01     pic 9(8)v99   comp.\n             07  CR-Last-02     pic 9(8)v99   comp.\n             07  CR-Last-03     pic 9(8)v99   comp.\n             07  CR-Last-04     pic 9(8)v99   comp.\n         05  NL-AC          pic x.\n     03  filler  redefines  NL-Data.\n         05  NL-Pointer     pic 9(5).\n*>\n screen section.\n*>=============\n*>\n 01  Display-Message-1       foreground-color 2.\n     03          value \"WS-Where=\"                line 23 col  1.\n     03  from WS-Where (1:J)           pic x(69)          col 10.\n*>\n 01  Display-Message-2       foreground-color 2.\n     03      value \"SM004 SQL Err No.=\"            line 4 col  1.    *> size 18 char\n     03  using Ws-Mysql-Error-Number   pic x(4)           col 19.    *>      4       == 22\n     03      value \" Para=\"                               col 23.    *> size 6 char  == 28\n     03  using WS-No-Paragraph         pic 9(3)           col 29.    *>      4       == 32\n     03      value \" SQL Cmd=\"                            col 32.    *>      9       == 41\n     03  using Ws-Mysql-Command        pic x(199)         col 41.\n     03      value \"SQL Err Msg=\"                  line 7 col  1.    *>      12\n     03  using Ws-Mysql-Error-Message  pic x(67)          col 13.\n*>\n*>\n PROCEDURE DIVISION   using File-Access\n                            ACAS-DAL-Common-data\n                            WS-IRSNL-Record.   *>  Ws record\n*>**********************************************\n ba-ACAS-DAL-Process  section.\n     accept   ws-env-lines from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines to ws-lines\n     end-if\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n*>\n ba010-Initialise.\n*>\n     move     zero   to We-Error                        *> as in irsub1\n                        Fs-Reply.    *> for testing as in irsub1 Not used.\n*>\n     move     spaces to WS-MYSQL-Error-Message\n                        WS-MYSQL-Error-Number\n                        WS-Log-Where\n                        WS-File-Key\n                        SQL-Msg\n                        SQL-Err.\n*>\n*>   Now Test for valid key for start, read-indexed and delete\n*>      REMOVED as not used here\n*>\n*>  Work out what is being requested and convert to action!!\n*>\n*>    This version uses the JC pre-Sql processor.\n*>    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n*>\n     evaluate File-Function\n        when  1\n              go to ba020-Process-Open\n        when  2\n              go to ba030-Process-Close\n        when  3\n              go to ba040-Process-Read-Next\n        when  4\n              go to ba050-Process-Read-Indexed\n        when  5\n              go to ba070-Process-Write\n*>\n*> option 6 is a special to cleardown all data\n*>\n        when  6                              *> DELETE-ALL  Special\n              go to ba085-Process-DELETE-ALL\n        when  7\n              go to ba090-Process-Rewrite\n        when  8\n              go to ba080-Process-Delete\n        when  9\n              go to ba060-Process-Start\n        when  15                             *> fn-Write-Raw  / 15\n              go to ba170-Process-Write-Raw\n        when  other                          *> 6 is spare / unused\n              go to ba100-Bad-Function\n     end-evaluate.\n*>\n ba020-Process-Open.\n *>\n *>  Manual process MYSQL INIT\n *>",
        "line": 50
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              go   to ba999-end.\n*>\n*> *> /MYSQL INIT\\\n*>       BASE=ACASDB\n*>       IMPLEMENTATION=dev-prog-001\n*>       PASSWORD=mysqlpass\n*> *> /MYSQL-END\\\n*>\n     move    \"OPEN IRSNOMINAL (RDB)\" to WS-File-Key\n     move    zero   to Most-Cursor-Set\n     go      to ba999-end.\n*>\n ba030-Process-Close.\n     if      Cursor-Active\n             perform ba998-Free.\n*>\n     move     2 to ws-No-Paragraph.\n     move    \"CLOSE IRSNOMINAL (RDB)\" to WS-File-Key.\n*>  /MYSQL CLOSE\\\n*>\n*>    Close the Database\n*>\n           PERFORM MYSQL-1980-CLOSE THRU MYSQL-1999-EXIT\n*>  /MYSQL-END\\\n*>\n     go      to ba999-end.\n*>\n ba040-Process-Read-Next.\n*>\n*>  Uses 3 (instead of 10) as EOF flag in WE-Error per irsub1\n*>\n*>   Here a SELECT first",
        "line": 360
      },
      {
        "type": "IF",
        "condition": "no cursor active using lowest\n*>    possible key of \"0000000000\"\n*>           [ KEY-1 ]\n*>\n     if       Cursor-Not-Active\n              set      KOR-x1 to 1                *> 1 = Primary\n              move     KOR-offset (KOR-x1) to K\n              move     KOR-length (KOR-x1) to L\n*>\n              move     spaces to WS-Where\n              move     1   to J\n              string\n                       \"`TIPE`='O' AND \"     delimited by size\n                       \"`\"                   delimited by size\n                       KeyName (KOR-x1)      delimited by space\n                       \"`\"                   delimited by size\n                       \" > \"                 delimited by size   *> 26/12/16 NOT '='\n                       '\"0000000000\"'          delimited by size\n                       ' ORDER BY '          delimited by size\n                       \"`\"                   delimited by size\n                       keyname (KOR-x1)      delimited by space\n                       \"`\"                   delimited by size\n                         ' ASC '             delimited by size\n                                      into ws-Where\n                                      with pointer J\n              end-string\n*>\n              move     ws-Where (1:J)   to WS-Log-Where       *>  For test logging\n              move     3 to ws-No-Paragraph\n*>               /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>                    TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             ws-Where (1:J)      *> KEY-1 > \"0000000000\" ORDER BY IRSNL-REC ASC\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>               /MYSQL-END\\\n           move    \"> 0000000000\" to WS-File-Key\n              if    Testing-2\n                    display Display-Message-1 with erase eos\n              end-if\n*>\n*>  It could be an empty table so test for it\n*>\n              if       WS-MYSQL-Count-Rows = zero\n                       call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n                       call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n                       move  WS-MYSQL-SqlState   to SQL-State\n                       if    WS-MYSQL-Error-Number  not = \"0  \"\n                             move WS-MYSQL-Error-Number  to SQL-Err\n                             call \"MySQL_error\" using WS-MYSQL-Error-Message\n                             move WS-MYSQL-Error-Message to SQL-Msg\n                       end-if\n                       move 10 to fs-reply\n   *>                    move 10 to WE-Error\n                     move 3 to WE-Error                 *> as in irsub1\n                       move    \"No Data\" to WS-File-Key\n                       go to ba999-End       *> can clear the dup code after testing\n              end-if\n              set Cursor-Active to true\n              move     WS-MYSQL-Count-Rows to WS-Temp-Ed\n              string   \"> 0 got cnt=\" delimited by size\n                       WS-Temp-ED delimited by size\n                       \" recs\"\n                        into WS-File-Key\n              end-string\n              perform ba999-End                         *> log it\n     end-if.                                            *> cursor now set\n*>\n ba041-Reread.\n*>\n*>  If here cursor is set (even from start), so get the next row\n*>\n     move     spaces to WS-Log-Where.\n     move     4 to ws-No-Paragraph.\n\n     move zero to return-code.\n\n*>      /MYSQL FETCH\\\n*>\n*>    Fetch next record\n*>\n*>             TABLE=IRSNL-REC\n           MOVE TP-IRSNL-REC TO WS-MYSQL-RESULT\n           CALL \"MySQL_fetch_record\" USING WS-MYSQL-RESULT\n                    HV-KEY-1\n                    HV-TIPE\n                    HV-NL-NAME\n                    HV-DR\n                    HV-CR\n                    HV-DR-LAST-01\n                    HV-CR-LAST-01\n                    HV-DR-LAST-02\n                    HV-CR-LAST-02\n                    HV-DR-LAST-03\n                    HV-CR-LAST-03\n                    HV-DR-LAST-04\n                    HV-CR-LAST-04\n                    HV-AC\n                    HV-REC-POINTER\n\n*>      /MYSQL-END\\\n     end-call\n*>\n     if       return-code = -1                  *> no more data so free cursor & return\n              move 10 to fs-Reply           *> WE-Error\n            move 3 to WE-Error                              *> as in irsub1\n              move    \"EOF\" to WS-File-Key\n *>             move     zero to Most-Cursor-Set\n              set Cursor-Not-Active to true\n              go to ba999-End\n     end-if\n*>\n     if       WS-MYSQL-Count-Rows = zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move 10 to fs-reply                     *> EOF equivilent !!\n       *>             move 10 to WE-Error\n                   move 3 to WE-Error                       *> as in irsub1\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    initialize WS-IRSNL-Record with filler\n                    move    \"EOF2\" to WS-File-Key\n              end-if\n              set Cursor-Not-Active to true\n              go to ba999-End\n     end-if.\n*>\n     if       fs-reply = 10\n *>             move     zero to Most-Cursor-Set\n              set Cursor-Not-Active to true\n              move    \"EOF3\" to WS-File-Key\n              go to ba999-End\n     end-if.\n     perform  bb100-UnloadHVs.       *> transfer/move HV vars to Record layout\n*>\n*> test to see if pointer record 1st [ from irsub1 ] but shouldnt happen !\n*>\n     if       Sub\n              go to ba041-Reread.\n*>\n     move     HV-KEY-1 to ws-temp-ed.\n     move    ws-temp-ed to WS-File-Key.\n     move     zero to fs-reply WE-Error.\n     go       to ba999-end.\n*>\n ba050-Process-Read-Indexed.\n*>\n*>  Now do on correct key within WHERE\n*>  Sets up key and compare data\n*>\n     set      KOR-x1 to 1                *> 1 = Primary\n     move     KOR-offset (KOR-x1) to K\n     move     KOR-length (KOR-x1) to L\n*>\n     move     spaces to WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-Record (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-Where (1:J)   to WS-Log-Where.    *>  For test logging\n     if    Testing-2\n           display Display-Message-1 with erase eos\n     end-if.\n     move     5 to ws-No-Paragraph\n*>      /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>      /MYSQL-END\\\n*>\n     if     WS-MYSQL-Count-Rows = zero\n            move 21  to fs-Reply             *> could also be 23 or 14\n            move 2 to WE-Error               *> as in irsub1\n            go to ba998-Free\n     end-if.\n     move     6 to ws-No-Paragraph\n*>      /MYSQL FETCH\\\n*>\n*>    Fetch next record\n*>\n*>             TABLE=IRSNL-REC\n           MOVE TP-IRSNL-REC TO WS-MYSQL-RESULT\n           CALL \"MySQL_fetch_record\" USING WS-MYSQL-RESULT\n                    HV-KEY-1\n                    HV-TIPE\n                    HV-NL-NAME\n                    HV-DR\n                    HV-CR\n                    HV-DR-LAST-01\n                    HV-CR-LAST-01\n                    HV-DR-LAST-02\n                    HV-CR-LAST-02\n                    HV-DR-LAST-03\n                    HV-CR-LAST-03\n                    HV-DR-LAST-04\n                    HV-CR-LAST-04\n                    HV-AC\n                    HV-REC-POINTER\n\n*>      /MYSQL-END\\\n     end-call\n*>\n     if       WS-MYSQL-Count-Rows not > zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    move 21 to fs-reply    *> from 23\n *>                   move 990 to WE-Error\n                    move 2 to WE-Error                 *> as in irsub1\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move WS-MYSQL-Error-Number to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move spaces to WS-File-Key\n                    move \"Not found 1\" to NL-Name\n                    go to ba998-Free\n              else\n                    move 21   to fs-reply    *> from 23\n *>                   move 989  to WE-Error\n                    move 2 to WE-Error                 *> as in irsub1\n                    move zero to SQL-Err\n                   move \"Not found 2\" to NL-Name\n                    move spaces to SQL-Msg\n                    move spaces to WS-File-Key     *> next 2 is not really needed\n                    go to ba998-Free\n              end-if\n     end-if                        *> row count zero should show up as a MYSQL error ?\n     perform  bb100-UnloadHVs      *> transfer/move HV vars to ws-Record layout\n     move     HV-KEY-1 to ws-temp-ed.\n     move    ws-temp-ed to WS-File-Key.\n*>\n*>  IRSUB1 specific - - >\n*>\n     if       Sub\n              if       Testing-1\n                       perform Ca-Process-Logs\n              end-if\n              move NL-Owning  to NL-Sub-Nominal\n              move NL-Pointer to NL-Owning\n              move \"Not found\" to NL-Name\n              go to  ba050-Process-Read-Indexed.\n*>\n     move     zero to FS-Reply WE-Error.\n     go       to ba998-Free.\n*>\n ba060-Process-Start.\n*>\n*> THIS MINOR CHANGES FOR IRSUB1 START/READ NEXT using\n*>   read-indexed = or not < or > or <  ???\n*>\n*>  Check for Param error 1st on start\n*>\n     if       access-type < 5 or > 8                   *> not using not < or not >\n              move 99 to FS-Reply\n              move 997 to WE-Error                     *> Invalid calling parameter settings     997\n              go to ba999-end\n     end-if\n*>\n*>  First clear any active cursors\n*>\n     if       Cursor-Active\n              perform ba998-Free.\n*>\n*>  Now do Start on correct key before read-next  within WHERE\n*>  Set up MOST-relation for condition test and key\n*>\n     set      KOR-x1 to 1                *> 1 = Primary\n     move     KOR-offset (KOR-x1) to K\n     move     KOR-length (KOR-x1) to L\n*>\n     move     spaces to MOST-Relation.\n     move     1   to J.\n     evaluate Access-Type     *>  x shows used in irs.\n              when  5                           *>x fn-equal-to\n                    move \"=  \" to MOST-Relation\n              when  6                           *> fn-less-than\n                    move \"<  \" to MOST-Relation\n              when  7                           *>x fn-greater-than\n                    move \">  \" to MOST-Relation\n              when  8                           *>x fn-not-less-than\n                    move \">= \" to MOST-Relation\n              when  9                           *> fn-not-greater-than [ not currently used in ACAS ]\n                    move \"<= \" to MOST-Relation\n     end-evaluate\n*>\n     move     spaces  to WS-Where.\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              MOST-relation         delimited by space\n              '\"'                   delimited by size\n              WS-IRSNL-RECord (K:L) delimited by size\n *>             NL-Key\n              '\"'                   delimited by size\n              \" ORDER BY \"          delimited by size   *> very iffy about this - wanted ?\n              \"`\"                   delimited by size\n              keyname (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n                ' ASC '             delimited by size\n                             into WS-Where\n                             with pointer J\n     end-string\n     move     WS-Where (1:J)  to WS-Log-Where.    *>  For test logging\n     move     NL-Key to WS-File-Key.   *> ws-IRSNL-Record (K:L) to WS-File-Key.\n     if    Testing-2\n           display Display-Message-1 with erase eos\n     end-if\n*>\n     move     8 to ws-No-Paragraph\n*>      /MYSQL SELECT\\\n*>\n*>    Select rows\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"SELECT * FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n            \";\"  X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n           PERFORM MYSQL-1220-STORE-RESULT THRU MYSQL-1239-EXIT\n           MOVE WS-MYSQL-RESULT TO TP-IRSNL-REC\n*>      /MYSQL-END\\\n*>\n     if       WS-MYSQL-Count-Rows not zero\n *>             move 1 to Most-Cursor-Set\n              set Cursor-Active to true\n     end-if\n*>\n     if       WS-MYSQL-Count-Rows = zero\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using WS-MYSQL-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 21 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    move 2 to WE-Error                   *> as in irsub1\n                    go to ba999-End\n              end-if\n     else\n              move  zero to FS-Reply WE-Error            *> next 2 for testing\n              move     WS-MYSQL-Count-Rows to WS-Temp-Ed\n              string   MOST-relation\n                       WS-IRSNL-RECord (K:L)\n                       \" got =\" delimited by size\n                       WS-Temp-ED delimited by size\n                       \" recs\"\n                        into WS-File-Key\n              end-string\n     end-if\n     perform  ba999-end.                                 *> Log it\n*>\n*> Here we need FETCH as SELECT has been issued & cursor active\n*>\n     go to ba041-Reread.\n*>\n*> Changed to do start",
        "line": 392
      },
      {
        "type": "IF",
        "condition": "WS-MYSQL-COUNT-ROWS not = 1\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    if    SQL-Err (1:4) = \"1062\"\n                                     or = \"1022\"\n                        or Sql-State = \"23000\"  *> Dup key (rec already present)\n                          move 22 to fs-reply\n                    else\n                          move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    end-if\n              end-if\n     end-if\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if.\n*>\n ba072-Proc-Write-Subs.\n*>\n*>  IRS only code, for Extra processing for sub-nominal.\n*>\n     if       SQL-Err = \"1062\" or \"1022\"\n        or    FS-Reply = 22    *> from original irsub1\n              display IR906 at 2401 with foreground-color 4\n              accept WS-Reply at 2438.    *> TESTING\n*>\n*>  Specials for testing as COA incorrectly coded without subs\n*>\n     if       Owner\n         AND  NL-Sub-Nominal = zero  *> its a sub pointer really\n         AND  NL-Tipe = \"O\"\n         AND  NL-Name = spaces           *> definately\n              move     \"S\"            to NL-Tipe\n              perform ba090-Process-Rewrite thru ba092-Finish-1\n              go       to ba999-Exit     *> wont bother logging it - special\n     end-if\n*>\n     if       Owner            *> no more processing - we are done & logged.\n              go to ba999-exit.\n*>\n     move     \"O\" to NL-Tipe.\n     perform  ba090-Process-Rewrite thru ba092-Finish-1.\n     if       WE-Error = 994\n              display IR907 at 2401 with foreground-color 4\n              accept WS-Reply at 2432    *> TESTING can remove ?\n     end-if\n*>\n*>  Extra code to stop zero keys  21/12/16\n*>\n     if       NL-Sub-Nominal = zero\n              go to ba999-Exit.\n*>\n     move     NL-Owning      to NL-Pointer.\n     move     NL-Sub-Nominal to NL-Owning.\n     move     zero           to NL-Sub-Nominal.\n*>\n ba073-Fix-Up-Subs.\n     move     \"S\"            to NL-Tipe.\n     perform  ba070-Process-Write.\n     if       SQL-Err = \"1062\" or \"1022\"\n       or     FS-Reply = 22\n              display IR908 at 2401 with foreground-color 4\n              accept WS-Reply at 2435    *> TESTING\n     end-if                                   *> here from irsub1\n*> JIC\n     if       fs-reply not = zero\n              perform ba090-Process-Rewrite thru ba092-Finish-1\n     end-if.\n     move     NL-Owning  to NL-Sub-Nominal.   *> Do not know why this was missed out\n     move     NL-Pointer to NL-Owning.        *>  but restored in case used by caller\n     go       to ba999-Exit.\n*>\n ba080-Process-Delete.        *> IRS does not test for error cond. as in irsub1\n*>\n     set      KOR-x1 to 1                *> 1 = Primary\n     move     KOR-offset (KOR-x1) to K\n     move     KOR-length (KOR-x1) to L\n*>\n     move     spaces to WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n *>             NL-Key\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-IRSNL-Record (K:L)  to WS-File-Key.\n     move     WS-Where (1:J)   to WS-Log-Where.   *>  For test logging\n     if    Testing-2\n           display Display-Message-1 with erase eos\n     end-if\n     move     13 to ws-No-Paragraph.\n*>      /MYSQL DELETE\\\n*>\n*>    Delete a row\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"DELETE FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n             X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>      /MYSQL-END\\\n     if       WS-MYSQL-COUNT-ROWS not = 1           *>  TEST IS NOT IN IRSUB1\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End                       *> produce log\n     else\n              move spaces to SQL-Msg SQL-State\n              move zero   to SQL-Err\n     end-if.\n     move     zero to FS-Reply WE-Error.\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if\n*>\n*> Now delete the pointer if NOT owner\n*>\n     if       owner\n              go to    ba999-Exit.\n*>\n*> Delete the pointer\n*>\n     move     nl-sub-nominal to nl-owning.\n     move     zero           to nl-sub-nominal.\n     move     14         to WS-No-Paragraph.\n     move     spaces to WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n *>             NL-Key\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-IRSNL-Record (K:L)  to WS-File-Key.\n     move     WS-Where (1:J)   to WS-Log-Where.   *>  For test logging\n     if    Testing-2\n           display Display-Message-1 with erase eos\n     end-if\n*>      /MYSQL DELETE\\\n*>\n*>    Delete a row\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"DELETE FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n             X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>      /MYSQL-END\\\n     if       WS-MYSQL-COUNT-ROWS not = 1           *>  TEST IS NOT IN IRSUB1\n              call \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End\n     else\n              move spaces to SQL-Msg SQL-State\n              move zero   to SQL-Err\n     end-if.\n     move     zero to FS-Reply WE-Error.\n     go       to ba999-End.\n*>\n ba085-Process-Delete-ALL.    *> THIS IS NON STANDARD\n*>\n*> This is the equivalent of :\n*>           EXEC SQL\n*>              DELETE\n*>              FROM IRSNL-REC\n*>           END-EXEC.\n*>\n*>  That creates the follwoing code from dbpre\n*>\n*>   MOVE LOW-VALUES TO SQLCA-STATEMENT\n*>   STRING\n*>     \"DELETE \" DELIMITED SIZE\n*>     \"FROM \" DELIMITED SIZE\n*>     \"IRSNL-REC \" DELIMITED SIZE\n*>   INTO SQLCA-STATEMENT\n*>   END-STRING\n*>   CALL \"MySQL_query\" USING SQLCA-STATEMENT\n*>   END-CALL\n*>\n*> So if this does not work it will be changed.\n*>\n     move     9999999999  to NL-Key.         *> The last possible data\n*>\n     set      KOR-x1 to 1\n     move     KOR-offset (KOR-x1) to K\n     move     KOR-length (KOR-x1) to L\n*>\n     move     spaces to WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '<\"'                  delimited by size\n              WS-IRSNL-RECord (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     spaces to WS-File-Key\n     string   \"Deleting back from \" delimited by size\n               NL-Key               delimited by size\n                      into WS-File-Key\n     end-string                                   *> for logging\n     move     WS-Where (1:J)   to WS-Log-Where.   *>  For test logging\n     if    Testing-2\n           display Display-Message-1 with erase eos\n     end-if\n     move     15 to ws-No-Paragraph.\n*>      /MYSQL DELETE\\\n*>\n*>    Delete a row\n*>\n*>             TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           STRING \"DELETE FROM \"\n             \"`IRSNL-REC`\"\n             \" WHERE \"\n             WS-Where (1:J)\n             X\"00\" INTO WS-MYSQL-COMMAND\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>      /MYSQL-END\\\n     if       WS-MYSQL-COUNT-ROWS not > zero    *> Changed for delete-ALL\n              call  \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call  \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move  WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply\n                    move 995 to WE-Error\n              end-if\n              go to ba999-End\n     else      *> of course there could be no data in table\n              move spaces to SQL-Msg\n              move zero   to SQL-Err\n     end-if.\n     move     zero to FS-Reply WE-Error.\n     go       to ba999-End.\n*>\n ba090-Process-Rewrite.\n*>\n     perform  bb000-HV-Load.       *> Load up the HV fields from table record in WS\n     move     17 to ws-No-Paragraph.\n     set      KOR-x1 to 1            *> 1 = Primary\n     move     KOR-offset (KOR-x1) to K\n     move     KOR-length (KOR-x1) to L\n*>\n     move     spaces to WS-Where\n     move     1   to J\n     string   \"`\"                   delimited by size\n              KeyName (KOR-x1)      delimited by space\n              \"`\"                   delimited by size\n              '=\"'                  delimited by size\n              WS-IRSNL-Record (K:L)       delimited by size\n              '\"'                   delimited by size\n                      into WS-Where\n                        with pointer J\n     end-string\n     move     WS-Where (1:J)   to WS-Log-Where.    *>  For test logging\n     perform  bb300-Update.\n*>\n     if       Testing-2\n              display Display-Message-1 with erase eos\n     end-if\n*>\n     if       WS-MYSQL-COUNT-ROWS not = 1\n              call \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call     \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move     WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    move 994 to WE-Error\n              end-if\n*>\n              if       Testing-1\n                       perform Ca-Process-Logs\n              end-if\n              go to ba092-Finish-1    *> ba999-exit  [ error ]\n     end-if\n     move     zero   to FS-Reply WE-Error.\n     move     zero   to SQL-Err.\n     move     spaces to SQL-Msg.\n     go       to ba092-Finish-1.  *> was ba999-exit.[normal finish]\n*>\n ba092-Finish-1.\n ba093-Finish-2.\n     go       to ba999-Exit.\n*>\n ba170-Process-Write-Raw.\n     perform  bb000-HV-Load.                       *>  move WS-IRSNL-RECord fields to HV fields\n     move     NL-Key to WS-File-Key.\n     move     zero to FS-Reply WE-Error\n     move     spaces to SQL-Msg\n     move     zero to SQL-Err\n     move     18 to ws-No-Paragraph.\n     perform  bb200-Insert.\n     if       WS-MYSQL-COUNT-ROWS not = 1\n              call \"MySQL_errno\" using WS-MYSQL-Error-Number\n              call     \"MySQL_sqlstate\" using WS-MYSQL-SQLstate\n              move     WS-MYSQL-SqlState   to SQL-State\n              if    WS-MYSQL-Error-Number  not = \"0  \"\n                    call \"MySQL_error\" using Ws-Mysql-Error-Message\n                    move WS-MYSQL-Error-Number  to SQL-Err\n                    move WS-MYSQL-Error-Message to SQL-Msg\n                    if    SQL-Err (1:4) = \"1062\"\n                                     or = \"1022\"\n                        or Sql-State = \"23000\"  *> Dup key (rec already present)\n                          move 22 to fs-reply\n                    else\n                          move 99 to fs-reply                  *> this may need changing for val in WE-Error!!\n                    end-if\n              end-if\n     end-if\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if.\n*>\n     if       fs-reply not = zero\n              perform ba090-Process-Rewrite thru ba092-Finish-1\n     end-if.                    *> this will run ca-process-logging\n     go       to ba999-Exit.\n*>\n ba100-Bad-Function.\n*>\n*> Houston; We have a problem\n*>\n     move     990 to WE-Error.\n     move     99 to Fs-Reply.\n     go       to ba999-end.\n*>\n*> /MYSQL PRO\\\n COPY \"mysql-procedures.cpy\".\n*> /MYSQL-END\\\n*>\n ba998-Free.\n     move     20 to ws-No-Paragraph.\n*>      /MYSQL FREE\\\n*>\n*>    Free result array\n*>\n*>             TABLE=IRSNL-REC\n           MOVE TP-IRSNL-REC TO WS-MYSQL-RESULT\n           CALL \"MySQL_free_result\" USING WS-MYSQL-RESULT end-call\n*>      /MYSQL-END\\\n *>    move     zero to Most-Cursor-Set.\n     set Cursor-Not-Active to true.\n*>\n ba999-end.\n*>  Any Clean ups before quiting    move data record ?????  do so at the start as well ??????\n*>\n     if       Testing-1\n              perform Ca-Process-Logs\n     end-if.\n*>\n ba999-exit.\n     exit program.\n*>\n bb000-HV-Load      Section.\n*>*************************\n*>\n*>  Load the Host variables with data from the passed record\n*>\n*> This Method loads the Host Variables for the Base table with\n*> the data passed in the data-buffer.\n*>\n     initialize TD-IRSNL-REC.\n     move     NL-Key                   to HV-KEY-1.\n     move     NL-Tipe                  to HV-TIPE.\n     if       NL-Pointer numeric\n          and NL-Pointer > zero\n              move     NL-Pointer      to HV-REC-POINTER\n     else\n              move     NL-Name         to HV-NL-NAME\n              move     NL-DR           to HV-DR\n              move     NL-CR           to HV-CR\n              move     NL-AC           to HV-AC\n              move     DR-Last-01      to HV-DR-LAST-01\n              move     CR-Last-01      to HV-CR-LAST-01\n              move     DR-Last-02      to HV-DR-LAST-02\n              move     CR-Last-02      to HV-CR-LAST-02\n              move     DR-Last-03      to HV-DR-LAST-03\n              move     CR-Last-03      to HV-CR-LAST-03\n              move     DR-Last-04      to HV-DR-LAST-04\n              move     CR-Last-04      to HV-CR-LAST-04\n     end-if.\n*>\n*> Loading HVs implies a non-Fetch action. RGs are handled separately for\n*> all such actions so they must not be loaded here.\n*>\n bb000-Exit.\n     exit section.\n*>\n bb100-UnloadHVs    Section.\n*>*************************\n*>\n*>  Load the data buffer in the interface with data from the host variables.\n*> (init moved lower)\n*>\n*> NULL fields must not be returned in the buffer. SQL filters each column to\n*>  ensure it has a proper value.  This saves using indicator variables.\n*>\n     initialize WS-IRSNL-Record.\n*>\n     move     HV-KEY-1                    to NL-Key.\n     move     HV-TIPE                     to NL-Tipe.\n     if       HV-REC-POINTER > zero\n              move     HV-REC-POINTER     to NL-Pointer\n     else\n              move     HV-NL-NAME         to NL-Name\n              move     HV-DR              to NL-Dr\n              move     HV-CR              to NL-Cr\n              move     HV-AC              to NL-AC\n              move     HV-DR-LAST-01      to DR-Last-01\n              move     HV-DR-LAST-02      to DR-Last-02\n              move     HV-DR-LAST-03      to DR-Last-03\n              move     HV-DR-LAST-04      to DR-Last-04\n              move     HV-CR-LAST-01      to CR-Last-01\n              move     HV-CR-LAST-02      to CR-Last-02\n              move     HV-CR-LAST-03      to CR-Last-03\n              move     HV-CR-LAST-04      to CR-Last-04\n     end-if.\n*>\n bb100-Exit.\n     exit section.\n*>\n bb200-Insert Section.\n*>*******************\n*>\n*>  /MYSQL INSERT\\\n*>\n*>    Insert a row\n*>\n*>         TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           MOVE 1 TO WS-MYSQL-I\n           STRING 'INSERT INTO '\n                    '`IRSNL-REC` SET '\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`KEY-1`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-KEY-1\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(03:18))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`TIPE`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-TIPE,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`NL-NAME`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-NL-NAME,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-01`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-01\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-01`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-01\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-02`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-02\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-02`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-02\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-03`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-03\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-03`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-03\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-04`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-04\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-04`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-04\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`AC`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-AC,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`REC-POINTER`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-REC-POINTER\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING \";\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING X\"00\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n       PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>  /MYSQL-END\\\n       .     *> period here\n*>\n bb200-Exit.\n     exit section.\n*>\n bb300-Update Section.\n*>*******************\n*>\n*>  /MYSQL UPDATE\\\n*>\n*>    Update a row\n*>\n*>      TABLE=IRSNL-REC\n           INITIALIZE WS-MYSQL-COMMAND\n           MOVE 1 TO WS-MYSQL-I\n           STRING 'UPDATE '\n                    '`IRSNL-REC` SET '\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`KEY-1`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-KEY-1\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(03:18))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`TIPE`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-TIPE,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`NL-NAME`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-NL-NAME,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-01`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-01\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-01`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-01\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-02`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-02\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-02`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-02\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-03`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-03\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-03`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-03\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`DR-LAST-04`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-DR-LAST-04\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`CR-LAST-04`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-CR-LAST-04\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING \".\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING WS-MYSQL-EDIT(22:02)\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`AC`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (HV-AC,TRAILING)\n                  '\"'\n                   INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           STRING ', 'INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n*>\n           STRING '`REC-POINTER`=\"' INTO WS-MYSQL-COMMAND\n                   WITH POINTER WS-MYSQL-I end-string\n           MOVE HV-REC-POINTER\n             TO WS-MYSQL-EDIT\n           STRING FUNCTION TRIM (WS-MYSQL-EDIT(13:08))\n             INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           STRING '\"' INTO WS-MYSQL-COMMAND\n           WITH POINTER WS-MYSQL-I end-string\n           STRING \" WHERE \"\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n           STRING FUNCTION TRIM (WS-Where (1:J))\n              INTO WS-MYSQL-COMMAND\n              WITH POINTER WS-MYSQL-I end-string\n           STRING \";\" X\"00\" INTO WS-MYSQL-COMMAND\n             WITH POINTER WS-MYSQL-I end-string\n           PERFORM MYSQL-1210-COMMAND THRU MYSQL-1219-EXIT\n*>  /MYSQL-END\\\n       .     *> period here\n*>\n bb300-Exit.\n     exit section.\n*>\n Ca-Process-Logs.\n*>**************\n*>\n     call     \"fhlogger\" using File-Access\n                               ACAS-DAL-Common-data.\n*>\n ca-Exit.     exit.\n*>\nend program irsnominalMT.",
        "line": 793
      }
    ],
    "evaluates": [
      {
        "content": "File-Function\n        when  1\n              go to ba020-Process-Open\n        when  2\n              g...",
        "line": 301,
        "whenCount": 11
      },
      {
        "content": "Access-Type     *>  x shows used in irs.\n              when  5                           *>x fn-equa...",
        "line": 691,
        "whenCount": 5
      }
    ],
    "validations": []
  },
  "complexity": {
    "mccabe": 34,
    "cognitive": 36,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 88,
      "totalOperators": 94,
      "totalOperands": 188,
      "vocabulary": 89,
      "length": 282,
      "volume": 1826.1568275325242
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
