{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl",
  "fileName": "acasconvert2.cbl",
  "timestamp": "2025-09-15T16:25:33.886Z",
  "programId": "acasconvert2",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": false,
    "errors": [
      "/Users/MartinGonella/Desktop/Demos/ACAS/copybooks/selsys.cob:4: error: file system-file: RELATIVE KEY rrn must be unsigned",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:383: error: 'Old-System-Record' is not defined",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:386: error: 'System-Record' is ambiguous; needs qualification",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:392: error: STRING item 'A' must be USAGE DISPLAY or NATIONAL",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:395: error: STRING item 'B' must be USAGE DISPLAY or NATIONAL",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:430: error: 'System-Record-Ver-Prime IN System-Record' is not defined",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:431: error: 'System-Record-Version-Secondary IN System-Record' is ambiguous; needs qualification",
      "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:435: error: 'System-Record-Version-Prime IN System-Record' is ambiguous; needs qualification",
      "Cannot read properties of undefined (reading 'total')"
    ],
    "warnings": []
  },
  "parseErrors": [
    "/Users/MartinGonella/Desktop/Demos/ACAS/copybooks/selsys.cob:4: error: file system-file: RELATIVE KEY rrn must be unsigned",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:383: error: 'Old-System-Record' is not defined",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:386: error: 'System-Record' is ambiguous; needs qualification",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:392: error: STRING item 'A' must be USAGE DISPLAY or NATIONAL",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:395: error: STRING item 'B' must be USAGE DISPLAY or NATIONAL",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:430: error: 'System-Record-Ver-Prime IN System-Record' is not defined",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:431: error: 'System-Record-Version-Secondary IN System-Record' is ambiguous; needs qualification",
    "/Users/MartinGonella/Desktop/Demos/ACAS/common/acasconvert2.cbl:435: error: 'System-Record-Version-Prime IN System-Record' is ambiguous; needs qualification",
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "configuration",
        "line": 66
      },
      {
        "name": "input-output",
        "line": 69
      },
      {
        "name": "file",
        "line": 74
      },
      {
        "name": "working-storage",
        "line": 78
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 70
      },
      {
        "name": "AA000-Start",
        "line": 375
      },
      {
        "name": "AA010-Read",
        "line": 414
      },
      {
        "name": "Disk-Error-Display",
        "line": 451
      },
      {
        "name": "Disk-Error",
        "line": 458
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "&",
        "line": 30,
        "replacing": null
      },
      {
        "name": "of",
        "line": 60,
        "replacing": null
      },
      {
        "name": "selsys",
        "line": 71,
        "replacing": null
      },
      {
        "name": "fdsys",
        "line": 75,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 91,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "Disk-Error-Display",
        "thru": null,
        "line": 441
      },
      {
        "target": "Disk-error",
        "thru": null,
        "line": 456
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "spaces",
        "to": "Display-Blk\n              string \"Old and new system record size not equal, Old = \"\n                                    delimited by size\n                     A              delimited by size\n                     \" \"            delimited by size\n                     \"New Rec = \"   delimited by size\n                     B              delimited by size    into Display-Blk\n              end-string\n              display Display-Blk at 2301 with erase eol\n              display \"ST901 Note error and hit return\" at 2401 with erase eol\n              accept FS-Reply at 2433\n              stop run\n     end-if\n*>\n     open     i-o system-file",
        "line": 389
      },
      {
        "from": "1",
        "to": "rrn",
        "line": 415
      },
      {
        "from": "1",
        "to": "System-Record-Ver-Prime in System-Record",
        "line": 430
      },
      {
        "from": "3",
        "to": "System-Record-Version-Secondary in System-Record",
        "line": 431
      },
      {
        "from": "1",
        "to": "rrn",
        "line": 438
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "NOT REPLACE WITH YOUR CURRENT ONE COPY & PASTE FROM COPYBOOKS\n*>      IN THE SOURCE DIRECTORY.\n*>\n*>      These fields are not encrypted but can be if required using any 3rd\n*>      party tool.\n*>\n*>   WARNING:\n*>    TAKE A BACK UP OF YOUR DATA FILES BEFORE RUNNING - twice.\n*>    TAKE A BACK UP OF YOUR DATA FILES BEFORE RUNNING - YES twice.\n*>\n*>    Test with cobc flag -Wcorresponding\n*>\n*>*************************************************************************\n*>\n*> Copyright Notice.\n*>*****************\n*>\n*> This file/program is part of the Applewood Computers Accounting System\n*>   and is copyright (c) Vincent B Coen. 1976 - 2025 and later.\n*>\n*> This program is free software; you can redistribute it and/or modify it\n*> under the terms of the GNU General Public License as published by the\n*> Free Software Foundation; version 2 ONLY.\n*>\n*> Cobxref is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endevor\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>*************************************************************************\n*>\n environment division.\n configuration section.\n source-computer.        Linux.\n object-computer.        Linux.\n input-output section.\n file-control.\n copy \"selsys.cob\".\n\n data division.\n file section.\n copy \"fdsys.cob\".\n*>\n*>\n working-storage section.\n 77  prog-name          pic x(18)  value \"IRSconv2 (1.01.03)\".\n 01  fs-reply           pic 99.\n 01  rec-count          pic 9(4)   value zero.\n 01  A                  pic s9(4)     comp    value zero.\n 01  B                  pic s9(4)     comp    value zero.\n 01  Rrn                binary-long.\n 01  Display-Blk        pic x(78)             value spaces.\n*>\n 01  Error-Messages.\n     03  SY103    pic x(22) value \"SY103 Rewrite Err 1 = \".\n     03  SY104    pic x(26) value \"SY104 Fix and Press Enter\".\n*>\n copy \"wsnames.cob\".\n*>\n*> 25/06/16 vbc - Added RDBMS-Port & needs RDBMS-Host, RDBMS-Socket.\n*>                Increased 'System-data' from 384 to 512 bytes & removed O/E\n*>                  Block (128) as it is unused.\n*> 26/06/16 vbc - Updated MySQL Load scripts ACASDB.sql in ACAS/mysql.\n*>                  Prima is yet to be done !!!\n*> 19/10/16 vbc - Changed PL-Approp-AC in IRS block from 9(5) to 9(6) for GL\n*>                support & reduced filler by 1.\n*>                With IRS data mapped into ACAS the IRS block can reduce to 32 bytes\n*>                Just need to change all of the IRS programs to use ACAS fields but\n*>                also NEED to change the date processing to use same in rest of ACAS\n*>                and not binary days since 01/01/2000 and hold dates in dd/mm/yy form.\n*>                Added 2 88s to Op-System for IRS.\n*> 27/10/16 vbc - Changed level-5 to IRS instead of omitted O/E.\n*>\n 01  System-Record.\n*>******************\n*>   System Data   *\n*>******************\n     03  System-Data-Block.                                  *>   384 changed to 512 bytes (25/06/16)\n         05  System-Record-Version-Prime      binary-char.   *>  1\n         05  System-Record-Version-Secondary  binary-char.   *>  3  Updated 25/08/16\n         05  Vat-Rates                    comp.\n             07 Vat-Rate-1   pic 99v99.                      *> Standard rate\n             07 Vat-Rate-2   pic 99v99.                      *> Reduced rate\n             07 Vat-Rate-3   pic 99v99.                      *> Minimal or exempt\n             07 Vat-Rate-4   pic 99v99.   *> 2b used for local sales tax   Not UK\n             07 Vat-Rate-5   pic 99v99.   *> 2b used for local sales tax   Not UK\n         05  Vat-Rate redefines Vat-Rates pic 99v99 comp occurs 5.\n         05  Cyclea          binary-char.  *> 99.\n         05  Scycle Redefines cyclea  binary-char.\n         05  Period          binary-char.  *> 99.\n         05  Page-Lines      binary-char  unsigned. *> 999.\n         05  Next-Invoice    binary-long. *> 9(8) comp.\n         05  Run-Date        binary-long. *> 9(8) comp.\n         05  Start-Date      binary-long. *> 9(8) comp.\n         05  End-Date        binary-long. *> 9(8) comp.\n         05  Suser.                             *> IRS\n             07  Usera       pic x(32).\n         05  User-Code       pic x(32).   *> encrypted username not used on OS versions so also b 4 client?\n         05  Address-1       pic x(24).\n         05  Address-2       pic x(24).\n         05  Address-3       pic x(24).\n         05  Address-4       pic x(24).\n         05  Post-Code       pic x(12).   *> or ZipCode size should cover all countries\n         05  Country         pic x(24).\n         05  Print-Spool-Name pic x(48).\n         05  File-Statuses.\n             07  File-Status pic 9          occurs 32.\n         05  Pass-Value      pic 9.\n         05  Level.\n             07  Level-1     pic 9.\n                 88  G-L                    value 1.   *> General (Nominal) ledger\n             07  Level-2     pic 9.\n                 88  B-L                    value 1.   *> Purchase (Payables) ledger\n             07  Level-3     pic 9.\n                 88  S-L                    value 1.   *> Sales (Receivables) ledger\n             07  Level-4     pic 9.\n                 88  Stock                  value 1.   *> Stock Control (Inventory)\n             07  Level-5     pic 9.\n                 88  IRS                    value 1.   *> IRS used (instead of General).\n             07  Level-6     pic 9.\n                 88  Payroll                value 1.   *> Payroll\n         05  Pass-Word       pic x(4).                 *>\n         05  Host            pic 9.\n             88  Multi-User                 value 1.\n         05  Op-System       pic 9.\n             88  valid-os-type            values 1 2 3 4 5 6.\n             88  No-OS                    value zero.\n             88  Dos                        value 1.\n             88  Windows                    value 2.\n             88  Mac                        value 3.\n             88  Os2                        value 4.\n             88  Unix                       value 5.\n             88  Linux                      value 6.\n             88  OS-Single                  values 1 2 4.\n         05  Current-Quarter pic 9.\n         05  RDBMS-Flat-Statuses.\n             07  File-System-Used  pic 9.\n                 88  FS-Cobol-Files-Used        value zero.\n                 88  FS-RDBMS-Used              value 1.\n*>                 88  FS-Oracle-Used             value 1.  *> THESE NOT IN USE\n*>                 88  FS-MySql-Used              value 2.  *> ditto\n*>                 88  FS-Postgres-Used           value 3.  *> ditto\n*>                 88  FS-DB2-Used                value 4.  *> ditto\n*>                 88  FS-MS-SQL-Used             value 5.  *> ditto\n                 88  FS-Valid-Options           values 0 thru 1.    *> 5. (not in use unless 1-5)\n             07  File-Duplicates-In-Use pic 9.\n                 88  FS-Duplicate-Processing    value 1.\n         05  Maps-Ser.      *> Not needed in OpenSource version, = 9999 (No Maintainence Contract]\n             07  Maps-Ser-xx pic xx.        *> Allows for 36^2 * 100 customers\n             07  Maps-Ser-nn binary-short.  *>       =  129600 - 2\n         05  Date-Form       pic 9.\n             88  Date-UK                    value 1.            *> dd/mm/yyyy\n             88  Date-USA                   value 2.            *> mm/dd/yyyy\n             88  Date-Intl                  value 3.            *> yyyy/mm/dd\n             88  Date-Valid-Formats         values 1 2 3.\n         05  Data-Capture-Used pic 9.\n             88  DC-Cobol-Standard          value zero.\n             88  DC-GUI                     value 1.\n             88  DC-Widget                  value 2.\n         05  RDBMS-DB-Name   pic x(12)      value \"ACASDB\".     *> change in setup\n         05  RDBMS-User      pic x(12)      value \"ACAS-User\".  *> change in setup\n         05  RDBMS-Passwd    pic x(12)      value \"PaSsWoRd\".   *> change in setup\n         05  VAT-Reg-Number  pic x(11)      value spaces.\n         05  Param-Restrict  pic x.                             *> Only via ACAS?\n         05  RDBMS-Port      pic x(5)       value \"3306\".       *> change in setup\n         05  RDBMS-Host      pic x(32)      value spaces.       *> change in setup\n         05  RDBMS-Socket    pic x(64)      value spaces.       *> change in setup v3\n         05  filler          pic x(34).                         *> for expansion v3\n*>***************\n*>   G/L Data   *\n*>***************\n     03  General-Ledger-Block.               *> 80 bytes\n         05  P-C             pic x.\n             88  Profit-Centres             value \"P\".\n             88  Branches                   value \"B\".\n         05  P-C-Grouped     pic x.\n             88  Grouped                    value \"Y\".\n         05  P-C-Level       pic x.\n             88  Revenue-Only               value \"R\".\n         05  Comps           pic x.\n             88  Comparatives               value \"Y\".\n         05  Comps-Active    pic x.\n             88  Comparatives-Active        vaLUE \"Y\".\n         05  M-V             pic x.\n             88  Minimum-Validation         vaLUE \"Y\".\n         05  Arch            pic x.\n             88  Archiving                  value \"Y\".\n         05  Trans-Print     pic x.\n             88  Mandatory                  value \"Y\".\n         05  Trans-Printed   pic x.\n             88  Trans-Done                 value \"Y\".\n         05  Header-Level    pic 9.\n         05  Sales-Range     pic 9.\n         05  Purchase-Range  pic 9.\n         05  Vat             pic x.\n             88  Auto-Vat                   value \"Y\".\n         05  Batch-Id        pic x.\n             88  Preserve-Batch             value \"Y\".\n         05  Ledger-2nd-Index pic x.                     *> But file uses SINGLE INDEX only ???\n             88  Index-2                    value \"Y\".\n         05  IRS-Instead     pic x.\n             88  IRS-Used                   value \"Y\".\n             88  IRS-Both-Used              value \"B\".   *> 26/11/16\n         05  Ledger-Sec      binary-short.  *> 9(4) comp\n         05  Updates         binary-short.  *> 9(4) comp\n         05  Postings        binary-short.  *> 9(4) comp\n         05  Next-Batch      binary-short.  *> 9(4) comp  should be unsigned used for all ledgers\n         05  Extra-Charge-Ac binary-long.   *> 9(8) comp\n         05  Vat-Ac          binary-long.   *> 9(8) comp\n         05  Print-Spool-Name2 pic x(48).\n*>******************\n*>   P(B)/L Data   *\n*>******************\n     03  Purchase-Ledger-Block.              *> 88 bytes\n         05  Next-Folio      binary-long.   *> 9(8) comp\n         05  BL-Pay-Ac       binary-long.   *> 9(8) comp\n         05  P-Creditors     binary-long.   *> 9(8) comp\n         05  BL-Purch-Ac     binary-long.   *> 9(8) comp\n         05  BL-End-Cycle-Date binary-long.   *> 9(8) comp\n         05  BL-Next-Batch   binary-short.   *> 9(4) comp  should be unsigned - unused ?\n         05  Age-To-Pay      binary-char.   *> 9(4) comp should be unsigned\n         05  Purchase-Ledger pic x.\n             88  P-L-Exists                 value \"Y\".\n         05  PL-Delim        pic x.\n         05  Entry-Level     pic 9.\n         05  P-Flag-A        pic 9.\n         05  P-Flag-I        pic 9.\n         05  P-Flag-P        pic 9.\n         05  PL-Stock-Link   pic x.\n         05  Print-Spool-Name3 pic x(48).\n         05  filler          pic x(10).\n*>***************\n*>   S/L Data   *\n*>***************\n     03  Sales-Ledger-Block.                 *> 128 bytes\n         05  Sales-Ledger    pic x.\n             88  S-L-Exists                 value \"Y\".\n         05  SL-Delim        pic x.\n         05  Oi-3-Flag       pic x.             *> 'Y' used in sl060 why?\n         05  Cust-Flag       pic x.\n         05  Oi-5-Flag       pic x.\n         05  S-Flag-Oi-3     pic x.             *> 'z' when otm3 created, used in sl060 why? NO LONGER USED\n         05  Full-Invoicing  pic 9.\n         05  S-Flag-A        pic 9.             *> '1' used in sl060 why?\n         05  S-Flag-I        pic 9.             *> '2' used in sl060 why?\n         05  S-Flag-P        pic 9.\n         05  SL-Dunning      pic 9.\n         05  SL-Charges      pic 9.\n         05  Sl-Own-Nos      pic x.\n         05  SL-Stats-Run    pic 9.\n         05  Sl-Day-Book     pic 9.\n         05  invoicer        pic 9.\n             88  I-Level-0                  value 0.  *> show totals only (no net & vat) not used?\n             88  I-Level-1                  value 1.  *> Show net, vat\n             88  I-Level-2                  value 2.  *> show Details + vat etc looks wrong in sl910 totals only (no net & vat)\n             88  Not-Invoicing              value 9.  *> show totals only (no net & vat) but not found yet nor level 3 (see sl900)\n         05  Extra-Desc      pic x(14).\n         05  Extra-Type      pic x.\n             88  Discount                   value \"D\".\n             88  Charge                     value \"C\".\n         05  Extra-Print     pic x.\n         05  SL-Stock-Link   pic x.\n         05  SL-Stock-Audit  pic x.\n             88  Stock-Audit-On             value \"Y\".   *> Invoicing will create an audit record (15/05/13)\n         05  SL-Late-Per     pic 99v99    comp.\n         05  SL-Disc         pic 99v99    comp.\n         05  Extra-Rate      pic 99v99    comp.\n         05  SL-Days-1       binary-char.  *> 999  comp.\n         05  SL-Days-2       binary-char.  *> 999  comp.\n         05  SL-Days-3       binary-char.  *> 999  comp.\n         05  SL-Credit       binary-char.  *> 999  comp.\n         05  filler          binary-short.   *> No longer used.\n         05  SL-Min          binary-short.  *> 9999  comp.\n         05  SL-Max          binary-short.  *> 9999  comp.\n         05  PF-Retention    binary-short.  *> 9999  comp.\n         05  First-Sl-Batch  binary-short.  *> 9999  comp.   *>unused ?\n         05  First-Sl-Inv    binary-long.   *> 9(8) comp.\n         05  SL-Limit        binary-long.   *> 9(8) comp.\n         05  SL-Pay-Ac       binary-long.   *> 9(8) comp.\n         05  S-Debtors       binary-long.   *> 9(8) comp.\n         05  SL-Sales-Ac     binary-long.   *> 9(8) comp.\n         05  S-End-Cycle-Date binary-long.   *> 9(8) comp.\n         05  SL-Comp-Head-Pick Pic x.\n             88  SL-Comp-Pick               value \"Y\".\n         05  SL-Comp-Head-Inv  pic x.\n             88  SL-Comp-Inv                value \"Y\".\n         05  SL-Comp-Head-Stat pic x.\n             88  SL-Comp-Stat               value \"Y\".\n         05  SL-Comp-Head-Lets pic x.\n             88  SL-Comp-Lets               value \"Y\".\n         05  SL-VAT-Printed  pic x.\n             88  SL-VAT-Prints              value \"Y\".\n         05  filler          pic x(45).      *>  just in case\n*>***************\n*> Stock Data   *\n*>***************\n*>\n     03  Stock-Control-Block.                *> 88 bytes\n         05  Stk-Abrev-Ref   pic x(6).\n         05  Stk-Debug       pic 9.          *> T/F (1/0).\n         05  Stk-Manu-Used   pic 9.          *> T/F (Bomp/Wip)\n         05  Stk-OE-Used     pic 9.          *> T/F.\n         05  Stk-Audit-Used  pic 9.          *> T/F.\n         05  Stk-Mov-Audit   pic 9.          *> T/F.\n         05  Stk-Period-Cur  pic x.          *> M=Monthly, Q=Quarterly, Y=Yearly\n         05  Stk-Period-dat  pic x.          *>  --  ditto  --\n         05  filler          pic x.          *> was stk-date-form\n         05  Stock-Control   pic x.\n             88  Stock-Control-Exists   value \"Y\".\n         05  Stk-Averaging   pic 9.          *> T/F.\n             88  Stock-Averaging        value 1.\n         05  Stk-Activity-Rep-Run pic 9.     *> T/F.  =17 bytes 0=no, 1=add, 2=del, 3=both\n         05  filler          pic x.          *> slack byte\n         05  Stk-Page-Lines  binary-char unsigned.  *> 9999 comp. Taken from Print-Lines\n         05  Stk-Audit-No    binary-char unsigned.  *> 9999 comp.\n         05  filler          pic x(68).             *> 64    (just in case)\n*>     03  Order-Entry-Block.                         *> 128 bytes\n*>         05  filler-Dummy    pic x(128).          *> space moved to System block as un-used v1.2\n     03  IRS-Entry-Block.                       *> NEW 12/06/13\n         05  Client             pic x(24).      *>              24      *> Not needed as will use suser\n         05  Next-Post          pic 9(5).       *>              29                                                  N   5\n         05  Vat-Rates2.                                             *> these can be replaced by the other VAT blk\n             07  vat1           pic 99v99.      *>              33   *> Standard  changed from vat (11/06/13)\n             07  vat2           pic 99v99.      *>              37   *> reduced 1 [not yet used]\n             07  vat3           pic 99v99.      *>              41   *> reduced 2 [not yet used]\n         05  Vat-Group redefines Vat-Rates2.\n             07  Vat-Psent      pic 99v99    occurs 3.\n         05  IRS-Pass-Value     pic 9.           *>             42  (Was Pass-Value in IRS system file)\n         05  Save-Sequ          pic 9.           *>             43\n         05  System-Work-Group  pic x(18).       *>             61\n         05  PL-App-Created     pic x.           *>             62\n         05  PL-Approp-AC6      pic 9(6).        *>             68   changed for GL support if needed ?. Both needed in RDB\n         05  filler redefines PL-Approp-AC6.\n             07  PL-Approp-AC   pic 9(5).        *>                   For IRS\n             07  filler         pic 9.\n         05  1st-Time-Flag      pic 9.           *>             69    (was First-Time-Flag in IRS system file)      N  32\n         05  filler             pic x(59).       *>             128  Old fn-1 to 5 files\n     03  IRS-Data-Block redefines IRS-Entry-Block.\n         05  filler-dummy4   pic x(128).\n*>\n procedure division.\n AA000-Start.\n*>\n*>   1st check that the record is exactly the same size for old and new\n*>     if not STOP\n*>\n*>\n     display  \" \" at 0101 with erase eos.\n     move     function Length (\n                               Old-System-Record\n                                                ) to A.\n     move     function length (\n                               System-Record\n                                               ) to B.\n     if       A not = B\n              move spaces to Display-Blk\n              string \"Old and new system record size not equal, Old = \"\n                                    delimited by size\n                     A              delimited by size\n                     \" \"            delimited by size\n                     \"New Rec = \"   delimited by size\n                     B              delimited by size    into Display-Blk\n              end-string\n              display Display-Blk at 2301 with erase eol\n              display \"ST901 Note error and hit return\" at 2401 with erase eol\n              accept FS-Reply at 2433\n              stop run\n     end-if\n*>\n     open     i-o system-file.\n     if       fs-reply not = zero\n              display \"Error on opening i-o System File \" fs-reply\n              display \"ST901 Note error and hit return\"\n              accept FS-Reply\n              stop run.\n*>\n*> now clear of any possible problems with the file - hopefully!\n*>\n     Display  prog-name \" Starts\".\n*>\n AA010-Read.\n     move     1  to  rrn.\n     read     system-file into Old-System-Record.\n     if       fs-reply not = zero\n              display \"Record 1 NOT found - Aborting err code = \", fs-reply\n              stop \" Read above msg and hit return to continue !\"\n              close system-file\n              stop run.\n*>\n     initialize System-Record.                  *> in case of new fields\n     move     corresponding Old-System-Record to System-Record.\n*>\n *> TEST WITH COBC FLAG -Wcorresponding should see (new) RDB fields\n*>\n*>     Now V1.3\n*>\n     move     1   to System-Record-Ver-Prime in System-Record.\n     move     3   to System-Record-Version-Secondary in System-Record.\n*>\n*>== just to confirm versions is now 1.3\n*>\n    display   \" new Version is \" System-Record-Version-Prime     in System-Record\n              \".\"                System-Record-Version-Secondary in System-Record.\n*>\n     move     1 to rrn.\n     rewrite  System-Record.\n*>\n     perform  Disk-Error-Display.\n*>\n     close    system-file.\n     if       fs-reply = zero\n              display \"System (Cobol flat) File Conversion completed \"\n              display \" Remember to go through system setup to confirm all data\"\n              stop    \" Hit return to close \".\n*>\n     stop     run.\n*>\n Disk-Error-Display.\n     if       fs-reply not = zero\n              display SY103 at 0310 with erase eos\n              display fs-reply at 0334\n              display \" \" at 0401\n              perform Disk-error.\n*>\n Disk-Error.\n     display  SY104 at 2401.\n     accept   fs-reply at 2428.\n*>",
        "line": 30
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 2,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 7,
      "totalOperators": 5,
      "totalOperands": 10,
      "vocabulary": 8,
      "length": 15,
      "volume": 45
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
