{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/purchase/pl010.cbl",
  "fileName": "pl010.cbl",
  "timestamp": "2025-09-15T16:25:47.859Z",
  "programId": "pl010",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 117
      },
      {
        "name": "file",
        "line": 131
      },
      {
        "name": "working-storage",
        "line": 137
      },
      {
        "name": "linkage",
        "line": 343
      },
      {
        "name": "screen",
        "line": 352
      },
      {
        "name": "init01",
        "line": 484
      },
      {
        "name": "Report-Supplier",
        "line": 567
      },
      {
        "name": "test-escape",
        "line": 582
      },
      {
        "name": "display-heading",
        "line": 600
      },
      {
        "name": "customer-display",
        "line": 637
      },
      {
        "name": "exit",
        "line": 668
      },
      {
        "name": "display-outline",
        "line": 670
      },
      {
        "name": "Customer-Data",
        "line": 681
      },
      {
        "name": "validate-address",
        "line": 722
      },
      {
        "name": "accept-key",
        "line": 745
      },
      {
        "name": "setup-suppliers",
        "line": 790
      },
      {
        "name": "amend-supplier",
        "line": 892
      },
      {
        "name": "Evaluate-Message",
        "line": 1013
      },
      {
        "name": "delete-supplier",
        "line": 1022
      },
      {
        "name": "display-suppliers",
        "line": 1092
      },
      {
        "name": "report-selection",
        "line": 1134
      },
      {
        "name": "produce-report",
        "line": 1193
      },
      {
        "name": "report-heading-setup",
        "line": 1383
      },
      {
        "name": "plcreate",
        "line": 1480
      },
      {
        "name": "zz050-Validate-Date",
        "line": 1519
      },
      {
        "name": "exit",
        "line": 1556
      },
      {
        "name": "zz060-Convert-Date",
        "line": 1558
      },
      {
        "name": "exit",
        "line": 1591
      },
      {
        "name": "zz070-Convert-Date",
        "line": 1593
      },
      {
        "name": "exit",
        "line": 1621
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 121
      },
      {
        "name": "file-defs",
        "line": 482
      },
      {
        "name": "menu-return",
        "line": 506
      },
      {
        "name": "menu-input",
        "line": 512
      },
      {
        "name": "menu-exit",
        "line": 547
      },
      {
        "name": "maps03",
        "line": 552
      },
      {
        "name": "maps09",
        "line": 557
      },
      {
        "name": "clear-error-line",
        "line": 562
      },
      {
        "name": "main-end",
        "line": 574
      },
      {
        "name": "get-escape",
        "line": 587
      },
      {
        "name": "cd-exit",
        "line": 667
      },
      {
        "name": "Customer-Data-Main",
        "line": 684
      },
      {
        "name": "end-if",
        "line": 714
      },
      {
        "name": "end-if",
        "line": 785
      },
      {
        "name": "customer-input",
        "line": 803
      },
      {
        "name": "customer-accept",
        "line": 809
      },
      {
        "name": "customer-details",
        "line": 833
      },
      {
        "name": "get-details",
        "line": 852
      },
      {
        "name": "main-output",
        "line": 861
      },
      {
        "name": "WS-Delivery-Record",
        "line": 880
      },
      {
        "name": "main-end",
        "line": 883
      },
      {
        "name": "customer-input",
        "line": 905
      },
      {
        "name": "customer-accept",
        "line": 910
      },
      {
        "name": "get-details",
        "line": 922
      },
      {
        "name": "main-output",
        "line": 930
      },
      {
        "name": "end-if",
        "line": 973
      },
      {
        "name": "end-if",
        "line": 988
      },
      {
        "name": "end-if",
        "line": 1001
      },
      {
        "name": "main-end",
        "line": 1004
      },
      {
        "name": "customer-input",
        "line": 1029
      },
      {
        "name": "customer-accept",
        "line": 1036
      },
      {
        "name": "get-details",
        "line": 1047
      },
      {
        "name": "main-output",
        "line": 1072
      },
      {
        "name": "main-end",
        "line": 1082
      },
      {
        "name": "customer-input",
        "line": 1099
      },
      {
        "name": "customer-accept",
        "line": 1104
      },
      {
        "name": "accept-of-show",
        "line": 1116
      },
      {
        "name": "main-end",
        "line": 1124
      },
      {
        "name": "accept-data",
        "line": 1148
      },
      {
        "name": "read-loop",
        "line": 1210
      },
      {
        "name": "test-num",
        "line": 1274
      },
      {
        "name": "headings",
        "line": 1294
      },
      {
        "name": "listing",
        "line": 1314
      },
      {
        "name": "notes-print",
        "line": 1357
      },
      {
        "name": "end-report",
        "line": 1370
      },
      {
        "name": "main-end",
        "line": 1373
      },
      {
        "name": "plcreate-Main",
        "line": 1483
      },
      {
        "name": "zz050-test-date",
        "line": 1550
      },
      {
        "name": "zz050-exit",
        "line": 1555
      },
      {
        "name": "zz060-Exit",
        "line": 1590
      },
      {
        "name": "zz070-Exit",
        "line": 1620
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 555,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "maps09",
        "line": 560,
        "type": "DYNAMIC",
        "using": [
          "customer-code"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1378,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 107,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 116,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 124,
        "replacing": null
      },
      {
        "name": "seldel",
        "line": 125,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 126,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 134,
        "replacing": null
      },
      {
        "name": "fddel",
        "line": 135,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 136,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 140,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 141,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 142,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 143,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 246,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 260,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 314,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 315,
        "replacing": null
      },
      {
        "name": "statement",
        "line": 318,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 346,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 347,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 348,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 1016,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 1623,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "plcreate",
        "thru": null,
        "line": 504
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 510
      },
      {
        "target": "setup-suppliers",
        "thru": null,
        "line": 531
      },
      {
        "target": "amend-supplier",
        "thru": null,
        "line": 534
      },
      {
        "target": "delete-supplier",
        "thru": null,
        "line": 537
      },
      {
        "target": "report-supplier",
        "thru": null,
        "line": 540
      },
      {
        "target": "display-suppliers",
        "thru": null,
        "line": 543
      },
      {
        "target": "Report-Selection",
        "thru": null,
        "line": 570
      },
      {
        "target": "Report-Heading-Setup",
        "thru": null,
        "line": 571
      },
      {
        "target": "Produce-Report",
        "thru": null,
        "line": 572
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 576
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 577
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 610
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 659
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 664
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 673
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 690
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 702
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 761
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 767
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 775
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 795
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 796
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 807
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 819
      },
      {
        "target": "maps09",
        "thru": null,
        "line": 822
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 827
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 830
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 855
      },
      {
        "target": "customer-data",
        "thru": null,
        "line": 856
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 859
      },
      {
        "target": "Purch-Write",
        "thru": null,
        "line": 870
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 877
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 886
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 887
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 897
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 898
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 908
      },
      {
        "target": "accept-key",
        "thru": null,
        "line": 912
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 925
      },
      {
        "target": "customer-data",
        "thru": null,
        "line": 926
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 928
      },
      {
        "target": "Purch-Rewrite",
        "thru": null,
        "line": 939
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 949
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 953
      },
      {
        "target": "Delivery-Rewrite",
        "thru": null,
        "line": 963
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 967
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 978
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 982
      },
      {
        "target": "Purch-Rewrite",
        "thru": null,
        "line": 991
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 995
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1007
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1008
      },
      {
        "target": "Purch-Open",
        "thru": null,
        "line": 1026
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 1027
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 1032
      },
      {
        "target": "accept-key",
        "thru": null,
        "line": 1039
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1050
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1053
      },
      {
        "target": "purch-Rewrite",
        "thru": null,
        "line": 1067
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 1078
      },
      {
        "target": "Purch-Delete",
        "thru": null,
        "line": 1080
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1086
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1087
      },
      {
        "target": "Delivery-Open-Input",
        "thru": null,
        "line": 1096
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 1097
      },
      {
        "target": "display-outline",
        "thru": null,
        "line": 1102
      },
      {
        "target": "accept-key",
        "thru": null,
        "line": 1106
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1114
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1120
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1128
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1129
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 1138
      },
      {
        "target": "Delivery-Open-Input",
        "thru": null,
        "line": 1139
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1182
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1198
      },
      {
        "target": "Purch-Start",
        "thru": null,
        "line": 1205
      },
      {
        "target": "Purch-Read-Next",
        "thru": null,
        "line": 1213
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1234
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1242
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1250
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1259
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1267
      },
      {
        "target": "listing",
        "thru": null,
        "line": 1271
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1318
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1345
      },
      {
        "target": "notes-print",
        "thru": null,
        "line": 1350
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 1360
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 1386
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 1484
      },
      {
        "target": "Purch-Open-Output",
        "thru": null,
        "line": 1496
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1502
      },
      {
        "target": "Delivery-Open-Output",
        "thru": null,
        "line": 1504
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1510
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1513
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1514
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 1553
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 1567
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 488
      },
      {
        "from": "prog-name",
        "to": "l1-version",
        "line": 493
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 494
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 498
      },
      {
        "from": "space",
        "to": "Print-Out",
        "line": 499
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 501
      },
      {
        "from": "zero",
        "to": "menu-reply",
        "line": 509
      },
      {
        "from": "spaces",
        "to": "d24-02 d24-check",
        "line": 605
      },
      {
        "from": "\"]\"",
        "to": "d24-03",
        "line": 606
      },
      {
        "from": "ws-date",
        "to": "ws-local-date\n              display ws-date at 0171 with foreground-color 2",
        "line": 611
      },
      {
        "from": "\"]\"",
        "to": "d24-02\n              move space to d24-03\n       else\n        if    menu-reply = 2\n              display \"Supplier Record Amendment\" at 0129 with foreground-color 2\n        else\n         if   menu-reply = 3\n              display \"Supplier Record Deletion\"  at 0129 with foreground-color 2\n         else\n          if  menu-reply = 5\n              display \"Supplier Record Display\"   at 0129 with foreground-color 2",
        "line": 622
      },
      {
        "from": "purch-unapplied",
        "to": "display-bal",
        "line": 651
      },
      {
        "from": "purch-current",
        "to": "display-bal",
        "line": 654
      },
      {
        "from": "purch-last-inv",
        "to": "u-bin\n              perform zz060-Convert-Date\n              display u-date at 2217 with foreground-color 3",
        "line": 658
      },
      {
        "from": "purch-last-pay",
        "to": "u-bin\n              perform zz060-Convert-Date\n              display u-date at 2317 with foreground-color 3",
        "line": 663
      },
      {
        "from": "spaces",
        "to": "a01-Notes",
        "line": 675
      },
      {
        "from": "zero",
        "to": "error-flag",
        "line": 685
      },
      {
        "from": "purch-address",
        "to": "test-address",
        "line": 689
      },
      {
        "from": "1",
        "to": "error-flag\n     else\n              display \" \" at 0766 with erase eol",
        "line": 694
      },
      {
        "from": "WS-Purch-Key",
        "to": "Deliv-Purchase-Key\n              move \"N\"       to WS-Deliv-Key-Type\n              perform Delivery-Delete       *> delete delivery-file invalid key\n              if      fs-reply not = zero\n                      move zero to Purch-Notes-Tag\n              end-if\n     end-if\n*>\n*>  yes I know, but just in case!!\n*>\n     if       A01-Notes = spaces\n              move zero to Purch-Notes-Tag\n     else\n              move 1 to Purch-Notes-Tag\n     end-if",
        "line": 700
      },
      {
        "from": "zero",
        "to": "a",
        "line": 725
      },
      {
        "from": "zero",
        "to": "truth\n     else\n              move  1  to  truth",
        "line": 730
      },
      {
        "from": "zero",
        "to": "a",
        "line": 734
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 740
      },
      {
        "from": "spaces",
        "to": "WS-Purch-Key",
        "line": 748
      },
      {
        "from": "zero",
        "to": "error-code",
        "line": 753
      },
      {
        "from": "999",
        "to": "error-code\n              go to  main-exit",
        "line": 756
      },
      {
        "from": "zero",
        "to": "save-notes-tag",
        "line": 759
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 760
      },
      {
        "from": "spaces",
        "to": "customer-code\n              go to  main-exit",
        "line": 764
      },
      {
        "from": "WS-Purch-Key",
        "to": "customer-code",
        "line": 768
      },
      {
        "from": "WS-Purch-Key",
        "to": "Deliv-Purchase-Key\n              move     \"N\"       to WS-Deliv-Key-Type\n              perform  Delivery-Read-Indexed       *>  read  delivery-file record invalid key\n              if       fs-reply not = zero\n                          move zero  to  Purch-Notes-tag\n                          move \"Record Not Found\" to A01-Notes-1\n                          move spaces             to A01-Notes-2\n              else                      *>       not invalid key\n                          move Deliv-Address to A01-Notes\n                          move 1     to save-notes-tag\n                                        Purch-Notes-tag\n              end-if                               *> end-read\n     end-if",
        "line": 773
      },
      {
        "from": "spaces",
        "to": "a01-Notes",
        "line": 806
      },
      {
        "from": "spaces",
        "to": "customer-nos",
        "line": 812
      },
      {
        "from": "\"C\"",
        "to": "maps09-reply",
        "line": 821
      },
      {
        "from": "customer-code",
        "to": "WS-Purch-Key",
        "line": 826
      },
      {
        "from": "1",
        "to": "purch-status",
        "line": 847
      },
      {
        "from": "customer-code",
        "to": "WS-Purch-Key",
        "line": 848
      },
      {
        "from": "run-date",
        "to": "purch-create-date",
        "line": 849
      },
      {
        "from": "age-to-pay",
        "to": "purch-credit",
        "line": 850
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 858
      },
      {
        "from": "WS-Purch-Key",
        "to": "deliv-Purchase-key\n              move   \"N\"       to WS-Deliv-Key-Type\n              move   spaces    to deliv-name\n              move   A01-Notes to deliv-address\n              perform  Delivery-Write",
        "line": 873
      },
      {
        "from": "Purch-Notes-Tag",
        "to": "save-Notes-Tag",
        "line": 920
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 927
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 941
      },
      {
        "from": "WS-Purch-Key",
        "to": "deliv-Purchase-key",
        "line": 942
      },
      {
        "from": "spaces",
        "to": "deliv-name",
        "line": 943
      },
      {
        "from": "A01-Notes",
        "to": "deliv-address",
        "line": 944
      },
      {
        "from": "\"K\"",
        "to": "escape-code",
        "line": 1052
      },
      {
        "from": "zero",
        "to": "purch-status\n              perform  purch-Rewrite",
        "line": 1066
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1076
      },
      {
        "from": "WS-Purch-Key",
        "to": "Deliv-Purchase-Key",
        "line": 1077
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 1119
      },
      {
        "from": "spaces",
        "to": "cust-in status-in credit-op invoice-op\n                        average-op overdue-op enter-date-op\n                        enter-date-in print-out",
        "line": 1141
      },
      {
        "from": "zero",
        "to": "credit-in invoice-in average-in overdue-in ws-enter-date",
        "line": 1145
      },
      {
        "from": "cust-in",
        "to": "customer-in",
        "line": 1153
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1180
      },
      {
        "from": "enter-date-in",
        "to": "ws-test-date",
        "line": 1181
      },
      {
        "from": "u-bin",
        "to": "ws-enter-date",
        "line": 1187
      },
      {
        "from": "u-date",
        "to": "enter-date-in",
        "line": 1188
      },
      {
        "from": "zero",
        "to": "a",
        "line": 1197
      },
      {
        "from": "customer-in",
        "to": "WS-Purch-Key",
        "line": 1202
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1204
      },
      {
        "from": "1",
        "to": "a",
        "line": 1207
      },
      {
        "from": "credit-in",
        "to": "test-1\n              move  purch-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1231
      },
      {
        "from": "invoice-in",
        "to": "test-1\n              move  purch-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1239
      },
      {
        "from": "average-in",
        "to": "test-1\n              move  purch-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1247
      },
      {
        "from": "overdue-in",
        "to": "test-1\n              subtract purch-last-inv from run-date giving test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1256
      },
      {
        "from": "ws-enter-date",
        "to": "test-1\n              move  purch-create-date to  test-2\n              move  enter-date-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1264
      },
      {
        "from": "1",
        "to": "truth\n     else\n              move  0  to  truth",
        "line": 1278
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1284
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1288
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1292
      },
      {
        "from": "a",
        "to": "l1-page",
        "line": 1298
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1",
        "line": 1302
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1310
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 1312
      },
      {
        "from": "WS-Purch-Key",
        "to": "l6-key",
        "line": 1319
      },
      {
        "from": "\"Active\"",
        "to": "l6-status\n     else\n              move  \"Dormant\" to  l6-status",
        "line": 1322
      },
      {
        "from": "spaces",
        "to": "l6-phone",
        "line": 1326
      },
      {
        "from": "purch-name",
        "to": "l6-name",
        "line": 1327
      },
      {
        "from": "purch-address",
        "to": "l7-address",
        "line": 1328
      },
      {
        "from": "purch-phone",
        "to": "l6-phone\n     else\n              move  1 to y\n              string purch-phone delimited by \"  \" into l6-phone with pointer y\n              subtract 1 from y\n              string \"x\"         delimited by size\n                     purch-ext   delimited by size  into l6-phone with pointer y",
        "line": 1331
      },
      {
        "from": "purch-fax",
        "to": "l6-fax",
        "line": 1339
      },
      {
        "from": "purch-limit",
        "to": "l6-limit",
        "line": 1340
      },
      {
        "from": "purch-credit",
        "to": "l6-credit",
        "line": 1341
      },
      {
        "from": "purch-discount",
        "to": "l6-discount",
        "line": 1342
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1352
      },
      {
        "from": "\"Y\"",
        "to": "Print-Out",
        "line": 1355
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1358
      },
      {
        "from": "WS-Purch-Key",
        "to": "Deliv-Purchase-Key",
        "line": 1359
      },
      {
        "from": "spaces",
        "to": "l7-address",
        "line": 1364
      },
      {
        "from": "ws-date",
        "to": "l3-date",
        "line": 1387
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 1388
      },
      {
        "from": "1",
        "to": "y",
        "line": 1389
      },
      {
        "from": "spaces",
        "to": "l3-report",
        "line": 1390
      },
      {
        "from": "credit-in",
        "to": "cr-days\n              string  credit-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 1416
      },
      {
        "from": "invoice-in",
        "to": "act-days\n              string  active-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 1429
      },
      {
        "from": "average-in",
        "to": "av-days\n              string  average-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 1442
      },
      {
        "from": "overdue-in",
        "to": "ov-days\n              string  overdue-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 1455
      },
      {
        "from": "enter-date-in",
        "to": "ed-date\n              string  enter-date-heading  delimited by size into  l3-report  with  pointer  y",
        "line": 1468
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 1487
      },
      {
        "from": "\"Y\"",
        "to": "purchase-ledger",
        "line": 1515
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 1532
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1534
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 1538
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 1545
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 1551
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1552
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 1569
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 1571
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1574
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 1578
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1585
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 1601
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 1604
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 1608
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 1615
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selpl.cob\".\n*> copy \"seldel.cob\".\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n*> copy \"fdpl.cob\".\n*> copy \"fddel.cob\".\n copy \"fdprint.cob\".\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"PL010 (3.02.17)\".\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps09.cob\".\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  a               pic 999.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  error-flag      pic 9           value zero.\n     03  escape-code     pic x.\n     03  save-notes-tag  binary-long.\n     03  print-out       pic x.\n     03  truth           pic 9.\n       88  a-true   value  1.\n       88  a-false  value  0.\n     03  d24-02          pic x           value space.\n     03  d24-03          pic x           value space.\n     03  d24-check.\n         05  filler      pic x(13)       value \"Check Digit {\".\n         05  d24-digit   pic x           value space.\n         05  filler      pic x           value \"}\".\n     03  A01-Notes.\n         05  a01-Notes-1     pic x(48)       value spaces.\n         05  a01-Notes-2     pic x(48)       value spaces.\n     03  cust-in         pic x(6)        value spaces.\n     03  status-in       pic x           value space.\n     03  credit-in       pic 99          value zero.\n     03  credit-op       pic x           value space.\n     03  invoice-in      pic 9(5)        value zero.\n     03  invoice-op      pic x           value space.\n     03  average-in      pic 9(5)        value zero.\n     03  average-op      pic x           value space.\n     03  overdue-in      pic 9(5)        value zero.\n     03  overdue-op      pic x           value space.\n     03  enter-date-in   pic x(10)       value spaces.\n     03  enter-date-op   pic x           value space.\n     03  ws-Local-Date   pic x(10)       value spaces.\n     03  ws-Test-Date    pic x(10).\n     03  test-1          binary-long.\n     03  test-2          binary-long.\n     03  test-op         pic x.\n     03  credit-heading.\n       05  cr-operand    pic xx.\n       05  cr-days       pic z9.\n       05  filler        pic x(12)       value  \" Days Credit\".\n     03  active-heading.\n       05  act-operand   pic xx.\n       05  act-days      pic zzzz9.\n       05  filler        pic x(9)        value  \" Invoices\".\n     03  average-heading.\n       05  av-operand    pic xx.\n       05  av-days       pic zzzz9.\n       05  filler        pic x(10)       value  \" Av. Value\".\n     03  overdue-heading.\n       05  ov-operand    pic xx.\n       05  ov-days       pic zzzz9.\n       05  filler        pic x(13)       value \" Days Overdue\".\n     03  enter-date-heading.\n       05  ed-operand    pic xx.\n       05  ed-date       pic x(8).\n       05  filler        pic x(11)       value  \" Entry Date\".\n     03  ws-enter-date   binary-long     value zero.\n     03  address-line    pic x(32).\n     03  display-bal     pic -(8)9.99.\n     03  test-address    pic x(92).\n     03  ws-spaces-30                    value spaces.\n         05  ws-spaces-7 pic x(7).\n         05  ws-spaces-13 pic x(13).\n         05  filler      pic x(10).\n     03  ws-eval-msg     pic x(25)       value spaces.\n     03  intest          pic x.\n     03  line-cnt        binary-char     value zero.\n     03  customer-in     pic x(7).\n     03  ws-env-lines    pic 999         value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  error-code          pic 999.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Cbl-File-Details.\n     03  Cbl-File-Size       pic x(8)  comp-x  value zero.\n     03  Cbl-File-Date.\n         05  Cbl-File-Day    pic x     comp-x  value zero.\n         05  Cbl-File-Mth    pic x     comp-x  value zero.\n         05  Cbl-File-Year   pic xx    comp-x  value zero.\n     03  Cbl-File-time.\n         05  Cbl-File-Hour   pic x     comp-x  value zero.\n         05  Cbl-File-Min    pic x     comp-x  value zero.\n         05  Cbl-File-Sec    pic x     comp-x  value zero.\n         05  Cbl-File-Hund   pic x     comp-x  value zero.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  PL002          pic x(31) value \"PL002 Note error and hit return\".\n     03  PL004          pic x(16) value \"PL004 Hit return\".\n     03  PL005          pic x(18) value \"PL005 Invalid Date\".\n*> Module specific\n     03  PL101          pic x(14) value \"PL101 Addr Err\".\n     03  PL102          pic x(31) value \"PL102 Supplier Record Not Found\".\n     03  PL103          pic x(52) value \"PL103 Purchase Ledger files have not been set up yet\".\n     03  PL104          pic x(44) value \"PL104 Do you wish to create them (Y/N) ? [ ]\".\n     03  PL105          pic x(40) value \"PL105 Creating Purchase & Delivery Files\".\n     03  PL106          pic x(34) value \"PL106 Opening Purchase file gives \".\n     03  PL107          pic x(34) value \"PL107 Opening Delivery file gives \".\n     03  PL108          pic x(34) value \"PL108 Abort Or Recover (A/R) : [ ]\".\n     03  PL109          pic x(51) value \"PL109 <<<Can not Delete currently active account>>>\".\n     03  PL110          pic x(36) value \"PL110 Supplier Record Already Exists\".\n*>\n 01  line-1.\n     03  l1-version      pic x(57)       value spaces.\n     03  filler          pic x(67)       value \"Supplier Listing\".\n     03  filler          pic x(5)        value \"Page \".\n     03  l1-page         pic zz9.\n*>\n 01  line-3.\n     03  l3-user         pic x(40).\n     03  filler          pic x(12)       value  \"Report On : \".\n     03  l3-report       pic x(70)       value  spaces.\n     03  l3-date         pic x(10).\n*>\n 01  line-4.\n     03  filler          pic x(51)       value \"Supplier  Status    <----------------Name & Address\".\n     03  filler          pic x(51)       value \"---------------->   ----Telephone---- -----Fax-----\".\n     03  filler          pic x(30)       value \"    ----Credit----   Discount \".\n*>\n 01  line-5.\n     03  filler          pic x(87)       value \" Number   ------\".\n     03  filler          pic x(45)       value \"                   Limit   Period       %\".\n*>\n 01  line-6.\n     03  l6-key          pic x(10).\n     03  l6-status       pic x(10).\n     03  l6-name         pic x(51).\n     03  l6-phone        pic x(18).\n     03  l6-fax          pic x(13).\n     03  l6-limit        pic z(8)9          blank when zero.\n     03  l6-credit       pic z(7)9          blank when zero.\n     03  l6-discount     pic z(7)9.99       blank when zero.\n*>\n 01  line-7.\n     03  filler          pic x(20)        value spaces.\n     03  l7-address      pic x(112).\n*>\n copy \"wspl.cob\".\n copy \"wsdel.cob\".\n*>\n*> REMARK OUT ANY IN USE - These have to be entered for each prog in P/L\n*>  and cannot be used via a COPY statement as some lines need to be remd out\n*>   for all files in use by this program.\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n screen section.\n*>=============\n*>\n*>   ALL Adjusted left 5 chars 11/12/11\n*>\n 01  display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  value \"Supplier Nos : [\"    line  4 col  1.\n*> >>>>>>>> customer no here <<<<<<<\n     03  from d24-02          pic x  line  4 col 23.\n     03  from d24-03          pic x          col 24.\n     03  from d24-check       pic x(15)      col 26.\n     03  value \"Supplier Name: [\"    line  6 col  1.\n     03  using Purch-name  pic x(30) line  6 col 17.\n     03  value \"]\"                   line  6 col 47.\n     03  value \"Addr: [\"             line  7 col 10.\n     03  using Purch-addr1 pic x(48)         col 17.\n     03  value \"]\"                   line  7 col 65.\n     03  value \"[\"                   line  8 col 16.\n     03  using Purch-addr2    pic x(48)      col 17.\n     03  value \"]\"                   line  8 col 65.\n     03  value \"Suppliers Bank Details\"\n                                     line  9 col  1.\n     03  value \"Sort Code  : [\"      line 10 col  3.\n     03  using Purch-SortCode pic 9(6)       col 17.\n     03  value \"]\"                           col 23.\n     03  value \"Account No : [\"      line 11 col  3.\n     03  using Purch-AccountNo pic 9(8)      col 17.\n     03  value \"]\"                           col 25.\n     03  value \"Supplier Note: [\"    line 12 col  1.\n     03  using a01-Notes-1    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"[\"                   line 13 col 16.\n     03  using a01-Notes-2    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"Telephone    : [\"    line 14 col  1.\n     03  using Purch-phone    pic x(13)      col 17.\n     03  value \"]\"                           col 30.\n     03  value \"Ext: [\"                      col 32.\n     03  using Purch-ext      pic x(4)       col 38.\n     03  value \"]\"                           col 42.\n     03  value \"Fax : [\"                     col 45.\n     03  using Purch-fax      pic x(13)      col 52.\n     03  value \"]\"                           col 65.\n     03  value \"Email Sales  : [\"    line 15 col  1.\n     03  using Purch-email    pic x(30)      col 17.\n     03  value \"]\"                           col 47.\n     03  value \"Credit Period: [\"    line 18 col  1.\n     03  using Purch-credit   pic 99         col 17.\n     03  value \"]\"                           col 19.\n     03  value \"Credit limit : [\"    line 19 col  1.\n     03  using Purch-limit    pic 9(7)       col 17.\n     03  value \"] Discount : [\"              col 24.\n     03  using Purch-discount pic 99.99      col 38.\n     03  value \"]\"                           col 43.\n     03  value \"*******************\" line 19 col 56.\n     03  value \"Unapplied Bal: {\"    line 20 col  1.\n     03  value \"}\"                           col 29.\n     03  value \"* Escape Code [\"     line 20 col 56.\n*> value entered by individual display\n     03  value \"] *\"                         col 72.\n     03  value \"Current Bal  : {\"    line 21 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 29.\n     03  value \"* <B> = Back      *\"         col 56.\n     03  value \"Last invoice : {\"    line 22 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 27.\n     03  value \"* <S> = Save      *\"         col 56.\n     03  value \"Last payment : {\"    line 23 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 27.\n     03  value \"* <Q> = Quit      *\" line 23 col 56.\n     03  value \"*******************\" line 24 col 56.\n*>\n 01  display-03                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  from prog-name  pic x(15)                 line  1 col  1\n                                                    blank screen.\n     03  value \"Supplier File\"                             col 34.\n     03  from ws-Local-Date   pic x(10)            line  1 col 71.\n     03  value \"Report Attributes\"                 line  3 col 32.\n*>\n*> Adjusted left 6 chars 11/12/11\n*>\n     03  value \"Supplier Number - [\"               line  8 col  3.\n     03  using cust-in   pic x(6)                          col 22.\n     03  value \"]\"                                         col 28.\n     03  value \"Enter characters in positions to match\"    col 33.\n     03  value \"Status          - [\"               line 10 col  3.\n     03  using status-in pic x                             col 22.\n     03  value \"]\"                                         col 23.\n     03  value \"<L> Live;<D> Dormant;< > All\"              col 33.\n     03  value \"Credit Period   - [\"               line 12 col  3.\n     03  using credit-in pic 99                            col 22.\n     03  value \"]  [\"                                      col 24.\n     03  using credit-op pic x                             col 28.\n     03  value \"]\"                                 line 12 col 29.\n     03  value \"Enter number of days & operator\"           col 33.\n     03  value \"<L>  for credit periods < than\"    line 13 col 37.\n     03  value \"<G>  for credit periods > than\"    line 14 col 37.\n     03  value \"<E>  for credit periods = to\"      line 15 col 37.\n     03  value \"Invoice Activity  [\"               line 17 col  3.\n     03  using invoice-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using invoice-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter number of orders & operator\"       col 33.\n     03  value \"Average Value   - [\"               line 19 col  3.\n     03  using average-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using average-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter order value & operator\"            col 33.\n     03  value \"Overdue A/Cs    - [\"               line 21 col  3.\n     03  using overdue-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using overdue-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter number of days & operator\"           col 33.\n     03  value \"Date Entered-[\"                    line 23 col  3.\n     03  using enter-date-in pic x(10)                     col 17.\n     03  value \"] [\"                                       col 27.\n     03  using enter-date-op pic x                         col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter date & operator\"                     col 33.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n init01 section.\n*>\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     move     prog-name to l1-version.\n     move     to-day to u-date.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     space to Print-Out.\n*>\n     move     1  to File-Key-No.\n*>\n     if       not p-l-exists\n              perform plcreate.\n*>\n menu-return.\n*>**********\n*>\n     move     zero  to  menu-reply.\n     perform  display-heading.\n*>\n menu-input.\n*>*********\n*>\n     display  \"Select one of the following by number :- [ ]\"   at 0701 with foreground-color 2.\n     display  \"(1)  Set-up Supplier records\" at 1004     with foreground-color 2.\n     display  \"(2)  Amend Supplier records\" at 1204      with foreground-color 2.\n     display  \"(3)  Delete Supplier records\" at 1404     with foreground-color 2.\n     display  \"(4)  Print Supplier records\" at 1604      with foreground-color 2.\n     display  \"(5)  Display Supplier records\" at 1804    with foreground-color 2.\n     display  \"(9)  Return to system menu\" at 2104       with foreground-color 2.\n     accept   menu-reply at 0743 with foreground-color 6 auto.\n*>\n     if       menu-reply = 9\n              go to  menu-exit.\n*>\n     if       menu-reply  <  1  or  >  5\n              go to  menu-input.\n*>\n     if       menu-reply = 1\n              perform setup-suppliers\n     else\n      if      menu-reply = 2\n              perform amend-supplier\n      else\n       if     menu-reply = 3\n              perform delete-supplier\n       else\n        if    menu-reply = 4\n              perform  report-supplier\n        else\n         if   menu-reply = 5\n              perform display-suppliers.\n*>\n     go      to menu-return.\n*>\n menu-exit.\n*>********\n*>\n     exit     program.\n*>\n maps03.\n*>*****\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps09.\n*>*****\n*>\n     call     \"maps09\"  using  customer-code.\n*>\n clear-error-line.\n*>***************\n*>\n     display  \" \" at line ws-23-lines col 01 with erase eol.\n*>\n Report-Supplier         section.\n*>==============================\n*>\n     perform  Report-Selection.\n     perform  Report-Heading-Setup.\n     perform  Produce-Report.\n*>\n main-end.\n*>\n     perform  Purch-Close.     *>   close    purchase-file delivery-file.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n test-escape  section.\n*>===================\n*>\n     display  escape-code at 2071 with foreground-color 6.\n*>\n get-escape.\n*>*********\n*>\n     accept   escape-code at 2071 with foreground-color 6 update.\n     move     function upper-case (escape-code) to escape-code.\n*>\n     if       escape-code not = \"B\" and not = \"S\" and not = \"Q\"\n                      and not = \"K\" and not = \"D\"\n              go to get-escape.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n display-heading         section.\n*>==============================\n*>\n     display  \" \" at 0101 with erase eos.\n*>\n     move     spaces to d24-02 d24-check.\n     move     \"]\" to d24-03.\n*>\n     if       menu-reply not = 4\n              display prog-name at 0101 with foreground-color 2\n              perform zz070-convert-date\n              move    ws-date to ws-local-date\n              display ws-date at 0171 with foreground-color 2.\n*>\n     if       menu-reply = zero\n              display \"Supplier File Set-Up & Maintenance\" at 0124 with foreground-color 2\n              display \"Function  Menu\" at 0434                     with foreground-color 2\n              go to main-exit\n     else\n       if     menu-reply = 1\n              display \"Supplier Record Creation\"  at 0129 with foreground-color 2\n              move \"Check Digit { }\" to d24-check\n              move \"]\" to d24-02\n              move space to d24-03\n       else\n        if    menu-reply = 2\n              display \"Supplier Record Amendment\" at 0129 with foreground-color 2\n        else\n         if   menu-reply = 3\n              display \"Supplier Record Deletion\"  at 0129 with foreground-color 2\n         else\n          if  menu-reply = 5\n              display \"Supplier Record Display\"   at 0129 with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n customer-display   section.\n*>*************************\n*>\n     if       menu-reply = 1\n              move WS-Purch-Key (7:1) to d24-digit\n*>              move check-digit of WS-Purch-Key to d24-digit\n     else\n              move WS-Purch-Key (7:1) to d24-02.\n*>              move check-digit of WS-Purch-Key to d24-02.\n*>\n     display  display-02.\n     if       menu-reply = 1 or 2\n              go to cd-exit.\n*>\n     move     purch-unapplied to display-bal.\n     display  display-bal at 2017 with foreground-color 3.\n*>\n     move     purch-current  to  display-bal.\n     display  display-bal at 2117 with foreground-color 3.\n*>\n     if       purch-last-inv not = zero\n              move purch-last-inv  to  u-bin\n              perform zz060-Convert-Date\n              display u-date at 2217 with foreground-color 3.\n*>\n     if       purch-last-pay not = zero\n              move purch-last-pay  to  u-bin\n              perform zz060-Convert-Date\n              display u-date at 2317 with foreground-color 3.\n*>\n cd-exit.\n     exit     section.\n*>\n display-outline         section.\n*>==============================\n*>\n     perform  display-heading.\n     initialize WS-Purch-Record WS-Delivery-Record.\n     move     spaces to a01-Notes.\n     display  display-02.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n Customer-Data           section.\n*>==============================\n*>\n Customer-Data-Main.\n     move     zero to error-flag.\n     display  display-02.\n     accept   display-02.\n*>\n     move     purch-address  to  test-address.\n     perform  validate-address.\n*>\n     if       a-false\n              display PL101 at 0766 with foreground-color 4\n              move 1 to error-flag\n     else\n              display \" \" at 0766 with erase eol.\n*>\n     if       A01-Notes = spaces\n         and  Purch-Notes-Tag not = zero\n              move WS-Purch-Key to Deliv-Purchase-Key\n              move \"N\"       to WS-Deliv-Key-Type\n              perform Delivery-Delete       *> delete delivery-file invalid key\n              if      fs-reply not = zero\n                      move zero to Purch-Notes-Tag\n              end-if\n     end-if\n*>\n*>  yes I know, but just in case!!\n*>\n     if       A01-Notes = spaces\n              move zero to Purch-Notes-Tag\n     else\n              move 1 to Purch-Notes-Tag\n     end-if.\n*>\n     if       error-flag not = zero\n              go to customer-data-Main.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n validate-address        section.\n*>==============================\n*>\n     move     zero  to  a.\n*>\n     inspect  test-address  tallying a for all pl-delim.\n*>\n     if       a  >  4  or  <  1\n              move  zero  to  truth\n     else\n              move  1  to  truth.\n*>\n     move     zero  to  a.\n     inspect  test-address tallying a for characters before initial pl-delim.\n*>\n*> Check for basic report/label limits\n*>\n     if       a  >  30\n              move  zero  to  truth.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n accept-key              section.\n*>==============================\n*>\n     move     spaces to WS-Purch-Key.\n*>\n     accept   WS-Purch-Key at 0417 with foreground-color 3.\n     move     function upper-case (WS-Purch-Key) to WS-Purch-Key.\n*>\n     move     zero  to  error-code.\n*>\n     if       WS-Purch-Key = spaces\n              move  999  to  error-code\n              go to  main-exit.\n*>\n     move     zero to save-notes-tag.               *> force clear\n     move     1 to File-Key-No.\n     perform  Purch-Read-Indexed.       *> read     purchase-file record invalid key\n     if       FS-reply = 21\n              display PL102  at 2301\n              move spaces to  customer-code\n              go to  main-exit.\n*>\n     perform  clear-error-line.\n     move     WS-Purch-Key  to  customer-code.\n*>\n*>  Check for Notes\n*>\n     if       Purch-Notes-Tag not = zero\n              move     WS-Purch-Key to Deliv-Purchase-Key\n              move     \"N\"       to WS-Deliv-Key-Type\n              perform  Delivery-Read-Indexed       *>  read  delivery-file record invalid key\n              if       fs-reply not = zero\n                          move zero  to  Purch-Notes-tag\n                          move \"Record Not Found\" to A01-Notes-1\n                          move spaces             to A01-Notes-2\n              else                      *>       not invalid key\n                          move Deliv-Address to A01-Notes\n                          move 1     to save-notes-tag\n                                        Purch-Notes-tag\n              end-if                               *> end-read\n     end-if.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n setup-suppliers         section.\n*>==============================\n*>\n *>    open     i-o purchase-file.\n *>    open     i-o delivery-file.\n     perform  Purch-Open.\n     perform  Delivery-Open.\n *>     if       fs-reply not = zero\n *>              close delivery-file\n *>             open output delivery-file        *> OC doesnt create in i-o mode\n *>             close delivery-file\n *>             open  i-o delivery-file.\n*>\n customer-input.\n*>*************\n*>\n     move     spaces to a01-Notes.\n     perform  display-outline.\n*>\n customer-accept.\n*>**************\n*>\n     move     spaces to customer-nos.\n     accept   customer-nos at 0417 with foreground-color 3.\n     if       customer-nos = spaces\n              go to  main-end.\n     move     function upper-case (customer-nos) to customer-nos.\n     display  customer-nos at 0417 with foreground-color 3.\n*>\n     perform  clear-error-line.\n*>\n     move     \"C\"  to  maps09-reply.\n     perform  maps09.\n     if       maps09-reply not = \"Y\"\n              go to  customer-accept.\n*>\n     move     customer-code  to  WS-Purch-Key.\n     perform  Purch-Read-Indexed.               *> read purchase-file not invalid key  *> Therefore, Record already exists\n     if       FS-Reply not = 21\n              display PL110  at 2301\n              perform  customer-display\n              go       to customer-accept.\n*>\n customer-details.\n*>***************\n*>\n     if       menu-reply = 1\n              display check-digit of maps09-ws at 0444  with foreground-color 3.\n*>\n*>  this bit is different from sl010 as well ??\n*>\n     subtract 2 from ws-23-lines giving y.\n     display  ws-spaces-30 at line y col 6.\n     add      1 to y.\n     display  ws-spaces-30 at line y col 6.\n     display  ws-spaces-30 at line ws-23-lines col 6.\n     initialize WS-Purch-Record  WS-Delivery-Record.\n     move     1              to purch-status.\n     move     customer-code  to WS-Purch-Key.\n     move     run-date       to purch-create-date.\n     move     age-to-pay     to purch-credit.\n*>\n get-details.\n*>***********\n*>\n     perform  customer-display.\n     perform  customer-data.\n*>\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>***********\n*>\n     if       escape-code = \"B\"\n              go to get-details.\n*>\n     if       escape-code = \"Q\"\n              go to  main-end.\n*>\n     perform  Purch-Write.    *>  write    purch-record.\n*>\n     if       Purch-Notes-Tag not = zero\n              move   WS-Purch-Key to deliv-Purchase-key\n              move   \"N\"       to WS-Deliv-Key-Type\n              move   spaces    to deliv-name\n              move   A01-Notes to deliv-address\n              perform  Delivery-Write.       *>  write  delivery-record.\n*>\n     initialize WS-Purch-Record\n                WS-Delivery-Record.\n     go       to customer-input.\n*>\n main-end.\n*>*******\n*>\n     perform  Purch-Close.      *> close    purchase-file delivery-file.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n amend-supplier         section.\n*>=============================\n*>\n *>    open     i-o  purchase-file.\n *>    open     i-o  delivery-file.\n     perform  Purch-Open.\n     perform  Delivery-Open.\n *>    if       fs-reply not = zero\n *>             close delivery-file\n *>             open output delivery-file\n *>             close delivery-file\n *>             open i-o delivery-file.\n*>\n customer-input.\n*>**************\n*>\n     perform  display-outline.\n*>\n customer-accept.\n*>\n     perform  accept-key.\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n     move     Purch-Notes-Tag     to  save-Notes-Tag.\n*>\n get-details.\n*>**********\n*>\n     perform  customer-display.\n     perform  customer-data.\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>**********\n*>\n     if       escape-code = \"B\"\n              go to get-details.\n*>\n     if       escape-code = \"Q\"\n              go to  customer-input.\n*>\n     perform  Purch-Rewrite.   *> rewrite  purch-record.\n*>\n     move     \"N\"         to WS-Deliv-Key-Type.\n     move     WS-Purch-Key   to deliv-Purchase-key.\n     move     spaces      to deliv-name.\n     move     A01-Notes   to deliv-address.\n*>\n     if       Purch-Notes-Tag not = zero\n        and   save-notes-tag = zero\n *>             write  delivery-record invalid key      *> THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Write\n              if     fs-reply not = zero\n                     display \"write notes tag \" at line ws-23-lines col 1\n                     display fs-reply  at line ws-23-lines col 20\n                     perform evaluate-message\n                     display ws-Eval-Msg at line ws-23-lines col 23\n                     display PL002 at line ws-lines col 1\n                     accept  Accept-Reply at line ws-lines col 20\n                     display \" \" at line ws-23-lines col 1 with erase eos\n *>             end-write\n              end-if\n     else\n      if      Purch-Notes-Tag not = zero\n *>             rewrite delivery-record invalid key      *> THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Rewrite\n              if      fs-reply not = zero\n                      display \"Rewrite notes tag \" at line ws-23-lines col 1\n                      display fs-reply\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display PL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos\n *>             end-rewrite.\n              end-if.\n*>\n     if       Purch-Notes-Tag = zero\n       and    save-notes-tag  not = zero\n *>             delete  delivery-file record invalid key      *> THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Delete\n              if      fs-reply not = zero\n                      display \"Delete notes tag \" at line ws-23-lines col 1\n                      display fs-reply\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display PL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos\n *>             end-delete.\n              end-if.\n*>\n  *>    rewrite  Purch-record invalid key                                 *> tags should be set already\n     perform  Purch-Rewrite.\n     if       fs-reply not = zero\n              display \"Rewrite Sales Rec \" at line ws-23-lines col 1\n              display fs-reply\n              perform evaluate-message\n              display ws-Eval-Msg at line ws-23-lines col 23\n              display PL002       at line ws-lines col 1\n              accept  Accept-Reply at line ws-lines col 20\n              display \" \" at line ws-23-lines col 1 with erase eos\n *>    end-rewrite\n     end-if.\n     go       to customer-input.\n*>\n main-end.\n*>*******\n*>\n     perform  Purch-Close.    *>  close    purchase-file delivery-file.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n Evaluate-Message        Section.\n*>==============================\n*>\n copy \"FileStat-Msgs.cpy\" replacing MSG by ws-Eval-Msg\n                                    STATUS by fs-reply.\n*>\n Eval-Msg-Exit.  exit section.\n*>************   ************\n*>\n delete-supplier         section.\n*>==============================\n*>\n *>    open     i-o  purchase-file delivery-file.\n     perform  Purch-Open.\n     perform  Delivery-Open.\n*>\n customer-input.\n*>*************\n*>\n     perform  display-outline.\n     display  \"D> = Dormant\" at 2159 with foreground-color 2.\n     display  \"K> = Kill \" at 2259 with foreground-color 2.\n*>\n customer-accept.\n*>**************\n*>\n     perform  accept-key.\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n get-details.\n*>**********\n*>\n     perform  customer-display.\n*>\n     move     \"K\"  to   escape-code.\n     perform  test-escape.\n*>\n     if       escape-code = \"Q\"\n              go to  main-end.\n*>\n     if       purch-current not = zero\n           or purch-unapplied not = zero\n              display PL109  at 0501 with foreground-color 4\n              go to  customer-accept.\n*>\n     display  \" \" at 0501 with erase eol.\n*>\n     if       escape-code = \"D\"\n              move  zero  to  purch-status\n              perform  purch-Rewrite.    *>  rewrite  purch-record.\n*>\n     if       escape-code not =  \"K\"\n              go to  customer-input.\n*>\n main-output.\n*>**********\n*>\n     if       Purch-Notes-tag  not = zero\n              move     \"N\"       to WS-Deliv-Key-Type.\n              move     WS-Purch-Key to Deliv-Purchase-Key.\n              perform  Delivery-Delete.       *>  delete   delivery-file.\n*>\n     perform  Purch-Delete.      *>  delete   purchase-file.\n*>\n main-end.\n*>*******\n*>\n *>    close    purchase-file delivery-file.\n     perform  Purch-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n display-suppliers       section.\n*>==============================\n*>\n *>    open     input  purchase-file delivery-file.\n     perform  Delivery-Open-Input.\n     perform  Purch-Open-Input.\n*>\n customer-input.\n*>*************\n*>\n     perform  display-outline.\n*>\n customer-accept.\n*>\n     perform  accept-key.\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n     perform  customer-display.\n*>\n accept-of-show.\n*>*************\n*>\n     move     \"S\" to escape-code.\n     perform  test-escape.\n     if       ws-reply not = \"Q\"\n              go to  customer-input.\n*>\n main-end.\n*>*******\n*>\n *>    close    purchase-file delivery-file.\n     perform  Purch-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-selection        section.\n*>==============================\n*>\n *>    open     input  purchase-file delivery-file.\n     perform  Purch-Open-Input.\n     perform  Delivery-Open-Input.\n*>\n     move     spaces to cust-in status-in credit-op invoice-op\n                        average-op overdue-op enter-date-op\n                        enter-date-in print-out.\n*>\n     move     zero to credit-in invoice-in average-in overdue-in ws-enter-date.\n     display  display-03.\n*>\n accept-data.\n*>**********\n*>\n     accept   display-03.\n     move     function upper-case (cust-in) to cust-in.\n     move     cust-in to customer-in.\n     move     function upper-case (status-in) to status-in.\n     if       status-in  not = \"L\" and not = \"D\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (credit-op) to credit-op.\n     if       credit-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (invoice-op) to invoice-op.\n     if       invoice-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (average-op) to average-op.\n     if       average-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (overdue-op) to overdue-op.\n     if       overdue-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     function upper-case (enter-date-op) to enter-date-op.\n     if       enter-date-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     if       enter-date-in = spaces\n              go to main-end.\n     move     zero          to u-bin.\n     move     enter-date-in to ws-test-date.  *> was u-date\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              display PL005 at 2362 with foreground-color 4\n              go to accept-data.\n     display  \" \" at 2362 with erase eol.\n     move     u-bin  to ws-enter-date.\n*>     move     u-date to enter-date-in.     *> not sure about this, means that say intl date is now uk????\n*>\n main-end.    exit section.\n*>*******     ****\n*>\n produce-report          section.\n*>==============================\n*>\n     open     output  print-file.\n     move     zero to a.\n     perform  headings.\n*>\n     if       customer-in = spaces\n              go to read-loop.\n     move     customer-in to WS-Purch-Key.\n     set      fn-not-less-than to true.\n     move     1 to File-Key-No.\n     perform  Purch-Start.          *> start    purchase-file key not < WS-Purch-Key invalid key\n     if       fs-reply not = zero\n              move 1 to a.\n     inspect  customer-in replacing all space by \"Z\".\n*>\n read-loop.\n*>********\n*>\n     perform  Purch-Read-Next.         *> read     purchase-file  next record  at end\n     if       fs-reply = 10\n              go to  end-report.\n     if       fs-reply not = zero\n              go to end-report.\n*>\n     if       status-in = \"L\"\n        and   supplier-dead\n              go to  read-loop.\n     if       status-in = \"D\"\n        and   supplier-live\n              go to  read-loop.\n*>\n     if       customer-in not = spaces\n        and   WS-Purch-Key > customer-in\n              go to end-report.\n*>\n     if       credit-op not = space\n              move  credit-in     to  test-1\n              move  purch-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       invoice-op not = space\n              move  invoice-in     to  test-1\n              move  purch-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       average-op not = space\n              move  average-in    to  test-1\n              move  purch-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       overdue-op not = space\n       and    purch-current > 0.00\n              move  overdue-in    to  test-1\n              subtract purch-last-inv from run-date giving test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       enter-date-op not = space\n              move  ws-enter-date     to  test-1\n              move  purch-create-date to  test-2\n              move  enter-date-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     perform  listing.\n     go       to read-loop.\n*>\n test-num.\n*>*******\n*>\n     if       test-op = space\n              move  1  to  truth\n     else\n              move  0  to  truth.\n*>\n     if       test-op = \"L\"\n          and test-2  <  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"G\"\n          and test-2  >  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"E\"\n          and test-2  =  test-1\n              move  1  to  truth.\n*>\n headings.\n*>*******\n*>\n     add      1  to  a.\n     move     a  to  l1-page.\n     if       a not = 1\n              write print-record  from  line-1 after page\n              write print-record  from  line-3 after 1\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1.\n     write    print-record  from  line-5 after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     6 to line-cnt.\n*>\n listing.\n*>******\n*>\n     if       line-cnt > Page-Lines\n              perform  headings.\n     move     WS-Purch-Key  to  l6-key.\n*>\n     if       supplier-live\n              move  \"Active\"  to  l6-status\n     else\n              move  \"Dormant\" to  l6-status.\n*>\n     move     spaces         to  l6-phone.\n     move     purch-name     to  l6-name.\n     move     purch-address  to  l7-address.\n     inspect  l7-address  replacing  all  sl-delim  by  \",\".\n     if       purch-ext = spaces\n              move purch-phone to l6-phone\n     else\n              move  1 to y\n              string purch-phone delimited by \"  \" into l6-phone with pointer y\n              subtract 1 from y\n              string \"x\"         delimited by size\n                     purch-ext   delimited by size  into l6-phone with pointer y.\n*>\n     move     purch-fax      to l6-fax.\n     move     purch-limit    to l6-limit.\n     move     purch-credit   to l6-credit.\n     move     purch-discount to l6-discount.\n*>\n     if       line-cnt > Page-Lines - 3\n              perform headings.\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n*>\n     if       Purch-Notes-Tag > zero\n              perform  notes-print.\n*>\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     add      3 to line-cnt.\n     move     \"Y\" to Print-Out.\n*>\n notes-print.\n     move     \"N\"       to WS-Deliv-Key-Type.\n     move     WS-Purch-Key to Deliv-Purchase-Key.\n     perform  Delivery-Read-Indexed               *> read     delivery-file invalid key\n     if       fs-reply not = zero\n              move \"Record Not Found\" to deliv-Address.\n*>\n     move     spaces to l7-address.\n     string   \"Notes: \" delimited by size\n              deliv-address delimited by \"  \" into l7-address.\n     write    print-record from line-7 after 1.\n     add      1 to line-cnt.\n*>\n end-report.\n*>*********\n*>\n main-end.\n*>*******\n*>\n     close    print-file.\n     if       Print-Out = \"Y\"\n              call     \"SYSTEM\" using Print-Report.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-heading-setup    section.\n*>==============================\n*>\n     perform  zz070-convert-date.\n     move     ws-date to l3-date.\n     move     usera  to  l3-user.\n     move     1      to  y.\n     move     spaces to  l3-report.\n*>\n     if       status-in = spaces  and  credit-op\n         and  invoice-op   and  average-op\n         and  overdue-op   and  customer-in\n              string  \"All\"  delimited by size     into  l3-report  with  pointer  y\n     else\n              string  \"Matched\"  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       status-in = \"L\"\n              string  \"Live\"  delimited by size    into  l3-report  with  pointer  y.\n     if       status-in = \"D\"\n              string  \"Dormant\"  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       credit-op = \"L\"\n              move    \"< \"  to  cr-operand.\n     if       credit-op = \"G\"\n              move    \"> \"   to  cr-operand.\n     if       credit-op = \"E\"\n              move    \"= \"  to  cr-operand.\n*>\n     if       credit-op not = \" \"\n              move  credit-in  to  cr-days\n              string  credit-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       invoice-op = \"L\"\n              move    \"< \"  to  act-operand.\n     if       invoice-op = \"G\"\n              move    \"> \"   to  act-operand.\n     if       invoice-op = \"E\"\n              move    \"= \"  to  act-operand.\n*>\n     if       invoice-op not = \" \"\n              move  invoice-in  to  act-days\n              string  active-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       average-op = \"L\"\n              move    \"< \"  to  av-operand.\n     if       average-op = \"G\"\n              move    \"> \"   to  av-operand.\n     if       average-op = \"E\"\n              move    \"= \"  to  av-operand.\n*>\n     if       average-op not = \" \"\n              move  average-in  to  av-days\n              string  average-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       overdue-op = \"L\"\n              move    \"< \"  to  ov-operand.\n     if       overdue-op = \"G\"\n              move    \"> \"   to  ov-operand.\n     if       overdue-op = \"E\"\n              move    \"= \"  to  ov-operand.\n*>\n     if       overdue-op not = \" \"\n              move  overdue-in  to  ov-days\n              string  overdue-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       enter-date-op = \"L\"\n              move    \"< \"  to  ed-operand.\n     if       enter-date-op = \"G\"\n              move    \"> \"   to  ed-operand.\n     if       enter-date-op = \"E\"\n              move    \"= \"  to  ed-operand.\n*>\n     if       enter-date-op  not = space\n              move  enter-date-in  to  ed-date\n              string  enter-date-heading  delimited by size into  l3-report  with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       customer-in not =  spaces\n              string  \" Keys Matching - \" delimited by size\n                      customer-in         delimited by size into  l3-report  with  pointer  y.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n plcreate                section.\n*>==============================\n*>\n plcreate-Main.\n     perform  display-heading.\n     display  PL103 at 1201  with foreground-color 4.\n     display  PL104 at 1301  with foreground-color 2.\n     move     space to ws-reply.\n     accept   ws-reply at 1343 with foreground-color 6 update.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply = \"N\"\n              exit program.\n     if       ws-reply not = \"Y\"\n              go to plcreate-Main.\n*>\n     display  PL105  at 1506  with foreground-color 2.\n     perform  Purch-Open-Output.       *>  open     output purchase-file.\n     if       fs-reply not = zero\n              display PL106    at 1201 with erase eol\n              display fs-reply at 1237\n              display PL004    at 1240\n              accept  ws-reply at 1261\n              perform  Purch-Close    *> close Purchase-File\n              go to main-exit.\n     perform  Delivery-Open-Output.   *> open     output delivery-file.\n     if       fs-reply not = zero\n              display PL107    at 1201 with erase eol\n              display fs-reply at 1237\n              display PL004    at 1240\n              accept  ws-reply at 1261\n              perform  Delivery-Close     *> close delivery-file\n              go to main-exit.\n*>\n     perform  Purch-Close.     *> close    purchase-file delivery-file.\n     perform  Delivery-Close.\n     move     \"Y\" to purchase-ledger.\n*>\n main-exit.   exit section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps03.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps03.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 104
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 5,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 127,
      "totalOperators": 118,
      "totalOperands": 236,
      "vocabulary": 128,
      "length": 354,
      "volume": 2478
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
