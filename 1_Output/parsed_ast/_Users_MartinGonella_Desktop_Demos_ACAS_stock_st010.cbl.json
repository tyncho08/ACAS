{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/stock/st010.cbl",
  "fileName": "st010.cbl",
  "timestamp": "2025-09-15T16:25:50.199Z",
  "programId": "st010",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 194
      },
      {
        "name": "file",
        "line": 207
      },
      {
        "name": "working-storage",
        "line": 215
      },
      {
        "name": "linkage",
        "line": 496
      },
      {
        "name": "screen",
        "line": 505
      },
      {
        "name": "aa000-Core",
        "line": 631
      },
      {
        "name": "ba000-Setup-Stock",
        "line": 793
      },
      {
        "name": "exit",
        "line": 1107
      },
      {
        "name": "ca000-Amend-Stock",
        "line": 1109
      },
      {
        "name": "exit",
        "line": 1395
      },
      {
        "name": "da000-Delete-Stock",
        "line": 1397
      },
      {
        "name": "exit",
        "line": 1510
      },
      {
        "name": "ea000-Report-Stock",
        "line": 1512
      },
      {
        "name": "exit",
        "line": 1530
      },
      {
        "name": "ea200-Produce-Report",
        "line": 1532
      },
      {
        "name": "exit",
        "line": 1682
      },
      {
        "name": "fa000-Display-Stock",
        "line": 1684
      },
      {
        "name": "exit",
        "line": 1790
      },
      {
        "name": "ga000-Renumber-Stock",
        "line": 1792
      },
      {
        "name": "exit",
        "line": 1953
      },
      {
        "name": "zz010-Display-Heading",
        "line": 1959
      },
      {
        "name": "exit",
        "line": 1985
      },
      {
        "name": "zz020-Convert-Date",
        "line": 1987
      },
      {
        "name": "exit",
        "line": 2009
      },
      {
        "name": "zz020-Display-Outline",
        "line": 2011
      },
      {
        "name": "exit",
        "line": 2023
      },
      {
        "name": "zz030-common-routines",
        "line": 2025
      },
      {
        "name": "exit",
        "line": 2062
      },
      {
        "name": "zz040-Check-for-Supplier",
        "line": 2064
      },
      {
        "name": "exit",
        "line": 2091
      },
      {
        "name": "zz050-Validate-Date",
        "line": 2093
      },
      {
        "name": "exit",
        "line": 2126
      },
      {
        "name": "zz060-Convert-Date",
        "line": 2128
      },
      {
        "name": "exit",
        "line": 2161
      },
      {
        "name": "zz070-Initialize-Stock-Record",
        "line": 2163
      },
      {
        "name": "exit",
        "line": 2208
      },
      {
        "name": "zz080-Copy-To-SS",
        "line": 2210
      },
      {
        "name": "exit",
        "line": 2227
      },
      {
        "name": "zz090-Copy-From-SS",
        "line": 2229
      },
      {
        "name": "exit",
        "line": 2246
      },
      {
        "name": "zz100-test-escape",
        "line": 2248
      },
      {
        "name": "exit",
        "line": 2262
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 197
      },
      {
        "name": "file-defs",
        "line": 628
      },
      {
        "name": "aa010-Menu-Return",
        "line": 652
      },
      {
        "name": "aa020-Menu-Input",
        "line": 656
      },
      {
        "name": "maps04",
        "line": 708
      },
      {
        "name": "maps09",
        "line": 711
      },
      {
        "name": "end-if",
        "line": 754
      },
      {
        "name": "end-if",
        "line": 769
      },
      {
        "name": "end-if",
        "line": 784
      },
      {
        "name": "Clear-Error-Line",
        "line": 787
      },
      {
        "name": "aa999-Exit",
        "line": 790
      },
      {
        "name": "end-if",
        "line": 811
      },
      {
        "name": "ba010-Display-Stock-Headings",
        "line": 831
      },
      {
        "name": "ba020-Stock-Item-Accept",
        "line": 841
      },
      {
        "name": "ba030-Stock-Abrev-Item-Accept",
        "line": 850
      },
      {
        "name": "ba040-Accept-Block",
        "line": 891
      },
      {
        "name": "ba042-Get-Stock-Retail",
        "line": 975
      },
      {
        "name": "ba044-Get-Stock-Cost",
        "line": 981
      },
      {
        "name": "ba046-Get-Stock-Value",
        "line": 986
      },
      {
        "name": "ba050-Main-Output",
        "line": 1078
      },
      {
        "name": "ba998-Main-End",
        "line": 1101
      },
      {
        "name": "ba999-Exit",
        "line": 1106
      },
      {
        "name": "ca010-Display-Stock-Headings",
        "line": 1134
      },
      {
        "name": "ca020-Stock-Item-Accept",
        "line": 1137
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 1149
      },
      {
        "name": "ca030-Get-Record",
        "line": 1151
      },
      {
        "name": "ca040-Accept-Block",
        "line": 1183
      },
      {
        "name": "ca042-Get-Stock-Retail",
        "line": 1267
      },
      {
        "name": "ca044-Get-Stock-Cost",
        "line": 1273
      },
      {
        "name": "ca046-Get-Stock-Value",
        "line": 1278
      },
      {
        "name": "ca050-Main-Output",
        "line": 1366
      },
      {
        "name": "ca998-Main-End",
        "line": 1389
      },
      {
        "name": "ca999-Exit",
        "line": 1394
      },
      {
        "name": "da010-Display-Stock-Headings",
        "line": 1406
      },
      {
        "name": "da020-Stock-Item-Accept",
        "line": 1409
      },
      {
        "name": "Customer-Code",
        "line": 1412
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 1425
      },
      {
        "name": "da030-Get-Record",
        "line": 1428
      },
      {
        "name": "da040-Accept-Delete",
        "line": 1485
      },
      {
        "name": "da999-Exit",
        "line": 1509
      },
      {
        "name": "ea999-exit",
        "line": 1529
      },
      {
        "name": "ea210-Read-Stock",
        "line": 1547
      },
      {
        "name": "ea220-Heads",
        "line": 1653
      },
      {
        "name": "end-if",
        "line": 1669
      },
      {
        "name": "ea230-Totals",
        "line": 1671
      },
      {
        "name": "ea299-Exit",
        "line": 1680
      },
      {
        "name": "fa010-Display-Stock-Headings",
        "line": 1695
      },
      {
        "name": "fa020-Stock-Item-Accept",
        "line": 1698
      },
      {
        "name": "Customer-Code",
        "line": 1701
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 1722
      },
      {
        "name": "fa030-Get-Record",
        "line": 1724
      },
      {
        "name": "fa999-Exit",
        "line": 1789
      },
      {
        "name": "ga010-Display-Stock-Headings",
        "line": 1801
      },
      {
        "name": "ga020-Stock-Item-Accept",
        "line": 1804
      },
      {
        "name": "Customer-Code",
        "line": 1807
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 1819
      },
      {
        "name": "ga030-Get-Record",
        "line": 1822
      },
      {
        "name": "WS-Temp-Stock-Key",
        "line": 1873
      },
      {
        "name": "WS-Save-Abrev-Key",
        "line": 1875
      },
      {
        "name": "ga040-Accept-New-Stock-No",
        "line": 1877
      },
      {
        "name": "ga050-Accept-Renumber",
        "line": 1913
      },
      {
        "name": "ga999-Exit",
        "line": 1952
      },
      {
        "name": "zz010-Exit",
        "line": 1984
      },
      {
        "name": "end-if",
        "line": 2006
      },
      {
        "name": "zz020-exit",
        "line": 2008
      },
      {
        "name": "zz020-exit",
        "line": 2022
      },
      {
        "name": "zz030-exit",
        "line": 2061
      },
      {
        "name": "WS-File-Key",
        "line": 2082
      },
      {
        "name": "zz040-Exit",
        "line": 2090
      },
      {
        "name": "zz050-test-date",
        "line": 2120
      },
      {
        "name": "zz050-exit",
        "line": 2125
      },
      {
        "name": "zz060-Exit",
        "line": 2160
      },
      {
        "name": "Stock-Services-Flag",
        "line": 2178
      },
      {
        "name": "Stock-Wip-Deds",
        "line": 2198
      },
      {
        "name": "end-perform",
        "line": 2205
      },
      {
        "name": "zz070-Exit",
        "line": 2207
      },
      {
        "name": "zz080-Exit",
        "line": 2226
      },
      {
        "name": "zz090-Exit",
        "line": 2245
      },
      {
        "name": "zz100-get-escape",
        "line": 2253
      },
      {
        "name": "zz100-exit",
        "line": 2261
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 661,
        "type": "DYNAMIC",
        "using": [
          "File-11",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "perform",
          "ba000-Setup-Stock",
          "*>",
          "so",
          "force",
          "setup",
          "stock",
          "data",
          "go",
          "to",
          "aa010-Menu-Return",
          "end-if",
          "end-if",
          "*>",
          "display",
          "\"Select",
          "one",
          "of",
          "the",
          "following",
          "by",
          "number",
          ":-",
          "[",
          "]\"",
          "at",
          "0701",
          "with",
          "foreground-color",
          "2"
        ]
      },
      {
        "target": "maps04",
        "line": 709,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "maps09",
        "line": 712,
        "type": "DYNAMIC",
        "using": [
          "maps09-ws"
        ]
      },
      {
        "target": "MySQL_rollback",
        "line": 725,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "MySQL_commit",
        "line": 735,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "CBL_CHECK_FILE_EXIST",
        "line": 814,
        "type": "DYNAMIC",
        "using": [
          "File-15",
          "File-Info",
          "end-call",
          "if",
          "return-code",
          "not",
          "=",
          "zero",
          "*>",
          "not",
          "=",
          "zero",
          "-",
          "No",
          "file",
          "found",
          "move",
          "1",
          "to",
          "WS-Process-Func",
          "WS-Sub-Function",
          "call",
          "\"sl070\"",
          "using",
          "WS-Calling-Data",
          "System-Record",
          "To-Day",
          "File-Defs",
          "end-call",
          "end-if",
          "end-if",
          "perform",
          "Analysis-Open-Input"
        ]
      },
      {
        "target": "scr_dump",
        "line": 902,
        "type": "DYNAMIC",
        "using": [
          "wScreenName",
          "returning",
          "wInt",
          "call",
          "\"pl010\"",
          "using",
          "WS-calling-data",
          "system-record",
          "to-day",
          "file-defs",
          "call",
          "\"scr_restore\"",
          "using",
          "wScreenName",
          "returning",
          "wInt",
          "call",
          "\"CBL_DELETE_FILE\"",
          "using",
          "Path-Work",
          "*>",
          "perform",
          "zz010-Display-Heading",
          "*>",
          "display",
          "Display-01",
          "*>",
          "display",
          "WS-Stock-Key",
          "at",
          "0421",
          "with",
          "foreground-color",
          "3",
          "*>",
          "display",
          "WS-Stock-Abrev-Key",
          "at",
          "0457",
          "with",
          "foreground-color",
          "3",
          "go",
          "to",
          "ba040-Accept-Block"
        ]
      },
      {
        "target": "scr_dump",
        "line": 1194,
        "type": "DYNAMIC",
        "using": [
          "wScreenName",
          "returning",
          "wInt",
          "call",
          "\"pl010\"",
          "using",
          "WS-calling-data",
          "system-record",
          "to-day",
          "file-defs",
          "call",
          "\"scr_restore\"",
          "using",
          "wScreenName",
          "returning",
          "wInt",
          "call",
          "\"CBL_DELETE_FILE\"",
          "using",
          "Path-Work",
          "*>",
          "perform",
          "zz010-Display-Heading",
          "*>",
          "display",
          "Display-01",
          "*>",
          "display",
          "WS-Stock-Key",
          "at",
          "0421",
          "with",
          "foreground-color",
          "3",
          "*>",
          "display",
          "WS-Stock-Abrev-Key",
          "at",
          "0457",
          "with",
          "foreground-color",
          "3",
          "go",
          "to",
          "ca040-Accept-Block"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1527,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 184,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 193,
        "replacing": null
      },
      {
        "name": "selstock",
        "line": 200,
        "replacing": null
      },
      {
        "name": "selpl",
        "line": 201,
        "replacing": null
      },
      {
        "name": "selanal",
        "line": 202,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 203,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 210,
        "replacing": null
      },
      {
        "name": "fdpl",
        "line": 211,
        "replacing": null
      },
      {
        "name": "fdanal",
        "line": 212,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 213,
        "replacing": null
      },
      {
        "name": "to",
        "line": 220,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 222,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 325,
        "replacing": null
      },
      {
        "name": "wsstock",
        "line": 426,
        "replacing": null
      },
      {
        "name": "wspl",
        "line": 427,
        "replacing": null
      },
      {
        "name": "wsanal",
        "line": 428,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 429,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 430,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 431,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 458,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 499,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 500,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 501,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2264,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz010-Display-Heading",
        "thru": null,
        "line": 654
      },
      {
        "target": "ba000-Setup-Stock",
        "thru": null,
        "line": 665
      },
      {
        "target": "ba000-Setup-Stock",
        "thru": null,
        "line": 689
      },
      {
        "target": "ca000-Amend-Stock",
        "thru": null,
        "line": 692
      },
      {
        "target": "da000-Delete-Stock",
        "thru": null,
        "line": 695
      },
      {
        "target": "ga000-Renumber-Stock",
        "thru": null,
        "line": 698
      },
      {
        "target": "ea000-Report-Stock",
        "thru": null,
        "line": 701
      },
      {
        "target": "fa000-Display-Stock",
        "thru": null,
        "line": 704
      },
      {
        "target": "aa020-Rollback",
        "thru": null,
        "line": 749
      },
      {
        "target": "aa020-Rollback",
        "thru": null,
        "line": 764
      },
      {
        "target": "aa020-Rollback",
        "thru": null,
        "line": 779
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 796
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 804
      },
      {
        "target": "aa100-Check-4-Errors",
        "thru": null,
        "line": 807
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 808
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 809
      },
      {
        "target": "Analysis-Open-Input",
        "thru": null,
        "line": 827
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 829
      },
      {
        "target": "zz020-Display-Outline",
        "thru": null,
        "line": 832
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 835
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 861
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 870
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 878
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 886
      },
      {
        "target": "zz010-Display-Heading",
        "thru": null,
        "line": 906
      },
      {
        "target": "varying",
        "thru": null,
        "line": 915
      },
      {
        "target": "zz040-Check-for-Supplier",
        "thru": null,
        "line": 919
      },
      {
        "target": "if",
        "thru": null,
        "line": 932
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 936
      },
      {
        "target": "Analysis-Start",
        "thru": null,
        "line": 945
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 951
      },
      {
        "target": "Analysis-Start",
        "thru": null,
        "line": 960
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 966
      },
      {
        "target": "zz090-Copy-From-SS",
        "thru": null,
        "line": 972
      },
      {
        "target": "zz030-accept-money7",
        "thru": null,
        "line": 979
      },
      {
        "target": "zz030-accept-money7b",
        "thru": null,
        "line": 984
      },
      {
        "target": "zz030-accept-money9c",
        "thru": null,
        "line": 990
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1008
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1023
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1036
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1047
      },
      {
        "target": "zz100-Test-Escape",
        "thru": null,
        "line": 1076
      },
      {
        "target": "Stock-Write",
        "thru": null,
        "line": 1088
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 1097
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 1102
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1103
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1104
      },
      {
        "target": "Purch-Open-Input",
        "thru": null,
        "line": 1112
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 1119
      },
      {
        "target": "Analysis-Open-Input",
        "thru": null,
        "line": 1125
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1128
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1129
      },
      {
        "target": "zz020-Display-Outline",
        "thru": null,
        "line": 1135
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 1139
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1153
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1159
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1163
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1170
      },
      {
        "target": "zz080-Copy-To-SS",
        "thru": null,
        "line": 1178
      },
      {
        "target": "zz010-Display-Heading",
        "thru": null,
        "line": 1198
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1207
      },
      {
        "target": "zz040-Check-for-Supplier",
        "thru": null,
        "line": 1211
      },
      {
        "target": "if",
        "thru": null,
        "line": 1224
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1228
      },
      {
        "target": "Analysis-Start",
        "thru": null,
        "line": 1237
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 1243
      },
      {
        "target": "Analysis-Start",
        "thru": null,
        "line": 1252
      },
      {
        "target": "aa102-Check-4-Errors",
        "thru": null,
        "line": 1258
      },
      {
        "target": "zz090-Copy-From-SS",
        "thru": null,
        "line": 1264
      },
      {
        "target": "zz030-accept-money7",
        "thru": null,
        "line": 1271
      },
      {
        "target": "zz030-accept-money7b",
        "thru": null,
        "line": 1276
      },
      {
        "target": "zz030-accept-money9c",
        "thru": null,
        "line": 1282
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1300
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1312
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1324
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1334
      },
      {
        "target": "zz100-test-escape",
        "thru": null,
        "line": 1364
      },
      {
        "target": "Stock-Rewrite",
        "thru": null,
        "line": 1376
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 1385
      },
      {
        "target": "Purch-Close",
        "thru": null,
        "line": 1390
      },
      {
        "target": "Analysis-Close",
        "thru": null,
        "line": 1391
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1392
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 1400
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1402
      },
      {
        "target": "zz020-Display-Outline",
        "thru": null,
        "line": 1407
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 1414
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1422
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1431
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1437
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1441
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1448
      },
      {
        "target": "zz080-Copy-To-SS",
        "thru": null,
        "line": 1456
      },
      {
        "target": "zz100-test-escape",
        "thru": null,
        "line": 1472
      },
      {
        "target": "Stock-Delete",
        "thru": null,
        "line": 1499
      },
      {
        "target": "Stock-Open-Input",
        "thru": null,
        "line": 1517
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1519
      },
      {
        "target": "ea200-Produce-Report",
        "thru": null,
        "line": 1524
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1526
      },
      {
        "target": "zz020-convert-date",
        "thru": null,
        "line": 1540
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1548
      },
      {
        "target": "ea220-Heads",
        "thru": null,
        "line": 1552
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1574
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1581
      },
      {
        "target": "ea220-Heads",
        "thru": null,
        "line": 1674
      },
      {
        "target": "Stock-Open-Input",
        "thru": null,
        "line": 1687
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1689
      },
      {
        "target": "zz020-Display-Outline",
        "thru": null,
        "line": 1696
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1713
      },
      {
        "target": "Stock-Start",
        "thru": null,
        "line": 1719
      },
      {
        "target": "Stock-Read-Next",
        "thru": null,
        "line": 1729
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1737
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1746
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1750
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1757
      },
      {
        "target": "zz080-Copy-To-SS",
        "thru": null,
        "line": 1765
      },
      {
        "target": "zz100-test-escape",
        "thru": null,
        "line": 1778
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1784
      },
      {
        "target": "Stock-Open",
        "thru": null,
        "line": 1795
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1797
      },
      {
        "target": "zz020-Display-Outline",
        "thru": null,
        "line": 1802
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1816
      },
      {
        "target": "Stock-Read-Indexed",
        "thru": null,
        "line": 1825
      },
      {
        "target": "Clear-Error-Line",
        "thru": null,
        "line": 1831
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1835
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 1842
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 1894
      },
      {
        "target": "zz100-test-escape",
        "thru": null,
        "line": 1900
      },
      {
        "target": "Stock-Write",
        "thru": null,
        "line": 1926
      },
      {
        "target": "Stock-Close",
        "thru": null,
        "line": 1936
      },
      {
        "target": "Stock-Delete",
        "thru": null,
        "line": 1943
      },
      {
        "target": "zz020-convert-date",
        "thru": null,
        "line": 1965
      },
      {
        "target": "zz010-Display-Heading",
        "thru": null,
        "line": 2014
      },
      {
        "target": "zz070-Initialize-Stock-Record",
        "thru": null,
        "line": 2016
      },
      {
        "target": "maps09",
        "thru": null,
        "line": 2073
      },
      {
        "target": "Purch-Read-Indexed",
        "thru": null,
        "line": 2084
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2123
      },
      {
        "target": "maps04",
        "thru": null,
        "line": 2137
      },
      {
        "target": "varying",
        "thru": null,
        "line": 2200
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "1",
        "to": "File-Key chg\n*>                    test for \"*\" to use fn-not-less-than instead of not-greater\n*>                    as previous can not work",
        "line": 144
      },
      {
        "from": "24",
        "to": "WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines",
        "line": 635
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 644
      },
      {
        "from": "spaces",
        "to": "Path-Work",
        "line": 648
      },
      {
        "from": "zero",
        "to": "Menu-Reply",
        "line": 653
      },
      {
        "from": "\"Y\"",
        "to": "Stock-Control",
        "line": 812
      },
      {
        "from": "1",
        "to": "WS-Process-Func\n                              WS-Sub-Function\n                    call \"sl070\" using WS-Calling-Data\n                                       System-Record\n                                       To-Day\n                                       File-Defs\n                    end-call\n              end-if\n     end-if\n     perform  Analysis-Open-Input",
        "line": 818
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key (13:1)\n                        WS-Stock-Abrev-Key (7:1)\n                        Customer-Code WS-Stock-Dates",
        "line": 836
      },
      {
        "from": "\"N\"",
        "to": "Stock-Services-Flag",
        "line": 839
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 869
      },
      {
        "from": "Customer-Code",
        "to": "WS-Stock-Abrev-Key",
        "line": 875
      },
      {
        "from": "2",
        "to": "File-Key-No\n              perform Stock-Read-Indexed\n*>              read   Stock-File key is WS-Stock-Abrev-Key not invalid key\n              if     (fs-Reply not = 23 and not = 21)           *> invalid key but for RDB its 23\n                     display ST116 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     go to ba020-Stock-Item-Accept",
        "line": 877
      },
      {
        "from": "customer-code",
        "to": "WS-Stock-Abrev-Key",
        "line": 887
      },
      {
        "from": "WS-Temp-Stock-Key",
        "to": "WS-Stock-Key",
        "line": 888
      },
      {
        "from": "zero",
        "to": "WS-term-code\n              move     z\"stk-temp",
        "line": 900
      },
      {
        "from": "zero",
        "to": "c",
        "line": 914
      },
      {
        "from": "1",
        "to": "c\n                                         display ST101\n                                                    at line WS-23-lines col 1 with foreground-color 4 highlight\n                                end-if\n                                display b at line WS-23-lines col a with foreground-color 4 highlight\n                       end-if\n                       move     WS-Stock-Supplier to Stock-Suppliers (b)\n              end-if\n     end-perform\n     if       c not = zero\n              go to ba040-Accept-Block",
        "line": 924
      },
      {
        "from": "\"P\"",
        "to": "Stock-PA-System\n              move Stock-PA-Code to WS-PA-Code\n              perform Analysis-Start\n              if     fs-Reply = 21 or = 23\n                     display ST111 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     go to ba040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     move     function lower-case (Stock-SA-Group) to Stock-SA-Group",
        "line": 943
      },
      {
        "from": "\"S\"",
        "to": "Stock-SA-System\n              move Stock-SA-Code to WS-PA-Code\n              perform  Analysis-Start\n              if    FS-Reply = 21 or = 23\n                    display ST110 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    go to ba040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if     *>              end-start\n     end-if\n*>\n*>   Display and get money fields then WIPs\n*>\n     perform zz090-Copy-From-SS",
        "line": 958
      },
      {
        "from": "13",
        "to": "lin",
        "line": 976
      },
      {
        "from": "17",
        "to": "cole",
        "line": 977
      },
      {
        "from": "Stock-Retail",
        "to": "amt-ok7",
        "line": 978
      },
      {
        "from": "amt-ok7",
        "to": "Stock-Retail",
        "line": 980
      },
      {
        "from": "57",
        "to": "cole",
        "line": 982
      },
      {
        "from": "Stock-Cost",
        "to": "amt-ok7b",
        "line": 983
      },
      {
        "from": "amt-ok7b",
        "to": "Stock-Cost",
        "line": 985
      },
      {
        "from": "14",
        "to": "lin",
        "line": 987
      },
      {
        "from": "17",
        "to": "cole",
        "line": 988
      },
      {
        "from": "Stock-Value",
        "to": "amt-ok9",
        "line": 989
      },
      {
        "from": "amt-ok9",
        "to": "Stock-Value",
        "line": 991
      },
      {
        "from": "WS-Stock-Order-Date",
        "to": "WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n                 display \" \" at 1228\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1228 with foreground-color 4 highlight\n                 go to ba040-Accept-Block\n              end-if\n     else\n              move zero to Stock-Order-Date\n     end-if\n*>\n     if       WS-Stock-Order-Due not = spaces\n              move WS-Stock-Order-Due to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Due\n                 display \" \" at 1268\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1268 with foreground-color 4 highlight\n                 go to ba040-Accept-Block\n     else\n              move zero to Stock-Order-Due",
        "line": 1007
      },
      {
        "from": "WS-Stock-Record",
        "to": "WS-Saved-Stock-Record\n              move    WS-Contruct-Key to WS-Stock-Key\n              move    1 to File-Key-No\n*>              set     fn-Equal-to to true\n              move    5 to Access-Type   *> =\n              perform Stock-Start\n              if      fs-Reply = 21                *> invalid key\n                      display ST115 at line WS-23-lines col 1 with foreground-color 4 highlight\n                      move  WS-saved-stock-record to WS-Stock-Record\n                      go    to ba040-Accept-Block\n              end-if\n              move     WS-saved-stock-record to WS-Stock-Record\n     end-if\n*>\n*> if stock-services-flag set clear down unneeded values inc",
        "line": 1042
      },
      {
        "from": "spaces",
        "to": "Stock-Construct-Item WS-Stock-Order-Due WS-Stock-Order-Date\n              move zero to Stock-Construct-Bundle  Stock-Under-Construction\n                           Stock-Work-in-Progress  Stock-ReOrder-Pnt\n                           Stock-Std-ReOrder       Stock-Back-Ordered\n                           Stock-On-Order          Stock-Pre-Sales\n                           Stock-Value\n                           Stock-Order-Due         Stock-Order-Date\n              display  display-01\n              display  display-01C\n              if       Stk-Manu-Used = 1\n                       display Display-02\n              end-if\n              display ST118 at line WS-23-lines col 1 with foreground-color 2 highlight\n     end-if\n     move     \"S\" to Escape-Code",
        "line": 1061
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Dates",
        "line": 1098
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key (13:1)\n                        WS-Stock-Abrev-Key (7:1)\n                        Customer-Code WS-Stock-Dates",
        "line": 1140
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1152
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay, now dates are converted\n*>\n     perform  zz080-Copy-To-SS",
        "line": 1162
      },
      {
        "from": "zero",
        "to": "WS-term-code\n              move     z\"stk-temp",
        "line": 1192
      },
      {
        "from": "zero",
        "to": "c",
        "line": 1206
      },
      {
        "from": "1",
        "to": "c\n                                         display ST101\n                                                    at line WS-23-lines col 1 with foreground-color 4 highlight\n                                end-if\n                                display b at line WS-23-lines col a with foreground-color 4 highlight\n                       end-if\n                       move     WS-Stock-Supplier to Stock-Suppliers (b)\n              end-if\n     end-perform\n     if       c not = zero\n              go to ca040-Accept-Block",
        "line": 1216
      },
      {
        "from": "\"P\"",
        "to": "Stock-PA-System\n              move Stock-PA-Code to WS-PA-Code\n              perform Analysis-Start\n              if   FS-Reply = 21 or = 23\n                   display ST111 at line WS-23-lines col 1 with foreground-color 4 highlight\n                   go to ca040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     move     function lower-case (Stock-SA-Group) to Stock-SA-Group",
        "line": 1235
      },
      {
        "from": "\"S\"",
        "to": "Stock-SA-System\n              move Stock-SA-Code to WS-PA-Code\n              perform Analysis-Start\n              if   FS-Reply = 21 or = 23\n                   display ST110 at line WS-23-lines col 1 with foreground-color 4 highlight\n                   go to ca040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if     *>      end-start\n     end-if\n*>\n*>   Display and get money fields then WIPs\n*>\n     perform zz090-Copy-From-SS",
        "line": 1250
      },
      {
        "from": "13",
        "to": "lin",
        "line": 1268
      },
      {
        "from": "17",
        "to": "cole",
        "line": 1269
      },
      {
        "from": "Stock-Retail",
        "to": "amt-ok7",
        "line": 1270
      },
      {
        "from": "amt-ok7",
        "to": "Stock-Retail",
        "line": 1272
      },
      {
        "from": "57",
        "to": "cole",
        "line": 1274
      },
      {
        "from": "Stock-Cost",
        "to": "amt-ok7b",
        "line": 1275
      },
      {
        "from": "amt-ok7b",
        "to": "Stock-Cost",
        "line": 1277
      },
      {
        "from": "14",
        "to": "lin",
        "line": 1279
      },
      {
        "from": "17",
        "to": "cole",
        "line": 1280
      },
      {
        "from": "Stock-Value",
        "to": "amt-ok9",
        "line": 1281
      },
      {
        "from": "amt-ok9",
        "to": "Stock-Value",
        "line": 1283
      },
      {
        "from": "WS-Stock-Order-Date",
        "to": "WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n                 display \" \" at 1228\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1228 with foreground-color 4 highlight\n                 go to ca040-Accept-Block\n     else     move zero to Stock-Order-Date",
        "line": 1299
      },
      {
        "from": "WS-Stock-Order-Due",
        "to": "WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Due\n                 display \" \" at 1268\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1268 with foreground-color 4 highlight\n                 go to ca040-Accept-Block\n     else     move zero to Stock-Order-Due",
        "line": 1311
      },
      {
        "from": "WS-Stock-Record",
        "to": "WS-saved-stock-record\n              move    WS-Contruct-Key to WS-Stock-Key\n              move    1 to File-Key-No\n              move    5 to Access-Type   *> =\n              perform Stock-Start\n              if      fs-Reply = 21\n                      display ST115 at line WS-23-lines col 1 with foreground-color 4 highlight\n                      move   WS-saved-stock-record to WS-Stock-Record\n                      go to ca040-Accept-Block\n*>              end-start\n              end-if\n              move     WS-saved-stock-record to WS-Stock-Record\n     end-if\n*>\n*> if stock-services-flag set clear down unneeded values inc",
        "line": 1330
      },
      {
        "from": "spaces",
        "to": "Stock-Construct-Item WS-Stock-Order-Due WS-Stock-Order-Date\n              move zero to Stock-Construct-Bundle  Stock-Under-Construction\n                           Stock-Work-in-Progress  Stock-ReOrder-Pnt\n                           Stock-Std-ReOrder       Stock-Back-Ordered\n                           Stock-On-Order          Stock-Pre-Sales\n                           Stock-Value\n                           Stock-Order-Due         Stock-Order-Date\n              display  display-01\n              display  display-01C\n              if       Stk-Manu-Used = 1\n                       display Display-02\n              end-if\n              display ST118 at line WS-23-lines col 1 with foreground-color 2 highlight\n     end-if\n     move     \"S\" to escape-code",
        "line": 1349
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Dates",
        "line": 1386
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code",
        "line": 1410
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1430
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n      perform  zz080-Copy-To-SS",
        "line": 1440
      },
      {
        "from": "\"D\"",
        "to": "escape-code",
        "line": 1471
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1498
      },
      {
        "from": "99",
        "to": "Line-Cnt",
        "line": 1535
      },
      {
        "from": "zero",
        "to": "Page-Nos WS-Rec-Cnt",
        "line": 1536
      },
      {
        "from": "Prog-Name",
        "to": "L1-Program",
        "line": 1537
      },
      {
        "from": "usera",
        "to": "L2-User",
        "line": 1538
      },
      {
        "from": "To-Day",
        "to": "u-Date",
        "line": 1539
      },
      {
        "from": "u-Date",
        "to": "L2-Date",
        "line": 1541
      },
      {
        "from": "hd-hh",
        "to": "L2-HH\n              move hd-mm to L2-MM",
        "line": 1544
      },
      {
        "from": "spaces",
        "to": "line-5",
        "line": 1554
      },
      {
        "from": "WS-Stock-Key",
        "to": "L5-Stock-Number",
        "line": 1555
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "L5-Abbrev-Stock",
        "line": 1556
      },
      {
        "from": "Stock-Supplier-P1",
        "to": "L5-Supplier-No",
        "line": 1557
      },
      {
        "from": "Stock-Retail",
        "to": "L5-Retail",
        "line": 1558
      },
      {
        "from": "Stock-Cost",
        "to": "L5-Cost",
        "line": 1559
      },
      {
        "from": "spaces",
        "to": "L5-Costz\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n              move  Stock-Value        to L5-Value\n              move  Stock-Held         to L5-Held\n              move  Stock-ReOrder-Pnt  to L5-Reord-Pnt\n              move  Stock-Std-ReOrder  to L5-Reord-Qty\n              move  Stock-On-Order     to L5-Qty-Ordered\n              move  Stock-Back-Ordered to L5-Qty-Back-Ord\n     end-if\n     move     WS-Stock-Location        to L5-Location",
        "line": 1561
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to L5-Date-Ordered\n     else\n              move spaces to L5-Date-Ordered\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to L5-Date-Due\n     else\n              move spaces to L5-Date-Due\n     end-if\n     move     WS-Stock-Desc to L6-Desc",
        "line": 1573
      },
      {
        "from": "1",
        "to": "a",
        "line": 1587
      },
      {
        "from": "spaces",
        "to": "L6-vars",
        "line": 1588
      },
      {
        "from": "Stock-Pre-Sales",
        "to": "WS-z6\n              string \"  Pre Sales :\"       delimited by size\n                     WS-z6                 delimited by size into L6-vars pointer a\n     end-if\n     if       Line-Cnt > 5\n              move all \"-\" to print-record\n              write print-record after 1\n              write print-record from line-5 after 1\n     else\n              write print-record from line-5 after 2\n     end-if\n     write    print-record from line-6 after 1",
        "line": 1613
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1626
      },
      {
        "from": "Stock-Construct-Bundle",
        "to": "WS-z6\n              move Stock-Under-Construction to WS-z6b\n              move Stock-Work-in-Progress   to WS-z6c\n              string \"Construction Bundle :\"    delimited by size\n                     WS-z6                      delimited by size\n                     \"  WIP :\"                  delimited by size\n                     WS-z6c                     delimited by size\n                     \"  Under Construction :\"   delimited by size\n                     WS-z6b                     delimited by size\n                     \" For Constructed Item : \" delimited by size\n                     Stock-Construct-Item       delimited by size\n                                into print-record\n              end-string\n              write  print-record after 1\n              add 1 to Line-Cnt\n     end-if\n     if       Stock-Services-Flag = \"Y\"\n              move \"Services only Product\" to print-record\n              write  print-record after 1\n              add 1 to Line-Cnt\n     end-if\n     go       to ea210-Read-Stock",
        "line": 1630
      },
      {
        "from": "Page-Nos",
        "to": "L1-Page\n              if  Page-Nos not = 1\n                  write print-record from line-1 after page\n                  write print-record from line-2 after 1\n                  move spaces to print-record\n                  write print-record after 1\n              else\n                  write print-record from line-1 before 1\n                  write print-record from line-2 before 1\n              end-if\n              write print-record from line-3 after 1\n              write print-record from line-4 after 1\n              move 5 to Line-Cnt\n     end-if",
        "line": 1656
      },
      {
        "from": "spaces",
        "to": "Print-Record",
        "line": 1675
      },
      {
        "from": "WS-Rec-Cnt",
        "to": "WS-Rec-Total",
        "line": 1676
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1693
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code",
        "line": 1699
      },
      {
        "from": "1",
        "to": "File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              move     spaces to WS-Stock-Key\n              set      fn-not-less-than to true      *> chgd from not-greater  16/08/23\n              perform  Stock-Start\n              move     \"*\" to WS-Stock-Key",
        "line": 1716
      },
      {
        "from": "1",
        "to": "File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if       fs-Reply not = 00\n                       display ST114 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       display ST003 at line WS-lines col 1 with foreground-color 4 highlight\n                       go to fa020-Stock-Item-Accept\n              end-if\n     end-if\n     display  WS-Stock-Key at 0421 with foreground-color 3",
        "line": 1736
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n     perform  zz080-Copy-To-SS",
        "line": 1749
      },
      {
        "from": "\"N\"",
        "to": "Escape-Code\n              display \"N> = Next  \" at line 20 col 64 with foreground-color cob-color-green\n     else\n              move \"S\" to Escape-Code",
        "line": 1774
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code",
        "line": 1805
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1824
      },
      {
        "from": "Stock-Order-Date",
        "to": "u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n     display  display-01",
        "line": 1834
      },
      {
        "from": "WS-Stock-Key",
        "to": "WS-Save-Stock-Key\n                              WS-Temp-Stock-Key",
        "line": 1872
      },
      {
        "from": "WS-Stock-Abrev-Key",
        "to": "WS-Temp-Abrev-Key\n                                    WS-Save-Abrev-Key",
        "line": 1874
      },
      {
        "from": "\"R\"",
        "to": "escape-code",
        "line": 1899
      },
      {
        "from": "WS-Temp-Stock-Key",
        "to": "WS-Stock-Key",
        "line": 1924
      },
      {
        "from": "WS-Temp-Abrev-Key",
        "to": "WS-Stock-Abrev-Key",
        "line": 1925
      },
      {
        "from": "WS-Save-Stock-Key",
        "to": "WS-Stock-Key",
        "line": 1941
      },
      {
        "from": "WS-Save-Abrev-key",
        "to": "WS-Stock-Abrev-Key",
        "line": 1942
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 1992
      },
      {
        "from": "u-date",
        "to": "WS-date\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              move WS-date to u-date\n     end-if\n     if       Date-Intl\n              move \"ccyy/mm/dd\" to WS-date   *> swap Intl to UK form\n              move u-date (7:4) to WS-Intl-Year\n              move u-date (4:2) to WS-Intl-Month\n              move u-date (1:2) to WS-Intl-Days\n              move WS-date to u-date\n     end-if",
        "line": 1994
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key WS-Stock-Abrev-Key WS-Stock-Dates",
        "line": 2017
      },
      {
        "from": "amt-wk-pence7",
        "to": "WS-pence7",
        "line": 2029
      },
      {
        "from": "amt-wk-pds7",
        "to": "WS-pound7",
        "line": 2030
      },
      {
        "from": "WS-pound7",
        "to": "amt-wk-pds7",
        "line": 2033
      },
      {
        "from": "WS-pence7",
        "to": "amt-wk-pence7",
        "line": 2034
      },
      {
        "from": "amt-wk-pence7b",
        "to": "WS-pence7b",
        "line": 2037
      },
      {
        "from": "amt-wk-pds7b",
        "to": "WS-pound7b",
        "line": 2038
      },
      {
        "from": "WS-pound7b",
        "to": "amt-wk-pds7b",
        "line": 2041
      },
      {
        "from": "WS-pence7b",
        "to": "amt-wk-pence7b",
        "line": 2042
      },
      {
        "from": "zero",
        "to": "WS-poundsd9 WS-penced9 amt-ok9",
        "line": 2045
      },
      {
        "from": "WS-pound9",
        "to": "amt-wk-pds9",
        "line": 2050
      },
      {
        "from": "WS-pence9",
        "to": "amt-wk-pence9",
        "line": 2051
      },
      {
        "from": "amt-wk-pence9",
        "to": "WS-pence9",
        "line": 2054
      },
      {
        "from": "amt-wk-pds9",
        "to": "WS-pound9",
        "line": 2055
      },
      {
        "from": "WS-pound9",
        "to": "amt-wk-pds9",
        "line": 2058
      },
      {
        "from": "WS-pence9",
        "to": "amt-wk-pence9",
        "line": 2059
      },
      {
        "from": "zero",
        "to": "Error-Code",
        "line": 2067
      },
      {
        "from": "WS-Stock-Supplier",
        "to": "customer-code\n              move \"C\" to maps09-reply\n              perform maps09\n              if  maps09-reply not = \"Y\"\n                  move 2 to Error-Code\n                  display ST103 at line WS-23-lines col 1 with foreground-color 4 highlight\n                  go to zz040-Exit\n              else\n                  move Customer-Code to WS-Stock-Supplier",
        "line": 2071
      },
      {
        "from": "WS-Stock-Supplier",
        "to": "WS-Purch-Key\n                                   WS-File-Key",
        "line": 2081
      },
      {
        "from": "5",
        "to": "Access-Type",
        "line": 2083
      },
      {
        "from": "1",
        "to": "Error-Code",
        "line": 2087
      },
      {
        "from": "WS-test-date",
        "to": "WS-date",
        "line": 2102
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2104
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz050-test-date",
        "line": 2108
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "WS-date",
        "line": 2115
      },
      {
        "from": "WS-date",
        "to": "u-date",
        "line": 2121
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 2122
      },
      {
        "from": "spaces",
        "to": "WS-Date\n              go to zz060-Exit",
        "line": 2139
      },
      {
        "from": "u-date",
        "to": "WS-date",
        "line": 2141
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2144
      },
      {
        "from": "WS-days",
        "to": "WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit",
        "line": 2148
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "WS-date",
        "line": 2155
      },
      {
        "from": "spaces",
        "to": "WS-Stock-Key\n                         WS-Stock-Abrev-Key\n                         Stock-Suppliers-Group\n                         WS-Stock-Desc\n                         Stock-Construct-Item\n                         WS-Stock-Location\n                         Stock-PA-Code\n                         Stock-SA-Code\n                         Stock-Services-Flag",
        "line": 2170
      },
      {
        "from": "zeros",
        "to": "Stock-Last-Actual-Cost\n                         Stock-Construct-Bundle\n                         Stock-Under-Construction\n                         Stock-Work-in-Progress\n                         Stock-ReOrder-Pnt\n                         Stock-Std-ReOrder\n                         Stock-Back-Ordered\n                         Stock-On-Order\n                         Stock-Held\n                         Stock-Pre-Sales\n                         Stock-Retail\n                         Stock-Cost\n                         Stock-Value\n                         Stock-Order-Due\n                         Stock-Order-Date\n                         Stock-Adds\n                         Stock-Deducts\n                         Stock-Wip-Adds\n                         Stock-Wip-Deds",
        "line": 2180
      },
      {
        "from": "zeros",
        "to": "Stock-TD-Adds (Z1)\n                            Stock-TD-Deds (Z1)\n                            Stock-TD-Wip-Adds (Z1)\n                            Stock-TD-Wip-Deds (Z1)\n     end-perform",
        "line": 2201
      },
      {
        "from": "Stock-Construct-Bundle",
        "to": "SS-Stock-Construct-Bundle",
        "line": 2213
      },
      {
        "from": "Stock-Under-Construction",
        "to": "SS-Stock-Under-Construction",
        "line": 2214
      },
      {
        "from": "Stock-Work-in-Progress",
        "to": "SS-Stock-Work-in-Progress",
        "line": 2215
      },
      {
        "from": "Stock-ReOrder-Pnt",
        "to": "SS-Stock-ReOrder-Pnt",
        "line": 2216
      },
      {
        "from": "Stock-Std-ReOrder",
        "to": "SS-Stock-Std-ReOrder",
        "line": 2217
      },
      {
        "from": "Stock-Back-Ordered",
        "to": "SS-Stock-Back-Ordered",
        "line": 2218
      },
      {
        "from": "Stock-On-Order",
        "to": "SS-Stock-On-Order",
        "line": 2219
      },
      {
        "from": "Stock-Held",
        "to": "SS-Stock-Held",
        "line": 2220
      },
      {
        "from": "Stock-Pre-Sales",
        "to": "SS-Stock-Pre-Sales",
        "line": 2221
      },
      {
        "from": "Stock-Retail",
        "to": "SS-Stock-Retail",
        "line": 2222
      },
      {
        "from": "Stock-Cost",
        "to": "SS-Stock-Cost",
        "line": 2223
      },
      {
        "from": "Stock-Value",
        "to": "SS-Stock-Value",
        "line": 2224
      },
      {
        "from": "SS-Stock-Construct-Bundle",
        "to": "Stock-Construct-Bundle",
        "line": 2232
      },
      {
        "from": "SS-Stock-Under-Construction",
        "to": "Stock-Under-Construction",
        "line": 2233
      },
      {
        "from": "SS-Stock-Work-in-Progress",
        "to": "Stock-Work-in-Progress",
        "line": 2234
      },
      {
        "from": "SS-Stock-ReOrder-Pnt",
        "to": "Stock-ReOrder-Pnt",
        "line": 2235
      },
      {
        "from": "SS-Stock-Std-ReOrder",
        "to": "Stock-Std-ReOrder",
        "line": 2236
      },
      {
        "from": "SS-Stock-Back-Ordered",
        "to": "Stock-Back-Ordered",
        "line": 2237
      },
      {
        "from": "SS-Stock-On-Order",
        "to": "Stock-On-Order",
        "line": 2238
      },
      {
        "from": "SS-Stock-Held",
        "to": "Stock-Held",
        "line": 2239
      },
      {
        "from": "SS-Stock-Pre-Sales",
        "to": "Stock-Pre-Sales",
        "line": 2240
      },
      {
        "from": "SS-Stock-Retail",
        "to": "Stock-Retail",
        "line": 2241
      },
      {
        "from": "SS-Stock-Cost",
        "to": "Stock-Cost",
        "line": 2242
      },
      {
        "from": "SS-Stock-Value",
        "to": "Stock-Value",
        "line": 2243
      }
    ],
    "computes": [
      {
        "target": "Stock-Value",
        "expression": "Stock-Value + (Stock-Cost * Stock-Work-in-Progress)",
        "line": 1004
      },
      {
        "target": "Stock-Value",
        "expression": "Stock-Value + (Stock-Cost * Stock-Work-in-Progress)",
        "line": 1296
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "in use.\n*> 18/06/09 vbc - .24 reversed PA and SA code in report to match input screen\n*>                 Swap Stk Abrev and no. around.2 match st030.\n*> 16/07/09 vbc - .25 Using ST104 instead of 105, if purchase ledger not setup.\n*> 17/07/09 vbc - .26 Abbrev code does not need to pass maps09 as no check digit.\n*> 24/07/09 vbc - .27 Force record entry (1) if stockfile not setup\n*>                    (file-status (11) not = 1) as per spec/manual.\n*> 11/12/11 vbc -     Changed version from 1.00.xx to 3.01.xx, in keeping with\n*>                    the rest of ACAS.\n*>                .28 Changed usage of Stk-Date-Form to the global field Date-Form\n*>                    making former redundent.\n*> 28/04/13 vbc - .29 Force services flag to N on new record entry screen\n*> 10/05/13 vbc - .30 Added new function of display all records in Display Records\n*>                     and new msg ST119.\n*>                    Changed set up and amend procedures to correctly accept\n*>                     amounts as screen section\n*>                    doesnt using Display-01B / 01C (display only).\n*> 12/05/13 vbc - .31 Detect F1 on accept during stock setup (or amend)\n*>                    and call pl010 to set up one or more suppliers.\n*> 12/05/13 vbc - .32 Changed wsnames to in common as pl010 called in st010.\n*>                .33 Bug in .31 display cleared some data.\n*> 13/05/13 vbc - .34 Added time to reports so that later reports on same day\n*>                    can be seen.\n*> 16/05/13 vbc - .35 Changed wsnames to in copybook see above.\n*> 25/05/13 vbc - .36 Force call to SL070 if analysis file not set up & clean\n*>                    up error recovery on opening same.\n*> 04/06/13 vbc - .37 Replaced Stk-WS-Page-Lines with system WS-Page-Lines.\n*> 29/06/16 vbc - .38 Replace Cobol file access verbs with calls to FH and RDB\n*>                    DAL. Precede references to Stock-Record, Stock-Key,\n*>                    Stock-Abrev-Key, Stock-Desc by WS- to reflect that we\n*>                    are only dealing with a WS record and the FD is now gone.\n*>                    Stop using File-Status and replace with call to\n*>                    \"CBL_CHECK_FILE_EXIST\" instead. Do same for all such\n*>                    checks, sets etc to kill of usage dates back to floppies.\n*>                    ST011 added. Update version to 3.02.\n*> 17/07/16 vbc - .39 Bug in test for file exist should be zero if found.\n*>                .40 Initalise broken - moving spaces into numerics so doing\n*>                    it the hard way !\n*> 24/07/16 vbc - .41 All file accessing now changed to use FH & RDB other\n*>                    than the printer. versioning changed to 3.02 from 3.01.\n*> 24/10/16 vbc - .42 ALL programs now using wsnames.cob in copybooks.\n*>                    Usage of maps99 removed.\n*> 12/03/18 vbc - .43 acasnnn copylib renaming acas000-open etc to comply with\n*>                    rest of ACAS to (System-Open etc).\n*>                    Chg ST000 to stock rec & comment grammar.\n*> 20/04/18 vbc - .44 Updated to support swapout of screen data when F1 is pressed.\n*>                     a little experimental.\n*> 21/04/18 vbc - .45 With chg to wsfnctn set path of current dir so can del temp\n*>                    screen save file.\n*> 04/12/18 vbc - .46 WS-Cob-Crt-Status was being used and it should have been\n*>                    Cob-Crt-Status - compile fails as it has not been defined\n*>                    for some time. Now how did that happen?\n*> 27/06/20 VBC - .47 Because of problems processing comp fields from the stock\n*>                    record in Screen Section where values seem to be binary\n*>                    spaces processing these vars as SS-xxx and moving back\n*>                    and from the WS-Stock-Record pre and post accept & display\n*>                    of Display-01, Display-02 also removed sign from the\n*>                    WS stock record.\n*> 29/06/20 vbc - .48 msg ST108 Table chgd to Rec, ST003 longer.\n*>                    Include extra 3 fields to code in .47.\n*> 06/02/23 vbc - .49 Included initialise stock-record in zz070 and elsewhere - JIC\n*> 06/08/23 vbc - .50 Added Display-F1-Display for display stk and clean up start\n*>                    for display stk AND remove tests for F1 in Display-Stock.\n*> 14/08/23 vbc - .51 Using WS-Page-Lines set as 45 as reports are landscape.\n*>                    User site to change if wrong for their printers.\n*> 16/08/23 vbc - .52 In fa020-Stock-Item-Accept added move 1 to File-Key chg\n*>                    test for \"*\" to use fn-not-less-than instead of not-greater\n*>                    as previous can not work.\n*> 27/01/24 vbc - .53 Wrong using in maps09 should be maps09-ws not customer-nos\n*>                    found with -d -g etc, wow thats been there for ever - cosmetic.\n*> 29/02/24 vbc - .54 Reinstate individual move zeros/spaces instead of initialise\n*>                    as it uses spaces for Stock-TD fields on GC v3.2.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 16/12/24 vbc - .55 Changed WS-Page-Lines to 56 as reports are landscape.\n*>                    User site to change if wrong for their printers.\n*> 04/02/25 vbc - .56 Added WS-  to Stock-Location.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>================================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>-------------------------------\n*>\n file-control.\n*>------------\n*>\n*> copy \"selstock.cob\".\n*> copy \"selpl.cob\".\n*> copy \"selanal.cob\".\n copy \"selprint.cob\".\n data                    division.\n*>===============================\n*>\n file section.\n*>------------\n*>\n*> copy \"fdstock.cob\".\n*> copy \"fdpl.cob\".\n*> copy \"fdanal.cob\".\n copy \"fdprint.cob\".\n*>\n working-storage section.\n*>-----------------------\n*>\n 77  prog-name           pic x(15)       value \"ST010 (3.02.55)\".\n*>\n*>  This will print 1 copy to CUPS print spool specified on line 3\n*>\n copy \"print-spool-command.cob\".\n 01  WS-saved-stock-record pic x(400).\n*>\n*> Amount workfields\n*>\n 01  WS-amount-screen-display7.\n     03  WS-poundsd7     pic 9(7).\n     03  WS-period7      pic x     value \".\".\n     03  WS-penced7      pic v99.\n 01  WS-amount-screen-accept7 redefines WS-amount-screen-display7.\n     03  WS-pound7       pic 9(7).\n     03  filler          pic x.\n     03  WS-pence7       pic v99.\n*>\n 01  WS-amount-work7.\n     03  amt-wk-pds7     pic 9(7).\n     03  amt-wk-pence7   pic v99.\n 01  WS-amount-ok7 redefines WS-amount-work7.\n     03  amt-ok7         pic 9(7)v99.\n*>\n 01  WS-amount-screen-display7b.\n     03  WS-poundsd7b    pic 9(7).\n     03  WS-period7b     pic x     value \".\".\n     03  WS-penced7b     pic v9999.\n 01  WS-amount-screen-accept7b redefines WS-amount-screen-display7b.\n     03  WS-pound7b      pic 9(7).\n     03  filler          pic x.\n     03  WS-pence7b      pic v9999.\n*>\n 01  WS-amount-work7b.\n     03  amt-wk-pds7b    pic 9(7).\n     03  amt-wk-pence7b  pic v9999.\n 01  WS-amount-ok7b redefines WS-amount-work7b.\n     03  amt-ok7b        pic 9(7)v9999.\n*>\n 01  WS-amount-screen-display9.\n     03  WS-poundsd9     pic 9(9).\n     03  WS-period9      pic x     value \".\".\n     03  WS-penced9      pic v99.\n 01  WS-amount-screen-accept9 redefines WS-amount-screen-display9.\n     03  WS-pound9       pic 9(9).\n     03  filler          pic x.\n     03  WS-pence9       pic v99.\n*>\n 01  WS-amount-work9.\n     03  amt-wk-pds9     pic 9(9).\n     03  amt-wk-pence9   pic v99.\n 01  WS-amount-ok9 redefines WS-amount-work9.\n     03  amt-ok9         pic 9(9)v99.\n*>\n 01  work-fields.\n     03  Menu-Reply      pic 9.\n     03  WS-reply        pic x.\n     03  WS-menu         pic 9.\n     03  Escape-Code     pic x.\n     03  Line-Cnt        binary-char unsigned value zero. *> Increase or decrease by 3 for every stk item reported\n     03  WS-Page-Lines   binary-char unsigned value 56.   *> 16/12/24 as system is for Portrait and Landscape used.\n     03  Page-Nos        binary-char unsigned value zero.\n     03  a               binary-char unsigned value zero.\n     03  b               pic 9.\n     03  c               pic 9.\n     03  z1              pic 99 comp  value zero.\n*>\n     03  WS-Stock-Dates.\n         05  WS-Stock-Order-Date pic x(10).\n         05  WS-Stock-Order-Due  pic x(10).\n     03  WS-Test-Date    pic x(10).\n     03  WS-Contruct-Key pic x(13).\n     03  WS-Temp-Stock-Key   pic x(13).    *> 1/07\n     03  WS-Save-Stock-Key   pic x(13).\n     03  WS-Save-Abrev-Key   pic x(7).\n     03  WS-Temp-Abrev-Key.\n         05  WS-Abrev-K2     pic x(6).\n         05  WS-Abrev-Chk2   pic 9.\n     03  WS-Stock-Supplier.\n         05  filler          pic x(6).\n         05  WS-Stock-Supp-7 pic x.\n     03  WS-z6           pic z(6).\n     03  WS-z6b          pic z(6).\n     03  WS-z6c          pic z(6).\n     03  WS-Rec-Total    pic zzz,zzz,zz9.\n*>\n     03  WS-env-lines    pic 999              value zero.\n     03  WS-lines        binary-char unsigned value zero.\n     03  WS-22-lines     binary-char unsigned value zero.\n     03  WS-23-lines     binary-char unsigned value zero.\n     03  WS-Rec-Cnt      binary-long unsigned value zero.\n*>\n 01  SS-Stock-Variables.\n     03  SS-Stock-Construct-Bundle   pic 9(6).\n     03  SS-Stock-Under-Construction pic 9(6).\n     03  SS-Stock-Work-in-Progress   pic 9(6).\n     03  SS-Stock-ReOrder-Pnt        pic 9(6).\n     03  SS-Stock-Std-ReOrder        pic 9(6).\n     03  SS-Stock-Back-Ordered       pic 9(6).\n     03  SS-Stock-On-Order           pic 9(6).\n     03  SS-Stock-Held               pic 9(6).\n     03  SS-Stock-Pre-Sales          pic 9(6).\n     03  SS-Stock-Retail             pic 9(7)v99.\n     03  SS-Stock-Cost               pic 9(7)v9999.\n     03  SS-Stock-Value              pic 9(9)v99.\n*>\n 01  accept-terminator-array pic 9(4)         value zero.\n     copy \"screenio.cpy\".\n*>\n*> the following for GC and screen\n*>\n 01  wScreenName             pic x(256).\n 01  wInt                    binary-long.\n*>\n 01  WS-date-formats.\n     03  WS-swap             pic xx.\n     03  WS-Conv-Date        pic x(10).\n     03  WS-date             pic x(10).\n     03  WS-UK redefines WS-date.\n         05  WS-days         pic xx.\n         05  filler          pic x.\n         05  WS-month        pic xx.\n         05  filler          pic x.\n         05  WS-year         pic x(4).\n     03  WS-USA redefines WS-date.\n         05  WS-usa-month    pic xx.\n         05  filler          pic x.\n         05  WS-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  WS-Intl redefines WS-date.\n         05  WS-intl-year    pic x(4).\n         05  filler          pic x.\n         05  WS-intl-month   pic xx.\n         05  filler          pic x.\n         05  WS-intl-days    pic xx.\n*>\n 01  hdtime                            value spaces.\n     03  hd-hh           pic xx.\n     03  hd-mm           pic xx.\n     03  hd-ss           pic xx.\n     03  hd-uu           pic xx.\n*>\n 01  File-Info                          value zero.\n     05 File-Size-Bytes  pic 9(18) comp.\n     05 Mod-DD           pic 9(2)  comp.\n     05 Mod-MO           pic 9(2)  comp.\n     05 Mod-YYYY         pic 9(4)  comp.\n     05 Mod-HH           pic 9(2)  comp.\n     05 Mod-MM           pic 9(2)  comp.\n     05 Mod-SS           pic 9(2)  comp.\n     05 filler           pic 9(2)  comp. *> Always 00\n*>\n*> Print layouts to 132 cols\n*>\n 01  Line-1.\n     03  L1-Program      pic x(16)     value spaces.\n     03  filler          pic x(41)     value spaces.\n     03  filler          pic x(17)     value \"Stock File Report\".\n     03  filler          pic x(50)     value spaces.\n     03  filler          pic x(5)      value \"Page \".\n     03  L1-Page         pic zz9.\n*>\n 01  line-2.\n     03  L2-User         pic x(40).\n     03  filler          pic x(76)     value spaces.\n     03  L2-Date         pic x(10).\n     03  filler          pic x         value space.\n     03  L2-HH           pic xx        value spaces.\n     03  filler          pic x         value \":\".\n     03  L2-MM           pic xx        value spaces.\n*>\n 01  line-3.\n     03  filler          pic x(132)  value\n         \"<------ Stock ------> Supplier  Location     Unit      Unit        Value    Number\" &\n         \" <- ReOrder -> <------- Date ------>  Quantity On\".\n*>\n 01  line-4.\n     03  filler          pic x(132)  value\n         \"Abrev   Number         Number               Price      Cost        in Stk   in Stk\" &\n         \"  Point    Qty   Ordered     Due      Order  B/Ord\".\n*>\n 01  line-5.\n     03  L5-Abbrev-Stock pic x(8).\n     03  L5-Stock-Number pic x(14).\n     03  L5-Supplier-No  pic x(8).         *> 30\n     03  L5-Location     pic x(11).        *> 41\n     03  L5-Retail       pic z(6)9.99.     *> 51\n     03  L5-Cost         pic z(6)9.9999.   *> 63\n     03  L5-Costx redefines L5-Cost.       *> helps to clear fraction of a penny/cent when zero\n         05  filler      pic x(10).\n         05  L5-Costz    pic xx.\n     03  L5-Value        pic zzzzz,zz9.99. *> 75\n     03  L5-Held         pic z(6)9.        *> 82\n     03  L5-Reord-Pnt    pic z(6)9.        *> 89\n     03  L5-Reord-Qty    pic z(6)9b.       *> 97\n     03  L5-Date-Ordered pic x(11).        *> 108\n     03  L5-Date-Due     pic x(10).        *> 118\n     03  L5-Qty-Ordered  pic z(6)9.        *> 125\n     03  L5-Qty-Back-Ord pic z(6)9.        *> 132\n*>\n 01  line-6.\n     03  filler          pic x(5)   value spaces.\n     03  filler          pic x(13)  value \"Description: \".\n     03  L6-Desc         pic x(32)  value spaces.\n     03  filler          pic x(5)   value spaces.\n     03  L6-vars         pic x(77).\n*>\n copy \"wsstock.cob\".     *> 3.02\n copy \"wspl.cob\".\n copy \"wsanal.cob\".\n copy \"wsfnctn.cob\".     *> Used in acas011, stockMT\n copy \"wsmaps03.cob\".\n copy \"wsmaps09.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n*>     03  System-Record          pic x.\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n*>     03  WS-Stock-Record        pic x.\n     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n     03  WS-Delivery-Record     pic x.\n*>     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n*>     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  ST000          pic x(36) value \"ST000 Error on Writing to Stock Rec \".   *> ????\n*>     03  ST000          pic x(36) value \"ST000 Error on Writing to Stock File\".\n     03  ST003          pic x(25) value \"ST003 Hit return for Menu\".\n     03  ST005          pic x(18) value \"ST005 Invalid Date\".\n     03  ST006          pic x(30) value \"ST006 Press return to continue\".\n     03  ST008          pic x(31) value \"ST008 Note message & Hit return\".\n     03  ST011          pic x(33) value \"ST011 Error on stockMT processing\".\n     03  ST012          pic x(33) value \"ST012 Error on purchMT processing\".\n*> Module Specific\n     03  ST101          pic x(24) value \"ST101 Supplier not found\".\n     03  ST102          pic x(46) value \"ST102 Abbreviated Stock number Must be present\".\n     03  ST103          pic x(38) value \"ST103 Abbreviated Stock number Invalid\".\n     03  ST104          pic x(46) value \"ST104 Purchase Ledger not yet set up, Aborting\".\n     03  ST105          pic x(41) value \"ST105 Purchase Ledger not found, Aborting\".\n*>     03  ST106          pic x(45) value \"ST106 Stock Table not yet used, nothing to do\".\n     03  ST106          pic x(41) value \"ST106 Stock File not found, nothing to do\".\n     03  ST107          pic x(51) value \"ST107 Cannot Delete record as non zero values exist\".\n     03  ST108          pic x(37) value \"ST108 Delete failed on Stock Rec   = \".\n*>     03  ST108          pic x(36) value \"ST108 Delete failed on Stock File = \".\n     03  ST109          pic x(50) value \"ST109 Cannot Renumber record as Order values exist\".\n     03  ST110          pic x(44) value \"ST110 Cannot find Sales Ledger Analysis Code\".\n     03  ST111          pic x(47) value \"ST111 Cannot find Purchase Ledger Analysis Code\".\n     03  ST112          pic x(39) value \"ST112 Analysis File not found, Aborting\".\n     03  ST113          pic x(49) value \"ST113 Abbreviated Stock Number is already on file\".\n     03  ST114          pic x(28) value \"ST114 Stock Number not found\".\n     03  ST115          pic x(38) value \"ST115 Construct Stock Number not found\".\n     03  ST116          pic x(37) value \"ST116 Stock Number is already on file\".\n     03  ST117          pic x(47) value \"ST117 Stock Number/Abrev No. is already on file\".\n     03  ST118          pic x(51) value \"ST118 Service Flag is set, so unused values cleared\".\n     03  ST119          pic x(32) value \"ST119 No more records to display\".\n     03  ST120          pic x(33) value \"ST120 Error on analMT processing\".\n*>\n 01  error-code         pic 999    value zero.\n*>\n linkage section.\n*>***************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day             pic x(10).\n*>\n screen section.\n*>**************\n*>\n 01  display-01                  background-color cob-color-black\n                                 foreground-color cob-color-green erase eos.\n     03  value \"Stock Number     - [\" line  4 col  1.\n*>   03   using WS-Stock-Key pic x(13) col 21. has an accept verb to get info\n     03  value \"]\"                            col 34.\n     03  value \"PL Fast key  - [\"             col 41.\n*>   03   using WS-Stock-Abrev-Key pic x(7) col 57. has an accept verb to get info\n     03  value \"]\"                            col 64.\n     03  value \"Desc [\"               line  5 col  1.\n     03  using WS-Stock-Desc pic x(32)        col  7 foreground-color 3.\n     03  value \"]\"                            col 39.\n     03  value \"Stock Location [\"             col 41.\n     03  using WS-Stock-Location  pic x(10)   col 57 foreground-color 3.\n     03  value \"]\"                            col 67.\n     03  value \"Supplier: 1 - [\"      line  6 col  1.\n     03  using Stock-Supplier-P1 pic x(7)     col 16 foreground-color 3.\n     03  value \"] : 2 - [\"                    col 23.\n     03  using Stock-Supplier-P2 pic x(7)     col 32 foreground-color 3.\n     03  value \"]\"                            col 39.\n     03  value \": 3 - [\"                      col 50.\n     03  using Stock-Supplier-P3 pic x(7)     col 57 foreground-color 3.\n     03  value \"]\"                            col 64.\n     03  value \"Stock Qty        - [\" line  7 col  1.\n     03  using SS-Stock-Held     pic 9(6)     col 21 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Qty Ordered      - [\"         col 41.\n     03  using SS-Stock-On-Order pic 9(6)     col 61 foreground-color 3.\n     03  value \"]\"                            col 67.\n     03  value \"Re-Order Point   - [\" line  8 col  1.\n     03  using SS-Stock-ReOrder-Pnt pic 9(6)  col 21 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Back Ordered     - [\"         col 41.\n     03  using SS-Stock-Back-Ordered pic 9(6) col 61 foreground-color 3.\n     03  value \"]\"                            col 67.\n     03  value \"Re-Order Qty     - [\" line  9 col  1.\n     03  using SS-Stock-Std-ReOrder pic 9(6)  col 21 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Sales Orders O/S - [\"         col 41.\n     03  using SS-Stock-Pre-Sales pic 9(6)    col 61 foreground-color 3.\n     03  value \"]\"                            col 67.\n     03  value \"Sales Anal. Code - [\" line 10 col  1.\n     03  using Stock-SA-Group pic xx          col 21 foreground-color 3.\n     03  value \"]\"                            col 23.\n     03  value \"Purch Anal. Code - [\"         col 41.\n     03  using Stock-PA-Group pic xx          col 61 foreground-color 3.\n     03  value \"]\"                            col 63.\n     03  value \"Services only Flag [\" line 11 col  1.\n     03  using Stock-Services-Flag pic x      col 21 foreground-color 3.\n     03  value \"] (Y/N)\"                      col 22.\n     03  value \"Date Ordered - [\"     line 12 col  1.\n     03  using WS-Stock-Order-Date pic x(10)  col 17 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Date Due     - [\"             col 41.\n     03  using WS-Stock-Order-Due pic x(10)   col 57 foreground-color 3.\n     03  value \"]\"                            col 67.\n*>\n*> Escape function box\n*>\n     03  value \"*******************\"  line 18 col 61 erase eol.\n     03  value \"* Escape Code [ ] *\"  line 19 col 61 erase eol.\n     03  value \"* <B> = Back      *\"  line 20 col 61 erase eol.\n     03  value \"* <S> = Save      *\"  line 21 col 61 erase eol.\n     03  value \"* <Q> = Quit      *\"  line 22 col 61 erase eol.\n     03  value \"*******************\"  line 23 col 61 erase eol.\n*>\n 01  Display-01B                  background-color cob-color-black\n                                 foreground-color cob-color-green.   *> Display for accepting money amounts\n*> these values from accepts\n     03  value \"Retail Price - [\"     line 13 col  1.\n*>     03  using SS-Stock-Retail pic 9(7).99    col 17 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Cost   Price - [\"             col 41.\n*>     03  using SS-Stock-Cost pic 9(7).9999    col 57 foreground-color 3.\n     03  value \"]\"                            col 69.\n     03  value \"Stock Value  - [\"     line 14 col  1.\n*>     03  using SS-Stock-Value pic 9(9).99     col 17 foreground-color 3.\n     03  value \"]\"                            col 29.\n*>\n 01  Display-01C                  background-color cob-color-black\n                                 foreground-color cob-color-green.   *> Display for money amounts (Display Only)\n*> these values from accepts\n     03  value \"Retail Price - [\"     line 13 col  1.\n     03  using Stock-Retail pic 9(7).99       col 17 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Cost   Price - [\"             col 41.\n     03  using Stock-Cost pic 9(7).9999       col 57 foreground-color 3.\n     03  value \"]\"                            col 69.\n     03  value \"Stock Value  - [\"     line 14 col  1.\n     03  using Stock-Value pic 9(9).99        col 17 foreground-color 3.\n     03  value \"]\"                            col 29.\n*>\n*> used only if Stk-Manu-Used = 1\n*>\n 01  display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  value \"Optional - Work In Progress (BOMP) Data\"\n                                      line 15 col 21 highlight.\n     03  value \"Construct Bundle - [\" line 16 col  1.\n     03  using Stock-Construct-Bundle pic 9(6) col 21 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Construction   - [\"           col 41.\n     03  using Stock-Under-Construction pic 9(6)\n                                              col 59 foreground-color 3.\n     03  value \"]\"                            col 65.\n     03  value \"Work In Progress - [\" line 17 col  1.\n     03  using Stock-Work-in-Progress  pic 9(6)\n                                              col 21 foreground-color 3.\n     03  value \"]\"                            col 27.\n     03  value \"Construct Item - [\"           col 41.\n     03  using Stock-Construct-Item pic x(13) col 59 foreground-color 3.\n     03  value \"]\"                            col 72.\n*>\n 01  Display-F1-Display          background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  value \"stock # = *  = All stock, one at a time - ESC to quit\"\n                                      line 23 col 1 foreground-color 3.\n*>\n procedure division using WS-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n aa000-Core                 section.\n*>*********************************\n     accept   WS-env-lines from lines.\n     if       WS-env-lines < 24\n              move  24 to WS-env-lines WS-lines\n     else\n              move  WS-env-lines to WS-lines\n     end-if\n     subtract 1 from WS-lines giving WS-23-lines.\n     subtract 2 from WS-lines giving WS-22-lines.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n*>\n*>  Set up delete file for screen save/restore.\n*>\n     move     spaces to Path-Work.\n     string   ACAS-Path       delimited by space\n              \"stk-temp.scr\"  delimited by size\n                                 into Path-Work.\n aa010-Menu-Return.\n     move     zero to Menu-Reply.\n     perform  zz010-Display-Heading.\n*>\n aa020-Menu-Input.\n*>\n*> New for RDB\n*>\n     if       FS-Cobol-Files-Used                *> Dup processing removed as redundant\n              call  \"CBL_CHECK_FILE_EXIST\" using File-11\n                                                 File-Info\n              end-call\n              if    return-code not = zero          *> not = zero - No file found\n                    perform ba000-Setup-Stock       *> so force setup stock data\n                    go to aa010-Menu-Return\n              end-if\n     end-if\n*>\n     display  \"Select one of the following by number :- [ ]\" at 0701 with foreground-color 2.\n*>\n     display  \"(1)  Set-up Stock records\"   at 0904 with foreground-color 2.\n     display  \"(2)  Amend Stock records\"    at 1104 with foreground-color 2.\n     display  \"(3)  Delete Stock records\"   at 1304 with foreground-color 2.\n     display  \"(4)  Renumber Stock records\" at 1504 with foreground-color 2.\n     display  \"(5)  Display Stock records\"  at 1704 with foreground-color 2.\n     display  \"(6)  Print Stock records\"    at 1904 with foreground-color 2.\n     display  \"(9)  Return to System Menu\"  at 2104 with foreground-color 2.\n*>\n     accept   Menu-Reply at 0743 with foreground-color 6 auto.\n*>\n     if       menu-reply = 9\n              go to  aa999-Exit.\n*>\n     if       menu-reply < 1 or > 6\n              go to  aa020-Menu-Input.\n*>\n     if       menu-reply = 1\n              perform ba000-Setup-Stock\n     else\n      if      menu-reply = 2\n              perform ca000-Amend-Stock\n      else\n       if     menu-reply = 3\n              perform da000-Delete-Stock\n       else\n        if    Menu-Reply = 4\n              perform ga000-Renumber-Stock\n        else\n         if   menu-reply = 6\n              perform ea000-Report-Stock\n         else\n          if  menu-reply = 5\n              perform fa000-Display-Stock.\n*>\n     go       to aa010-Menu-Return.\n*>\n maps04.\n     call     \"maps04\" using maps03-ws.\n*>\n maps09.\n     call     \"maps09\" using maps09-ws.   *> customer-code.  *> 27/01/24\n*>\n*> aa020-Rollback.\n*>\n*> These do not work during testing with mariadb, Non transactional model or\n*>  autocommit set ON. Likewise if not using InnoDB but left in in case user\n*>  switches using correct engine !!\n*>\n*>  In reality, using Cobol files they are commited so it is left as default\n*> --------------------------------------------------------------------------\n*>           exec sql\n*>                rollback\n*>           end-exec.\n *>    call     \"MySQL_rollback\".\n*>     if       return-code not = zero\n*>              display \"Rollback failed \" at 2301\n*>              display return-code      at 2317\n*>     end-if.\n*>\n*> aa030-Commit.            *> Not called\n*>           exec sql\n*>                commit\n*>           end-exec.\n*>     call     \"MySQL_commit\".\n*>     if       return-code not = zero\n*>              display \"Commit failed \" at 2301\n*>              display return-code      at 2315\n*>     end-if.\n*>\n aa100-Check-4-Errors.                       *> Stock-Record - if any errors",
        "line": 79
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display ST011            at 0601 with erase eos  *> acas011/StockMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n *>             if      FS-RDBMS-Used\n *>                     perform aa020-Rollback\n *>             end-if\n              display ST003 at 1101 with erase eol\n              accept  Accept-Reply at 1135\n              go to  aa999-Exit\n     end-if.\n*>\n aa101-Check-4-Errors.                       *> Purch-Record - if any errors",
        "line": 742
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display ST012            at 0601 with erase eos  *> acas022/PurchMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n *>             if      FS-RDBMS-Used\n *>                     perform aa020-Rollback\n *>             end-if\n              display ST003 at 1101 with erase eol\n              accept  Accept-Reply at 1135\n              go to  aa999-Exit\n     end-if.\n*>\n aa102-Check-4-Errors.                       *> Anal-Record - if any errors",
        "line": 757
      },
      {
        "type": "IF",
        "condition": "fs-reply not = zero\n              display ST120            at 0601 with erase eos  *> acas015/analMT processing\n              display \"Fs-reply = \"    at 0701\n              display fs-reply         at 0712\n              display \"WE-Error = \"    at 0801\n              display WE-Error         at 0812\n *>             if      FS-RDBMS-Used\n *>                     perform aa020-Rollback\n *>             end-if\n              display ST003 at 1101 with erase eol\n              accept  Accept-Reply at 1135\n              go to  aa999-Exit\n     end-if.\n*>\n*>\n Clear-Error-Line.\n     display  \" \" at line WS-23-lines col 01 with erase eol.\n*>\n aa999-Exit.\n     exit program.\n*>\n ba000-Setup-Stock      section.\n*>*****************************\n*>\n     perform  Purch-Open-Input.\n     if       fs-reply not = zero\n              display ST104 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              exit program\n              go to ba999-exit.   *> safe guard\n*>\n     perform  Stock-Open.\n     if       fs-reply not = zero\n        or    WE-Error not zero\n              Perform aa100-Check-4-Errors\n              perform Purch-Close\n              perform Stock-Close\n              exit program\n     end-if.\n     move     \"Y\" to Stock-Control.\n     if       FS-Cobol-Files-Used\n              call  \"CBL_CHECK_FILE_EXIST\" using File-15\n                                                 File-Info\n              end-call\n              if    return-code not = zero          *> not = zero - No file found\n                    move 1 to WS-Process-Func\n                              WS-Sub-Function\n                    call \"sl070\" using WS-Calling-Data\n                                       System-Record\n                                       To-Day\n                                       File-Defs\n                    end-call\n              end-if\n     end-if\n     perform  Analysis-Open-Input.\n     if       fs-Reply not = zero\n              perform  aa102-Check-4-Errors.\n*>\n ba010-Display-Stock-Headings.\n     perform  zz020-Display-Outline.\n*>\n     initialize WS-Stock-Record with filler.                  *> chgd 4 acas011\n     perform  zz070-Initialize-Stock-Record.\n     move     spaces to WS-Stock-Key (13:1)\n                        WS-Stock-Abrev-Key (7:1)\n                        Customer-Code WS-Stock-Dates.\n     move     \"N\" to Stock-Services-Flag.\n*>\n ba020-Stock-Item-Accept.\n     display  \" \" at 0467.\n     accept   WS-Stock-Key at 0421 with foreground-color 3.\n     if       WS-Stock-Key = spaces\n          or  Cob-Crt-Status = Cob-Scr-Esc\n              go to  ba998-Main-End.\n     move     function upper-case (WS-Stock-Key) to WS-Temp-Stock-Key.           *> chgd 4 acas011\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n*>\n ba030-Stock-Abrev-Item-Accept.\n     accept   WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n          or  Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to ba020-Stock-Item-Accept\n     end-if\n     if       WS-Stock-Abrev-Key not = spaces\n              move  function upper-case (WS-Stock-Abrev-Key) to WS-Stock-Abrev-Key\n                                                                   Customer-Code\n              display WS-Stock-Abrev-Key at 0457 with foreground-color 3\n              perform  clear-error-line\n     else\n              display ST102 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba030-Stock-Abrev-Item-Accept\n     end-if\n*>\n*>  Check that keys do NOT exist\n*>\n     move     1 to File-Key-No.             *>  1=stock-key, 2=Abrev, 3=Desc\n     perform  Stock-Read-Indexed.\n     if       (fs-Reply not = 23 and not = 21)            *> invalid key but for RDB it's 23\n              display ST113 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ba020-Stock-Item-Accept.\n*>\n     move     Customer-Code to WS-Stock-Abrev-Key.\n     if       WS-Stock-Abrev-Key not = spaces\n              move   2 to File-Key-No\n              perform Stock-Read-Indexed\n*>              read   Stock-File key is WS-Stock-Abrev-Key not invalid key\n              if     (fs-Reply not = 23 and not = 21)           *> invalid key but for RDB its 23\n                     display ST116 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     go to ba020-Stock-Item-Accept.\n*>\n*>  Now, we have unused Stock keys\n*>\n     perform  clear-error-line.\n     move     customer-code to WS-Stock-Abrev-Key.\n     move     WS-Temp-Stock-Key  to WS-Stock-Key.\n     initialise SS-Stock-Variables.\n*>\n ba040-Accept-Block.\n     accept   Display-01.      *> get all data but not money fields\n     If       Cob-Crt-Status = Cob-Scr-Esc\n              go to ba020-Stock-Item-Accept.\n*>\n*> If F3 allow set up of a supplier",
        "line": 772
      },
      {
        "type": "IF",
        "condition": "Cob-Crt-Status = COB-SCR-F3\n              move     zero to WS-term-code\n              move     z\"stk-temp.scr\"  to wScreenName\n              call     \"scr_dump\"    using wScreenName returning wInt\n              call     \"pl010\" using WS-calling-data system-record to-day file-defs\n              call     \"scr_restore\" using wScreenName returning wInt\n              call     \"CBL_DELETE_FILE\" using Path-Work\n *>             perform  zz010-Display-Heading\n *>             display  Display-01\n *>             display  WS-Stock-Key at 0421 with foreground-color 3\n *>             display  WS-Stock-Abrev-Key at 0457 with foreground-color 3\n              go       to ba040-Accept-Block.\n*>\n*>  If Suppliers included, they are now checked for presence on Purchase Ledger\n*>\n     move     zero to c.\n     perform  varying b from 1 by 1 until b > 3\n              if       Stock-Suppliers (b) not = spaces\n                       move     function upper-case (Stock-Suppliers (b)) to Stock-Suppliers (b)\n                                                                             WS-Stock-Supplier\n                       perform  zz040-Check-for-Supplier\n                       if       Error-Code not = zero\n                                multiply b by 2 giving a\n                                add      20 to a\n                                if       c = zero    *> display only once\n                                         move 1 to c\n                                         display ST101\n                                                    at line WS-23-lines col 1 with foreground-color 4 highlight\n                                end-if\n                                display b at line WS-23-lines col a with foreground-color 4 highlight\n                       end-if\n                       move     WS-Stock-Supplier to Stock-Suppliers (b)\n              end-if\n     end-perform\n     if       c not = zero\n              go to ba040-Accept-Block.\n*>\n     perform  Clear-Error-Line.\n*>\n*> If PA or SA anal codes present they are checked for on analysis file.\n*>\n     move     function lower-case (Stock-PA-Group) to Stock-PA-Group.\n     display  Stock-PA-Group at 1057 with foreground-color 3.\n     if       Stock-PA-Group not = spaces\n              move \"P\" to Stock-PA-System\n              move Stock-PA-Code to WS-PA-Code\n              perform Analysis-Start\n              if     fs-Reply = 21 or = 23\n                     display ST111 at line WS-23-lines col 1 with foreground-color 4 highlight\n                     go to ba040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     move     function lower-case (Stock-SA-Group) to Stock-SA-Group.\n     display  Stock-SA-Group at 1021 with foreground-color 3.\n     if       Stock-SA-Group not = spaces\n              move \"S\" to Stock-SA-System\n              move Stock-SA-Code to WS-PA-Code\n              perform  Analysis-Start\n              if    FS-Reply = 21 or = 23\n                    display ST110 at line WS-23-lines col 1 with foreground-color 4 highlight\n                    go to ba040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if     *>              end-start\n     end-if\n*>\n*>   Display and get money fields",
        "line": 899
      },
      {
        "type": "IF",
        "condition": "Stk-Manu-Used = 1\n              accept Display-02.\n*>\n*>  Calc Stock-Value only if Stock-Averaging is set\n*>\n     if       Stock-Averaging\n         and  Stock-Value = zero\n         and  Stock-Cost not = zero\n         and  Stock-Held not = zero\n              multiply Stock-Held by Stock-Cost giving Stock-Value\n              if Stk-Manu-Used = 1\n                 compute Stock-Value = Stock-Value + (Stock-Cost * Stock-Work-in-Progress).\n*>\n     if       WS-Stock-Order-Date not = spaces\n              move WS-Stock-Order-Date to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n                 display \" \" at 1228\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1228 with foreground-color 4 highlight\n                 go to ba040-Accept-Block\n              end-if\n     else\n              move zero to Stock-Order-Date\n     end-if\n*>\n     if       WS-Stock-Order-Due not = spaces\n              move WS-Stock-Order-Due to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Due\n                 display \" \" at 1268\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1268 with foreground-color 4 highlight\n                 go to ba040-Accept-Block\n     else\n              move zero to Stock-Order-Due.\n*>\n     display  space at 1228.  *> incase 1st was entered",
        "line": 993
      },
      {
        "type": "IF",
        "condition": "Stock-Construct-Item not = spaces\n              move    function upper-case (Stock-Construct-Item) to Stock-Construct-Item\n                                                                    WS-Contruct-Key\n              display Stock-Construct-Item at 1659 with foreground-color 3\n              move    WS-Stock-Record to WS-Saved-Stock-Record\n              move    WS-Contruct-Key to WS-Stock-Key\n              move    1 to File-Key-No\n*>              set     fn-Equal-to to true\n              move    5 to Access-Type   *> =\n              perform Stock-Start\n              if      fs-Reply = 21                *> invalid key\n                      display ST115 at line WS-23-lines col 1 with foreground-color 4 highlight\n                      move  WS-saved-stock-record to WS-Stock-Record\n                      go    to ba040-Accept-Block\n              end-if\n              move     WS-saved-stock-record to WS-Stock-Record\n     end-if\n*>\n*> if stock-services-flag set clear down unneeded values inc. WIP & redisplay\n*>\n     if       Stock-Services-Flag not = space\n              move function upper-case (Stock-Services-Flag) to Stock-Services-Flag.\n     if       Stock-Services-Flag = \"Y\"\n              move spaces to Stock-Construct-Item WS-Stock-Order-Due WS-Stock-Order-Date\n              move zero to Stock-Construct-Bundle  Stock-Under-Construction\n                           Stock-Work-in-Progress  Stock-ReOrder-Pnt\n                           Stock-Std-ReOrder       Stock-Back-Ordered\n                           Stock-On-Order          Stock-Pre-Sales\n                           Stock-Value\n                           Stock-Order-Due         Stock-Order-Date\n              display  display-01\n              display  display-01C\n              if       Stk-Manu-Used = 1\n                       display Display-02\n              end-if\n              display ST118 at line WS-23-lines col 1 with foreground-color 2 highlight\n     end-if\n     move     \"S\" to Escape-Code.\n     perform  zz100-Test-Escape.\n*>\n ba050-Main-Output.\n     if       escape-code = \"Q\"\n         or   Cob-Crt-Status = Cob-Scr-Esc\n              go to  ba998-Main-End.\n*>\n     if       escape-code = \"B\"\n         or   Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to ba020-Stock-Item-Accept.\n*>\n     perform  Stock-Write.\n     if       fs-reply not = zero  *> could be 22 (Dup key) or 99 (any other)\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line WS-23-lines col 38 with foreground-color 4 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ba998-Main-End.\n*>\n *>    initialize WS-Stock-Record with filler.\n     perform  zz070-Initialize-Stock-Record.\n     move     spaces to WS-Stock-Dates.\n     go       to ba010-Display-Stock-Headings.\n*>\n ba998-Main-End.\n     perform  Analysis-Close.\n     perform  Purch-Close.\n     perform  Stock-Close.\n*>\n ba999-Exit.\n     exit     section.\n*>\n ca000-Amend-Stock          section.\n*>*********************************\n*>  can any of this be removed although purch is needed for supplier details ???????\n     perform  Purch-Open-Input.\n     if       fs-reply not = zero\n              display ST105 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ca999-exit.\n*>\n     perform  Stock-Open.\n     if       fs-reply not = zero\n        or    WE-Error not zero\n              display ST106 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ca998-Main-End.\n*>\n     perform  Analysis-Open-Input.\n     if       fs-reply not = zero\n              display ST112 at line WS-23-lines col 1 with foreground-color 4 highlight\n              perform Purch-Close        *> close Purchase-File   Stock-File\n              perform Stock-Close\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ca999-exit.\n*>\n ca010-Display-Stock-Headings.\n     perform  zz020-Display-Outline.\n*>\n ca020-Stock-Item-Accept.\n *>    initialize WS-Stock-Record with filler.\n     perform  zz070-Initialize-Stock-Record.\n     move     spaces to WS-Stock-Key (13:1)\n                        WS-Stock-Abrev-Key (7:1)\n                        Customer-Code WS-Stock-Dates.\n     display  \" \" at 0467.\n     accept   WS-Stock-Key at 0421 with foreground-color 3.\n     if       WS-Stock-Key = spaces\n          or  Cob-Crt-Status = Cob-Scr-Esc\n              go to  ca998-Main-End.\n     move     function upper-case (WS-Stock-Key) to WS-Stock-Key\n                                                    WS-Temp-Stock-Key.\n*>\n ca030-Get-Record.\n     move     1 to File-Key-No.             *>  1=stock-key, 2=Abrev, 3=Desc\n     perform  Stock-Read-Indexed.\n     if       fs-Reply = 23 or = 21\n              display ST114 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ca020-Stock-Item-Accept.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n     perform  Clear-Error-Line.\n*>\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay, now dates are converted\n*>\n     perform  zz080-Copy-To-SS.\n     display  display-01.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n*>\n ca040-Accept-Block.\n     accept   display-01.      *> get all data but not money fields\n     If       Cob-Crt-Status = Cob-Scr-Esc\n              go to ca020-Stock-Item-Accept.\n*>\n*> If F3 allow set up of a supplier",
        "line": 1038
      },
      {
        "type": "IF",
        "condition": "Cob-Crt-Status = COB-SCR-F3\n              move     zero to WS-term-code\n              move     z\"stk-temp.scr\"  to wScreenName\n              call     \"scr_dump\"    using wScreenName returning wInt\n              call     \"pl010\" using WS-calling-data system-record to-day file-defs\n              call     \"scr_restore\" using wScreenName returning wInt\n              call     \"CBL_DELETE_FILE\" using Path-Work\n *>             perform  zz010-Display-Heading\n *>             display  Display-01\n *>             display  WS-Stock-Key at 0421 with foreground-color 3\n *>             display  WS-Stock-Abrev-Key at 0457 with foreground-color 3\n              go       to ca040-Accept-Block.\n*>\n*>  If Suppliers included, they are now checked for presence on Purchase Ledger\n*>\n     move     zero to c.\n     perform  varying b from 1 by 1 until b > 3\n              if       Stock-Suppliers (b) not = spaces\n                       move     function upper-case (Stock-Suppliers (b)) to Stock-Suppliers (b)\n                                                                             WS-Stock-Supplier\n                       perform  zz040-Check-for-Supplier\n                       if       Error-Code not = zero\n                                multiply b by 2 giving a\n                                add      20 to a\n                                if       c = zero    *> display only once\n                                         move 1 to c\n                                         display ST101\n                                                    at line WS-23-lines col 1 with foreground-color 4 highlight\n                                end-if\n                                display b at line WS-23-lines col a with foreground-color 4 highlight\n                       end-if\n                       move     WS-Stock-Supplier to Stock-Suppliers (b)\n              end-if\n     end-perform\n     if       c not = zero\n              go to ca040-Accept-Block.\n*>\n     perform  Clear-Error-Line.\n*>\n*> If PA or SA anal codes present they are checked for on analysis file.\n*>\n     move     function lower-case (Stock-PA-Group) to Stock-PA-Group.\n     display  Stock-PA-Group at 1057 with foreground-color 3.\n     if       Stock-PA-Group not = spaces\n              move \"P\" to Stock-PA-System\n              move Stock-PA-Code to WS-PA-Code\n              perform Analysis-Start\n              if   FS-Reply = 21 or = 23\n                   display ST111 at line WS-23-lines col 1 with foreground-color 4 highlight\n                   go to ca040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if\n     end-if\n*>\n     move     function lower-case (Stock-SA-Group) to Stock-SA-Group.\n     display  Stock-SA-Group at 1021 with foreground-color 3.\n     if       Stock-SA-Group not = spaces\n              move \"S\" to Stock-SA-System\n              move Stock-SA-Code to WS-PA-Code\n              perform Analysis-Start\n              if   FS-Reply = 21 or = 23\n                   display ST110 at line WS-23-lines col 1 with foreground-color 4 highlight\n                   go to ca040-Accept-Block\n              end-if\n              if       fs-Reply not = zero\n                       perform  aa102-Check-4-Errors\n              end-if     *>      end-start\n     end-if\n*>\n*>   Display and get money fields",
        "line": 1191
      },
      {
        "type": "IF",
        "condition": "Stk-Manu-Used = 1\n              accept Display-02.\n*>\n*>  Calc Stock-Value only if Stock-Averaging is set\n*>\n     if       Stock-Averaging\n         and  Stock-Value = zero\n         and  Stock-Cost not = zero\n         and  Stock-Held not = zero\n              multiply Stock-Held by Stock-Cost giving Stock-Value.\n              if Stk-Manu-Used = 1\n                 compute Stock-Value = Stock-Value + (Stock-Cost * Stock-Work-in-Progress).\n*>\n     if       WS-Stock-Order-Date not = spaces\n              move WS-Stock-Order-Date to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Date\n                 display \" \" at 1228\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1228 with foreground-color 4 highlight\n                 go to ca040-Accept-Block\n     else     move zero to Stock-Order-Date.\n*>\n     if       WS-Stock-Order-Due not = spaces\n              move WS-Stock-Order-Due to WS-Test-Date\n              perform zz050-Validate-Date\n              if u-bin not = zero\n                 move u-bin to Stock-Order-Due\n                 display \" \" at 1268\n              else\n                 display ST005 at line WS-23-lines col 1 with foreground-color 4 highlight\n                 display \"*\" at 1268 with foreground-color 4 highlight\n                 go to ca040-Accept-Block\n     else     move zero to Stock-Order-Due.\n*>\n     display  \" \" at 1228.  *> incase 1st was entered",
        "line": 1285
      },
      {
        "type": "IF",
        "condition": "Stock-Construct-Item not = spaces\n              move    function upper-case (Stock-Construct-Item) to Stock-Construct-Item\n                                                                    WS-Contruct-Key\n              display Stock-Construct-Item at 1659 with foreground-color 3\n              move    WS-Stock-Record to WS-saved-stock-record\n              move    WS-Contruct-Key to WS-Stock-Key\n              move    1 to File-Key-No\n              move    5 to Access-Type   *> =\n              perform Stock-Start\n              if      fs-Reply = 21\n                      display ST115 at line WS-23-lines col 1 with foreground-color 4 highlight\n                      move   WS-saved-stock-record to WS-Stock-Record\n                      go to ca040-Accept-Block\n*>              end-start\n              end-if\n              move     WS-saved-stock-record to WS-Stock-Record\n     end-if\n*>\n*> if stock-services-flag set clear down unneeded values inc. WIP & redisplay\n*>\n     if       Stock-Services-Flag not = space\n              move function upper-case (Stock-Services-Flag) to Stock-Services-Flag.\n     if       Stock-Services-Flag = \"Y\"\n              move spaces to Stock-Construct-Item WS-Stock-Order-Due WS-Stock-Order-Date\n              move zero to Stock-Construct-Bundle  Stock-Under-Construction\n                           Stock-Work-in-Progress  Stock-ReOrder-Pnt\n                           Stock-Std-ReOrder       Stock-Back-Ordered\n                           Stock-On-Order          Stock-Pre-Sales\n                           Stock-Value\n                           Stock-Order-Due         Stock-Order-Date\n              display  display-01\n              display  display-01C\n              if       Stk-Manu-Used = 1\n                       display Display-02\n              end-if\n              display ST118 at line WS-23-lines col 1 with foreground-color 2 highlight\n     end-if\n     move     \"S\" to escape-code.\n     perform  zz100-test-escape.\n*>\n ca050-Main-Output.\n     if       escape-code = \"Q\"\n         or   Cob-Crt-Status = Cob-Scr-Esc\n              go to  ca998-main-end.\n*>\n     if       escape-code = \"B\"\n         or   Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to ca020-Stock-Item-Accept.\n*>\n     perform  Stock-Rewrite.\n     if       fs-reply not = zero\n              display ST000 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line WS-23-lines col 38 with foreground-color 4 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              go to ca998-main-end.\n*>\n *>    initialize WS-Stock-Record with filler.\n     perform  zz070-Initialize-Stock-Record.\n     move     spaces to WS-Stock-Dates.\n     go       to ca010-Display-Stock-Headings.\n*>\n ca998-Main-End.\n     perform  Purch-Close.\n     perform  Analysis-Close.\n     perform  Stock-Close.\n*>\n ca999-Exit.\n     exit     section.\n*>\n da000-Delete-Stock         section.\n*>*********************************\n*>\n     perform  Stock-Open.\n     if       fs-reply not = zero\n              perform Stock-Close\n              display ST106 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da999-Exit.\n*>\n da010-Display-Stock-Headings.\n     perform  zz020-Display-Outline.\n*>\n da020-Stock-Item-Accept.\n     move     spaces to WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code.\n     display  space at 2361 with erase eol.\n        perform  zz070-Initialize-Stock-Record.\n        initialise SS-Stock-Variables.\n     display  display-01.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n     accept   WS-Stock-Key at 0421 with foreground-color 3.\n     if       WS-Stock-Key = spaces\n          or  Cob-Crt-Status = Cob-Scr-Esc\n              perform Stock-Close\n              go to da999-Exit.\n     move     function upper-case (WS-Stock-Key) to WS-Stock-Key\n                                                 WS-Temp-Stock-Key.\n     display  space at line WS-23-lines col 1 with erase eos.\n*>\n da030-Get-Record.\n*>     read     Stock-File record key WS-Stock-Key invalid key\n     move     1 to File-Key-No.\n     perform  Stock-Read-Indexed.\n     if       fs-Reply = 21 or = 23              *> 23 for RDB\n              display ST114 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Stock-Item-Accept.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n     perform  Clear-Error-Line.\n*>\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n      perform  zz080-Copy-To-SS.\n     display  display-01.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n     display  \"* <D> = Delete    *\" at 2261 with foreground-color 2.\n     display  \"*******************\" at 2361 with foreground-color 2.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n*>\n     if       Stock-On-Order not = zero\n           or Stock-Held not = zero\n           or Stock-Back-Ordered not = zero\n              display ST107 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to da020-Stock-Item-Accept.\n*>\n     move     \"D\" to escape-code.\n     perform  zz100-test-escape.\n*>\n     if       escape-code = \"Q\"\n         or   Cob-Crt-Status = Cob-Scr-Esc\n              go to  da999-Exit.\n*>\n     if       escape-code = \"B\" or = \"S\"\n         or   Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to da020-Stock-Item-Accept.\n*>\n     if       escape-code not = \"D\"\n              go to  da010-Display-Stock-Headings.\n\n da040-Accept-Delete.\n     display  \"Deleting Stock Item record, are you sure? [ ]\"\n                at line WS-22-lines col 1 with foreground-color 2 highlight.\n     accept   WS-reply at line WS-22-lines col 44 with foreground-color 6.\n     move     function upper-case (WS-reply) to WS-reply.\n     if       WS-reply not = \"Y\" and not = \"N\"\n              go to da040-Accept-Delete.\n*>\n     if       WS-reply = \"N\"\n              go to da010-Display-Stock-Headings.\n     display  \" \" at line WS-22-lines col 1 with erase eol.\n*>\n     move     1 to File-Key-No.\n     perform  Stock-Delete.\n*>\n     if       fs-reply not = zero\n              display ST108 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line WS-23-lines col 37 with foreground-color 4 highlight\n              display ST006   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30.\n*>\n     go       to  da010-Display-Stock-Headings.\n*>\n da999-Exit.\n     exit     section.\n*>\n ea000-Report-Stock         section.\n*>*********************************\n*>\n*> Used here as a full print. For other options see st030 (Stock Reports)\n*>\n     perform  Stock-Open-Input.\n     if       fs-reply not = zero\n              perform Stock-Close\n              display ST106 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ea999-Exit.\n*>\n     open     output Print-File.\n     perform  ea200-Produce-Report.\n     close    Print-File.\n     perform  Stock-Close.\n     call     \"SYSTEM\" using Print-Report.\n*>\n ea999-exit.\n     exit     section.\n*>\n ea200-Produce-Report       section.\n*>*********************************\n*>\n     move     99 to Line-Cnt.\n     move     zero to Page-Nos WS-Rec-Cnt.\n     move     Prog-Name to L1-Program.\n     move     usera to L2-User.\n     move     To-Day to u-Date.\n     perform  zz020-convert-date.\n     move     u-Date to L2-Date.\n     accept   hdtime from time.\n     if       hdtime not = \"00000000\"\n              move hd-hh to L2-HH\n              move hd-mm to L2-MM.\n*>\n ea210-Read-Stock.\n     perform  Stock-Read-Next.\n     if       fs-Reply = 10                       *> EOF\n              go to ea230-Totals.\n*>\n     perform  ea220-Heads.\n     add      1 to WS-Rec-Cnt.\n     move     spaces to line-5.\n     move     WS-Stock-Key       to L5-Stock-Number.\n     move     WS-Stock-Abrev-Key to L5-Abbrev-Stock.\n     move     Stock-Supplier-P1  to L5-Supplier-No.\n     move     Stock-Retail       to L5-Retail.\n     move     Stock-Cost         to L5-Cost.\n     if       L5-Costz = \"00\"\n              move spaces to L5-Costz\n     end-if\n     if       Stock-Services-Flag not = \"Y\"\n              move  Stock-Value        to L5-Value\n              move  Stock-Held         to L5-Held\n              move  Stock-ReOrder-Pnt  to L5-Reord-Pnt\n              move  Stock-Std-ReOrder  to L5-Reord-Qty\n              move  Stock-On-Order     to L5-Qty-Ordered\n              move  Stock-Back-Ordered to L5-Qty-Back-Ord\n     end-if\n     move     WS-Stock-Location        to L5-Location.\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to L5-Date-Ordered\n     else\n              move spaces to L5-Date-Ordered\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to L5-Date-Due\n     else\n              move spaces to L5-Date-Due\n     end-if\n     move     WS-Stock-Desc to L6-Desc.\n     move     1 to a.\n     move     spaces to L6-vars.\n     if       Stock-Supplier-P2 not = spaces\n           or Stock-Supplier-P3 not = spaces\n              string \"Secondary Suppliers\" delimited by size into L6-vars pointer a\n              if Stock-Supplier-P2 not = spaces\n                  string \" 1: \"            delimited by size\n                         Stock-Supplier-P2 delimited by size into L6-vars pointer a\n              end-if\n              if Stock-Supplier-P3 not = spaces\n                  string \" 2: \"            delimited by size\n                         Stock-Supplier-P3 delimited by size into L6-vars pointer a\n              end-if\n              add 2 to a\n     end-if\n     if       Stock-SA-Code not = spaces\n              string \"SA Code: \"           delimited by size\n                     Stock-SA-Group        delimited by size into L6-vars pointer a\n              add 2 to a\n     end-if\n     if       Stock-PA-Code not = spaces\n              string \"PA Code: \"           delimited by size\n                     Stock-PA-Group        delimited by size into L6-vars pointer a\n     end-if\n*>\n     if       Stock-Pre-Sales not = zero\n              move Stock-Pre-Sales to WS-z6\n              string \"  Pre Sales :\"       delimited by size\n                     WS-z6                 delimited by size into L6-vars pointer a\n     end-if\n     if       Line-Cnt > 5\n              move all \"-\" to print-record\n              write print-record after 1\n              write print-record from line-5 after 1\n     else\n              write print-record from line-5 after 2\n     end-if\n     write    print-record from line-6 after 1.\n     add      3 to Line-Cnt.\n     move     spaces to print-record.\n     if       Stock-Services-Flag not = \"Y\"\n          and (zero not = Stock-Construct-Bundle or not = Stock-Under-Construction\n           or not = Stock-Work-in-Progress or Stock-Construct-Item not = spaces)\n              move Stock-Construct-Bundle   to WS-z6\n              move Stock-Under-Construction to WS-z6b\n              move Stock-Work-in-Progress   to WS-z6c\n              string \"Construction Bundle :\"    delimited by size\n                     WS-z6                      delimited by size\n                     \"  WIP :\"                  delimited by size\n                     WS-z6c                     delimited by size\n                     \"  Under Construction :\"   delimited by size\n                     WS-z6b                     delimited by size\n                     \" For Constructed Item : \" delimited by size\n                     Stock-Construct-Item       delimited by size\n                                into print-record\n              end-string\n              write  print-record after 1\n              add 1 to Line-Cnt\n     end-if\n     if       Stock-Services-Flag = \"Y\"\n              move \"Services only Product\" to print-record\n              write  print-record after 1\n              add 1 to Line-Cnt\n     end-if\n     go       to ea210-Read-Stock.\n*>\n ea220-Heads.\n     if       line-cnt > WS-Page-Lines\n              add 1 to Page-Nos\n              move Page-Nos to L1-Page\n              if  Page-Nos not = 1\n                  write print-record from line-1 after page\n                  write print-record from line-2 after 1\n                  move spaces to print-record\n                  write print-record after 1\n              else\n                  write print-record from line-1 before 1\n                  write print-record from line-2 before 1\n              end-if\n              write print-record from line-3 after 1\n              write print-record from line-4 after 1\n              move 5 to Line-Cnt\n     end-if.\n*>\n ea230-Totals.\n     if       Line-Cnt > WS-Page-Lines - 2\n              add 60 to Line-Cnt\n              perform ea220-Heads.\n     move     spaces to Print-Record.\n     move     WS-Rec-Cnt to WS-Rec-Total.\n     string   \" Total Stock Records \" delimited by size\n              function trim (WS-Rec-Total leading) delimited by size into Print-Record.\n     write    Print-Record after 2.\n\n ea299-Exit.\n     exit     section.\n*>\n fa000-Display-Stock        section.     *> Get rec load SS-  ??????\n*>*********************************\n*>\n     perform  Stock-Open-Input.\n     if       fs-reply not = zero\n              perform Stock-Close\n              display ST106 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display ST003 at line WS-lines col 1 with foreground-color 4 highlight\n              go to fa999-Exit.\n     move     1 to File-Key-No.             *>  1=stock-key, 2=Abrev, 3=Desc\n*>\n fa010-Display-Stock-Headings.\n     perform  zz020-Display-Outline.\n*>\n fa020-Stock-Item-Accept.\n     move     spaces to WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code.\n     display  display-01.\n     display  display-01C.\n     display  Display-F1-Display.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n     accept   WS-Stock-Key at 0421 with foreground-color 3.\n*>\n*> test to see if can save function key values!!!\n*>\n     if       WS-Stock-Key = spaces\n          or  Cob-Crt-Status = Cob-Scr-Esc\n              perform Stock-Close\n              go to fa999-Exit.\n     if       WS-Stock-Key (1:1) = \"*\"\n              move     1 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              move     spaces to WS-Stock-Key\n              set      fn-not-less-than to true      *> chgd from not-greater  16/08/23\n              perform  Stock-Start\n              move     \"*\" to WS-Stock-Key.\n     move     function upper-case (WS-Stock-Key) to WS-Stock-Key\n                                                    WS-Temp-Stock-Key.\n*>\n fa030-Get-Record.\n*>\n*>  if a * entered",
        "line": 1326
      },
      {
        "type": "IF",
        "condition": "WS-Temp-Stock-Key (1:1) = \"*\"\n              perform  Stock-Read-Next\n              if       fs-Reply not = zeros           *> was   = 10     *> EOF   16/08/23\n                       display ST119 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       display ST003 at line WS-lines col 1 with foreground-color 4 highlight\n                       go to fa020-Stock-Item-Accept\n              end-if\n     else\n              move     1 to File-Key-No             *>  1=stock-key, 2=Abrev, 3=Desc\n              perform  Stock-Read-Indexed\n              if       fs-Reply not = 00\n                       display ST114 at line WS-23-lines col 1 with foreground-color 4 highlight\n                       display ST003 at line WS-lines col 1 with foreground-color 4 highlight\n                       go to fa020-Stock-Item-Accept\n              end-if\n     end-if\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n     perform  Clear-Error-Line.\n*>\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n     perform  zz080-Copy-To-SS.\n     display  display-01.\n     display  display-01C.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n*>\n     if       WS-Temp-Stock-Key = \"*\"\n              move \"N\" to Escape-Code\n              display \"N> = Next  \" at line 20 col 64 with foreground-color cob-color-green\n     else\n              move \"S\" to Escape-Code.\n     perform  zz100-test-escape.\n*>\n     if       Escape-Code = \"N\"                  *> Get next record\n              go to fa030-Get-Record.\n     if       escape-code = \"Q\"\n         or   Cob-Crt-Status = Cob-Scr-Esc\n              perform Stock-Close\n              go to  fa999-Exit.\n*>\n     go       to  fa010-Display-Stock-Headings.  *> S will redisplay heads etc\n*>\n fa999-Exit.\n     exit     section.\n*>\n ga000-Renumber-Stock        section.\n*>**********************************\n*>\n     perform  Stock-Open.\n     if       fs-reply not = zero\n              perform Stock-Close\n              display ST106 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ga999-Exit.\n*>\n ga010-Display-Stock-Headings.\n     perform  zz020-Display-Outline.\n*>\n ga020-Stock-Item-Accept.\n     move     spaces to WS-Stock-Key\n                        WS-Stock-Abrev-Key\n                        Customer-Code.\n     display  space at 2361 with erase eol.\n     display  display-01.\n     display  Display-01C.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n     accept   WS-Stock-Key at 0421 with foreground-color 3.\n     if       WS-Stock-Key = spaces\n          or  Cob-Crt-Status = Cob-Scr-Esc\n              perform Stock-Close\n              go to ga999-Exit.\n     move     function upper-case (WS-Stock-Key) to WS-Stock-Key\n                                                    WS-Temp-Stock-Key.\n     display  space at line WS-23-lines col 1 with erase eos.\n*>\n ga030-Get-Record.\n*>     read     Stock-File record key WS-Stock-Key invalid key\n     move     1 to File-Key-No.\n     perform  Stock-Read-Indexed.\n     if       fs-Reply = 23 or = 21\n              display ST114 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ga020-Stock-Item-Accept.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n     perform  Clear-Error-Line.\n*>\n     if       Stock-Order-Date not = zero\n              move Stock-Order-Date to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Date\n     else\n              move spaces to WS-Stock-Order-Date\n     end-if\n     if       Stock-Order-Due not = zero\n              move Stock-Order-Due to u-bin\n              perform zz060-Convert-Date\n              move WS-date to WS-Stock-Order-Due\n     else\n              move spaces to WS-Stock-Order-Due\n     end-if\n*>\n*> Redisplay now dates are converted\n*>\n     display  display-01.\n     display  Display-01C.\n     if       Stk-Manu-Used = 1\n              display Display-02.\n*>\n*> Get and process new Stock and Abrev keys\n*>\n     display  \"Stock Number     - [\" at 1601 with foreground-color 2 erase eol.\n     display  \"]\" at 1634 with foreground-color 2.\n     display  \"PL Fast key  - [\" at 1641 with foreground-color 2.\n     display  \"]\" at 1664 with foreground-color 2.\n*>\n     display  \"* <R> = Renumber  *\" at 2261 with foreground-color 2.\n     display  \"*******************\" at 2361 with foreground-color 2.\n     display  WS-Stock-Key at 0421 with foreground-color 3.\n     display  WS-Stock-Abrev-Key at 0457 with foreground-color 3.\n*>\n     if       Stock-On-Order not = zero\n           or Stock-Back-Ordered not = zero\n              display ST109 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ga020-Stock-Item-Accept.\n*>\n     move     WS-Stock-Key to WS-Save-Stock-Key\n                              WS-Temp-Stock-Key.\n     move     WS-Stock-Abrev-Key to WS-Temp-Abrev-Key\n                                    WS-Save-Abrev-Key.\n*>\n ga040-Accept-New-Stock-No.\n     accept   WS-Temp-Stock-Key at 1621 with foreground-color 3 update.\n     if       WS-Temp-Stock-Key = spaces\n           or Cob-Crt-Status = Cob-Scr-Esc\n              go to ga010-Display-Stock-Headings.\n*>\n     move     function upper-case (WS-Temp-Stock-Key) to WS-Temp-Stock-Key.\n     display  WS-Stock-Key at 1621 with foreground-color 3.\n*>\n     accept   WS-Temp-Abrev-Key at 1657 with foreground-color 3 update.\n     if       Cob-Crt-Status = Cob-Scr-Esc\n          or  Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to ga040-Accept-New-Stock-No.\n*>\n     if       WS-Temp-Abrev-Key not = spaces\n              move    function upper-case (WS-Temp-Abrev-Key) to WS-Temp-Abrev-Key\n              perform clear-error-line\n     else\n              display ST102 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ga040-Accept-New-Stock-No.\n*>\n     move     \"R\" to escape-code.\n     perform  zz100-test-escape.\n     if       escape-code = \"Q\"\n         or   Cob-Crt-Status = Cob-Scr-Esc\n              go to  ga999-Exit.\n*>\n     if       escape-code = \"B\" or = \"S\"\n         or   Cob-Crt-Status = Cob-Scr-Page-Up\n          or  Cob-Crt-Status = Cob-Scr-Key-Up\n              go to ga020-Stock-Item-Accept.\n*>\n     if       escape-code not = \"R\"\n              go to  ga010-Display-Stock-Headings.\n*>\n ga050-Accept-Renumber.\n     display  \"Renumbering Stock Item record, are you sure? [ ]\"\n                at line WS-22-lines col 1 with foreground-color 2 highlight.\n     accept   WS-reply at line WS-22-lines col 47 with foreground-color 6 UPPER.\n     if       WS-reply not = \"Y\" and not = \"N\"\n              go to ga050-Accept-Renumber.\n*>\n     if       WS-reply = \"N\"\n              go to ga010-Display-Stock-Headings.\n     display  space at line WS-22-lines col 1 with erase eol.\n*>\n     move     WS-Temp-Stock-Key to WS-Stock-Key.\n     move     WS-Temp-Abrev-Key to WS-Stock-Abrev-Key.\n     perform  Stock-Write.\n     if       fs-reply = 22\n              display ST117 at line WS-23-lines col 1 with foreground-color 4 highlight\n              go to ga040-Accept-New-Stock-No.\n     if       fs-reply not = zero\n              display ST000    at line WS-23-lines col 1  with foreground-color 4 highlight\n              display \"=\"      at line WS-23-lines col 37 with foreground-color 4 highlight\n              display fs-reply at line WS-23-lines col 39 with foreground-color 4 highlight\n              display ST003   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30\n              perform Stock-Close\n              go to ga999-Exit.\n*>\n*>  Created record with new stock number so can delete old one\n*>\n     move     WS-Save-Stock-Key to WS-Stock-Key.\n     move     WS-Save-Abrev-key to WS-Stock-Abrev-Key.\n     perform  Stock-Delete.\n     if       fs-reply not = zero\n              display ST108 at line WS-23-lines col 1 with foreground-color 4 highlight\n              display fs-reply at line WS-23-lines col 37 with foreground-color 4 highlight\n              display ST006   at line WS-lines col 01\n              accept WS-reply at line WS-lines col 30.\n*>\n     go       to  ga010-Display-Stock-Headings.\n*>\n ga999-Exit.\n     exit     section.\n*>\n*>****************************************************\n*>               Common Routines Block               *\n*>****************************************************\n*>\n zz010-Display-Heading      section.\n*>*********************************\n*>\n  *>   if       menu-reply not = 4\n              display prog-name at 0101 with foreground-color 2 erase eos\n              display  usera at 0301 with foreground-color 3\n              perform zz020-convert-date\n              display u-date at 0171 with foreground-color 2.\n*>\n     if       menu-reply = zero\n              display \"Stock File Set-Up & Maintenance\" at 0124 with foreground-color 2\n              display \"Function  Menu\"         at 0434 with foreground-color 2\n     else\n       if     menu-reply = 1\n              display \"Stock Record Creation\"  at 0129 with foreground-color 2\n       else\n        if    menu-reply = 2\n              display \"Stock Record Amendment\" at 0129 with foreground-color 2\n        else\n         if   menu-reply = 3\n              display \"Stock Record Deletion\"  at 0129 with foreground-color 2\n         else\n          if  menu-reply = 5\n              display \"Stock Record Display\"   at 0129 with foreground-color 2.\n*>\n zz010-Exit.\n     exit     section.\n*>\n zz020-Convert-Date  section.\n*>**************************\n*>\n*> Convert from UK to selected form\n*>\n     move     to-day to u-date.\n     if       Date-USA\n              move u-date to WS-date\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              move WS-date to u-date\n     end-if\n     if       Date-Intl\n              move \"ccyy/mm/dd\" to WS-date   *> swap Intl to UK form\n              move u-date (7:4) to WS-Intl-Year\n              move u-date (4:2) to WS-Intl-Month\n              move u-date (1:2) to WS-Intl-Days\n              move WS-date to u-date\n     end-if.\n*>\n zz020-exit.\n     exit     section.\n*>\n zz020-Display-Outline      section.\n*>*********************************\n*>\n     perform  zz010-Display-Heading.\n *>    initialize WS-Stock-Record with filler.\n     perform  zz070-Initialize-Stock-Record.\n     move     spaces to WS-Stock-Key WS-Stock-Abrev-Key WS-Stock-Dates.\n     display  Display-01.\n*>     if       Stk-Manu-Used = 1\n*>              display Display-02.\n*>\n zz020-exit.\n     exit     section.\n*>\n zz030-common-routines      section.\n*>*********************************\n*>\n zz030-accept-money7.  *> USED\n     move     amt-wk-pence7 to WS-pence7.\n     move     amt-wk-pds7 to WS-pound7.\n     display  WS-amount-screen-display7 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept7  at curs with foreground-color 3 update.\n     move     WS-pound7 to amt-wk-pds7.\n     move     WS-pence7 to amt-wk-pence7.\n*>\n zz030-accept-money7b.  *> USED\n     move     amt-wk-pence7b to WS-pence7b.\n     move     amt-wk-pds7b to WS-pound7b.\n     display  WS-amount-screen-display7b at curs with foreground-color 3.\n     accept   WS-amount-screen-accept7b  at curs with foreground-color 3 update.\n     move     WS-pound7b to amt-wk-pds7b.\n     move     WS-pence7b to amt-wk-pence7b.\n*>\n zz030-accept-money9a.\t*> Not used\n     move     zero to WS-poundsd9 WS-penced9 amt-ok9.\n*>\n zz030-accept-money9b.\t*> Not used\n     display  WS-amount-screen-display9 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept9  at curs with foreground-color 3 update.\n     move     WS-pound9 to amt-wk-pds9.\n     move     WS-pence9 to amt-wk-pence9.\n*>\n zz030-accept-money9c.  *> USED\n     move     amt-wk-pence9 to WS-pence9.\n     move     amt-wk-pds9 to WS-pound9.\n     display  WS-amount-screen-display9 at curs with foreground-color 3.\n     accept   WS-amount-screen-accept9  at curs with foreground-color 3 update.\n     move     WS-pound9 to amt-wk-pds9.\n     move     WS-pence9 to amt-wk-pence9.\n*>\n zz030-exit.\n     exit     section.\n*>\n zz040-Check-for-Supplier   section.\n*>*********************************\n*>\n     move     zero to Error-Code.\n     if       WS-Stock-Supplier = spaces\n              go to zz040-Exit.\n     if       WS-Stock-Supp-7 = space\n              move WS-Stock-Supplier to customer-code\n              move \"C\" to maps09-reply\n              perform maps09\n              if  maps09-reply not = \"Y\"\n                  move 2 to Error-Code\n                  display ST103 at line WS-23-lines col 1 with foreground-color 4 highlight\n                  go to zz040-Exit\n              else\n                  move Customer-Code to WS-Stock-Supplier.\n*>\n     move     WS-Stock-Supplier to WS-Purch-Key\n                                   WS-File-Key.\n     move     5 to Access-Type.\n     perform  Purch-Read-Indexed.\n     if       FS-Reply  = zero       *> not = 23 and not = 21\n              go to  zz040-Exit.\n     move     1 to Error-Code.\n     display  ST101 at line WS-23-lines col 1 with foreground-color 4 highlight.\n*>\n zz040-Exit.\n     exit     section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   WS-test-date\n*> output:  u-date/WS-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     move     WS-test-date to WS-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to WS-date.  *> swap Intl to UK form\n     move     WS-test-date (1:4) to WS-Year.\n     move     WS-test-date (6:2) to WS-Month.\n     move     WS-test-date (9:2) to WS-Days.\n*>\n zz050-test-date.\n     move     WS-date to u-date.\n     move     zero to u-bin.\n     perform  maps04.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  WS-date as uk/US/Inlt date format\n*>          u-date & WS-Date = spaces if invalid date\n*>\n     perform  maps04.\n     if       u-date = spaces\n              move spaces to WS-Date\n              go to zz060-Exit.\n     move     u-date to WS-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move WS-days to WS-swap\n              move WS-month to WS-days\n              move WS-swap to WS-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to WS-date.  *> swap Intl to UK form\n     move     u-date (7:4) to WS-Intl-Year.\n     move     u-date (4:2) to WS-Intl-Month.\n     move     u-date (1:2) to WS-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Initialize-Stock-Record section.\n*>\n*> The simple process here is initialise WS-Stock-Record\n*>   but some versions of the compiler this doesn't work.\n*>      for v3.2 initialise does not work for Stock-TD fields as they\n*>          are spaces.\n*>     initialise WS-Stock-Record with filler.  *> JIC anything missed\n     move     spaces to  WS-Stock-Key\n                         WS-Stock-Abrev-Key\n                         Stock-Suppliers-Group\n                         WS-Stock-Desc\n                         Stock-Construct-Item\n                         WS-Stock-Location\n                         Stock-PA-Code\n                         Stock-SA-Code\n                         Stock-Services-Flag.\n*>\n     move     zeros to   Stock-Last-Actual-Cost\n                         Stock-Construct-Bundle\n                         Stock-Under-Construction\n                         Stock-Work-in-Progress\n                         Stock-ReOrder-Pnt\n                         Stock-Std-ReOrder\n                         Stock-Back-Ordered\n                         Stock-On-Order\n                         Stock-Held\n                         Stock-Pre-Sales\n                         Stock-Retail\n                         Stock-Cost\n                         Stock-Value\n                         Stock-Order-Due\n                         Stock-Order-Date\n                         Stock-Adds\n                         Stock-Deducts\n                         Stock-Wip-Adds\n                         Stock-Wip-Deds.\n*>\n     perform  varying Z1 from 1 by 1 until Z1 > 12\n              move zeros to Stock-TD-Adds (Z1)\n                            Stock-TD-Deds (Z1)\n                            Stock-TD-Wip-Adds (Z1)\n                            Stock-TD-Wip-Deds (Z1)\n     end-perform.\n*>\n zz070-Exit.\n     exit     section.\n*>\n zz080-Copy-To-SS  section.\n*>************************\n*>\n     move     Stock-Construct-Bundle    to SS-Stock-Construct-Bundle.\n     move     Stock-Under-Construction  to SS-Stock-Under-Construction.\n     move     Stock-Work-in-Progress    to SS-Stock-Work-in-Progress.\n     move     Stock-ReOrder-Pnt         to SS-Stock-ReOrder-Pnt.\n     move     Stock-Std-ReOrder         to SS-Stock-Std-ReOrder.\n     move     Stock-Back-Ordered        to SS-Stock-Back-Ordered.\n     move     Stock-On-Order            to SS-Stock-On-Order.\n     move     Stock-Held                to SS-Stock-Held.\n     move     Stock-Pre-Sales           to SS-Stock-Pre-Sales.\n     move     Stock-Retail              to SS-Stock-Retail.\n     move     Stock-Cost                to SS-Stock-Cost.\n     move     Stock-Value               to SS-Stock-Value.\n*>\n zz080-Exit.\n     exit     section.\n*>\n zz090-Copy-From-SS  section.\n*>**************************\n*>\n     move     SS-Stock-Construct-Bundle     to Stock-Construct-Bundle.\n     move     SS-Stock-Under-Construction   to Stock-Under-Construction.\n     move     SS-Stock-Work-in-Progress     to Stock-Work-in-Progress.\n     move     SS-Stock-ReOrder-Pnt          to Stock-ReOrder-Pnt.\n     move     SS-Stock-Std-ReOrder          to Stock-Std-ReOrder.\n     move     SS-Stock-Back-Ordered         to Stock-Back-Ordered.\n     move     SS-Stock-On-Order             to Stock-On-Order.\n     move     SS-Stock-Held                 to Stock-Held.\n     move     SS-Stock-Pre-Sales            to Stock-Pre-Sales.\n     move     SS-Stock-Retail               to Stock-Retail.\n     move     SS-Stock-Cost                 to Stock-Cost.\n     move     SS-Stock-Value                to Stock-Value.\n*>\n zz090-Exit.\n     exit     section.\n*>\n zz100-test-escape          section.\n*>*********************************\n*>\n     display  escape-code at 1976 with foreground-color 6.\n*>\n zz100-get-escape.\n     accept   escape-code at 1976 with foreground-color 6 update UPPER.\n*>\n     if       escape-code not = \"B\" and not = \"S\" and not = \"Q\"\n                      and not = \"K\" and not = \"D\" and not = \"R\"\n                      and not = \"C\" and not = \"N\"\n              go to zz100-get-escape.\n*>\n zz100-exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 1728
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 23,
    "cognitive": 11,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 163,
      "totalOperators": 165,
      "totalOperands": 326,
      "vocabulary": 165,
      "length": 491,
      "volume": 3616.8642071946956
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
