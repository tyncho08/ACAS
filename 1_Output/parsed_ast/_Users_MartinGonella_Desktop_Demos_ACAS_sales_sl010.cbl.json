{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/sales/sl010.cbl",
  "fileName": "sl010.cbl",
  "timestamp": "2025-09-15T16:25:31.765Z",
  "programId": "sl010",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 157
      },
      {
        "name": "file",
        "line": 170
      },
      {
        "name": "working-storage",
        "line": 176
      },
      {
        "name": "linkage",
        "line": 407
      },
      {
        "name": "screen",
        "line": 416
      },
      {
        "name": "init01",
        "line": 579
      },
      {
        "name": "test-escape",
        "line": 680
      },
      {
        "name": "display-heading",
        "line": 699
      },
      {
        "name": "customer-display",
        "line": 739
      },
      {
        "name": "exit",
        "line": 794
      },
      {
        "name": "Display-Outline",
        "line": 796
      },
      {
        "name": "customer-data",
        "line": 815
      },
      {
        "name": "validate-address",
        "line": 950
      },
      {
        "name": "validate-response",
        "line": 973
      },
      {
        "name": "Accept-Key",
        "line": 998
      },
      {
        "name": "ba000-Setup-Customers",
        "line": 1057
      },
      {
        "name": "ca000-Amend-Customer",
        "line": 1165
      },
      {
        "name": "Evaluate-Message",
        "line": 1327
      },
      {
        "name": "da000-Delete-Customer",
        "line": 1336
      },
      {
        "name": "ea000-Report-Customers",
        "line": 1409
      },
      {
        "name": "ga000-Amend-BO-Status",
        "line": 1424
      },
      {
        "name": "fa000-Display-Customers",
        "line": 1525
      },
      {
        "name": "report-selection",
        "line": 1583
      },
      {
        "name": "produce-report",
        "line": 1641
      },
      {
        "name": "report-heading-setup",
        "line": 1873
      },
      {
        "name": "slcreate",
        "line": 1980
      },
      {
        "name": "zz030-common-routines",
        "line": 2019
      },
      {
        "name": "exit",
        "line": 2031
      },
      {
        "name": "zz050-Validate-Date",
        "line": 2033
      },
      {
        "name": "exit",
        "line": 2070
      },
      {
        "name": "zz060-Convert-Date",
        "line": 2072
      },
      {
        "name": "exit",
        "line": 2105
      },
      {
        "name": "zz070-Convert-Date",
        "line": 2107
      },
      {
        "name": "exit",
        "line": 2135
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 161
      },
      {
        "name": "file-defs",
        "line": 577
      },
      {
        "name": "menu-return",
        "line": 610
      },
      {
        "name": "menu-input",
        "line": 616
      },
      {
        "name": "menu-exit",
        "line": 655
      },
      {
        "name": "maps03",
        "line": 660
      },
      {
        "name": "maps09",
        "line": 665
      },
      {
        "name": "clear-error-line",
        "line": 670
      },
      {
        "name": "clear-error-line-24",
        "line": 675
      },
      {
        "name": "get-escape",
        "line": 685
      },
      {
        "name": "cd-exit",
        "line": 793
      },
      {
        "name": "WS-Delivery-Record",
        "line": 801
      },
      {
        "name": "a01-Notes",
        "line": 809
      },
      {
        "name": "Customer-Data-Main",
        "line": 818
      },
      {
        "name": "bypass-deliv-test",
        "line": 863
      },
      {
        "name": "end-if",
        "line": 882
      },
      {
        "name": "Bypass-Notes-Test",
        "line": 884
      },
      {
        "name": "end-if",
        "line": 1052
      },
      {
        "name": "customer-input",
        "line": 1063
      },
      {
        "name": "customer-accept",
        "line": 1069
      },
      {
        "name": "customer-details",
        "line": 1094
      },
      {
        "name": "get-details",
        "line": 1117
      },
      {
        "name": "main-output",
        "line": 1126
      },
      {
        "name": "WS-Delivery-Record",
        "line": 1153
      },
      {
        "name": "main-end",
        "line": 1156
      },
      {
        "name": "customer-input",
        "line": 1171
      },
      {
        "name": "customer-accept",
        "line": 1176
      },
      {
        "name": "get-details",
        "line": 1192
      },
      {
        "name": "main-output",
        "line": 1200
      },
      {
        "name": "end-if",
        "line": 1289
      },
      {
        "name": "end-if",
        "line": 1303
      },
      {
        "name": "end-if",
        "line": 1315
      },
      {
        "name": "main-end",
        "line": 1318
      },
      {
        "name": "customer-input",
        "line": 1342
      },
      {
        "name": "customer-accept",
        "line": 1347
      },
      {
        "name": "get-details",
        "line": 1356
      },
      {
        "name": "main-output",
        "line": 1387
      },
      {
        "name": "main-end",
        "line": 1400
      },
      {
        "name": "main-end",
        "line": 1416
      },
      {
        "name": "ga010-Customer-Input",
        "line": 1429
      },
      {
        "name": "ga020-Customer-Accept",
        "line": 1433
      },
      {
        "name": "ga100-Process",
        "line": 1454
      },
      {
        "name": "end-if",
        "line": 1471
      },
      {
        "name": "ga990-Quit",
        "line": 1519
      },
      {
        "name": "customer-input",
        "line": 1532
      },
      {
        "name": "customer-accept",
        "line": 1537
      },
      {
        "name": "accept-of-show",
        "line": 1549
      },
      {
        "name": "main-end",
        "line": 1574
      },
      {
        "name": "accept-data",
        "line": 1596
      },
      {
        "name": "read-loop",
        "line": 1657
      },
      {
        "name": "test-num",
        "line": 1721
      },
      {
        "name": "headings",
        "line": 1741
      },
      {
        "name": "Listing",
        "line": 1761
      },
      {
        "name": "delivery-print",
        "line": 1820
      },
      {
        "name": "l6-letter",
        "line": 1838
      },
      {
        "name": "l6-discount",
        "line": 1841
      },
      {
        "name": "notes-print",
        "line": 1847
      },
      {
        "name": "end-report",
        "line": 1860
      },
      {
        "name": "main-end",
        "line": 1863
      },
      {
        "name": "SLcreate-Main",
        "line": 1983
      },
      {
        "name": "zz030-accept-money9c",
        "line": 2022
      },
      {
        "name": "zz030-exit",
        "line": 2030
      },
      {
        "name": "zz050-test-date",
        "line": 2064
      },
      {
        "name": "zz050-exit",
        "line": 2069
      },
      {
        "name": "zz060-Exit",
        "line": 2104
      },
      {
        "name": "zz070-Exit",
        "line": 2134
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "maps04",
        "line": 663,
        "type": "DYNAMIC",
        "using": [
          "maps03-ws"
        ]
      },
      {
        "target": "maps09",
        "line": 668,
        "type": "DYNAMIC",
        "using": [
          "maps09-ws"
        ]
      },
      {
        "target": "SYSTEM",
        "line": 1868,
        "type": "DYNAMIC",
        "using": [
          "Print-Report"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 147,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 156,
        "replacing": null
      },
      {
        "name": "selboitm",
        "line": 164,
        "replacing": null
      },
      {
        "name": "selprint",
        "line": 165,
        "replacing": null
      },
      {
        "name": "fdboitm",
        "line": 173,
        "replacing": null
      },
      {
        "name": "fdprint",
        "line": 174,
        "replacing": null
      },
      {
        "name": "print-spool-command",
        "line": 179,
        "replacing": null
      },
      {
        "name": "wsmaps03",
        "line": 180,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 181,
        "replacing": null
      },
      {
        "name": "wsmaps09",
        "line": 182,
        "replacing": null
      },
      {
        "name": "wssl",
        "line": 184,
        "replacing": null
      },
      {
        "name": "wsdel",
        "line": 185,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 211,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 345,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 410,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 411,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 412,
        "replacing": null
      },
      {
        "name": "FileStat-Msgs",
        "line": 1330,
        "replacing": null
      },
      {
        "name": "Proc-ACAS-FH-Calls",
        "line": 2137,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "should",
        "thru": null,
        "line": 117
      },
      {
        "target": "slcreate",
        "thru": null,
        "line": 608
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 614
      },
      {
        "target": "ba000-Setup-Customers",
        "thru": null,
        "line": 636
      },
      {
        "target": "ca000-Amend-Customer",
        "thru": null,
        "line": 639
      },
      {
        "target": "da000-Delete-Customer",
        "thru": null,
        "line": 642
      },
      {
        "target": "ea000-Report-Customers",
        "thru": null,
        "line": 645
      },
      {
        "target": "fa000-Display-Customers",
        "thru": null,
        "line": 648
      },
      {
        "target": "ga000-Amend-BO-Status",
        "thru": null,
        "line": 651
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 709
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 785
      },
      {
        "target": "zz060-Convert-Date",
        "thru": null,
        "line": 790
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 799
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 824
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 838
      },
      {
        "target": "validate-address",
        "thru": null,
        "line": 851
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 870
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 888
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 908
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 918
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 927
      },
      {
        "target": "validate-response",
        "thru": null,
        "line": 936
      },
      {
        "target": "clear-error-line-24",
        "thru": null,
        "line": 993
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 1013
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 1019
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 1027
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 1043
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1060
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 1061
      },
      {
        "target": "Display-Outline",
        "thru": null,
        "line": 1067
      },
      {
        "target": "clear-error-line",
        "thru": null,
        "line": 1079
      },
      {
        "target": "maps09",
        "thru": null,
        "line": 1082
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 1088
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1091
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1120
      },
      {
        "target": "customer-data",
        "thru": null,
        "line": 1121
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1124
      },
      {
        "target": "Sales-Write",
        "thru": null,
        "line": 1136
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 1143
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 1150
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1159
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1160
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1168
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 1169
      },
      {
        "target": "Display-Outline",
        "thru": null,
        "line": 1174
      },
      {
        "target": "Accept-Key",
        "thru": null,
        "line": 1179
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1195
      },
      {
        "target": "customer-data",
        "thru": null,
        "line": 1196
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1198
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 1219
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1223
      },
      {
        "target": "Delivery-Rewrite",
        "thru": null,
        "line": 1229
      },
      {
        "target": "Delivery-Rewrite",
        "thru": null,
        "line": 1234
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1238
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 1247
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1251
      },
      {
        "target": "Delivery-Write",
        "thru": null,
        "line": 1267
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1271
      },
      {
        "target": "Delivery-Rewrite",
        "thru": null,
        "line": 1280
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1284
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 1294
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1298
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1306
      },
      {
        "target": "evaluate-message",
        "thru": null,
        "line": 1310
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1321
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1322
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1339
      },
      {
        "target": "Delivery-Open",
        "thru": null,
        "line": 1340
      },
      {
        "target": "Display-Outline",
        "thru": null,
        "line": 1343
      },
      {
        "target": "Accept-Key",
        "thru": null,
        "line": 1348
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1357
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1360
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1382
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 1394
      },
      {
        "target": "Delivery-Delete",
        "thru": null,
        "line": 1397
      },
      {
        "target": "Sales-Delete",
        "thru": null,
        "line": 1398
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1403
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1404
      },
      {
        "target": "Report-Selection",
        "thru": null,
        "line": 1412
      },
      {
        "target": "Report-Heading-Setup",
        "thru": null,
        "line": 1413
      },
      {
        "target": "Produce-Report",
        "thru": null,
        "line": 1414
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1418
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1419
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1427
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 1430
      },
      {
        "target": "Sales-Read-Indexed",
        "thru": null,
        "line": 1462
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1470
      },
      {
        "target": "Sales-Start",
        "thru": null,
        "line": 1480
      },
      {
        "target": "until",
        "thru": null,
        "line": 1488
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 1489
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1493
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1498
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1501
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1502
      },
      {
        "target": "else",
        "thru": null,
        "line": 1503
      },
      {
        "target": "until",
        "thru": null,
        "line": 1505
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 1506
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1510
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1513
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1514
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1515
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1521
      },
      {
        "target": "Delivery-Open-Input",
        "thru": null,
        "line": 1529
      },
      {
        "target": "Sales-Open",
        "thru": null,
        "line": 1530
      },
      {
        "target": "Display-Outline",
        "thru": null,
        "line": 1535
      },
      {
        "target": "Accept-Key",
        "thru": null,
        "line": 1539
      },
      {
        "target": "customer-display",
        "thru": null,
        "line": 1547
      },
      {
        "target": "test-escape",
        "thru": null,
        "line": 1553
      },
      {
        "target": "zz030-accept-money9c",
        "thru": null,
        "line": 1561
      },
      {
        "target": "zz030-accept-money9c",
        "thru": null,
        "line": 1566
      },
      {
        "target": "Sales-Rewrite",
        "thru": null,
        "line": 1568
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 1577
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 1578
      },
      {
        "target": "Sales-Open-Input",
        "thru": null,
        "line": 1586
      },
      {
        "target": "Delivery-Open-Input",
        "thru": null,
        "line": 1587
      },
      {
        "target": "zz050-Validate-Date",
        "thru": null,
        "line": 1630
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1646
      },
      {
        "target": "Sales-Start",
        "thru": null,
        "line": 1652
      },
      {
        "target": "Sales-Read-Next",
        "thru": null,
        "line": 1660
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1681
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1689
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1697
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1706
      },
      {
        "target": "test-num",
        "thru": null,
        "line": 1714
      },
      {
        "target": "listing",
        "thru": null,
        "line": 1718
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1765
      },
      {
        "target": "headings",
        "thru": null,
        "line": 1806
      },
      {
        "target": "delivery-print",
        "thru": null,
        "line": 1811
      },
      {
        "target": "notes-print",
        "thru": null,
        "line": 1813
      },
      {
        "target": "Delivery-Read-Indexed",
        "thru": null,
        "line": 1825
      },
      {
        "target": "Delivery-Read-Indexed,",
        "thru": null,
        "line": 1850
      },
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 1876
      },
      {
        "target": "display-heading",
        "thru": null,
        "line": 1984
      },
      {
        "target": "Sales-Open-Output",
        "thru": null,
        "line": 1995
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 2001
      },
      {
        "target": "Delivery-Open-Output",
        "thru": null,
        "line": 2003
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 2009
      },
      {
        "target": "Sales-Close",
        "thru": null,
        "line": 2012
      },
      {
        "target": "Delivery-Close",
        "thru": null,
        "line": 2013
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 2067
      },
      {
        "target": "maps03",
        "thru": null,
        "line": 2081
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 583
      },
      {
        "from": "prog-name",
        "to": "l1-version",
        "line": 588
      },
      {
        "from": "to-day",
        "to": "u-date",
        "line": 589
      },
      {
        "from": "Print-Spool-Name",
        "to": "PSN",
        "line": 593
      },
      {
        "from": "space",
        "to": "Print-Out",
        "line": 594
      },
      {
        "from": "\"N\"",
        "to": "SL-BO-Default",
        "line": 596
      },
      {
        "from": "\"N\"",
        "to": "WS-BO-Status\n              else\n                       move     \"Y\" to WS-BO-Status",
        "line": 601
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 605
      },
      {
        "from": "zero",
        "to": "menu-reply",
        "line": 613
      },
      {
        "from": "spaces",
        "to": "d24-02 d24-check",
        "line": 704
      },
      {
        "from": "\"]\"",
        "to": "d24-03",
        "line": 705
      },
      {
        "from": "ws-date",
        "to": "ws-local-date\n              display ws-date at 0171 with foreground-color 2",
        "line": 710
      },
      {
        "from": "\"]\"",
        "to": "d24-02\n              move space to d24-03\n       else\n        if    menu-reply = 2\n              display \"Customer Record Amendment\" at 0129 with foreground-color 2\n        else\n         if   menu-reply = 3\n              display \"Customer Record Deletion\"  at 0129 with foreground-color 2\n         else\n          if  menu-reply = 5\n              display \"Customer Record Display\"   at 0129 with foreground-color 2\n          else\n           if Menu-Reply = 6\n              display \"Amend Back Order Status\"   at 0129 with foreground-color 2",
        "line": 721
      },
      {
        "from": "\"Y\"",
        "to": "a01-late-charg\n     else\n              move  \"N\" to a01-late-charg",
        "line": 743
      },
      {
        "from": "\"Y\"",
        "to": "a01-dun-letter\n     else\n              move  \"N\" to a01-dun-letter",
        "line": 748
      },
      {
        "from": "\"Y\"",
        "to": "a01-Email-Inv\n     else\n              move \"N\" to a01-Email-Inv",
        "line": 753
      },
      {
        "from": "\"Y\"",
        "to": "a01-Email-Stat\n     else\n              move \"N\" to a01-Email-Stat",
        "line": 757
      },
      {
        "from": "\"Y\"",
        "to": "a01-Email-Let\n     else\n              move \"N\" to a01-Email-Let",
        "line": 761
      },
      {
        "from": "\"N\"",
        "to": "Sales-Partial-Ship-Flag",
        "line": 772
      },
      {
        "from": "sales-unapplied",
        "to": "display-bal",
        "line": 777
      },
      {
        "from": "sales-current",
        "to": "display-bal",
        "line": 780
      },
      {
        "from": "sales-last-inv",
        "to": "u-bin\n              perform zz060-Convert-Date\n              display ws-date at 2217 with foreground-color 2",
        "line": 784
      },
      {
        "from": "sales-last-pay",
        "to": "u-bin\n              perform zz060-Convert-Date\n              display ws-date at 2317 with foreground-color 2",
        "line": 789
      },
      {
        "from": "spaces",
        "to": "a01-late-charg\n                        a01-dun-letter\n                        a01-Email-Let\n                        a01-Email-Stat\n                        a01-Email-Inv\n                        a01-deliv-name\n                        a01-Deliv-Address\n                        a01-Notes",
        "line": 802
      },
      {
        "from": "zero",
        "to": "error-flag",
        "line": 819
      },
      {
        "from": "sales-address",
        "to": "test-address",
        "line": 823
      },
      {
        "from": "1",
        "to": "error-flag\n      else\n              display space at 0766 with erase eol\n     end-if\n*>\n     if       A01-deliv-name = spaces\n       and    A01-deliv-Address = spaces\n        and   delivery-tag not = zero\n              move WS-Sales-Key to WS-Deliv-Sales-Key\n              move \"D\"          to WS-Deliv-Key-Type\n              perform Delivery-Delete     *> delete delivery-file invalid key\n              if     fs-Reply not = zero\n                     move zero to delivery-tag\n              end-if\n     end-if\n*>\n     if       A01-deliv-Name = spaces\n       and    A01-deliv-Address = spaces\n              move  zero  to  delivery-tag\n              go to bypass-deliv-test\n     end-if\n*>\n     move     A01-deliv-address  to  test-address",
        "line": 828
      },
      {
        "from": "1",
        "to": "error-flag\n      else\n              display \" \" at 1066 with erase eol\n     end-if\n*>\n     if       A01-deliv-address not = spaces\n              move 1 to Delivery-Tag",
        "line": 855
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key\n              move \"N\"          to WS-Deliv-Key-Type\n              perform  Delivery-Delete        *> delete delivery-file invalid key\n              if       fs-reply not = zero\n                       move zero to Notes-tag\n              end-if\n     end-if\n*>\n*>  yes I know, but just in case!!\n*>\n     if       A01-Notes = spaces\n              move zero to Notes-Tag\n     else\n              move 1 to Notes-Tag\n     end-if",
        "line": 868
      },
      {
        "from": "a01-late-charg",
        "to": "ws-reply",
        "line": 887
      },
      {
        "from": "z",
        "to": "sales-late\n              display ws-spaces-7 at 1619\n     else\n              move 1 to error-flag\n              display SL102 at 1619 with foreground-color 4",
        "line": 891
      },
      {
        "from": "\"N\"",
        "to": "Sales-Partial-Ship-Flag",
        "line": 899
      },
      {
        "from": "1",
        "to": "Error-Flag\n              display \"*\" at 1575 with foreground-color 4",
        "line": 904
      },
      {
        "from": "a01-dun-letter",
        "to": "ws-reply",
        "line": 907
      },
      {
        "from": "z",
        "to": "sales-dunning\n     else\n              move 1 to error-flag\n              display SL102 at 1719 with foreground-color 4",
        "line": 912
      },
      {
        "from": "a01-Email-Inv",
        "to": "ws-reply",
        "line": 917
      },
      {
        "from": "z",
        "to": "Email-Invoice\n     else\n              move 1 to error-flag\n              display \"*\" at 1839 with foreground-color 4",
        "line": 921
      },
      {
        "from": "a01-Email-Stat",
        "to": "ws-reply",
        "line": 926
      },
      {
        "from": "z",
        "to": "Email-Statement\n     else\n              move 1 to error-flag\n              display \"*\" at 1849 with foreground-color 4",
        "line": 930
      },
      {
        "from": "a01-Email-Let",
        "to": "ws-reply",
        "line": 935
      },
      {
        "from": "z",
        "to": "Email-Letters\n     else\n              move 1 to error-flag\n              display \"*\" at 1859 with foreground-color 4",
        "line": 939
      },
      {
        "from": "zero",
        "to": "a",
        "line": 953
      },
      {
        "from": "zero",
        "to": "truth\n     else\n              move  1  to  truth",
        "line": 958
      },
      {
        "from": "zero",
        "to": "a",
        "line": 962
      },
      {
        "from": "zero",
        "to": "truth",
        "line": 968
      },
      {
        "from": "1",
        "to": "truth",
        "line": 976
      },
      {
        "from": "1",
        "to": "z\n     else\n      if      ws-reply = \"N\"\n              move  zero  to  z\n      else\n              move  zero  to  truth",
        "line": 980
      },
      {
        "from": "spaces",
        "to": "WS-Sales-Key",
        "line": 1001
      },
      {
        "from": "zero",
        "to": "error-code",
        "line": 1005
      },
      {
        "from": "999",
        "to": "error-code\n              go to  main-exit",
        "line": 1008
      },
      {
        "from": "zero",
        "to": "save-tag\n                          save-notes-tag",
        "line": 1011
      },
      {
        "from": "spaces",
        "to": "customer-code\n              go to  main-exit",
        "line": 1016
      },
      {
        "from": "WS-Sales-Key",
        "to": "customer-code",
        "line": 1020
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key\n              move     \"D\"          to WS-Deliv-Key-Type\n              perform Delivery-Read-Indexed\n              if      fs-reply = 21\n                          move zero  to  delivery-tag\n                          move \"Record not found\"  to A01-deliv-name\n                          move space               to A01-Deliv-Address\n              else             *>  not invalid key\n                          move deliv-name     to A01-deliv-name\n                          move deliv-address  to A01-Deliv-Address\n                          move 1              to save-tag  delivery-tag\n     end-if\n*>\n*>  Check for Notes\n*>\n     if       Notes-Tag not = zero\n              move     WS-Sales-Key to WS-Deliv-Sales-Key\n              move     \"N\"          to WS-Deliv-Key-Type\n              perform Delivery-Read-Indexed\n              if      fs-reply = 21\n                          move zero  to  Notes-tag\n                          move \"Record Not Found\" to A01-Notes-1\n                          move spaces             to A01-Notes-2\n              else   *>    not invalid key\n                          move Deliv-Address to A01-Notes\n                          move 1     to save-notes-tag\n                                        notes-tag\n     end-if",
        "line": 1025
      },
      {
        "from": "spaces",
        "to": "a01-Notes",
        "line": 1066
      },
      {
        "from": "spaces",
        "to": "customer-nos",
        "line": 1072
      },
      {
        "from": "\"C\"",
        "to": "maps09-reply",
        "line": 1081
      },
      {
        "from": "customer-code",
        "to": "WS-Sales-Key",
        "line": 1086
      },
      {
        "from": "customer-code",
        "to": "WS-Sales-Key",
        "line": 1105
      },
      {
        "from": "SL-BO-Default",
        "to": "Sales-Partial-Ship-Flag",
        "line": 1106
      },
      {
        "from": "sl-charges",
        "to": "sales-late",
        "line": 1107
      },
      {
        "from": "sl-dunning",
        "to": "sales-dunning",
        "line": 1108
      },
      {
        "from": "sl-credit",
        "to": "sales-credit",
        "line": 1109
      },
      {
        "from": "sl-disc",
        "to": "sales-discount",
        "line": 1110
      },
      {
        "from": "sl-min",
        "to": "sales-late-min",
        "line": 1111
      },
      {
        "from": "sl-max",
        "to": "sales-late-max",
        "line": 1112
      },
      {
        "from": "sl-limit",
        "to": "sales-limit",
        "line": 1113
      },
      {
        "from": "run-date",
        "to": "sales-create-date",
        "line": 1114
      },
      {
        "from": "1",
        "to": "sales-status",
        "line": 1115
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 1123
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key\n              move   \"D\"          to WS-Deliv-Key-Type\n              move   A01-deliv-name    to deliv-name\n              move   A01-deliv-address to deliv-address\n              perform Delivery-Write",
        "line": 1139
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key\n              move   \"N\"          to WS-Deliv-Key-Type\n              move   spaces    to deliv-name\n              move   A01-Notes to deliv-address\n              perform Delivery-Write",
        "line": 1146
      },
      {
        "from": "delivery-tag",
        "to": "save-tag",
        "line": 1187
      },
      {
        "from": "Notes-Tag",
        "to": "save-Notes-Tag",
        "line": 1188
      },
      {
        "from": "zero",
        "to": "Email-Invoice Email-Statement Email-Letters",
        "line": 1190
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 1197
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1211
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1212
      },
      {
        "from": "A01-deliv-name",
        "to": "deliv-name",
        "line": 1213
      },
      {
        "from": "A01-deliv-address",
        "to": "deliv-address",
        "line": 1214
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1259
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1260
      },
      {
        "from": "spaces",
        "to": "deliv-name",
        "line": 1261
      },
      {
        "from": "A01-Notes",
        "to": "deliv-address",
        "line": 1262
      },
      {
        "from": "\"K\"",
        "to": "escape-code",
        "line": 1359
      },
      {
        "from": "spaces",
        "to": "BO-Cust-Itm-No",
        "line": 1365
      },
      {
        "from": "WS-Sales-Key",
        "to": "BO-Stk-Cust-No\n              move     low-values   to BO-Stk-Item-No\n              start    BO-Stk-Itm-File KEY not < BO-Cust-Itm-No\n              read     BO-Stk-Itm-File next record",
        "line": 1367
      },
      {
        "from": "zero",
        "to": "sales-status\n              perform Sales-Rewrite",
        "line": 1381
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1392
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1393
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1395
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1396
      },
      {
        "from": "\"Y\"",
        "to": "WS-BO-State",
        "line": 1431
      },
      {
        "from": "Customer-In",
        "to": "WS-Sales-Key",
        "line": 1452
      },
      {
        "from": "spaces",
        "to": "Customer-In\n                       go to  ga010-Customer-Input\n              end-if\n              move     WS-BO-State to Sales-Partial-Ship-Flag\n              perform  Sales-Rewrite\n    end-if",
        "line": 1466
      },
      {
        "from": "WS-BO-State",
        "to": "Sales-Partial-Ship-Flag\n                       perform  Sales-Rewrite\n                       exit     perform cycle\n              end-perform\n     else   *> we do all of them\n              perform  until exit\n                       perform  Sales-Read-Next\n                       if       FS-Reply not = zeros\n                                display \" Requested process completed\" at line WS-23-Lines col 1\n                                                        with foreground-color 2 beep erase eol\n                                exit perform\n                       end-if\n                       move     WS-BO-State to Sales-Partial-Ship-Flag\n                       perform  Sales-Rewrite\n                       exit     perform cycle\n              end-perform\n     end-if\n     go to    ga020-Customer-Accept",
        "line": 1500
      },
      {
        "from": "\"S\"",
        "to": "escape-code",
        "line": 1552
      },
      {
        "from": "20",
        "to": "lin\n              move     17 to cole\n              move     Sales-Unapplied to amt-ok9\n              perform  zz030-accept-money9c\n              move     amt-ok9 to Sales-Unapplied\n              move     21 to lin\n              move     17 to cole\n              move     Sales-Current to amt-ok9\n              perform  zz030-accept-money9c\n              move     amt-ok9 to Sales-Current\n              perform Sales-Rewrite\n     end-if\n*>\n     if       Escape-Code not = \"Q\"\n              go to  customer-input",
        "line": 1558
      },
      {
        "from": "spaces",
        "to": "cust-in status-in credit-op invoice-op\n                        average-op overdue-op enter-date-op\n                        enter-date-in print-out",
        "line": 1589
      },
      {
        "from": "zero",
        "to": "credit-in invoice-in average-in overdue-in ws-enter-date",
        "line": 1593
      },
      {
        "from": "cust-in",
        "to": "customer-in",
        "line": 1601
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1628
      },
      {
        "from": "enter-date-in",
        "to": "ws-test-date",
        "line": 1629
      },
      {
        "from": "u-bin",
        "to": "ws-enter-date",
        "line": 1635
      },
      {
        "from": "u-date",
        "to": "enter-date-in",
        "line": 1636
      },
      {
        "from": "zero",
        "to": "a",
        "line": 1645
      },
      {
        "from": "Customer-In",
        "to": "WS-Sales-Key",
        "line": 1650
      },
      {
        "from": "1",
        "to": "a",
        "line": 1654
      },
      {
        "from": "credit-in",
        "to": "test-1\n              move  sales-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1678
      },
      {
        "from": "invoice-in",
        "to": "test-1\n              move  sales-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1686
      },
      {
        "from": "average-in",
        "to": "test-1\n              move  sales-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1694
      },
      {
        "from": "overdue-in",
        "to": "test-1\n              subtract sales-last-inv from run-date giving test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop",
        "line": 1703
      },
      {
        "from": "ws-enter-date",
        "to": "test-1\n          move  sales-create-date to  test-2\n          move  enter-date-op     to  test-op\n          perform  test-num\n          if    a-false\n                go to  read-loop",
        "line": 1711
      },
      {
        "from": "1",
        "to": "truth\n     else\n              move  0  to  truth",
        "line": 1725
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1731
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1735
      },
      {
        "from": "1",
        "to": "truth",
        "line": 1739
      },
      {
        "from": "a",
        "to": "l1-page",
        "line": 1745
      },
      {
        "from": "spaces",
        "to": "print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1",
        "line": 1749
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1757
      },
      {
        "from": "6",
        "to": "line-cnt",
        "line": 1759
      },
      {
        "from": "WS-Sales-Key",
        "to": "l6-key",
        "line": 1766
      },
      {
        "from": "\"Active\"",
        "to": "l6-status\n     else\n              move  \"Dormant\" to  l6-status",
        "line": 1769
      },
      {
        "from": "spaces",
        "to": "l6-phone",
        "line": 1773
      },
      {
        "from": "sales-name",
        "to": "l6-name",
        "line": 1774
      },
      {
        "from": "sales-address",
        "to": "l7-address",
        "line": 1775
      },
      {
        "from": "sales-phone",
        "to": "l6-phone\n     else\n              move 1 to y\n              string sales-phone delimited by \"  \"\n                            into l6-phone with pointer y\n              subtract 1 from y\n              string \"x\"       delimited by size\n                     sales-ext delimited by size\n                            into l6-phone with pointer y",
        "line": 1778
      },
      {
        "from": "sales-fax",
        "to": "l6-fax",
        "line": 1788
      },
      {
        "from": "Sales-Partial-Ship-Flag",
        "to": "L6-BO",
        "line": 1789
      },
      {
        "from": "\"Y\"",
        "to": "l6-charges\n     else\n              move  spaces  to  l6-charges",
        "line": 1792
      },
      {
        "from": "\"Y\"",
        "to": "l6-letter\n     else\n              move  spaces  to  l6-letter",
        "line": 1797
      },
      {
        "from": "sales-limit",
        "to": "l6-limit",
        "line": 1801
      },
      {
        "from": "sales-credit",
        "to": "l6-credit",
        "line": 1802
      },
      {
        "from": "sales-discount",
        "to": "l6-discount",
        "line": 1803
      },
      {
        "from": "spaces",
        "to": "print-record",
        "line": 1815
      },
      {
        "from": "\"Y\"",
        "to": "Print-Out",
        "line": 1818
      },
      {
        "from": "\"D\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1823
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1824
      },
      {
        "from": "deliv-name",
        "to": "l6-name",
        "line": 1831
      },
      {
        "from": "deliv-address",
        "to": "l7-address",
        "line": 1832
      },
      {
        "from": "spaces",
        "to": "l6-phone  l6-fax\n                          l6-charges\n                          l6-letter",
        "line": 1836
      },
      {
        "from": "zero",
        "to": "l6-limit\n                          l6-credit\n                          l6-discount",
        "line": 1839
      },
      {
        "from": "\"N\"",
        "to": "WS-Deliv-Key-Type",
        "line": 1848
      },
      {
        "from": "WS-Sales-Key",
        "to": "WS-Deliv-Sales-Key",
        "line": 1849
      },
      {
        "from": "spaces",
        "to": "l7-address",
        "line": 1854
      },
      {
        "from": "ws-date",
        "to": "l3-date",
        "line": 1877
      },
      {
        "from": "usera",
        "to": "l3-user",
        "line": 1878
      },
      {
        "from": "spaces",
        "to": "l3-report",
        "line": 1880
      },
      {
        "from": "credit-in",
        "to": "cr-days\n              string  credit-heading  delimited by size\n                              into  l3-report with  pointer  y",
        "line": 1910
      },
      {
        "from": "invoice-in",
        "to": "act-days\n              string  active-heading  delimited by size\n                               into  l3-report with  pointer  y",
        "line": 1924
      },
      {
        "from": "average-in",
        "to": "av-days\n              string  average-heading  delimited by size\n                              into  l3-report with  pointer  y",
        "line": 1938
      },
      {
        "from": "overdue-in",
        "to": "ov-days\n              string  overdue-heading  delimited by size\n                              into  l3-report with  pointer  y",
        "line": 1952
      },
      {
        "from": "enter-date-in",
        "to": "ed-date\n              string  enter-date-heading  delimited by size\n                             into  l3-report with  pointer  y",
        "line": 1966
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 1987
      },
      {
        "from": "\"Y\"",
        "to": "sales-ledger",
        "line": 2014
      },
      {
        "from": "amt-wk-pence9",
        "to": "ws-pence9",
        "line": 2023
      },
      {
        "from": "amt-wk-pds9",
        "to": "ws-pound9",
        "line": 2024
      },
      {
        "from": "ws-pound9",
        "to": "amt-wk-pds9",
        "line": 2027
      },
      {
        "from": "ws-pence9",
        "to": "amt-wk-pence9",
        "line": 2028
      },
      {
        "from": "ws-test-date",
        "to": "ws-date",
        "line": 2046
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2048
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date",
        "line": 2052
      },
      {
        "from": "\"dd/mm/ccyy\"",
        "to": "ws-date",
        "line": 2059
      },
      {
        "from": "ws-date",
        "to": "u-date",
        "line": 2065
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 2066
      },
      {
        "from": "spaces",
        "to": "ws-Date\n              go to zz060-Exit",
        "line": 2083
      },
      {
        "from": "u-date",
        "to": "ws-date",
        "line": 2085
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2088
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit",
        "line": 2092
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 2099
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 2115
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 2118
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 2122
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 2129
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "*>                exists.\n*> 12/07/84 vbc - Move escape box 5 chars right, remove display\n*>                  headings from menu-input,clear screen on report\n*> 28/02/85 vbc - Support for entry date on report matches.\n*> 03/03/09 vbc - Migration to open cobol v3.00.00.\n*> 16/03/09 vbc - New field - Notes which goes into del file so all fields\n*>                move down one line in display-02. fixes bug 30.4\n*> 25/03/09 vbc - Display & accept tidyups that was highlited by pl010.\n*> 29/05/09 vbc - Support for Page-Lines instead of fixed number.\n*> 07/09/10 vbc - .14 Mod lpr.\n*> 18/11/11 vbc - .15 Support for dates other than UK & clean up msgs\n*> 19/11/11 vbc - .16 Error msgs to SLnnn, Cleanup error/bad code in slcreate\n*>                    that missed testing!!\n*> 08/12/11 vbc - .17 Changed delivery file to use indexed instead of relative,\n*>                    easier to delete un-needed records and control size.\n*>                    Support for path+filenames.\n*> 09/12/11 vbc -     Updated version to 3.01.nn\n*> 11/12/11 vbc - .18 Changed usage of Stk-Date-Form to the global field\n*>                    Date-Form making former redundent.\n*> 27/02/12 vbc - .19 Changed use of check-digit' in 'sales-key to sales-key\n*>                    (7:1) for SQL processing.\n*> 29/05/13 vbc - .20 Added changeable unapplied & current for test data on\n*>                    cust. display with escape 'T'.\n*> 24/10/16 vbc - .21 ALL programs now using wsnames.cob in copybooks\n*> 15/01/17 vbc - .   All programs upgraded to v3.02 for RDB processing.\n*>                    Clean up some error/warning msgs getting rid of calls to\n*>                    maps99.\n*> 23/01/17 vbc       Dry testing completed with fixes.\n*> 10/12/22 vbc   .22 Added para after some sections 4 GC 3.2 warning msgs.\n*> 27/01/24 vbc - .23 Cosmetic/proc err - call using maps09 using customer-nos\n*>                    instead of wsmaps09-ws as the full group item. found by\n*>                    -d -g -ftraceall. - works without the runtime checks.\n*> 15/03/24 vbc - .24 Added support for field Sales-Partial-Ship-Flag for input\n*>                    display and reporting. Chg case for FUNCTION, UPPER-CASE.\n*> 20/03/24 vbc - .25 Added Support for SL-BO-Default for create mode and as \"N\"\n*>                    if not yet set to \"N\" or \"Y\".\n*> 11/04/24 vbc - .26 Added tests for BO file when req for delete by chk for\n*>                    same cust key present on BO file so can't delete.\n*> 13/04/24 vbc - .27 Add support to change selected or all customers BO flag\n*>                    to \"Y\" or \"N\".\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*> 17/04/24 vbc       Inserted a space after/before <<< >>> for SL109.\n*> 18/04/24 vbc   .28 Fix bugs in new ga000 code perform should have been go to.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>------------\n*>\n copy \"selboitm.cob\".  *> 11/04/24\n copy \"selprint.cob\".\n*>\n data                    division.\n*>===============================\n*>\n file section.\n*>-----------\n*>\n copy \"fdboitm.cob\".  *> 11/04/24\n copy \"fdprint.cob\".\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(15) value \"SL010 (3.02.28)\".\n copy \"print-spool-command.cob\".\n copy \"wsmaps03.cob\".\n copy \"wsfnctn.cob\".\n copy \"wsmaps09.cob\".\n*>\n copy \"wssl.cob\".\n copy \"wsdel.cob\".\n*>\n*> REMARK OUT ANY IN USE\n*>\n 01  Dummies-4-Unused-ACAS-FH-Calls.      *> Call blk at zz080-ACAS-Calls\n     03  Default-Record         pic x.\n     03  Final-Record           pic x.\n     03  System-Record-4        pic x.\n     03  WS-Ledger-Record       pic x.\n     03  WS-Posting-Record      pic x.\n     03  WS-Batch-Record        pic x.\n     03  WS-IRS-Posting-Record  pic x.\n     03  WS-Stock-Audit-Record  pic x.\n     03  WS-Stock-Record        pic x.\n*>     03  WS-Sales-Record        pic x.\n     03  WS-Value-Record        pic x.\n*>     03  WS-Delivery-Record     pic x.\n     03  WS-Analysis-Record     pic x.\n     03  WS-Del-Inv-Nos-Record  pic x.\n     03  WS-Purch-Record        pic x.\n     03  WS-Pay-Record          pic x.\n     03  WS-Invoice-Record      pic x.\n     03  WS-OTM3-Record         pic x.\n     03  WS-PInvoice-Record     pic x.\n     03  WS-OTM5-Record         pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  a               pic 999.\n     03  B               pic 9.\n     03  y               pic 99.\n     03  z               pic 9.\n     03  error-flag      pic 9           value zero.\n     03  escape-code     pic x.\n     03  save-tag        binary-long.\n     03  save-notes-tag  binary-long.\n     03  print-out       pic x.\n     03  d24-02          pic x           value space.\n     03  d24-03          pic x           value space.\n     03  d24-check.\n         05  filler      pic x(13)       value \"Check Digit {\".\n         05  d24-digit   pic x           value space.\n         05  filler      pic x           value \"}\".\n     03  a01-late-charg  pic x           value space.\n     03  a01-dun-letter  pic x           value space.\n     03  a01-Email-Let   pic x           value space.\n     03  a01-Email-Stat  pic x           value space.\n     03  a01-Email-Inv   pic x           value space.\n     03  A01-Notes.\n         05  a01-Notes-1     pic x(48)       value spaces.\n         05  a01-Notes-2     pic x(48)       value spaces.\n     03  A01-Deliv-Name  pic x(30)       value spaces.\n     03  A01-Deliv-Address.\n         05  A01-deliv-addr1 pic x(48)       value spaces.\n         05  A01-deliv-addr2 pic x(48)       value spaces.\n     03  cust-in         pic x(6)        value spaces.\n     03  status-in       pic x           value space.\n     03  credit-in       pic 99          value zero.\n     03  credit-op       pic x           value space.\n     03  invoice-in      pic 9(5)        value zero.\n     03  invoice-op      pic x           value space.\n     03  average-in      pic 9(5)        value zero.\n     03  average-op      pic x           value space.\n     03  overdue-in      pic 9(5)        value zero.\n     03  overdue-op      pic x           value space.\n     03  enter-date-in   pic x(10)       value spaces.\n     03  enter-date-op   pic x           value space.\n     03  ws-Local-Date   pic x(10)       value spaces.\n     03  ws-Test-Date    pic x(10).\n     03  truth           pic 9           value zero.\n         88  a-true   value  1.\n         88  a-false  value  0.\n     03  customer-nos2   pic x(6)        value spaces.\n     03  test-1          binary-long.\n     03  test-2          binary-long.\n     03  test-op         pic x.\n     03  credit-heading.\n         05  cr-operand  pic xx.\n         05  cr-days     pic z9.\n         05  filler      pic x(12)       value  \" Days Credit\".\n     03  active-heading.\n         05  act-operand pic xx.\n         05  act-days    pic zzzz9.\n         05  filler      pic x(9)        value  \" Invoices\".\n     03  average-heading.\n         05  av-operand  pic xx.\n         05  av-days     pic zzzz9.\n         05  filler      pic x(10)       value  \" Av. Value\".\n     03  overdue-heading.\n         05  ov-operand  pic xx.\n         05  ov-days     pic zzzz9.\n         05  filler      pic x(13)       value \" Days Overdue\".\n     03  enter-date-heading.\n         05  ed-operand  pic xx.\n         05  ed-date     pic x(10).\n         05  filler      pic x(11)       value \" Entry Date\".\n     03  ws-enter-date   binary-long     value zero.\n     03  address-line    pic x(32).\n     03  display-bal     pic -(8)9.99.\n     03  test-address    pic x(96).\n     03  ws-spaces-30                    value spaces.\n         05  ws-spaces-7 pic x(7).\n         05  ws-spaces-13 pic x(13).\n         05  filler      pic x(10).\n     03  ws-eval-msg     pic x(25)       value spaces.\n     03  intest          pic x.\n     03  line-cnt        pic 99   comp   value zero.\n     03  Customer-In     pic x(7).\n     03  WS-BO-State     pic x           value \"Y\".\n         88  WS-BO-Valid-State           values \"Y\" \"N\".\n     03  WS-BO-Status    pic x           value space.\n         88  WS-BO-Active                value \"Y\".\n     03  ws-env-lines    pic 999       value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>\n 01  ws-amount-screen-display9.\n     03  ws-poundsd9     pic 9(9).\n     03  ws-period9      pic x     value \".\".\n     03  ws-penced9      pic v99.\n 01  ws-amount-screen-accept9 redefines ws-amount-screen-display9.\n     03  ws-pound9       pic 9(9).\n     03  filler          pic x.\n     03  ws-pence9       pic v99.\n*>\n 01  ws-amount-work9.\n     03  amt-wk-pds9     pic 9(9).\n     03  amt-wk-pence9   pic v99.\n 01  ws-amount-ok9 redefines ws-amount-work9.\n     03  amt-ok9         pic 9(9)v99.\n*>\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n 01  error-code          pic 999.  *> Used.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SL002          pic x(31) value \"SL002 Note error and hit return\".\n     03  SL004          pic x(20) value \"SL004 Now Hit return\".\n     03  SL005          pic x(18) value \"SL005 Invalid Date\".\n*> Module specific\n     03  SL101          pic x(14) value \"SL101 Addr Err\".\n     03  SL102          pic x(5)  value \"Error\".\n     03  SL103          pic x(49) value \"SL103 Sales Ledger files have not been set up yet\".\n     03  SL104          pic x(44) value \"SL104 Do you wish to create them (Y/N) ? [ ]\".\n     03  SL105          pic x(37) value \"SL105 Creating Sales & Delivery Files\".\n     03  SL106          pic x(31) value \"SL106 Opening Sales file gives \".\n     03  SL107          pic x(34) value \"SL107 Opening Delivery file gives \".\n     03  SL108          pic x(34) value \"SL108 Abort Or Recover (A/R) : [ ]\".\n     03  SL109          pic x(53) value \"SL109 <<< Can not Delete currently active account >>>\".\n     03  SL110          pic x(31) value \"SL110 Response Must Be (Y or N)\".\n     03  SL111          pic x(31) value \"SL111 Customer Record Not Found\".\n     03  SL112          pic x(36) value \"SL112 Customer Record Already Exists\".\n*>\n 01  line-1.  *> 132\n     03  l1-version      pic x(57)       value spaces.\n     03  filler          pic x(67)       value \"Customer Listing\".\n     03  filler          pic x(5)        value \"Page \".\n     03  l1-page         pic zz9.\n*>\n 01  line-3.\n     03  l3-user         pic x(40).\n     03  filler          pic x(12)       value  \"Report On : \".\n     03  l3-report       pic x(70)       value  spaces.\n     03  l3-date         pic x(10).\n*>\n 01  line-4.\n     03  filler          pic x(127)      value\n         \"Customer  Status    <---------------Name & Address-------------->     ----Telephone\" &\n         \"---- -----Fax----- BO  Late       Credit\".\n     03  filler          pic x(5)        value \" Disc\".\n*>\n 01  line-5.\n     03  filler          pic x           value space.\n     03  filler          pic x(103)      value \"Number   ------\".\n     03  filler          pic x(28)       value \"Chg  Let   Limit/Days    %\".\n*>\n 01  line-6.\n     03  l6-key          pic x(10).\n     03  l6-status       pic x(10).\n     03  l6-name         pic x(50).\n     03  l6-phone        pic x(18).\n     03  l6-fax          pic x(13).\n     03  filler          pic xx          value spaces.\n     03  L6-BO           pic xb.\n     03  l6-charges      pic xb(4).\n     03  l6-letter       pic xbb.\n     03  l6-limit        pic z(6)9       blank when zero.\n     03  l6-credit       pic zzz9bbb     blank when zero.\n     03  l6-discount     pic z9.99       blank when zero.\n*>\n 01  line-7.\n     03  filler          pic x(20)       value spaces.\n     03  l7-address      pic x(112).\n*>\n linkage section.\n*>==============\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day              pic x(10).\n*>\n screen section.\n*>=============\n*>\n*>   ALL Adjusted left 5 chars 29/11/11\n*>\n 01  display-02                  background-color cob-color-black\n                                 foreground-color cob-color-green\n                                                     blank screen.\n\n     03  value \"Customer Nos : [\"    line  4 col  1.\n*> >>>>>>>> customer no here <<<<<<<\n     03  from d24-02          pic x  line  4 col 23.\n     03  from d24-03          pic x          col 24.\n     03  from d24-check       pic x(15)      col 26.\n     03  value \"Customer Name: [\"    line  6 col  1.\n     03  using sales-name  pic x(30) line  6 col 17.\n     03  value \"]\"                   line  6 col 47.\n     03  value \"Addr: [\"             line  7 col 10.\n     03  using sales-addr1    pic x(48)      col 17.\n     03  value \"]\"                   line  7 col 65.\n     03  value \"[\"                   line  8 col 16.\n     03  using sales-addr2    pic x(48)      col 17.\n     03  value \"]\"                   line  8 col 65.\n     03  value \"Delivery name: [\"    line  9 col  1.\n     03  using A01-deliv-name     pic x(30)      col 17.\n     03  value \"]\"                           col 47.\n     03  value \"Addr: [\"             line 10 col 10.\n     03  using A01-deliv-addr1    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"[\"                   line 11 col 16.\n     03  using A01-deliv-addr2    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"Customer Note: [\"    line 12 col  1.\n     03  using a01-Notes-1    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"[\"                   line 13 col 16.\n     03  using a01-Notes-2    pic x(48)      col 17.\n     03  value \"]\"                           col 65.\n     03  value \"Telephone    : [\"    line 14 col  1.\n     03  using sales-phone    pic x(13)      col 17.\n     03  value \"]\"                           col 30.\n     03  value \"Ext: [\"                      col 32.\n     03  using sales-ext      pic x(4)       col 38.\n     03  value \"]\"                           col 42.\n     03  value \"Fax : [\"                     col 45.\n     03  using sales-fax      pic x(13)      col 52.\n     03  value \"]\"                           col 65.\n     03  value \"Email Sales  : [\"    line 15 col  1.\n     03  using sales-email    pic x(30)      col 17.\n     03  value \"]\"                           col 47.\n*> added 15/03/24\n     03  value \"BO Allowed - [\"              col 49.\n     03  using Sales-Partial-Ship-Flag\n                              pic x          col 63.\n     03  value \"] (Y or N)\"                  col 64.\n*>\n     03  value \"Late charges : [\"    line 16 col  1.\n     03  using a01-late-charg  pic x         col 17.\n     03  value \"]\"                           col 18.\n     03  value \"Minimum balance before late charge : [\" col 26.\n     03  using sales-late-min pic 9(4)       col 64.\n     03  value \"]\"                           col 68.\n     03  value \"Late letters : [\"    line 17 col  1.\n     03  using a01-dun-letter  pic x         col 17.\n     03  value \"]\"                           col 18.\n     03  value \"Maximum late charge\"         col 26.\n     03  value \": [\"                         col 61.\n     03  using sales-late-max pic 9(4)       col 64.\n     03  value \"]\"                           col 68.\n     03  value \"Credit period: [\"    line 18 col  1.\n     03  using sales-credit   pic 99         col 17.\n     03  value \"]\"                           col 19.\n     03  value \"EMail-Inv:[\"                 col 26.\n     03  using a01-Email-Inv  pic x          col 37.\n     03  value \"]\"                           col 38.\n     03  value \"Stat: [\"                     col 40.\n     03  using a01-EMail-Stat pic x          col 47.\n     03  value \"]\"                           col 48.\n     03  value \"Dun : [\"                     col 50.\n     03  using a01-EMail-Let  pic x          col 57.\n     03  value \"]\"                           col 58.\n     03  value \"Credit limit : [\"    line 19 col  1.\n     03  using sales-limit    pic 9(7)       col 17.\n     03  value \"] Discount : [\"              col 24.\n     03  using sales-discount pic 99.99      col 38.\n     03  value \"]\"                           col 43.\n     03  value \"*******************\" line 19 col 56.\n     03  value \"Unapplied Bal: {\"    line 20 col  1.\n     03  value \"}\"                           col 29.\n     03  value \"* Escape Code [\"             col 56.\n*> value entered by individual display.\n     03  value \"] *\"                         col 72.\n     03  value \"Current Bal  : {\"    line 21 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 29.\n     03  value \"* <B> = Back      *\"         col 56.\n     03  value \"Last invoice : {\"    line 22 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 27.\n     03  value \"* <S> = Save      *\"         col 56.\n     03  value \"Last payment : {\"    line 23 col  1.\n*> value entered by individual display\n     03  value \"}\"                           col 27.\n     03  value \"* <Q> = Quit      *\" line 23 col 56.\n     03  value \"*******************\" line 24 col 56.\n*>\n 01  display-03                  background-color cob-color-black\n                                 foreground-color cob-color-green.\n     03  from prog-name  pic x(15)                 line  1 col  1\n                                                    blank screen.\n     03  value \"Customer File\"                             col 34.\n     03  from ws-Local-Date     pic x(10)          line  1 col 71.\n     03  value \"Report Attributes\"                 line  3 col 32.\n*>\n*> Adjusted left 6 chars 29/11/11\n*>\n     03  value \"Customer Number - [\"               line  8 col  3.\n     03  using cust-in   pic x(6)                          col 22.\n     03  value \"]\"                                         col 28.\n     03  value \"Enter characters in positions to match\"    col 33.\n     03  value \"Status          - [\"               line 10 col  3.\n     03  using status-in pic x                             col 22.\n     03  value \"]\"                                         col 23.\n     03  value \"<L> Live;<D> Dormant;< > All\"              col 33.\n     03  value \"Credit Period   - [\"               line 12 col  3.\n     03  using credit-in pic 99                            col 22.\n     03  value \"]  [\"                                      col 24.\n     03  using credit-op pic x                             col 28.\n     03  value \"]\"                                 line 12 col 29.\n     03  value \"Enter number of days & operator\"           col 33.\n     03  value \"<L>  for credit periods < than\"    line 13 col 37.\n     03  value \"<G>  for credit periods > than\"    line 14 col 37.\n     03  value \"<E>  for credit periods = to\"      line 15 col 37.\n     03  value \"Invoice Activity  [\"               line 17 col  3.\n     03  using invoice-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using invoice-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter number of invoices & operator\"       col 33.\n     03  value \"Average Value   - [\"               line 19 col  3.\n     03  using average-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using average-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter invoice value & operator\"            col 33.\n     03  value \"Overdue A/Cs    - [\"               line 21 col  3.\n     03  using overdue-in pic 9(5)                         col 22.\n     03  value \"] [\"                                       col 27.\n     03  using overdue-op pic x                            col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter number of days & operator\"           col 33.\n     03  value \"Date Entered-[\"                    line 23 col  3.\n     03  using enter-date-in pic x(10)                     col 17.\n     03  value \"] [\"                                       col 27.\n     03  using enter-date-op pic x                         col 30.\n     03  value \"]\"                                         col 31.\n     03  value \"Enter date & operator\"                     col 33.\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>=======================================\n init01 section.\n*>\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     move     prog-name to l1-version.\n     move     to-day to u-date.\n*> Force Esc, PgUp, PgDown, PrtSC to be detected\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     move     Print-Spool-Name to PSN.\n     move     space to Print-Out.\n     if       SL-BO-Default not = \"Y\" and not = \"N\"\n              move     \"N\" to SL-BO-Default.      *>< JIC not yet set up\n     if       SL-BO-Flag = \"Y\"  *> BO active in param rec\n              open i-o BO-Stk-Itm-File\n              If       FS-Reply not = zero\n                       close BO-Stk-Itm-File\n                       move     \"N\" to WS-BO-Status\n              else\n                       move     \"Y\" to WS-BO-Status.\n*>\n     move     1  to File-Key-No.\n*>\n     if       not S-L-Exists\n              perform slcreate.\n*>\n menu-return.\n*>**********\n*>\n     move     zero  to  menu-reply.\n     perform  display-heading.\n*>\n menu-input.\n*>*********\n*>\n     display  \"Select one of the following by number :- [ ]\" at 0701 with foreground-color 2.\n     display  \"(1)  Set-up Customer records\"  at 1004  with foreground-color 2.\n     display  \"(2)  Amend Customer records\"   at 1204  with foreground-color 2.\n     display  \"(3)  Delete Customer records\"  at 1404  with foreground-color 2.\n     display  \"(4)  Print Customer records\"   at 1604  with foreground-color 2.\n     display  \"(5)  Display Customer records\" at 1804  with foreground-color 2.\n     display  \"(6)  Amend Back Order Status\"  at 2004  with foreground-color 2.\n     display  \"(9)  Return to System Menu\"    at 2204  with foreground-color 2.\n     accept   menu-reply at 0743 with foreground-color 2 auto.\n*>\n     if       menu-reply = 9\n              go to  Menu-Exit.\n*>\n     if       menu-reply  <  1  or  >  6\n              go to  menu-input.\n*>\n     if       menu-reply = 1\n              perform  ba000-Setup-Customers\n     else\n      if      menu-reply = 2\n              perform  ca000-Amend-Customer\n      else\n       if     menu-reply = 3\n              perform  da000-Delete-Customer\n       else\n        if    menu-reply = 4\n              perform  ea000-Report-Customers\n        else\n         if   menu-reply = 5\n              perform  fa000-Display-Customers\n         else\n          if  Menu-Reply = 6\n              perform  ga000-Amend-BO-Status.\n*>\n     go       to menu-return.\n*>\n menu-exit.\n*>********\n*>\n     exit     program.\n*>\n maps03.\n*>*****\n*>\n     call     \"maps04\"  using  maps03-ws.\n*>\n maps09.\n*>*****\n*>\n     call     \"maps09\"  using  maps09-ws. *>  customer-code.\n*>\n clear-error-line.\n*>***************\n*>\n     display  \" \" at line ws-23-lines col 01 with erase eol.\n*>\n clear-error-line-24.\n*>******************\n*>\n     display  \" \" at line ws-lines    col 01 with erase eol.\n*>\n test-escape  section.\n*>===================\n*>\n     display  escape-code at 2071 with foreground-color 6.\n*>\n get-escape.\n*>*********\n*>\n     accept   escape-code at 2071 with foreground-color 6 update.\n     move     FUNCTION UPPER-CASE (escape-code) to escape-code.\n*>\n     if       escape-code not = \"B\" and not = \"S\" and not = \"Q\"\n                      and not = \"K\" and not = \"D\"\n                      and not = \"T\"                           *> TESTING ONLY during cust. display\n              go to get-escape.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n display-heading         section.\n*>==============================\n*>\n     display  \" \" at 0101 with foreground-color 2 erase eos.\n*>\n     move     spaces to d24-02 d24-check.\n     move     \"]\" to d24-03.\n*>\n     if       menu-reply not = 4\n              display prog-name at 0101 with foreground-color 2\n              perform zz070-convert-date\n              move    ws-date to ws-local-date\n              display ws-date at 0171 with foreground-color 2.\n*>\n     if       menu-reply = zero\n              display \"Customer File Set-Up & Maintenance\" at 0124 with foreground-color 2\n              display \"Function Menu\" at 0434                     with foreground-color 2\n              go to main-exit\n     else\n       if     menu-reply = 1\n              display \"Customer Record Creation\"  at 0129 with foreground-color 2\n              move \"Check Digit { }\" to d24-check\n              move \"]\" to d24-02\n              move space to d24-03\n       else\n        if    menu-reply = 2\n              display \"Customer Record Amendment\" at 0129 with foreground-color 2\n        else\n         if   menu-reply = 3\n              display \"Customer Record Deletion\"  at 0129 with foreground-color 2\n         else\n          if  menu-reply = 5\n              display \"Customer Record Display\"   at 0129 with foreground-color 2\n          else\n           if Menu-Reply = 6\n              display \"Amend Back Order Status\"   at 0129 with foreground-color 2.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n customer-display   section.\n*>*************************\n*>\n     if       late-charges\n              move  \"Y\" to a01-late-charg\n     else\n              move  \"N\" to a01-late-charg.\n*>\n     if       dunning-letters\n              move  \"Y\" to a01-dun-letter\n     else\n              move  \"N\" to a01-dun-letter.\n*>\n     if       Email-Invoicing\n              move \"Y\" to a01-Email-Inv\n     else\n              move \"N\" to a01-Email-Inv.\n     if       Email-Statementing\n              move \"Y\" to a01-Email-Stat\n     else\n              move \"N\" to a01-Email-Stat.\n     if       Email-Dunning\n              move \"Y\" to a01-Email-Let\n     else\n              move \"N\" to a01-Email-Let.\n     if       menu-reply = 1\n              move WS-Sales-Key (7:1) to d24-digit\n*>              move check-digit of WS-Sales-Key to d24-digit\n     else\n              move WS-Sales-Key (7:1) to d24-02.\n*>              move check-digit of WS-Sales-Key to d24-02.\n*>\n     if       Sales-Partial-Ship-Flag = space\n              move \"N\" to Sales-Partial-Ship-Flag.\n     display  display-02.\n     if       menu-reply = 1 or 2\n              go to cd-exit.\n*>\n     move     sales-unapplied to display-bal.\n     display  display-bal at 2017 with foreground-color 2.\n*>\n     move     sales-current  to  display-bal.\n     display  display-bal at 2117 with foreground-color 2.\n*>\n     if       sales-last-inv not = zero\n              move sales-last-inv  to  u-bin\n              perform zz060-Convert-Date\n              display ws-date at 2217 with foreground-color 2.\n*>\n     if       sales-last-pay not = zero\n              move sales-last-pay  to  u-bin\n              perform zz060-Convert-Date\n              display ws-date at 2317 with foreground-color 2.\n*>\n cd-exit.\n     exit     section.\n*>\n Display-Outline         section.\n*>==============================\n*>\n     perform  display-heading.\n     initialize WS-Sales-Record\n                WS-Delivery-Record.\n     move     spaces to a01-late-charg\n                        a01-dun-letter\n                        a01-Email-Let\n                        a01-Email-Stat\n                        a01-Email-Inv\n                        a01-deliv-name\n                        a01-Deliv-Address\n                        a01-Notes.\n     display  display-02.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n customer-data           section.\n*>==============================\n*>\n Customer-Data-Main.\n     move     zero to error-flag.\n     display  display-02.\n     accept   display-02.\n*>\n     move     sales-address  to  test-address.\n     perform  validate-address.\n*>\n     if       a-false\n              display SL101 at 0766 with foreground-color 4\n              move 1 to error-flag\n      else\n              display space at 0766 with erase eol\n     end-if\n*>\n     if       A01-deliv-name = spaces\n       and    A01-deliv-Address = spaces\n        and   delivery-tag not = zero\n              move WS-Sales-Key to WS-Deliv-Sales-Key\n              move \"D\"          to WS-Deliv-Key-Type\n              perform Delivery-Delete     *> delete delivery-file invalid key\n              if     fs-Reply not = zero\n                     move zero to delivery-tag\n              end-if\n     end-if\n*>\n     if       A01-deliv-Name = spaces\n       and    A01-deliv-Address = spaces\n              move  zero  to  delivery-tag\n              go to bypass-deliv-test\n     end-if\n*>\n     move     A01-deliv-address  to  test-address.\n     perform  validate-address.\n*>\n     if       a-false\n              display SL101 at 1066 with foreground-color 4\n              move 1 to error-flag\n      else\n              display \" \" at 1066 with erase eol\n     end-if\n*>\n     if       A01-deliv-address not = spaces\n              move 1 to Delivery-Tag.\n*>\n bypass-deliv-test.\n*>****************\n*>\n     if       A01-Notes = spaces\n         and  Notes-Tag not = zero\n              move WS-Sales-Key to WS-Deliv-Sales-Key\n              move \"N\"          to WS-Deliv-Key-Type\n              perform  Delivery-Delete        *> delete delivery-file invalid key\n              if       fs-reply not = zero\n                       move zero to Notes-tag\n              end-if\n     end-if\n*>\n*>  yes I know, but just in case!!\n*>\n     if       A01-Notes = spaces\n              move zero to Notes-Tag\n     else\n              move 1 to Notes-Tag\n     end-if.\n*>\n Bypass-Notes-Test.\n*>****************\n*>\n     move     a01-late-charg to ws-reply.\n     perform  validate-response.\n*>\n     if       a-true\n              move  z  to  sales-late\n              display ws-spaces-7 at 1619\n     else\n              move 1 to error-flag\n              display SL102 at 1619 with foreground-color 4.\n*>\n     move     FUNCTION UPPER-CASE (Sales-Partial-Ship-Flag) to Sales-Partial-Ship-Flag.\n     if       Sales-Partial-Ship-Flag = space\n              move \"N\" to Sales-Partial-Ship-Flag.\n     if       Sales-Partial-Ship-Flag = \"Y\" or\n                                      = \"N\"\n              display \" \" at 1575\n     else\n              move 1 to Error-Flag\n              display \"*\" at 1575 with foreground-color 4.\n*>\n     move     a01-dun-letter to ws-reply.\n     perform  validate-response.\n*>\n     if       a-true\n              display ws-spaces-7 at 1719\n              move  z  to  sales-dunning\n     else\n              move 1 to error-flag\n              display SL102 at 1719 with foreground-color 4.\n*>\n     move     a01-Email-Inv to ws-reply.\n     perform  validate-response.\n     if       a-true\n              display \" \" at 1839\n              move z to Email-Invoice\n     else\n              move 1 to error-flag\n              display \"*\" at 1839 with foreground-color 4.\n*>\n     move     a01-Email-Stat to ws-reply.\n     perform  validate-response.\n     if       a-true\n              display \" \" at 1849\n              move z to Email-Statement\n     else\n              move 1 to error-flag\n              display \"*\" at 1849 with foreground-color 4.\n*>\n     move     a01-Email-Let to ws-reply.\n     perform  validate-response.\n     if       a-true\n              display \" \" at 1859\n              move z to Email-Letters\n     else\n              move 1 to error-flag\n              display \"*\" at 1859 with foreground-color 4.\n*>\n     if       error-flag not = zero\n              go to customer-data-Main.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n validate-address        section.\n*>==============================\n*>\n     move     zero  to  a.\n*>\n     inspect  test-address  tallying a for all sl-delim.\n*>\n     if       a  >  4  or  <  1\n              move  zero  to  truth\n     else\n              move  1  to  truth.\n*>\n     move     zero  to  a.\n     inspect  test-address tallying a for characters before initial sl-delim.\n*>\n*> Check for basic report/label limits\n*>\n     if       a  >  30\n              move  zero  to  truth.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n validate-response       section.\n*>==============================\n*>\n     move     1  to  truth.\n*>\n     move     FUNCTION UPPER-CASE (ws-reply) to ws-reply.\n     if       ws-reply = \"Y\"\n              move  1  to  z\n     else\n      if      ws-reply = \"N\"\n              move  zero  to  z\n      else\n              move  zero  to  truth.\n*>\n     if       a-false\n              display SL110   at 2301\n              display SL002   at 2401\n              accept ws-reply at 2440\n              go to main-exit.\n*>\n     perform  clear-error-line-24.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n Accept-Key              section.\n*>==============================\n*>\n     move     spaces to WS-Sales-Key.\n*>\n     accept   WS-Sales-Key at 0417 with foreground-color 3 UPPER.\n*>\n     move     zero  to  error-code.\n*>\n     if       WS-Sales-Key = spaces\n              move  999  to  error-code\n              go to  main-exit.\n*>\n     move     zero to     save-tag\n                          save-notes-tag.               *> force clear\n     perform  Sales-Read-Indexed.\n     if       FS-reply = 21\n              display SL111  at 2301\n              move spaces to  customer-code\n              go to  main-exit.\n*>\n     perform  clear-error-line.\n     move     WS-Sales-Key  to  customer-code.\n*>\n*>  Check for Delivery address\n*>\n     if       delivery-tag not = zero\n              move     WS-Sales-Key to WS-Deliv-Sales-Key\n              move     \"D\"          to WS-Deliv-Key-Type\n              perform Delivery-Read-Indexed\n              if      fs-reply = 21\n                          move zero  to  delivery-tag\n                          move \"Record not found\"  to A01-deliv-name\n                          move space               to A01-Deliv-Address\n              else             *>  not invalid key\n                          move deliv-name     to A01-deliv-name\n                          move deliv-address  to A01-Deliv-Address\n                          move 1              to save-tag  delivery-tag\n     end-if\n*>\n*>  Check for Notes\n*>\n     if       Notes-Tag not = zero\n              move     WS-Sales-Key to WS-Deliv-Sales-Key\n              move     \"N\"          to WS-Deliv-Key-Type\n              perform Delivery-Read-Indexed\n              if      fs-reply = 21\n                          move zero  to  Notes-tag\n                          move \"Record Not Found\" to A01-Notes-1\n                          move spaces             to A01-Notes-2\n              else   *>    not invalid key\n                          move Deliv-Address to A01-Notes\n                          move 1     to save-notes-tag\n                                        notes-tag\n     end-if.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ba000-Setup-Customers   section.\n*>==============================\n*>\n     perform  Sales-Open.\n     perform  Delivery-Open.\n*>\n customer-input.\n*>*************\n*>\n     move     spaces to a01-Notes.\n     perform  Display-Outline.\n*>\n customer-accept.\n*>**************\n*>\n     move     spaces to customer-nos.\n     accept   customer-nos at 0417 with foreground-color 3.\n     if       customer-nos = spaces\n              go to  main-end.\n     move     FUNCTION UPPER-CASE (customer-nos) to customer-nos.\n     display  customer-nos at 0417 with foreground-color 3.\n*>\n     perform  clear-error-line.\n*>\n     move     \"C\"  to  maps09-reply.\n     perform  maps09.\n     if       maps09-reply not = \"Y\"\n              go to  customer-accept.\n*>\n     move     customer-code  to  WS-Sales-Key.\n *>    read     sales-file  not invalid key        *>    Therefore, Record already exists\n     perform  Sales-Read-Indexed.\n     if       FS-Reply not = 21\n              display SL112  at 2301\n              perform  customer-display\n              go       to customer-accept.\n*>\n customer-details.\n*>***************\n*>\n     if       menu-reply = 1\n              display check-digit of maps09-ws at 0439 with foreground-color 3.\n*>\n     display  ws-spaces-30 at 2101.\n     display  ws-spaces-30 at 2201.\n     display  ws-spaces-30 at 2301.\n     initialize WS-Sales-Record\n                WS-Delivery-Record.          *>  and grab defaults from system file\n     move     customer-code to WS-Sales-Key.\n     move     SL-BO-Default to Sales-Partial-Ship-Flag.\n     move     sl-charges to  sales-late.\n     move     sl-dunning to  sales-dunning.\n     move     sl-credit  to  sales-credit.\n     move     sl-disc    to  sales-discount.\n     move     sl-min     to  sales-late-min.\n     move     sl-max     to  sales-late-max.\n     move     sl-limit   to  sales-limit.\n     move     run-date   to  sales-create-date.\n     move     1          to  sales-status.              *> Live\n*>\n get-details.\n*>***********\n*>\n     perform  customer-display.\n     perform  customer-data.\n*>\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>***********\n*>\n     if       escape-code = \"B\"\n              go to get-details.\n*>\n     if       escape-code = \"Q\"\n              go to  main-end.\n*>\n *>    we know that rec doesnt exist and file is open so no test\n     perform  Sales-Write.\n*>\n     if       delivery-tag  not = zero\n              move   WS-Sales-Key to WS-Deliv-Sales-Key\n              move   \"D\"          to WS-Deliv-Key-Type\n              move   A01-deliv-name    to deliv-name\n              move   A01-deliv-address to deliv-address\n              perform Delivery-Write.\n*>\n     if       Notes-Tag not = zero\n              move   WS-Sales-Key to WS-Deliv-Sales-Key\n              move   \"N\"          to WS-Deliv-Key-Type\n              move   spaces    to deliv-name\n              move   A01-Notes to deliv-address\n              perform Delivery-Write.\n*>\n     initialize WS-Sales-Record\n                WS-Delivery-Record.\n     go       to customer-input.\n*>\n main-end.\n*>*******\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ca000-Amend-Customer  section.\n*>============================\n*>\n     perform  Sales-Open.\n     perform  Delivery-Open.\n*>\n customer-input.\n*>*************\n*>\n     perform  Display-Outline.\n*>\n customer-accept.\n*>**************\n*>\n     perform  Accept-Key.\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n     move     delivery-tag  to  save-tag.\n     move     Notes-Tag     to  save-Notes-Tag.\n     if       Email-Invoice not = 0 and not = 1\n              move zero to Email-Invoice Email-Statement Email-Letters.\n*>\n get-details.\n*>**********\n*>\n     perform  customer-display.\n     perform  customer-data.\n     move     \"S\"  to   escape-code.\n     perform  test-escape.\n*>\n main-output.\n*>**********\n*>\n     if       escape-code = \"B\"\n              go to get-details.\n*>\n     if       escape-code = \"Q\"\n              go to  customer-input.\n*>\n*>  Now deal with delivery Address\n*>\n     move     \"D\"           to WS-Deliv-Key-Type.\n     move     WS-Sales-Key  to WS-Deliv-Sales-Key.\n     move     A01-deliv-name    to deliv-name.\n     move     A01-deliv-address to deliv-address.\n*>\n     if       delivery-tag  not = zero\n       and    save-tag = zero\n *>  THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Write\n              if       fs-reply not = zero\n                       display \"write deliverytag \" at line ws-23-lines col 1\n                       display fs-reply at line ws-23-lines col 20\n                       perform evaluate-message\n                       display ws-Eval-Msg at line ws-23-lines col 23\n                       display SL002        at line ws-lines col 1\n                       accept  Accept-Reply at line ws-lines col 20\n                       display \" \" at line ws-23-lines col 1 with erase eos\n*>\n                       perform Delivery-Rewrite\n              end-if\n     else\n      if      delivery-tag  not = zero\n *>  THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Rewrite\n              if       fs-reply not = zero\n                       display \"rewrite deliverytag \" at line ws-23-lines col 1\n                       display fs-reply at line ws-23-lines col 20\n                       perform evaluate-message\n                       display ws-Eval-Msg at line ws-23-lines col 23\n                       display SL002       at line ws-lines col 1\n                       accept  Accept-Reply at line ws-lines col 20\n                       display \" \" at line ws-23-lines col 1 with erase eos.\n*>\n     if       delivery-tag = zero\n       and    save-tag  not = zero\n *>    THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Delete\n              if      fs-reply not = zero\n                      display \"Delete deliverytag \" at line ws-23-lines col 1\n                      display fs-reply at line ws-23-lines col 20\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display SL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos.\n*>\n*>  Now deal with Notes\n*>\n     move     \"N\"            to WS-Deliv-Key-Type.\n     move     WS-Sales-Key   to WS-Deliv-Sales-Key.\n     move     spaces      to deliv-name.\n     move     A01-Notes   to deliv-address.\n*>\n     if       Notes-Tag not = zero\n        and   save-notes-tag = zero\n *>  THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Write\n              if      fs-reply not = zero\n                      display \"write notes tag \" at line ws-23-lines col 1\n                      display fs-reply  at line ws-23-lines col 20\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display SL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos\n              end-if\n     else\n      if      Notes-Tag not = zero\n *>   THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Rewrite\n              if      fs-reply not = zero\n                      display \"Rewrite notes tag \" at line ws-23-lines col 1\n                      display fs-reply\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display SL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos\n              end-if.\n*>\n     if       Notes-Tag = zero\n       and    save-notes-tag  not = zero\n *>    THIS STUFF FOR DEBUGGING, REMOVE AFTER\n              perform Delivery-Delete\n              if      fs-reply not = zero\n                      display \"Delete notes tag \" at line ws-23-lines col 1\n                      display fs-reply\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display SL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display space at line ws-23-lines col 1 with erase eos\n              end-if.\n*>\n *>                 tags should be set already\n     perform  Sales-Rewrite.\n     if       fs-reply not = zero\n                      display \"Rewrite Sales Rec \" at line ws-23-lines col 1\n                      display fs-reply\n                      perform evaluate-message\n                      display ws-Eval-Msg at line ws-23-lines col 23\n                      display SL002       at line ws-lines col 1\n                      accept  Accept-Reply at line ws-lines col 20\n                      display \" \" at line ws-23-lines col 1 with erase eos\n     end-if.\n     go       to customer-input.\n*>\n main-end.\n*>*******\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n Evaluate-Message        Section.\n*>==============================\n*>\n copy \"FileStat-Msgs.cpy\" replacing MSG by ws-Eval-Msg\n                                    STATUS by fs-reply.\n*>\n Eval-Msg-Exit.  exit section.\n*>************   ************\n*>\n da000-Delete-Customer  section.\n*>=============================\n*>\n     perform  Sales-Open.\n     perform  Delivery-Open.\n*>\n customer-input.\n     perform  Display-Outline.\n     display  \"D> = Dormant\" at 2159 with foreground-color 2.\n     display  \"K> = Kill \" at 2259 with foreground-color 2.\n*>\n customer-accept.\n     perform  Accept-Key.  *> get sales cust key\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n get-details.\n     perform  customer-display.\n*>\n     move     \"K\"  to   escape-code.\n     perform  test-escape.\n*>\n     if       escape-code = \"Q\"\n              go to  main-end.\n*>\n     move     spaces to BO-Cust-Itm-No.\n     if       WS-BO-Active\n              move     WS-Sales-Key to BO-Stk-Cust-No\n              move     low-values   to BO-Stk-Item-No\n              start    BO-Stk-Itm-File KEY not < BO-Cust-Itm-No\n              read     BO-Stk-Itm-File next record.\n*>\n     if       sales-current not = zero\n          or  sales-unapplied not = zero\n          OR  BO-Stk-Cust-No = WS-Sales-Key\n              display SL109  at 0501 with foreground-color 4\n              go to  customer-accept.\n*>\n     display  \" \" at 0501 with erase eol.\n*>\n     if       escape-code = \"D\"\n              move  zero  to  sales-status\n              perform Sales-Rewrite.\n*>\n     if       escape-code  not = \"K\"\n              go to  customer-input.\n*>\n main-output.\n*>**********\n*>\n*>  Delete and dont bother checking if present as delete will fail so no prob.\n*>\n     move     \"D\"          to WS-Deliv-Key-Type.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     perform  Delivery-Delete.\n     move     \"N\"          to WS-Deliv-Key-Type.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     perform  Delivery-Delete.\n     perform  Sales-Delete.\n*>\n main-end.\n*>*******\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ea000-Report-Customers  section.\n*>==============================\n*>\n     perform  Report-Selection.\n     perform  Report-Heading-Setup.\n     perform  Produce-Report.\n*>\n main-end.\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n ga000-Amend-BO-Status   section.\n*>==============================\n*>\n     perform  Sales-Open.\n*>\n ga010-Customer-Input.\n     perform  display-heading.\n     move     \"Y\" to WS-BO-State. *> preset but others will use last used.\n*>\n ga020-Customer-Accept.\n     display  \"Customer account for search and change [       ]\" at 0401\n                                                    with foreground-color 2\n                                                    erase eol.\n     display  \"BO State [ ]\" at 0461 with foreground-color 2.\n     display  \"Escape = Quit, one or more chars process group of customers, or 7 Chars for one\"\n                                                at 0701\n                                                with foreground-color 4 erase eol.\n     accept   Customer-In at 0441 with foreground-color 3 UPPER.\n     if       Cob-CRT-Status = Cob-Scr-Esc\n              go to ga990-Quit.\n     accept   WS-BO-State at 0471 with foreground-color 3 UPPER update.\n     if       not WS-BO-Valid-State\n              display  \"Invalid State not Y or N\" at line WS-23-Lines col 1\n                                   with foreground-color 4 highlight beep erase eol\n              go to ga020-Customer-Accept\n     end-if\n     display  \" \" at line WS-23-Lines col 1 with erase eos  *> clear any err/warn msgs\n*>\n     move     Customer-In to WS-Sales-Key.  *> In sales key in rec\n*>\n ga100-Process.\n     move     FUNCTION STORED-CHAR-LENGTH (Customer-In) to B.\n     if       B > 7       *> JIC\n              stop     \"Error in function STORED-CHAR-LENGTH\"\n              go to    ga990-Quit.\n     if       B < 7   *> group range select\n              go to    ga110-Process-Block-Selections\n     else                    *> doing just one\n              perform  Sales-Read-Indexed\n              if       FS-reply not = zeros\n                       display SL111 at line WS-23-Lines col 1 with foreground-color 4\n                                                               highlight beep erase eol\n                       move spaces to  Customer-In\n                       go to  ga010-Customer-Input\n              end-if\n              move     WS-BO-State to Sales-Partial-Ship-Flag\n              perform  Sales-Rewrite\n    end-if.\n    go        to ga020-Customer-Accept.\n*>\n ga110-Process-Block-Selections.  *> being performed\n*>\n*> Customer-IN is less than 7 so do all of same first chars present\n*>\n     if       Customer-IN not = spaces\n              set      fn-not-less-than to true\n              perform  Sales-Start\n              if       fs-reply not = zero\n                       display  \"No records match criteria\" at line WS-23-Lines col 1\n                                    with foreground-color 4 highlight beep erase eol\n                       go to    ga020-Customer-Accept\n              else\n                       display  \" \" at line WS-23-Lines col 1 erase eol\n              end-if\n              perform  until exit\n                       perform  Sales-Read-Next\n                       if       FS-Reply not = zeros\n                                display \" EoF - Requested Process Completed\" at line WS-23-Lines col 1\n                                                        with foreground-color 2 beep erase eol\n                                exit perform\n                       end-if\n                       if       WS-Sales-Key (1:B) not = Customer-In (1:B)\n                                display \" Requested Selection Range Process Completed\" at line WS-23-Lines col 1\n                                                        with foreground-color 2 beep erase eol\n                                exit perform\n                       end-if\n                       move     WS-BO-State to Sales-Partial-Ship-Flag\n                       perform  Sales-Rewrite\n                       exit     perform cycle\n              end-perform\n     else   *> we do all of them\n              perform  until exit\n                       perform  Sales-Read-Next\n                       if       FS-Reply not = zeros\n                                display \" Requested process completed\" at line WS-23-Lines col 1\n                                                        with foreground-color 2 beep erase eol\n                                exit perform\n                       end-if\n                       move     WS-BO-State to Sales-Partial-Ship-Flag\n                       perform  Sales-Rewrite\n                       exit     perform cycle\n              end-perform\n     end-if\n     go to    ga020-Customer-Accept.\n*>\n ga990-Quit.\n     display  \" \" at 0401 with erase eos.\n     perform  Sales-Close.\n*>\n Main-Exit.   exit section.\n*>\n\n fa000-Display-Customers section.\n*>==============================\n*>\n     perform  Delivery-Open-Input.\n     perform  Sales-Open.\n*>\n customer-input.\n*>*************\n*>\n     perform  Display-Outline.\n*>\n customer-accept.\n*>\n     perform  Accept-Key.\n*>\n     if       error-code = 999\n              go to  main-end.\n*>\n     if       customer-code = spaces\n              go to  customer-accept.\n*>\n     perform  customer-display.\n*>\n accept-of-show.\n*>*************\n*>\n     move     \"S\" to escape-code.\n     perform  test-escape.\n*>\n*> TEST CODE ONLY\n*>\n     if       Escape-Code = \"T\"\n              move     20 to lin\n              move     17 to cole\n              move     Sales-Unapplied to amt-ok9\n              perform  zz030-accept-money9c\n              move     amt-ok9 to Sales-Unapplied\n              move     21 to lin\n              move     17 to cole\n              move     Sales-Current to amt-ok9\n              perform  zz030-accept-money9c\n              move     amt-ok9 to Sales-Current\n              perform Sales-Rewrite\n     end-if\n*>\n     if       Escape-Code not = \"Q\"\n              go to  customer-input.\n*>\n main-end.\n*>*******\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-selection        section.\n*>==============================\n*>\n     perform  Sales-Open-Input.\n     perform  Delivery-Open-Input.\n*>\n     move     spaces to cust-in status-in credit-op invoice-op\n                        average-op overdue-op enter-date-op\n                        enter-date-in print-out.\n*>\n     move     zero to credit-in invoice-in average-in overdue-in ws-enter-date.\n     display  display-03.\n*>\n accept-data.\n*>**********\n*>\n     accept   display-03.\n     move     FUNCTION UPPER-CASE (cust-in) to cust-in.\n     move     cust-in to customer-in.\n     move     FUNCTION UPPER-CASE (status-in) to status-in.\n     if       status-in not = \"L\" and not = \"D\" AND not = space\n              go to  accept-data.\n*>\n     move     FUNCTION UPPER-CASE (credit-op) to credit-op.\n     if       credit-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     FUNCTION UPPER-CASE (invoice-op) to invoice-op.\n     if       invoice-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     FUNCTION UPPER-CASE (average-op) to average-op.\n     if       average-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     FUNCTION UPPER-CASE (overdue-op) to overdue-op.\n     if       overdue-op not = \"L\" and not = \"G\" and not = \"E\" and not = space\n              go to  accept-data.\n*>\n     move     FUNCTION UPPER-CASE (enter-date-op)   to enter-date-op.\n     if       enter-date-op not = \"L\" and not = \"G\" AND not = \"E\" and not = space\n              go to  accept-data.\n*>\n     if       enter-date-in = spaces\n              go to main-end.\n     move     zero to u-bin.\n     move     enter-date-in to ws-test-date.  *> was u-date\n     perform  zz050-Validate-Date.\n     if       u-bin = zero\n              display SL005 at 2362 with foreground-color 4\n              go to accept-data.\n     display  \" \" at 2362 with erase eol.\n     move     u-bin to ws-enter-date.\n*>     move     u-date to enter-date-in.     *> not sure about this, means that say intl date is now uk????\n*>\n main-end.    exit section.\n*>*******     *****\n*>\n produce-report          section.\n*>==============================\n*>\n     open     output  print-file.\n     move     zero to a.\n     perform  headings.\n*>\n     if       Customer-In = spaces\n              go to read-loop.\n     move     Customer-In to WS-Sales-Key.\n     set      fn-not-less-than to true.\n     perform  Sales-Start.\n     if       fs-reply = 21\n              move 1 to a.\n     inspect  Customer-In replacing all space by \"Z\".\n*>\n read-loop.\n*>********\n*>\n     perform  Sales-Read-Next.\n     if       fs-reply = 10\n              go to  end-report.\n     if       fs-reply not = zero\n              go to end-report.\n*>\n     if       status-in = \"L\"\n       and    customer-dead\n              go to  read-loop.\n     if       status-in = \"D\"\n       and    customer-live\n              go to  read-loop.\n*>\n     if       Customer-In not = spaces\n        and   WS-Sales-Key > customer-in\n              go to end-report.\n*>\n     if       credit-op not = space\n              move  credit-in     to  test-1\n              move  sales-credit  to  test-2\n              move  credit-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       invoice-op not = space\n              move  invoice-in     to  test-1\n              move  sales-activety to  test-2\n              move  invoice-op     to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       average-op not = space\n              move  average-in    to  test-1\n              move  sales-average to  test-2\n              move  average-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if       overdue-op not = space\n        and   sales-current  > 0.00\n              move  overdue-in    to  test-1\n              subtract sales-last-inv from run-date giving test-2\n              move  overdue-op    to  test-op\n              perform  test-num\n              if    a-false\n                    go to  read-loop.\n*>\n     if   enter-date-op not = space\n          move  ws-enter-date     to  test-1\n          move  sales-create-date to  test-2\n          move  enter-date-op     to  test-op\n          perform  test-num\n          if    a-false\n                go to  read-loop.\n*>\n     perform  listing.\n     go       to read-loop.\n*>\n test-num.\n*>*******\n*>\n     if       test-op  = space\n              move  1  to  truth\n     else\n              move  0  to  truth.\n*>\n     if       test-op = \"L\"\n       and    test-2  <  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"G\"\n       and    test-2  >  test-1\n              move  1  to  truth.\n*>\n     if       test-op = \"E\"\n       and    test-2  =  test-1\n              move  1  to  truth.\n*>\n headings.\n*>*******\n*>\n     add      1  to  a.\n     move     a  to  l1-page.\n     if       a not = 1\n              write print-record  from  line-1 after page\n              write print-record  from  line-3 after 1\n              move  spaces  to  print-record\n              write print-record after 1\n     else\n              write print-record  from  line-1 before 1\n              write print-record  from  line-3 before 1\n     end-if\n     write    print-record  from  line-4 after 1.\n     write    print-record  from  line-5 after 1.\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     move     6 to line-cnt.\n*>\n Listing.\n*>******\n*>\n     if       line-cnt > Page-Lines\n              perform  headings.\n     move     WS-Sales-Key  to  l6-key.\n*>\n     if       customer-live\n              move  \"Active\"  to  l6-status\n     else\n              move  \"Dormant\" to  l6-status.\n*>\n     move     spaces         to  l6-phone.\n     move     sales-name     to  l6-name.\n     move     sales-address  to  l7-address.\n     inspect  l7-address  replacing  all  sl-delim  by  \",\".\n     if       sales-ext = spaces\n              move sales-phone to l6-phone\n     else\n              move 1 to y\n              string sales-phone delimited by \"  \"\n                            into l6-phone with pointer y\n              subtract 1 from y\n              string \"x\"       delimited by size\n                     sales-ext delimited by size\n                            into l6-phone with pointer y.\n*>\n     move     sales-fax to l6-fax.\n     move     Sales-Partial-Ship-Flag to L6-BO.\n*>\n     if       late-charges\n              move  \"Y\"     to  l6-charges\n     else\n              move  spaces  to  l6-charges.\n*>\n     if       dunning-letters\n              move  \"Y\"     to  l6-letter\n     else\n              move  spaces  to  l6-letter.\n*>\n     move     sales-limit   to  l6-limit.\n     move     sales-credit  to  l6-credit.\n     move     sales-discount to l6-discount.\n*>\n     if       line-cnt > Page-Lines - 5\n              perform headings.\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n*>\n     if       delivery-tag  >  zero\n              perform  delivery-print.\n     if       Notes-Tag > zero\n              perform  notes-print.\n*>\n     move     spaces  to  print-record.\n     write    print-record after 1.\n     add      3 to line-cnt.\n     move     \"Y\" to Print-Out.\n*>\n delivery-print.\n*>*************\n*>\n     move     \"D\"       to WS-Deliv-Key-Type.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     perform  Delivery-Read-Indexed.\n     if       fs-reply not = zero\n              move \"Record Not Found\" to deliv-name.\n*>\n     move     \"   Deliver\"   to  l6-key.\n     move     \"y Address\"    to  l6-status.\n     move     deliv-name     to  l6-name.\n     move     deliv-address  to  l7-address.\n     if       Deliv-Name not = \"Record Not Found\"\n              inspect  l7-address  replacing  all  sl-delim  by  \",\".\n*>\n     move     spaces  to  l6-phone  l6-fax\n                          l6-charges\n                          l6-letter.\n     move     zero    to  l6-limit\n                          l6-credit\n                          l6-discount.\n*>\n     write    print-record  from  line-6 after 1.\n     write    print-record  from  line-7 after 1.\n     add      2 to line-cnt.\n*>\n notes-print.\n     move     \"N\"       to WS-Deliv-Key-Type.\n     move     WS-Sales-Key to WS-Deliv-Sales-Key.\n     perform  Delivery-Read-Indexed,\n     if       fs-reply not = zero\n              move \"Record Not Found\" to deliv-Address.\n*>\n     move     spaces to l7-address.\n     string   \"Notes: \" delimited by size\n              deliv-address delimited by \"  \" into l7-address.\n     write    print-record from line-7 after 1.\n     add      1 to line-cnt.\n*>\n end-report.\n*>*********\n*>\n main-end.\n*>*******\n*>\n     close    print-file.\n     if       Print-Out = \"Y\"\n              call \"SYSTEM\" using Print-Report.\n*>\n main-exit.   exit section.\n*>********    ****\n*>\n report-heading-setup    section.\n*>==============================\n*>\n     perform  zz070-convert-date.\n     move     ws-date to l3-date.\n     move     usera  to  l3-user.\n     add      1      to  y.\n     move     spaces to  l3-report.\n*>\n     if       status-in = spaces  and  credit-op\n         and  invoice-op   and  average-op\n         and  overdue-op   and  customer-in\n              string  \"All\"  delimited by size\n                          into  l3-report with  pointer  y\n     else\n              string  \"Matched\"  delimited by size\n                          into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       status-in = \"L\"\n              string  \"Live\"     delimited by size\n                          into  l3-report with  pointer  y.\n     if       status-in = \"D\"\n              string  \"Dormant\"  delimited by size\n                          into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       credit-op = \"L\"\n              move    \"< \"  to  cr-operand.\n     if       credit-op = \"G\"\n              move    \"> \"  to  cr-operand.\n     if       credit-op = \"E\"\n              move    \"= \"  to  cr-operand.\n*>\n     if       credit-op  not = space\n              move  credit-in  to  cr-days\n              string  credit-heading  delimited by size\n                              into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       invoice-op = \"L\"\n              move    \"< \"  to  act-operand.\n     if       invoice-op = \"G\"\n              move    \"> \"  to  act-operand.\n     if       invoice-op = \"E\"\n              move    \"= \"  to  act-operand.\n*>\n     if       invoice-op  not = space\n              move  invoice-in  to  act-days\n              string  active-heading  delimited by size\n                               into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       average-op = \"L\"\n              move    \"< \"  to  av-operand.\n     if       average-op = \"G\"\n              move    \"> \"  to  av-operand.\n     if       average-op = \"E\"\n              move    \"= \"  to  av-operand.\n*>\n     if       average-op  not = space\n              move  average-in  to  av-days\n              string  average-heading  delimited by size\n                              into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       overdue-op = \"L\"\n              move    \"< \"  to  ov-operand.\n     if       overdue-op = \"G\"\n              move    \"> \"  to  ov-operand.\n     if       overdue-op = \"E\"\n              move    \"= \"  to  ov-operand.\n*>\n     if       overdue-op  not = space\n              move  overdue-in  to  ov-days\n              string  overdue-heading  delimited by size\n                              into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       enter-date-op = \"L\"\n              move    \"< \"  to  ed-operand.\n     if       enter-date-op = \"G\"\n              move    \"> \"  to  ed-operand.\n     if       enter-date-op = \"E\"\n              move    \"= \"  to  ed-operand.\n*>\n     if       enter-date-op  not = space\n              move  enter-date-in  to  ed-date\n              string  enter-date-heading  delimited by size\n                             into  l3-report with  pointer  y.\n*>\n     add      1  to  y.\n*>\n     if       Customer-In  not = spaces\n              string  \" Keys Matching - \" delimited by size\n                      Customer-In         delimited by size\n                             into  l3-report with  pointer  y.\n*>\n main-exit.   exit section.\n*>********    *****\n*>\n slcreate     section.\n*>===================\n*>\n SLcreate-Main.\n     perform  display-heading.\n     display  SL103  at 1201 with foreground-color 4.\n     display  SL104  at 1301 with foreground-color 2.\n     move     space to ws-reply.\n     accept   ws-reply at 1343 with foreground-color 6 update UPPER.\n     if       ws-reply = \"N\"\n              exit program.\n     if       ws-reply not = \"Y\"\n              go to slcreate-Main.\n*>\n     display  SL105  at 1506 with foreground-color 2.\n     perform  Sales-Open-Output.\n     if       fs-reply not = zero\n              display SL106    at 1201 with erase eol\n              display fs-reply at 1234\n              display SL004    at 1237\n              accept  ws-reply at 1258\n              perform Sales-Close   *> close sales-file\n              go to main-exit.\n     perform  Delivery-Open-Output.\n     if       fs-reply not = zero\n              display SL107    at 1201 with erase eol\n              display fs-reply at 1237\n              display SL004    at 1240\n              accept  ws-reply at 1261\n              perform Delivery-Close\n              go to main-exit.\n*>\n     perform  Sales-Close.\n     perform  Delivery-Close.\n     move     \"Y\" to sales-ledger.\n*>\n main-exit.   exit section.\n*>\n*>\n zz030-common-routines      section.\n*>*********************************\n*>\n zz030-accept-money9c.\n     move     amt-wk-pence9 to ws-pence9.\n     move     amt-wk-pds9 to ws-pound9.\n     display  ws-amount-screen-display9 at curs with foreground-color 3.\n     accept   ws-amount-screen-accept9  at curs with foreground-color 3 update.\n     move     ws-pound9 to amt-wk-pds9.\n     move     ws-pence9 to amt-wk-pence9.\n*>\n zz030-exit.\n     exit     section.\n*>\n zz050-Validate-Date        section.\n*>*********************************\n*>\n*>  Converts USA/Intl to UK date format for processing.\n*>*******************************\n*> Input:   ws-test-date\n*> output:  u-date/ws-date as uk date format\n*>          u-bin not zero if valid date\n*>\n     inspect  ws-test-date replacing all \".\" by \"/\".\n     inspect  ws-test-date replacing all \",\" by \"/\".\n     inspect  ws-test-date replacing all \"-\" by \"/\".\n*>\n     move     ws-test-date to ws-date.\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz050-test-date.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz050-test-date.\n*>\n*> So its International date format\n*>\n     move     \"dd/mm/ccyy\" to ws-date.  *> swap Intl to UK form\n     move     ws-test-date (1:4) to ws-Year.\n     move     ws-test-date (6:2) to ws-Month.\n     move     ws-test-date (9:2) to ws-Days.\n*>\n zz050-test-date.\n     move     ws-date to u-date.\n     move     zero to u-bin.\n     perform  maps03.\n*>\n zz050-exit.\n     exit     section.\n*>\n zz060-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in binary to UK/USA/Intl date format\n*>****************************************************\n*> Input:   u-bin\n*> output:  ws-date as uk/US/Inlt date format\n*>          u-date & ws-Date = spaces if invalid date\n*>\n     perform  maps03.\n     if       u-date = spaces\n              move spaces to ws-Date\n              go to zz060-Exit.\n     move     u-date to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz060-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz060-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     u-date (7:4) to ws-Intl-Year.\n     move     u-date (4:2) to ws-Intl-Month.\n     move     u-date (1:2) to ws-Intl-Days.\n*>\n zz060-Exit.\n     exit     section.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.\n*>\n copy \"Proc-ACAS-FH-Calls.cob\".\n*>",
        "line": 74
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 5,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 182,
      "totalOperators": 174,
      "totalOperands": 348,
      "vocabulary": 183,
      "length": 522,
      "volume": 3923.1953155842702
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
