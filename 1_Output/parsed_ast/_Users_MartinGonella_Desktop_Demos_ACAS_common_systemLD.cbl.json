{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/common/systemLD.cbl",
  "fileName": "systemLD.cbl",
  "timestamp": "2025-09-15T16:25:34.103Z",
  "programId": "SystemLD",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 124
      },
      {
        "name": "file",
        "line": 135
      },
      {
        "name": "working-storage",
        "line": 139
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 127
      },
      {
        "name": "aa000-main-start",
        "line": 211
      },
      {
        "name": "goback",
        "line": 228
      },
      {
        "name": "goback",
        "line": 238
      },
      {
        "name": "goback",
        "line": 294
      },
      {
        "name": "aa010-Proc-Override",
        "line": 296
      },
      {
        "name": "WS-System-Record",
        "line": 329
      },
      {
        "name": "acas000-Open",
        "line": 331
      },
      {
        "name": "acas000-Close",
        "line": 337
      },
      {
        "name": "acas000-Write",
        "line": 341
      },
      {
        "name": "acas000-ReWrite",
        "line": 345
      },
      {
        "name": "aa010-Read",
        "line": 352
      },
      {
        "name": "FA-File-System-Used",
        "line": 357
      },
      {
        "name": "aa020-Rollback",
        "line": 408
      },
      {
        "name": "aa030-Commit",
        "line": 422
      },
      {
        "name": "aa100-Check-4-Errors",
        "line": 432
      },
      {
        "name": "end-if",
        "line": 449
      },
      {
        "name": "aa999-Finish",
        "line": 451
      },
      {
        "name": "FA-File-System-Used",
        "line": 461
      },
      {
        "name": "goback",
        "line": 473
      },
      {
        "name": "Call-Sysout",
        "line": 477
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "acas-get-params",
        "line": 247,
        "type": "DYNAMIC",
        "using": [
          "WS-RDB-Return",
          "WS-RDB-Vars",
          "if",
          "WS-RDB-Return",
          "=",
          "8",
          "display",
          "\"acas"
        ]
      },
      {
        "target": "acas000",
        "line": 324,
        "type": "DYNAMIC",
        "using": [
          "*>",
          "File-Defs",
          "call",
          "\"systemMT\"",
          "using",
          "File-Access",
          "ACAS-DAL-Common-data",
          "WS-System-Record"
        ]
      },
      {
        "target": "MySQL_rollback",
        "line": 416,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "MySQL_commit",
        "line": 426,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "ACAS-Sysout",
        "line": 478,
        "type": "DYNAMIC",
        "using": [
          "SO-Print"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 113,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 123,
        "replacing": null
      },
      {
        "name": "selsys",
        "line": 130,
        "replacing": null
      },
      {
        "name": "fdsys",
        "line": 138,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 174,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 176,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 187,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 188,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 189,
        "replacing": null
      },
      {
        "name": "Proc-Get-Env-Set-Files",
        "line": 475,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz020-Get-Program-Args",
        "thru": null,
        "line": 212
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 214
      },
      {
        "target": "acas000-Open",
        "thru": null,
        "line": 320
      },
      {
        "target": "acas000",
        "thru": null,
        "line": 334
      },
      {
        "target": "aa100-Check-4-Errors",
        "thru": null,
        "line": 335
      },
      {
        "target": "acas000",
        "thru": null,
        "line": 339
      },
      {
        "target": "acas000",
        "thru": null,
        "line": 343
      },
      {
        "target": "acas000",
        "thru": null,
        "line": 347
      },
      {
        "target": "acas000-Write",
        "thru": null,
        "line": 360
      },
      {
        "target": "acas000-ReWrite",
        "thru": null,
        "line": 368
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 372
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 375
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 378
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 380
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 382
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 392
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 395
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 398
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 400
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 402
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 435
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 438
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 441
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 443
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 445
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 447
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 456
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 459
      },
      {
        "target": "acas000-Close",
        "thru": null,
        "line": 467
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 470
      },
      {
        "target": "Call-Sysout",
        "thru": null,
        "line": 472
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zeros",
        "to": "FS-Reply WE-Error\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices",
        "line": 80
      },
      {
        "from": "Prog-Name",
        "to": "So-Print",
        "line": 213
      },
      {
        "from": "0",
        "to": "WS-Log-System",
        "line": 215
      },
      {
        "from": "20",
        "to": "WS-Log-File-no",
        "line": 216
      },
      {
        "from": "128",
        "to": "return-code\n              goback",
        "line": 227
      },
      {
        "from": "1",
        "to": "rrn",
        "line": 229
      },
      {
        "from": "128",
        "to": "return-code\n              goback",
        "line": 237
      },
      {
        "from": "WS-Host-Name",
        "to": "RDBMS-Host\n                       move     WS-Implementation to RDBMS-User\n                       move     WS-Password       to RDBMS-Passwd\n                       move     WS-Base-Name      to RDBMS-DB-Name\n                       move     WS-Port-Number    to RDBMS-Port\n                       move     WS-Socket         to RDBMS-Socket\n              display \"DBName = \" RDBMS-DB-Name\n              display \"User = \"   RDBMS-User\n              display \"Port = \"   RDBMS-Port\n              display \"Host = \"   RDBMS-Host\n              display \"Socket = \" RDBMS-Socket\n                       go to aa010-Proc-Override",
        "line": 266
      },
      {
        "from": "64",
        "to": "Return-Code\n              goback",
        "line": 293
      },
      {
        "from": "RDBMS-DB-Name",
        "to": "DB-Schema",
        "line": 298
      },
      {
        "from": "RDBMS-User",
        "to": "DB-UName",
        "line": 299
      },
      {
        "from": "RDBMS-Passwd",
        "to": "DB-UPass",
        "line": 300
      },
      {
        "from": "RDBMS-Port",
        "to": "DB-Port",
        "line": 301
      },
      {
        "from": "RDBMS-Host",
        "to": "DB-Host",
        "line": 302
      },
      {
        "from": "RDBMS-Socket",
        "to": "DB-Socket",
        "line": 303
      },
      {
        "from": "zero",
        "to": "File-System-Used\n                      File-Duplicates-In-Use\n                      FA-File-System-Used\n                      FA-File-Duplicates-In-Use",
        "line": 307
      },
      {
        "from": "zero",
        "to": "Log-file-rec-written",
        "line": 311
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 315
      },
      {
        "from": "1",
        "to": "File-System-Used\n                   FA-File-System-Used",
        "line": 316
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 319
      },
      {
        "from": "System-Record",
        "to": "WS-System-Record",
        "line": 353
      },
      {
        "from": "1",
        "to": "File-System-Used           *> acas0nn set to process RDB\n                   FA-File-System-Used",
        "line": 356
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 359
      },
      {
        "from": "zeros",
        "to": "FS-Reply\n                               WE-Error\n              perform acas000-ReWrite\n              if  FS-Reply not = zero\n                  move spaces to SO-Print\n                  string SY014 FS-Reply into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"WE-Error = \" WE-Error into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string SY018 SQL-Err into SO-Print\n                  perform Call-Sysout\n                  move SQL-Msg to SO-Print\n                  perform Call-Sysout\n                  move SQL-State to SO-Print\n                  perform Call-Sysout\n                  go to aa999-Finish\n              end-if\n              add 1 to ws-Rec-Cnt-R-Out\n              go to aa999-Finish\n     end-if\n*>\n     if       fs-reply not = zero              *> Anything else\n              move spaces to SO-Print\n              string SY015 FS-Reply into SO-Print\n              perform Call-Sysout\n              move spaces to SO-Print\n              string \"WE-Error = \" WE-Error into SO-Print\n              perform Call-Sysout\n              move spaces to SO-Print\n              string SY018 SQL-Err into SO-Print\n              perform Call-Sysout\n              move SQL-Msg to SO-Print\n              perform Call-Sysout\n              move SQL-State to SO-Print\n              perform Call-Sysout\n              go to aa999-Finish\n     end-if\n     add      1 to ws-Rec-Cnt-Out",
        "line": 366
      },
      {
        "from": "SY011",
        "to": "SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"FS-Reply = \" FS-Reply into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"WE-Error = \" WE-Error into SO-Print\n                  perform Call-Sysout\n                  move SQL-Err to SO-Print\n                  perform Call-Sysout\n                  move SQL-Msg to SO-Print\n                  perform Call-Sysout\n                  move SQL-State to SO-Print\n                  perform Call-Sysout\n              go to aa999-Finish\n     end-if",
        "line": 434
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 452
      },
      {
        "from": "spaces",
        "to": "SO-Print",
        "line": 457
      },
      {
        "from": "1",
        "to": "File-System-Used\n                   FA-File-System-Used",
        "line": 460
      },
      {
        "from": "\"66\"",
        "to": "FA-RDBMS-Flat-Statuses",
        "line": 463
      },
      {
        "from": "zero",
        "to": "Access-Type",
        "line": 465
      },
      {
        "from": "2",
        "to": "File-Function",
        "line": 466
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "system.dat does not hold RDBMS params we check if\n*>                       file acas.param exists and if so takes details from that.\n*>                       JIC not testing for RDB but it exists etc - saves having\n*>                       to change system.dat record just for loading DB's.\n*>**\n*>   Version.            See prog-name in Ws.\n*>**\n*>   Called Modules.     acas-get-params  ( WS-RDB-Return, WS-RDB-Vars )\n*>                       acas000    } For file and table access.\n*>                       systemMT   }\n*>                       ACAS-Sysout\n*>                       fhlogger\n*>    Note file FH NOT called.\n*>**\n*>   Error messages used.\n*>                       SY001.\n*>                       SY004.\n*>                       SY006.\n*>                       SY007.\n*>                       SY008.\n*>                       SY009.\n*>                       SY010.\n*>                       SY011.\n*>                       SY014.\n*>                       SY015\n*>                       SY018.\n*>                       SY019.\n*>                       SY099.\n*>**\n*>   Changes.\n*> 27/08/16 vbc - .06 Source taken from stockLD.\n*> 16/09/16 vbc   .07 Changess for this module that calls systemMT directly\n*>                    having set up the DB- fields as acas000 not called.\n*> 23/09/16 vbc - .08 Cosmetic : Extra Displays for force update.\n*>                    Removed logging.\n*> 24/10/16 vbc - .   ALL programs now using wsnames.cob in copybooks\n*> 03/01/17 vbc - .09 Clean up displays & msgs.\n*> 21/03/18 vbc - .10 Added WS-Calling-Data used in zz020 but not in Loader progs.\n*> 17/05/19 vbc - .11 Support for program to be called via script & test for rdb.\n*> 07/06/19 vbc - .12 Include test for 99 on write for non tested other error types.\n*> 08/06/19 vbc - .13 Changed displays to go to module ACAS-Sysout as using display\n*>                    create Escape sequences that looks messy and impossible to\n*>                    read using 'less ' or even 'cat.\n*> 21/06/23 vbc - .14 See UPDATE note in Remarks regarding acas.param,\n*>                    call to new module, acas-get-params that reads file\n*>                    acas.params\n*>\n*>                    adding WS blocks: WS-RDB-Return, WS-RDB-Vars\n*>                    PD: after reading system file.\n*> 09/07/23 vbc - .15 Chg SO-Print to 160 from 80 & replaced displays with SO-Print.\n*>                    in test Sql-State = \"2300\" added  move zeros to FS-Reply WE-Error\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>**\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n*>\n environment division.\n*>-------------------\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n file-control.\n*>-----------\n*>\n copy \"selsys.cob\".\n*>\n data division.\n*>------------\n*>\n file section.\n*>-----------\n*>\n copy \"fdsys.cob\".\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(18)    value \"SystemLD (3.02.15)\".\n 77  z                   binary-char  value zero.\n 77  OS-Delimiter        pic x        value \"/\".\n 77  ACAS_BIN            pic x(512)   value spaces.\n 77  ACAS_LEDGERS        pic x(500)   value spaces.\n 77  Arg-Number          pic 9        value zero.\n*>\n*> holds program parameter values from command line\n 01  Arg-Vals                         value spaces.\n     03  Arg-Value       pic x(525)  occurs 2.\n 01  Arg-Test            pic x(525)   value spaces.\n*>\n 01  work-fields.\n     03  ws-Rec-Cnt-In   pic 9(4)     value zero.\n     03  ws-Rec-Cnt-Out  pic 9(4)     value zero.\n     03  ws-Rec-Cnt-R-Out pic 9(6)    value zero.\n     03  ws-reply        pic x.\n*>\n 01  SO-Print            pic x(160)    value spaces.\n*>\n*> For getting acas.param file data\n*>\n 01  WS-RDB-Return       pic 99       value zeros.\n 01  WS-RDB-Vars                      value spaces.\n     03  WS-Host-Name    pic x(64).\n     03  WS-Implementation\n                         pic x(64).\n     03  WS-Password     pic x(64).\n     03  WS-Base-Name    pic x(64).\n     03  WS-Port-Number  pic x(4).\n     03  WS-Socket       pic x(64).\n*>\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n copy \"wssystem.cob\" replacing System-Record by WS-System-Record\n                               File-System-Used by WS-File-System-Used\n                               File-Duplicates-In-Use by WS-File-Duplicates-In-Use\n                               FS-Cobol-Files-Used by WS-FS-Cobol-Files-Used\n                               FS-Duplicate-Processing by WS-FS-Duplicate-Processing\n                               RDBMS-DB-Name by WS-RDBMS-DB-Name\n                               RDBMS-User    by WS-RDBMS-User\n                               RDBMS-Passwd  by WS-RDBMS-Passwd\n                               RDBMS-Port    by WS-RDBMS-Port\n                               RDBMS-Host    by WS-RDBMS-Host\n                               RDBMS-Socket  by WS-RDBMS-Socket.\n copy \"wsfnctn.cob\".\n copy \"wsnames.cob\".\n copy \"wscall.cob\".\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY001          pic x(26) value \"SY001 System 1 read err = \".\n     03  SY004          pic x(59) value \"SY004 Problem with opening system file. Hit return to clear\".\n     03  SY006          pic x(62) value \"SY006 Program Arguments limited to two and you have specified \".\n     03  SY007          pic x(35) value \"SY007 Program arguments incorrect: \".\n     03  SY008          pic x(31) value \"SY008 Note message & Hit return\".\n     03  SY009          pic x(53) value \"SY009 Environment variables not yet set up : ABORTING\".\n*> Program specific\n     03  SY010          pic x(30) value \"SY010 Duplicate key/s found = \".\n     03  SY011          pic x(34) value \"SY011 Error on SystemMT processing\".\n     03  SY014          pic x(31) value \"SY014 Error on writing table = \".\n     03  SY015          pic x(33) value \"SY015 Error on Rewriting table = \".\n     03  SY018          pic x(22) value \"SY018 RDBMS details : \".\n     03  SY019          pic x(38) value \"SY019 DB is not set up in Param file :\".\n     03  SY099          pic x(15) value \"SY099 Ignoring.\".\n*>\n procedure division.\n*>=================\n*>\n aa000-main-start.\n     perform  zz020-Get-Program-Args.\n     move     Prog-Name to So-Print.\n     perform  Call-Sysout.\n     move     0      to WS-Log-System.   *> 1 = IRS, 2=GL, 3=SL, 4=PL, 5=Stock used in FH logging\n     move     20     to WS-Log-File-no.  *> for FHlogger\n*>\n*>  Get the system param for the various RDB fields\n*>\n     open     input System-File.\n     if       fs-reply not = zero\n              display Prog-Name at 0101 with erase eos\n              display SY001     at 0401\n              display fs-reply  at 0428\n              display SY004     at 0501\n              close System-File\n              move 128 to return-code\n              goback.\n     move     1 to rrn.\n     read     system-file record.\n     if       fs-reply not = zero\n              display Prog-Name at 0101 with erase eos\n              display SY001           at 0401\n              display fs-reply        at 0428\n              display \"Not set up ?\"  at 0431\n              close System-File\n              move 128 to return-code\n              goback.\n*>\n*>  Load up the DB settings from the system record as its not passed on.\n*>\n     if       RDBMS-DB-Name = spaces\n         or   FS-Cobol-Files-Used\n              display Prog-Name          *>  at 0101 with erase eos\n              display SY019\n              display \"Cobol files in use ONLY\"\n              call     \"acas-get-params\" using WS-RDB-Return\n                                               WS-RDB-Vars\n              if       WS-RDB-Return = 8\n                       display \"acas.param file NOT found - Aborted\"\n                       close  System-File\n                       goback\n              end-if\n              if       WS-RDB-Return = 1\n                       display \"Invalid keyword terminator found - Aborted\"\n                       close  System-File\n                       goback\n              end-if\n              if       WS-RDB-Return = 2\n                       display \"Invalid keyword found - Aborted\"\n                       close  System-File\n                       goback\n              end-if\n              if       WS-RDB-Return = zeros\n                       display \"acas-param file found and being used \"\n                       move     WS-Host-Name      to RDBMS-Host\n                       move     WS-Implementation to RDBMS-User\n                       move     WS-Password       to RDBMS-Passwd\n                       move     WS-Base-Name      to RDBMS-DB-Name\n                       move     WS-Port-Number    to RDBMS-Port\n                       move     WS-Socket         to RDBMS-Socket\n              display \"DBName = \" RDBMS-DB-Name\n              display \"User = \"   RDBMS-User\n              display \"Port = \"   RDBMS-Port\n              display \"Host = \"   RDBMS-Host\n              display \"Socket = \" RDBMS-Socket\n                       go to aa010-Proc-Override.\n*>\n     if       RDBMS-DB-Name = spaces\n         or   FS-Cobol-Files-Used\n              display Prog-Name at 0101 with erase eos\n              display SY019\n              if  FS-Cobol-Files-Used\n                  display \"Cobol files in use ONLY\"\n              end-if\n              display \"DBName = \" RDBMS-DB-Name\n              display \"User = \"   RDBMS-User\n              display \"Port = \"   RDBMS-Port\n              display \"Host = \"   RDBMS-Host\n              display \"Socket = \" RDBMS-Socket\n              stop \"SY008 Note message & Hit return\"\n              close System-File\n              move 64 to Return-Code\n              goback.\n*>\n aa010-Proc-Override.\n*>\n     move     RDBMS-DB-Name to DB-Schema.\n     move     RDBMS-User    to DB-UName.\n     move     RDBMS-Passwd  to DB-UPass.\n     move     RDBMS-Port    to DB-Port.\n     move     RDBMS-Host    to DB-Host.\n     move     RDBMS-Socket  to DB-Socket.\n*>\n*>  Over-ride processes for acas000/SystemMT for Dup modes\n*>\n     move     zero to File-System-Used\n                      File-Duplicates-In-Use\n                      FA-File-System-Used\n                      FA-File-Duplicates-In-Use.   *>  Cobol file in use\n     move     zero to Log-file-rec-written.        *> for logging.\n*>\n*>  As we are working on the system file can clear out stuff processing secondary file\n*>\n     move     1 to File-Key-No.\n     move     1 to File-System-Used\n                   FA-File-System-Used.            *> RDB in use\n *> ----\n     move     \"66\" to FA-RDBMS-Flat-Statuses.      *> Force RDB processing with acas000.\n     perform  acas000-Open.                        *> Open/Init RDB via FH - systemMT\n     go       to aa010-Read.                       *> and NOT acas000\n*>\n acas000.    *> Uses systemMT DAL and NOT the F.H.\n*>     call     \"acas000\" using\n*>                              File-Defs\n     call     \"systemMT\" using\n                                File-Access\n                                ACAS-DAL-Common-data\n                                WS-System-Record.\n*>\n acas000-Open.\n     set      fn-open to true.\n     set      fn-i-o  to true.\n     perform  acas000.\n     perform  aa100-Check-4-Errors.\n*>\n acas000-Close.\n     set      fn-Close to true.\n     perform  acas000.\n*>\n acas000-Write.\n     set      fn-Write to true.\n     perform  acas000.\n*>\n acas000-ReWrite.\n     set      fn-re-write to true.\n     perform  acas000.\n*>\n*>  We will Rollback on any errors but Mysql has to be set up to do it\n*>      otherwise as normally it is set to autocommit !!!!!\n*>\n aa010-Read.\n     move     System-Record to WS-System-Record.   *> They are the same layout.\n     add      1 to ws-Rec-Cnt-In.\n*>\n     move     1 to File-System-Used           *> acas0nn set to process RDB\n                   FA-File-System-Used.\n *> ----\n     move  \"66\" to FA-RDBMS-Flat-Statuses.     *> Force RDB processing with acas000.\n     perform  acas000-Write.                   *> uses direct call to systemMT.\n*>\n     if       Sql-State = \"23000\"  *> Dup key (rec already present)\n          or  fs-reply = 22 or = \"99\"                   *> Check for dup key/record\n         or   SQL-Err (1:4) = \"1062\"\n                           or = \"1022\"\n              move    zeros to FS-Reply\n                               WE-Error\n              perform acas000-ReWrite\n              if  FS-Reply not = zero\n                  move spaces to SO-Print\n                  string SY014 FS-Reply into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"WE-Error = \" WE-Error into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string SY018 SQL-Err into SO-Print\n                  perform Call-Sysout\n                  move SQL-Msg to SO-Print\n                  perform Call-Sysout\n                  move SQL-State to SO-Print\n                  perform Call-Sysout\n                  go to aa999-Finish\n              end-if\n              add 1 to ws-Rec-Cnt-R-Out\n              go to aa999-Finish\n     end-if\n*>\n     if       fs-reply not = zero              *> Anything else\n              move spaces to SO-Print\n              string SY015 FS-Reply into SO-Print\n              perform Call-Sysout\n              move spaces to SO-Print\n              string \"WE-Error = \" WE-Error into SO-Print\n              perform Call-Sysout\n              move spaces to SO-Print\n              string SY018 SQL-Err into SO-Print\n              perform Call-Sysout\n              move SQL-Msg to SO-Print\n              perform Call-Sysout\n              move SQL-State to SO-Print\n              perform Call-Sysout\n              go to aa999-Finish\n     end-if\n     add      1 to ws-Rec-Cnt-Out.\n     go       to aa999-Finish.    *> only have one record.\n*>\n aa020-Rollback.\n*>\n*> These do not work during testing with mariadb - Non transactional model\n*>    or autocommit set ON\n*>\n*>           exec sql\n*>                rollback\n*>           end-exec.\n     call     \"MySQL_rollback\".\n*>     if       return-code not = zero\n*>              display \"Rollback failed \" at 0501\n*>              display return-code        at 0517\n*>     end-if.\n*>\n aa030-Commit.\n*>           exec sql\n*>                commit\n*>           end-exec.\n     call     \"MySQL_commit\".\n*>     if       return-code not = zero\n*>              display \"Commit failed \" at 0501\n*>              display return-code      at 0515\n*>     end-if.\n*>\n aa100-Check-4-Errors.\n     if       fs-reply not = zero\n                  move SY011 to SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"FS-Reply = \" FS-Reply into SO-Print\n                  perform Call-Sysout\n                  move spaces to SO-Print\n                  string \"WE-Error = \" WE-Error into SO-Print\n                  perform Call-Sysout\n                  move SQL-Err to SO-Print\n                  perform Call-Sysout\n                  move SQL-Msg to SO-Print\n                  perform Call-Sysout\n                  move SQL-State to SO-Print\n                  perform Call-Sysout\n              go to aa999-Finish\n     end-if.\n*>\n aa999-Finish.\n     move     spaces to SO-Print.\n     string   \"Rec cnt  in = \" ws-Rec-Cnt-In\n              \" Rec cnt out = \" ws-Rec-Cnt-Out\n              \" Rec Cnt rewrite = \" ws-Rec-Cnt-R-Out into SO-Print.\n     perform  Call-Sysout.\n     move     spaces to SO-Print.\n     string   \"Log Recs out   = \" Log-File-Rec-Written into SO-Print.\n     perform  Call-Sysout.\n     move     1 to File-System-Used\n                   FA-File-System-Used.\n\n     move  \"66\" to FA-RDBMS-Flat-Statuses.     *> Force RDB processing with acas000.\n\n     move     zero to Access-Type.\n     move     2 to File-Function.\n     perform  acas000-Close.                     *> Close RDB\n     close    System-File.\n     move     \"EOJ - Load System Params Table\" to So-Print.   *> at 2001 with erase eol.\n     perform  Call-Sysout.\n     move     \"CLOSE   \" to SO-Print.\n     perform  Call-Sysout.\n     goback.\n*>\n copy \"Proc-Get-Env-Set-Files.cob\".  *> Only uses ACAS_LEDGERS now\n*>\n Call-Sysout.\n     call     \"ACAS-Sysout\" using SO-Print.\n*>",
        "line": 30
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 7,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 46,
      "totalOperators": 31,
      "totalOperands": 62,
      "vocabulary": 47,
      "length": 93,
      "volume": 516.5767632060202
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
