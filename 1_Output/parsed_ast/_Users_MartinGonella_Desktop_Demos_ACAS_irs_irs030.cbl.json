{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs030.cbl",
  "fileName": "irs030.cbl",
  "timestamp": "2025-09-15T16:25:49.487Z",
  "programId": "irs030",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 195
      },
      {
        "name": "working-storage",
        "line": 199
      },
      {
        "name": "linkage",
        "line": 410
      },
      {
        "name": "Screen",
        "line": 449
      },
      {
        "name": "Init-Main",
        "line": 554
      },
      {
        "name": "Input-Headings",
        "line": 1232
      },
      {
        "name": "Date-Validate",
        "line": 1278
      },
      {
        "name": "initialise-main",
        "line": 1395
      },
      {
        "name": "Show-Default",
        "line": 1497
      },
      {
        "name": "file-init",
        "line": 1511
      },
      {
        "name": "Net",
        "line": 1537
      },
      {
        "name": "Gross",
        "line": 1549
      },
      {
        "name": "Ledger-Postings-Add",
        "line": 1562
      },
      {
        "name": "exit",
        "line": 1724
      }
    ],
    "paragraphs": [
      {
        "name": "reverse-video",
        "line": 479
      },
      {
        "name": "File-Defs",
        "line": 551
      },
      {
        "name": "Main-Loop",
        "line": 563
      },
      {
        "name": "Main-Loop-clear",
        "line": 576
      },
      {
        "name": "Get-Default",
        "line": 599
      },
      {
        "name": "Get-Default-1",
        "line": 604
      },
      {
        "name": "Chk-Ans",
        "line": 676
      },
      {
        "name": "Get-Vat-Rate",
        "line": 685
      },
      {
        "name": "end-if",
        "line": 716
      },
      {
        "name": "Get-Char",
        "line": 720
      },
      {
        "name": "set-up",
        "line": 771
      },
      {
        "name": "set-up-1",
        "line": 774
      },
      {
        "name": "set-up-2",
        "line": 776
      },
      {
        "name": "Input-Loop",
        "line": 790
      },
      {
        "name": "Date-Inp",
        "line": 820
      },
      {
        "name": "Account-Input",
        "line": 840
      },
      {
        "name": "Vat-Input",
        "line": 897
      },
      {
        "name": "Vat-Input-Skip",
        "line": 920
      },
      {
        "name": "Input-Tidy",
        "line": 946
      },
      {
        "name": "Accept-Money",
        "line": 981
      },
      {
        "name": "end-if",
        "line": 995
      },
      {
        "name": "Accept-Money2",
        "line": 1001
      },
      {
        "name": "end-if",
        "line": 1015
      },
      {
        "name": "Justify-Accept-Money",
        "line": 1021
      },
      {
        "name": "Credit-Tidy",
        "line": 1080
      },
      {
        "name": "Input-End",
        "line": 1110
      },
      {
        "name": "Input-End-1",
        "line": 1116
      },
      {
        "name": "Clear-Screen",
        "line": 1146
      },
      {
        "name": "End-Batch",
        "line": 1163
      },
      {
        "name": "Batch-Close",
        "line": 1206
      },
      {
        "name": "Batch-Close-Return",
        "line": 1215
      },
      {
        "name": "Heading-ScreenP",
        "line": 1219
      },
      {
        "name": "Main-Exit",
        "line": 1223
      },
      {
        "name": "goback",
        "line": 1224
      },
      {
        "name": "Display-Existing",
        "line": 1238
      },
      {
        "name": "Display-Existing-End",
        "line": 1270
      },
      {
        "name": "u-bin",
        "line": 1352
      },
      {
        "name": "Pack-Loop-1",
        "line": 1361
      },
      {
        "name": "Pack-Loop-2",
        "line": 1371
      },
      {
        "name": "Main-Exit",
        "line": 1390
      },
      {
        "name": "end-if",
        "line": 1460
      },
      {
        "name": "end-perform",
        "line": 1467
      },
      {
        "name": "initialise-Main-Exit",
        "line": 1494
      },
      {
        "name": "exit",
        "line": 1495
      },
      {
        "name": "main51-exit",
        "line": 1508
      },
      {
        "name": "exit",
        "line": 1509
      },
      {
        "name": "main52-exit",
        "line": 1534
      },
      {
        "name": "exit",
        "line": 1535
      },
      {
        "name": "Main-Exita",
        "line": 1546
      },
      {
        "name": "exit",
        "line": 1547
      },
      {
        "name": "Main-Exitb",
        "line": 1559
      },
      {
        "name": "exit",
        "line": 1560
      },
      {
        "name": "Input-Loop",
        "line": 1613
      },
      {
        "name": "EOJ",
        "line": 1696
      },
      {
        "name": "EOJ-q1",
        "line": 1709
      },
      {
        "name": "main99-exit",
        "line": 1723
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 101,
        "type": "DYNAMIC",
        "using": []
      },
      {
        "target": "scr_dump",
        "line": 611,
        "type": "DYNAMIC",
        "using": [
          "wScreenName",
          "returning",
          "wInt",
          "perform",
          "Show-Default",
          "call",
          "\"scr_restore\"",
          "using",
          "wScreenName",
          "returning",
          "wInt",
          "call",
          "\"CBL_DELETE_FILE\"",
          "using",
          "Path-Work",
          "go",
          "to",
          "Get-Default"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 185,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 194,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 282,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 283,
        "replacing": null
      },
      {
        "name": "irswsdflt",
        "line": 284,
        "replacing": null
      },
      {
        "name": "irswspost",
        "line": 285,
        "replacing": null
      },
      {
        "name": "wspost-irs",
        "line": 286,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 295,
        "replacing": null
      },
      {
        "name": "screenio",
        "line": 341,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 413,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 416,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 447,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 1726,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 102
      },
      {
        "target": "Initialise-Main",
        "thru": null,
        "line": 559
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 581
      },
      {
        "target": "Show-Default",
        "thru": null,
        "line": 585
      },
      {
        "target": "file-init",
        "thru": null,
        "line": 587
      },
      {
        "target": "Ledger-Postings-Add",
        "thru": null,
        "line": 595
      },
      {
        "target": "Show-Default",
        "thru": null,
        "line": 613
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 653
      },
      {
        "target": "varying",
        "thru": null,
        "line": 697
      },
      {
        "target": "display",
        "thru": null,
        "line": 705
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 758
      },
      {
        "target": "acasirsub4-Open",
        "thru": null,
        "line": 772
      },
      {
        "target": "Heading-ScreenP",
        "thru": null,
        "line": 777
      },
      {
        "target": "End-Batch",
        "thru": "Batch-Close",
        "line": 806
      },
      {
        "target": "End-Batch",
        "thru": "Batch-Close",
        "line": 824
      },
      {
        "target": "Get-Default",
        "thru": "Set-Up",
        "line": 825
      },
      {
        "target": "Set-Up-2",
        "thru": null,
        "line": 826
      },
      {
        "target": "Date-Validate",
        "thru": null,
        "line": 834
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 857
      },
      {
        "target": "Accept-Money",
        "thru": null,
        "line": 885
      },
      {
        "target": "Net",
        "thru": null,
        "line": 910
      },
      {
        "target": "Gross",
        "thru": null,
        "line": 913
      },
      {
        "target": "Accept-Money2",
        "thru": null,
        "line": 930
      },
      {
        "target": "Justify-Accept-Money",
        "thru": null,
        "line": 987
      },
      {
        "target": "justify-Accept-Money",
        "thru": null,
        "line": 1009
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1030
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1034
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1039
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1043
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1048
      },
      {
        "target": "*>",
        "thru": null,
        "line": 1057
      },
      {
        "target": "cycle",
        "thru": null,
        "line": 1062
      },
      {
        "target": "if",
        "thru": null,
        "line": 1064
      },
      {
        "target": "Heading-ScreenP",
        "thru": null,
        "line": 1111
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1112
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1140
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1169
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1179
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1188
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1204
      },
      {
        "target": "acasirsub4-Close",
        "thru": null,
        "line": 1210
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1246
      },
      {
        "target": "acasirsub3",
        "thru": null,
        "line": 1426
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1430
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1436
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1442
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1445
      },
      {
        "target": "if",
        "thru": null,
        "line": 1452
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1458
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1464
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1473
      },
      {
        "target": "acasirsub1-Open-Input",
        "thru": null,
        "line": 1474
      },
      {
        "target": "varying",
        "thru": null,
        "line": 1478
      },
      {
        "target": "acasirsub1-Read-Next",
        "thru": null,
        "line": 1480
      },
      {
        "target": "end-if",
        "thru": null,
        "line": 1482
      },
      {
        "target": "sort",
        "thru": null,
        "line": 1488
      },
      {
        "target": "Input-Headings",
        "thru": null,
        "line": 1502
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1530
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 1532
      },
      {
        "target": "acas008-Open-Input",
        "thru": null,
        "line": 1572
      },
      {
        "target": "acasirsub3",
        "thru": null,
        "line": 1580
      },
      {
        "target": "acasirsub1-Open",
        "thru": null,
        "line": 1584
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1590
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1600
      },
      {
        "target": "acasirsub4-Open",
        "thru": null,
        "line": 1611
      },
      {
        "target": "acas008-Read-Next",
        "thru": null,
        "line": 1615
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1624
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1636
      },
      {
        "target": "acasirsub1-Read-Indexed",
        "thru": null,
        "line": 1642
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1652
      },
      {
        "target": "acasirsub4-Write",
        "thru": null,
        "line": 1668
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1699
      },
      {
        "target": "acasirsub1-Rewrite",
        "thru": null,
        "line": 1702
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 1704
      },
      {
        "target": "acasirsub4-Close",
        "thru": null,
        "line": 1705
      },
      {
        "target": "acas008-Close",
        "thru": null,
        "line": 1706
      },
      {
        "target": "acas008-Open-Output",
        "thru": null,
        "line": 1718
      },
      {
        "target": "acas008-Close",
        "thru": null,
        "line": 1719
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "w",
        "line": 564
      },
      {
        "from": "zero",
        "to": "next-post save-sequ\n                   go to  get-default",
        "line": 591
      },
      {
        "from": "zero",
        "to": "save-sequ\n              perform Ledger-Postings-Add",
        "line": 594
      },
      {
        "from": "z\"irs-temp.scr\"",
        "to": "wScreenName\n              call     \"scr_dump\"    using wScreenName\n                                             returning wInt\n              perform  Show-Default\n              call     \"scr_restore\" using wScreenName\n                                                                                               returning wInt\n              call     \"CBL_DELETE_FILE\" using Path-Work\n              go to Get-Default",
        "line": 610
      },
      {
        "from": "zero",
        "to": "NL-Sub-Nominal",
        "line": 652
      },
      {
        "from": "1",
        "to": "vat-flag\n     else\n              move zero to vat-flag",
        "line": 661
      },
      {
        "from": "NL-Name",
        "to": "WS-Def-Name",
        "line": 674
      },
      {
        "from": "1",
        "to": "WS-Vat-Number",
        "line": 689
      },
      {
        "from": "zero",
        "to": "WS-Vat-Current\n              move   3    to WS-Vat-Number      *> Default zero rate - may be\n     else\n              move     1 to cole col2\n              move     ws-23-lines to lin lin2\n              display  space at curs with erase eol\n              perform  varying WS-Vat-Number  from 1 by 1 until WS-Vat-Number > 3\n                       display \"Rate n [99",
        "line": 691
      },
      {
        "from": "1",
        "to": "WS-Vat-Number\n              accept  WS-Vat-Number at line ws-lines col 40\n                                                     with foreground-color 3 with update\n              if      WS-Vat-Number < 1 or > 3\n                      go to Get-Vat-Rate\n              end-if\n              move  WS-Vat-Rate (WS-Vat-Number) to WS-Vat-Current\n              display  space at line ws-23-lines col 1 with erase eol\n     end-if",
        "line": 708
      },
      {
        "from": "ws-type",
        "to": "ws-type-display",
        "line": 733
      },
      {
        "from": "\"CR\"",
        "to": "ws-type\n     else\n              move \"DR\" to ws-type",
        "line": 736
      },
      {
        "from": "spaces",
        "to": "ws-vat-ac\n              move zero  to ws-vat vat-ac-def\n              go to set-up",
        "line": 745
      },
      {
        "from": "32",
        "to": "y\n     else\n              move 31 to y",
        "line": 749
      },
      {
        "from": "y",
        "to": "vat-ac-def",
        "line": 756
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 757
      },
      {
        "from": "nl-name",
        "to": "ws-vat-ac",
        "line": 769
      },
      {
        "from": "zero",
        "to": "ws-batch save-sequ",
        "line": 773
      },
      {
        "from": "6",
        "to": "lin",
        "line": 781
      },
      {
        "from": "run-date",
        "to": "post-date",
        "line": 782
      },
      {
        "from": "1",
        "to": "Next-Post",
        "line": 785
      },
      {
        "from": "next-post",
        "to": "post-key",
        "line": 786
      },
      {
        "from": "spaces",
        "to": "post-legend",
        "line": 788
      },
      {
        "from": "zero",
        "to": "w\n              go to Main-Loop-clear",
        "line": 807
      },
      {
        "from": "zeros",
        "to": "post-amount",
        "line": 816
      },
      {
        "from": "zeros",
        "to": "input-account",
        "line": 817
      },
      {
        "from": "next-post",
        "to": "post-key\n              move     def-codes (w) to  post-code\n              go to  Date-Inp\n     end-if\n     display  space at line WS-Lines col 41 with erase eol",
        "line": 827
      },
      {
        "from": "1",
        "to": "cole",
        "line": 837
      },
      {
        "from": "input-account",
        "to": "display-account",
        "line": 842
      },
      {
        "from": "11",
        "to": "cole",
        "line": 852
      },
      {
        "from": "input-account",
        "to": "nl-owning",
        "line": 855
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 856
      },
      {
        "from": "1",
        "to": "vat-flag-2\n     else\n              move zero to vat-flag-2",
        "line": 866
      },
      {
        "from": "18",
        "to": "cole",
        "line": 873
      },
      {
        "from": "post-legend",
        "to": "display-legend",
        "line": 877
      },
      {
        "from": "43",
        "to": "cole",
        "line": 878
      },
      {
        "from": "ws-23-lines",
        "to": "lin2\n     move     14 to col2",
        "line": 881
      },
      {
        "from": "zero",
        "to": "amt-ok",
        "line": 883
      },
      {
        "from": "amt-ok",
        "to": "post-amount",
        "line": 888
      },
      {
        "from": "post-amount",
        "to": "display-amount",
        "line": 889
      },
      {
        "from": "61",
        "to": "cole",
        "line": 890
      },
      {
        "from": "zero",
        "to": "vat-amount  ws-vat\n              go to Input-Tidy",
        "line": 894
      },
      {
        "from": "space",
        "to": "ws-vat-code",
        "line": 902
      },
      {
        "from": "zero",
        "to": "vat-amount\n              go to Vat-Input-Skip",
        "line": 904
      },
      {
        "from": "zero",
        "to": "vat-amount\n       else\n              go to Vat-Input",
        "line": 916
      },
      {
        "from": "post-amount",
        "to": "net-display",
        "line": 921
      },
      {
        "from": "vat-amount",
        "to": "vat-display",
        "line": 922
      },
      {
        "from": "61",
        "to": "cole",
        "line": 923
      },
      {
        "from": "71",
        "to": "cole",
        "line": 925
      },
      {
        "from": "vat-amount",
        "to": "amt-ok",
        "line": 928
      },
      {
        "from": "curs",
        "to": "curs2",
        "line": 929
      },
      {
        "from": "post-amount",
        "to": "net-display\n              move 61 to cole\n              display net-display at curs with foreground-color 3",
        "line": 935
      },
      {
        "from": "amt-ok",
        "to": "vat-amount",
        "line": 938
      },
      {
        "from": "1",
        "to": "rev-flag\n              multiply post-amount by -1 giving post-amount",
        "line": 955
      },
      {
        "from": "input-account",
        "to": "post-cr",
        "line": 958
      },
      {
        "from": "\"CR\"",
        "to": "post-vat-side",
        "line": 963
      },
      {
        "from": "zero",
        "to": "ws-poundsd amt-ok ws-penced",
        "line": 982
      },
      {
        "from": "spaces",
        "to": "ws-amount-screen-accept",
        "line": 983
      },
      {
        "from": "space",
        "to": "ws-sign",
        "line": 984
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 996
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 997
      },
      {
        "from": "\"-\"",
        "to": "ws-sign else\n              move space to ws-sign",
        "line": 1003
      },
      {
        "from": "amt-wk-pence",
        "to": "ws-pence",
        "line": 1005
      },
      {
        "from": "\".\"",
        "to": "ws-period",
        "line": 1006
      },
      {
        "from": "amt-wk-pds",
        "to": "ws-pound",
        "line": 1007
      },
      {
        "from": "ws-pound",
        "to": "amt-wk-pds",
        "line": 1016
      },
      {
        "from": "ws-pence",
        "to": "amt-wk-pence",
        "line": 1017
      },
      {
        "from": "zero",
        "to": "amt-ok c d",
        "line": 1027
      },
      {
        "from": "zero",
        "to": "ws-dstrg-9 ws-nstrg\n     move     10 to b",
        "line": 1028
      },
      {
        "from": "2",
        "to": "c                        *> set negative flag - twice\n                    exit perform                       *> we have an error\n              end-if\n              if    ws-amount-screen-accept (a:1) = \"",
        "line": 1033
      },
      {
        "from": "2",
        "to": "d                        *> set decimal flag - twice\n                    exit perform                       *> we have an error\n              end-if\n              if    ws-amount-screen-accept (a:1) = \"-\"\n                    move 1 to c                        *> set negative flag\n                    exit perform cycle\n              end-if\n              if    ws-amount-screen-accept (a:1) = \"",
        "line": 1038
      },
      {
        "from": "1",
        "to": "d                        *> set decimal flag\n                    subtract b from 10 giving E1    *> = 0, 1 or 2 dec",
        "line": 1046
      },
      {
        "from": "3",
        "to": "c                 *> if we have number already we can\n                    exit perform                *> NOT have more\n              end-if\n              if    ws-amount-screen-accept (a:1) numeric\n                    subtract 1 from b               *> 1st char is (10)\n                    move ws-amount-screen-accept (a:1) to ws-num-dstring (b:1)\n                    exit perform cycle\n              end-if\n     end-perform\n     if       c < 2 and d < 2         *> these are errors\n       if     E1 = 2\n              divide ws-nstrg by 100 giving amt-ok\n       else\n        if    E1 = 1\n              divide ws-nstrg by 10  giving amt-ok\n        else\n              move ws-nstrg to amt-ok\n        end-if\n       end-if\n       if     c = 1\n              multiply -1 by amt-ok\n       end-if\n     end-if ",
        "line": 1056
      },
      {
        "from": "input-account",
        "to": "post-dr",
        "line": 1085
      },
      {
        "from": "1",
        "to": "rev-flag\n              multiply post-amount by -1 giving post-amount",
        "line": 1088
      },
      {
        "from": "\"DR\"",
        "to": "post-vat-side",
        "line": 1094
      },
      {
        "from": "post-amount",
        "to": "net-display",
        "line": 1122
      },
      {
        "from": "vat-amount",
        "to": "vat-display",
        "line": 1123
      },
      {
        "from": "61",
        "to": "cole",
        "line": 1124
      },
      {
        "from": "71",
        "to": "cole",
        "line": 1126
      },
      {
        "from": "zero",
        "to": "rev-flag",
        "line": 1137
      },
      {
        "from": "5",
        "to": "file-function",
        "line": 1139
      },
      {
        "from": "6",
        "to": "lin",
        "line": 1144
      },
      {
        "from": "1",
        "to": "cole",
        "line": 1147
      },
      {
        "from": "7",
        "to": "lin",
        "line": 1160
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1168
      },
      {
        "from": "ws-default",
        "to": "nl-cr\n              move zero to nl-dr\n     else\n              move ws-default to nl-dr\n              move zero to nl-cr",
        "line": 1173
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1187
      },
      {
        "from": "ws-vat",
        "to": "nl-cr\n              move  zero    to  nl-dr",
        "line": 1191
      },
      {
        "from": "ws-vat",
        "to": "nl-dr\n              move  zero    to  nl-cr",
        "line": 1194
      },
      {
        "from": "ws-vat",
        "to": "nl-cr\n              move  zero    to  nl-dr",
        "line": 1198
      },
      {
        "from": "ws-vat",
        "to": "nl-dr\n              move  zero    to  nl-cr",
        "line": 1201
      },
      {
        "from": "post-key",
        "to": "next-post",
        "line": 1211
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 1235
      },
      {
        "from": "7",
        "to": "lin",
        "line": 1236
      },
      {
        "from": "ws-acs",
        "to": "nl-owning",
        "line": 1243
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1244
      },
      {
        "from": "41",
        "to": "cole\n              move 6  to lin",
        "line": 1265
      },
      {
        "from": "1",
        "to": "w  cole",
        "line": 1271
      },
      {
        "from": "7",
        "to": "lin",
        "line": 1272
      },
      {
        "from": "zero",
        "to": "u-bin q",
        "line": 1303
      },
      {
        "from": "post-date",
        "to": "u-date",
        "line": 1304
      },
      {
        "from": "u-date",
        "to": "post-date",
        "line": 1334
      },
      {
        "from": "1",
        "to": "ws-work1",
        "line": 1350
      },
      {
        "from": "zero",
        "to": "ws-work2\n                        u-bin",
        "line": 1351
      },
      {
        "from": "zero",
        "to": "u-bin\n              go to  Pack-End",
        "line": 1358
      },
      {
        "from": "zero",
        "to": "u-bin\n              go to Pack-End",
        "line": 1374
      },
      {
        "from": "zero",
        "to": "u-bin",
        "line": 1389
      },
      {
        "from": "24",
        "to": "ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines",
        "line": 1405
      },
      {
        "from": "spaces",
        "to": "Path-Work",
        "line": 1416
      },
      {
        "from": "1",
        "to": "File-Key-No",
        "line": 1421
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 1425
      },
      {
        "from": "zero",
        "to": "a",
        "line": 1438
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal\n              perform  acasirsub1-Read-Indexed\n              if   we-error = 2\n                   display IR035 at line ws-lines col 01 with foreground-color cob-color-red erase eol\n                   accept ws-reply at line ws-lines col 77\n                   display space at line ws-lines col 01 with erase eol\n                   add 1 to a\n              end-if\n     end-perform\n     if       a > zero\n              display \"You will need to fix the VAT account problems before posting\"\n                              at 1201 with erase eos foreground-color 4\n              display SY008   at 1401 with foreground-color 4\n              accept ws-reply at 1440\n              perform  acasirsub1-Close\n              go to Initialise-Main-Exit\n     end-if",
        "line": 1444
      },
      {
        "from": "zero",
        "to": "b",
        "line": 1468
      },
      {
        "from": "zeros",
        "to": "CoA-Count",
        "line": 1476
      },
      {
        "from": "zeros",
        "to": "CoA-Index",
        "line": 1477
      },
      {
        "from": "NL-Owning",
        "to": "CoA-Own (CoA-Count)\n              move    NL-Sub-Nominal to CoA-Sub (CoA-Count)\n              move    NL-Name     to CoA-Orig-Desc  (CoA-Count)\n              move    function lower-case (NL-Name)  to Coa-Desc  (CoA-Count)\n     end-perform\n     sort     COA-Table ascending key CoA-Desc",
        "line": 1484
      },
      {
        "from": "space",
        "to": "ws-reply",
        "line": 1505
      },
      {
        "from": "spaces",
        "to": "ws-reply",
        "line": 1514
      },
      {
        "from": "\"Z\"",
        "to": "ws-reply\n*>              go to  main52-exit",
        "line": 1523
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 1528
      },
      {
        "from": "3",
        "to": "access-type",
        "line": 1529
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 1531
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 1579
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1589
      },
      {
        "from": "WS-IRSNL-Record",
        "to": "nl31-record",
        "line": 1596
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1599
      },
      {
        "from": "WS-IRSNL-Record",
        "to": "nl32-record",
        "line": 1606
      },
      {
        "from": "WS-IRS-Post-DR",
        "to": "nl-owning",
        "line": 1622
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1623
      },
      {
        "from": "WS-IRS-Post-CR",
        "to": "nl-owning",
        "line": 1640
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 1641
      },
      {
        "from": "WS-IRS-Post-Code",
        "to": "post-code",
        "line": 1656
      },
      {
        "from": "WS-IRS-Post-Date",
        "to": "post-date",
        "line": 1657
      },
      {
        "from": "WS-IRS-Post-CR",
        "to": "post-cr",
        "line": 1658
      },
      {
        "from": "WS-IRS-Post-DR",
        "to": "post-dr",
        "line": 1659
      },
      {
        "from": "WS-IRS-Post-Amount",
        "to": "post-amount",
        "line": 1660
      },
      {
        "from": "WS-IRS-Post-Legend",
        "to": "post-legend",
        "line": 1661
      },
      {
        "from": "WS-IRS-Vat-AC-Def",
        "to": "vat-ac-def",
        "line": 1662
      },
      {
        "from": "WS-IRS-Post-Vat-Side",
        "to": "post-vat-side",
        "line": 1663
      },
      {
        "from": "WS-IRS-Vat-Amount",
        "to": "vat-amount",
        "line": 1664
      },
      {
        "from": "next-post",
        "to": "post-key",
        "line": 1665
      },
      {
        "from": "nl31-record",
        "to": "WS-IRSNL-Record",
        "line": 1698
      },
      {
        "from": "nl32-record",
        "to": "WS-IRSNL-Record",
        "line": 1701
      }
    ],
    "computes": [
      {
        "target": "u-bin",
        "expression": "u-year * 365",
        "line": 1355
      }
    ]
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "feasible to use a\n*>                         entry method using first few letters of the descriptions of a\n*>                         account.  This will involve a lot of changes possibly so will\n*>                         be very experimental.\n*>                         This option is will NOT be available anytime soon.\n*>                      F4 is NOT YET AVAILABLE - not coded.\n*>                      F9 is NOT YET AVAILABLE - not coded.\n*>**\n*> Version.             See prog-name in ws.\n*>**\n*> Calls.\n*>                      acas008  ->   SL posting  FH.\n*>                       slpostingMT\n*>                      acasirsub1  ->\n*>                       irsnominalMT\n*>                      acasirsub3 ->\n*>                       irsdfltMT\n*>                      acasirsub4 ->\n*>                       postingMT\n*>**\n*> Error messages used.\n*>  System Wide\n*>                      SM901 }\n*>                      SM903 } Produced by DAL.\n*>                      SM904 }\n*>                      SY008.\n*>                      IR901 }\n*>                      IR902 } From FH.\n*>                      IR911 }\n*>                      IR912 }\n*>                      IR913 }\n*>                      IR914 }\n*>                      IR915 }\n*>                      IR916 }\n*>  Module Specific.\n*>                      IR030 End of listing. Hit return for Menu.\n*>                      IR031 No Ledger Posting file found. Process Aborted\n*>                      IR032 Invalid key 1 =\n*>                      IR033 Invalid key 2 =\n*>                      IR034 That Account now deleted!!!  Re-enter\n*>                      IR035 VAT Account/s not present, Fix it. Now hit return\n*>                      IR036 Amount not numeric. Re-Enter\n*>                      IR037 That account does not exist. Re-enter\n*>                      IR038 Posting & Default a/c must not be the same\n*>                      IR039 Make sure that you have backed up your data\n*>                      IR03A IRSUB1-31 returns\n*>                      IR03B IRSUB1-32 returns\n*>**\n*> Changes.\n*>\n*>  11/7/83 vbc - Check response on correct account?,fix date vet\n*>                to vet for zero day month,year < 70 & improve\n*>                loop in accept post date routine.\n*> 13/07/83 vbc - Clear save-sequ if updating post file.\n*> 26/07/83 vbc - Rewrite date vet routines.\n*> 07/12/83 vbc - Tidy up display.\n*> 28/05/84 vbc - Hilite display heads.\n*> 12/04/85 vbc - Check if posting to vat account direct.\n*> 26/09/89 vbc - 2.53\n*>                Mods for COBOL/2.\n*> 09/10/89 vbc - Re-calc net amount if vat code = m & vat changed.\n*> 28/12/89 vbc - Test for dflt a/c same as input a/c.\n*> 22/01/09 vbc - Migration to Open/Gnu Cobol as version 3.\n*> 21/02/09 vbc - Added support for environment LINES and COLUMNS as needed.\n*> 24/02/09 vbc - Added change of default within postings at accept for\n*>                post-date via test for F3 added from full version.\n*> 07/04/09 vbc - .12 Added posting file from S.L. and P.L. as input to IRS.\n*> 14/03/10 vbc - .13-5 Cleanup multi field displays to comply with standards.\n*> 24/11/16 vbc - 3.02\n*> 24/11/16 vbc - .16 Added RDB support using acas000, acasirsub1, 3 & 4.\n*> 01/12/16 vbc - .17 RDB support via acasirsub(1-5) & DALs and using\n*>                    standard ACAS param file (system.dat) for info pickup\n*>                    passed to IRS-System-Params (renamed from system-record).\n*>                    Replaced all occurrences of call \"irsubn\" by\n*>                     perform acasirsubn\n*>                    File-Defs  added to all irsnnn calls as 2nd param.\n*>                    Clean up all msgs to use Pre-Defined ones system/module\n*>                    wide across entire IRS system in compliance with all of\n*>                    ACAS.\n*> 20/12/16 vbc -     All irs progs call copybook Proc-ZZ100-ACAS-IRS-Calls.\n*> 17/09/17 vbc - .18 Change screen defaults at Setup-Amend-Screen-3 to show the\n*>                    fixed data in place of an occurs 16 that does not work in GC.\n*> 29/01/18 vbc - .19 Changed copies to use copybooks where poss.\n*>                    renamed print-spool-commandxxx & wsnl to irsprint-spool-command\n*>                    & irswsnl as moved to copybooks dir.\n*> 10/02/18 vbc - .20 Renamed IR011-16 to IR911-16 and others.\n*> 11/02/18 vbc - .21 Starting adding in support for 3 rates of Vat in postings.\n*>                    WS-Vat-Rate/s.\n*>                    In  Account-Input consider adding 2nd char in accept for\n*>                    Vat-Rate entry ( 1 - 3 ) instead of the preset at start of\n*>                    batch run??\n*>                    Check Next-Post for zero and make it = 1.\n*> 19/04/18 vbc - .22 Experimental to see if save/restore screens work when\n*>                    processing request to display the defaults during postings\n*>                    by using F1 so new code in initialization and show-default.\n*> 20/04/18 vbc - .23 close NL if vat a/c's missing in initialise-main and remove close NL\n*>                    on PL/SL posting file proc as closed at EOJ.\n*>                    Init initialise-main used a for the vat rates is is now 3 so exits prog.\n*>                    Change to use b and zeroise after - really dumb error.\n*> 21/04/18 vbc - .24 With chg to wsfnctn set path of current dir so can del temp\n*>                    screen save file.\n*> 23/04/18 vbc - .25 Extra test with error/abort for open NL in init.\n*>                    Add comment regarding usage of F1 and F3",
        "line": 28
      },
      {
        "type": "IF",
        "condition": "anything for testing code.\n*>                    on COA-Search-Table. Nothing for actual search - more code\n*>                    needed.   Display defaults is using F1  (and 99 at start).\n*> 01/08/23 vbc - .30 Missing close acasirs1 before 2nd open in initialise-main\n*>                    found when running in -d -g etc.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>**\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n*>====================\n*>\n copy  \"envdiv.cob\".\n input-output section.\n data division.\n*>=============\n*>\n working-storage section.\n*>----------------------\n 77  prog-name           pic x(16) value \"irs030 (3.02.30)\".\n*>\n 01  filler.\n     03  a               binary-char     value zero.\n     03  b               binary-char     value zero.\n     03  c               binary-char     value zero.\n     03  d               binary-char     value zero.\n     03  E1              binary-char     value zero.\n     03  ws-env-lines    pic 999         value zero.\n     03  ws-lines        binary-char unsigned value zero.\n     03  ws-20-lines     binary-char unsigned value zero.\n     03  ws-21-lines     binary-char unsigned value zero.\n     03  ws-22-lines     binary-char unsigned value zero.\n     03  ws-23-lines     binary-char unsigned value zero.\n*>************************************************************\n*>     Demo-Flag set to 1 for generation of DEMO version     *\n*>                                                           *\n*>   This is not in use for the O/S (Open Source versions.   *\n*>===========================================================*\n     03  Demo-Flag       pic 9           value zero.\n         88 Demo                         value 1.\n*>===========================================================*\n*>    above demo flag set to 1 for demo version              *\n*>************************************************************\n     03  rev-flag        pic 9           value zero.\n     03  menu-reply      pic 9.\n     03  ws-reply        pic x.\n     03  ws-pass         pic x(4).\n     03  w               pic 99.\n     03  y               pic 99.\n     03  ws-type         pic xx.\n     03  ws-type2        pic xx          value \"DR\".\n     03  ws-default      pic s9(7)v99    value zero.\n     03  ws-vat          pic s9(7)v99    value zero.\n     03  ws-batch        pic s9(7)v99    value zero.\n     03  ws-def-ac       pic s9(7)v99    value zero.\n     03  input-account   pic s9(5).\n     03  Accept-WS-Vat.\n         05  ws-Vat-code pic x.      *>  As it was & it is P,M, sp.\n         05  WS-Vat-Term pic 9.      *>  Will be 1, 2 or 3 (Std, Reduced, Zero).\n*>\n*> New for .28 07/04/18\n*>\n     03  WS-Posting-Method pic 9         value zero.\n         88  WS-Posting-By-Default       value zero.\n         88  WS-Posting-By-Account       value 1.\n*>\n*>\n     03  post-true       pic z(4)9.\n     03  save-post       pic 9(5).\n     03  save-key        pic 9(5).\n     03  save-lin        pic 99.\n     03  net-display     pic z(6)9.99-.\n     03  vat-display     pic z(6)9.99-.\n     03  display-amount  pic z(6)9.99-.\n     03  display-account pic zzzz9.\n     03  ws-type-display pic xx.\n     03  hold-post       pic 9(5).\n     03  ws-acs          pic 9(5).\n     03  ws-codes        pic xx.\n     03  ws-vax          pic x.\n     03  vat-flag        pic 9           value zero.\n     03  vat-flag-2      pic 9           value zero.\n     03  ws-spaces       pic x(80)       value spaces.\n     03  ws-def-name     pic x(24).\n     03  ws-vat-ac       pic x(20).\n     03  display-legend  pic x(16).\n*>\n     03  Post-Record-Cnt pic 9(5)        value zero.\n     03  WS-Vat-Rates                    value zero.  *> taken from IRS system rec.\n         05  WS-Vat-Rate pic 99v99   occurs 3.\n         05  WS-Vat-Rate-Disp\n                         pic z9.99 occurs 3.\n     03  WS-Vat-Current  pic 99v99       value zero.\n     03  WS-VAT-Number   pic 9           value zero.\n*>\n*> the following for GC and screen with *nix NOT tested with Windows\n*>\n 01  wScreenName             pic x(256).\n 01  wInt                    binary-long.\n*>\n copy \"wsfnctn.cob\".\n copy \"irswsnl.cob\"   replacing NL-Record by WS-IRSNL-Record.\n copy \"irswsdflt.cob\" replacing Default-Record by WS-IRS-Default-Record.\n copy \"irswspost.cob\".\n copy \"wspost-irs.cob\".\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n *>    03  WS-IRSNL-Record       pic x.   *> acasirsub1 in use.\n *>    03  WS-IRS-Default-Record pic x.   *> acasirsub3 in use.\n *>    03  Posting-Record        pic x.   *> acasirsub4 in use.\n *>    03  WS-IRS-Posting-Record pic x.   *> acas008    in use.\n     03  Final-Record          pic x.    *> Table/File not used in this program.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  date-fields.\n     03  q                 pic 9.\n*>\n     03  days-in-month     pic x(24)  value \"312831303130313130313031\".\n     03  filler  redefines  days-in-month.\n       05  days            pic 99     occurs 12.\n*>\n     03  ws-work1          pic 9(5)   comp-3.\n     03  ws-work2          pic 9(5)   comp-3.\n     03  display-bin       pic zzzz9.\n*>\n 01  maps03-ws.\n     03  u-date          pic x(8).\n     03  filler  redefines  u-date.\n       05  u-days        pic 99.\n       05  filler        pic x.\n       05  u-month       pic 99.\n       05  filler        pic x.\n       05  u-year        pic 99.\n     03  u-bin           pic 9(5)     comp.\n*>\n 01  ws-amount-screen-display.\n     03  ws-poundsd      pic 9(7).\n     03  ws-period       pic x     value \".\".\n     03  ws-penced       pic v99.\n     03  ws-signd        pic x.\n 01  ws-amount-screen-accept redefines ws-amount-screen-display.\n     03  ws-pound        pic 9(7).\n     03  filler          pic x.\n     03  ws-pence        pic v99.\n     03  ws-sign         pic x.\n*>\n 01  ws-amount-work.\n     03  amt-wk-pds      pic s9(7).\n     03  amt-wk-pence    pic v99.\n 01  ws-amount-ok redefines ws-amount-work.\n     03  amt-ok          pic s9(7)v99.\n*>\n 01  ws-num-dstring.\n     03  ws-nstrg        pic 9(9).\n 01  ws-dstrg.\n     03  ws-dstrg-9      pic 99.\n*>\n 01  All-My-Constants    pic 9(4).\n     copy \"screenio.cpy\".\n*>\n*>  Working Storage for NL Default rec 31\n*>\n 01  nl31-record.\n     03  nl31-key.\n         05  nl31-owning   pic 9(5).\n         05  nl31-sub-nominal pic 9(5).\n     03  nl31-type         pic a.\n     03  nl31-data.\n         05  nl31-name     pic x(24).\n         05  nl31-dr       pic 9(8)v99   comp.\n         05  nl31-cr       pic 9(8)v99   comp.\n         05  nl31-dr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl31-cr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl31-ac       pic a.\n*>\n*>  Working Storage for NL Default rec 32\n*>\n 01  nl32-record.\n     03  nl32-key.\n         05  nl32-owning   pic 9(5).\n         05  nl32-sub-nominal pic 9(5).\n     03  nl32-type         pic a.\n     03  nl32-data.\n         05  nl32-name     pic x(24).\n         05  nl32-dr       pic 9(8)v99   comp.\n         05  nl32-cr       pic 9(8)v99   comp.\n         05  nl32-dr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl32-cr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl32-ac       pic a.\n*>\n*>  Searchable Table holding CoA with desc in lowercase and as original.\n*>\n 01  COA-Search-Table.\n     03  CoA-Table   occurs 500\n                      ascending key CoA-Desc\n                      indexed       CoA-Index.\n         05  CoA-Account.\n             07  CoA-Own   pic 9(5).\n             07  CoA-Sub   pic 9(5).\n         05  CoA-Desc      pic x(24).\n         05  CoA-Orig-Desc pic x(24).\n 01  CoA-Count             pic 999 comp     value zero.\n 01  CoA-Found-Key         pic 999 comp     value zero.\n*>\n 01  Error-Messages.\n*> System Wide\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR914          pic x(51) value \"IR914 Error on irspostingMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific\n     03  IR030          pic x(42) value \"IR030 End of listing. Hit return for Menu.\".\n     03  IR031          pic x(51) value \"IR031 No Ledger Posting file found. Process Aborted\".\n     03  IR032          pic x(22) value \"IR032 Invalid key 1 = \".\n     03  IR033          pic x(22) value \"IR033 Invalid key 2 = \".\n     03  IR034          pic x(43) value \"IR034 That Account now deleted!!!  Re-enter\".\n     03  IR035          pic x(55) value \"IR035 VAT Account/s not present, Fix it. Now hit return\".\n     03  IR036          pic x(34) value \"IR036 Amount not numeric. Re-Enter\".\n     03  IR037          pic x(43) value \"IR037 That account does not exist. Re-enter\".\n     03  IR038          pic x(48) value \"IR038 Posting & Default a/c must not be the same\".\n     03  IR039          pic x(50) value \"IR039 Make sure that you have backed up your data\".\n     03  IR03A          pic x(24) value \"IR03A IRSUB1-31 returns \".\n     03  IR03B          pic x(24) value \"IR03B IRSUB1-32 returns \".\n*>\n linkage section.\n*>---------------\n*>\n copy \"irswssystem.cob\"   *> IRS param record\n              replacing system-record  by IRS-System-Params. *> (01 level)\n*>\n copy \"wssystem.cob\"    *> NEW for v3.02\n             replacing  System-Record by WS-System-Record\n                        Run-Date   by ACAS-Run-Date     *> these 3 are in binary\n                        Start-Date by ACAS-Start-Date   *> IRS expects as x(8)\n                        End-Date   by ACAS-End-Date     *>  dd/mm/yy\n                        suser      by ACAS-suser\n                        Address-1  by ACAS-Address-1\n                        Address-2  by ACAS-Address-2\n                        Address-3  by ACAS-Address-3\n                        Address-4  by ACAS-Address-4\n                        Post-Code  by ACAS-Post-Code\n                        Print-Spool-Name by ACAS-Print-Spool-Name\n                        Pass-Value by ACAS-Pass-Value\n                        Pass-Word  by ACAS-Pass-Word\n                        OP-System  By ACAS-Op-System\n                        Vat        by VatCode\n                        Client     by IRS-Client\n                        System-Ops by IRS-System-Ops\n                        Next-Post  by IRS-Next-Post\n                        Vat-Rates2 by IRS-Vat-Rates2\n                        Vat1       by IRS-Vat1\n                        Vat2       by IRS-Vat2\n                        Vat3       by IRS-Vat3\n                        Vat-Group  by IRS-Vat-Group\n                        Vat-Psent  by IRS-Vat-Psent\n                        Save-Sequ  by IRS-Save-Sequ\n                        System-Work-Group by IRS-System-Work-Group\n                        PL-App-Created by IRS-PL-App-Created\n                        PL-Approp-AC   by IRS-PL-Approp-AC\n                        1st-Time-Flag  by IRS-First-Time-Flag.\n*>\n copy \"wsnames.cob\".\n*>\n Screen Section.\n*>==============\n*>\n 01  heading-screen.\n   02                                       background-color 0 foreground-color 6.\n     03  pic x(16)      from  prog-name         line  1 col  1 foreground-color 2.\n     03             value \"Transaction Posting\"         col 31 foreground-color 1\n                                                               background-color 7.\n     03  pic x(8)       from  run-date                  col 73 foreground-color 2.\n     03             value \"Default -\"           line  2 col  1 foreground-color 2.\n     03  pic z9         from  w                         col 11 foreground-color 3.\n     03             value \"Run is - \"                   col 14 foreground-color 2.\n     03  pic xx         from  ws-type-display           col 23 foreground-color 3.\n     03  pic x(20)      from  ws-def-name               col 50 foreground-color 3.\n     03  pic z(6)9.99-  from  ws-default                col 70 foreground-color 3.\n     03             value \"Client \"             line  3 col  1 foreground-color 2.\n     03  pic x(24)      from  client                    col  8 foreground-color 3.\n     03             value \"End Date \"                   col 32 foreground-color 2.\n     03  pic x(8)       from  end-date                  col 41 foreground-color 3.\n     03  pic x(20)      from  ws-vat-ac                 col 50 foreground-color 3.\n     03  pic z(6)9.99-  from  ws-vat                    col 70 foreground-color 3.\n     03             value \"Batch Total\"         line  4 col 50 foreground-color 2.\n     03  pic z(6)9.99-  from  ws-batch                  col 70 foreground-color 3.\n*>\n 01  Display-Screen-1                                          background-color cob-color-black\n                                                               foreground-color cob-color-green.\n     03  pic x(16)      from  prog-name         line 1 col  1       blank screen.\n     03        value \"Default Accounts Display\" line 1 col 27\n                                                               foreground-color cob-color-white\n                                                               background-color cob-color-blue\n                                                                    reverse-video.\n     03  pic x(8)       from run-date           line 1 col 73.\n*> setup this is to display the defaults\n 01  Setup-Amend-Screen-3                                      background-color cob-color-black\n                                                               foreground-color cob-color-green.\n     03             value \"Client -\"            line  3 col  1.\n     03  pic x(24)      from client             line  3 col 10 foreground-color cob-color-cyan.\n     03             value \"Start date -\"        line  3 col 39.\n     03  pic x(8)       from start-date         line  3 col 52 foreground-color cob-color-cyan.\n     03             value \"End date -\"          line  3 col 62.\n     03  pic x(8)       from end-date           line  3 col 73 foreground-color cob-color-cyan.\n     03             value \"A/C Nos\"             line  5 col  4.\n     03             value \"Description\"         line  5 col 14.\n     03             value \"Code VAT   A/C Nos\"  line  5 col 33.\n     03             value \"Description\"         line  5 col 54.\n     03             value \"Code VAT\"            line  5 col 73.\n     03             value \" \"  erase eol        line  6 col 1.\n     03             value \"01 [00000]                      [AB] [C]\" &\n                          \"17 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"02 [00000]                      [AB] [C]\" &\n                          \"18 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"03 [00000]                      [AB] [C]\" &\n                          \"19 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"04 [00000]                      [AB] [C]\" &\n                          \"20 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"05 [00000]                      [AB] [C]\" &\n                          \"21 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"06 [00000]                      [AB] [C]\" &\n                          \"22 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"07 [00000]                      [AB] [C]\" &\n                          \"23 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"08 [00000]                      [AB] [C]\" &\n                          \"24 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"09 [00000]                      [AB] [C]\" &\n                          \"25 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"10 [00000]                      [AB] [C]\" &\n                          \"26 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"11 [00000]                      [AB] [C]\" &\n                          \"27 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"12 [00000]                      [AB] [C]\" &\n                          \"28 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"13 [00000]                      [AB] [C]\" &\n                          \"29 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"14 [00000]                      [AB] [C]\" &\n                          \"30 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"15 [00000]                      [AB] [C]\" &\n                          \"31 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n     03             value \"16 [00000]                      [AB] [C]\" &\n                          \"32 [00000]                      [DE] [F\"\n                                                line plus 1 col 1.\n*>\n*> after display need to update\n*>  cc4/44 = a/c-nos , vat 38/78, 33/73 code\n*> ] cc80\n*>\n procedure division using IRS-System-Params\n                          WS-System-Record\n                          File-Defs.\n*>=========================================\n*>\n Init-Main section.\n*>*****************\n*>\n*> first get date & user information..\n*>\n     perform  Initialise-Main.\n     if       a > zero                   *> Found errors in Tax/Vat accounts\n              go to Main-Exit.\n*>\n Main-Loop.\n     move     zero to w.\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Transaction Posting\"                       at 0131 with foreground-color 1 background-color 7.\n     display  \"Enter Run Option     -    [  ]\"            at 0501 with foreground-color 2.\n     display  \"(<99>    Display Existing Defaults)\"       at 0532 with foreground-color 2.\n     display  \"(<88>    Add to Existing Postings)\"        at 0632 with foreground-color 2.\n     display  \"(<77>    Clear Existing Postings)\"         at 0732 with foreground-color 2.\n     display  \"(<66>    Add PL or SL Postings from file)\" at 0832 with foreground-color 2.\n     display  \"(<Return> to exit to System Menu)\"         at 1032 with foreground-color 2.\n*>\n     accept   w at 0528 with foreground-color 3 update.\n*>\n Main-Loop-clear.\n*>\n*> close A/C file\n*>\n     if       w = zero\n              perform acasirsub1-Close        *> call-irsub1\n              go to Main-Exit.\n*>\n     if       w = 99\n              perform  Show-Default.\n     if       w = 77\n              perform  file-init\n              if   ws-reply = \"Z\"\n                   go to Main-Loop\n              else\n                   move  zero  to  next-post save-sequ\n                   go to  get-default.\n     if       w = 66\n              move zero to save-sequ\n              perform Ledger-Postings-Add.\n     if       w not = 88\n              go to  Main-Loop.\n*>\n Get-Default.\n     display  \"Enter Default Number -    [  ]\" at line ws-lines col 1\n                                                with foreground-color 2 erase eol.\n     display  \"F1 to Display Defaults\" at line WS-Lines col 41 with foreground-color 2.\n*>\n Get-Default-1.\n     accept   w  at line ws-lines col 28 with foreground-color 3.\n*>\n*> Save screen, show the defaults",
        "line": 150
      },
      {
        "type": "IF",
        "condition": "Cob-Crt-Status = Cob-Scr-F1\n              move     z\"irs-temp.scr\"  to wScreenName\n              call     \"scr_dump\"    using wScreenName\n                                             returning wInt\n              perform  Show-Default\n              call     \"scr_restore\" using wScreenName\n                                                                                               returning wInt\n              call     \"CBL_DELETE_FILE\" using Path-Work\n              go to Get-Default.\n*>\n     if       w  <  1  or  >  33                *>  a/c 33 is temp default added 01/05/18\n              go to  Get-Default.\n*>\n*>  First for test of F9 = using to / from accounts instead of the default system.\n*>   THIS IS NOT YET AVAILABLE.\n*>  Need to consider do a different process as a new called routine to Replace\n*>   existing code which in turn is a routine\n*>\n\n *>    if       Cob-Crt-Status = Cob-Scr-F9\n *>             set   WS-Posting-By-Default to false     *> but could be WS-Posting-By-Account to true\n *>             go to ????\n *>    end-if\n\n*>\n*> get Default A/C\n*>\n     if       w = 33\n              display  \"Def. A/C Code - [12345]\" at line ws-lines col 1\n                                                with foreground-color 2 erase eol\n              display  \"Def. Post Code - [AB]\"   at line ws-lines col 31\n                                                with foreground-color 2\n              display  \"Def. VAT Code  - [I] {I, O, N}\"    at line ws-lines col 55\n                                                with foreground-color 2\n              accept   Def-ACS (33)   at line ws-lines col 18\n                                                with foreground-color 3 update\n              accept   Def-Codes (33) at line ws-lines col 49\n                                                with foreground-color 3 update\n              accept   Def-VAT (33)   at line ws-lines col 73\n                                                with foreground-color 3 update\n     end-if\n*>\n     move     Def-ACS (w)  to  NL-Owning.\n     move     zero         to  NL-Sub-Nominal.\n     perform  acasirsub1-Read-Indexed.\n*>\n     if       WE-Error = 2\n              display IR034 at line ws-lines col 34 with  erase eol foreground-color 2\n              go to Get-Default-1.\n*>\n     if       w = 31 or = 32                             *> > 30\n          or  NL-Owning = Def-ACS (31) or Def-ACS (32)\n              move 1    to vat-flag\n     else\n              move zero to vat-flag.\n*>\n     display  NL-Name at line ws-lines col 01 with erase eol foreground-color 2.\n     if       DEF-Vat (w) = \"N\"\n              display \"(No VAT)    \" at line ws-lines col 26 with foreground-color 2\n     else\n      if      Def-Vat (w) = \"O\"\n              display \"(Output VAT - Sales)\" at line ws-lines col 26 with foreground-color 2\n      else\n              display \"(Input VAT - Purchases) \" at line ws-lines col 26 with foreground-color 2.\n*>\n     move     NL-Name  to  WS-Def-Name.\n*>\n Chk-Ans.\n     display  \"Correct Account (Y/N)....[ ]\" at line ws-lines col 51 with foreground-color 2.\n     accept   ws-reply  at line ws-lines col 77 with foreground-color 3.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply = \"N\"\n              go to Get-Default.\n     if       ws-reply not = \"Y\"\n              go to Chk-Ans.\n*>\n Get-Vat-Rate.\n*>\n*> Currently not coded for vat rates 4 & 5.\n*>\n     move     1 to WS-Vat-Number.               *> Default, Standard rate\n     if       Def-VAT (W) = \"N\"\n              move   zero to WS-Vat-Current\n              move   3    to WS-Vat-Number      *> Default zero rate - may be\n     else\n              move     1 to cole col2\n              move     ws-23-lines to lin lin2\n              display  space at curs with erase eol\n              perform  varying WS-Vat-Number  from 1 by 1 until WS-Vat-Number > 3\n                       display \"Rate n [99.99]  \" at curs with foreground-color 2\n                       add  5 cole giving col2\n                       display WS-Vat-Number      at curs2 with foreground-color 2\n                       add  8 cole giving col2\n                       display WS-Vat-Rate-Disp (WS-Vat-Number) at\n                                                     curs2 with foreground-color 2\n                       add 16 to cole\n              end-perform\n              display  \"STD Vat rate to be used (1, 2 or 3) - [ ]\" at line ws-lines col 1\n                                                     with foreground-color 2 erase eol\n              move    1  to WS-Vat-Number\n              accept  WS-Vat-Number at line ws-lines col 40\n                                                     with foreground-color 3 with update\n              if      WS-Vat-Number < 1 or > 3\n                      go to Get-Vat-Rate\n              end-if\n              move  WS-Vat-Rate (WS-Vat-Number) to WS-Vat-Current\n              display  space at line ws-23-lines col 1 with erase eol\n     end-if.\n*>\n*>          WS-VAT-Current = Vat rate to use for this batch.\n*>\n Get-Char.\n     display  \"Enter Run Characteristic [  ]\" at line ws-lines col 01 with erase eol\n                                                                      foreground-color 2.\n     display  \"('DR' or 'CR') DR if entered a/c, is debited (TO)\" at line ws-lines col 31\n                                                                 with foreground-color 2.\n     accept   ws-type2  at line ws-lines col 27 with foreground-color 3 update.\n     move     function upper-case (ws-type2) to ws-type.\n     if       ws-type not = \"DR\" and not = \"CR\"\n              go to  Get-Char.\n     display  space at line ws-lines col 01 with erase eol.\n*>\n*> now reverse posting type\n*>\n     move     ws-type to ws-type-display.\n*>\n     if       ws-type = \"DR\"\n              move \"CR\" to ws-type\n     else\n              move \"DR\" to ws-type.\n*>\n*> Set-up totals including VAT\n*>\n     subtract nl-cr from nl-dr giving ws-default.\n*>\n     if       def-vat (w) equal \"N\"\n              move spaces to ws-vat-ac\n              move zero  to ws-vat vat-ac-def\n              go to set-up.\n     if       def-vat (w) equal \"O\"\n              move 32 to y\n     else\n              move 31 to y.\n*>\n*> Set-up for VAT\n*>\n     move     def-acs (y) to nl-owning.\n     move     y to vat-ac-def.\n     move     zero to nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n*>\n*> Error cannot occur as tested in initialization but JIC\n*>\n     if       we-error = 2\n              display IR035 at line ws-lines col 01 with foreground-color cob-color-red erase eol\n              accept ws-reply at line ws-lines col 74\n              display space   at line ws-lines col 01 with erase eol\n              go to  Main-Exit.\n*>\n     subtract nl-dr  from  nl-cr  giving  ws-vat.\n     move     nl-name  to  ws-vat-ac.\n*>\n set-up.\n     perform  acasirsub4-Open                   *> open i-o\n     move     zero  to  ws-batch save-sequ.\n set-up-1.\n     display  space at 0101 with erase eos.\n set-up-2.\n     perform  Heading-ScreenP.\n*>\n     display  \"--Date--  Account\"                    at 0501 with foreground-color 2.\n     display  \"----Narrative----     Net       VAT\"  at 0543 with foreground-color 2.\n     move     6  to  lin.\n     move     run-date  to  post-date.\n*>\n     if       next-post = zero\n              move 1 to Next-Post.\n     move     next-post  to  post-key.\n     move     def-codes (w)  to  post-code .\n     move     spaces  to  post-legend.\n*>\n Input-Loop.\n     display  \"Date      - [        ]\"      at line ws-21-lines col 01 with foreground-color 2.\n     display  \"Account                 -[     ]\" at line ws-21-lines col 41 with foreground-color 2.\n     display  \"Narrative - [\"               at line ws-22-lines col 01 with foreground-color 2.\n     display  \"]\"                           at line ws-22-lines col 46 with foreground-color 2.\n     add      1  post-key  giving  post-true.\n*>\n*>    The code below is for the demo version, if DEMO-FLAG set to 1\n*>      but as this version is now Open Source the flag is zero\n*> WARNING:: SET to 0 for use in normal system. <<<<<<<<<<<<\n*>\n     if       demo   and   post-true > 50\n              display space\n              display \"Sorry only 50 postings allowed on DEMO system\" at 1220\n              display SY008   AT 1426\n              accept ws-reply at 1453\n              perform End-Batch thru Batch-Close\n              move zero to w\n              go to Main-Loop-clear.\n*>\n     display  \"{Posting number :- \"     at line ws-22-lines col 51 with foreground-color 2.\n     display  post-true                 at line ws-22-lines col 70 with foreground-color 3.\n     display  \"}\"                       at line ws-22-lines col 75 with foreground-color 2.\n     display  \"Amount    - [           ]\" at line ws-23-lines col 1 with foreground-color 2.\n     display  \"VAT Code (P/M or space) - [ ]\" at line ws-23-lines col 41 with foreground-color 2.\n*>\n     move     zeros to post-amount.\n*>     move     zeros to input-account. *> so we can use the one previously input (date & desc. as well)\n     display  post-date at line ws-21-lines col 14 with foreground-color 3.\n*>\n Date-Inp.\n     display  \"F3 for new default\" at line WS-Lines col 41  with foreground-color 2 erase eol.\n     accept   post-date  at line ws-21-lines col 14 with foreground-color 3 update.\n     if       cob-crt-status = COB-SCR-F3\n              perform  End-Batch thru Batch-Close\n              perform  Get-Default thru Set-Up\n              perform  Set-Up-2\n              move     next-post     to  post-key\n              move     def-codes (w) to  post-code\n              go to  Date-Inp\n     end-if\n     display  space at line WS-Lines col 41 with erase eol.          *> clear F3 comment.\n     if       post-date = spaces\n              go to End-Batch.\n     perform  Date-Validate.\n     if       u-bin = zero\n              go to  Date-Inp.\n     move     1 to cole.\n     display  post-date at curs with foreground-color 3.\n*>\n Account-Input.\n     accept   input-account at line ws-21-lines col 67 with foreground-color 3 update.\n     move     input-account to  display-account.\n     if       input-account = zero\n              go to  End-Batch.\n     if       input-account < zero\n              go to  account-input.\n     if       Input-account = Def-acs (w)\n              display IR038        at line ws-lines col 01 with foreground-color 2\n              go to account-input\n     else\n              display ws-spaces at line ws-lines col 01.\n     move     11 to cole.\n     display  display-account at curs with foreground-color 3.\n*>\n     move     input-account to nl-owning.\n     move     zero to nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n*>\n     if       we-error = 2\n              display IR037      at line ws-lines col 01 with foreground-color 2\n              go to  account-input\n     else\n              display  ws-spaces at line ws-lines col 01.\n     if       input-account = def-acs (31) or def-acs (32)\n          or  vat-flag = 1\n              move 1  to vat-flag-2\n     else\n              move zero to vat-flag-2.\n*>\n     display  \"Amount    - [           ]\"      at line ws-23-lines col 01 with foreground-color 2.\n     display  \"VAT Code (P/M or space) - [  ]\" at line ws-23-lines col 41 with foreground-color 2.\n*>\n     move     18 to cole.\n     display  nl-name at curs with foreground-color 3.\n     display  post-legend at line ws-22-lines col 14 with foreground-color 3.\n     accept   post-legend at line ws-22-lines col 14 with foreground-color 3 update.\n     move     post-legend  to  display-legend.\n     move     43 to cole.\n     display  display-legend at curs with foreground-color 3.\n*>\n     move     ws-23-lines to lin2\n     move     14 to col2.\n     move     zero to amt-ok.\n     if       vat-flag-2 = zero\n              perform Accept-Money.\n     if       amt-ok = zero\n              go to Input-Loop.\n     move     amt-ok to post-amount.\n     move     post-amount to display-amount.\n     move     61 to cole.\n     display  display-amount at curs with foreground-color 3.\n*>\n     if       def-vat (w) equal \"N\"\n              move zero to vat-amount  ws-vat\n              go to Input-Tidy.\n*>\n Vat-Input.\n*>\n*> Will need to consider accept of 2nd char for VAT rate setting (1 - 3).\n*>   but slightly coded for at least in WS.\n*>\n     move     space to ws-vat-code.\n     if       vat-flag-2 = 1\n              move zero to vat-amount\n              go to Vat-Input-Skip.\n*>\n     accept   ws-vat-code  at line ws-23-lines col 68 with foreground-color 3.\n     move     function upper-case (ws-vat-code) to ws-vat-code.\n     if       ws-vat-code = \"P\"\n              perform  Net\n     else\n      if      ws-vat-code = \"M\"\n              perform  Gross\n      else\n       if     ws-vat-code = space\n              move zero to vat-amount\n       else\n              go to Vat-Input.\n*>\n Vat-Input-Skip.\n     move     post-amount  to  net-display.\n     move     vat-amount   to  vat-display.\n     move     61 to cole.\n     display  net-display at curs with foreground-color 3.\n     move     71 to cole.\n     display  vat-display at curs with foreground-color 3.\n*>\n     move     vat-amount to amt-ok.\n     move     curs to curs2.\n     perform  Accept-Money2.\n     if       vat-amount not = amt-ok\n        and   ws-vat-code = \"M\"\n              Add Vat-amount to Post-amount\n              Subtract Amt-ok from Post-amount\n              move post-amount to net-display\n              move 61 to cole\n              display net-display at curs with foreground-color 3.\n     move     amt-ok to vat-amount.\n     if       vat-amount < zero\n              multiply vat-amount by -1 giving  vat-amount.\n*>\n     if       post-amount = zero  and\n              vat-amount  = zero\n              go to  Input-Loop.\n*>\n Input-Tidy.\n     if       ws-type = \"CR\" and post-amount > zero\n              go to credit-tidy.\n     if       ws-type = \"DR\" and post-amount < zero\n              go to credit-tidy.\n*>\n*> processing for DR run\n*>\n     if       post-amount < zero\n              move 1 to rev-flag\n              multiply post-amount by -1 giving post-amount.\n     move     def-acs (w) to post-dr.\n     move     input-account to post-cr.\n     if       rev-flag = 1\n              subtract post-amount vat-amount from ws-batch.\n     if       rev-flag not = 1\n              add      post-amount vat-amount to ws-batch.\n     move     \"CR\" to post-vat-side.\n     add      post-amount vat-amount to ws-default.\n     add      vat-amount             to ws-vat.\n     add      post-amount            to nl-cr.\n*>\n*> now for traps\n*>\n     if       input-account = def-acs (w)\n              subtract post-amount from ws-default.\n*>\n     if       def-vat (w) = \"N\"\n              go to Input-End.\n*>\n     if       input-account = def-acs (y)\n              add  post-amount  to  ws-vat.\n*>\n     go       to Input-End.\n*>\n Accept-Money.\n*>     move     zero to ws-poundsd amt-ok ws-penced.\n     move     spaces to ws-amount-screen-accept.\n*>     move     space to ws-sign.\n     display  ws-amount-screen-display at curs2 with foreground-color 3.\n     accept   ws-amount-screen-accept at curs2 with foreground-color 3.\n     perform  Justify-Accept-Money.\n     if       c > 1 or d > 1\n*>     if       ws-pound not numeric\n*>           or ws-pence not numeric\n              display IR036 at line ws-lines col 01 with foreground-color 4\n              go to Accept-Money\n     else\n              display \"                            \" at line ws-lines col 01\n     end-if.\n*>     move     ws-pound to amt-wk-pds.\n*>     move     ws-pence to amt-wk-pence.\n*>     if       ws-sign = \"-\"\n*>              multiply -1 by amt-ok.\n*>\n Accept-Money2.\n     if       amt-ok negative\n              move \"-\" to ws-sign else\n              move space to ws-sign.\n     move     amt-wk-pence to ws-pence.\n     move     \".\" to ws-period.\n     move     amt-wk-pds to ws-pound.\n     accept   ws-amount-screen-accept at curs2 with foreground-color 3 update.\n     perform  justify-Accept-Money.\n     if       c > 1 or d > 1\n              display IR036 at line ws-lines col 01 with foreground-color 4\n              go to Accept-Money2\n     else\n              display \"                            \" at line ws-lines col 01\n     end-if.\n*>     move     ws-pound to amt-wk-pds.\n*>     move     ws-pence to amt-wk-pence.\n*>     if       ws-sign = \"-\"\n*>              multiply -1 by amt-ok.\n*>\n Justify-Accept-Money.\n*>\n*> Because GC has no numeric editing or justification on accept\n*>      as of v1.1 beta on 16/02/09 and up to v3\n*> input field 9(7).99- output 9(9)\n*>\n     move     zero to amt-ok c d.   *> c = neg flag,d = dec. flag,e = dig before '.'\n     move     zero to ws-dstrg-9 ws-nstrg\n     move     10 to b.      *> for num string 9 chars, if changed must also do below\n     perform  varying a from 11 by -1 until a < 1\n              if    ws-amount-screen-accept (a:1) = \"-\"\n                and c = 1\n                    move 2 to c                        *> set negative flag - twice\n                    exit perform                       *> we have an error\n              end-if\n              if    ws-amount-screen-accept (a:1) = \".\"\n                and d = 1\n                    move 2 to d                        *> set decimal flag - twice\n                    exit perform                       *> we have an error\n              end-if\n              if    ws-amount-screen-accept (a:1) = \"-\"\n                    move 1 to c                        *> set negative flag\n                    exit perform cycle\n              end-if\n              if    ws-amount-screen-accept (a:1) = \".\"\n                    move 1 to d                        *> set decimal flag\n                    subtract b from 10 giving E1    *> = 0, 1 or 2 dec. digits\n                    exit perform cycle\n              end-if\n*>\n*> Thats the allowed non numerics done\n*>    below may need to test for 0 thru 9 instead\n*>\n              if    ws-amount-screen-accept (a:1) not numeric\n                and b not = 10                  *> must be same as start value\n                    move 3 to c                 *> if we have number already we can\n                    exit perform                *> NOT have more\n              end-if\n              if    ws-amount-screen-accept (a:1) numeric\n                    subtract 1 from b               *> 1st char is (10)\n                    move ws-amount-screen-accept (a:1) to ws-num-dstring (b:1)\n                    exit perform cycle\n              end-if\n     end-perform\n     if       c < 2 and d < 2         *> these are errors\n       if     E1 = 2\n              divide ws-nstrg by 100 giving amt-ok\n       else\n        if    E1 = 1\n              divide ws-nstrg by 10  giving amt-ok\n        else\n              move ws-nstrg to amt-ok\n        end-if\n       end-if\n       if     c = 1\n              multiply -1 by amt-ok\n       end-if\n     end-if .\n*>\n Credit-Tidy.\n*>\n*> Processing for CR run\n*>\n     move     def-acs (w)  to  post-cr.\n     move     input-account to  post-dr.\n*>\n     if       post-amount < zero\n              move 1 to rev-flag\n              multiply post-amount by -1 giving post-amount.\n     if       rev-flag = 1\n              subtract post-amount vat-amount from ws-batch.\n     if       rev-flag not = 1\n              add      post-amount vat-amount to   ws-batch.\n     move     \"DR\"  to post-vat-side.\n     subtract post-amount vat-amount from ws-default.\n     subtract vat-amount             from ws-vat.\n     add      post-amount to nl-dr.\n*>\n*> Now for traps\n*>\n     if       input-account = def-acs (w)\n              add   post-amount  to  ws-default.\n*>\n     if       def-vat (w) = \"N\"\n              go to  Input-End.\n*>\n     if       input-account = def-acs (y)\n              add  post-amount  to  ws-vat.\n*>\n Input-End.\n     perform  Heading-ScreenP.\n     perform  acasirsub1-Rewrite.                     *> Now write-out updated account\n*>\n*> Now write-out posting record\n*>\n Input-End-1.\n     if       rev-flag = 1\n              multiply  post-amount  by  -1 giving  post-amount.\n     if       rev-flag = 1\n              multiply  vat-amount  by  -1 giving  vat-amount.\n*>\n     move     post-amount  to  net-display.\n     move     vat-amount   to  vat-display.\n     move     61 to cole.\n     display  net-display at curs with foreground-color 3.\n     move     71 to cole.\n     display  vat-display at curs with foreground-color 3.\n*>\n     add      1  to  post-key.\n     add      1  to  lin.\n     if       rev-flag = 1\n              multiply post-amount by -1 giving  post-amount.\n     if       rev-flag = 1\n              multiply vat-amount by -1 giving  vat-amount.\n*>\n     if       rev-flag = 1\n              move  zero  to  rev-flag.\n*>\n     move     5  to  file-function.\n     perform  acasirsub4.    *> write\n*>\n     if       lin  <  ws-20-lines  *> 20\n              go to  Input-Loop.\n     move     6  to  lin.\n*>\n Clear-Screen.\n     move     1 to cole.\n     display  ws-spaces at curs.\n     add      1  to  lin.\n     if       lin  <  ws-20-lines  *> 20\n              go to  Clear-Screen.\n*>\n     display  post-date       at 0601 with foreground-color 3.\n     display  display-account at 0611 with foreground-color 3.\n     display  nl-name         at 0618 with foreground-color 3.\n     display  display-legend  at 0643 with foreground-color 3.\n     display  net-display     at 0661 with foreground-color 3.\n     display  vat-display     at 0671 with foreground-color 3.\n*>\n     move     7  to  lin.\n     go       to Input-Loop.\n*>\n End-Batch.\n*>\n*> Output totals including vat\n*>\n     move     def-acs (w)  to  nl-owning.\n     move     zero         to  nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n*>\n     if       ws-default < zero\n              multiply  ws-default by -1 giving ws-default\n              move ws-default to nl-cr\n              move zero to nl-dr\n     else\n              move ws-default to nl-dr\n              move zero to nl-cr.\n*>\n     perform  acasirsub1-Rewrite.\n*>\n     if       def-vat (w)  equal \"N\"\n              go to   Batch-Close.\n*>\n*> Output for vat\n*>\n     move     def-acs (y)  to  nl-owning.\n     move     zero  to  nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n*>\n     if       ws-type = \"DR\"  and  ws-vat  >  zero\n              move  ws-vat  to  nl-cr\n              move  zero    to  nl-dr.\n     if       ws-type = \"DR\"  and  ws-vat  <  .01\n              move  ws-vat  to  nl-dr\n              move  zero    to  nl-cr.\n*>\n     if       ws-type = \"CR\"  and  ws-vat  >  zero\n              move  ws-vat  to  nl-cr\n              move  zero    to  nl-dr.\n     if       ws-type = \"CR\"  and  ws-vat  <  .01\n              move  ws-vat  to  nl-dr\n              move  zero    to  nl-cr.\n*>\n     perform  acasirsub1-Rewrite.\n*>\n Batch-Close.\n*>\n*> Close files\n*>\n     perform  acasirsub4-Close.         *> Close\n     move     post-key  to  next-post.  *> Now we update system rec for next-post\n*>\n*>  Written out by irs menu after EOJ\n*>\n Batch-Close-Return.\n*>\n     go to    Main-Loop.\n*>\n Heading-ScreenP.\n*>\n     display  heading-screen at 0101.\n*>\n Main-Exit.\n     goback.\n*>\n*>-------------------------------------------------\n*>            Second Level Procedures\n*>-------------------------------------------------\n*>\n*>  all below looks good. vbc 22/1/09\n*>\n Input-Headings section.\n*>----------------------\n*>\n     move     1  to  w  cole.\n     move     7  to  lin.\n*>\n Display-Existing.\n     display  w at curs with foreground-color cob-color-green.\n     add      4 curs giving curs2.\n     move     def-acs (w) to ws-acs.\n     display  ws-acs at curs2 with foreground-color cob-color-cyan.\n     move     ws-acs to  nl-owning.\n     move     zero  to  nl-sub-nominal.\n     if       ws-acs not = zero\n              perform  acasirsub1-Read-Indexed\n              add  10 curs giving curs2\n              display nl-name (1:22) at curs2 with foreground-color cob-color-cyan\n     end-if\n*>\n*>  get code description\n*>\n     add      33 curs giving curs2.\n     move     def-codes (w) to ws-codes.\n     display  ws-codes at curs2 with foreground-color cob-color-cyan.\n     add      5  to col2.\n     move     def-vat (w) to ws-vax.\n     display  ws-vax at curs2 with foreground-color cob-color-cyan.\n     add      1 to col2.\n     display  \"]\" at curs2 with foreground-color cob-color-green.\n     add      1 to w.\n     if       w > 32\n              go to  Display-Existing-end.\n     if       w = 17\n              move 41 to cole\n              move 6  to lin.\n     add      1  to lin.\n     go to    Display-Existing.\n*>\n Display-Existing-End.\n     move     1 to w  cole.\n     move     7 to lin.\n*>\n Main-Exit.   exit.\n*>********    ****\n*>\n*>\n Date-Validate section.\n*>---------------------\n*>\n*>  THESE Routines are NOT the same as the rest of ACAS -\n*>    do not support other country formats.\n*>  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n*>\n*>************************************************\n*>                                               *\n*>            Date Vet Section.                  *\n*>            =================                  *\n*>                                               *\n*>    Format of date must be as follows:-        *\n*>                                               *\n*>       ddxmmxyy                                *\n*>                                               *\n*>    where x can only be one of the following:- *\n*>                                               *\n*>        / , . -                                *\n*>                                               *\n*>     and  dd = 1 thru [days in month]          *\n*>          mm = 1 thru 12                       *\n*>                                               *\n*>************************************************\n*>\n     move     zero to u-bin q.\n     move     post-date to u-date.\n     inspect  u-date replacing all \".\" by \"/\".\n     inspect  u-date replacing all \",\" by \"/\".\n     inspect  u-date replacing all \"-\" by \"/\".\n     inspect  u-date tallying q for all \"/\".\n*>\n     if       q not = 2 or\n              u-days  not numeric or\n              u-month not numeric or\n              u-year  not numeric or\n              u-days  < 01 or > 31 or\n              u-month < 01 or > 12\n              go to Main-Exit.\n*>\n     if       u-days > 29 and\n              u-month = 2\n              go to Main-Exit.\n*>\n     if       u-days > days (u-month) and\n              u-month not = 2\n              go to Main-Exit.\n*>\n     divide   u-year by 4 giving ws-work1.\n     multiply ws-work1 by 4 giving ws-work2.\n*>\n     if       u-month = 2 and\n              u-days > 28 and\n              u-year not = ws-work2\n              go to Main-Exit.\n*>\n     move     u-date to post-date.\n*>\n*>********************************************\n*>                                           *\n*>       date validation & conversion        *\n*>       ============================        *\n*>                                           *\n*>                                           *\n*>  requires  date input in u-date           *\n*>  & returns  date as binary days since     *\n*>    01/01/70  in  u-bin                    *\n*>  date errors returned as u-bin equal zero *\n*>                                           *\n*>********************************************\n*>\n*>\n     move     1     to  ws-work1.\n     move     zero  to  ws-work2\n                        u-bin.\n*>\n     if       u-year not = zero\n              compute u-bin  = u-year * 365.\n*>\n     if       u-bin <   zero\n              move  zero  to  u-bin\n              go to  Pack-End.\n*>\n Pack-Loop-1.\n     if       u-year  >  ws-work2\n              add  1  to  u-bin\n              add  4  to  ws-work2\n              go to  Pack-Loop-1.\n*>\n     if       u-year =  ws-work2\n       and    u-month  >  2\n              add  1  to  u-bin.\n*>\n Pack-Loop-2.\n\n     if       u-month  >  12\n              move  zero  to  u-bin\n              go to Pack-End.\n     if       u-month  >  ws-work1\n              add  days (ws-work1)  to  u-bin\n              add  1  to  ws-work1\n              go to Pack-Loop-2.\n*>\n     if       u-days  not  >  days (ws-work1)\n              add  u-days  to  u-bin\n              go to  Pack-End.\n     if       u-days  = 29\n        and   u-month = 2\n        and   u-year  = ws-work2\n              add  u-days  to   u-bin\n     else\n              move  zero  to u-bin.\n Main-Exit.\n*>\n Pack-End.    exit.\n*>********    ****\n*>\n initialise-main    section.\n*>**************************\n*>\n*> Force Esc, PgUp, PgDown, PrtSC to be detected   - new code for experiment\n*>\n     set      ENVIRONMENT \"COB_SCREEN_EXCEPTIONS\" to \"Y\".\n     set      ENVIRONMENT \"COB_SCREEN_ESC\" to \"Y\".\n     display  space at 0101 with erase eos.\n     accept   ws-env-lines   from lines.\n     if       ws-env-lines < 24\n              move  24 to ws-env-lines ws-lines\n     else\n              move  ws-env-lines   to ws-lines\n     end-if\n     subtract 1 from ws-lines giving ws-23-lines.\n     subtract 2 from ws-lines giving ws-22-lines.\n     subtract 3 from ws-lines giving ws-21-lines.\n     subtract 4 from ws-lines giving ws-20-lines.\n*>\n*>  Set up delete file for screen save/restore.\n*>\n     move     spaces to Path-Work.\n     string   ACAS-Path       delimited by space\n              \"irs-temp.scr\"  delimited by size\n                                 into Path-Work.\n*>\n     move     1 to File-Key-No.               *> 1 = Primary\n*>\n*> Test if the 2 vat accounts exist in defaults. if not, a non 0\n*>\n     move     3  to  file-function.\n     perform  acasirsub3.  *>  call-irsub3.                 *> get default record\n*>\n*> Open A/C file\n*>\n     perform  acasirsub1-Open.                              *>  Open NL as I/O\n     if       WE-Error not = zero\n              display   IR912    at line ws-23-lines col 01 with foreground-color cob-color-red erase eol\n              display   FS-Reply at line ws-23-lines col 52\n              display   SY008    at line ws-lines col 01 with foreground-color cob-color-red erase eol\n              accept    ws-reply at line ws-lines col 38\n              perform   acasirsub1-Close\n              goback.                                       *> Cannot continue.\n     move     zero to a.\n*>\n*> Make sure vat a/c exist\n*>\n     perform  varying y from 31 by 1 until y > 32\n              move  def-acs (y) to nl-owning\n              move  zero to nl-sub-nominal\n              perform  acasirsub1-Read-Indexed\n              if   we-error = 2\n                   display IR035 at line ws-lines col 01 with foreground-color cob-color-red erase eol\n                   accept ws-reply at line ws-lines col 77\n                   display space at line ws-lines col 01 with erase eol\n                   add 1 to a\n              end-if\n     end-perform\n     if       a > zero\n              display \"You will need to fix the VAT account problems before posting\"\n                              at 1201 with erase eos foreground-color 4\n              display SY008   at 1401 with foreground-color 4\n              accept ws-reply at 1440\n              perform  acasirsub1-Close\n              go to Initialise-Main-Exit\n     end-if.\n*>\n*> Get the three VAT rates into both WS tables (usage and edited display)\n*>\n     perform  varying b from 1 by 1 until b > 3\n              move  VAT-Psent (b) to WS-Vat-Rate (b)\n                                     WS-Vat-Rate-Disp (b)\n     end-perform.\n     move     zero to b.\n*>\n*>  Get Coa and store in CoA-Table for when using non default postings AND using description\n*>   to search by.\n*>\n     perform  acasirsub1-Close.\n     perform  acasirsub1-Open-Input.\n     initialise COA-Search-Table.\n     move     zeros to CoA-Count.\n     move     zeros to CoA-Index.  *> NEEDED ?\n     perform  varying CoA-Count from 1 by 1 until CoA-Count > 500  *> table size\n                              or FS-Reply not = zero\n              perform acasirsub1-Read-Next\n              if      Fs-Reply not = zero\n                      exit perform\n              end-if\n              move    NL-Owning      to CoA-Own (CoA-Count)\n              move    NL-Sub-Nominal to CoA-Sub (CoA-Count)\n              move    NL-Name     to CoA-Orig-Desc  (CoA-Count)\n              move    function lower-case (NL-Name)  to Coa-Desc  (CoA-Count)\n     end-perform\n     sort     COA-Table ascending key CoA-Desc.\n*>\n*>  We now have a sorted table sort by CoA-Desc(ription) as lower case so can use search all.\n*>\n*>\n initialise-Main-Exit.\n     exit.\n*>\n Show-Default section.\n*>--------------------\n*>\n     display  Display-Screen-1.\n     display  Setup-Amend-Screen-3.\n     perform  Input-Headings.\n     display  ws-spaces at line ws-23-lines col 01 with erase eos.\n     display  IR030 at line ws-lines col 01   with foreground-color cob-color-white.\n     move     space to ws-reply.\n     accept   ws-reply  at line ws-lines col 79.  *>   2479\n*>\n main51-exit.\n     exit.\n*>\n file-init section.\n*>-----------------\n*>\n     move     spaces to ws-reply.  *> Make sure that you have backed etc\n     display  IR039 at 0301 with foreground-color 4 highlight.\n     display  \" \"    at 0401 with erase eol.\n*>\n*> Removed from O/S versions.\n*>\n*>     display  \"Enter Pass-word - [****]\" AT 0432 with foreground-color 2.\n*>     accept   ws-pass  at 0451 with secure.\n*>     if       ws-pass not = pass-word\n*>              move \"Z\"  to  ws-reply\n*>              go to  main52-exit.\n*>\n*>  Open output postings file/table\n*>\n     move     1  to  file-function.\n     move     3  to  access-type.\n     perform  acasirsub4.     *> call-irsub4.\n     move     2  to  file-function.\n     perform  acasirsub4.     *> call-irsub4.\n*>\n main52-exit.\n     exit.\n*>\n Net section.\n*>----------\n*>\n*> Calculate vat from net  - THIS MAY NEED A TEST FOR ONLY NON ZERO VAT RATES\n*>                           before compute but look like comes to zero ?\n*>\n *>     compute  vat-amount rounded =  post-amount *  vat  /  100.\n     compute  vat-amount rounded =  post-amount *  WS-Vat-Current  /  100.\n*>\n Main-Exita.\n     exit.\n*>\n Gross section.\n*>------------\n*>\n*> calculate vat from gross\n*>\n *>    compute  vat-amount rounded = post-amount - (post-amount / ( (vat + 100) / 100)).\n     compute  vat-amount rounded =\n              post-amount - (post-amount / ( (WS-Vat-Current + 100) / 100)).\n     subtract vat-amount from post-amount.\n*>\n Main-Exitb.\n     exit.\n*>\n Ledger-Postings-Add section.\n*>--------------------------\n*>\n*> This routine processes the posting file produced from SL & PL updating the IRS NL\n*>   accounts and copies the posting record to the internal IRS one.\n*>\n*>  Open input file, get vat a/cs for both Sales and Purchases and hold records\n*>   some code bits from irs080\n*>\n *>    open     input irs-post-file.\n     perform  acas008-Open-Input.\n     if       fs-reply not = zero\n              display IR031 at 2301 with foreground-color 2\n              go to main99-exit.\n*>\n*>   Get default record\n*>\n     move     3  to  file-function.\n     perform  acasirsub3.    *> call-irsub3.\n*>\n*>   Open I-O Nominal-Ledger.\n*>\n *>    perform  acasirsub1-Open.      *> IT is opened in intialise-main\n*>\n*> Get default input and output tax accounts via acs 31 & 32 and save them.\n*>\n     move     def-acs (31) to nl-owning.\n     move     zero         to nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error not = zero\n              display IR03A at 2301 with foreground-color 4 highlight\n              display we-error at 2319 with foreground-color 4 highlight\n              accept we-error at 2340\n              go to main99-exit.\n     move     WS-IRSNL-Record to nl31-record.\n*>\n     move     def-acs (32) to nl-owning.\n     move     zero         to nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error not = zero\n              display IR03B at 2301 with foreground-color 4 highlight\n              display we-error at 2319 with foreground-color 4 highlight\n              accept we-error at 2340\n              go to main99-exit.\n     move     WS-IRSNL-Record to nl32-record.\n*>\n*>   open    i-o post-file.\n*>\n     display  \"Updating Nominal Ledger\" at 2401 with foreground-color 2.\n     perform  acasirsub4-Open.         *> call-irsub4.\n*>\n Input-Loop.\n *>    read     irs-post-file at end\n     perform  acas008-Read-Next.\n     if       FS-Reply = 10\n              go to EOJ.\n     add      1 to Post-Record-Cnt.\n*>\n*> Processing for DR\n*>\n     move     WS-IRS-Post-DR to  nl-owning.\n     move     zero           to  nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              display IR032          at 2301 with foreground-color 4 highlight\n              display WS-IRS-Post-DR at 2325 with foreground-color 4 highlight\n              accept we-error        at 2340\n              go to Input-Loop.\n     add      WS-IRS-Post-Amount  to  nl-dr.\n     if       ws-irs-post-vat-side = \"CR\"\n              add  WS-IRS-Vat-Amount  to  nl-dr.\n*>\n*>  rewrite\n*>\n     perform  acasirsub1-Rewrite.\n*>\n*> Processing for CR\n*>\n     move     WS-IRS-Post-CR  to  nl-owning.\n     move     zero            to  nl-sub-nominal.\n     perform  acasirsub1-Read-Indexed.\n     if       we-error = 2\n              display IR033          at 2301 with foreground-color 4 highlight\n              display WS-IRS-Post-CR at 2325 with foreground-color 4 highlight\n              accept we-error        at 2340\n              go to Input-Loop.\n     add      WS-IRS-Post-Amount  to  nl-cr.\n     if       WS-irs-post-vat-side = \"DR\"\n              add  WS-IRS-Vat-Amount  to  nl-cr.\n*>\n     perform  acasirsub1-Rewrite.\n*>\n*> Now add SL/PL posting to IRS post file\n*>\n     move     WS-IRS-Post-Code   to post-code.\n     move     WS-IRS-Post-Date   to post-date.\n     move     WS-IRS-Post-CR     to post-cr.\n     move     WS-IRS-Post-DR     to post-dr.\n     move     WS-IRS-Post-Amount to post-amount.\n     move     WS-IRS-Post-Legend to post-legend.\n     move     WS-IRS-Vat-AC-Def  to vat-ac-def.\n     move     WS-IRS-Post-Vat-Side to post-vat-side.\n     move     WS-IRS-Vat-Amount  to vat-amount.\n     move     next-post to post-key.\n     add      1 to next-post.\n*>\n     perform  acasirsub4-Write.\n     if       we-error not = zero\n              display IR914 at 2301 with foreground-color 2\n              accept we-error at 2352\n              go to EOJ.\n*>\n*> Processing for VAT\n*>\n     if       WS-IRS-Vat-AC-Def = zero\n              go to  Input-Loop.\n*>\n     if       WS-IRS-Vat-AC-Def = 31\n         and  WS-IRS-Post-Vat-Side = \"CR\"\n              add  WS-IRS-Vat-Amount  to  nl31-cr\n     else\n       if     WS-IRS-Vat-AC-Def = 31\n         and  WS-IRS-Post-Vat-Side = \"DR\"\n              add  WS-IRS-Vat-Amount  to  nl31-dr\n       else\n        if    WS-IRS-Vat-AC-Def = 32\n          and WS-IRS-Post-Vat-Side = \"CR\"\n              add  WS-IRS-Vat-Amount  to  nl32-cr\n        else\n         if   WS-IRS-Vat-AC-Def = 32\n          and WS-IRS-Post-Vat-Side = \"DR\"\n              add  WS-IRS-Vat-Amount  to  nl32-dr.\n     go       to Input-Loop.\n*>\n EOJ.\n*>\n     move     nl31-record to WS-IRSNL-Record.\n     perform  acasirsub1-Rewrite.\n*>\n     move     nl32-record to WS-IRSNL-Record.\n     perform  acasirsub1-Rewrite.\n*>\n *>    perform  acasirsub1-Close.                    *> Closed at EOJ\n     perform  acasirsub4-Close.\n     perform  acas008-Close.\n     display  space at 1201 with erase eol.\n     display  \"Processing Complete on \" Post-Record-Cnt \" records\".\nEOJ-q1.\n     display  \"Can I clear the Ledgers Posting file? [Y]\" at 1401 with erase eol.\n     accept   ws-reply at 1440 with foreground-color 6.\n     move     function upper-case (ws-reply) to ws-reply.\n     if       ws-reply not = \"Y\" and not = \"N\"\n              go to EOJ-q1.\n     if       ws-reply = \"Y\"\n *>             open output irs-post-file\n *>             close irs-post-file.\n              perform acas008-Open-Output    *>         performs a acas008-Delete-All\n              perform acas008-Close.\n     display  \"Note counts and any messages\" at 1401 with erase eol.\n     accept   ws-reply at 1430.\n*>\n main99-exit.\n     exit     section.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 609
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 7,
    "cognitive": 3,
    "halstead": {
      "uniqueOperators": 2,
      "uniqueOperands": 138,
      "totalOperators": 146,
      "totalOperands": 290,
      "vocabulary": 140,
      "length": 436,
      "volume": 3108.367395388005
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
