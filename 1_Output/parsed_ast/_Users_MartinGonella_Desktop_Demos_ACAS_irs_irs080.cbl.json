{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/irs/irs080.cbl",
  "fileName": "irs080.cbl",
  "timestamp": "2025-09-15T16:25:48.987Z",
  "programId": "irs080",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 131
      },
      {
        "name": "file",
        "line": 135
      },
      {
        "name": "working-storage",
        "line": 137
      },
      {
        "name": "linkage",
        "line": 212
      },
      {
        "name": "init01",
        "line": 255
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 132
      },
      {
        "name": "File-Defs",
        "line": 252
      },
      {
        "name": "Clear-nl",
        "line": 279
      },
      {
        "name": "clear-end",
        "line": 319
      },
      {
        "name": "repost",
        "line": 352
      },
      {
        "name": "input-loop",
        "line": 365
      },
      {
        "name": "eoj",
        "line": 434
      },
      {
        "name": "main99-exit",
        "line": 452
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "irsubn",
        "line": 76,
        "type": "DYNAMIC",
        "using": []
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 123,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 130,
        "replacing": null
      },
      {
        "name": "irswsnl",
        "line": 150,
        "replacing": null
      },
      {
        "name": "wsfnctn",
        "line": 151,
        "replacing": null
      },
      {
        "name": "irswsdflt",
        "line": 152,
        "replacing": null
      },
      {
        "name": "irswspost",
        "line": 153,
        "replacing": null
      },
      {
        "name": "Test-Data-Flags",
        "line": 192,
        "replacing": null
      },
      {
        "name": "irswssystem",
        "line": 215,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 218,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 248,
        "replacing": null
      },
      {
        "name": "Proc-ZZ100-ACAS-IRS-Calls",
        "line": 455,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "acasirsubn",
        "thru": null,
        "line": 77
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 277
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 284
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 298
      },
      {
        "target": "acasirsub1-Close",
        "thru": null,
        "line": 313
      },
      {
        "target": "acasirsub3",
        "thru": null,
        "line": 327
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 333
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 344
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 360
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 369
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 379
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 392
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 399
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 410
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 438
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 441
      },
      {
        "target": "acasirsub4",
        "thru": null,
        "line": 444
      },
      {
        "target": "acasirsub1",
        "thru": null,
        "line": 445
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "save-sequ post-record-cnt",
        "line": 260
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 275
      },
      {
        "from": "2",
        "to": "access-type",
        "line": 276
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 283
      },
      {
        "from": "zero",
        "to": "nl-dr nl-cr",
        "line": 293
      },
      {
        "from": "7",
        "to": "file-function",
        "line": 297
      },
      {
        "from": "zero",
        "to": "post-record-cnt",
        "line": 322
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 326
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 331
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 332
      },
      {
        "from": "WS-IRSNL-Record",
        "to": "nl31-record",
        "line": 339
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 342
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 343
      },
      {
        "from": "WS-IRSNL-Record",
        "to": "nl32-record",
        "line": 350
      },
      {
        "from": "1",
        "to": "file-function",
        "line": 358
      },
      {
        "from": "1",
        "to": "access-type",
        "line": 359
      },
      {
        "from": "zero",
        "to": "we-error",
        "line": 367
      },
      {
        "from": "3",
        "to": "file-function",
        "line": 368
      },
      {
        "from": "post-dr",
        "to": "nl-owning",
        "line": 376
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 377
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 378
      },
      {
        "from": "7",
        "to": "file-function",
        "line": 391
      },
      {
        "from": "post-cr",
        "to": "nl-owning",
        "line": 396
      },
      {
        "from": "zero",
        "to": "nl-sub-nominal",
        "line": 397
      },
      {
        "from": "4",
        "to": "file-function",
        "line": 398
      },
      {
        "from": "7",
        "to": "file-function",
        "line": 409
      },
      {
        "from": "7",
        "to": "file-function",
        "line": 436
      },
      {
        "from": "nl31-record",
        "to": "WS-IRSNL-Record",
        "line": 437
      },
      {
        "from": "nl32-record",
        "to": "WS-IRSNL-Record",
        "line": 440
      },
      {
        "from": "2",
        "to": "file-function",
        "line": 443
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "post file changed.\n*> 26/07/83 vbc - Rewrite date vet routine.\n*> 07/12/83 vbc - Tidyup display.\n*> 16/02/84 vbc - Changed to irs080.\n*> 28/05/84 vbc - Hilite display heads.\n*> 26/09/89 vbc - 2.53\n*>                Mods for Cobol/2.\n*> 23/01/09 vbc - Migration to Open/Gnu Cobol as version 3\n*> 21/02/09 vbc - Added support for environment LINES and COLUMNS as needed.\n*> 07/04/09 vbc - Added colour to displays & replace direct NL file\n*>                processing to using irsub1.\n*> 14/03/10 vbc - Cleanup multi field displays to comply with standards.\n*> 04/12/16 vbc - v3.02 RDB\n*> 04/12/16 vbc - .14 RDB support via acasirsub(1-5) & DALs and using\n*>                    standard ACAS param file (system.dat) for info pickup\n*>                    passed to IRS-System-Params (renamed from system-record).\n*>                    Replaced all occurances of call \"irsubn\" by\n*>                     perform acasirsubn\n*>                    File-Defs  added to all irsnnn calls as 2nd param.\n*>                    Clean up all msgs to use Pre-Defined ones system/module\n*>                    wide across entire IRS system in compliance with all of\n*>                    ACAS.\n*>                    Replace direct access (open,read,write,close) for NL\n*>                    for FH & DAL. Must have been written before using FH\n*>                    The temp. Work file is ALWAYS a Cobol file.\n*> 20/12/16 vbc -     All irs progs call cpybk Proc-ZZ100-ACAS-IRS-Calls.\n*> 25/12/16 vbc - .15 Extra tests for rewrite when cleaning NL.\n*> 29/01/18 vbc -     Removed unused error messages.\n*>                    Changed copies to use copybooks where poss. I.e.,\n*>                    renamed print-spool-commandxxx & wsnl to irsprint-spool-command\n*>                    & irswsnl as moved to copybooks dir.\n*> 07/02/18 vbc - .16 Cleanup starting msgs with accept for Y or N.\n*> 10/02/18 vbc - .17 Renamed IR011-16 to IR911-16 and others.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment division.\n copy  \"envdiv.cob\".\n input-output section.\n file-control.\n*>\n data division.\n file section.\n*>\n working-storage section.\n*>-----------------------\n 77  prog-name           pic x(16) value \"irs080 (3.02.17)\".\n*>\n 01  filler.\n     03  ws-reply        pic x.\n*>\n*>     03  ws-pass         pic x(1024).   *> Not used for O/S versions.\n     03  ws-Pass         pic x(4).\n     03  y               pic 99.\n     03  error-flag      pic 9.\n     03  post-record-cnt pic 9(5)    value zero.\n*>\n copy \"irswsnl.cob\"       replacing      nl-record by WS-IRSNL-Record.\n copy \"wsfnctn.cob\".\n copy \"irswsdflt.cob\"     replacing Default-Record by WS-IRS-Default-Record.\n copy \"irswspost.cob\".\n*>\n*>  Working Storage for NL Default rec 31\n*>\n 01  nl31-record.\n     03  nl31-key.\n         05  nl31-owning   pic 9(5).\n         05  nl31-sub-nominal pic 9(5).\n     03  nl31-type         pic a.\n     03  nl31-data.\n         05  nl31-name     pic x(24).\n         05  nl31-dr       pic 9(8)v99   comp.\n         05  nl31-cr       pic 9(8)v99   comp.\n         05  nl31-dr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl31-cr-last  pic 9(8)v99   comp  occurs  4.\n         05  nl31-ac       pic a.\n*>\n*>  Working Storage for NL Default rec 32\n*>\n 01  nl32-record.\n     03  nl32-key.\n       05  nl32-owning     pic 9(5).\n       05  nl32-sub-nominal pic 9(5).\n     03  nl32-type         pic a.\n     03  nl32-data.\n       05  nl32-name       pic x(24).\n       05  nl32-dr         pic 9(8)v99   comp.\n       05  nl32-cr         pic 9(8)v99   comp.\n       05  nl32-dr-last    pic 9(8)v99   comp  occurs  4.\n       05  nl32-cr-last    pic 9(8)v99   comp  occurs  4.\n       05  nl32-ac         pic a.\n*>\n 01  Dummies-For-Unused-FH-Calls.      *> IRS call blk at zz100-ACAS-IRS-Calls\n *>    03  WS-IRSNL-Record       pic x.\n *>    03  WS-IRS-Default-Record pic x.\n *>    03  Posting-Record        pic x.\n     03  Final-Record          pic x.     *> Dummied out as not used in program.\n     03  WS-IRS-Posting-Record pic x.\n*>\n copy \"Test-Data-Flags.cob\".  *> set sw-testing to zero to stop logging.\n*>\n 01  Error-Messages.\n*> System Wide.\n     03  SY008          pic x(32) value \"SY008 Note message & Hit return \".\n     03  IR911          pic x(47) value \"IR911 Error on systemMT processing, Fs-reply = \".\n     03  IR912          pic x(51) value \"IR912 Error on irsnominalMT processing, Fs-reply = \".\n     03  IR913          pic x(48) value \"IR913 Error on irsdfltMT processing, Fs-reply = \".\n     03  IR914          pic x(51) value \"IR914 Error on irspostingMT processing, Fs-reply = \".\n     03  IR915          pic x(49) value \"IR915 Error on irsfinalMT processing, Fs-reply = \".\n     03  IR916          pic x(50) value \"IR916 Error on slpostingMT processing, Fs-reply = \".\n*> Module specific  USED are :  49, 50, 56, 57\n     03  IR980          pic x(22) value \"IR980 Invalid key 1 = \".\n     03  IR981          pic x(22) value \"IR981 Invalid key 2 = \".\n     03  IR982          pic x(50) value \"IR982 Make sure that you have backed up your data\".\n     03  IR983          pic x(39) value \"IR983 Clearing Nominal Ledger of totals\".\n     03  IR984          pic x(32) value \"IR984 To continue Y or N to quit\".\n     03  IR985          pic x(24) value \"IR985 IRSUB1-31 returns \".\n     03  IR986          pic x(24) value \"IR986 IRSUB1-32 returns \".\n*>\n linkage section.\n*>***************\n*>\n copy \"irswssystem.cob\"   *> IRS param record\n              replacing system-record  by IRS-System-Params. *> (01 level)\n*>\n copy \"wssystem.cob\"    *> NEW for v3.02\n             replacing  System-Record by WS-System-Record\n                        Run-Date   by ACAS-Run-Date     *> these 3 are in binary\n                        Start-Date by ACAS-Start-Date   *> IRS expects as x(8)\n                        End-Date   by ACAS-End-Date     *>  dd/mm/yy\n                        suser      by ACAS-suser\n                        Address-1  by ACAS-Address-1\n                        Address-2  by ACAS-Address-2\n                        Address-3  by ACAS-Address-3\n                        Address-4  by ACAS-Address-4\n                        Post-Code  by ACAS-Post-Code\n                        Print-Spool-Name by ACAS-Print-Spool-Name\n                        Pass-Value by ACAS-Pass-Value\n                        Pass-Word  by ACAS-Pass-Word\n                        OP-System  By ACAS-Op-System\n                        Client     by IRS-Client\n                        System-Ops by IRS-System-Ops\n                        Next-Post  by IRS-Next-Post\n                        Vat-Rates2 by IRS-Vat-Rates2\n                        Vat1       by IRS-Vat1\n                        Vat2       by IRS-Vat2\n                        Vat3       by IRS-Vat3\n                        Vat-Group  by IRS-Vat-Group\n                        Vat-Psent  by IRS-Vat-Psent\n                        Save-Sequ  by IRS-Save-Sequ\n                        System-Work-Group by IRS-System-Work-Group\n                        PL-App-Created by IRS-PL-App-Created\n                        PL-Approp-AC   by IRS-PL-Approp-AC\n                        1st-Time-Flag  by IRS-First-Time-Flag.\n*>\n copy \"wsnames.cob\".\n*>\n procedure division using IRS-System-Params\n                          WS-System-Record\n                          File-Defs.\n*>=========================================\n*>\n init01       section.\n*>********************\n*>\n*> First get date & user information..\n*>\n     move     zero to save-sequ post-record-cnt.\n*>\n     display  prog-name at 0101 with erase eos foreground-color 2.\n     display  \"Fixup Accounts File\" at 0129 with foreground-color 1 background-color 7.\n     display  run-date              at 0173  with foreground-color 2.\n     display  IR982 at 0301    with foreground-color 4.\n     display  IR984 at 0401    with foreground-color 4.\n     accept   ws-reply at 0433.\n     if       ws-reply not = \"y\" and not = \"Y\"\n              exit program.\n*>\n     display  IR983  at 0101 with erase eos foreground-color 2.\n*>\n*>   Open I-O N/L.\n*>\n     move     1  to  file-function.\n     move     2  to  access-type.\n     perform  acasirsub1.\n*>\n Clear-nl.\n*>\n*> Read next NL record\n*>\n     move     3 to file-function.\n     perform  acasirsub1.\n     if       we-error = 3\n              go to Clear-end.\n*> v3.02 code\n     if        NL-DR = zero\n          and  NL-CR = zero\n               add  1 to post-record-cnt\n               go   to Clear-NL\n     end-if\n     move     zero to nl-dr nl-cr.\n*>\n*> Rewrite rec\n*>\n     move     7 to file-function.\n     perform  acasirsub1.\n*>\n*> New code for v3.02\n*>\n     if       not FS-Cobol-Files-Used\n         and  WE-Error = 994\n              display IR912 at 2201 with foreground-color 4\n              display FS-Reply at 2252\n              display \"WE=\"    at 2255\n              display WE-Error at 2258\n              display \"SQL=\"   at 2262\n              display SQL-Err  at 2266\n              display SQL-Msg  at 2301\n              display SY008    at 2401\n              accept ws-reply  at 2433\n              perform acasirsub1-Close\n              go to main99-exit\n     end-if\n     add      1 to post-record-cnt.\n     go       to Clear-nl.\n*>\n clear-end.\n     display  \"Cleared Nominal Ledger of totals\" at 0201 with foreground-color 2.\n     display  post-record-cnt at 0234.\n     move     zero to post-record-cnt.\n*>\n*>   Get default record\n*>\n     move     3  to  file-function.\n     perform  acasirsub3.\n     display  \"Got Default record\" at 0301 with foreground-color 2.\n*>\n     move     def-acs (31)  to  nl-owning.\n     move     zero     to  nl-sub-nominal.\n     move     4        to  file-function.\n     perform  acasirsub1.\n     if       we-error not = zero\n              display IR985 at 2301 with foreground-color 4 highlight\n              display we-error at 2319 with foreground-color 4 highlight\n              accept we-error at 2340\n              stop run.\n     move     WS-IRSNL-Record to nl31-record.\n*>\n     move     def-acs (32)  to  nl-owning.\n     move     zero     to  nl-sub-nominal.\n     move     4        to  file-function.\n     perform  acasirsub1.\n     if       we-error not = zero\n              display IR986 at 2301 with foreground-color 4 highlight\n              display we-error at 2319 with foreground-color 4 highlight\n              accept we-error at 2340\n              stop run.\n     move     WS-IRSNL-Record to nl32-record.\n*>\n repost.\n*>-----\n*>\n*>   open    i/p post-file.\n*>\n     display  \"Updating Nominal Ledger\" at 0401 with foreground-color 2.\n     move     1  to  file-function.\n     move     1  to  access-type.\n     perform  acasirsub4.\n     if       we-error not = zero\n              display \"No Postings Available\" at 2301 with foreground-color 2\n              go to eoj.\n*>\n input-loop.\n*>\n     move     zero  to  we-error.\n     move     3  to  file-function.\n     perform  acasirsub4.\n     if       we-error = 3\n              go to  eoj.\n     add      1 to post-record-cnt.\n*>\n*> Processing for DR\n*>\n     move     post-dr  to  nl-owning.\n     move     zero     to  nl-sub-nominal.\n     move     4        to  file-function.\n     perform  acasirsub1.\n     if       we-error = 2\n              display IR980   at 2301 with foreground-color 4 highlight\n              display post-dr at 2323 with foreground-color 4 highlight\n              accept we-error at 2340\n              go to input-loop.\n     add      post-amount  to  nl-dr.\n     if       post-vat-side = \"CR\"\n              add  vat-amount  to  nl-dr.\n*>\n*>  Rewrite\n*>\n     move     7  to  file-function.\n     perform  acasirsub1.\n*>\n*> Processing for CR\n*>\n     move     post-cr  to  nl-owning.\n     move     zero     to  nl-sub-nominal.\n     move     4        to  file-function.\n     perform  acasirsub1.\n     if       we-error = 2\n              display IR981   at 2301 with foreground-color 4 highlight\n              display post-cr at 2323 with foreground-color 4 highlight\n              accept we-error at 2340\n              go to input-loop.\n     add      post-amount  to  nl-cr.\n     if       post-vat-side = \"DR\"\n              add  vat-amount  to  nl-cr.\n*>\n     move     7  to  file-function.\n     perform  acasirsub1.\n*>\n*> Processing for VAT\n*>\n     if       vat-ac-def = zero\n              go to  input-loop.\n*>\n     if       vat-ac-def = 31\n         and  post-vat-side = \"CR\"\n              add  vat-amount  to  nl31-cr\n     else\n       if     vat-ac-def = 31\n         and  post-vat-side = \"DR\"\n              add  vat-amount  to  nl31-dr\n       else\n        if    vat-ac-def = 32\n          and post-vat-side = \"CR\"\n              add  vat-amount  to  nl32-cr\n        else\n         if   vat-ac-def = 32\n          and post-vat-side = \"DR\"\n              add  vat-amount  to  nl32-dr.\n     go to    input-loop.\n*>\n eoj.\n*>\n     move     7  to  file-function.\n     move     nl31-record to WS-IRSNL-Record.\n     perform  acasirsub1.\n*>\n     move     nl32-record to WS-IRSNL-Record.\n     perform  acasirsub1.\n*>\n     move     2  to  file-function.\n     perform  acasirsub4.\n     perform  acasirsub1.\n     display   \" \" at 0501 with erase eol.\n     display  \"Processing Complete on 12345 records\" at 0501 with foreground-color 2.\n     display  post-record-cnt at 0524 with foreground-color 2.\n     display  \"Note counts. messages and Hit return for menu\" at 0701 with foreground-color 2.\n     accept   ws-reply at 0747 with foreground-color 2.\n*>\n main99-exit.\n     exit     program.\n*>\n copy \"Proc-ZZ100-ACAS-IRS-Calls.cob\".\n*>",
        "line": 60
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 3,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 19,
      "totalOperators": 30,
      "totalOperands": 60,
      "vocabulary": 20,
      "length": 90,
      "volume": 388.9735285398626
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
