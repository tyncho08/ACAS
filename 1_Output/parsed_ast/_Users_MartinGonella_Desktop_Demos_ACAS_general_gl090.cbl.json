{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/general/gl090.cbl",
  "fileName": "gl090.cbl",
  "timestamp": "2025-09-15T16:25:32.494Z",
  "programId": "gl090",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "input-output",
        "line": 89
      },
      {
        "name": "working-storage",
        "line": 95
      },
      {
        "name": "linkage",
        "line": 131
      },
      {
        "name": "zz070-Convert-Date",
        "line": 187
      },
      {
        "name": "exit",
        "line": 215
      }
    ],
    "paragraphs": [
      {
        "name": "file-defs",
        "line": 143
      },
      {
        "name": "menu-input",
        "line": 146
      },
      {
        "name": "file-defs",
        "line": 173
      },
      {
        "name": "file-defs",
        "line": 179
      },
      {
        "name": "main-exit",
        "line": 184
      },
      {
        "name": "goback",
        "line": 185
      },
      {
        "name": "zz070-Exit",
        "line": 214
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [
      {
        "target": "gl090b",
        "line": 170,
        "type": "DYNAMIC",
        "using": [
          "ws-calling-data",
          "system-record",
          "to-day",
          "file-defs"
        ]
      },
      {
        "target": "gl090a",
        "line": 176,
        "type": "DYNAMIC",
        "using": [
          "ws-calling-data",
          "system-record",
          "to-day",
          "file-defs"
        ]
      }
    ],
    "copies": [
      {
        "name": "of",
        "line": 79,
        "replacing": null
      },
      {
        "name": "envdiv",
        "line": 88,
        "replacing": null
      },
      {
        "name": "wscall",
        "line": 134,
        "replacing": null
      },
      {
        "name": "wssystem",
        "line": 135,
        "replacing": null
      },
      {
        "name": "wsnames",
        "line": 136,
        "replacing": null
      }
    ],
    "performs": [
      {
        "target": "zz070-convert-date",
        "thru": null,
        "line": 151
      }
    ]
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "9",
        "to": "menu-reply",
        "line": 166
      },
      {
        "from": "to-day",
        "to": "ws-date",
        "line": 195
      },
      {
        "from": "1",
        "to": "Date-Form",
        "line": 198
      },
      {
        "from": "ws-days",
        "to": "ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit",
        "line": 202
      },
      {
        "from": "\"ccyy/mm/dd\"",
        "to": "ws-date",
        "line": 209
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "Ledger does not exist.\n*>**\n*>    Version.            See Prog-Name in Ws.\n*>**\n*>    Called Modules.     gl090b.\n*>                        gl090a.\n*>**\n*>    Error messages used.\n*>                        NONE\n*>****\n*> Changes:\n*> 28/01/09 vbc - Migration to open Cobol.\n*> 20/12/11 vbc - .03 Support for dates other than UK & clean up msgs\n*>                    Error msgs to GLnnn,\n*>                    Support for path+filenames.\n*> 24/10/16 vbc - .   ALL programs now using wsnames.cob in copybooks.\n*> 13/01/18 vbc - .04 Updated for v3.02 & FH & DALs but no code changes here.\n*> 16/04/24 vbc       Copyright notice update superseding all previous notices.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*>*************************************************************************\n*>\n environment             division.\n*>===============================\n*>\n copy \"envdiv.cob\".\n input-output            section.\n*>------------------------------\n*>\n data                    division.\n*>===============================\n*>\n working-storage section.\n*>----------------------\n*>\n 77  prog-name           pic x(15) value \"gl090 (3.02.04)\".\n*>\n 01  ws-data.\n     03  menu-reply      pic 9.\n*>\n 01  ws-Test-Date            pic x(10).\n 01  ws-date-formats.\n     03  ws-swap             pic xx.\n     03  ws-Conv-Date        pic x(10).\n     03  ws-date             pic x(10).\n     03  ws-UK redefines ws-date.\n         05  ws-days         pic xx.\n         05  filler          pic x.\n         05  ws-month        pic xx.\n         05  filler          pic x.\n         05  ws-year         pic x(4).\n     03  ws-USA redefines ws-date.\n         05  ws-usa-month    pic xx.\n         05  filler          pic x.\n         05  ws-usa-days     pic xx.\n         05  filler          pic x.\n         05  filler          pic x(4).\n     03  ws-Intl redefines ws-date.\n         05  ws-intl-year    pic x(4).\n         05  filler          pic x.\n         05  ws-intl-month   pic xx.\n         05  filler          pic x.\n         05  ws-intl-days    pic xx.\n*>\n*> 01  Error-Messages.\n*> System Wide\n*> Module specific\n*>\n linkage section.\n*>**************\n*>\n copy \"wscall.cob\".\n copy \"wssystem.cob\".\n copy \"wsnames.cob\".\n*>\n 01  to-day             pic x(10).\n*>\n procedure division using ws-calling-data\n                          system-record\n                          to-day\n                          file-defs.\n*>***************************************\n*>\n menu-input.\n*>*********\n*>\n     display  prog-name at 0101 with foreground-color 2 erase eos.\n     display  \"Trial Balance\" at 0135 with foreground-color 2.\n     perform  zz070-convert-date.\n     display  ws-date at 0171 with foreground-color 2.\n     display  usera at 0301 with foreground-color 3.\n*>\n     display  \"Select Option By Number :- [ ]\" at 0801 with foreground-color 2.\n     display  \"(1)  Detailed Trial Balance\" at 1001 with foreground-color 2.\n*>\n     if       profit-centres\n              display \"(2)  Profit Centre Trial Balance\" at 1201 with foreground-color 2\n     else\n      if      branches\n              display \"(2)  Branch Trial Balance\" at 1201 with foreground-color 2.\n*>\n     display  \"(9)  Exit to system menu\" at 1701 with foreground-color 2.\n*>\n     move     9 to menu-reply.\n     accept   menu-reply at 0829 with foreground-color 7 update.\n*>\n     if       menu-reply = 1\n              call \"gl090b\" using ws-calling-data\n                                  system-record\n                                  to-day\n                                  file-defs.\n*>\n     if       menu-reply = 2\n              call \"gl090a\" using ws-calling-data\n                                  system-record\n                                  to-day\n                                  file-defs.\n*>\n     if       menu-reply not = 9\n              go to  menu-input.\n*>\n main-exit.\n     goback.\n*>\n zz070-Convert-Date        section.\n*>********************************\n*>\n*>  Converts date in to-day to UK/USA/Intl date format\n*>****************************************************\n*> Input:   to-day\n*> output:  ws-date as uk/US/Inlt date format\n*>\n     move     to-day to ws-date.\n*>\n     if       Date-Form = zero\n              move 1 to Date-Form.\n     if       Date-UK\n              go to zz070-Exit.\n     if       Date-USA                *> swap month and days\n              move ws-days to ws-swap\n              move ws-month to ws-days\n              move ws-swap to ws-month\n              go to zz070-Exit.\n*>\n*> So its International date format\n*>\n     move     \"ccyy/mm/dd\" to ws-date.  *> swap Intl to UK form\n     move     to-day (7:4) to ws-Intl-Year.\n     move     to-day (4:2) to ws-Intl-Month.\n     move     to-day (1:2) to ws-Intl-Days.\n*>\n zz070-Exit.\n     exit     section.",
        "line": 32
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 4,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 9,
      "totalOperators": 5,
      "totalOperands": 10,
      "vocabulary": 10,
      "length": 15,
      "volume": 49.82892142331043
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
