{
  "filePath": "/Users/MartinGonella/Desktop/Demos/ACAS/stock/stockconvert3.cbl",
  "fileName": "stockconvert3.cbl",
  "timestamp": "2025-09-15T16:25:49.910Z",
  "programId": "stockconvert3",
  "parserUsed": "GnuCOBOL + Regex",
  "parseConfidence": 0,
  "validationStatus": "ERROR",
  "gnuCobolValidation": {
    "success": true,
    "errors": [],
    "warnings": []
  },
  "parseErrors": [
    "Cannot read properties of undefined (reading 'total')"
  ],
  "parseWarnings": [],
  "divisions": {
    "identification": true,
    "environment": true,
    "data": true,
    "procedure": true
  },
  "structure": {
    "sections": [
      {
        "name": "configuration",
        "line": 78
      },
      {
        "name": "input-output",
        "line": 81
      },
      {
        "name": "file",
        "line": 103
      },
      {
        "name": "working-storage",
        "line": 167
      }
    ],
    "paragraphs": [
      {
        "name": "file-control",
        "line": 82
      },
      {
        "name": "AA000-Start",
        "line": 175
      },
      {
        "name": "AA010-Read",
        "line": 189
      },
      {
        "name": "AA020-Process-2",
        "line": 215
      },
      {
        "name": "AA020-Read",
        "line": 230
      }
    ],
    "entryPoints": []
  },
  "dependencies": {
    "calls": [],
    "copies": [
      {
        "name": "of",
        "line": 11,
        "replacing": null
      },
      {
        "name": "of",
        "line": 71,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 105,
        "replacing": null
      },
      {
        "name": "fdstock",
        "line": 106,
        "replacing": null
      }
    ],
    "performs": []
  },
  "dataFlow": {
    "files": [],
    "moves": [
      {
        "from": "zero",
        "to": "In-Rec-Count Rec-Count",
        "line": 216
      }
    ],
    "computes": []
  },
  "businessLogic": {
    "conditions": [
      {
        "type": "IF",
        "condition": "running comp-stock*.sh\n  *>  you can delete or just ignore it as it will not be used.\n  *>\n  *>  YOU MUST RUN THIS PROGRAM IN THE Data Folders containing the files :\n  *>    stockctl.dat**  for each folder that you use i.e.,  INCLUDING any\n  *>      for warehouses if used, and do so one by one, i.e.,\n  *>\n  *>      cd ACAS\n  *>      stockconvert2\n  *>      cd whse-1\n  *>      stockconvert2\n  *>      cd whse-2\n  *>      stockconvert2\n  *>\n  *>       etc, etc.\n  *>\n identification division.\n program-id.                 stockconvert3.\n*>Author.                    Vincent B Coen, FBCS (ret). 30/03/2024.\n*>\n*>Security.                  Copyright (C) 2024 & later, Vincent Bryan Coen.\n*>                           Distributed under the GNU General Public License.\n*>                           See the file COPYING for details.\n*>\n*>Purpose.                   Convert file for Stock for new ALT key.\n*>\n*> Updates.\n*> 13/12/24 vbc - Add close all open files if any error occurs before a STOP RUN\n*>                Add instruction to compile it as the scripts will create a .so\n*>                file that is not called.\n*> 04/02/25 vbc - Add Location as alternative key with dups.\n*>\n*>*************************************************************************\n*>\n*>  From copyright.cob.\n*>\n*> Copyright Notice.\n*> ****************\n*>\n*> This notice supersedes all prior copyright notices & was updated 2024-04-16.\n*>\n*> These files and programs are part of the Applewood Computers Accounting\n*> System and is Copyright (c) Vincent B Coen. 1976-2025 and later.\n*>\n*> This program is now free software; you can redistribute it and/or modify it\n*> under the terms listed here and of the GNU General Public License as\n*> published by the Free Software Foundation; version 3 and later as revised\n*> for PERSONAL USAGE ONLY and that includes for use within a business but\n*> EXCLUDES repackaging or for Resale, Rental or Hire in ANY way.\n*>\n*> Persons interested in repackaging, redevelopment for the purpose of resale or\n*> distribution in a rental or hire mode must get in touch with the copyright\n*> holder with your commercial plans and proposals.\n*>\n*> ACAS is distributed in the hope that it will be useful, but WITHOUT\n*> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n*> FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n*> for more details. If it breaks, you own both pieces but I will endeavour\n*> to fix it, providing you tell me about the problem.\n*>\n*> You should have received a copy of the GNU General Public License along\n*> with ACAS; see the file COPYING.  If not, write to the Free Software\n*> Foundation, 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.\n*>\n*> *>*************************************************************************\n*>\n environment division.\n configuration section.\n source-computer.        Linux.\n object-computer.        Linux.\n input-output section.\n file-control.\n*>\n     select  Old-Stock-File  assign               \"stockctl.dat\"    *> File-11\n                             access               dynamic\n                             organization         indexed\n                             status               Fs-Reply\n                             record key           Stock-Key in Old-Stock-Record.\n*>\n     select Temp-Stock-File  assign               \"Temp-stock.dat\"\n                             organization         sequential.\n*>\n     select  Stock-File      assign               \"stockctl.dat\"  *>  File-11\n                             access               dynamic\n                             organization         indexed\n                             status               Fs-Reply\n                             record key           Stock-Key       in Stock-Record\n                             alternate record key Stock-Abrev-Key in Stock-Record\n                             alternate record key Stock-Desc      in Stock-Record with duplicates\n                             alternate record key Stock-Location  in Stock-Record with duplicates. *> New 04/2/25.\n*>\n data division.\n file section.\n*>\n copy \"fdstock.cob\".\n copy \"fdstock.cob\"  replacing ==Stock-File== by ==Temp-Stock-File==\n                               ==Stock-Record== by ==Temp-Stock-Record==.\n fd  Old-Stock-File.\n*>\n 01  Old-Stock-Record.\n     03  Stock-Key                pic x(13).\n     03  Stock-Abrev-Key          pic x(7).\n     03  Stock-Suppliers-Group.\n         05  Stock-Supplier-P1    pic x(7).                          *> Primary   Supplier\n         05  Stock-Supplier-P2    pic x(7).                          *> Secondary Supplier\n         05  Stock-Supplier-P3    pic x(7).                          *> Back Up   Supplier\n     03  filler redefines Stock-Suppliers-Group.\n         05  Stock-Suppliers      pic x(7)     occurs 3.  *> 41\n     03  Stock-Desc               pic x(32).              *> 73\n     03  Stock-Construct-Item     pic x(13).              *> 86\n     03  Stock-Location           pic x(10).\n     03  Stock-PA-Code.\n         05  Stock-pa-System      pic x.\n         05  Stock-pa-Group.\n             07  Stock-pa-First   pic x.\n             07  Stock-pa-Second  pic x.\n     03  Stock-SA-Code.\n         05  Stock-sa-System      pic x.\n         05  Stock-sa-Group.\n             07  Stock-sa-First   pic x.\n             07  Stock-sa-Second  pic x.\n     03  Stock-Services-Flag      pic x.                  *> 103  flag 4 services, not product (Y/N)\n     03  Stock-Last-Actual-Cost   pic 9(7)v99     comp-3. *> (5)\n     03  Stock-Arrived-Date       pic 9(8)       comp.   *> Last arrived, NEW 30/03/24 - 112\n     03  filler                   pic x(4).              *> was 8 (30/03/24) 116\n *>    03  filler                   pic x(8).\n     03  Stock-Construct-Bundle   pic 9(6)        comp.\n     03  Stock-Under-Construction pic 9(6)        comp.\n     03  Stock-Work-in-Progress   pic 9(6)        comp.\n     03  Stock-ReOrder-Pnt        pic 9(6)        comp.\n     03  Stock-Std-ReOrder        pic 9(6)        comp.\n     03  Stock-Back-Ordered       pic 9(6)        comp.\n     03  Stock-On-Order           pic 9(6)        comp.\n     03  Stock-Held               pic 9(6)        comp.\n     03  Stock-Pre-Sales          pic 9(6)        comp.   *> 36 = 152\n     03  Stock-Committed redefines Stock-Pre-Sales\n                                  pic 9(6)       comp.\n     03  Stock-Retail             pic 9(7)v99     comp-3. *> 5    *> This 3 increased by 1 leading digit\n     03  Stock-Cost               pic 9(7)v9999   comp-3. *> 6          Based on last Order Only\n     03  Stock-Value              pic 9(9)v99     comp-3. *> 6 = 169\n     03  Stock-Order-Due          pic 9(8)    comp.\n     03  Stock-Order-Date         pic 9(8)    comp.   *> 177\n     03  Stock-Mthly-Running-Totals.                 *> 16:    cleared at EOY cycle\n         05  Stock-Adds           pic 9(8)    comp.  *> binary-long.\n         05  Stock-Deducts        pic 9(8)    comp.  *> binary-long.\n         05  Stock-Wip-Adds       pic 9(8)    comp.  *> binary-long.\n         05  Stock-Wip-Deds       pic 9(8)    comp.  *> binary-long.\n     03  Stock-History.\n         05  Stock-History-Data.    *> 193:       zeroed for new year\n             07  Stock-TD-Adds     pic 9(8)   comp  occurs 12.\n             07  Stock-TD-Deds     pic 9(8)   comp  occurs 12.\n             07  Stock-TD-Wip-Adds pic 9(8)   comp  occurs 12.\n             07  Stock-TD-Wip-Deds pic 9(8)   comp  occurs 12.\n     03  filler                   pic x(15).                           *> 400  expansion\n\n*>\n working-storage section.\n 77  prog-name           pic x(20)  value \"Stockconv2 (1.00.00)\".\n 01  fs-reply            pic 99.\n 01  rec-count           pic 9(4)   value zero.\n 01  In-Rec-Count        pic 9(4)   value zero.\n 01  Out-Rec-Count       pic 9(4)   value zero.\n*>\n procedure division.\n AA000-Start.\n     open     input Old-Stock-File.\n     if       fs-reply not = \"00\"\n              display \"Error on opening input Stock file \" fs-reply\n              close Old-Stock-File\n              stop run.\n     open     output Temp-Stock-File.\n     if       fs-reply  not = \"00\"\n              display  \"Failure to Open output Temp Stock File\" fs-reply\n              close Temp-Stock-File\n              close Old-Stock-File\n              stop run.\n     Display  prog-name \" Starts\".\n*>\n AA010-Read.\n     read     Old-Stock-File  next record at end\n              close Old-Stock-File Temp-Stock-File\n              display \" \"\n              display \"Converting Stock recs 1/2 \"\n                  In-Rec-Count \" Read \"   rec-count \" written - Pass 1 of 2\"\n*>             Display  prog-name \" Ends\"\n*>             stop run.\n              go to AA020-Process-2.\n     if       fs-reply not = zero\n              display \"Error on reading OLD stock recs = \" fs-reply\n              close Old-Stock-File Temp-Stock-File\n              stop run.\n     display  \"*\" no advancing.\n*>\n     add      1 to In-Rec-Count.\n     initialise Temp-Stock-Record with filler.\n     move     CORRESPONDING Old-Stock-Record to Temp-Stock-Record.\n     write    Temp-Stock-Record.\n     if       fs-reply not = zero\n              display \"Error writing Temp stock record = \" fs-reply\n              close Old-Stock-File Temp-Stock-File\n              stop run.\n     add      1 to rec-count.\n     go       to AA010-Read.\n*>\n AA020-Process-2.\n     move     zero to In-Rec-Count Rec-Count.\n     open     input Temp-Stock-File.\n     if       fs-reply  not = \"00\"\n              display  \"Failure to Open input Temp Stock File\" fs-reply\n              close Temp-Stock-File\n              stop run.\n     open     output Stock-File.\n     if       fs-reply not = \"00\"\n              display \"Error on opening output NEW Stock file \" fs-reply\n              close Stock-File\n              close Temp-Stock-File\n              stop run.\n     display \" Phase 2 starts\".\n*>\n AA020-Read.\n     read     Temp-Stock-File  next record at end\n              close Stock-File Temp-Stock-File\n              display \" \"\n              display \"Converting Stock recs 2/2 \"\n                  In-Rec-Count \" Read \"   rec-count \" written - Pass 2 of 2\"\n              Display  prog-name \" Ends\"\n              stop run.\n     if       fs-reply not = zero\n              display \"Error on reading Temp stock recs = \" fs-reply\n              close Stock-File Temp-Stock-File\n              stop run.\n     display  \"*\" no advancing.\n*>\n     add      1 to In-Rec-Count.\n     move     CORRESPONDING Temp-Stock-Record to Stock-Record.\n     write    Stock-Record.\n     if       fs-reply not = zero\n              display \"Error writing NEW stock record = \" fs-reply\n              close Stock-File Temp-Stock-File\n              stop run.\n     add      1 to rec-count.\n     go       to AA020-Read.\n*>",
        "line": 11
      }
    ],
    "evaluates": [],
    "validations": []
  },
  "complexity": {
    "mccabe": 2,
    "cognitive": 1,
    "halstead": {
      "uniqueOperators": 1,
      "uniqueOperands": 2,
      "totalOperators": 1,
      "totalOperands": 2,
      "vocabulary": 3,
      "length": 3,
      "volume": 4.754887502163468
    }
  },
  "quality": {
    "gotos": [],
    "deadCode": [],
    "missingErrorHandlers": []
  },
  "sql": {
    "hasSQL": false,
    "statements": []
  },
  "cics": {
    "hasCICS": false,
    "statements": []
  }
}
